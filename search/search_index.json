{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u683c\u81f4 \u00b6 Thinking & Writing \u6700\u8fd1\u66f4\u65b0 \u00b6 2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2022-01-27 GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-15 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6 \u66f4\u591a\u5206\u7c7b \u00b6 CAD/CAE integration (12) devops (5) feeling (2) finite element analysis (8) machine learning (4) mathematics (15) numeric calculation (10) optimization (7) plasticity theory (4) process automation (27) python/vba/cpp (26) web development (5)","title":"\u683c\u81f4"},{"location":"#_1","text":"Thinking & Writing","title":"\u683c\u81f4"},{"location":"#_2","text":"2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2022-01-27 GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-15 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6","title":"\u6700\u8fd1\u66f4\u65b0"},{"location":"#_3","text":"CAD/CAE integration (12) devops (5) feeling (2) finite element analysis (8) machine learning (4) mathematics (15) numeric calculation (10) optimization (7) plasticity theory (4) process automation (27) python/vba/cpp (26) web development (5)","title":"\u66f4\u591a\u5206\u7c7b"},{"location":"2012-05-21-%E4%B8%80%E8%B7%AF%E8%B5%B0%E6%9D%A5/","text":"\u4e00\u8def\u8d70\u6765 \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-05-21 | \u5206\u7c7b\uff1a feeling \u5f88\u4e45\u4e4b\u524d\u4fbf\u8bf4\u8981\u586b\u300a\u4e0d\u662f\u56e0\u4e3a\u5bc2\u5bde\u624d\u60f3\u4f60\u300b\u7684\u6b4c\u8bcd\uff0c\u53ef\u662f\u8fdf\u8fdf\u6ca1\u6709\u5b8c\u6210\u3002\u7ec8\u5728\u4e00\u591c\u4e4b\u95f4\u63a8\u5012\u6b64\u524d\u6240\u6709\u7684\u6784\u601d\u800c\u5199\u5c31\uff0c\u5982\u201c\u6628\u65e5\u7684\u66f2\u8c03\uff0c\u604d\u7136\u95f4\u4e91\u6563\u70df\u6d88\uff1b\u7eed\u5199\u7684\u624b\u7a3f\uff0c\u6d8c\u52a8\u5185\u5fc3\u7684\u6ce2\u6d9b\u201d\u6240\u8a00\u3002 \u6628\u65e5\u7684\u66f2\u8c03 \u604d\u7136\u95f4\u4e91\u6563\u70df\u6d88 \u7eed\u5199\u7684\u624b\u7a3f \u6d8c\u52a8\u5185\u5fc3\u7684\u6ce2\u6d9b \u591c\u9611\u58f0\u6084\u6084 \u4efb\u51ed\u601d\u5ff5\u5728\u53d1\u9175 \u8ba9\u601d\u7eea\u5b83\u6162\u6162\u8dd1 \u4e1d\u4e1d\u7f15\u7f15\u5230\u7834\u6653 \u53f9\u5e7d\u68a6\u98d8\u6e3a \u4f60\u7684\u5029\u5f71\u5bfb\u4e0d\u7740 \u66fe\u7ecf\u7684\u9a84\u50b2 \u5316\u6210\u6d53\u90c1\u7684\u5bc2\u5be5 \u60f3\u8d77\u6bcf\u4e00\u6b21\u5435\u95f9 \u540e\u6094\u60c5\u7eea\u592a\u9738\u9053 \u628a\u90a3\u4e0d\u5feb\u90fd\u5fd8\u6389 \u611f\u53d7\u5bf9\u65b9\u7684\u5fc3\u8df3 \u4e5f\u8bb8\u98ce\u96e8\u7f81\u7eca\u591a\u70e6\u607c \u6c89\u6dc0\u8fc7\u540e\u5374\u662f\u4f60\u7684\u597d \u7e41\u534e\u843d\u5c3d\u82b3\u534e\u6d88 \u4f60\u7684\u7b11\u9765\u5fd8\u4e0d\u4e86 \u7ec8\u4e8e\u6211\u548c\u4f60\u8d70\u5230\u4eca\u671d \u7ec8\u4e8e\u6211\u4eec\u4e0d\u6015\u524d\u8def\u8fe2\u8fe2 \u767d\u4e91\u60a0\u60a0\u6e05\u98ce\u900d\u9065 \u643a\u624b\u56db\u5206\u4e4b\u4e09\u548c\u4f60\u4e00\u8d77\u8001","title":"\u4e00\u8def\u8d70\u6765"},{"location":"2012-05-21-%E4%B8%80%E8%B7%AF%E8%B5%B0%E6%9D%A5/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2012-05-21 | \u5206\u7c7b\uff1a feeling \u5f88\u4e45\u4e4b\u524d\u4fbf\u8bf4\u8981\u586b\u300a\u4e0d\u662f\u56e0\u4e3a\u5bc2\u5bde\u624d\u60f3\u4f60\u300b\u7684\u6b4c\u8bcd\uff0c\u53ef\u662f\u8fdf\u8fdf\u6ca1\u6709\u5b8c\u6210\u3002\u7ec8\u5728\u4e00\u591c\u4e4b\u95f4\u63a8\u5012\u6b64\u524d\u6240\u6709\u7684\u6784\u601d\u800c\u5199\u5c31\uff0c\u5982\u201c\u6628\u65e5\u7684\u66f2\u8c03\uff0c\u604d\u7136\u95f4\u4e91\u6563\u70df\u6d88\uff1b\u7eed\u5199\u7684\u624b\u7a3f\uff0c\u6d8c\u52a8\u5185\u5fc3\u7684\u6ce2\u6d9b\u201d\u6240\u8a00\u3002 \u6628\u65e5\u7684\u66f2\u8c03 \u604d\u7136\u95f4\u4e91\u6563\u70df\u6d88 \u7eed\u5199\u7684\u624b\u7a3f \u6d8c\u52a8\u5185\u5fc3\u7684\u6ce2\u6d9b \u591c\u9611\u58f0\u6084\u6084 \u4efb\u51ed\u601d\u5ff5\u5728\u53d1\u9175 \u8ba9\u601d\u7eea\u5b83\u6162\u6162\u8dd1 \u4e1d\u4e1d\u7f15\u7f15\u5230\u7834\u6653 \u53f9\u5e7d\u68a6\u98d8\u6e3a \u4f60\u7684\u5029\u5f71\u5bfb\u4e0d\u7740 \u66fe\u7ecf\u7684\u9a84\u50b2 \u5316\u6210\u6d53\u90c1\u7684\u5bc2\u5be5 \u60f3\u8d77\u6bcf\u4e00\u6b21\u5435\u95f9 \u540e\u6094\u60c5\u7eea\u592a\u9738\u9053 \u628a\u90a3\u4e0d\u5feb\u90fd\u5fd8\u6389 \u611f\u53d7\u5bf9\u65b9\u7684\u5fc3\u8df3 \u4e5f\u8bb8\u98ce\u96e8\u7f81\u7eca\u591a\u70e6\u607c \u6c89\u6dc0\u8fc7\u540e\u5374\u662f\u4f60\u7684\u597d \u7e41\u534e\u843d\u5c3d\u82b3\u534e\u6d88 \u4f60\u7684\u7b11\u9765\u5fd8\u4e0d\u4e86 \u7ec8\u4e8e\u6211\u548c\u4f60\u8d70\u5230\u4eca\u671d \u7ec8\u4e8e\u6211\u4eec\u4e0d\u6015\u524d\u8def\u8fe2\u8fe2 \u767d\u4e91\u60a0\u60a0\u6e05\u98ce\u900d\u9065 \u643a\u624b\u56db\u5206\u4e4b\u4e09\u548c\u4f60\u4e00\u8d77\u8001","title":"\u4e00\u8def\u8d70\u6765"},{"location":"2012-07-10-Marc%E8%B0%83%E7%94%A8Python%E8%84%9A%E6%9C%AC%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E4%BA%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/","text":"Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898 \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-07-10 | \u5206\u7c7b\uff1a finite element analysis \u672c\u6587\u4e3a\u4f5c\u8005\u5728\u7f16\u5199\u4f9b Marc \u8c03\u7528\u7684 Python \u811a\u672c\u7a0b\u5e8f\u8fc7\u7a0b\u4e2d\uff0c\u9047\u5230\u7684\u5173\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u51e0\u4e2a\u95ee\u9898\u53ca\u89e3\u51b3\u65b9\u6cd5\u3002 \u9700\u6c42 \u00b6 \u901a\u8fc7Python\u811a\u672c\u4e3aMarc\u8bfb\u5165\u521d\u59cb\u5316\u6570\u636e\uff0c\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a user_application |- data | |- initial_data.txt |-menu_command | |- marc_menu_newproject.py \u5176\u4e2d\uff0c initial_data.txt \u4e3a\u521d\u59cb\u6570\u636e\uff0c marc_menu_newproject.py \u4e3a\u811a\u672c\u6587\u4ef6\u3002 \u57fa\u672c\u601d\u8def\u4e3a\uff1a \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u7684\u4e0a\u7ea7\u76ee\u5f55\uff0c\u5373 data \u6587\u4ef6\u5939\u6240\u5728\u76ee\u5f55 \u7528Marc\u5185\u90e8\u547d\u4ee4 *user_defined_read filename \u8bfb\u53d6 data \u4e0b\u6587\u4ef6 user_dir = os.path.dirname(os.getcwd()) # \u811a\u672c\u76ee\u5f55 data_dir = user_dir + \"\\\\data\\\\initial_data.txt\" ImportError: No module named os \u00b6 \u5f53\u524dPython\u7248\u672c\u4e3aMarc\u5b89\u88c5\u65f6\u81ea\u5e26\u7684Python 2.5\uff0c\u4f46\u662f\u5728python\u7f16\u8f91\u5668\u4e0b\u76f4\u63a5\u8fd0\u884c import os \u4e0d\u5b58\u5728\u6b64\u95ee\u9898\u3002\u731c\u6d4b\u539f\u56e0\u4e3a\uff1a\u5b9e\u9645\u8c03\u7528Python\u811a\u672c\u7684\u662fMarc\u7a0b\u5e8f\uff0c\u5219\u7531\u4e8eMarc\u65e0\u6cd5\u641c\u7d22\u5230Python\u7684 os \u6a21\u5757\u800c\u5bfc\u81f4\u9519\u8bef\u3002 \u89e3\u51b3\u65b9\u6848 \uff1a\u4e3aMarc\u6307\u5b9aPython\u76f8\u5173\u6a21\u5757\uff0c\u5373\u5efa\u7acb PYTHONPATH \u73af\u5883\u53d8\u91cf 1 \uff0c\u5176\u503c\u4e3aMarc\u5b89\u88c5\u76ee\u5f55\u4e0bPython\u5e93\u6587\u4ef6\u8def\u5f84 Lib \u3002 \u81f3\u6b64\uff0c\u7b2c\u4e00\u4e2a\u95ee\u9898\u89e3\u51b3\u3002 \u8bfb\u5165\u521d\u59cb\u6587\u4ef6\u5931\u8d25 \u00b6 \u6570\u636e\u6587\u4ef6\u7684\u76ee\u6807\u4f4d\u7f6e\u662f \\user_application\\data\\ \uff0c\u5b9e\u9645\u4e0a\u5374\u5b9a\u4f4d\u5411\u4e86\u9519\u8bef\u4f4d\u7f6e C:\\User\\data\\ \u3002\u8fd9\u662f\u56e0\u4e3a\u4e0a\u8ff0\u4ee3\u7801\u671f\u671b\u901a\u8fc7 os.getcwd() \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0c\u7136\u800c os.getcwd() \u83b7\u53d6\u7684\u662f\u5f53\u524d\u76ee\u5f55\u2014\u2014\u6b63\u5728\u8fd0\u884c\u7684Marc\u7a0b\u5e8f\u7684\u76ee\u5f55\uff0c\u800c\u4e0d\u662fMarc\u8c03\u7528\u7684\u811a\u672c\u7684\u76ee\u5f55 2 \u3002 \u89e3\u51b3\u65b9\u6848 \uff1a\u4f7f\u7528 sys.path[0] \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u6240\u5728\u8def\u5f84 3 \u3002 \u56e0\u6b64\uff0c\u4fee\u6b63\u540e\u4ee3\u7801\u4e3a\uff1a user_dir = os.path.dirname(sys.path[0]) # \u811a\u672c\u76ee\u5f55 data_dir = user_dir + \"\\\\data\\\\initial_data.txt\" Windows\u4e0b\u914d\u7f6ePython\u73af\u5883\u53d8\u91cf \u21a9 Python\u8bed\u8a00\u83b7\u53d6\u811a\u672c\u6587\u4ef6\u6240\u5728\u8def\u5f84 \u21a9 Python \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u8def\u5f84\u76ee\u5f55 \u21a9","title":"Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898"},{"location":"2012-07-10-Marc%E8%B0%83%E7%94%A8Python%E8%84%9A%E6%9C%AC%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E4%BA%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/#marcpython","text":"\u53d1\u5e03\u4e8e\uff1a2012-07-10 | \u5206\u7c7b\uff1a finite element analysis \u672c\u6587\u4e3a\u4f5c\u8005\u5728\u7f16\u5199\u4f9b Marc \u8c03\u7528\u7684 Python \u811a\u672c\u7a0b\u5e8f\u8fc7\u7a0b\u4e2d\uff0c\u9047\u5230\u7684\u5173\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u51e0\u4e2a\u95ee\u9898\u53ca\u89e3\u51b3\u65b9\u6cd5\u3002","title":"Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898"},{"location":"2012-07-10-Marc%E8%B0%83%E7%94%A8Python%E8%84%9A%E6%9C%AC%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E4%BA%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/#_1","text":"\u901a\u8fc7Python\u811a\u672c\u4e3aMarc\u8bfb\u5165\u521d\u59cb\u5316\u6570\u636e\uff0c\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a user_application |- data | |- initial_data.txt |-menu_command | |- marc_menu_newproject.py \u5176\u4e2d\uff0c initial_data.txt \u4e3a\u521d\u59cb\u6570\u636e\uff0c marc_menu_newproject.py \u4e3a\u811a\u672c\u6587\u4ef6\u3002 \u57fa\u672c\u601d\u8def\u4e3a\uff1a \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u7684\u4e0a\u7ea7\u76ee\u5f55\uff0c\u5373 data \u6587\u4ef6\u5939\u6240\u5728\u76ee\u5f55 \u7528Marc\u5185\u90e8\u547d\u4ee4 *user_defined_read filename \u8bfb\u53d6 data \u4e0b\u6587\u4ef6 user_dir = os.path.dirname(os.getcwd()) # \u811a\u672c\u76ee\u5f55 data_dir = user_dir + \"\\\\data\\\\initial_data.txt\"","title":"\u9700\u6c42"},{"location":"2012-07-10-Marc%E8%B0%83%E7%94%A8Python%E8%84%9A%E6%9C%AC%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E4%BA%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/#importerror no module named os","text":"\u5f53\u524dPython\u7248\u672c\u4e3aMarc\u5b89\u88c5\u65f6\u81ea\u5e26\u7684Python 2.5\uff0c\u4f46\u662f\u5728python\u7f16\u8f91\u5668\u4e0b\u76f4\u63a5\u8fd0\u884c import os \u4e0d\u5b58\u5728\u6b64\u95ee\u9898\u3002\u731c\u6d4b\u539f\u56e0\u4e3a\uff1a\u5b9e\u9645\u8c03\u7528Python\u811a\u672c\u7684\u662fMarc\u7a0b\u5e8f\uff0c\u5219\u7531\u4e8eMarc\u65e0\u6cd5\u641c\u7d22\u5230Python\u7684 os \u6a21\u5757\u800c\u5bfc\u81f4\u9519\u8bef\u3002 \u89e3\u51b3\u65b9\u6848 \uff1a\u4e3aMarc\u6307\u5b9aPython\u76f8\u5173\u6a21\u5757\uff0c\u5373\u5efa\u7acb PYTHONPATH \u73af\u5883\u53d8\u91cf 1 \uff0c\u5176\u503c\u4e3aMarc\u5b89\u88c5\u76ee\u5f55\u4e0bPython\u5e93\u6587\u4ef6\u8def\u5f84 Lib \u3002 \u81f3\u6b64\uff0c\u7b2c\u4e00\u4e2a\u95ee\u9898\u89e3\u51b3\u3002","title":"ImportError:\u00a0No\u00a0module\u00a0named\u00a0os"},{"location":"2012-07-10-Marc%E8%B0%83%E7%94%A8Python%E8%84%9A%E6%9C%AC%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E4%BA%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/#_2","text":"\u6570\u636e\u6587\u4ef6\u7684\u76ee\u6807\u4f4d\u7f6e\u662f \\user_application\\data\\ \uff0c\u5b9e\u9645\u4e0a\u5374\u5b9a\u4f4d\u5411\u4e86\u9519\u8bef\u4f4d\u7f6e C:\\User\\data\\ \u3002\u8fd9\u662f\u56e0\u4e3a\u4e0a\u8ff0\u4ee3\u7801\u671f\u671b\u901a\u8fc7 os.getcwd() \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0c\u7136\u800c os.getcwd() \u83b7\u53d6\u7684\u662f\u5f53\u524d\u76ee\u5f55\u2014\u2014\u6b63\u5728\u8fd0\u884c\u7684Marc\u7a0b\u5e8f\u7684\u76ee\u5f55\uff0c\u800c\u4e0d\u662fMarc\u8c03\u7528\u7684\u811a\u672c\u7684\u76ee\u5f55 2 \u3002 \u89e3\u51b3\u65b9\u6848 \uff1a\u4f7f\u7528 sys.path[0] \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u6240\u5728\u8def\u5f84 3 \u3002 \u56e0\u6b64\uff0c\u4fee\u6b63\u540e\u4ee3\u7801\u4e3a\uff1a user_dir = os.path.dirname(sys.path[0]) # \u811a\u672c\u76ee\u5f55 data_dir = user_dir + \"\\\\data\\\\initial_data.txt\" Windows\u4e0b\u914d\u7f6ePython\u73af\u5883\u53d8\u91cf \u21a9 Python\u8bed\u8a00\u83b7\u53d6\u811a\u672c\u6587\u4ef6\u6240\u5728\u8def\u5f84 \u21a9 Python \u83b7\u53d6\u5f53\u524d\u811a\u672c\u6587\u4ef6\u8def\u5f84\u76ee\u5f55 \u21a9","title":"\u8bfb\u5165\u521d\u59cb\u6587\u4ef6\u5931\u8d25"},{"location":"2012-07-26-Windows%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4Marc%E8%AE%A1%E7%AE%97%E4%BB%BB%E5%8A%A1/","text":"Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1 \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-07-26 | \u5206\u7c7b\uff1a finite element analysis \u5b8c\u6210 Marc \u6709\u9650\u5143\u5efa\u6a21\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728 MENTAT \u4e2d\u6267\u884c\u8ba1\u7b97\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 run_marc \u5728\u547d\u4ee4\u884c\u63d0\u4ea4\u8ba1\u7b97\u4efb\u52a1\u3002 \u547d\u4ee4\u884c \u00b6 \u6253\u5f00\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u5207\u6362\u5230Marc\u8f93\u5165\u6587\u4ef6\u5982 example.dat \u6240\u5728\u76ee\u5f55\uff0c\u7136\u540e\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\u63d0\u4ea4\u8ba1\u7b97\uff1a run_marc -j example -b n \u7b2c\u4e00\u6b21\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u51fa\u73b0\u4ee5\u4e0b\u9519\u8bef\u63d0\u793a\uff1a '#for' \u4e0d\u662f\u5185\u90e8\u6216\u5916\u90e8\u547d\u4ee4\uff0c\u4e5f\u4e0d\u662f\u53ef\u8fd0\u884c\u7684\u7a0b\u5e8f\u6216\u6279\u5904\u7406\u6587\u4ef6\u3002 'getarch.bat' \u4e0d\u662f\u5185\u90e8\u6216\u5916\u90e8\u547d\u4ee4\uff0c\u4e5f\u4e0d\u662f\u53ef\u8fd0\u884c\u7684\u7a0b\u5e8f\u6216\u6279\u5904\u7406\u6587\u4ef6\u3002 error, program \\run_marc_read.exe which reads the command line options does not exist. \u89e3\u51b3\u65b9\u6848 1 \uff1a\u5728 marc2010\\tools \u76ee\u5f55\u4e2d\u627e\u5230 run_marc.bat \u6587\u4ef6\uff0c\u5c06\u7b2c\u4e09\u884c for %%i in (%0) do set DIRSCRIPT=%%~dpi \u4fee\u6539\u4e3a for %%i in (run_marc.bat) do set DIRSCRIPT=%%~dp$PATH:i \u53c2\u6570\u8bf4\u660e \u00b6 run_marc \u547d\u4ee4\u7684\u63a7\u5236\u53c2\u6570\u6709\uff1a run_marc -prog prog_name -jid job_name -rid rid_name -pid pid_name -sid sid_name -queue queue_name -user user_name -back back_value -ver verify_value -save save_value -vf view_name -def def_name -nprocd number_of_processors (for Single Input file runs, use -nps number_of_processors) -nthread number_of_threads -dir directory_where_job_is_processed -itree message_passing_type -host hostfile (for running over the network) -pq queue_priority -at date_time -comp compatible_machines_on_network -cpu time_limit -nsolver number of processors (MUMPS) -ml memory_limit -mode i4 -mpi intel-mpi \u4e00\u822c\u53ea\u9700\u6307\u5b9a\u51e0\u4e2a\u5e38\u7528\u53c2\u6570\u5373\u53ef\uff0c\u8be6\u7ec6\u8bf4\u660e\u53c2\u8003Marc2010\u5e2e\u52a9\u6587\u6863\uff1a\u300aVolume A: Theory and User Information\u300b\u3002 \u5b9e\u4f8b \u00b6 \u5355\u5904\u7406\u5668\u540e\u53f0\u8fd0\u884c\u4efb\u52a1 e2x1.dat \uff0c\u8981\u6c42 e2x1.dat \u5728\u5f53\u524d\u76ee\u5f55\u4e0b run_marc -jid e2x1 4\u5904\u7406\u5668\u524d\u53f0\u8fd0\u884c\u4efb\u52a1 e2x1.dat \uff0c\u5e76\u4f7f\u7528\u7528\u6237\u5b50\u7a0b\u5e8f u2x14.f \uff0c\u8ba1\u7b97\u5b8c\u6210\u540e\u5728\u76f8\u5e94\u76ee\u5f55\u4e0b\u521b\u5efa\u53ef\u6267\u884c\u6a21\u5757 u2x14.marc \u3002 run_marc -jid e2x14 -user u2x14 -sav y -b no -nprocd 4 run_marc\u540e\u51fa\u73b0getarch.bat\u4e0d\u662f\u5185\u90e8\u6216\u5916\u90e8\u547d\u4ee4\uff0c\u5982\u4f55\u89e3\u51b3\uff1f \u21a9","title":"Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1"},{"location":"2012-07-26-Windows%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4Marc%E8%AE%A1%E7%AE%97%E4%BB%BB%E5%8A%A1/#windowsmarc","text":"\u53d1\u5e03\u4e8e\uff1a2012-07-26 | \u5206\u7c7b\uff1a finite element analysis \u5b8c\u6210 Marc \u6709\u9650\u5143\u5efa\u6a21\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728 MENTAT \u4e2d\u6267\u884c\u8ba1\u7b97\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 run_marc \u5728\u547d\u4ee4\u884c\u63d0\u4ea4\u8ba1\u7b97\u4efb\u52a1\u3002","title":"Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1"},{"location":"2012-07-26-Windows%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4Marc%E8%AE%A1%E7%AE%97%E4%BB%BB%E5%8A%A1/#_1","text":"\u6253\u5f00\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u5207\u6362\u5230Marc\u8f93\u5165\u6587\u4ef6\u5982 example.dat \u6240\u5728\u76ee\u5f55\uff0c\u7136\u540e\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\u63d0\u4ea4\u8ba1\u7b97\uff1a run_marc -j example -b n \u7b2c\u4e00\u6b21\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u51fa\u73b0\u4ee5\u4e0b\u9519\u8bef\u63d0\u793a\uff1a '#for' \u4e0d\u662f\u5185\u90e8\u6216\u5916\u90e8\u547d\u4ee4\uff0c\u4e5f\u4e0d\u662f\u53ef\u8fd0\u884c\u7684\u7a0b\u5e8f\u6216\u6279\u5904\u7406\u6587\u4ef6\u3002 'getarch.bat' \u4e0d\u662f\u5185\u90e8\u6216\u5916\u90e8\u547d\u4ee4\uff0c\u4e5f\u4e0d\u662f\u53ef\u8fd0\u884c\u7684\u7a0b\u5e8f\u6216\u6279\u5904\u7406\u6587\u4ef6\u3002 error, program \\run_marc_read.exe which reads the command line options does not exist. \u89e3\u51b3\u65b9\u6848 1 \uff1a\u5728 marc2010\\tools \u76ee\u5f55\u4e2d\u627e\u5230 run_marc.bat \u6587\u4ef6\uff0c\u5c06\u7b2c\u4e09\u884c for %%i in (%0) do set DIRSCRIPT=%%~dpi \u4fee\u6539\u4e3a for %%i in (run_marc.bat) do set DIRSCRIPT=%%~dp$PATH:i","title":"\u547d\u4ee4\u884c"},{"location":"2012-07-26-Windows%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4Marc%E8%AE%A1%E7%AE%97%E4%BB%BB%E5%8A%A1/#_2","text":"run_marc \u547d\u4ee4\u7684\u63a7\u5236\u53c2\u6570\u6709\uff1a run_marc -prog prog_name -jid job_name -rid rid_name -pid pid_name -sid sid_name -queue queue_name -user user_name -back back_value -ver verify_value -save save_value -vf view_name -def def_name -nprocd number_of_processors (for Single Input file runs, use -nps number_of_processors) -nthread number_of_threads -dir directory_where_job_is_processed -itree message_passing_type -host hostfile (for running over the network) -pq queue_priority -at date_time -comp compatible_machines_on_network -cpu time_limit -nsolver number of processors (MUMPS) -ml memory_limit -mode i4 -mpi intel-mpi \u4e00\u822c\u53ea\u9700\u6307\u5b9a\u51e0\u4e2a\u5e38\u7528\u53c2\u6570\u5373\u53ef\uff0c\u8be6\u7ec6\u8bf4\u660e\u53c2\u8003Marc2010\u5e2e\u52a9\u6587\u6863\uff1a\u300aVolume A: Theory and User Information\u300b\u3002","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"2012-07-26-Windows%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4Marc%E8%AE%A1%E7%AE%97%E4%BB%BB%E5%8A%A1/#_3","text":"\u5355\u5904\u7406\u5668\u540e\u53f0\u8fd0\u884c\u4efb\u52a1 e2x1.dat \uff0c\u8981\u6c42 e2x1.dat \u5728\u5f53\u524d\u76ee\u5f55\u4e0b run_marc -jid e2x1 4\u5904\u7406\u5668\u524d\u53f0\u8fd0\u884c\u4efb\u52a1 e2x1.dat \uff0c\u5e76\u4f7f\u7528\u7528\u6237\u5b50\u7a0b\u5e8f u2x14.f \uff0c\u8ba1\u7b97\u5b8c\u6210\u540e\u5728\u76f8\u5e94\u76ee\u5f55\u4e0b\u521b\u5efa\u53ef\u6267\u884c\u6a21\u5757 u2x14.marc \u3002 run_marc -jid e2x14 -user u2x14 -sav y -b no -nprocd 4 run_marc\u540e\u51fa\u73b0getarch.bat\u4e0d\u662f\u5185\u90e8\u6216\u5916\u90e8\u547d\u4ee4\uff0c\u5982\u4f55\u89e3\u51b3\uff1f \u21a9","title":"\u5b9e\u4f8b"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/","text":"MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-07-27 | \u5206\u7c7b\uff1a finite element analysis \u5e76\u884c\u8ba1\u7b97\u53ef\u4ee5\u6709\u6548\u5229\u7528\u672c\u5730\u6216\u8005\u7f51\u7edc\u8ba1\u7b97\u673a\u8d44\u6e90\uff0c\u63d0\u9ad8\u8ba1\u7b97\u6548\u7387\uff0c\u7279\u522b\u662f\u9488\u5bf9\u4e00\u4e9b\u8ba1\u7b97\u89c4\u6a21\u8f83\u5927\u7684\u95ee\u9898\u3002\u672c\u6587\u793a\u4f8bMarc\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u3002 \u6d4b\u8bd5\u5e73\u53f0\uff1aWIN7 64Bit MARC2011 \u5f00\u542f\u5e76\u884c\u8ba1\u7b97 \u00b6 \u4ee5 \u7ba1\u7406\u5458\u6743\u9650 \u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u5728MARC\u5b89\u88c5\u8def\u5f84\u4e0b /intel/mpi/win64/bin \u6587\u4ef6\u5939\uff0832Bit\u8ba1\u7b97\u673a\u9009\u62e9 win32 \u6587\u4ef6\u5939\uff09\uff0c\u8fd0\u884c wmpiregister.exe \u3002 \u8f93\u5165Windows\u767b\u5f55\u7528\u6237\u540d(\u901a\u5e38\u4e3aadministrator)\u53ca\u5bc6\u7801\uff08\u82e5\u5bc6\u7801\u4e3a\u7a7a\uff0c\u9700\u8981\u91cd\u65b0\u8bbe\u7f6e\u4e00\u4e2a\u5bc6\u7801\uff09\uff0c\u70b9\u51fb register \u6309\u94ae\u3002\u51fa\u73b0\u5982\u4e0b\u4fe1\u606f\u8868\u793a\u8fd9\u4e00\u6b65\u987a\u5229\u5b8c\u6210\uff1a Password encrypted into the Registry \u8fd0\u884c ismpd.exe \uff0c\u6216\u8005\u5728\u547d\u4ee4\u884c\u8fd0\u884c ismpd -install \u3002 \u5206\u914d\u8ba1\u7b97\u5355\u5143 \u00b6 \u5355\u673a\u591a\u6838\u8ba1\u7b97\u63d0\u9ad8\u6548\u7387\u7684\u9014\u5f84\u5728\u4e8e\u51e0\u4e2a\u6838\u5fc3\u540c\u65f6\u8fdb\u884c\u8ba1\u7b97\uff0c\u56e0\u6b64\u5bf9\u4e00\u4e2a\u6a21\u578b\u5b8c\u6210\u6240\u6709\u7684\u5efa\u6a21\u540e\u9700\u8981\u4e3a\u53c2\u4e0e\u8ba1\u7b97\u7684\u591a\u6838\u5206\u914d\u8ba1\u7b97\u4efb\u52a1\uff08\u8f6f\u4ef6\u81ea\u52a8\u5206\u914d\u6216\u8005\u7528\u6237\u624b\u52a8\u5206\u914d\uff09\uff0c\u4e5f\u5c31\u662f\u5355\u5143\uff0c\u6700\u540e\u5728\u63d0\u4ea4\u4efb\u52a1\u524d\u63d0\u793a\u8f6f\u4ef6\u8fdb\u884c\u5e76\u884c\u8ba1\u7b97\u3002 Warning \u5e76\u884c\u8ba1\u7b97\u5e76\u975e\u9002\u7528\u4e8e\u4efb\u4f55\u5206\u6790\u573a\u5408\uff0c\u4f8b\u5982\u8bbe\u7f6e\u4e86\u5168\u5c40\u7f51\u683c\u81ea\u9002\u5e94\u5212\u5206\uff0c\u5219\u4e0d\u652f\u6301\u5e76\u884c\u8ba1\u7b97\u3002 \u6d4b\u8bd5\u7535\u8111\u4e3a\u53cc\u68384\u7ebf\u7a0b\uff0c\u8fd9\u91cc\u8bbe\u7f6e2\u6838\u8ba1\u7b97\u3002 \u81ea\u52a8\u5206\u914d\u5355\u5143 \u00b6 \u2460 Jobs -> User Domains \u8c03\u51fa\u9762\u677f \u2461 Generate! \u6309\u94ae\u8bbe\u7f6e\u53c2\u4e0e\u8ba1\u7b97\u7684CPU\u5185\u6838\u6570 \u2462 \u8f93\u5165\u5206\u914d\u7684\u5185\u6838\u65702\uff0c\u56de\u8f66\u786e\u5b9a \u2463 \u8f6f\u4ef6\u81ea\u52a8\u4e3a\u4e24\u4e2a\u5185\u6838\u5206\u914d\u5355\u5143\uff0c\u5e76\u8f93\u51fa\u5355\u5143\u6570\u4fe1\u606f \u2464 \u52fe\u9009 Identify \uff0c\u663e\u793a\u5355\u5143\u5206\u914d\u60c5\u51b5 \u624b\u52a8\u5206\u914d\u5355\u5143 \u00b6 \u2460 \u9009\u62e9 Manul Decomposition \uff0c\u51fa\u73b0\u624b\u52a8\u5206\u914d\u5355\u5143\u7684\u4e00\u4e9b\u547d\u4ee4\u6309\u94ae \u2461 Delete All \u5220\u9664\u4e4b\u524d\u81ea\u52a8\u5206\u914d\u60c5\u51b5 \u2462 Add Elements \u5206\u522b\u4e3a\u5185\u6838\u5206\u914d\u4e0d\u540c\u7684\u5355\u5143 \u63d0\u4ea4\u8ba1\u7b97 \u00b6 \u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u540e\uff0c\u52fe\u9009 Parallelization \u9009\u9879\u5373\u53ef\u8fdb\u884c\u5e76\u884c\u8ba1\u7b97\uff1a \u2460 Job\u2014>Show Menu \u8fdb\u5165 Job \u9762\u677f \u2461 Run \u547d\u4ee4\u8fdb\u5165 Run Job \u9762\u677f \u2462 \u70b9\u51fb Parallelization \u8fdb\u5165\u76f8\u5e94\u9762\u677f \u2463 \u52fe\u9009 Use DDM \u9009\u9879\uff0c\u5047\u5982\u4f7f\u7528\u7528\u6237\u5206\u914d\u7684\u5355\u5143\uff0c\u9009\u62e9 Decomposition In Mentat \u2464 \u70b9\u51fbOK\u56de\u5230 Run Job \u9762\u677f \u2465 \u70b9\u51fb Submit \u63d0\u4ea4\u4efb\u52a1\u8fdb\u884c\u5e76\u884c\u8ba1\u7b97 \u8fd0\u884c\u60c5\u51b5\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/#msc marc2011","text":"\u53d1\u5e03\u4e8e\uff1a2012-07-27 | \u5206\u7c7b\uff1a finite element analysis \u5e76\u884c\u8ba1\u7b97\u53ef\u4ee5\u6709\u6548\u5229\u7528\u672c\u5730\u6216\u8005\u7f51\u7edc\u8ba1\u7b97\u673a\u8d44\u6e90\uff0c\u63d0\u9ad8\u8ba1\u7b97\u6548\u7387\uff0c\u7279\u522b\u662f\u9488\u5bf9\u4e00\u4e9b\u8ba1\u7b97\u89c4\u6a21\u8f83\u5927\u7684\u95ee\u9898\u3002\u672c\u6587\u793a\u4f8bMarc\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u3002 \u6d4b\u8bd5\u5e73\u53f0\uff1aWIN7 64Bit MARC2011","title":"MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/#_1","text":"\u4ee5 \u7ba1\u7406\u5458\u6743\u9650 \u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a \u5728MARC\u5b89\u88c5\u8def\u5f84\u4e0b /intel/mpi/win64/bin \u6587\u4ef6\u5939\uff0832Bit\u8ba1\u7b97\u673a\u9009\u62e9 win32 \u6587\u4ef6\u5939\uff09\uff0c\u8fd0\u884c wmpiregister.exe \u3002 \u8f93\u5165Windows\u767b\u5f55\u7528\u6237\u540d(\u901a\u5e38\u4e3aadministrator)\u53ca\u5bc6\u7801\uff08\u82e5\u5bc6\u7801\u4e3a\u7a7a\uff0c\u9700\u8981\u91cd\u65b0\u8bbe\u7f6e\u4e00\u4e2a\u5bc6\u7801\uff09\uff0c\u70b9\u51fb register \u6309\u94ae\u3002\u51fa\u73b0\u5982\u4e0b\u4fe1\u606f\u8868\u793a\u8fd9\u4e00\u6b65\u987a\u5229\u5b8c\u6210\uff1a Password encrypted into the Registry \u8fd0\u884c ismpd.exe \uff0c\u6216\u8005\u5728\u547d\u4ee4\u884c\u8fd0\u884c ismpd -install \u3002","title":"\u5f00\u542f\u5e76\u884c\u8ba1\u7b97"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/#_2","text":"\u5355\u673a\u591a\u6838\u8ba1\u7b97\u63d0\u9ad8\u6548\u7387\u7684\u9014\u5f84\u5728\u4e8e\u51e0\u4e2a\u6838\u5fc3\u540c\u65f6\u8fdb\u884c\u8ba1\u7b97\uff0c\u56e0\u6b64\u5bf9\u4e00\u4e2a\u6a21\u578b\u5b8c\u6210\u6240\u6709\u7684\u5efa\u6a21\u540e\u9700\u8981\u4e3a\u53c2\u4e0e\u8ba1\u7b97\u7684\u591a\u6838\u5206\u914d\u8ba1\u7b97\u4efb\u52a1\uff08\u8f6f\u4ef6\u81ea\u52a8\u5206\u914d\u6216\u8005\u7528\u6237\u624b\u52a8\u5206\u914d\uff09\uff0c\u4e5f\u5c31\u662f\u5355\u5143\uff0c\u6700\u540e\u5728\u63d0\u4ea4\u4efb\u52a1\u524d\u63d0\u793a\u8f6f\u4ef6\u8fdb\u884c\u5e76\u884c\u8ba1\u7b97\u3002 Warning \u5e76\u884c\u8ba1\u7b97\u5e76\u975e\u9002\u7528\u4e8e\u4efb\u4f55\u5206\u6790\u573a\u5408\uff0c\u4f8b\u5982\u8bbe\u7f6e\u4e86\u5168\u5c40\u7f51\u683c\u81ea\u9002\u5e94\u5212\u5206\uff0c\u5219\u4e0d\u652f\u6301\u5e76\u884c\u8ba1\u7b97\u3002 \u6d4b\u8bd5\u7535\u8111\u4e3a\u53cc\u68384\u7ebf\u7a0b\uff0c\u8fd9\u91cc\u8bbe\u7f6e2\u6838\u8ba1\u7b97\u3002","title":"\u5206\u914d\u8ba1\u7b97\u5355\u5143"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/#_3","text":"\u2460 Jobs -> User Domains \u8c03\u51fa\u9762\u677f \u2461 Generate! \u6309\u94ae\u8bbe\u7f6e\u53c2\u4e0e\u8ba1\u7b97\u7684CPU\u5185\u6838\u6570 \u2462 \u8f93\u5165\u5206\u914d\u7684\u5185\u6838\u65702\uff0c\u56de\u8f66\u786e\u5b9a \u2463 \u8f6f\u4ef6\u81ea\u52a8\u4e3a\u4e24\u4e2a\u5185\u6838\u5206\u914d\u5355\u5143\uff0c\u5e76\u8f93\u51fa\u5355\u5143\u6570\u4fe1\u606f \u2464 \u52fe\u9009 Identify \uff0c\u663e\u793a\u5355\u5143\u5206\u914d\u60c5\u51b5","title":"\u81ea\u52a8\u5206\u914d\u5355\u5143"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/#_4","text":"\u2460 \u9009\u62e9 Manul Decomposition \uff0c\u51fa\u73b0\u624b\u52a8\u5206\u914d\u5355\u5143\u7684\u4e00\u4e9b\u547d\u4ee4\u6309\u94ae \u2461 Delete All \u5220\u9664\u4e4b\u524d\u81ea\u52a8\u5206\u914d\u60c5\u51b5 \u2462 Add Elements \u5206\u522b\u4e3a\u5185\u6838\u5206\u914d\u4e0d\u540c\u7684\u5355\u5143","title":"\u624b\u52a8\u5206\u914d\u5355\u5143"},{"location":"2012-07-27-MSC-Marc2011%E5%8D%95%E6%9C%BA%E5%A4%9A%E6%A0%B8%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B/#_5","text":"\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u540e\uff0c\u52fe\u9009 Parallelization \u9009\u9879\u5373\u53ef\u8fdb\u884c\u5e76\u884c\u8ba1\u7b97\uff1a \u2460 Job\u2014>Show Menu \u8fdb\u5165 Job \u9762\u677f \u2461 Run \u547d\u4ee4\u8fdb\u5165 Run Job \u9762\u677f \u2462 \u70b9\u51fb Parallelization \u8fdb\u5165\u76f8\u5e94\u9762\u677f \u2463 \u52fe\u9009 Use DDM \u9009\u9879\uff0c\u5047\u5982\u4f7f\u7528\u7528\u6237\u5206\u914d\u7684\u5355\u5143\uff0c\u9009\u62e9 Decomposition In Mentat \u2464 \u70b9\u51fbOK\u56de\u5230 Run Job \u9762\u677f \u2465 \u70b9\u51fb Submit \u63d0\u4ea4\u4efb\u52a1\u8fdb\u884c\u5e76\u884c\u8ba1\u7b97 \u8fd0\u884c\u60c5\u51b5\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u63d0\u4ea4\u8ba1\u7b97"},{"location":"2012-10-10-%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8EVS2005%E3%80%81Python%E7%A8%8B%E5%BA%8F%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E6%97%B6%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/","text":"\u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898 \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-10-10 | \u5206\u7c7b\uff1a finite element analysis \u6839\u636e\u9879\u76ee\u9700\u6c42\uff0c\u9700\u8981\u4ee5\u6587\u672c\u6587\u4ef6\u7684\u65b9\u5f0f\u5b9e\u73b0MFC\u7a0b\u5e8f\u4e0eMarc\u7a0b\u5e8f\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u6362\uff0c\u73b0\u5c06\u5176\u7b80\u5316\u4e3a\uff1a\u901a\u8fc7MFC\u7a0b\u5e8f\u9009\u62e9\u4e00\u4e2a\u76ee\u6807\u8def\u5f84\u5e76\u53e6\u5b58\u4e3a\u6587\u672c\u6587\u4ef6temp.txt\uff0c\u7136\u540e\u5728Mentat\u4e2d\u8c03\u7528python\u811a\u672c\u8bfb\u53d6\u8be5\u8def\u5f84\uff0c\u5b9e\u73b0\u5728\u8be5\u8def\u5f84\u4e0b\u4fdd\u5b58Marc\u6a21\u578b\u6587\u4ef6test.mud\u3002 MFC\u5199\u6587\u4ef6 \u00b6 \u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u5c06\u6587\u4ef6\u5bf9\u8bdd\u6846\u83b7\u53d6\u7684\u8def\u5f84\u5199\u5165 C:\\temp.txt \uff1a CFile file(_T(\"C:\\\\temp.txt\"), CFile::modeWrite|CFile::modeCreate|CFile::typeBinary); CString str = dlg->workPath; file.Write(str, str.GetLength()); file.Close(); \u4f46\u662f\uff0c\u4f7f\u7528\u8bb0\u4e8b\u672c\u6253\u5f00 C:\\temp.txt \u53d1\u73b0\u5b58\u5728\u4e24\u4e2a\u95ee\u9898\uff1a \u8def\u5f84\u4e0d\u5b8c\u6574\u2014\u2014\u8868\u660e\u5199\u5165\u7684\u5b57\u7b26\u6570\u4e0d\u6b63\u786e \u4e2d\u6587\u8def\u5f84\u51fa\u73b0\u4e71\u7801\u2014\u2014\u8868\u660e\u5b58\u5728\u7f16\u7801\u9519\u8bef\u3002 \u8fd9\u662f\u56e0\u4e3aVS2005\u9ed8\u8ba4\u4e3aUnicode\u7f16\u7801\uff0c\u6839\u636eUnicode\u7f16\u7801\u89c4\u5219\uff0c GetLength() \u83b7\u5f97\u957f\u5ea6\u5b9e\u9645\u4e3aCString\u7684\u4e00\u534a\uff0c\u4e8e\u662f\u51fa\u73b0\u8def\u5f84\u4e0d\u5b8c\u6574\u7684\u9519\u8bef\uff1b\u800c\u8bb0\u4e8b\u672c\u9ed8\u8ba4\u4e3aANSI\u7f16\u7801\u683c\u5f0f\uff0c\u4e8e\u662f\u51fa\u73b0\u4e71\u7801\u3002 \u76f8\u5e94\u5bf9\u7b56\u4e3a\uff1a \u4eba\u4e3a\u5730\uff0c\u5c06\u5199\u5165\u5b57\u7b26\u6570\u4e58\u4ee52 file.Write(str, 2*str.GetLength()) \u91c7\u7528Unicode\u7684\u89e3\u7801\u683c\u5f0f\u3002\u5b9e\u9645\u4e0a\u5df2\u7ecf\u91c7\u7528Unicode\u683c\u5f0f\u5b58\u50a8\uff0c\u663e\u793a\u4e71\u7801\u4e0e\u5426\u53ea\u662f\u7f16\u8f91\u5668\u89e3\u7801\u7684\u95ee\u9898\uff0c\u4e0d\u5f71\u54cd\u7a0b\u5e8f\u6570\u636e\u4ea4\u6362\u3002 \u6539\u8fdb\u540e\uff0c\u5728 Sublime Text \u4ee5 UTF-16 le \u7f16\u7801\u683c\u5f0f\u6253\u5f00 C:\\temp.txt \uff0c\u53d1\u73b0\u4e00\u5207\u6b63\u5e38\u3002 Python\u8bfb\u6587\u4ef6 \u00b6 \u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u8bfb\u53d6 C:\\temp.txt \u4e2d\u7684\u76ee\u6807\u8def\u5f84\uff1a from py_mentat import * import codecs # main function def main(): f = codecs.open(\"C:\\\\temp.txt\",\"rb\") s = f.readline() x = s + \"\\\\test.mud\" print s # output test py_send(\"*save_as_model \" + x + \" yes\") \u53ef\u662f\uff0c\u5728Mentat\u4e2d\u8c03\u7528python\u811a\u672c\u62a5\u9519\uff0c\u89c2\u5bdf print s \u7684\u7ed3\u679c\u53d1\u73b0\u76ee\u6807\u8def\u5f84\u7684\u8f93\u51fa\u662f\u4e71\u7801\u3002\u8054\u60f3\u5230\u6b64\u524d temp.txt \u6587\u4ef6\u4e3a Unicode 16 le \u7f16\u7801\u683c\u5f0f\uff0c\u5219\u5e94\u5f53\u4ee5\u6b64\u79cd\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6\uff0c\u4e8e\u662f\u4fee\u6539\u4e3a f = codecs.open(\"C:\\\\temp.txt\", \"rb\", \"utf_16_le\") \u8fd9\u6b21\u76ee\u6807\u4f4d\u7f6e\u663e\u793a\u6b63\u786e\uff0c\u4f46\u662f\u4f9d\u65e7\u5b58\u5728\u9519\u8bef 1 \uff1a UnicodeEncodeError: 'ascii' codec can't encode characters in position 31-34: ordinal not in range(128) \u6839\u636e\u9519\u8bef\u4fe1\u606f\u53ef\u77e5\uff1a\u53d8\u91cf x \u7684\u7c7b\u578b\u4e3aunicode\uff0c\u800c py_send(\"*save_as_model \" + x +\" yes\") \u5904\u7406\u7684\u662fstr\u7c7b\u578b\uff0c\u8fd9\u5c31\u5b58\u5728\u4e00\u4e2a\u7f16\u7801\u8fc7\u7a0b\u2014\u2014\u5c06unicode\u4ee5\u67d0\u79cd\u89c4\u5219\u7f16\u7801\u4e3astr\u3002\u800c\u9ed8\u8ba4\u7684 ascii \u7f16\u7801\u683c\u5f0f\u4e0d\u8db3\u4ee5\u80dc\u4efb\u3002 \u89e3\u51b3\u65b9\u6cd5\u4e3a\u589e\u52a0\u7f16\u7801\u89c4\u5219 2 3 4 \uff0c\u7531\u4e8e\u9700\u8981\u5904\u7406\u4e2d\u6587\u7f16\u7801\uff0c\u6700\u597d\u91c7\u7528 gbk \u7f16\u7801\u65b9\u5f0f\uff0c\u76f8\u5e94\u8bed\u53e5\u6539\u4e3a\uff1a x = s.encode(\"gbk\") + '\\\\test.mud' \u81f3\u6b64\u5b8c\u5168\u5b9e\u73b0\u9884\u671f\u7ed3\u679c\u3002 \u66f4\u597d\u7684\u65b9\u6848 \u00b6 \u7ecf\u5386\u4ee5\u4e0a\u8fc7\u7a0b\u60f3\u5fc5\u5bf9\u5b57\u7b26\u7f16\u7801\u3001\u89e3\u7801\u95ee\u9898\u6709\u6240\u4f53\u4f1a\u4e86\u3002\u56de\u5230\u6e90\u5934\uff0c\u95ee\u9898\u7684\u6839\u6e90\u5728\u4e8eVS2005\u9ed8\u8ba4\u91c7\u7528\u7684 unicode \u7f16\u7801\u65b9\u5f0f\u3002\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u4fee\u6539\u5176\u7f16\u7801\u65b9\u5f0f\u4e3a \u591a\u5b57\u8282\u5b57\u7b26\u96c6\uff08multi-byte character\uff09 5 6 \uff0c\u8fd9\u6837\u4ee5 ANSI \u7f16\u7801\u65b9\u5f0f\u4fdd\u5b58\u6587\u4ef6\u3002 \u5982\u6b64\u4e00\u6765\uff0c\u4e4b\u524d\u7684\u95ee\u9898\u4e0d\u590d\u5b58\u5728\uff1a \u53ef\u4ee5\u76f4\u63a5\u91c7\u7528 file.Write(str,str.GetLength()) \u5199\u6587\u4ef6 \u7528\u8bb0\u4e8b\u672c\u6253\u5f00\u65f6\u4e0d\u4f1a\u663e\u793a\u4e71\u7801 Python\u53ef\u4ee5\u6309\u5e38\u89c4\u65b9\u5f0f\u8bfb\u5199ANSI\u7f16\u7801\u683c\u5f0f\u6587\u4ef6 from py_mentat import * # main function def main(): f = open(\"C:\\\\temp.txt\",\"rb\") s = f.readline() x = s + \"\\\\test.mud\" py_send(\"*save_as_model \" + x + \" yes\") python\u65b0\u624b\u5fc5\u78b0\u5230\u7684\u95ee\u9898---encode\u4e0edecode\uff0c\u4e2d\u6587\u4e71\u7801[\u8f6c] \u21a9 python\u7684str\uff0cunicode\u5bf9\u8c61\u7684encode\u548cdecode\u65b9\u6cd5\uff08\u8f6c\uff09 \u21a9 [\u8f6c]Python\u3001Unicode\u548c\u4e2d\u6587 \u21a9 Python\u5b57\u7b26\u96c6\u7f16\u7801\u548c\u6587\u4ef6\u8bfb\u5199 \u21a9 \u8f6c\uff1aMulti-Byte Character Set & Use Unicode Character Set \u21a9 unicode character multi-byte character\u7f16\u7801 \u21a9","title":"\u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898"},{"location":"2012-10-10-%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8EVS2005%E3%80%81Python%E7%A8%8B%E5%BA%8F%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E6%97%B6%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/#vs2005python","text":"\u53d1\u5e03\u4e8e\uff1a2012-10-10 | \u5206\u7c7b\uff1a finite element analysis \u6839\u636e\u9879\u76ee\u9700\u6c42\uff0c\u9700\u8981\u4ee5\u6587\u672c\u6587\u4ef6\u7684\u65b9\u5f0f\u5b9e\u73b0MFC\u7a0b\u5e8f\u4e0eMarc\u7a0b\u5e8f\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u6362\uff0c\u73b0\u5c06\u5176\u7b80\u5316\u4e3a\uff1a\u901a\u8fc7MFC\u7a0b\u5e8f\u9009\u62e9\u4e00\u4e2a\u76ee\u6807\u8def\u5f84\u5e76\u53e6\u5b58\u4e3a\u6587\u672c\u6587\u4ef6temp.txt\uff0c\u7136\u540e\u5728Mentat\u4e2d\u8c03\u7528python\u811a\u672c\u8bfb\u53d6\u8be5\u8def\u5f84\uff0c\u5b9e\u73b0\u5728\u8be5\u8def\u5f84\u4e0b\u4fdd\u5b58Marc\u6a21\u578b\u6587\u4ef6test.mud\u3002","title":"\u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898"},{"location":"2012-10-10-%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8EVS2005%E3%80%81Python%E7%A8%8B%E5%BA%8F%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E6%97%B6%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/#mfc","text":"\u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u5c06\u6587\u4ef6\u5bf9\u8bdd\u6846\u83b7\u53d6\u7684\u8def\u5f84\u5199\u5165 C:\\temp.txt \uff1a CFile file(_T(\"C:\\\\temp.txt\"), CFile::modeWrite|CFile::modeCreate|CFile::typeBinary); CString str = dlg->workPath; file.Write(str, str.GetLength()); file.Close(); \u4f46\u662f\uff0c\u4f7f\u7528\u8bb0\u4e8b\u672c\u6253\u5f00 C:\\temp.txt \u53d1\u73b0\u5b58\u5728\u4e24\u4e2a\u95ee\u9898\uff1a \u8def\u5f84\u4e0d\u5b8c\u6574\u2014\u2014\u8868\u660e\u5199\u5165\u7684\u5b57\u7b26\u6570\u4e0d\u6b63\u786e \u4e2d\u6587\u8def\u5f84\u51fa\u73b0\u4e71\u7801\u2014\u2014\u8868\u660e\u5b58\u5728\u7f16\u7801\u9519\u8bef\u3002 \u8fd9\u662f\u56e0\u4e3aVS2005\u9ed8\u8ba4\u4e3aUnicode\u7f16\u7801\uff0c\u6839\u636eUnicode\u7f16\u7801\u89c4\u5219\uff0c GetLength() \u83b7\u5f97\u957f\u5ea6\u5b9e\u9645\u4e3aCString\u7684\u4e00\u534a\uff0c\u4e8e\u662f\u51fa\u73b0\u8def\u5f84\u4e0d\u5b8c\u6574\u7684\u9519\u8bef\uff1b\u800c\u8bb0\u4e8b\u672c\u9ed8\u8ba4\u4e3aANSI\u7f16\u7801\u683c\u5f0f\uff0c\u4e8e\u662f\u51fa\u73b0\u4e71\u7801\u3002 \u76f8\u5e94\u5bf9\u7b56\u4e3a\uff1a \u4eba\u4e3a\u5730\uff0c\u5c06\u5199\u5165\u5b57\u7b26\u6570\u4e58\u4ee52 file.Write(str, 2*str.GetLength()) \u91c7\u7528Unicode\u7684\u89e3\u7801\u683c\u5f0f\u3002\u5b9e\u9645\u4e0a\u5df2\u7ecf\u91c7\u7528Unicode\u683c\u5f0f\u5b58\u50a8\uff0c\u663e\u793a\u4e71\u7801\u4e0e\u5426\u53ea\u662f\u7f16\u8f91\u5668\u89e3\u7801\u7684\u95ee\u9898\uff0c\u4e0d\u5f71\u54cd\u7a0b\u5e8f\u6570\u636e\u4ea4\u6362\u3002 \u6539\u8fdb\u540e\uff0c\u5728 Sublime Text \u4ee5 UTF-16 le \u7f16\u7801\u683c\u5f0f\u6253\u5f00 C:\\temp.txt \uff0c\u53d1\u73b0\u4e00\u5207\u6b63\u5e38\u3002","title":"MFC\u5199\u6587\u4ef6"},{"location":"2012-10-10-%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8EVS2005%E3%80%81Python%E7%A8%8B%E5%BA%8F%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E6%97%B6%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/#python","text":"\u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u8bfb\u53d6 C:\\temp.txt \u4e2d\u7684\u76ee\u6807\u8def\u5f84\uff1a from py_mentat import * import codecs # main function def main(): f = codecs.open(\"C:\\\\temp.txt\",\"rb\") s = f.readline() x = s + \"\\\\test.mud\" print s # output test py_send(\"*save_as_model \" + x + \" yes\") \u53ef\u662f\uff0c\u5728Mentat\u4e2d\u8c03\u7528python\u811a\u672c\u62a5\u9519\uff0c\u89c2\u5bdf print s \u7684\u7ed3\u679c\u53d1\u73b0\u76ee\u6807\u8def\u5f84\u7684\u8f93\u51fa\u662f\u4e71\u7801\u3002\u8054\u60f3\u5230\u6b64\u524d temp.txt \u6587\u4ef6\u4e3a Unicode 16 le \u7f16\u7801\u683c\u5f0f\uff0c\u5219\u5e94\u5f53\u4ee5\u6b64\u79cd\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6\uff0c\u4e8e\u662f\u4fee\u6539\u4e3a f = codecs.open(\"C:\\\\temp.txt\", \"rb\", \"utf_16_le\") \u8fd9\u6b21\u76ee\u6807\u4f4d\u7f6e\u663e\u793a\u6b63\u786e\uff0c\u4f46\u662f\u4f9d\u65e7\u5b58\u5728\u9519\u8bef 1 \uff1a UnicodeEncodeError: 'ascii' codec can't encode characters in position 31-34: ordinal not in range(128) \u6839\u636e\u9519\u8bef\u4fe1\u606f\u53ef\u77e5\uff1a\u53d8\u91cf x \u7684\u7c7b\u578b\u4e3aunicode\uff0c\u800c py_send(\"*save_as_model \" + x +\" yes\") \u5904\u7406\u7684\u662fstr\u7c7b\u578b\uff0c\u8fd9\u5c31\u5b58\u5728\u4e00\u4e2a\u7f16\u7801\u8fc7\u7a0b\u2014\u2014\u5c06unicode\u4ee5\u67d0\u79cd\u89c4\u5219\u7f16\u7801\u4e3astr\u3002\u800c\u9ed8\u8ba4\u7684 ascii \u7f16\u7801\u683c\u5f0f\u4e0d\u8db3\u4ee5\u80dc\u4efb\u3002 \u89e3\u51b3\u65b9\u6cd5\u4e3a\u589e\u52a0\u7f16\u7801\u89c4\u5219 2 3 4 \uff0c\u7531\u4e8e\u9700\u8981\u5904\u7406\u4e2d\u6587\u7f16\u7801\uff0c\u6700\u597d\u91c7\u7528 gbk \u7f16\u7801\u65b9\u5f0f\uff0c\u76f8\u5e94\u8bed\u53e5\u6539\u4e3a\uff1a x = s.encode(\"gbk\") + '\\\\test.mud' \u81f3\u6b64\u5b8c\u5168\u5b9e\u73b0\u9884\u671f\u7ed3\u679c\u3002","title":"Python\u8bfb\u6587\u4ef6"},{"location":"2012-10-10-%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8EVS2005%E3%80%81Python%E7%A8%8B%E5%BA%8F%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E6%97%B6%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/#_1","text":"\u7ecf\u5386\u4ee5\u4e0a\u8fc7\u7a0b\u60f3\u5fc5\u5bf9\u5b57\u7b26\u7f16\u7801\u3001\u89e3\u7801\u95ee\u9898\u6709\u6240\u4f53\u4f1a\u4e86\u3002\u56de\u5230\u6e90\u5934\uff0c\u95ee\u9898\u7684\u6839\u6e90\u5728\u4e8eVS2005\u9ed8\u8ba4\u91c7\u7528\u7684 unicode \u7f16\u7801\u65b9\u5f0f\u3002\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u4fee\u6539\u5176\u7f16\u7801\u65b9\u5f0f\u4e3a \u591a\u5b57\u8282\u5b57\u7b26\u96c6\uff08multi-byte character\uff09 5 6 \uff0c\u8fd9\u6837\u4ee5 ANSI \u7f16\u7801\u65b9\u5f0f\u4fdd\u5b58\u6587\u4ef6\u3002 \u5982\u6b64\u4e00\u6765\uff0c\u4e4b\u524d\u7684\u95ee\u9898\u4e0d\u590d\u5b58\u5728\uff1a \u53ef\u4ee5\u76f4\u63a5\u91c7\u7528 file.Write(str,str.GetLength()) \u5199\u6587\u4ef6 \u7528\u8bb0\u4e8b\u672c\u6253\u5f00\u65f6\u4e0d\u4f1a\u663e\u793a\u4e71\u7801 Python\u53ef\u4ee5\u6309\u5e38\u89c4\u65b9\u5f0f\u8bfb\u5199ANSI\u7f16\u7801\u683c\u5f0f\u6587\u4ef6 from py_mentat import * # main function def main(): f = open(\"C:\\\\temp.txt\",\"rb\") s = f.readline() x = s + \"\\\\test.mud\" py_send(\"*save_as_model \" + x + \" yes\") python\u65b0\u624b\u5fc5\u78b0\u5230\u7684\u95ee\u9898---encode\u4e0edecode\uff0c\u4e2d\u6587\u4e71\u7801[\u8f6c] \u21a9 python\u7684str\uff0cunicode\u5bf9\u8c61\u7684encode\u548cdecode\u65b9\u6cd5\uff08\u8f6c\uff09 \u21a9 [\u8f6c]Python\u3001Unicode\u548c\u4e2d\u6587 \u21a9 Python\u5b57\u7b26\u96c6\u7f16\u7801\u548c\u6587\u4ef6\u8bfb\u5199 \u21a9 \u8f6c\uff1aMulti-Byte Character Set & Use Unicode Character Set \u21a9 unicode character multi-byte character\u7f16\u7801 \u21a9","title":"\u66f4\u597d\u7684\u65b9\u6848"},{"location":"2012-10-18-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F/","text":"MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-10-18 | \u5206\u7c7b\uff1a finite element analysis Marc\u4e2d\u6750\u6599\u5c5e\u6027\u3001\u8fb9\u754c\u6761\u4ef6\u3001\u63a5\u89e6\u6761\u4ef6\u7684\u521a\u4f53\u8fd0\u52a8\u63a7\u5236\u90e8\u5206\u90fd\u4f1a\u7528\u5230\u8868\u683c\u66f2\u7ebf Table \u3002\u4e00\u4e2a\u8868\u683c\u6700\u591a\u67094\u4e2a\u81ea\u53d8\u91cf\uff08v1,v2,v3,v4\uff09\uff0c\u81ea\u53d8\u91cf\u7c7b\u578b\u4e3b\u8981\u6709\u65f6\u95f4\u3001\u6e29\u5ea6\u3001\u7b49\u6548\u5e94\u53d8\u3001\u5750\u6807\u7b49\uff0c\u53ef\u4ee5\u6ee1\u8db3\u7edd\u5927\u90e8\u5206\u9700\u6c42\u3002\u56e0\u6b64\uff0cTable\u7684\u7075\u6d3b\u8fd0\u7528\u53ef\u4ee5\u6ee1\u8db3\u5404\u79cd\u7279\u5b9a\u5de5\u51b5\u6a21\u62df\u7684\u9700\u8981\u3002 \u672c\u6587\u662fMsc.marc 2010\u8868\u683c\u4ecb\u7ecd\u7684\u7b2c\u4e00\u90e8\u5206\u2014\u2014\u521b\u5efa\u65b9\u6cd5\uff0c\u901a\u5e38\u6709\u4e24\u79cd\u521b\u5efa\u8868\u683c\u66f2\u7ebf\u7684\u65b9\u5f0f\uff1a DATA POINTS \u65b9\u5f0f\u2014\u2014\u76f4\u63a5\u8f93\u5165\u6570\u636e\u70b9\u7684\u5750\u6807\uff0c\u5f53\u6570\u636e\u91cf\u8f83\u5927\u65f6\u53ef\u4ee5\u901a\u8fc7 READ \u547d\u4ee4\u5bfc\u5165 FORMULA \u65b9\u5f0f\u2014\u2014\u901a\u8fc7\u66f2\u7ebf\u65b9\u7a0b\u5efa\u7acb\u66f2\u7ebf \u672c\u6587\u7740\u91cd\u4ecb\u7ecd\u4f7f\u7528 FORMULA \u65b9\u5f0f\u521b\u5efa\u8868\u683c\u7684\u4e00\u4e9b\u77e5\u8bc6\u70b9 1 \u3002 \u5e38\u91cf \u00b6 \u7b26\u53f7 \u542b\u4e49 pi \u03c0 e exponent tz offset temperature entered via the PARAMETERS model definition option q Activation energy entered via MATERIAL DATA model definition option r Universal gas constant entered via the PARAMETERS model definition option sb Stefan Boltzman constant entered via the PARAMETERS model definition option Note v1 , v2 , v3 , v4 \u5206\u522b\u4ee3\u8868\u76f8\u5e94\u7684\u81ea\u53d8\u91cf\u3002 \u6570\u5b66\u8fd0\u7b97\u7b26 \u00b6 \u7b26\u53f7 \u542b\u4e49 + addition - subtraction * multiplication / division ^ exponential ! factor % mod \u6570\u5b66\u51fd\u6570 \u00b6 \u51fd\u6570\u540d \u542b\u4e49 \u8bf4\u660e dcos cosine (x) x in radians dsin sine (x) x in radians dtan tangent (x) x in radians dacos inverse cosine (x) f in radians dasin inverse sine (x) f in radians datan inverse tangent (x) f in radians datan2 inverse tangent (x,y) f in radians \u51fd\u6570\u540d \u542b\u4e49 \u8bf4\u660e cos cosine (x) x in degrees sin sine (x) x in degrees tan tangent (x) x in degrees acos inverse cosine (x) f in degrees asin inverse sine (x) f in degrees atan inverse tangent (x) f in degrees atan2 inverse tangent (x,y) f in degrees \u51fd\u6570\u540d \u542b\u4e49 cosh hyperbolic cosine sinh hyperbolic sine tanh hyperbolic tangent acosh inverse hyperbolic cosine asinh inverse hyperbolic sine atanh inverse hyperbolic tangent \u51fd\u6570\u540d \u542b\u4e49 log log based 10 ln natural log exp exponent sqrt square root rad convert degrees to radians deg convert radians to degrees abs obtain absolute value int truncates the value to whole frac take the fractional value max takes the maximal value min takes the minimal value mod return the remainder of x, based on y mod(x,y) = x - y * int (x/y) \u5b9e\u4f8b\u8bf4\u660e \u00b6 \u5047\u8bbe\u67d0\u521a\u4f53\u8fd0\u52a8\u7684\u901f\u5ea6-\u65f6\u95f4\u66f2\u7ebf\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5ef6\u7eed\u5468\u671f\u6570\u4e3a100\u3002 \u867d\u7136\u4e00\u4e2a\u5468\u671f\u5185\u7684\u66f2\u7ebf\u6bd4\u8f83\u7b80\u5355\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\uff1b\u4f46\u662f\u7531\u4e8e\u5468\u671f\u6570\u592a\u591a\uff0c\u624b\u52a8\u8f93\u5165\u6bd4\u8f83\u9ebb\u70e6\uff0c\u56e0\u6b64\u8003\u8651\u91c7\u7528\u51fd\u6570\u8f93\u5165\u7684\u65b9\u5f0f\u3002 \u8be5\u66f2\u7ebf\u65e0\u6cd5\u7528\u4e00\u4e2a\u521d\u7b49\u51fd\u6570\u89e3\u6790\u8868\u8fbe\uff0c\u4f46\u89c2\u5bdf\u53d1\u73b0\uff1a\u4e00\u4e2a\u5468\u671f\u5185\u53ea\u6709 t=3 \u8fd9\u4e00\u4e2a\u70b9\u7684\u51fd\u6570\u503c\u7b49\u4e8e1\uff0c\u56e0\u6b64\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5468\u671f\u7684 t=0,1,2,3 \u53ef\u4ee5\u7528 max(v1-2, 0) \u5b9e\u73b0\uff1b\u5176\u4ed6\u5468\u671f\u5219\u901a\u8fc7 v1%4 \u8f6c\u6362\u5230\u7b2c\u4e00\u5468\u671f\u5185\uff0c\u4e8e\u662f\u8868\u8fbe\u5f0f\u4e3a\uff1a max(v1%4-2,0) \u7406\u8bba\u4e0a\u5e94\u5f53\u5b9e\u73b0\u4e86\uff0c\u53ef\u662f\u5728\u8f93\u5165\u8fc7\u7a0b\u4e2d\u53d1\u73b0\uff0cMarc\u81ea\u52a8\u5c06 max \u8f6c\u6362\u4e3a mav1 \u4e86\uff0c\u4ece\u800c\u5bfc\u81f4\u516c\u5f0f\u8f93\u5165\u9519\u8bef\u3002\u8fd9\u8c8c\u4f3c\u662f\u4e00\u4e2aBUG\u3002\u731c\u6d4b\u539f\u56e0\u4e3a\uff1a\u516c\u5f0f\u63a5\u53d7\u7684\u81ea\u53d8\u91cf\u4e3a v1 \uff0c\u56e0\u6b64marc\u9ed8\u8ba4\u5c06\u53ef\u80fd\u8bef\u8f93\u5165\u7684\u5b57\u7b26 x \u8f6c\u6362\u4e3a v1 \u3002 \u65e2\u7136 max() \u51fd\u6570\u6709\u95ee\u9898\uff0c\u90a3\u5c31\u4f7f\u7528 min() \u51fd\u6570\u6309\u7167\u540c\u6837\u7684\u601d\u8def\u5b9e\u73b0\u5373\u53ef\uff1a -min(2-v1%4,0) Marc\u00ae 2010 Volume A: Theory and User Information \u21a9","title":"MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f"},{"location":"2012-10-18-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F/#mscmarc 2010","text":"\u53d1\u5e03\u4e8e\uff1a2012-10-18 | \u5206\u7c7b\uff1a finite element analysis Marc\u4e2d\u6750\u6599\u5c5e\u6027\u3001\u8fb9\u754c\u6761\u4ef6\u3001\u63a5\u89e6\u6761\u4ef6\u7684\u521a\u4f53\u8fd0\u52a8\u63a7\u5236\u90e8\u5206\u90fd\u4f1a\u7528\u5230\u8868\u683c\u66f2\u7ebf Table \u3002\u4e00\u4e2a\u8868\u683c\u6700\u591a\u67094\u4e2a\u81ea\u53d8\u91cf\uff08v1,v2,v3,v4\uff09\uff0c\u81ea\u53d8\u91cf\u7c7b\u578b\u4e3b\u8981\u6709\u65f6\u95f4\u3001\u6e29\u5ea6\u3001\u7b49\u6548\u5e94\u53d8\u3001\u5750\u6807\u7b49\uff0c\u53ef\u4ee5\u6ee1\u8db3\u7edd\u5927\u90e8\u5206\u9700\u6c42\u3002\u56e0\u6b64\uff0cTable\u7684\u7075\u6d3b\u8fd0\u7528\u53ef\u4ee5\u6ee1\u8db3\u5404\u79cd\u7279\u5b9a\u5de5\u51b5\u6a21\u62df\u7684\u9700\u8981\u3002 \u672c\u6587\u662fMsc.marc 2010\u8868\u683c\u4ecb\u7ecd\u7684\u7b2c\u4e00\u90e8\u5206\u2014\u2014\u521b\u5efa\u65b9\u6cd5\uff0c\u901a\u5e38\u6709\u4e24\u79cd\u521b\u5efa\u8868\u683c\u66f2\u7ebf\u7684\u65b9\u5f0f\uff1a DATA POINTS \u65b9\u5f0f\u2014\u2014\u76f4\u63a5\u8f93\u5165\u6570\u636e\u70b9\u7684\u5750\u6807\uff0c\u5f53\u6570\u636e\u91cf\u8f83\u5927\u65f6\u53ef\u4ee5\u901a\u8fc7 READ \u547d\u4ee4\u5bfc\u5165 FORMULA \u65b9\u5f0f\u2014\u2014\u901a\u8fc7\u66f2\u7ebf\u65b9\u7a0b\u5efa\u7acb\u66f2\u7ebf \u672c\u6587\u7740\u91cd\u4ecb\u7ecd\u4f7f\u7528 FORMULA \u65b9\u5f0f\u521b\u5efa\u8868\u683c\u7684\u4e00\u4e9b\u77e5\u8bc6\u70b9 1 \u3002","title":"MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f"},{"location":"2012-10-18-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F/#_1","text":"\u7b26\u53f7 \u542b\u4e49 pi \u03c0 e exponent tz offset temperature entered via the PARAMETERS model definition option q Activation energy entered via MATERIAL DATA model definition option r Universal gas constant entered via the PARAMETERS model definition option sb Stefan Boltzman constant entered via the PARAMETERS model definition option Note v1 , v2 , v3 , v4 \u5206\u522b\u4ee3\u8868\u76f8\u5e94\u7684\u81ea\u53d8\u91cf\u3002","title":"\u5e38\u91cf"},{"location":"2012-10-18-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F/#_2","text":"\u7b26\u53f7 \u542b\u4e49 + addition - subtraction * multiplication / division ^ exponential ! factor % mod","title":"\u6570\u5b66\u8fd0\u7b97\u7b26"},{"location":"2012-10-18-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F/#_3","text":"\u51fd\u6570\u540d \u542b\u4e49 \u8bf4\u660e dcos cosine (x) x in radians dsin sine (x) x in radians dtan tangent (x) x in radians dacos inverse cosine (x) f in radians dasin inverse sine (x) f in radians datan inverse tangent (x) f in radians datan2 inverse tangent (x,y) f in radians \u51fd\u6570\u540d \u542b\u4e49 \u8bf4\u660e cos cosine (x) x in degrees sin sine (x) x in degrees tan tangent (x) x in degrees acos inverse cosine (x) f in degrees asin inverse sine (x) f in degrees atan inverse tangent (x) f in degrees atan2 inverse tangent (x,y) f in degrees \u51fd\u6570\u540d \u542b\u4e49 cosh hyperbolic cosine sinh hyperbolic sine tanh hyperbolic tangent acosh inverse hyperbolic cosine asinh inverse hyperbolic sine atanh inverse hyperbolic tangent \u51fd\u6570\u540d \u542b\u4e49 log log based 10 ln natural log exp exponent sqrt square root rad convert degrees to radians deg convert radians to degrees abs obtain absolute value int truncates the value to whole frac take the fractional value max takes the maximal value min takes the minimal value mod return the remainder of x, based on y mod(x,y) = x - y * int (x/y)","title":"\u6570\u5b66\u51fd\u6570"},{"location":"2012-10-18-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F/#_4","text":"\u5047\u8bbe\u67d0\u521a\u4f53\u8fd0\u52a8\u7684\u901f\u5ea6-\u65f6\u95f4\u66f2\u7ebf\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5ef6\u7eed\u5468\u671f\u6570\u4e3a100\u3002 \u867d\u7136\u4e00\u4e2a\u5468\u671f\u5185\u7684\u66f2\u7ebf\u6bd4\u8f83\u7b80\u5355\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\uff1b\u4f46\u662f\u7531\u4e8e\u5468\u671f\u6570\u592a\u591a\uff0c\u624b\u52a8\u8f93\u5165\u6bd4\u8f83\u9ebb\u70e6\uff0c\u56e0\u6b64\u8003\u8651\u91c7\u7528\u51fd\u6570\u8f93\u5165\u7684\u65b9\u5f0f\u3002 \u8be5\u66f2\u7ebf\u65e0\u6cd5\u7528\u4e00\u4e2a\u521d\u7b49\u51fd\u6570\u89e3\u6790\u8868\u8fbe\uff0c\u4f46\u89c2\u5bdf\u53d1\u73b0\uff1a\u4e00\u4e2a\u5468\u671f\u5185\u53ea\u6709 t=3 \u8fd9\u4e00\u4e2a\u70b9\u7684\u51fd\u6570\u503c\u7b49\u4e8e1\uff0c\u56e0\u6b64\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5468\u671f\u7684 t=0,1,2,3 \u53ef\u4ee5\u7528 max(v1-2, 0) \u5b9e\u73b0\uff1b\u5176\u4ed6\u5468\u671f\u5219\u901a\u8fc7 v1%4 \u8f6c\u6362\u5230\u7b2c\u4e00\u5468\u671f\u5185\uff0c\u4e8e\u662f\u8868\u8fbe\u5f0f\u4e3a\uff1a max(v1%4-2,0) \u7406\u8bba\u4e0a\u5e94\u5f53\u5b9e\u73b0\u4e86\uff0c\u53ef\u662f\u5728\u8f93\u5165\u8fc7\u7a0b\u4e2d\u53d1\u73b0\uff0cMarc\u81ea\u52a8\u5c06 max \u8f6c\u6362\u4e3a mav1 \u4e86\uff0c\u4ece\u800c\u5bfc\u81f4\u516c\u5f0f\u8f93\u5165\u9519\u8bef\u3002\u8fd9\u8c8c\u4f3c\u662f\u4e00\u4e2aBUG\u3002\u731c\u6d4b\u539f\u56e0\u4e3a\uff1a\u516c\u5f0f\u63a5\u53d7\u7684\u81ea\u53d8\u91cf\u4e3a v1 \uff0c\u56e0\u6b64marc\u9ed8\u8ba4\u5c06\u53ef\u80fd\u8bef\u8f93\u5165\u7684\u5b57\u7b26 x \u8f6c\u6362\u4e3a v1 \u3002 \u65e2\u7136 max() \u51fd\u6570\u6709\u95ee\u9898\uff0c\u90a3\u5c31\u4f7f\u7528 min() \u51fd\u6570\u6309\u7167\u540c\u6837\u7684\u601d\u8def\u5b9e\u73b0\u5373\u53ef\uff1a -min(2-v1%4,0) Marc\u00ae 2010 Volume A: Theory and User Information \u21a9","title":"\u5b9e\u4f8b\u8bf4\u660e"},{"location":"2012-10-20-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%BC%8F/","text":"MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-10-20 | \u5206\u7c7b\uff1a finite element analysis \u6839\u636e \u7b2c\u4e00\u90e8\u5206 \u4ecb\u7ecd\u7684\u901a\u8fc7\u8f93\u5165\u516c\u5f0f\uff08FORMULA\uff09\u521b\u5efa\u8868\u683c\u66f2\u7ebf\u540e\uff0c\u5373\u53ef\u4f9bMarc\u7a0b\u5e8f\u8c03\u7528\u2014\u2014\u6839\u636e\u5f53\u524d\u65f6\u523b\u7684\u81ea\u53d8\u91cf\u503c\u83b7\u53d6\u8868\u683c\u51fd\u6570\u503c\u3002 DATA POINTS \u7684\u8f93\u5165\u65b9\u5f0f\u53ea\u7ed9\u51fa\u4e86\u66f2\u7ebf\u5728\u6709\u9650\u8282\u70b9\u4f4d\u7f6e\u7684\u51fd\u6570\u503c\uff0c\u5982\u4f55\u5904\u7406\u81ea\u53d8\u91cf\u4f4d\u4e8e\u4e24\u8282\u70b9\u4e4b\u95f4\u65f6\u523b\u7684\u51fd\u6570\u503c\uff1f\u4e00\u65e6\u5f53\u524d\u65f6\u523b\u5bf9\u5e94\u7684\u81ea\u53d8\u91cf\u8d85\u51fa\u8868\u683c\u8303\u56f4\uff0c\u53c8\u8be5\u5982\u4f55\u5904\u7406\uff1f\u672c\u6587\u5373\u5bf9\u8868\u683c\u66f2\u7ebf\u7684\u6570\u636e\u6a21\u5f0f\u8fdb\u884c\u4ecb\u7ecd\u3002 \u6839\u636eMarc\u7528\u6237\u624b\u518c 1 \u7684\u63cf\u8ff0\uff0c\u8868\u683c\u66f2\u7ebf\u7684\u51fd\u6570\u503c\u5177\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u6570\u636e\u6a21\u5f0f\uff1a The function can be input through the TABLE model definition option using either the piecewise linear mode or the equation mode . In the piecewise linear mode, the result is interpolated between the given data values.If the independent variable is outside of the range of data entered, the result will be either extrapolated or the last value will be used. In the second mode, the function may be entered as a mathematical equation. \u5206\u6bb5\u7ebf\u6027\u6a21\u5f0f \u00b6 \u901a\u8fc7\u5916\u90e8\u6570\u636e\u8bfb\u5165\u6216 DATA POINTS \u9009\u9879\u76f4\u63a5\u8f93\u5165\u6563\u70b9\u5f97\u5230\u7684\u8868\u683c\u66f2\u7ebf\u4e3a\u5206\u6bb5\u7ebf\u6027\u6a21\u5f0f\uff08the piecewise linear mode\uff09\u3002\u5728\u8f93\u5165\u6570\u636e\u533a\u95f4\u5185\uff0c\u81ea\u53d8\u91cf\u5bf9\u5e94\u7684\u6570\u503c\u662f\u6700\u8fd1\u7684\u4e24\u4e2a\u8f93\u5165\u6570\u636e\u7684\u7ebf\u6027\u63d2\u503c\uff1b\u82e5\u8d85\u51fa\u6b64\u8303\u56f4\uff0c\u5219\u6709\u4e24\u79cd\u4e0d\u540c\u5904\u7406\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4e3a\u6839\u636e\u6700\u540e\u4e24\u4e2a\u70b9\u7ebf\u6027\u5916\u63a8\uff0c\u53e6\u5916\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u6700\u540e\u4e00\u4e2a\u70b9\u7684\u6570\u503c\u3002 \u65b9\u7a0b\u6a21\u5f0f \u00b6 \u901a\u8fc7 FORMULA \u9009\u9879\u8f93\u5165\u51fd\u6570\u516c\u5f0f\u5f97\u5230\u66f2\u7ebf\u4e3a\u65b9\u7a0b\u6a21\u5f0f\uff08the equation mode\uff09\uff0c\u4efb\u610f\u81ea\u53d8\u91cf\uff08\u5373\u4fbf\u8d85\u51fa\u4e86\u8868\u683c\u663e\u793a\u4e0a\u7684\u8303\u56f4\uff09\u5bf9\u5e94\u7684\u6570\u503c\u5747\u53ef\u76f4\u63a5\u4ee3\u5165\u516c\u5f0f\u8ba1\u7b97\u3002 \u6ce8\u610f \u5728\u663e\u793a\u4e0a\uff0c\u7a0b\u5e8f\u90fd\u662f\u901a\u8fc7\u8ba1\u7b97\u6709\u9650\u6570\u76ee\uff08\u53d6\u51b3\u4e8e\u81ea\u53d8\u91cf\u81ea\u5b9a\u4e49\u7684\u5206\u6bb5\u6570\uff09\u7684\u70b9\u7684\u5750\u6807\uff0c\u7136\u540e\u8fdb\u884c\u63cf\u70b9\u4f5c\u56fe\u3002\u6240\u4ee5\uff0c \u6709\u53ef\u80fd\u66f2\u7ebf\u4e0a\u663e\u793a\u7684\u6570\u503c\u4e0e\u7a0b\u5e8f\u771f\u5b9e\u91c7\u7528\u7684\u6570\u503c\u5e76\u4e0d\u4e00\u81f4 \u3002 \u4f8b\u5982\uff0c\u5728 [0,8] \u533a\u95f4\u5b9a\u4e49\u5173\u4e8e\u53d8\u91cf v1 \u66f2\u7ebf f=sin(0.25*pi*v1) \uff0c\u5f53\u81ea\u53d8\u91cf\u5212\u5206\u6bb5\u6570\u5206\u522b\u4e3a4\u548c40\u65f6\uff0c\u66f2\u7ebf\u663e\u793a\u5f62\u6001\u5206\u522b\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u867d\u7136\u4e8c\u8005\u7684\u663e\u793a\u5f62\u6001\u5b8c\u5168\u4e0d\u540c\uff0c\u4f46\u5bf9\u4e8eMarc\u6765\u8bf4\uff0c\u8f93\u5165\u662f\u540c\u4e00\u6761\u66f2\u7ebf\u3002 v1=1 \u5904\u7684f\u503c\uff0c\u4e0d\u662f\u7ebf\u6027\u63d2\u503c\u5f97\u5230\u7684 f=0.5 \uff0c\u800c\u662f\u76f4\u63a5\u4ee3\u5165\u8ba1\u7b97\u5f97\u5230\u7684 f=sin(0.25*pi)=0.707 . \u5982\u679c\u5c06\u516c\u5f0f\u8f93\u5165\u5f97\u5230\u7684\u66f2\u7ebf\u7531 FORMULA \u5f62\u5f0f\u6539\u4e3a DATA POINTS \u5f62\u5f0f\uff0c\u6570\u636e\u6a21\u5f0f\u76f8\u5e94\u5730\u7531\u65b9\u7a0b\u6a21\u5f0f\u5207\u6362\u5230\u4e86\u5206\u6bb5\u7ebf\u6027\u6a21\u5f0f\uff0c\u6b64\u65f6\u7a0b\u5e8f\u5c06\u91c7\u7528\u63d2\u503c\u7684\u65b9\u6cd5\u8ba1\u7b97\u672a\u77e5\u70b9\u7684\u5750\u6807\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6b64\u65f6\u5bf9\u4e8e v1=1 \uff0c\u5176\u51fd\u6570\u503c\u5c06\u75311,2\u70b9\u63d2\u503c\u5f97\u5230 f=0.5 \u3002 \u5e94\u7528\u793a\u4f8b \u00b6 \u4ee5\u4e0a\u5dee\u5f02\u662f\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff0c\u4f46\u6362\u4e2a\u89d2\u5ea6\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u7075\u6d3b\u8fd0\u7528\u8868\u683c\u7684\u6280\u5de7\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e0b\u56fe\u6240\u793a\u7684\u8fd0\u52a8\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5148\u7528 FORMULA \u5f62\u5f0f\u8f93\u5165\u516c\u5f0f f=sin(0.25*pi*v1) \uff0c\u540c\u65f6\u6ce8\u610f\u8bbe\u7f6e\u597d\u81ea\u53d8\u91cf\u6b65\u6570\uff0c\u4ee5\u4fbf\u5f97\u5230\u76f8\u540c\u7684\u663e\u793a\u5f62\u5f0f\uff1b\u7136\u540e\u4fee\u6539\u4e3a DATA POINTS \u6a21\u5f0f\uff0c\u4f7f\u5176\u771f\u6b63\u53d8\u4e3a\u56fe\u4e2d\u6240\u793a\u66f2\u7ebf\u3002 Marc\u00ae 2010 Volume A: Theory and User Information \u21a9","title":"MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f"},{"location":"2012-10-20-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%BC%8F/#mscmarc 2010","text":"\u53d1\u5e03\u4e8e\uff1a2012-10-20 | \u5206\u7c7b\uff1a finite element analysis \u6839\u636e \u7b2c\u4e00\u90e8\u5206 \u4ecb\u7ecd\u7684\u901a\u8fc7\u8f93\u5165\u516c\u5f0f\uff08FORMULA\uff09\u521b\u5efa\u8868\u683c\u66f2\u7ebf\u540e\uff0c\u5373\u53ef\u4f9bMarc\u7a0b\u5e8f\u8c03\u7528\u2014\u2014\u6839\u636e\u5f53\u524d\u65f6\u523b\u7684\u81ea\u53d8\u91cf\u503c\u83b7\u53d6\u8868\u683c\u51fd\u6570\u503c\u3002 DATA POINTS \u7684\u8f93\u5165\u65b9\u5f0f\u53ea\u7ed9\u51fa\u4e86\u66f2\u7ebf\u5728\u6709\u9650\u8282\u70b9\u4f4d\u7f6e\u7684\u51fd\u6570\u503c\uff0c\u5982\u4f55\u5904\u7406\u81ea\u53d8\u91cf\u4f4d\u4e8e\u4e24\u8282\u70b9\u4e4b\u95f4\u65f6\u523b\u7684\u51fd\u6570\u503c\uff1f\u4e00\u65e6\u5f53\u524d\u65f6\u523b\u5bf9\u5e94\u7684\u81ea\u53d8\u91cf\u8d85\u51fa\u8868\u683c\u8303\u56f4\uff0c\u53c8\u8be5\u5982\u4f55\u5904\u7406\uff1f\u672c\u6587\u5373\u5bf9\u8868\u683c\u66f2\u7ebf\u7684\u6570\u636e\u6a21\u5f0f\u8fdb\u884c\u4ecb\u7ecd\u3002 \u6839\u636eMarc\u7528\u6237\u624b\u518c 1 \u7684\u63cf\u8ff0\uff0c\u8868\u683c\u66f2\u7ebf\u7684\u51fd\u6570\u503c\u5177\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u6570\u636e\u6a21\u5f0f\uff1a The function can be input through the TABLE model definition option using either the piecewise linear mode or the equation mode . In the piecewise linear mode, the result is interpolated between the given data values.If the independent variable is outside of the range of data entered, the result will be either extrapolated or the last value will be used. In the second mode, the function may be entered as a mathematical equation.","title":"MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f"},{"location":"2012-10-20-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%BC%8F/#_1","text":"\u901a\u8fc7\u5916\u90e8\u6570\u636e\u8bfb\u5165\u6216 DATA POINTS \u9009\u9879\u76f4\u63a5\u8f93\u5165\u6563\u70b9\u5f97\u5230\u7684\u8868\u683c\u66f2\u7ebf\u4e3a\u5206\u6bb5\u7ebf\u6027\u6a21\u5f0f\uff08the piecewise linear mode\uff09\u3002\u5728\u8f93\u5165\u6570\u636e\u533a\u95f4\u5185\uff0c\u81ea\u53d8\u91cf\u5bf9\u5e94\u7684\u6570\u503c\u662f\u6700\u8fd1\u7684\u4e24\u4e2a\u8f93\u5165\u6570\u636e\u7684\u7ebf\u6027\u63d2\u503c\uff1b\u82e5\u8d85\u51fa\u6b64\u8303\u56f4\uff0c\u5219\u6709\u4e24\u79cd\u4e0d\u540c\u5904\u7406\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4e3a\u6839\u636e\u6700\u540e\u4e24\u4e2a\u70b9\u7ebf\u6027\u5916\u63a8\uff0c\u53e6\u5916\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u6700\u540e\u4e00\u4e2a\u70b9\u7684\u6570\u503c\u3002","title":"\u5206\u6bb5\u7ebf\u6027\u6a21\u5f0f"},{"location":"2012-10-20-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%BC%8F/#_2","text":"\u901a\u8fc7 FORMULA \u9009\u9879\u8f93\u5165\u51fd\u6570\u516c\u5f0f\u5f97\u5230\u66f2\u7ebf\u4e3a\u65b9\u7a0b\u6a21\u5f0f\uff08the equation mode\uff09\uff0c\u4efb\u610f\u81ea\u53d8\u91cf\uff08\u5373\u4fbf\u8d85\u51fa\u4e86\u8868\u683c\u663e\u793a\u4e0a\u7684\u8303\u56f4\uff09\u5bf9\u5e94\u7684\u6570\u503c\u5747\u53ef\u76f4\u63a5\u4ee3\u5165\u516c\u5f0f\u8ba1\u7b97\u3002 \u6ce8\u610f \u5728\u663e\u793a\u4e0a\uff0c\u7a0b\u5e8f\u90fd\u662f\u901a\u8fc7\u8ba1\u7b97\u6709\u9650\u6570\u76ee\uff08\u53d6\u51b3\u4e8e\u81ea\u53d8\u91cf\u81ea\u5b9a\u4e49\u7684\u5206\u6bb5\u6570\uff09\u7684\u70b9\u7684\u5750\u6807\uff0c\u7136\u540e\u8fdb\u884c\u63cf\u70b9\u4f5c\u56fe\u3002\u6240\u4ee5\uff0c \u6709\u53ef\u80fd\u66f2\u7ebf\u4e0a\u663e\u793a\u7684\u6570\u503c\u4e0e\u7a0b\u5e8f\u771f\u5b9e\u91c7\u7528\u7684\u6570\u503c\u5e76\u4e0d\u4e00\u81f4 \u3002 \u4f8b\u5982\uff0c\u5728 [0,8] \u533a\u95f4\u5b9a\u4e49\u5173\u4e8e\u53d8\u91cf v1 \u66f2\u7ebf f=sin(0.25*pi*v1) \uff0c\u5f53\u81ea\u53d8\u91cf\u5212\u5206\u6bb5\u6570\u5206\u522b\u4e3a4\u548c40\u65f6\uff0c\u66f2\u7ebf\u663e\u793a\u5f62\u6001\u5206\u522b\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u867d\u7136\u4e8c\u8005\u7684\u663e\u793a\u5f62\u6001\u5b8c\u5168\u4e0d\u540c\uff0c\u4f46\u5bf9\u4e8eMarc\u6765\u8bf4\uff0c\u8f93\u5165\u662f\u540c\u4e00\u6761\u66f2\u7ebf\u3002 v1=1 \u5904\u7684f\u503c\uff0c\u4e0d\u662f\u7ebf\u6027\u63d2\u503c\u5f97\u5230\u7684 f=0.5 \uff0c\u800c\u662f\u76f4\u63a5\u4ee3\u5165\u8ba1\u7b97\u5f97\u5230\u7684 f=sin(0.25*pi)=0.707 . \u5982\u679c\u5c06\u516c\u5f0f\u8f93\u5165\u5f97\u5230\u7684\u66f2\u7ebf\u7531 FORMULA \u5f62\u5f0f\u6539\u4e3a DATA POINTS \u5f62\u5f0f\uff0c\u6570\u636e\u6a21\u5f0f\u76f8\u5e94\u5730\u7531\u65b9\u7a0b\u6a21\u5f0f\u5207\u6362\u5230\u4e86\u5206\u6bb5\u7ebf\u6027\u6a21\u5f0f\uff0c\u6b64\u65f6\u7a0b\u5e8f\u5c06\u91c7\u7528\u63d2\u503c\u7684\u65b9\u6cd5\u8ba1\u7b97\u672a\u77e5\u70b9\u7684\u5750\u6807\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6b64\u65f6\u5bf9\u4e8e v1=1 \uff0c\u5176\u51fd\u6570\u503c\u5c06\u75311,2\u70b9\u63d2\u503c\u5f97\u5230 f=0.5 \u3002","title":"\u65b9\u7a0b\u6a21\u5f0f"},{"location":"2012-10-20-MSC.MARC-2010%E8%A1%A8%E6%A0%BC%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%BC%8F/#_3","text":"\u4ee5\u4e0a\u5dee\u5f02\u662f\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff0c\u4f46\u6362\u4e2a\u89d2\u5ea6\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u7075\u6d3b\u8fd0\u7528\u8868\u683c\u7684\u6280\u5de7\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e0b\u56fe\u6240\u793a\u7684\u8fd0\u52a8\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5148\u7528 FORMULA \u5f62\u5f0f\u8f93\u5165\u516c\u5f0f f=sin(0.25*pi*v1) \uff0c\u540c\u65f6\u6ce8\u610f\u8bbe\u7f6e\u597d\u81ea\u53d8\u91cf\u6b65\u6570\uff0c\u4ee5\u4fbf\u5f97\u5230\u76f8\u540c\u7684\u663e\u793a\u5f62\u5f0f\uff1b\u7136\u540e\u4fee\u6539\u4e3a DATA POINTS \u6a21\u5f0f\uff0c\u4f7f\u5176\u771f\u6b63\u53d8\u4e3a\u56fe\u4e2d\u6240\u793a\u66f2\u7ebf\u3002 Marc\u00ae 2010 Volume A: Theory and User Information \u21a9","title":"\u5e94\u7528\u793a\u4f8b"},{"location":"2012-10-21-MSC.MARC-2010%E5%88%9A%E6%80%A7%E6%8E%A5%E8%A7%A6%E4%BD%93%E8%BF%90%E5%8A%A8%E8%AE%BE%E7%BD%AE/","text":"MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e \u00b6 \u53d1\u5e03\u4e8e\uff1a2012-10-21 | \u5206\u7c7b\uff1a finite element analysis MARC\u4e2d\u6709\u4e09\u79cd\u65b9\u5f0f\u8bbe\u7f6e\u521a\u6027\u63a5\u89e6\u4f53\u7684\u8fd0\u52a8\uff1a\u901f\u5ea6\u63a7\u5236\u3001\u4f4d\u79fb\u63a7\u5236\u3001\u529b\u63a7\u5236\u3002\u7ed3\u5408\u8fd9\u4e09\u79cd\u63a7\u5236\u65b9\u5f0f\u53ca\u8868\u683c\u529f\u80fd\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5404\u79cd\u81ea\u5b9a\u4e49\u8fd0\u52a8\u3002 \u901f\u5ea6\u63a7\u5236 \u00b6 \u901f\u5ea6\u63a7\u5236\u9762\u677f\u5982\u4e0b\u56fe\u6240\u793a\u3002\u5176\u4e2d\uff0c\u5e73\u52a8\u548c\u65cb\u8f6c\u90fd\u662f\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u76f8\u5bf9\u65cb\u8f6c\u4e2d\u5fc3\uff08\u9ed8\u8ba4\u4e3a\u5750\u6807\u539f\u70b9\uff09\u7684\u901f\u5ea6\u3002 \u6ce8\u610f\uff1a \u4e0a\u56fe\u901a\u8fc7\u8868\u683c\u6765\u63a7\u5236y\u65b9\u5411\u7684\u5e73\u52a8\u901f\u5ea6\u3002\u901f\u5ea6\u66f2\u7ebf\u4f53\u73b0\u4e3a\u6bcf\u4e2a\u589e\u91cf\u6b65\u5185\u7684\u4f4d\u79fb\uff0c\u5373\u901f\u5ea6\u66f2\u7ebf\u4e0e\u5750\u6807\u8f74\u56f4\u6210\u7684\u9762\u79ef\u3002 \u5047\u8bbe\u6bcf\u4e2a\u589e\u91cf\u6b65\u7684\u65f6\u95f4\u4e3a1s\uff0cy\u65b9\u5411\u901f\u5ea6\u5982\u4e0a\u56fe\u6240\u793a\uff0c table5 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5219\u7b2c\u4e09\u589e\u91cf\u6b65\u5185\u521a\u4f53\u5411y\u8f74\u8d1f\u65b9\u5411\u8fd0\u52a8\u4e86 0.1*(0.5*1*1)=0.05mm \uff0c\u5176\u4ed6\u4ee5\u6b64\u7c7b\u63a8\u3002 \u4f4d\u79fb\u63a7\u5236 \u00b6 \u53c2\u6570\u8f93\u5165\u9762\u677f\u4e0e\u901f\u5ea6\u63a7\u5236\u7c7b\u4f3c\u3002\u5e73\u52a8\u548c\u65cb\u8f6c\u90fd\u662f\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u76f8\u5bf9\u65cb\u8f6c\u4e2d\u5fc3\uff08\u9ed8\u8ba4\u4e3a\u5750\u6807\u539f\u70b9\uff09\u7684\u4f4d\u7f6e\u3002 \u6ce8\u610f\uff1a \u4e00\u4e2a\u589e\u91cf\u6b65\u5185\u521a\u4f53\u5e73\u52a8\u7684\u4f4d\u79fb\u8868\u73b0\u4e3a\u4f4d\u79fb\u66f2\u7ebf\u5728\u589e\u91cf\u6b65\u59cb\u672b\u65f6\u523b\u7684\u6570\u503c\u4e4b\u5dee\uff0c\u5373\u589e\u91cf\u6b65\u65f6\u95f4\u5185\u7eb5\u8f74\u7684\u6570\u503c\u3002 \u5047\u8bbe\u4e0a\u56fe\u4e3a\u4f4d\u79fb\u66f2\u7ebf\uff0c\u5219\u7b2c\u4e09\u589e\u91cf\u6b65\u5185\u4f4d\u79fb\u4e3a -0.1*(1-0)=-0.1mm \uff0c\u5373\u6cbf\u7740y\u8f74\u8d1f\u5411\u8fd0\u52a8\u4e860.1mm\u3002 \u529b\u63a7\u5236 \u00b6 \u529b\u63a7\u5236\u9700\u8981\u901a\u8fc7\u8bbe\u7f6e\u63a7\u5236\u8282\u70b9\u548c\u8f85\u52a9\u8282\u70b9\u6765\u5b8c\u6210\uff0c\u8fd9\u4e24\u4e2a\u8282\u70b9\u5fc5\u987b\u662f\u5355\u5143\u8282\u70b9\u4e4b\u5916\u7684\u8282\u70b9\u3002 \u63a7\u5236\u8282\u70b9\u8868\u793a\u521a\u4f53\u7684\u4e09\u4e2a\u5e73\u52a8\u81ea\u7531\u5ea6\uff0c\u53ef\u4ee5\u5728\u4f4d\u79fb\u8fb9\u754c\u6761\u4ef6 FIXED DISPLACEMENT \u4e2d\u5bf9\u6b64\u8282\u70b9\u65bd\u52a0\u4f4d\u79fb\u7ea6\u675f\u4ee5\u5b9e\u73b0\u9884\u5b9a\u7684\u8fd0\u52a8\u65b9\u5f0f\u3002\u540c\u65f6\u63a7\u5236\u8282\u70b9\u4f5c\u4e3a\u521a\u4f53\u65cb\u8f6c\u7684\u4e2d\u5fc3\u70b9\uff08\u65cb\u8f6c\u8f74\u6839\u636e\u9700\u8981\u81ea\u5b9a\u4e49\uff09\u3002 \u8f85\u52a9\u8282\u70b9\u63a7\u5236\u521a\u4f53\u7684\u8f6c\u52a8\u81ea\u7531\u5ea6\uff0c\u5728\u8fb9\u754c\u6761\u4ef6 POINT LOAD \u4e2d\u5bf9\u6b64\u8282\u70b9\u65bd\u52a0\u626d\u77e9\u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u8f6c\u52a8\u3002\u6ce8\u610f\uff1aFORCE X\u3001Y\u3001Z\u8868\u793a\u4e09\u4e2a\u65b9\u5411\u7684\u626d\u77e9\uff0c\u800c\u975eMOMENT X\u3001Y\u3001Z\u3002","title":"MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e"},{"location":"2012-10-21-MSC.MARC-2010%E5%88%9A%E6%80%A7%E6%8E%A5%E8%A7%A6%E4%BD%93%E8%BF%90%E5%8A%A8%E8%AE%BE%E7%BD%AE/#mscmarc 2010","text":"\u53d1\u5e03\u4e8e\uff1a2012-10-21 | \u5206\u7c7b\uff1a finite element analysis MARC\u4e2d\u6709\u4e09\u79cd\u65b9\u5f0f\u8bbe\u7f6e\u521a\u6027\u63a5\u89e6\u4f53\u7684\u8fd0\u52a8\uff1a\u901f\u5ea6\u63a7\u5236\u3001\u4f4d\u79fb\u63a7\u5236\u3001\u529b\u63a7\u5236\u3002\u7ed3\u5408\u8fd9\u4e09\u79cd\u63a7\u5236\u65b9\u5f0f\u53ca\u8868\u683c\u529f\u80fd\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5404\u79cd\u81ea\u5b9a\u4e49\u8fd0\u52a8\u3002","title":"MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e"},{"location":"2012-10-21-MSC.MARC-2010%E5%88%9A%E6%80%A7%E6%8E%A5%E8%A7%A6%E4%BD%93%E8%BF%90%E5%8A%A8%E8%AE%BE%E7%BD%AE/#_1","text":"\u901f\u5ea6\u63a7\u5236\u9762\u677f\u5982\u4e0b\u56fe\u6240\u793a\u3002\u5176\u4e2d\uff0c\u5e73\u52a8\u548c\u65cb\u8f6c\u90fd\u662f\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u76f8\u5bf9\u65cb\u8f6c\u4e2d\u5fc3\uff08\u9ed8\u8ba4\u4e3a\u5750\u6807\u539f\u70b9\uff09\u7684\u901f\u5ea6\u3002 \u6ce8\u610f\uff1a \u4e0a\u56fe\u901a\u8fc7\u8868\u683c\u6765\u63a7\u5236y\u65b9\u5411\u7684\u5e73\u52a8\u901f\u5ea6\u3002\u901f\u5ea6\u66f2\u7ebf\u4f53\u73b0\u4e3a\u6bcf\u4e2a\u589e\u91cf\u6b65\u5185\u7684\u4f4d\u79fb\uff0c\u5373\u901f\u5ea6\u66f2\u7ebf\u4e0e\u5750\u6807\u8f74\u56f4\u6210\u7684\u9762\u79ef\u3002 \u5047\u8bbe\u6bcf\u4e2a\u589e\u91cf\u6b65\u7684\u65f6\u95f4\u4e3a1s\uff0cy\u65b9\u5411\u901f\u5ea6\u5982\u4e0a\u56fe\u6240\u793a\uff0c table5 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5219\u7b2c\u4e09\u589e\u91cf\u6b65\u5185\u521a\u4f53\u5411y\u8f74\u8d1f\u65b9\u5411\u8fd0\u52a8\u4e86 0.1*(0.5*1*1)=0.05mm \uff0c\u5176\u4ed6\u4ee5\u6b64\u7c7b\u63a8\u3002","title":"\u901f\u5ea6\u63a7\u5236"},{"location":"2012-10-21-MSC.MARC-2010%E5%88%9A%E6%80%A7%E6%8E%A5%E8%A7%A6%E4%BD%93%E8%BF%90%E5%8A%A8%E8%AE%BE%E7%BD%AE/#_2","text":"\u53c2\u6570\u8f93\u5165\u9762\u677f\u4e0e\u901f\u5ea6\u63a7\u5236\u7c7b\u4f3c\u3002\u5e73\u52a8\u548c\u65cb\u8f6c\u90fd\u662f\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u76f8\u5bf9\u65cb\u8f6c\u4e2d\u5fc3\uff08\u9ed8\u8ba4\u4e3a\u5750\u6807\u539f\u70b9\uff09\u7684\u4f4d\u7f6e\u3002 \u6ce8\u610f\uff1a \u4e00\u4e2a\u589e\u91cf\u6b65\u5185\u521a\u4f53\u5e73\u52a8\u7684\u4f4d\u79fb\u8868\u73b0\u4e3a\u4f4d\u79fb\u66f2\u7ebf\u5728\u589e\u91cf\u6b65\u59cb\u672b\u65f6\u523b\u7684\u6570\u503c\u4e4b\u5dee\uff0c\u5373\u589e\u91cf\u6b65\u65f6\u95f4\u5185\u7eb5\u8f74\u7684\u6570\u503c\u3002 \u5047\u8bbe\u4e0a\u56fe\u4e3a\u4f4d\u79fb\u66f2\u7ebf\uff0c\u5219\u7b2c\u4e09\u589e\u91cf\u6b65\u5185\u4f4d\u79fb\u4e3a -0.1*(1-0)=-0.1mm \uff0c\u5373\u6cbf\u7740y\u8f74\u8d1f\u5411\u8fd0\u52a8\u4e860.1mm\u3002","title":"\u4f4d\u79fb\u63a7\u5236"},{"location":"2012-10-21-MSC.MARC-2010%E5%88%9A%E6%80%A7%E6%8E%A5%E8%A7%A6%E4%BD%93%E8%BF%90%E5%8A%A8%E8%AE%BE%E7%BD%AE/#_3","text":"\u529b\u63a7\u5236\u9700\u8981\u901a\u8fc7\u8bbe\u7f6e\u63a7\u5236\u8282\u70b9\u548c\u8f85\u52a9\u8282\u70b9\u6765\u5b8c\u6210\uff0c\u8fd9\u4e24\u4e2a\u8282\u70b9\u5fc5\u987b\u662f\u5355\u5143\u8282\u70b9\u4e4b\u5916\u7684\u8282\u70b9\u3002 \u63a7\u5236\u8282\u70b9\u8868\u793a\u521a\u4f53\u7684\u4e09\u4e2a\u5e73\u52a8\u81ea\u7531\u5ea6\uff0c\u53ef\u4ee5\u5728\u4f4d\u79fb\u8fb9\u754c\u6761\u4ef6 FIXED DISPLACEMENT \u4e2d\u5bf9\u6b64\u8282\u70b9\u65bd\u52a0\u4f4d\u79fb\u7ea6\u675f\u4ee5\u5b9e\u73b0\u9884\u5b9a\u7684\u8fd0\u52a8\u65b9\u5f0f\u3002\u540c\u65f6\u63a7\u5236\u8282\u70b9\u4f5c\u4e3a\u521a\u4f53\u65cb\u8f6c\u7684\u4e2d\u5fc3\u70b9\uff08\u65cb\u8f6c\u8f74\u6839\u636e\u9700\u8981\u81ea\u5b9a\u4e49\uff09\u3002 \u8f85\u52a9\u8282\u70b9\u63a7\u5236\u521a\u4f53\u7684\u8f6c\u52a8\u81ea\u7531\u5ea6\uff0c\u5728\u8fb9\u754c\u6761\u4ef6 POINT LOAD \u4e2d\u5bf9\u6b64\u8282\u70b9\u65bd\u52a0\u626d\u77e9\u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u8f6c\u52a8\u3002\u6ce8\u610f\uff1aFORCE X\u3001Y\u3001Z\u8868\u793a\u4e09\u4e2a\u65b9\u5411\u7684\u626d\u77e9\uff0c\u800c\u975eMOMENT X\u3001Y\u3001Z\u3002","title":"\u529b\u63a7\u5236"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/","text":"UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55 \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-06-13 | \u5206\u7c7b\uff1a CAD/CAE integration UG\u8fd0\u52a8\u4eff\u771f\u7684\u5b66\u4e60\u5174\u8da3\u7531\u6765\u5df2\u4e45\uff0c\u5e76\u4e14\u8d44\u6599\u4e5f\u6536\u96c6\u4e86\u4e00\u4e9b\uff1b\u4f46\u8fdf\u8fdf\u9650\u4e8e\u8d44\u6599\u6536\u96c6\u7684\u72b6\u6001\uff0c\u59cb\u7ec8\u6ca1\u6709\u5f00\u59cb\u5b66\u4e60\u3002\u76f4\u5230\u6700\u8fd1\u5b9e\u9a8c\u9700\u8981\uff0c\u7ec8\u4e8e\u7528\u4e86\u4e00\u5929\u65f6\u95f4\u5bf9 \u300aUG NX 7.0 \u52a8\u529b\u5b66\u4e0e\u6709\u9650\u5143\u5206\u6790\u4ece\u5165\u95e8\u5230\u7cbe\u901a\u300b \u4e00\u4e66\u8fdb\u884c\u4e86\u5feb\u901f\u5b66\u4e60\uff0c\u5e76\u7ed3\u5408\u968f\u4e66\u89c6\u9891\u7b80\u8981\u7ec3\u4e60\uff0c\u7b97\u662f\u5230\u4e86\u5165\u95e8\u9636\u6bb5\u3002 \u5de5\u5177\u680f\u6982\u89c8 \u00b6 \u8fd0\u52a8\u8bbe\u7f6e \u00b6 \u673a\u6784\u6307\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684\u6784\u4ef6\u901a\u8fc7\u6d3b\u52a8\u8054\u63a5\u4ee5\u5b9e\u73b0\u89c4\u5b9a\u8fd0\u52a8\u7684\u6784\u4ef6\u7ec4\u5408\uff0c\u56e0\u6b64\u6700\u57fa\u672c\u7684\u673a\u6784\u8fd0\u52a8\u5206\u6790\u9700\u8981\u5b9a\u4e49 \u6784\u4ef6 \u3001 \u8054\u63a5\u5173\u7cfb \uff0c\u5bf9\u4e8e\u4e00\u4e9b\u7279\u5b9a\u7684\u3001\u590d\u6742\u7684\u8fd0\u52a8\u8fd8\u8981\u901a\u8fc7 \u7ea6\u675f\u6761\u4ef6 \u6765\u5b9e\u73b0\u3002 \u6784\u4ef6\uff08Link\uff09 \u72ec\u7acb\u7684\u8fd0\u52a8\u5355\u4f4d\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u90e8\u4ef6\uff0c\u673a\u67b6\u8bbe\u5b9a\u4e3a\u56fa\u5b9a\u3002 \u8fd0\u52a8\u526f\uff08Joint\uff09 \u6700\u57fa\u672c\u7684\u8054\u63a5\u65b9\u5f0f\uff0c\u5305\u62ec\u65cb\u8f6c\u526f\u3001\u6ed1\u52a8\u526f\u3001\u5e73\u9762\u526f\u3001\u5706\u67f1\u526f\u3001\u7403\u526f\u3001\u4e07\u5411\u8282\u7b49\u3002\u53ef\u4ee5\u8bbe\u5b9a\u57fa\u7840\u6784\u4ef6\uff0c\u5219\u76f8\u5bf9\u5176\u8fd0\u52a8\u3002 \u4f20\u52a8\u526f\uff08Gear\uff09 \u4e3b\u8981\u5305\u62ec\u9f7f\u8f6e\u3001\u9f7f\u8f6e\u9f7f\u6761\u3001\u5e26\u4f20\u52a8\u7b49\u3002 \u4f20\u52a8\u526f\u662f\u8fd0\u52a8\u526f\u7684\u7ec4\u5408\uff0c\u540c\u65f6\u9644\u5e26\u4f20\u52a8\u6bd4\u3002\u4f8b\u5982\u9f7f\u8f6e\u7ec4\u5408\u4e24\u4e2a\u65cb\u8f6c\u526f\uff0c\u5219\u6da1\u8f6e\u8717\u6746\u4e5f\u5c5e\u4e8e\u9f7f\u8f6e\u4f20\u52a8\u526f\uff1b\u9f7f\u8f6e\u9f7f\u6761\u7ec4\u5408\u65cb\u8f6c\u526f\u548c\u6ed1\u52a8\u526f\uff0c\u51f8\u8f6e\u4f20\u52a8\u4e5f\u5c5e\u4e8e\u6b64\u7c7b\uff1b\u5e26\u4f20\u52a8\u7ec4\u5408\u4e24\u4e2a\u6ed1\u52a8\u526f\u3002 \u8fde\u63a5\uff08Spring\uff09 \u5305\u62ec\u5f39\u7c27\u3001\u963b\u5c3c\u3001\u886c\u5957\u3001\u4e09\u7ef4\u63a5\u89e6\u3001\u4e8c\u7ef4\u63a5\u89e6\u3002 \u8fd0\u52a8\u526f\u3001\u4f20\u52a8\u526f\u3001\u8fde\u63a5\u540c\u5c5e\u4e8e\u8054\u63a5\u5173\u7cfb\u3002 \u7ea6\u675f\uff08Point on Curve\uff09 \u5305\u62ec\u70b9\u5728\u7ebf\u4e0a\u3001\u7ebf\u5728\u7ebf\u4e0a\u3001\u70b9\u5728\u9762\u4e0a\u4e09\u79cd\u7ea6\u675f\u6761\u4ef6\u3002 \u8f7d\u8377\uff08Scalar Force\uff09 \u5305\u62ec\u6807\u91cf/\u77e2\u91cf\u529b\uff0c\u6807\u91cf/\u77e2\u91cf\u626d\u77e9\u3002 \u6807\u91cf\u529b\u5b9a\u4e49\u4e24\u4e2a\u53c2\u8003\u70b9\u4f5c\u4e3a\u529b\u7684\u65b9\u5411\uff0c\u5219\u53ef\u80fd\u59cb\u7ec8\u53d8\u5316\uff1b\u77e2\u91cf\u529b\u660e\u786e\u7ed9\u5b9a\u65b9\u5411\u53ca\u5927\u5c0f\u3002 \u5e72\u6d89\uff08Interference\uff09 \u8bbe\u5b9a\u5e72\u6d89\u6761\u4ef6\uff0c\u914d\u5408\u6c42\u89e3\u4e2d\u201c\u5728\u53d1\u751f\u5e72\u6d89\u65f6\u505c\u6b62\u201d\u9009\u9879\u53ef\u4ee5\u7528\u4e8e\u673a\u6784\u8fd0\u52a8\u5408\u7406\u6027\u7684\u68c0\u6d4b\u3002 \u63d0\u793a \u7ea6\u675f\u3001\u8f7d\u8377\u3001\u5e72\u6d89\u540c\u5c5e\u4e8e\u8054\u63a5\u5173\u7cfb\u3002 \u6c42\u89e3 \u00b6 \u5bf9\u6c42\u89e3\u5de5\u51b5\uff08Solution\uff09\u7684\u8bbe\u7f6e\u4e2d\u6ce8\u610f\u4e09\u79cd\u9a71\u52a8\u65b9\u5f0f\uff1a \u6b63\u5e38\u8fd0\u884c \u7531\u8fd0\u52a8\u526f\u6216\u8005\u8f7d\u8377\u9a71\u52a8\uff0c\u9700\u8981\u8bbe\u7f6e\u8fd0\u884c\u7684\u65f6\u95f4\u53ca\u6b65\u6570\uff0c\u5373\u8fd0\u52a8\u884c\u7a0b\u6709\u9650\u3002 \u5173\u8282\u8fd0\u52a8 \u8bbe\u5b9a\u5355\u6b65\u8fd0\u52a8\u91cf\u53ca\u6b65\u6570\uff0c\u53ef\u4ee5\u4efb\u610f\u884c\u7a0b\u8fd0\u52a8\uff0c\u5e38\u914d\u5408\u201c\u5728\u53d1\u751f\u5e72\u6d89\u65f6\u505c\u6b62\u201d\u9009\u9879\u68c0\u6d4b\u8fd0\u52a8\u8303\u56f4\u3002 \u8868\u5355\u9a71\u52a8 \u7531Excel\u4e2d\u65f6\u95f4\u3001\u884c\u7a0b\u6570\u636e\u9a71\u52a8\u3002 \u63d0\u793a \u91cd\u529b\u59cb\u7ec8\u5b58\u5728\uff0c\u5927\u5c0f\u53ef\u8c03\u3002 \u540e\u5904\u7406 \u00b6 \u540e\u5904\u7406\uff08Animation\uff09\u53ef\u4ee5\u521b\u5efa\u52a8\u753b\u3001\u66f2\u7ebf\u56fe\uff08\u4f4d\u79fb-\u65f6\u95f4\uff0c\u529b-\u65f6\u95f4\uff09\u7b49\u3002 \u603b\u7ed3 \u00b6 UG\u8fd0\u52a8\u4eff\u771f\u7684\u57fa\u672c\u8bbe\u7f6e\u6d41\u7a0b\u4e3a\uff1a\u5b9a\u4e49\u6784\u4ef6\u53ca\u8054\u63a5\u5173\u7cfb\uff0c\u8bbe\u7f6e\u7ea6\u675f\u6761\u4ef6\uff0c\u6700\u7ec8\u8fdb\u884c\u6c42\u89e3\u548c\u540e\u5904\u7406\u5206\u6790\u3002 \u8f6f\u4ef6\u8bbe\u7f6e\u662f\u5728\u7406\u89e3\u4e86\u673a\u6784\u8fd0\u52a8\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u7684\uff0c\u6240\u4ee5Motion Simulation\u7684\u8bbe\u7f6e\u53ea\u662f\u5f62\u5f0f\uff0c\u5173\u952e\u5728\u4e8e\u5bf9\u673a\u6784\u8fd0\u52a8\u7684\u7406\u89e3\u3002","title":"UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#ug","text":"\u53d1\u5e03\u4e8e\uff1a2013-06-13 | \u5206\u7c7b\uff1a CAD/CAE integration UG\u8fd0\u52a8\u4eff\u771f\u7684\u5b66\u4e60\u5174\u8da3\u7531\u6765\u5df2\u4e45\uff0c\u5e76\u4e14\u8d44\u6599\u4e5f\u6536\u96c6\u4e86\u4e00\u4e9b\uff1b\u4f46\u8fdf\u8fdf\u9650\u4e8e\u8d44\u6599\u6536\u96c6\u7684\u72b6\u6001\uff0c\u59cb\u7ec8\u6ca1\u6709\u5f00\u59cb\u5b66\u4e60\u3002\u76f4\u5230\u6700\u8fd1\u5b9e\u9a8c\u9700\u8981\uff0c\u7ec8\u4e8e\u7528\u4e86\u4e00\u5929\u65f6\u95f4\u5bf9 \u300aUG NX 7.0 \u52a8\u529b\u5b66\u4e0e\u6709\u9650\u5143\u5206\u6790\u4ece\u5165\u95e8\u5230\u7cbe\u901a\u300b \u4e00\u4e66\u8fdb\u884c\u4e86\u5feb\u901f\u5b66\u4e60\uff0c\u5e76\u7ed3\u5408\u968f\u4e66\u89c6\u9891\u7b80\u8981\u7ec3\u4e60\uff0c\u7b97\u662f\u5230\u4e86\u5165\u95e8\u9636\u6bb5\u3002","title":"UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#_1","text":"","title":"\u5de5\u5177\u680f\u6982\u89c8"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#_2","text":"\u673a\u6784\u6307\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684\u6784\u4ef6\u901a\u8fc7\u6d3b\u52a8\u8054\u63a5\u4ee5\u5b9e\u73b0\u89c4\u5b9a\u8fd0\u52a8\u7684\u6784\u4ef6\u7ec4\u5408\uff0c\u56e0\u6b64\u6700\u57fa\u672c\u7684\u673a\u6784\u8fd0\u52a8\u5206\u6790\u9700\u8981\u5b9a\u4e49 \u6784\u4ef6 \u3001 \u8054\u63a5\u5173\u7cfb \uff0c\u5bf9\u4e8e\u4e00\u4e9b\u7279\u5b9a\u7684\u3001\u590d\u6742\u7684\u8fd0\u52a8\u8fd8\u8981\u901a\u8fc7 \u7ea6\u675f\u6761\u4ef6 \u6765\u5b9e\u73b0\u3002 \u6784\u4ef6\uff08Link\uff09 \u72ec\u7acb\u7684\u8fd0\u52a8\u5355\u4f4d\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u90e8\u4ef6\uff0c\u673a\u67b6\u8bbe\u5b9a\u4e3a\u56fa\u5b9a\u3002 \u8fd0\u52a8\u526f\uff08Joint\uff09 \u6700\u57fa\u672c\u7684\u8054\u63a5\u65b9\u5f0f\uff0c\u5305\u62ec\u65cb\u8f6c\u526f\u3001\u6ed1\u52a8\u526f\u3001\u5e73\u9762\u526f\u3001\u5706\u67f1\u526f\u3001\u7403\u526f\u3001\u4e07\u5411\u8282\u7b49\u3002\u53ef\u4ee5\u8bbe\u5b9a\u57fa\u7840\u6784\u4ef6\uff0c\u5219\u76f8\u5bf9\u5176\u8fd0\u52a8\u3002 \u4f20\u52a8\u526f\uff08Gear\uff09 \u4e3b\u8981\u5305\u62ec\u9f7f\u8f6e\u3001\u9f7f\u8f6e\u9f7f\u6761\u3001\u5e26\u4f20\u52a8\u7b49\u3002 \u4f20\u52a8\u526f\u662f\u8fd0\u52a8\u526f\u7684\u7ec4\u5408\uff0c\u540c\u65f6\u9644\u5e26\u4f20\u52a8\u6bd4\u3002\u4f8b\u5982\u9f7f\u8f6e\u7ec4\u5408\u4e24\u4e2a\u65cb\u8f6c\u526f\uff0c\u5219\u6da1\u8f6e\u8717\u6746\u4e5f\u5c5e\u4e8e\u9f7f\u8f6e\u4f20\u52a8\u526f\uff1b\u9f7f\u8f6e\u9f7f\u6761\u7ec4\u5408\u65cb\u8f6c\u526f\u548c\u6ed1\u52a8\u526f\uff0c\u51f8\u8f6e\u4f20\u52a8\u4e5f\u5c5e\u4e8e\u6b64\u7c7b\uff1b\u5e26\u4f20\u52a8\u7ec4\u5408\u4e24\u4e2a\u6ed1\u52a8\u526f\u3002 \u8fde\u63a5\uff08Spring\uff09 \u5305\u62ec\u5f39\u7c27\u3001\u963b\u5c3c\u3001\u886c\u5957\u3001\u4e09\u7ef4\u63a5\u89e6\u3001\u4e8c\u7ef4\u63a5\u89e6\u3002 \u8fd0\u52a8\u526f\u3001\u4f20\u52a8\u526f\u3001\u8fde\u63a5\u540c\u5c5e\u4e8e\u8054\u63a5\u5173\u7cfb\u3002 \u7ea6\u675f\uff08Point on Curve\uff09 \u5305\u62ec\u70b9\u5728\u7ebf\u4e0a\u3001\u7ebf\u5728\u7ebf\u4e0a\u3001\u70b9\u5728\u9762\u4e0a\u4e09\u79cd\u7ea6\u675f\u6761\u4ef6\u3002 \u8f7d\u8377\uff08Scalar Force\uff09 \u5305\u62ec\u6807\u91cf/\u77e2\u91cf\u529b\uff0c\u6807\u91cf/\u77e2\u91cf\u626d\u77e9\u3002 \u6807\u91cf\u529b\u5b9a\u4e49\u4e24\u4e2a\u53c2\u8003\u70b9\u4f5c\u4e3a\u529b\u7684\u65b9\u5411\uff0c\u5219\u53ef\u80fd\u59cb\u7ec8\u53d8\u5316\uff1b\u77e2\u91cf\u529b\u660e\u786e\u7ed9\u5b9a\u65b9\u5411\u53ca\u5927\u5c0f\u3002 \u5e72\u6d89\uff08Interference\uff09 \u8bbe\u5b9a\u5e72\u6d89\u6761\u4ef6\uff0c\u914d\u5408\u6c42\u89e3\u4e2d\u201c\u5728\u53d1\u751f\u5e72\u6d89\u65f6\u505c\u6b62\u201d\u9009\u9879\u53ef\u4ee5\u7528\u4e8e\u673a\u6784\u8fd0\u52a8\u5408\u7406\u6027\u7684\u68c0\u6d4b\u3002 \u63d0\u793a \u7ea6\u675f\u3001\u8f7d\u8377\u3001\u5e72\u6d89\u540c\u5c5e\u4e8e\u8054\u63a5\u5173\u7cfb\u3002","title":"\u8fd0\u52a8\u8bbe\u7f6e"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#_3","text":"\u5bf9\u6c42\u89e3\u5de5\u51b5\uff08Solution\uff09\u7684\u8bbe\u7f6e\u4e2d\u6ce8\u610f\u4e09\u79cd\u9a71\u52a8\u65b9\u5f0f\uff1a \u6b63\u5e38\u8fd0\u884c \u7531\u8fd0\u52a8\u526f\u6216\u8005\u8f7d\u8377\u9a71\u52a8\uff0c\u9700\u8981\u8bbe\u7f6e\u8fd0\u884c\u7684\u65f6\u95f4\u53ca\u6b65\u6570\uff0c\u5373\u8fd0\u52a8\u884c\u7a0b\u6709\u9650\u3002 \u5173\u8282\u8fd0\u52a8 \u8bbe\u5b9a\u5355\u6b65\u8fd0\u52a8\u91cf\u53ca\u6b65\u6570\uff0c\u53ef\u4ee5\u4efb\u610f\u884c\u7a0b\u8fd0\u52a8\uff0c\u5e38\u914d\u5408\u201c\u5728\u53d1\u751f\u5e72\u6d89\u65f6\u505c\u6b62\u201d\u9009\u9879\u68c0\u6d4b\u8fd0\u52a8\u8303\u56f4\u3002 \u8868\u5355\u9a71\u52a8 \u7531Excel\u4e2d\u65f6\u95f4\u3001\u884c\u7a0b\u6570\u636e\u9a71\u52a8\u3002 \u63d0\u793a \u91cd\u529b\u59cb\u7ec8\u5b58\u5728\uff0c\u5927\u5c0f\u53ef\u8c03\u3002","title":"\u6c42\u89e3"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#_4","text":"\u540e\u5904\u7406\uff08Animation\uff09\u53ef\u4ee5\u521b\u5efa\u52a8\u753b\u3001\u66f2\u7ebf\u56fe\uff08\u4f4d\u79fb-\u65f6\u95f4\uff0c\u529b-\u65f6\u95f4\uff09\u7b49\u3002","title":"\u540e\u5904\u7406"},{"location":"2013-06-13-UG%E8%BF%90%E5%8A%A8%E4%BB%BF%E7%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#_5","text":"UG\u8fd0\u52a8\u4eff\u771f\u7684\u57fa\u672c\u8bbe\u7f6e\u6d41\u7a0b\u4e3a\uff1a\u5b9a\u4e49\u6784\u4ef6\u53ca\u8054\u63a5\u5173\u7cfb\uff0c\u8bbe\u7f6e\u7ea6\u675f\u6761\u4ef6\uff0c\u6700\u7ec8\u8fdb\u884c\u6c42\u89e3\u548c\u540e\u5904\u7406\u5206\u6790\u3002 \u8f6f\u4ef6\u8bbe\u7f6e\u662f\u5728\u7406\u89e3\u4e86\u673a\u6784\u8fd0\u52a8\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u7684\uff0c\u6240\u4ee5Motion Simulation\u7684\u8bbe\u7f6e\u53ea\u662f\u5f62\u5f0f\uff0c\u5173\u952e\u5728\u4e8e\u5bf9\u673a\u6784\u8fd0\u52a8\u7684\u7406\u89e3\u3002","title":"\u603b\u7ed3"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/","text":"Levy Mises\u7406\u8bba\u7684\u601d\u8003 \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-07-29 | \u5206\u7c7b\uff1a plasticity theory \u589e\u91cf\u7406\u8bba\u6307\u7684\u662f\u7528\u5e94\u53d8\u589e\u91cf\u63cf\u8ff0\u672c\u6784\u5173\u7cfb\uff0c\u53c8\u79f0\u4e3a\u6d41\u52a8\u7406\u8bba\u3002\u672c\u6784\u5173\u7cfb\u5305\u62ec\u4e09\u90e8\u5206\uff1a\u672c\u6784\u65b9\u7a0b\u3001\u5c48\u670d\u6761\u4ef6\u548c\u786c\u5316\u6761\u4ef6\u3002 Levy-Mises\u7406\u8bba \u662f\u5851\u6027\u6210\u5f62\u589e\u91cf\u7406\u8bba\u4e4b\u4e00\uff0c\u5176\u57fa\u672c\u5047\u8bbe\u5982\u4e0b\uff1a \u521a\u5851\u6027\u6750\u6599 Mises\u5c48\u670d\u51c6\u5219 \u5723\u7ef4\u5357\u5047\u8bbe\uff1a\u52a0\u8f7d\u77ac\u65f6\uff0c\u5e94\u529b\u4e3b\u8f74\u4e0e\u5e94\u53d8\u589e\u91cf\u4e3b\u8f74\u91cd\u5408 \u4f53\u79ef\u4e0d\u53d8\u6761\u4ef6 \u63a8\u5bfc\u8fc7\u7a0b \u00b6 \u5728\u5723\u7ef4\u5357\u5047\u8bbe\u7684\u57fa\u7840\u4e0a\uff0c\u5047\u8bbe\u5851\u6027\u5e94\u53d8\u589e\u91cf\u7684\u5404\u4e2a\u5206\u91cf\u4e0e\u76f8\u5e94\u504f\u5e94\u529b\u5206\u91cf\u6210\u6bd4\u4f8b d\\varepsilon_{ij}^{p} = d\\lambda\\,{\\sigma_{ij}}' d\\varepsilon_{ij}^{p} = d\\lambda\\,{\\sigma_{ij}}' \u6839\u636e\u7b49\u6548\u5851\u6027\u5e94\u53d8\u589e\u91cf d{\\bar\\varepsilon}_{ij}^{p} d{\\bar\\varepsilon}_{ij}^{p} \u7684\u5b9a\u4e49\u5f0f\u53ca\u4f53\u79ef\u4e0d\u53d8\u6761\u4ef6\u5f97\u5230 d{\\bar\\varepsilon}_{ij}^{p} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon'}_{ij}^{p}\\,d{\\varepsilon'}_{ij}^{p}} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon}_{ij}^{p}\\,d{\\varepsilon}_{ij}^{p}} d{\\bar\\varepsilon}_{ij}^{p} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon'}_{ij}^{p}\\,d{\\varepsilon'}_{ij}^{p}} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon}_{ij}^{p}\\,d{\\varepsilon}_{ij}^{p}} \u4e8e\u662f\u7b49\u6548\u5e94\u53d8 \\begin{align*} \\bar\\sigma &= \\sqrt{\\dfrac{3}{2}\\,{\\sigma_{ij}}'\\,{\\sigma_{ij}}'} = \\sqrt{\\dfrac{3}{2}\\,\\dfrac{d\\varepsilon_{ij}^{p}}{d\\lambda} \\, \\dfrac{d\\varepsilon_{ij}^{p}}{d\\lambda}} \\\\\\ &= \\dfrac{1}{d\\lambda}\\,\\sqrt{\\dfrac{3}{2}\\,d\\varepsilon_{ij}^{p} \\, d\\varepsilon_{ij}^{p}} \\\\\\ &= \\dfrac{3}{2}\\,\\dfrac{1}{d\\lambda}\\,\\sqrt{\\dfrac{2}{3}\\,d\\varepsilon_{ij}^{p} \\, d\\varepsilon_{ij}^{p}} \\\\\\ &= \\dfrac{3}{2}\\,\\dfrac{1}{d\\lambda}\\,d{\\bar\\varepsilon}_{ij}^{p} \\end{align*} \u6700\u540e\uff0c\u6839\u636eMises\u5c48\u670d\u6761\u4ef6 \\bar\\sigma = \\sigma_s \\bar\\sigma = \\sigma_s \u5f97\u5230 d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\sigma_s} d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\sigma_s} \u7406\u60f3\u521a\u5851\u6027\u5047\u8bbe\u662f\u5426\u5fc5\u8981\uff1f \u00b6 \u673a\u68b0\u5de5\u4e1a\u51fa\u7248\u793e\u7684\u300a\u6750\u6599\u6210\u578b\u539f\u7406\u300b\u7b49\u8d44\u6599\u5728Livey-Mises\u7406\u8bba\u7684\u5047\u8bbe\u6761\u4ef6\u4e2d\u90fd\u63d0\u5230\u4e86\u7406\u60f3\u521a\u5851\u6027\u5047\u8bbe\uff0c\u90a3\u4e48\u7406\u60f3\u521a\u5851\u6027\u6761\u4ef6\u662f\u5fc5\u987b\u7684\u4e48\uff1f \u7406\u60f3\u521a\u5851\u6027\u5305\u542b\u4e24\u5c42\u610f\u601d\uff1a \u6750\u6599\u53d8\u5f62\u7279\u70b9\u4e3a\u521a\u5851\u6027\uff0c\u5ffd\u7565\u6750\u6599\u7684\u5f39\u6027\u53d8\u5f62\uff0c\u59cb\u7ec8\u53ea\u6709\u5851\u6027\u5e94\u53d8 \u786c\u5316\u6a21\u5f0f\u4e3a\u7406\u60f3\u6a21\u5f0f\uff0c\u5373\u4e00\u65e6\u5c48\u670d\u540e\u6d41\u52a8\u5e94\u529b\u4e0d\u518d\u589e\u52a0 \u7b2c\u4e00\u70b9\u662f\u5fc5\u987b\u7684\uff0c\u56e0\u4e3aLivey-Mises\u7406\u8bba\u786e\u5b9e\u6ca1\u6709\u8003\u8651\u5f39\u6027\u53d8\u5f62\uff1b\u800c\u7b2c\u4e8c\u70b9\u5e76\u6ca1\u6709\u6d89\u53ca\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u65e0\u8bba\u6750\u6599\u662f\u4f55\u79cd\u786c\u5316\u65b9\u5f0f\uff0c\u672c\u7406\u8bba\u90fd\u662f\u9002\u7528\u7684\u3002 Mises\u5c48\u670d\u51c6\u5219\u7684\u5047\u8bbe\u6761\u4ef6\u662f\u5426\u5fc5\u8981\uff1f \u00b6 \u4ece\u5f62\u5f0f\u4e0a\u770b\uff0c\u524d\u9762\u63a8\u5bfc\u8fc7\u7a0b\u4e2d\u53ea\u662f\u6700\u540e\u4e00\u6b65\u6839\u636eMises\u5c48\u670d\u51c6\u5219\u4ee3\u5165\u4e86 \\bar\\sigma=\\sigma_s \\bar\\sigma=\\sigma_s \uff0c\u90a3\u4e48\u5373\u4fbf\u53bb\u9664\u6b64\u6761\u4ef6\uff0c\u4e0d\u662f\u4f9d\u7136\u53ef\u4ee5\u5f97\u5230 d\\lambda d\\lambda \u7684\u8868\u8fbe\u5f0f d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} \u4e48\uff1f \u90a3\u4e48\uff0c\u8fd9\u4e2a\u5047\u8bbe\u6761\u4ef6\u8fd8\u662f\u5fc5\u8981\u7684\u4e48\uff1f \u5b9e\u9645\u4e0a\uff0c \u6211\u4eec\u5e38\u89c1\u7684\u7b49\u6548\u5e94\u529b\u53ea\u662fMises\u7b49\u6548\u5e94\u529b\u4e60\u60ef\u4e0a\u7684\u7b80\u79f0 \u3002\u5728\u4e0d\u540c\u7684\u7406\u8bba\u6846\u67b6\u4e0b\uff0c\u7b49\u6548\u5e94\u529b\u6709\u4e0d\u540c\u7684\u8868\u8fbe\u5f0f\u3002\u6b63\u662f\u5728Mises\u7b49\u6548\u5e94\u529b\u7684\u5b9a\u4e49\u4e0b\uff0c\u624d\u8868\u73b0\u4e3a\uff1a \\bar\\sigma = f(\\sigma'_{ij}) = \\sqrt{\\dfrac{3}{2}\\,{\\sigma_{ij}}'\\,{\\sigma_{ij}}'} \\bar\\sigma = f(\\sigma'_{ij}) = \\sqrt{\\dfrac{3}{2}\\,{\\sigma_{ij}}'\\,{\\sigma_{ij}}'} \u663e\u7136\u524d\u9762\u7684\u63a8\u5bfc\u8fc7\u7a0b\u662f\u57fa\u4e8e\u4e0a\u5f0f\u7684\uff0c\u56e0\u6b64Mises\u5c48\u670d\u51c6\u5219\u662fLevy-Mises\u7406\u8bba\u5fc5\u987b\u7684\u5047\u8bbe\u6761\u4ef6\u4e4b\u4e00\u3002 Mises\u5c48\u670d\u51c6\u5219\u4e0d\u4ec5\u7ed9\u51fa\u4e86 \\bar\\sigma=\\sigma_s \\bar\\sigma=\\sigma_s \uff0c\u8fd8\u7ed9\u51fa\u4e86Mises\u7b49\u6548\u5e94\u529b \\bar\\sigma \\bar\\sigma \u7684\u8868\u8fbe\u5f0f\u3002 \u5c48\u670d\u51c6\u5219\u4e0e\u672c\u6784\u65b9\u7a0b\u7684\u5173\u8054 \u00b6 \u8fdb\u4e00\u6b65\u53ef\u4ee5\u8054\u60f3\u5230\u5c48\u670d\u51c6\u5219\u4e0e\u672c\u6784\u65b9\u7a0b\u662f\u76f8\u4e92\u5173\u8054\u7684\uff0c\u4e8c\u8005\u76f8\u4e92\u9002\u5e94\u3002\u4ee5Livey-Mises\u7406\u8bba\u4e3a\u4f8b\uff0c\u4ece\u5851\u6027\u52bf\u7684\u89d2\u5ea6\u4e5f\u53ef\u4ee5\u63a8\u5bfc\u51faLivey-Mises\u7406\u8bba\u6240\u5305\u542b\u7684\u672c\u6784\u65b9\u7a0b \u5c06\u4ee5\u5e94\u529b\u5f20\u91cf\u7b2c\u4e8c\u4e0d\u53d8\u91cf\u63cf\u8ff0\u7684Mises\u5c48\u670d\u51c6\u5219 f(\\sigma'_{ij}) = {J'}_2-\\frac{1}{3}\\,\\sigma_s^2=0 f(\\sigma'_{ij}) = {J'}_2-\\frac{1}{3}\\,\\sigma_s^2=0 \u4ee3\u5165\u5851\u6027\u52bf\u7406\u8bba d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\,f}{\\partial\\,{\\sigma_{ij}}'} d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\,f}{\\partial\\,{\\sigma_{ij}}'} \u5f97\u5230 d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\left({J'}_2-\\frac{1}{3}\\,\\sigma_s^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,\\frac{\\partial\\left(\\frac{1}{3}\\,{\\bar\\sigma}^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,{\\sigma'}_{ij} d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\left({J'}_2-\\frac{1}{3}\\,\\sigma_s^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,\\frac{\\partial\\left(\\frac{1}{3}\\,{\\bar\\sigma}^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,{\\sigma'}_{ij} \u5373\u5f97\u5230\u4e0eLivey-Mises\u7406\u8bba\u540c\u6837\u7684\u8868\u8fbe\u5f0f\u3002 \u7531\u6b64\u53ef\u4ee5\u4f53\u4f1a\uff1a \u672c\u6784\u65b9\u7a0b\u63cf\u8ff0\u7684\u662f\u7269\u4f53\u7684\u53d8\u5f62\u7279\u6027\uff0c\u5177\u6709\u666e\u9002\u610f\u4e49\uff1b\u800c\u4e00\u65e6\u5177\u4f53\u5316\u5176\u8868\u8fbe\u5f0f\uff08\u901a\u5e38\u542b\u6709\u7b49\u6548\u5e94\u529b\u8fd9\u4e2a\u81ea\u53d8\u91cf\uff09\uff0c\u5219\u4e0e\u4f9d\u8d56\u4e8e\u7b49\u6548\u5e94\u529b\u5b9a\u4e49\u5f0f\u7684\u5c48\u670d\u51c6\u5219\u6709\u4e86\u5173\u8054\u3002 \u603b\u7ed3 \u00b6 Livey-Mises\u7406\u8bba\u7684\u5047\u8bbe\u4e2d\uff1a\u7406\u60f3\u786c\u5316\u6761\u4ef6\u4e0d\u662f\u5fc5\u8981\u7684\uff0cMises\u5c48\u670d\u51c6\u5219\u662f\u5fc5\u987b\u7684\u3002 \u672c\u6784\u65b9\u7a0b\u4e0e\u5c48\u670d\u6761\u4ef6\u56e0\u4e3a\u7b49\u6548\u5e94\u529b\u7684\u5b9a\u4e49\u800c\u7edf\u4e00\u4e8e\u67d0\u79cd\u5173\u7cfb\uff0c\u4f8b\u5982\u80fd\u91cf\u539f\u7406\uff08\u5851\u6027\u52bf\uff09","title":"Levy Mises\u7406\u8bba\u7684\u601d\u8003"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/#levy mises","text":"\u53d1\u5e03\u4e8e\uff1a2013-07-29 | \u5206\u7c7b\uff1a plasticity theory \u589e\u91cf\u7406\u8bba\u6307\u7684\u662f\u7528\u5e94\u53d8\u589e\u91cf\u63cf\u8ff0\u672c\u6784\u5173\u7cfb\uff0c\u53c8\u79f0\u4e3a\u6d41\u52a8\u7406\u8bba\u3002\u672c\u6784\u5173\u7cfb\u5305\u62ec\u4e09\u90e8\u5206\uff1a\u672c\u6784\u65b9\u7a0b\u3001\u5c48\u670d\u6761\u4ef6\u548c\u786c\u5316\u6761\u4ef6\u3002 Levy-Mises\u7406\u8bba \u662f\u5851\u6027\u6210\u5f62\u589e\u91cf\u7406\u8bba\u4e4b\u4e00\uff0c\u5176\u57fa\u672c\u5047\u8bbe\u5982\u4e0b\uff1a \u521a\u5851\u6027\u6750\u6599 Mises\u5c48\u670d\u51c6\u5219 \u5723\u7ef4\u5357\u5047\u8bbe\uff1a\u52a0\u8f7d\u77ac\u65f6\uff0c\u5e94\u529b\u4e3b\u8f74\u4e0e\u5e94\u53d8\u589e\u91cf\u4e3b\u8f74\u91cd\u5408 \u4f53\u79ef\u4e0d\u53d8\u6761\u4ef6","title":"Levy Mises\u7406\u8bba\u7684\u601d\u8003"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/#_1","text":"\u5728\u5723\u7ef4\u5357\u5047\u8bbe\u7684\u57fa\u7840\u4e0a\uff0c\u5047\u8bbe\u5851\u6027\u5e94\u53d8\u589e\u91cf\u7684\u5404\u4e2a\u5206\u91cf\u4e0e\u76f8\u5e94\u504f\u5e94\u529b\u5206\u91cf\u6210\u6bd4\u4f8b d\\varepsilon_{ij}^{p} = d\\lambda\\,{\\sigma_{ij}}' d\\varepsilon_{ij}^{p} = d\\lambda\\,{\\sigma_{ij}}' \u6839\u636e\u7b49\u6548\u5851\u6027\u5e94\u53d8\u589e\u91cf d{\\bar\\varepsilon}_{ij}^{p} d{\\bar\\varepsilon}_{ij}^{p} \u7684\u5b9a\u4e49\u5f0f\u53ca\u4f53\u79ef\u4e0d\u53d8\u6761\u4ef6\u5f97\u5230 d{\\bar\\varepsilon}_{ij}^{p} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon'}_{ij}^{p}\\,d{\\varepsilon'}_{ij}^{p}} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon}_{ij}^{p}\\,d{\\varepsilon}_{ij}^{p}} d{\\bar\\varepsilon}_{ij}^{p} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon'}_{ij}^{p}\\,d{\\varepsilon'}_{ij}^{p}} = \\sqrt{\\frac{2}{3}\\,d{\\varepsilon}_{ij}^{p}\\,d{\\varepsilon}_{ij}^{p}} \u4e8e\u662f\u7b49\u6548\u5e94\u53d8 \\begin{align*} \\bar\\sigma &= \\sqrt{\\dfrac{3}{2}\\,{\\sigma_{ij}}'\\,{\\sigma_{ij}}'} = \\sqrt{\\dfrac{3}{2}\\,\\dfrac{d\\varepsilon_{ij}^{p}}{d\\lambda} \\, \\dfrac{d\\varepsilon_{ij}^{p}}{d\\lambda}} \\\\\\ &= \\dfrac{1}{d\\lambda}\\,\\sqrt{\\dfrac{3}{2}\\,d\\varepsilon_{ij}^{p} \\, d\\varepsilon_{ij}^{p}} \\\\\\ &= \\dfrac{3}{2}\\,\\dfrac{1}{d\\lambda}\\,\\sqrt{\\dfrac{2}{3}\\,d\\varepsilon_{ij}^{p} \\, d\\varepsilon_{ij}^{p}} \\\\\\ &= \\dfrac{3}{2}\\,\\dfrac{1}{d\\lambda}\\,d{\\bar\\varepsilon}_{ij}^{p} \\end{align*} \u6700\u540e\uff0c\u6839\u636eMises\u5c48\u670d\u6761\u4ef6 \\bar\\sigma = \\sigma_s \\bar\\sigma = \\sigma_s \u5f97\u5230 d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\sigma_s} d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\sigma_s}","title":"\u63a8\u5bfc\u8fc7\u7a0b"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/#_2","text":"\u673a\u68b0\u5de5\u4e1a\u51fa\u7248\u793e\u7684\u300a\u6750\u6599\u6210\u578b\u539f\u7406\u300b\u7b49\u8d44\u6599\u5728Livey-Mises\u7406\u8bba\u7684\u5047\u8bbe\u6761\u4ef6\u4e2d\u90fd\u63d0\u5230\u4e86\u7406\u60f3\u521a\u5851\u6027\u5047\u8bbe\uff0c\u90a3\u4e48\u7406\u60f3\u521a\u5851\u6027\u6761\u4ef6\u662f\u5fc5\u987b\u7684\u4e48\uff1f \u7406\u60f3\u521a\u5851\u6027\u5305\u542b\u4e24\u5c42\u610f\u601d\uff1a \u6750\u6599\u53d8\u5f62\u7279\u70b9\u4e3a\u521a\u5851\u6027\uff0c\u5ffd\u7565\u6750\u6599\u7684\u5f39\u6027\u53d8\u5f62\uff0c\u59cb\u7ec8\u53ea\u6709\u5851\u6027\u5e94\u53d8 \u786c\u5316\u6a21\u5f0f\u4e3a\u7406\u60f3\u6a21\u5f0f\uff0c\u5373\u4e00\u65e6\u5c48\u670d\u540e\u6d41\u52a8\u5e94\u529b\u4e0d\u518d\u589e\u52a0 \u7b2c\u4e00\u70b9\u662f\u5fc5\u987b\u7684\uff0c\u56e0\u4e3aLivey-Mises\u7406\u8bba\u786e\u5b9e\u6ca1\u6709\u8003\u8651\u5f39\u6027\u53d8\u5f62\uff1b\u800c\u7b2c\u4e8c\u70b9\u5e76\u6ca1\u6709\u6d89\u53ca\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u65e0\u8bba\u6750\u6599\u662f\u4f55\u79cd\u786c\u5316\u65b9\u5f0f\uff0c\u672c\u7406\u8bba\u90fd\u662f\u9002\u7528\u7684\u3002","title":"\u7406\u60f3\u521a\u5851\u6027\u5047\u8bbe\u662f\u5426\u5fc5\u8981\uff1f"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/#mises","text":"\u4ece\u5f62\u5f0f\u4e0a\u770b\uff0c\u524d\u9762\u63a8\u5bfc\u8fc7\u7a0b\u4e2d\u53ea\u662f\u6700\u540e\u4e00\u6b65\u6839\u636eMises\u5c48\u670d\u51c6\u5219\u4ee3\u5165\u4e86 \\bar\\sigma=\\sigma_s \\bar\\sigma=\\sigma_s \uff0c\u90a3\u4e48\u5373\u4fbf\u53bb\u9664\u6b64\u6761\u4ef6\uff0c\u4e0d\u662f\u4f9d\u7136\u53ef\u4ee5\u5f97\u5230 d\\lambda d\\lambda \u7684\u8868\u8fbe\u5f0f d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} d\\lambda = \\dfrac{3\\,d{\\bar\\varepsilon}_{ij}^{p}}{2\\,\\bar\\sigma} \u4e48\uff1f \u90a3\u4e48\uff0c\u8fd9\u4e2a\u5047\u8bbe\u6761\u4ef6\u8fd8\u662f\u5fc5\u8981\u7684\u4e48\uff1f \u5b9e\u9645\u4e0a\uff0c \u6211\u4eec\u5e38\u89c1\u7684\u7b49\u6548\u5e94\u529b\u53ea\u662fMises\u7b49\u6548\u5e94\u529b\u4e60\u60ef\u4e0a\u7684\u7b80\u79f0 \u3002\u5728\u4e0d\u540c\u7684\u7406\u8bba\u6846\u67b6\u4e0b\uff0c\u7b49\u6548\u5e94\u529b\u6709\u4e0d\u540c\u7684\u8868\u8fbe\u5f0f\u3002\u6b63\u662f\u5728Mises\u7b49\u6548\u5e94\u529b\u7684\u5b9a\u4e49\u4e0b\uff0c\u624d\u8868\u73b0\u4e3a\uff1a \\bar\\sigma = f(\\sigma'_{ij}) = \\sqrt{\\dfrac{3}{2}\\,{\\sigma_{ij}}'\\,{\\sigma_{ij}}'} \\bar\\sigma = f(\\sigma'_{ij}) = \\sqrt{\\dfrac{3}{2}\\,{\\sigma_{ij}}'\\,{\\sigma_{ij}}'} \u663e\u7136\u524d\u9762\u7684\u63a8\u5bfc\u8fc7\u7a0b\u662f\u57fa\u4e8e\u4e0a\u5f0f\u7684\uff0c\u56e0\u6b64Mises\u5c48\u670d\u51c6\u5219\u662fLevy-Mises\u7406\u8bba\u5fc5\u987b\u7684\u5047\u8bbe\u6761\u4ef6\u4e4b\u4e00\u3002 Mises\u5c48\u670d\u51c6\u5219\u4e0d\u4ec5\u7ed9\u51fa\u4e86 \\bar\\sigma=\\sigma_s \\bar\\sigma=\\sigma_s \uff0c\u8fd8\u7ed9\u51fa\u4e86Mises\u7b49\u6548\u5e94\u529b \\bar\\sigma \\bar\\sigma \u7684\u8868\u8fbe\u5f0f\u3002","title":"Mises\u5c48\u670d\u51c6\u5219\u7684\u5047\u8bbe\u6761\u4ef6\u662f\u5426\u5fc5\u8981\uff1f"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/#_3","text":"\u8fdb\u4e00\u6b65\u53ef\u4ee5\u8054\u60f3\u5230\u5c48\u670d\u51c6\u5219\u4e0e\u672c\u6784\u65b9\u7a0b\u662f\u76f8\u4e92\u5173\u8054\u7684\uff0c\u4e8c\u8005\u76f8\u4e92\u9002\u5e94\u3002\u4ee5Livey-Mises\u7406\u8bba\u4e3a\u4f8b\uff0c\u4ece\u5851\u6027\u52bf\u7684\u89d2\u5ea6\u4e5f\u53ef\u4ee5\u63a8\u5bfc\u51faLivey-Mises\u7406\u8bba\u6240\u5305\u542b\u7684\u672c\u6784\u65b9\u7a0b \u5c06\u4ee5\u5e94\u529b\u5f20\u91cf\u7b2c\u4e8c\u4e0d\u53d8\u91cf\u63cf\u8ff0\u7684Mises\u5c48\u670d\u51c6\u5219 f(\\sigma'_{ij}) = {J'}_2-\\frac{1}{3}\\,\\sigma_s^2=0 f(\\sigma'_{ij}) = {J'}_2-\\frac{1}{3}\\,\\sigma_s^2=0 \u4ee3\u5165\u5851\u6027\u52bf\u7406\u8bba d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\,f}{\\partial\\,{\\sigma_{ij}}'} d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\,f}{\\partial\\,{\\sigma_{ij}}'} \u5f97\u5230 d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\left({J'}_2-\\frac{1}{3}\\,\\sigma_s^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,\\frac{\\partial\\left(\\frac{1}{3}\\,{\\bar\\sigma}^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,{\\sigma'}_{ij} d{\\varepsilon'}_{ij}^{p} = d\\lambda\\,\\frac{\\partial\\left({J'}_2-\\frac{1}{3}\\,\\sigma_s^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,\\frac{\\partial\\left(\\frac{1}{3}\\,{\\bar\\sigma}^2\\right)}{\\partial\\,{\\sigma_{ij}}'} = d\\lambda\\,{\\sigma'}_{ij} \u5373\u5f97\u5230\u4e0eLivey-Mises\u7406\u8bba\u540c\u6837\u7684\u8868\u8fbe\u5f0f\u3002 \u7531\u6b64\u53ef\u4ee5\u4f53\u4f1a\uff1a \u672c\u6784\u65b9\u7a0b\u63cf\u8ff0\u7684\u662f\u7269\u4f53\u7684\u53d8\u5f62\u7279\u6027\uff0c\u5177\u6709\u666e\u9002\u610f\u4e49\uff1b\u800c\u4e00\u65e6\u5177\u4f53\u5316\u5176\u8868\u8fbe\u5f0f\uff08\u901a\u5e38\u542b\u6709\u7b49\u6548\u5e94\u529b\u8fd9\u4e2a\u81ea\u53d8\u91cf\uff09\uff0c\u5219\u4e0e\u4f9d\u8d56\u4e8e\u7b49\u6548\u5e94\u529b\u5b9a\u4e49\u5f0f\u7684\u5c48\u670d\u51c6\u5219\u6709\u4e86\u5173\u8054\u3002","title":"\u5c48\u670d\u51c6\u5219\u4e0e\u672c\u6784\u65b9\u7a0b\u7684\u5173\u8054"},{"location":"2013-07-29-Levy-Mises%E7%90%86%E8%AE%BA%E7%9A%84%E6%80%9D%E8%80%83/#_4","text":"Livey-Mises\u7406\u8bba\u7684\u5047\u8bbe\u4e2d\uff1a\u7406\u60f3\u786c\u5316\u6761\u4ef6\u4e0d\u662f\u5fc5\u8981\u7684\uff0cMises\u5c48\u670d\u51c6\u5219\u662f\u5fc5\u987b\u7684\u3002 \u672c\u6784\u65b9\u7a0b\u4e0e\u5c48\u670d\u6761\u4ef6\u56e0\u4e3a\u7b49\u6548\u5e94\u529b\u7684\u5b9a\u4e49\u800c\u7edf\u4e00\u4e8e\u67d0\u79cd\u5173\u7cfb\uff0c\u4f8b\u5982\u80fd\u91cf\u539f\u7406\uff08\u5851\u6027\u52bf\uff09","title":"\u603b\u7ed3"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/","text":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-07-30 | \u5206\u7c7b\uff1a plasticity theory , mathematics \u4ece\u672c\u79d1\u7684\u6750\u6599\u6210\u5f62\u539f\u7406\u6559\u6750\u4e0a\u8ba4\u8bc6\u4e86\u5e94\u529b\u5f20\u91cf\u540e\uff0c\u5b83\u4fbf\u4e00\u76f4\u51fa\u73b0\u5728\u6211\u4eec\u7684\u89c6\u91ce\u91cc\u3002\u521d\u59cb\uff0c\u4ec5\u662f\u4e00\u4e2a\u57fa\u672c\u5b9a\u4e49\u63a5\u53d7\u4e86\u5b83\uff0c\u8fdb\u800c\u6709\u8fc7\u7591\u60d1\uff0c\u968f\u7740\u77e9\u9635\u8bba\u7684\u5b66\u4e60\u53c8\u6709\u4e86\u65b0\u7684\u8ba4\u8bc6\u3002\u66fe\u7ecf\u5c31\u6709\u8bb0\u5f55\u4e0b\u5bf9\u5176\u7406\u89e3\u7684\u60f3\u6cd5\uff0c\u4f46\u56e0\u601d\u8def\u5c1a\u672a\u5b8c\u5584\u800c\u4e00\u518d\u6401\u7f6e\uff1b\u76f4\u5230\u4eca\u5929\u91cd\u65b0\u60f3\u8d77\uff0c\u5e76\u5b8c\u6210\u4e86\u65b9\u5411\u4f59\u5f26\u4f5c\u4e3a\u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e\uff0c\u624d\u7ec8\u4e8e\u5f00\u59cb\u8be6\u7ec6\u8bb0\u5f55\u3002 \u6839\u636e\u6211\u5bf9\u5e94\u529b\u5f20\u91cf\u7684\u9636\u6bb5\u6027\u8ba4\u8bc6\uff0c\u76f8\u5e94\u5206\u4e3a\u4e09\u90e8\u5206\u8fdb\u884c\u8bb0\u5f55\u3002\u672c\u6587\u4ecb\u7ecd\u7b2c\u4e00\u90e8\u5206\uff0c\u5e94\u529b\u7684\u57fa\u672c\u77e5\u8bc6\u548c\u5e38\u89c4\u8ba4\u8bc6\u3002 \u5e94\u529b \u00b6 \u521d\u4e2d\u7269\u7406\u5df2\u6307\u51fa\uff0c\u56e0\u5916\u529b\u4f5c\u7528\u800c\u5728\u7269\u4f53\u5185\u90e8\u4ea7\u751f\u7684\u529b\u79f0\u4e3a \u5185\u529b \u3002\u5355\u4f4d\u9762\u79ef\u4e0a\u7684\u5185\u529b\u5373\u662f \u5e94\u529b \uff0c\u8868\u5f81\u5185\u529b\u7684\u5f3a\u5ea6\u3002 \u4e3a\u4e86\u7814\u7a76\u67d0\u4e00\u70b9 P P \u5904\u7684\u5e94\u529b\uff0c\u7528\u4efb\u610f\u622a\u9762\u5728 P P \u70b9\u5904\u5207\u5f00\u7269\u4f53\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u6839\u636e\u5b9a\u4e49\u53ef\u4ee5\u5f97\u5230 P P \u70b9\u7684\u6b63\u5e94\u529b \\sigma \\sigma \u3001\u5207\u5e94\u529b \\tau \\tau \uff0c\u4ed6\u4eec\u7684\u5408\u6210\u5373\u4e3a\u5168\u5e94\u529b\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e00\u4e2a\u786e\u5b9a\u7684\u622a\u9762\u5bf9\u5e94\u4e86\u4e00\u7ec4\u6b63\u5e94\u529b\u548c\u5207\u5e94\u529b\u3002\u4f46\u662f\u8fc7 P P \u70b9\u6709\u65e0\u6570\u7684\u622a\u9762\uff0c\u90a3\u4e48\u5982\u4f55\u624d\u80fd\u771f\u6b63\u63cf\u8ff0 P P \u70b9\u7684\u5e94\u529b\u72b6\u6001\u5462\uff1f \u5e94\u529b\u72b6\u6001 \u00b6 \u5e94\u529b\u72b6\u6001 \u662f\u53d7\u529b\u7269\u4f53\u67d0\u4e00\u70b9\u5404\u4e2a\u622a\u9762\u4e0a\u5e94\u529b\u7684\u53d8\u5316\u60c5\u51b5\u3002\u4e0a\u9762\u5df2\u7ecf\u610f\u8bc6\u5230\u8fc7\u4e00\u70b9\u6709\u65e0\u6570\u7684\u622a\u9762\uff0c\u53ea\u6709\u4efb\u610f\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\u90fd\u88ab\u786e\u5b9a\uff0c\u624d\u80fd\u8bf4\u5e94\u529b\u72b6\u6001\u662f\u786e\u5b9a\u7684\u3002 \u901a\u5e38\u5728\u65e0\u6570\u7684\u622a\u9762\u4e2d\uff0c\u4efb\u610f\u53d6\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\uff0c\u5e76\u4ee5\u4ed6\u4eec\u7684\u6cd5\u7ebf\u65b9\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\u3002\u4e5f\u5373\u5728 P P \u70b9\u622a\u53d6\u4e00\u4e2a\u65e0\u9650\u5c0f\u7684\u5e73\u884c\u516d\u9762\u4f53\uff0c\u79f0\u4e3a \u5355\u5143\u4f53 \u3002 \u5355\u5143\u4f53\u65e0\u9650\u5c0f\uff0c\u56e0\u6b64\u5355\u5143\u4f53\u4e0a\u76f8\u4e92\u5e73\u884c\u7684\u4e24\u4e2a\u5e73\u9762\u89c6\u4e3a\u8fc7\u8be5\u70b9\u7684\u540c\u4e00\u5e73\u9762\uff0c\u4e5f\u5373\u4ed6\u4fe9\u7684\u5e94\u529b\u662f\u76f8\u540c\u7684\u3002\u8fd9\u6837\u53ea\u7528\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5373\u53ef\u5206\u6790\u95ee\u9898\u3002 \u7531\u4e8e\u5355\u5143\u4f53\u5904\u4e8e\u9759\u529b\u5e73\u8861\u72b6\u6001\uff0c\u7531\u7ed5\u5404\u8f74\u5408\u529b\u77e9\u4e3a\u96f6\u53ef\u4ee5\u5f97\u5230\u5207\u5e94\u529b\u4e92\u7b49\u5b9a\u5f8b\u3002 \u65e2\u7136\u5355\u5143\u4f53\u4e0a\u76f8\u4e92\u5e73\u884c\u7684\u4e24\u4e2a\u5e73\u9762\u89c6\u4e3a\u8fc7\u8be5\u70b9\u7684\u540c\u4e00\u5e73\u9762\uff0c\u90a3\u4e3a\u4ec0\u4e48\u4e0a\u56fe\u5e73\u884c\u7684\u5e73\u9762\u4e0a\u5e94\u529b\u662f\u76f8\u53cd\u7684\uff1f \u5355\u5143\u4f53\u4e0a\u76f8\u4e92\u5e73\u884c\u7684\u4e24\u4e2a\u5e73\u9762\u89c6\u4e3a\u8fc7\u8be5\u70b9\u7684\u540c\u4e00\u5e73\u9762\uff0c\u4f46\u662f\u5206\u522b\u662f\u88ab\u622a\u5f00\u7684\u4e24\u90e8\u5206\u7684\u5e73\u9762\u3002\u622a\u5f00\u524d\u4ed6\u4eec\u662f\u91cd\u5408\u7684\uff0c\u622a\u5f00\u540e\u6210\u4e3a\u4e86\u4e24\u90e8\u5206\u5404\u81ea\u7684\u8868\u9762\uff0c\u800c\u5916\u8868\u9762\u662f\u6709\u65b9\u5411\u7684\u3002\u6240\u4ee5\uff0c\u4ece\u5404\u81ea\u7684\u65b9\u5411\u4e0a\u6765\u770b\uff0c\u5e94\u529b\u65b9\u5411\u8fd8\u662f\u76f8\u540c\u7684\u3002 \u5e94\u529b\u5f20\u91cf \u00b6 \u6839\u636e\u4e0a\u9762\u5355\u5143\u4f53\u4e0a\u7684\u5e94\u529b\u5206\u91cf\uff0c\u662f\u5426\u53ef\u4ee5\u6c42\u51fa\u4e0b\u56fe\u6240\u793a\u4efb\u610f\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\uff1f \u7b54\u6848\u662f\u80af\u5b9a\u7684\u3002\u6839\u636e\u4e09\u4e2a\u65b9\u5411\u7684\u9759\u529b\u5e73\u8861\u5c31\u53ef\u4ee5\u8ba1\u7b97\u5f97\u5230\u4e0a\u56fe\u6cd5\u5411\u4e3a \\vec{n}=(n_1,n_2,n_3) \\vec{n}=(n_1,n_2,n_3) \u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\u3002\u4e8e\u662f\uff0c\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\u4e0a\u76849\u4e2a\u5e94\u529b\u5206\u91cf\u53ef\u4ee5\u786e\u5b9a\u4efb\u610f\u622a\u9762\u7684\u5e94\u529b\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e00\u70b9\u7684\u5e94\u529b\u72b6\u6001\u88ab\u5b8c\u5168\u786e\u5b9a\u4e86\u3002\u5e76\u4e14\uff0c\u4ece\u8fd9\u4e09\u4e2a\u6b63\u4ea4\u622a\u9762\u7684\u9009\u53d6\u4e0a\u6765\u770b\uff0c\u4ed6\u4eec\u548c\u5750\u6807\u7cfb\u65e0\u5173\u3002 \u4e8e\u662f\uff0c\u6211\u4eec\u628a\u5355\u5143\u4f53\u4e0a\u7684\u4e5d\u4e2a\u5e94\u529b\u5206\u91cf\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u63cf\u8ff0 P P \u70b9\u7684\u5e94\u529b\u72b6\u6001\uff0c\u79f0\u4f5c \u5e94\u529b\u5f20\u91cf \uff0c\u8bb0\u4f5c \\[ \\sigma_{ij} = \\begin{pmatrix} \\sigma_x & \\tau_{xy} & \\tau_{xz} \\\\\\ \\tau_{yx} & \\sigma_y & \\sigma_{yz} \\\\\\ \\tau_{zx} & \\tau_{zy} & \\sigma_z \\end{pmatrix} \\] \u4e3b\u5e94\u529b \u00b6 \u5982\u679c\u4f5c\u7528\u5728\u67d0\u4e00\u622a\u9762\u4e0a\u7684\u5168\u5e94\u529b\u548c\u8fd9\u4e00\u622a\u9762\u5782\u76f4\uff0c\u5373\u8be5\u622a\u9762\u4e0a\u53ea\u6709\u6b63\u5e94\u529b\uff0c\u5219\u8fd9\u4e00\u622a\u9762\u79f0\u4e3a \u4e3b\u5e73\u9762 \uff0c\u5176\u6cd5\u7ebf\u65b9\u5411\u79f0\u4e3a\u5e94\u529b\u4e3b\u65b9\u5411\uff0c\u8be5\u622a\u9762\u7684\u5e94\u529b\u79f0\u4e3a \u4e3b\u5e94\u529b \u3002\u5982\u679c\u4e09\u4e2a\u5750\u6807\u8f74\u65b9\u5411\u90fd\u662f\u4e3b\u65b9\u5411\uff0c\u5219\u79f0\u8fd9\u4e00\u5750\u6807\u7cfb\u4e3a \u4e3b\u8f74\u5750\u6807\u7cfb \u3002 \u786e\u5b9a\u65b9\u6cd5\u4f9d\u7136\u662f\u6c42\u89e3\u9759\u529b\u5e73\u8861\u65b9\u7a0b\u3002 \u5e94\u529b\u5f20\u91cf\u4e0d\u53d8\u91cf \u00b6 \u5728\u6c42\u89e3\u4e3b\u5e94\u529b\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u5f97\u5230\u4ee5\u4e3b\u5e94\u529b\u4e3a\u672a\u77e5\u6570\u7684\u4e09\u6b21\u65b9\u7a0b\uff0c\u53eb\u505a \u72b6\u6001\u65b9\u7a0b \u3002 \\sigma^3-I_1\\,\\sigma^2+I_2\\,\\sigma-I_3=0 \\sigma^3-I_1\\,\\sigma^2+I_2\\,\\sigma-I_3=0 \u72b6\u6001\u65b9\u7a0b\u7684\u4e09\u4e2a\u7cfb\u6570\u7531\u4e3b\u5e94\u529b\u552f\u4e00\u786e\u5b9a\uff0c\u800c\u4e00\u70b9\u7684\u4e3b\u5e94\u529b\u662f\u552f\u4e00\u7684\uff0c\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u4e0d\u968f\u5750\u6807\u7cfb\u53d8\u5316\u7684\u4e09\u4e2a\u91cf\uff0c\u53eb\u4f5c \u5e94\u529b\u5f20\u91cf\u4e0d\u53d8\u91cf \\[ \\begin{align*} I_1 &= \\sigma_1 + \\sigma_2 + \\sigma_3 \\\\\\ I_2 &= \\sigma_1 \\, \\sigma_2 + \\sigma_2 \\, \\sigma_3 + \\sigma_3 \\, \\sigma_1 \\\\\\ I_3 &= \\sigma_1 \\, \\sigma_2 \\, \\sigma_3 \\end{align*} \\] \u7528\u4e00\u822c\u5e94\u529b\u8868\u793a\u4e3a \\[ \\begin{align*} I_1 &= \\sigma_x + \\sigma_y + \\sigma_z \\\\\\ I_2 &= \\sigma_x \\, \\sigma_y + \\sigma_y \\, \\sigma_z + \\sigma_z \\, \\sigma_x - \\tau_{xy}^2 - \\tau_{yz}^2 - \\tau_{zx}^2 \\\\\\ I_3 &= \\sigma_x \\, \\sigma_y \\, \\sigma_z + 2\\,\\tau_{xy}\\,\\tau_{yz}\\,\\tau_{zx} - \\sigma_x\\,\\tau_{yz}^2 - \\sigma_y\\,\\tau_{zx}^2 - \\sigma_z\\,\\tau_{xy}^2 \\end{align*} \\] \u4e3b\u5207\u5e94\u529b \u00b6 \u5207\u5e94\u529b\u6709\u6781\u503c\u7684\u622a\u9762\u53eb\u4e3b\u5207\u5e94\u529b\u5e73\u9762\uff0c\u622a\u9762\u4e0a\u7684\u5207\u5e94\u529b\u53eb\u4f5c \u4e3b\u5207\u5e94\u529b \u3002\u516d\u4e2a\u4e3b\u5207\u5e94\u529b\u4e2d\u7edd\u5bf9\u503c\u6700\u5927\u7684\u53eb\u4f5c\u6700\u5927\u5207\u5e94\u529b\u3002\u901a\u8fc7\u8ba1\u7b97\u53ef\u77e5\uff0c\u4e3b\u5207\u5e94\u529b\u5e73\u9762\u4e0e\u4e3b\u5e94\u529b\u5e73\u9762\u621045\u00b0\u5939\u89d2\u3002\u4e0b\u8868\u662f\u4e3b\u5207\u5e94\u529b\u5e73\u9762\u4e0a\u7684\u6b63\u5e94\u529b\u3001\u5207\u5e94\u529b\u503c\uff1a \u4e3b\u5207\u5e94\u529b\u5e73\u9762 \u5207\u5e94\u529b \u6b63\u5e94\u529b \\left(0,\\,\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\left(0,\\,\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\pm\\dfrac{\\sigma_2-\\sigma_3}{2} \\pm\\dfrac{\\sigma_2-\\sigma_3}{2} \\dfrac{\\sigma_2+\\sigma_3}{2} \\dfrac{\\sigma_2+\\sigma_3}{2} \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,0,\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,0,\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\pm\\dfrac{\\sigma_1-\\sigma_3}{2} \\pm\\dfrac{\\sigma_1-\\sigma_3}{2} \\dfrac{\\sigma_1+\\sigma_3}{2} \\dfrac{\\sigma_1+\\sigma_3}{2} \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\,0,\\right) \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\,0,\\right) \\pm\\dfrac{\\sigma_1-\\sigma_2}{2} \\pm\\dfrac{\\sigma_1-\\sigma_2}{2} \\dfrac{\\sigma_1+\\sigma_2}{2} \\dfrac{\\sigma_1+\\sigma_2}{2} \u7531\u4e8e\u5851\u6027\u53d8\u5f62\u662f\u7531\u5207\u5e94\u529b\u5f15\u8d77\u7684\uff0c\u6240\u4ee5\u6700\u5927\u5207\u5e94\u529b\u53ef\u4ee5\u4f5c\u4e3a\u5c48\u670d\u51c6\u5219\u3002 \u5e94\u529b\u5f20\u91cf\u5206\u89e3 \u00b6 \u5c06\u4e09\u4e2a\u6b63\u5e94\u529b\u7684\u5e73\u5747\u503c\u53eb\u4f5c\u5e73\u5747\u5e94\u529b\u6216\u8005\u9759\u6c34\u5e94\u529b\uff0c\u5e94\u529b\u5f20\u91cf\u51cf\u53bb\u8fd9\u90e8\u5206\u540e\u5f97\u5230 \u5e94\u529b\u504f\u5f20\u91cf \u3002\u5e94\u529b\u504f\u5f20\u91cf\u540c\u6837\u6709\u4e09\u4e2a\u4e0d\u53d8\u91cf\u3002 \\sigma_m = \\dfrac{1}{3}\\left(\\sigma_x+\\sigma_y+\\sigma_z\\right) = \\dfrac{1}{3}\\left(\\sigma_{11}+\\sigma_{22}+\\sigma_{33}\\right) \\sigma_m = \\dfrac{1}{3}\\left(\\sigma_x+\\sigma_y+\\sigma_z\\right) = \\dfrac{1}{3}\\left(\\sigma_{11}+\\sigma_{22}+\\sigma_{33}\\right) \\[ \\begin{pmatrix} \\sigma_x & \\tau_{xy} & \\tau_{xz} \\\\\\ \\tau_{yx} & \\sigma_y & \\sigma_{yz} \\\\\\ \\tau_{zx} & \\tau_{zy} & \\sigma_z \\end{pmatrix} = \\begin{pmatrix} \\sigma_m & 0 & 0 \\\\\\ 0 & \\sigma_m & 0 \\\\\\ 0 & 0 & \\sigma_m \\end{pmatrix} + \\begin{pmatrix} \\sigma_x-\\sigma_m & \\tau_{xy} & \\tau_{xz} \\\\\\ \\tau_{yx} & \\sigma_y-\\sigma_m & \\sigma_{yz} \\\\\\ \\tau_{zx} & \\tau_{zy} & \\sigma_z-\\sigma_m \\end{pmatrix} \\] \u5e94\u529b\u5f20\u91cf\u5206\u89e3\u7684\u7269\u7406\u610f\u4e49\u5728\u4e8e\uff1a \u7269\u4f53\u5728\u5e94\u529b\u5f20\u91cf\u4f5c\u7528\u4e0b\u7684\u53d8\u5f62\u5206\u4e3a\u4f53\u79ef\u53d8\u5316\u548c\u5f62\u72b6\u53d8\u5316\u4e24\u90e8\u5206\uff1b\u524d\u8005\u53d6\u51b3\u4e8e\u5e94\u529b\u7403\u5f20\u91cf\uff0c\u540e\u8005\u53d6\u51b3\u4e8e\u5e94\u529b\u504f\u5f20\u91cf\u3002 \u4f53\u79ef\u53d8\u5316\u8868\u5f81\u5f39\u6027\u53d8\u5f62\uff0c\u5f53\u5e94\u529b\u504f\u5f20\u91cf\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u540e\uff0c\u5219\u7269\u4f53\u53d1\u751f\u5851\u6027\u53d8\u5f62\u3002 \u5e94\u529b\u5e73\u8861\u5fae\u5206\u65b9\u7a0b \u00b6 \u4ee5\u4e0a\u8bf4\u660e\u7684\u90fd\u662f\u4e00\u70b9\u7684\u5e94\u529b\u72b6\u6001\uff0c\u800c\u7269\u4f53\u5185\u90e8\u4e0d\u540c\u70b9\u7684\u5e94\u529b\u72b6\u6001\u4e00\u822c\u662f\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u5982\u4f55\u63cf\u8ff0\u76f8\u90bb\u70b9\u95f4\u7684\u5e94\u529b\u53d8\u5316\u5173\u7cfb\u5462\uff1f \u4ee5\u7269\u4f53\u5185\u67d0\u4e00\u70b9 P(x,y,z) P(x,y,z) \u4e3a\u9876\u70b9\u622a\u53d6\u8fb9\u957f\u5206\u522b\u4e3adx,dy,dz\u7684\u76f4\u89d2\u5e73\u884c\u516d\u9762\u4f53\u5fae\u5143\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5219\u53e6\u4e00\u9876\u70b9\u7684\u5750\u6807\u4e3a (x+dx,y+dy,z+dz) (x+dx,y+dy,z+dz) \u3002 \u6839\u636e\u9759\u529b\u5e73\u8861\u65b9\u7a0b\uff0c\u5e76\u5904\u7406\u6389\u9ad8\u9636\u5c0f\u91cf\uff0c\u5f97\u5230\u5e94\u529b\u5e73\u8861\u5fae\u5206\u65b9\u7a0b\uff1a \\[ \\begin{align*} \\dfrac{\\partial\\sigma_x}{\\partial\\,x}+\\dfrac{\\partial\\tau_{yx}}{\\partial\\,y}+\\dfrac{\\partial\\tau_{zx}}{\\partial\\,z} &= 0 \\\\\\ \\dfrac{\\partial\\tau_{xy}}{\\partial\\,x}+\\dfrac{\\partial\\sigma_y}{\\partial\\,y}+\\dfrac{\\partial\\tau_{zy}}{\\partial\\,z} &= 0 \\\\\\ \\dfrac{\\partial\\tau_{xz}}{\\partial\\,x}+\\dfrac{\\partial\\tau_{yz}}{\\partial\\,y}+\\dfrac{\\partial\\sigma_z}{\\partial\\,z} &= 0 \\end{align*} \\] \u8fd9\u90e8\u5206\u5fae\u516d\u9762\u4f53\u5e94\u529b\u72b6\u6001\u5206\u6790\u56fe\u4e0e\u4e4b\u524d\u70b9\u7684\u5e94\u529b\u72b6\u6001\u56fe\u5373\u4e3a\u76f8\u4f3c\uff0c\u5374\u6709\u4e0d\u540c\uff0c\u5982\u4f55\u7406\u89e3\uff1f \u4e8c\u8005\u7684\u6db5\u4e49\u5b8c\u5168\u4e0d\u540c\u3002\u70b9\u7684\u5e94\u529b\u72b6\u6001\u56fe\u5f3a\u8c03\u7684\u662f\u540c\u4e00\u4e2a\u70b9\u5728\u4e0d\u540c\u622a\u9762\u4e0b\u7684\u72b6\u6001\uff0c\u800c\u5fae\u516d\u9762\u4f53\u5e94\u529b\u72b6\u6001\u5206\u6790\u5f3a\u8c03\u7684\u662f\u76f8\u90bb\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u5e94\u529b\u5173\u7cfb\u3002\u53ef\u4ee5\u8bf4\u524d\u8005\u662f\u9759\u6001\u7684\uff0c\u540e\u8005\u63ed\u793a\u7684\u662f\u76f8\u4e92\u4f5c\u7528\u7684\u5173\u7cfb\u3002 \u603b\u7ed3 \u00b6 \u8fd9\u4e00\u90e8\u5206\u68b3\u7406\u4e86\u6211\u4eec\u5e38\u89c4\u5b66\u4e60\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u6982\u62ec\u4e3a\u4e24\u70b9\uff1a \u5e94\u529b\u5f20\u91cf\u2014\u2014\u67d0\u70b9\u7684\u5e94\u529b\u72b6\u6001 \u5e94\u529b\u5e73\u8861\u65b9\u7a0b\u2014\u2014\u76f8\u90bb\u70b9\u7684\u76f8\u4e92\u4f5c\u7528","title":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2013-07-30 | \u5206\u7c7b\uff1a plasticity theory , mathematics \u4ece\u672c\u79d1\u7684\u6750\u6599\u6210\u5f62\u539f\u7406\u6559\u6750\u4e0a\u8ba4\u8bc6\u4e86\u5e94\u529b\u5f20\u91cf\u540e\uff0c\u5b83\u4fbf\u4e00\u76f4\u51fa\u73b0\u5728\u6211\u4eec\u7684\u89c6\u91ce\u91cc\u3002\u521d\u59cb\uff0c\u4ec5\u662f\u4e00\u4e2a\u57fa\u672c\u5b9a\u4e49\u63a5\u53d7\u4e86\u5b83\uff0c\u8fdb\u800c\u6709\u8fc7\u7591\u60d1\uff0c\u968f\u7740\u77e9\u9635\u8bba\u7684\u5b66\u4e60\u53c8\u6709\u4e86\u65b0\u7684\u8ba4\u8bc6\u3002\u66fe\u7ecf\u5c31\u6709\u8bb0\u5f55\u4e0b\u5bf9\u5176\u7406\u89e3\u7684\u60f3\u6cd5\uff0c\u4f46\u56e0\u601d\u8def\u5c1a\u672a\u5b8c\u5584\u800c\u4e00\u518d\u6401\u7f6e\uff1b\u76f4\u5230\u4eca\u5929\u91cd\u65b0\u60f3\u8d77\uff0c\u5e76\u5b8c\u6210\u4e86\u65b9\u5411\u4f59\u5f26\u4f5c\u4e3a\u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e\uff0c\u624d\u7ec8\u4e8e\u5f00\u59cb\u8be6\u7ec6\u8bb0\u5f55\u3002 \u6839\u636e\u6211\u5bf9\u5e94\u529b\u5f20\u91cf\u7684\u9636\u6bb5\u6027\u8ba4\u8bc6\uff0c\u76f8\u5e94\u5206\u4e3a\u4e09\u90e8\u5206\u8fdb\u884c\u8bb0\u5f55\u3002\u672c\u6587\u4ecb\u7ecd\u7b2c\u4e00\u90e8\u5206\uff0c\u5e94\u529b\u7684\u57fa\u672c\u77e5\u8bc6\u548c\u5e38\u89c4\u8ba4\u8bc6\u3002","title":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_2","text":"\u521d\u4e2d\u7269\u7406\u5df2\u6307\u51fa\uff0c\u56e0\u5916\u529b\u4f5c\u7528\u800c\u5728\u7269\u4f53\u5185\u90e8\u4ea7\u751f\u7684\u529b\u79f0\u4e3a \u5185\u529b \u3002\u5355\u4f4d\u9762\u79ef\u4e0a\u7684\u5185\u529b\u5373\u662f \u5e94\u529b \uff0c\u8868\u5f81\u5185\u529b\u7684\u5f3a\u5ea6\u3002 \u4e3a\u4e86\u7814\u7a76\u67d0\u4e00\u70b9 P P \u5904\u7684\u5e94\u529b\uff0c\u7528\u4efb\u610f\u622a\u9762\u5728 P P \u70b9\u5904\u5207\u5f00\u7269\u4f53\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u6839\u636e\u5b9a\u4e49\u53ef\u4ee5\u5f97\u5230 P P \u70b9\u7684\u6b63\u5e94\u529b \\sigma \\sigma \u3001\u5207\u5e94\u529b \\tau \\tau \uff0c\u4ed6\u4eec\u7684\u5408\u6210\u5373\u4e3a\u5168\u5e94\u529b\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e00\u4e2a\u786e\u5b9a\u7684\u622a\u9762\u5bf9\u5e94\u4e86\u4e00\u7ec4\u6b63\u5e94\u529b\u548c\u5207\u5e94\u529b\u3002\u4f46\u662f\u8fc7 P P \u70b9\u6709\u65e0\u6570\u7684\u622a\u9762\uff0c\u90a3\u4e48\u5982\u4f55\u624d\u80fd\u771f\u6b63\u63cf\u8ff0 P P \u70b9\u7684\u5e94\u529b\u72b6\u6001\u5462\uff1f","title":"\u5e94\u529b"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_3","text":"\u5e94\u529b\u72b6\u6001 \u662f\u53d7\u529b\u7269\u4f53\u67d0\u4e00\u70b9\u5404\u4e2a\u622a\u9762\u4e0a\u5e94\u529b\u7684\u53d8\u5316\u60c5\u51b5\u3002\u4e0a\u9762\u5df2\u7ecf\u610f\u8bc6\u5230\u8fc7\u4e00\u70b9\u6709\u65e0\u6570\u7684\u622a\u9762\uff0c\u53ea\u6709\u4efb\u610f\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\u90fd\u88ab\u786e\u5b9a\uff0c\u624d\u80fd\u8bf4\u5e94\u529b\u72b6\u6001\u662f\u786e\u5b9a\u7684\u3002 \u901a\u5e38\u5728\u65e0\u6570\u7684\u622a\u9762\u4e2d\uff0c\u4efb\u610f\u53d6\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\uff0c\u5e76\u4ee5\u4ed6\u4eec\u7684\u6cd5\u7ebf\u65b9\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\u3002\u4e5f\u5373\u5728 P P \u70b9\u622a\u53d6\u4e00\u4e2a\u65e0\u9650\u5c0f\u7684\u5e73\u884c\u516d\u9762\u4f53\uff0c\u79f0\u4e3a \u5355\u5143\u4f53 \u3002 \u5355\u5143\u4f53\u65e0\u9650\u5c0f\uff0c\u56e0\u6b64\u5355\u5143\u4f53\u4e0a\u76f8\u4e92\u5e73\u884c\u7684\u4e24\u4e2a\u5e73\u9762\u89c6\u4e3a\u8fc7\u8be5\u70b9\u7684\u540c\u4e00\u5e73\u9762\uff0c\u4e5f\u5373\u4ed6\u4fe9\u7684\u5e94\u529b\u662f\u76f8\u540c\u7684\u3002\u8fd9\u6837\u53ea\u7528\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5373\u53ef\u5206\u6790\u95ee\u9898\u3002 \u7531\u4e8e\u5355\u5143\u4f53\u5904\u4e8e\u9759\u529b\u5e73\u8861\u72b6\u6001\uff0c\u7531\u7ed5\u5404\u8f74\u5408\u529b\u77e9\u4e3a\u96f6\u53ef\u4ee5\u5f97\u5230\u5207\u5e94\u529b\u4e92\u7b49\u5b9a\u5f8b\u3002 \u65e2\u7136\u5355\u5143\u4f53\u4e0a\u76f8\u4e92\u5e73\u884c\u7684\u4e24\u4e2a\u5e73\u9762\u89c6\u4e3a\u8fc7\u8be5\u70b9\u7684\u540c\u4e00\u5e73\u9762\uff0c\u90a3\u4e3a\u4ec0\u4e48\u4e0a\u56fe\u5e73\u884c\u7684\u5e73\u9762\u4e0a\u5e94\u529b\u662f\u76f8\u53cd\u7684\uff1f \u5355\u5143\u4f53\u4e0a\u76f8\u4e92\u5e73\u884c\u7684\u4e24\u4e2a\u5e73\u9762\u89c6\u4e3a\u8fc7\u8be5\u70b9\u7684\u540c\u4e00\u5e73\u9762\uff0c\u4f46\u662f\u5206\u522b\u662f\u88ab\u622a\u5f00\u7684\u4e24\u90e8\u5206\u7684\u5e73\u9762\u3002\u622a\u5f00\u524d\u4ed6\u4eec\u662f\u91cd\u5408\u7684\uff0c\u622a\u5f00\u540e\u6210\u4e3a\u4e86\u4e24\u90e8\u5206\u5404\u81ea\u7684\u8868\u9762\uff0c\u800c\u5916\u8868\u9762\u662f\u6709\u65b9\u5411\u7684\u3002\u6240\u4ee5\uff0c\u4ece\u5404\u81ea\u7684\u65b9\u5411\u4e0a\u6765\u770b\uff0c\u5e94\u529b\u65b9\u5411\u8fd8\u662f\u76f8\u540c\u7684\u3002","title":"\u5e94\u529b\u72b6\u6001"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_4","text":"\u6839\u636e\u4e0a\u9762\u5355\u5143\u4f53\u4e0a\u7684\u5e94\u529b\u5206\u91cf\uff0c\u662f\u5426\u53ef\u4ee5\u6c42\u51fa\u4e0b\u56fe\u6240\u793a\u4efb\u610f\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\uff1f \u7b54\u6848\u662f\u80af\u5b9a\u7684\u3002\u6839\u636e\u4e09\u4e2a\u65b9\u5411\u7684\u9759\u529b\u5e73\u8861\u5c31\u53ef\u4ee5\u8ba1\u7b97\u5f97\u5230\u4e0a\u56fe\u6cd5\u5411\u4e3a \\vec{n}=(n_1,n_2,n_3) \\vec{n}=(n_1,n_2,n_3) \u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\u3002\u4e8e\u662f\uff0c\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\u4e0a\u76849\u4e2a\u5e94\u529b\u5206\u91cf\u53ef\u4ee5\u786e\u5b9a\u4efb\u610f\u622a\u9762\u7684\u5e94\u529b\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e00\u70b9\u7684\u5e94\u529b\u72b6\u6001\u88ab\u5b8c\u5168\u786e\u5b9a\u4e86\u3002\u5e76\u4e14\uff0c\u4ece\u8fd9\u4e09\u4e2a\u6b63\u4ea4\u622a\u9762\u7684\u9009\u53d6\u4e0a\u6765\u770b\uff0c\u4ed6\u4eec\u548c\u5750\u6807\u7cfb\u65e0\u5173\u3002 \u4e8e\u662f\uff0c\u6211\u4eec\u628a\u5355\u5143\u4f53\u4e0a\u7684\u4e5d\u4e2a\u5e94\u529b\u5206\u91cf\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u63cf\u8ff0 P P \u70b9\u7684\u5e94\u529b\u72b6\u6001\uff0c\u79f0\u4f5c \u5e94\u529b\u5f20\u91cf \uff0c\u8bb0\u4f5c \\[ \\sigma_{ij} = \\begin{pmatrix} \\sigma_x & \\tau_{xy} & \\tau_{xz} \\\\\\ \\tau_{yx} & \\sigma_y & \\sigma_{yz} \\\\\\ \\tau_{zx} & \\tau_{zy} & \\sigma_z \\end{pmatrix} \\]","title":"\u5e94\u529b\u5f20\u91cf"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_5","text":"\u5982\u679c\u4f5c\u7528\u5728\u67d0\u4e00\u622a\u9762\u4e0a\u7684\u5168\u5e94\u529b\u548c\u8fd9\u4e00\u622a\u9762\u5782\u76f4\uff0c\u5373\u8be5\u622a\u9762\u4e0a\u53ea\u6709\u6b63\u5e94\u529b\uff0c\u5219\u8fd9\u4e00\u622a\u9762\u79f0\u4e3a \u4e3b\u5e73\u9762 \uff0c\u5176\u6cd5\u7ebf\u65b9\u5411\u79f0\u4e3a\u5e94\u529b\u4e3b\u65b9\u5411\uff0c\u8be5\u622a\u9762\u7684\u5e94\u529b\u79f0\u4e3a \u4e3b\u5e94\u529b \u3002\u5982\u679c\u4e09\u4e2a\u5750\u6807\u8f74\u65b9\u5411\u90fd\u662f\u4e3b\u65b9\u5411\uff0c\u5219\u79f0\u8fd9\u4e00\u5750\u6807\u7cfb\u4e3a \u4e3b\u8f74\u5750\u6807\u7cfb \u3002 \u786e\u5b9a\u65b9\u6cd5\u4f9d\u7136\u662f\u6c42\u89e3\u9759\u529b\u5e73\u8861\u65b9\u7a0b\u3002","title":"\u4e3b\u5e94\u529b"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_6","text":"\u5728\u6c42\u89e3\u4e3b\u5e94\u529b\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u5f97\u5230\u4ee5\u4e3b\u5e94\u529b\u4e3a\u672a\u77e5\u6570\u7684\u4e09\u6b21\u65b9\u7a0b\uff0c\u53eb\u505a \u72b6\u6001\u65b9\u7a0b \u3002 \\sigma^3-I_1\\,\\sigma^2+I_2\\,\\sigma-I_3=0 \\sigma^3-I_1\\,\\sigma^2+I_2\\,\\sigma-I_3=0 \u72b6\u6001\u65b9\u7a0b\u7684\u4e09\u4e2a\u7cfb\u6570\u7531\u4e3b\u5e94\u529b\u552f\u4e00\u786e\u5b9a\uff0c\u800c\u4e00\u70b9\u7684\u4e3b\u5e94\u529b\u662f\u552f\u4e00\u7684\uff0c\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u4e0d\u968f\u5750\u6807\u7cfb\u53d8\u5316\u7684\u4e09\u4e2a\u91cf\uff0c\u53eb\u4f5c \u5e94\u529b\u5f20\u91cf\u4e0d\u53d8\u91cf \\[ \\begin{align*} I_1 &= \\sigma_1 + \\sigma_2 + \\sigma_3 \\\\\\ I_2 &= \\sigma_1 \\, \\sigma_2 + \\sigma_2 \\, \\sigma_3 + \\sigma_3 \\, \\sigma_1 \\\\\\ I_3 &= \\sigma_1 \\, \\sigma_2 \\, \\sigma_3 \\end{align*} \\] \u7528\u4e00\u822c\u5e94\u529b\u8868\u793a\u4e3a \\[ \\begin{align*} I_1 &= \\sigma_x + \\sigma_y + \\sigma_z \\\\\\ I_2 &= \\sigma_x \\, \\sigma_y + \\sigma_y \\, \\sigma_z + \\sigma_z \\, \\sigma_x - \\tau_{xy}^2 - \\tau_{yz}^2 - \\tau_{zx}^2 \\\\\\ I_3 &= \\sigma_x \\, \\sigma_y \\, \\sigma_z + 2\\,\\tau_{xy}\\,\\tau_{yz}\\,\\tau_{zx} - \\sigma_x\\,\\tau_{yz}^2 - \\sigma_y\\,\\tau_{zx}^2 - \\sigma_z\\,\\tau_{xy}^2 \\end{align*} \\]","title":"\u5e94\u529b\u5f20\u91cf\u4e0d\u53d8\u91cf"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_7","text":"\u5207\u5e94\u529b\u6709\u6781\u503c\u7684\u622a\u9762\u53eb\u4e3b\u5207\u5e94\u529b\u5e73\u9762\uff0c\u622a\u9762\u4e0a\u7684\u5207\u5e94\u529b\u53eb\u4f5c \u4e3b\u5207\u5e94\u529b \u3002\u516d\u4e2a\u4e3b\u5207\u5e94\u529b\u4e2d\u7edd\u5bf9\u503c\u6700\u5927\u7684\u53eb\u4f5c\u6700\u5927\u5207\u5e94\u529b\u3002\u901a\u8fc7\u8ba1\u7b97\u53ef\u77e5\uff0c\u4e3b\u5207\u5e94\u529b\u5e73\u9762\u4e0e\u4e3b\u5e94\u529b\u5e73\u9762\u621045\u00b0\u5939\u89d2\u3002\u4e0b\u8868\u662f\u4e3b\u5207\u5e94\u529b\u5e73\u9762\u4e0a\u7684\u6b63\u5e94\u529b\u3001\u5207\u5e94\u529b\u503c\uff1a \u4e3b\u5207\u5e94\u529b\u5e73\u9762 \u5207\u5e94\u529b \u6b63\u5e94\u529b \\left(0,\\,\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\left(0,\\,\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\pm\\dfrac{\\sigma_2-\\sigma_3}{2} \\pm\\dfrac{\\sigma_2-\\sigma_3}{2} \\dfrac{\\sigma_2+\\sigma_3}{2} \\dfrac{\\sigma_2+\\sigma_3}{2} \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,0,\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,0,\\,\\pm\\dfrac{1}{\\sqrt{2}}\\right) \\pm\\dfrac{\\sigma_1-\\sigma_3}{2} \\pm\\dfrac{\\sigma_1-\\sigma_3}{2} \\dfrac{\\sigma_1+\\sigma_3}{2} \\dfrac{\\sigma_1+\\sigma_3}{2} \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\,0,\\right) \\left(\\pm\\dfrac{1}{\\sqrt{2}},\\,\\pm\\dfrac{1}{\\sqrt{2}}\\,0,\\right) \\pm\\dfrac{\\sigma_1-\\sigma_2}{2} \\pm\\dfrac{\\sigma_1-\\sigma_2}{2} \\dfrac{\\sigma_1+\\sigma_2}{2} \\dfrac{\\sigma_1+\\sigma_2}{2} \u7531\u4e8e\u5851\u6027\u53d8\u5f62\u662f\u7531\u5207\u5e94\u529b\u5f15\u8d77\u7684\uff0c\u6240\u4ee5\u6700\u5927\u5207\u5e94\u529b\u53ef\u4ee5\u4f5c\u4e3a\u5c48\u670d\u51c6\u5219\u3002","title":"\u4e3b\u5207\u5e94\u529b"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_8","text":"\u5c06\u4e09\u4e2a\u6b63\u5e94\u529b\u7684\u5e73\u5747\u503c\u53eb\u4f5c\u5e73\u5747\u5e94\u529b\u6216\u8005\u9759\u6c34\u5e94\u529b\uff0c\u5e94\u529b\u5f20\u91cf\u51cf\u53bb\u8fd9\u90e8\u5206\u540e\u5f97\u5230 \u5e94\u529b\u504f\u5f20\u91cf \u3002\u5e94\u529b\u504f\u5f20\u91cf\u540c\u6837\u6709\u4e09\u4e2a\u4e0d\u53d8\u91cf\u3002 \\sigma_m = \\dfrac{1}{3}\\left(\\sigma_x+\\sigma_y+\\sigma_z\\right) = \\dfrac{1}{3}\\left(\\sigma_{11}+\\sigma_{22}+\\sigma_{33}\\right) \\sigma_m = \\dfrac{1}{3}\\left(\\sigma_x+\\sigma_y+\\sigma_z\\right) = \\dfrac{1}{3}\\left(\\sigma_{11}+\\sigma_{22}+\\sigma_{33}\\right) \\[ \\begin{pmatrix} \\sigma_x & \\tau_{xy} & \\tau_{xz} \\\\\\ \\tau_{yx} & \\sigma_y & \\sigma_{yz} \\\\\\ \\tau_{zx} & \\tau_{zy} & \\sigma_z \\end{pmatrix} = \\begin{pmatrix} \\sigma_m & 0 & 0 \\\\\\ 0 & \\sigma_m & 0 \\\\\\ 0 & 0 & \\sigma_m \\end{pmatrix} + \\begin{pmatrix} \\sigma_x-\\sigma_m & \\tau_{xy} & \\tau_{xz} \\\\\\ \\tau_{yx} & \\sigma_y-\\sigma_m & \\sigma_{yz} \\\\\\ \\tau_{zx} & \\tau_{zy} & \\sigma_z-\\sigma_m \\end{pmatrix} \\] \u5e94\u529b\u5f20\u91cf\u5206\u89e3\u7684\u7269\u7406\u610f\u4e49\u5728\u4e8e\uff1a \u7269\u4f53\u5728\u5e94\u529b\u5f20\u91cf\u4f5c\u7528\u4e0b\u7684\u53d8\u5f62\u5206\u4e3a\u4f53\u79ef\u53d8\u5316\u548c\u5f62\u72b6\u53d8\u5316\u4e24\u90e8\u5206\uff1b\u524d\u8005\u53d6\u51b3\u4e8e\u5e94\u529b\u7403\u5f20\u91cf\uff0c\u540e\u8005\u53d6\u51b3\u4e8e\u5e94\u529b\u504f\u5f20\u91cf\u3002 \u4f53\u79ef\u53d8\u5316\u8868\u5f81\u5f39\u6027\u53d8\u5f62\uff0c\u5f53\u5e94\u529b\u504f\u5f20\u91cf\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u540e\uff0c\u5219\u7269\u4f53\u53d1\u751f\u5851\u6027\u53d8\u5f62\u3002","title":"\u5e94\u529b\u5f20\u91cf\u5206\u89e3"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_9","text":"\u4ee5\u4e0a\u8bf4\u660e\u7684\u90fd\u662f\u4e00\u70b9\u7684\u5e94\u529b\u72b6\u6001\uff0c\u800c\u7269\u4f53\u5185\u90e8\u4e0d\u540c\u70b9\u7684\u5e94\u529b\u72b6\u6001\u4e00\u822c\u662f\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u5982\u4f55\u63cf\u8ff0\u76f8\u90bb\u70b9\u95f4\u7684\u5e94\u529b\u53d8\u5316\u5173\u7cfb\u5462\uff1f \u4ee5\u7269\u4f53\u5185\u67d0\u4e00\u70b9 P(x,y,z) P(x,y,z) \u4e3a\u9876\u70b9\u622a\u53d6\u8fb9\u957f\u5206\u522b\u4e3adx,dy,dz\u7684\u76f4\u89d2\u5e73\u884c\u516d\u9762\u4f53\u5fae\u5143\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5219\u53e6\u4e00\u9876\u70b9\u7684\u5750\u6807\u4e3a (x+dx,y+dy,z+dz) (x+dx,y+dy,z+dz) \u3002 \u6839\u636e\u9759\u529b\u5e73\u8861\u65b9\u7a0b\uff0c\u5e76\u5904\u7406\u6389\u9ad8\u9636\u5c0f\u91cf\uff0c\u5f97\u5230\u5e94\u529b\u5e73\u8861\u5fae\u5206\u65b9\u7a0b\uff1a \\[ \\begin{align*} \\dfrac{\\partial\\sigma_x}{\\partial\\,x}+\\dfrac{\\partial\\tau_{yx}}{\\partial\\,y}+\\dfrac{\\partial\\tau_{zx}}{\\partial\\,z} &= 0 \\\\\\ \\dfrac{\\partial\\tau_{xy}}{\\partial\\,x}+\\dfrac{\\partial\\sigma_y}{\\partial\\,y}+\\dfrac{\\partial\\tau_{zy}}{\\partial\\,z} &= 0 \\\\\\ \\dfrac{\\partial\\tau_{xz}}{\\partial\\,x}+\\dfrac{\\partial\\tau_{yz}}{\\partial\\,y}+\\dfrac{\\partial\\sigma_z}{\\partial\\,z} &= 0 \\end{align*} \\] \u8fd9\u90e8\u5206\u5fae\u516d\u9762\u4f53\u5e94\u529b\u72b6\u6001\u5206\u6790\u56fe\u4e0e\u4e4b\u524d\u70b9\u7684\u5e94\u529b\u72b6\u6001\u56fe\u5373\u4e3a\u76f8\u4f3c\uff0c\u5374\u6709\u4e0d\u540c\uff0c\u5982\u4f55\u7406\u89e3\uff1f \u4e8c\u8005\u7684\u6db5\u4e49\u5b8c\u5168\u4e0d\u540c\u3002\u70b9\u7684\u5e94\u529b\u72b6\u6001\u56fe\u5f3a\u8c03\u7684\u662f\u540c\u4e00\u4e2a\u70b9\u5728\u4e0d\u540c\u622a\u9762\u4e0b\u7684\u72b6\u6001\uff0c\u800c\u5fae\u516d\u9762\u4f53\u5e94\u529b\u72b6\u6001\u5206\u6790\u5f3a\u8c03\u7684\u662f\u76f8\u90bb\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u5e94\u529b\u5173\u7cfb\u3002\u53ef\u4ee5\u8bf4\u524d\u8005\u662f\u9759\u6001\u7684\uff0c\u540e\u8005\u63ed\u793a\u7684\u662f\u76f8\u4e92\u4f5c\u7528\u7684\u5173\u7cfb\u3002","title":"\u5e94\u529b\u5e73\u8861\u5fae\u5206\u65b9\u7a0b"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_10","text":"\u8fd9\u4e00\u90e8\u5206\u68b3\u7406\u4e86\u6211\u4eec\u5e38\u89c4\u5b66\u4e60\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u6982\u62ec\u4e3a\u4e24\u70b9\uff1a \u5e94\u529b\u5f20\u91cf\u2014\u2014\u67d0\u70b9\u7684\u5e94\u529b\u72b6\u6001 \u5e94\u529b\u5e73\u8861\u65b9\u7a0b\u2014\u2014\u76f8\u90bb\u70b9\u7684\u76f8\u4e92\u4f5c\u7528","title":"\u603b\u7ed3"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/","text":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-07-30 | \u5206\u7c7b\uff1a plasticity theory , mathematics \u8fd9\u4e00\u90e8\u5206\u4e3b\u8981\u662f\u5bf9\u5e94\u529b\u5f20\u91cf\u6570\u5b66\u672c\u8d28\u7684\u7406\u89e3\u3002 \u76f8\u4f3c\u77e9\u9635 \u00b6 \u901a\u8fc7\u57fa\u7840\u77e5\u8bc6\u6211\u4eec\u5df2\u7ecf\u8ba4\u8bc6\u5230\uff0c\u5e94\u529b\u5f20\u91cf\u4ee3\u8868\u70b9\u7684\u5e94\u529b\u72b6\u6001\uff0c\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u5750\u6807\u7cfb\u7684\u9009\u53d6\uff0c\u5e76\u4e14\u5bf9\u5e94\u7740\u540c\u4e00\u4e3b\u5e94\u529b\u72b6\u6001\u3002\u7528\u77e9\u9635\u7684\u89c2\u70b9\u7406\u89e3\u4e3a\uff1a \u540c\u4e00\u70b9\u7684\u5e94\u529b\u5f20\u91cf\u77e9\u9635\u662f\u76f8\u4f3c\u77e9\u9635\uff0c\u5e76\u4e14\u53ef\u4ee5\u5bf9\u89d2\u5316 \u3002 \u7136\u800c\u95ee\u9898\u662f\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\uff1f \u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u540c\u4e00\u70b9\u4e0d\u540c\u622a\u9762\u4e0b\u7684\u5e94\u529b\u5f20\u91cf\u63cf\u8ff0\u7684\u90fd\u662f\u76f8\u540c\u7684\u5e94\u529b\u72b6\u6001\uff0c\u56e0\u6b64\u4ed6\u4eec\u5b58\u5728\u5185\u5728\u8054\u7cfb\uff08\u4f8b\u5982\u53d7\u7ea6\u675f\u4e8e\u9759\u529b\u5e73\u8861\u65b9\u7a0b\uff09\u3002\u7531\u5207\u5e94\u529b\u4e92\u7b49\u5b9a\u5f8b\u53ef\u77e5\u5e94\u529b\u5f20\u91cf\u77e9\u9635\u662f\u5b9e\u5bf9\u79f0\u77e9\u9635\uff0c\u800c\u5b9e\u5bf9\u79f0\u77e9\u9635\u5fc5\u5b9a\u53ef\u4ee5\u5bf9\u89d2\u5316\uff0c\u5373\u4e0d\u540c\u622a\u9762\u5e94\u529b\u5f20\u91cf\u5bf9\u76f8\u4f3c\u4e8e\u4e00\u4e2a\u4e3b\u5e94\u529b\u5f20\u91cf\uff1b\u800c\u540c\u4e00\u70b9\u7684\u4e3b\u5e94\u529b\u72b6\u6001\u662f\u786e\u5b9a\u7684\u3002\u4e8e\u662f\u7531\u76f8\u4f3c\u77e9\u9635\u7684\u4f20\u9012\u6027\u53ef\u77e5\uff0c\u4e0d\u540c\u622a\u9762\u4e0b\u7684\u5e94\u529b\u5f20\u91cf\u77e9\u9635\u662f\u76f8\u4f3c\u7684\u3002 \u7ebf\u6027\u53d8\u6362 \u00b6 \u7531\u5e94\u529b\u5f20\u91cf\u662f\u76f8\u4f3c\u77e9\u9635\u518d\u8fdb\u4e00\u6b65\uff0c\u56e0\u4e3a \u76f8\u4f3c\u77e9\u9635\u7684\u672c\u8d28\u662f\u540c\u4e00\u7ebf\u6027\u53d8\u6362\u5728\u4e0d\u540c\u57fa\u4e0b\u8868\u793a\u7684\u77e9\u9635 \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u66f4\u6839\u672c\u7684\u89d2\u5ea6\u770b\u5f85\u5e94\u529b\u5f20\u91cf\u4e86\uff1a \u5e94\u529b\u5f20\u91cf\u4ee3\u8868\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362 \uff01 \u8fd9\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u8ba4\u8bc6\uff0c\u6216\u8005\u8bf4\u662f\u4ece\u76f8\u4f3c\u77e9\u9635\u63a8\u8bba\u51fa\u6765\u7684\u3002\u90a3\u4e48\u63a5\u4e0b\u6765\u8ba9\u4ed6\u5177\u4f53\u5316\uff1a \u4ece\u57fa\u7840\u77e5\u8bc6\u5df2\u7ecf\u77e5\u9053\uff0c\u5229\u7528\u4e09\u4e2a\u76f8\u4e92\u5782\u76f4\u7684\u622a\u9762\u622a\u53d6\u4e00\u70b9P\uff0c\u5404\u4e2a\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\u7ec4\u6210\u5e94\u529b\u5f20\u91cf\u3002\u4ee5\u8fd9\u4e09\u4e2a\u622a\u9762\u7684\u6cd5\u7ebf\u65b9\u5411\u4e3a\u6b63\u65b9\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5bf9\u4e8e\u4efb\u610f\u6cd5\u5411 \\vec{n}=(n_1,\\,n_2,\\,n_3) \\vec{n}=(n_1,\\,n_2,\\,n_3) \u7684\u622a\u9762\uff0c\u53ef\u4ee5\u5f97\u5230\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf p_i = \\sigma_{ij}\\,n_j p_i = \\sigma_{ij}\\,n_j \u6539\u5199\u4e3a\u77e9\u9635\u8868\u8fbe\u5f0f A\\,x = y A\\,x = y \u5176\u4e2d\uff0c \\[ A = \\begin{pmatrix} \\sigma_{11} & \\tau_{12} & \\tau_{13} \\\\\\ \\tau_{21} & \\sigma_{22} & \\sigma_{23} \\\\\\ \\tau_{31} & \\tau_{32} & \\sigma_{33} \\end{pmatrix}\\,, x = n_j = \\begin{pmatrix} n_1 \\\\\\ n_2 \\\\\\ n_3 \\end{pmatrix}\\,, y = p_i = \\begin{pmatrix} p_1 \\\\\\ p_2 \\\\\\ p_3 \\end{pmatrix} \\] \u6839\u636e\u7ebf\u6027\u53d8\u6362\u4e0e\u77e9\u9635\u7684\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u53ef\u77e5\uff0c\u5e94\u529b\u5f20\u91cf\u4ee3\u8868\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff08\u786e\u5207\u7684\u8bf4\u662f\u7ebf\u6027\u6620\u5c04\uff09\u2014\u2014 \u5e94\u529b\u5f20\u91cf\u5c06\u622a\u9762\u4f4d\u7f6e\u6620\u5c04\u5230\u622a\u9762\u5e94\u529b \u3002\u5176\u6570\u5b66\u8868\u8ff0\u4e3a\uff1a \\sigma\\,\\in \\, Hom(U,\\,V),\\,\\sigma:\\,x \\rightarrow y \\quad x=\\left(n_1,\\,n_2,\\,n_3\\right)^T \\quad y=\\left(p_1,\\,p_2,\\,p_3\\right)^T \\sigma\\,\\in \\, Hom(U,\\,V),\\,\\sigma:\\,x \\rightarrow y \\quad x=\\left(n_1,\\,n_2,\\,n_3\\right)^T \\quad y=\\left(p_1,\\,p_2,\\,p_3\\right)^T \u5176\u4e2d\uff0c U U \u662f\u622a\u9762\u65b9\u5411\u4f59\u5f26\u7ec4\u6210\u7684\u7ebf\u6027\u7a7a\u95f4\uff0c V V \u662f\u622a\u9762\u5e94\u529b\u4f5c\u6210\u7684\u7ebf\u6027\u7a7a\u95f4\u3002 \u4e3e\u4f8b\u8bf4\u660e \u00b6 \u4ee5\u4e0b\u8bf4\u660e\u8fd9\u4e2a\u7ebf\u6027\u6620\u5c04\u662f\u5982\u4f55\u4e0e\u529b\u5b66\u63cf\u8ff0\u76f8\u4e00\u81f4\u7684\u3002 \u4e4b\u524d\u591a\u6b21\u63d0\u53ca\uff0c\u7528\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\u622a\u53d6P\u70b9\uff0c\u5e76\u4ee5\u5176\u6cd5\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\u3002\u8fd9\u6837\u7684\u622a\u9762\u6709\u65e0\u6570\u591a\u5bf9\uff0c\u8fd9\u6837\u7684\u5750\u6807\u7cfb\u4e5f\u6709\u65e0\u6570\u591a\u4e2a\u3002\u4e3a\u4e86\u533a\u5206\u4ed6\u4eec\uff0c\u5148\u786e\u5b9a\u4e00\u4e2a \u5168\u5c40\u5750\u6807\u7cfb S:Oxyz S:Oxyz \uff0c\u90a3\u4e48\u5176\u4ed6\u4efb\u610f\u7684 \u5c40\u90e8\u5750\u6807\u7cfb S':O'x'y'z' S':O'x'y'z' \u5c31\u53ef\u4ee5\u7528\u5b83\u7684\u5750\u6807\u8f74\u65b9\u5411\u5728\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u7684\u65b9\u5411\u4f59\u5f26\u6765\u63cf\u8ff0\u4e86\u3002 \u4f8b\u5982\uff0c\u5c40\u90e8\u7cfb x' x' \u8f74\u5728\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u7684\u65b9\u5411\u4f59\u5f26\u4e3a \\alpha_x = \\left(\\cos\\langle{x',\\,x}\\rangle,\\,\\cos\\langle{x',\\,y}\\rangle,\\,\\cos\\langle{x',\\,z}\\rangle\\right) \\alpha_x = \\left(\\cos\\langle{x',\\,x}\\rangle,\\,\\cos\\langle{x',\\,y}\\rangle,\\,\\cos\\langle{x',\\,z}\\rangle\\right) \u8fdb\u800c\uff0c\u5c40\u90e8\u5750\u6807\u7cfb S' S' \u53ef\u4ee5\u63cf\u8ff0\u4e3a \\[ \\alpha = \\left(\\alpha_x,\\,\\alpha_y,\\,\\alpha_z\\right) = \\begin{pmatrix} \\cos\\langle{x',\\,x}\\rangle & \\cos\\langle{y',\\,x}\\rangle & \\cos\\langle{z',\\,x}\\rangle \\\\\\ \\cos\\langle{x',\\,y}\\rangle & \\cos\\langle{y',\\,y}\\rangle & \\cos\\langle{z',\\,y}\\rangle \\\\\\ \\cos\\langle{x',\\,z}\\rangle & \\cos\\langle{y',\\,z}\\rangle & \\cos\\langle{z',\\,z}\\rangle \\end{pmatrix} \\] \u5728\u5c40\u90e8\u5750\u6807\u7cfb\u5185\uff0c\u622a\u9762 \\vec{n} \\vec{n} \u7528\u65b9\u5411\u4f59\u5f26\u8868\u793a\u4e3a \\vec{n}=\\left(n_1,\\,n_2,\\,n_3\\right)^T = \\left(\\cos\\langle{\\vec{n},\\,x'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,y'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,z'}\\rangle\\right)^T \\vec{n}=\\left(n_1,\\,n_2,\\,n_3\\right)^T = \\left(\\cos\\langle{\\vec{n},\\,x'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,y'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,z'}\\rangle\\right)^T \\alpha \\alpha \u8868\u793a\u5c40\u90e8\u5750\u6807\u7cfb\u5728\u5168\u5c40\u5750\u6807\u7cfb\u7a7a\u95f4\u4e0b\u7684\u57fa\u3002 \\vec{n} \\vec{n} \u8868\u793a\u4efb\u610f\u622a\u9762\u5728\u5c40\u90e8\u5750\u6807\u7cfb\u4e0b\u7684\u5750\u6807\u3002 \u5c40\u90e8\u5750\u6807\u7cfb\u4efb\u610f\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u5e03\u4e5f\u662f\u7c7b\u4f3c\u7684\u60c5\u51b5\uff0c\u5176\u5750\u6807\u7cfb\u65b9\u5411\u4e00\u81f4\uff0c\u5750\u6807\u7684\u63cf\u8ff0\u4e5f\u7c7b\u4f3c\uff0c\u53ea\u662f\u5c5e\u4e8e\u4e0d\u540c\u7684\u7a7a\u95f4\u800c\u5df2\u3002\u5982\u6b64\u4e00\u6765\uff0c\u529b\u5b66\u63cf\u8ff0\u548c\u6570\u5b66\u63cf\u8ff0\u662f\u76f8\u4e92\u7edf\u4e00\u7684\uff1a \u529b\u5b66\u63cf\u8ff0 \u7528\u4efb\u610f\u76f8\u4e92\u5782\u76f4\u7684\u4e09\u4e2a\u5e73\u9762\u622a\u53d6 P P \u70b9\uff0c\u4ee5\u622a\u9762\u6cd5\u5411\u4e3a\u6b63\u65b9\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\uff0c\u5f97\u5230\u4e09\u4e2a\u622a\u9762\u4e0a\u7684\u5e94\u529b\u72b6\u6001\u5373\u5e94\u529b\u5f20\u91cf \\sigma \\sigma \u3002\u4ee5\u6b64\u4e3a\u57fa\u7840\uff0c\u53ef\u4ee5\u6c42\u5f97\u5f53\u524d\u5750\u6807\u7cfb\u4e0b\u4efb\u610f\u622a\u9762 \\vec{n} \\vec{n} \u4e0a\u7684\u5e94\u529b\u5206\u5e03 \\vec{p} \\vec{p} \u3002 \u6570\u5b66\u63cf\u8ff0 \u4efb\u610f\u7ed9\u5b9a\u4e00\u7ec4\u57fa \\alpha \\alpha \u540e\uff0c\u53ef\u4ee5\u7528\u5750\u6807 \\left(n_1,\\,n_2,\\,n_3\\right)^T \\left(n_1,\\,n_2,\\,n_3\\right)^T \u63cf\u8ff0\u622a\u9762\u4f4d\u7f6e\uff0c\u7528\u5750\u6807 \\left(p_1,\\,p_2,\\,p_3\\right)^T \\left(p_1,\\,p_2,\\,p_3\\right)^T \u63cf\u8ff0\u622a\u9762\u5e94\u529b\u3002\u5728\u8fd9\u7ec4\u57fa\u4e0b\uff0c\u5b58\u5728\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362 \\sigma \\sigma \uff0c\u5c06\u622a\u9762\u4f4d\u7f6e \\vec{n} \\vec{n} \u6620\u5c04\u5230\u622a\u9762\u5e94\u529b \\vec{p} \\vec{p} \u3002 \u603b\u7ed3 \u00b6 \u8fd9\u4e00\u90e8\u5206\u4ece\u76f8\u4f3c\u77e9\u9635\u53ca\u7ebf\u6027\u53d8\u6362\u7684\u89d2\u5ea6\u6765\u8ba4\u8bc6\u5e94\u529b\u5f20\u91cf\uff0c\u5e94\u529b\u5f20\u91cf\u662f\u4ece\u622a\u9762\u4f4d\u7f6e\u5230\u622a\u9762\u5e94\u529b\u7684\u7ebf\u6027\u53d8\u6362\u6240\u5bf9\u5e94\u7684\u77e9\u9635\u3002","title":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2013-07-30 | \u5206\u7c7b\uff1a plasticity theory , mathematics \u8fd9\u4e00\u90e8\u5206\u4e3b\u8981\u662f\u5bf9\u5e94\u529b\u5f20\u91cf\u6570\u5b66\u672c\u8d28\u7684\u7406\u89e3\u3002","title":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/#_2","text":"\u901a\u8fc7\u57fa\u7840\u77e5\u8bc6\u6211\u4eec\u5df2\u7ecf\u8ba4\u8bc6\u5230\uff0c\u5e94\u529b\u5f20\u91cf\u4ee3\u8868\u70b9\u7684\u5e94\u529b\u72b6\u6001\uff0c\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u5750\u6807\u7cfb\u7684\u9009\u53d6\uff0c\u5e76\u4e14\u5bf9\u5e94\u7740\u540c\u4e00\u4e3b\u5e94\u529b\u72b6\u6001\u3002\u7528\u77e9\u9635\u7684\u89c2\u70b9\u7406\u89e3\u4e3a\uff1a \u540c\u4e00\u70b9\u7684\u5e94\u529b\u5f20\u91cf\u77e9\u9635\u662f\u76f8\u4f3c\u77e9\u9635\uff0c\u5e76\u4e14\u53ef\u4ee5\u5bf9\u89d2\u5316 \u3002 \u7136\u800c\u95ee\u9898\u662f\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\uff1f \u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u540c\u4e00\u70b9\u4e0d\u540c\u622a\u9762\u4e0b\u7684\u5e94\u529b\u5f20\u91cf\u63cf\u8ff0\u7684\u90fd\u662f\u76f8\u540c\u7684\u5e94\u529b\u72b6\u6001\uff0c\u56e0\u6b64\u4ed6\u4eec\u5b58\u5728\u5185\u5728\u8054\u7cfb\uff08\u4f8b\u5982\u53d7\u7ea6\u675f\u4e8e\u9759\u529b\u5e73\u8861\u65b9\u7a0b\uff09\u3002\u7531\u5207\u5e94\u529b\u4e92\u7b49\u5b9a\u5f8b\u53ef\u77e5\u5e94\u529b\u5f20\u91cf\u77e9\u9635\u662f\u5b9e\u5bf9\u79f0\u77e9\u9635\uff0c\u800c\u5b9e\u5bf9\u79f0\u77e9\u9635\u5fc5\u5b9a\u53ef\u4ee5\u5bf9\u89d2\u5316\uff0c\u5373\u4e0d\u540c\u622a\u9762\u5e94\u529b\u5f20\u91cf\u5bf9\u76f8\u4f3c\u4e8e\u4e00\u4e2a\u4e3b\u5e94\u529b\u5f20\u91cf\uff1b\u800c\u540c\u4e00\u70b9\u7684\u4e3b\u5e94\u529b\u72b6\u6001\u662f\u786e\u5b9a\u7684\u3002\u4e8e\u662f\u7531\u76f8\u4f3c\u77e9\u9635\u7684\u4f20\u9012\u6027\u53ef\u77e5\uff0c\u4e0d\u540c\u622a\u9762\u4e0b\u7684\u5e94\u529b\u5f20\u91cf\u77e9\u9635\u662f\u76f8\u4f3c\u7684\u3002","title":"\u76f8\u4f3c\u77e9\u9635"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/#_3","text":"\u7531\u5e94\u529b\u5f20\u91cf\u662f\u76f8\u4f3c\u77e9\u9635\u518d\u8fdb\u4e00\u6b65\uff0c\u56e0\u4e3a \u76f8\u4f3c\u77e9\u9635\u7684\u672c\u8d28\u662f\u540c\u4e00\u7ebf\u6027\u53d8\u6362\u5728\u4e0d\u540c\u57fa\u4e0b\u8868\u793a\u7684\u77e9\u9635 \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u66f4\u6839\u672c\u7684\u89d2\u5ea6\u770b\u5f85\u5e94\u529b\u5f20\u91cf\u4e86\uff1a \u5e94\u529b\u5f20\u91cf\u4ee3\u8868\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362 \uff01 \u8fd9\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u8ba4\u8bc6\uff0c\u6216\u8005\u8bf4\u662f\u4ece\u76f8\u4f3c\u77e9\u9635\u63a8\u8bba\u51fa\u6765\u7684\u3002\u90a3\u4e48\u63a5\u4e0b\u6765\u8ba9\u4ed6\u5177\u4f53\u5316\uff1a \u4ece\u57fa\u7840\u77e5\u8bc6\u5df2\u7ecf\u77e5\u9053\uff0c\u5229\u7528\u4e09\u4e2a\u76f8\u4e92\u5782\u76f4\u7684\u622a\u9762\u622a\u53d6\u4e00\u70b9P\uff0c\u5404\u4e2a\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf\u7ec4\u6210\u5e94\u529b\u5f20\u91cf\u3002\u4ee5\u8fd9\u4e09\u4e2a\u622a\u9762\u7684\u6cd5\u7ebf\u65b9\u5411\u4e3a\u6b63\u65b9\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5bf9\u4e8e\u4efb\u610f\u6cd5\u5411 \\vec{n}=(n_1,\\,n_2,\\,n_3) \\vec{n}=(n_1,\\,n_2,\\,n_3) \u7684\u622a\u9762\uff0c\u53ef\u4ee5\u5f97\u5230\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u91cf p_i = \\sigma_{ij}\\,n_j p_i = \\sigma_{ij}\\,n_j \u6539\u5199\u4e3a\u77e9\u9635\u8868\u8fbe\u5f0f A\\,x = y A\\,x = y \u5176\u4e2d\uff0c \\[ A = \\begin{pmatrix} \\sigma_{11} & \\tau_{12} & \\tau_{13} \\\\\\ \\tau_{21} & \\sigma_{22} & \\sigma_{23} \\\\\\ \\tau_{31} & \\tau_{32} & \\sigma_{33} \\end{pmatrix}\\,, x = n_j = \\begin{pmatrix} n_1 \\\\\\ n_2 \\\\\\ n_3 \\end{pmatrix}\\,, y = p_i = \\begin{pmatrix} p_1 \\\\\\ p_2 \\\\\\ p_3 \\end{pmatrix} \\] \u6839\u636e\u7ebf\u6027\u53d8\u6362\u4e0e\u77e9\u9635\u7684\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u53ef\u77e5\uff0c\u5e94\u529b\u5f20\u91cf\u4ee3\u8868\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff08\u786e\u5207\u7684\u8bf4\u662f\u7ebf\u6027\u6620\u5c04\uff09\u2014\u2014 \u5e94\u529b\u5f20\u91cf\u5c06\u622a\u9762\u4f4d\u7f6e\u6620\u5c04\u5230\u622a\u9762\u5e94\u529b \u3002\u5176\u6570\u5b66\u8868\u8ff0\u4e3a\uff1a \\sigma\\,\\in \\, Hom(U,\\,V),\\,\\sigma:\\,x \\rightarrow y \\quad x=\\left(n_1,\\,n_2,\\,n_3\\right)^T \\quad y=\\left(p_1,\\,p_2,\\,p_3\\right)^T \\sigma\\,\\in \\, Hom(U,\\,V),\\,\\sigma:\\,x \\rightarrow y \\quad x=\\left(n_1,\\,n_2,\\,n_3\\right)^T \\quad y=\\left(p_1,\\,p_2,\\,p_3\\right)^T \u5176\u4e2d\uff0c U U \u662f\u622a\u9762\u65b9\u5411\u4f59\u5f26\u7ec4\u6210\u7684\u7ebf\u6027\u7a7a\u95f4\uff0c V V \u662f\u622a\u9762\u5e94\u529b\u4f5c\u6210\u7684\u7ebf\u6027\u7a7a\u95f4\u3002","title":"\u7ebf\u6027\u53d8\u6362"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/#_4","text":"\u4ee5\u4e0b\u8bf4\u660e\u8fd9\u4e2a\u7ebf\u6027\u6620\u5c04\u662f\u5982\u4f55\u4e0e\u529b\u5b66\u63cf\u8ff0\u76f8\u4e00\u81f4\u7684\u3002 \u4e4b\u524d\u591a\u6b21\u63d0\u53ca\uff0c\u7528\u4e09\u4e2a\u4e92\u76f8\u5782\u76f4\u7684\u622a\u9762\u622a\u53d6P\u70b9\uff0c\u5e76\u4ee5\u5176\u6cd5\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\u3002\u8fd9\u6837\u7684\u622a\u9762\u6709\u65e0\u6570\u591a\u5bf9\uff0c\u8fd9\u6837\u7684\u5750\u6807\u7cfb\u4e5f\u6709\u65e0\u6570\u591a\u4e2a\u3002\u4e3a\u4e86\u533a\u5206\u4ed6\u4eec\uff0c\u5148\u786e\u5b9a\u4e00\u4e2a \u5168\u5c40\u5750\u6807\u7cfb S:Oxyz S:Oxyz \uff0c\u90a3\u4e48\u5176\u4ed6\u4efb\u610f\u7684 \u5c40\u90e8\u5750\u6807\u7cfb S':O'x'y'z' S':O'x'y'z' \u5c31\u53ef\u4ee5\u7528\u5b83\u7684\u5750\u6807\u8f74\u65b9\u5411\u5728\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u7684\u65b9\u5411\u4f59\u5f26\u6765\u63cf\u8ff0\u4e86\u3002 \u4f8b\u5982\uff0c\u5c40\u90e8\u7cfb x' x' \u8f74\u5728\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u7684\u65b9\u5411\u4f59\u5f26\u4e3a \\alpha_x = \\left(\\cos\\langle{x',\\,x}\\rangle,\\,\\cos\\langle{x',\\,y}\\rangle,\\,\\cos\\langle{x',\\,z}\\rangle\\right) \\alpha_x = \\left(\\cos\\langle{x',\\,x}\\rangle,\\,\\cos\\langle{x',\\,y}\\rangle,\\,\\cos\\langle{x',\\,z}\\rangle\\right) \u8fdb\u800c\uff0c\u5c40\u90e8\u5750\u6807\u7cfb S' S' \u53ef\u4ee5\u63cf\u8ff0\u4e3a \\[ \\alpha = \\left(\\alpha_x,\\,\\alpha_y,\\,\\alpha_z\\right) = \\begin{pmatrix} \\cos\\langle{x',\\,x}\\rangle & \\cos\\langle{y',\\,x}\\rangle & \\cos\\langle{z',\\,x}\\rangle \\\\\\ \\cos\\langle{x',\\,y}\\rangle & \\cos\\langle{y',\\,y}\\rangle & \\cos\\langle{z',\\,y}\\rangle \\\\\\ \\cos\\langle{x',\\,z}\\rangle & \\cos\\langle{y',\\,z}\\rangle & \\cos\\langle{z',\\,z}\\rangle \\end{pmatrix} \\] \u5728\u5c40\u90e8\u5750\u6807\u7cfb\u5185\uff0c\u622a\u9762 \\vec{n} \\vec{n} \u7528\u65b9\u5411\u4f59\u5f26\u8868\u793a\u4e3a \\vec{n}=\\left(n_1,\\,n_2,\\,n_3\\right)^T = \\left(\\cos\\langle{\\vec{n},\\,x'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,y'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,z'}\\rangle\\right)^T \\vec{n}=\\left(n_1,\\,n_2,\\,n_3\\right)^T = \\left(\\cos\\langle{\\vec{n},\\,x'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,y'}\\rangle,\\,\\cos\\langle{\\vec{n},\\,z'}\\rangle\\right)^T \\alpha \\alpha \u8868\u793a\u5c40\u90e8\u5750\u6807\u7cfb\u5728\u5168\u5c40\u5750\u6807\u7cfb\u7a7a\u95f4\u4e0b\u7684\u57fa\u3002 \\vec{n} \\vec{n} \u8868\u793a\u4efb\u610f\u622a\u9762\u5728\u5c40\u90e8\u5750\u6807\u7cfb\u4e0b\u7684\u5750\u6807\u3002 \u5c40\u90e8\u5750\u6807\u7cfb\u4efb\u610f\u622a\u9762\u4e0a\u7684\u5e94\u529b\u5206\u5e03\u4e5f\u662f\u7c7b\u4f3c\u7684\u60c5\u51b5\uff0c\u5176\u5750\u6807\u7cfb\u65b9\u5411\u4e00\u81f4\uff0c\u5750\u6807\u7684\u63cf\u8ff0\u4e5f\u7c7b\u4f3c\uff0c\u53ea\u662f\u5c5e\u4e8e\u4e0d\u540c\u7684\u7a7a\u95f4\u800c\u5df2\u3002\u5982\u6b64\u4e00\u6765\uff0c\u529b\u5b66\u63cf\u8ff0\u548c\u6570\u5b66\u63cf\u8ff0\u662f\u76f8\u4e92\u7edf\u4e00\u7684\uff1a \u529b\u5b66\u63cf\u8ff0 \u7528\u4efb\u610f\u76f8\u4e92\u5782\u76f4\u7684\u4e09\u4e2a\u5e73\u9762\u622a\u53d6 P P \u70b9\uff0c\u4ee5\u622a\u9762\u6cd5\u5411\u4e3a\u6b63\u65b9\u5411\u5efa\u7acb\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\uff0c\u5f97\u5230\u4e09\u4e2a\u622a\u9762\u4e0a\u7684\u5e94\u529b\u72b6\u6001\u5373\u5e94\u529b\u5f20\u91cf \\sigma \\sigma \u3002\u4ee5\u6b64\u4e3a\u57fa\u7840\uff0c\u53ef\u4ee5\u6c42\u5f97\u5f53\u524d\u5750\u6807\u7cfb\u4e0b\u4efb\u610f\u622a\u9762 \\vec{n} \\vec{n} \u4e0a\u7684\u5e94\u529b\u5206\u5e03 \\vec{p} \\vec{p} \u3002 \u6570\u5b66\u63cf\u8ff0 \u4efb\u610f\u7ed9\u5b9a\u4e00\u7ec4\u57fa \\alpha \\alpha \u540e\uff0c\u53ef\u4ee5\u7528\u5750\u6807 \\left(n_1,\\,n_2,\\,n_3\\right)^T \\left(n_1,\\,n_2,\\,n_3\\right)^T \u63cf\u8ff0\u622a\u9762\u4f4d\u7f6e\uff0c\u7528\u5750\u6807 \\left(p_1,\\,p_2,\\,p_3\\right)^T \\left(p_1,\\,p_2,\\,p_3\\right)^T \u63cf\u8ff0\u622a\u9762\u5e94\u529b\u3002\u5728\u8fd9\u7ec4\u57fa\u4e0b\uff0c\u5b58\u5728\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362 \\sigma \\sigma \uff0c\u5c06\u622a\u9762\u4f4d\u7f6e \\vec{n} \\vec{n} \u6620\u5c04\u5230\u622a\u9762\u5e94\u529b \\vec{p} \\vec{p} \u3002","title":"\u4e3e\u4f8b\u8bf4\u660e"},{"location":"2013-07-30-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/#_5","text":"\u8fd9\u4e00\u90e8\u5206\u4ece\u76f8\u4f3c\u77e9\u9635\u53ca\u7ebf\u6027\u53d8\u6362\u7684\u89d2\u5ea6\u6765\u8ba4\u8bc6\u5e94\u529b\u5f20\u91cf\uff0c\u5e94\u529b\u5f20\u91cf\u662f\u4ece\u622a\u9762\u4f4d\u7f6e\u5230\u622a\u9762\u5e94\u529b\u7684\u7ebf\u6027\u53d8\u6362\u6240\u5bf9\u5e94\u7684\u77e9\u9635\u3002","title":"\u603b\u7ed3"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/","text":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-07-31 | \u5206\u7c7b\uff1a plasticity theory , mathematics \u524d\u9762\u4e24\u90e8\u5206\u5206\u522b\u4ecb\u7ecd\u4e86\u5e94\u529b\u5f20\u91cf\u7684\u57fa\u7840\u548c\u5bf9\u5176\u672c\u8d28\u7684\u601d\u8003\uff0c\u6700\u7ec8\u5f97\u51fa\u4e86\u5e94\u529b\u5f20\u91cf\u7684\u672c\u8d28\u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\u7684\u7ed3\u8bba\u3002\u8fd9\u4e00\u90e8\u5206\u662f\u5bf9\u4e0a\u8ff0\u7ed3\u8bba\u7684\u9a8c\u8bc1\u8ba1\u7b97\u548c\u5173\u4e8e\u4e25\u8c28\u6027\u65b9\u9762\u7684\u8865\u5145\u8bc1\u660e\u3002 \u4e3a\u4e86\u52a0\u6df1\u5bf9\u5e94\u529b\u5f20\u91cf\u662f\u7ebf\u6027\u53d8\u6362\u7684\u77e9\u9635\u7684\u7406\u89e3\uff0c\u8fdb\u884c\u5982\u4e0b\u8ba1\u7b97\uff1a \u4ece\u7ebf\u6027\u53d8\u6362\u7684\u89d2\u5ea6\u6c42\u51fa\u53d8\u6362\u77e9\u9635\uff08\u5373\u5e94\u529b\u5f20\u91cf\uff09\uff0c\u5e76\u9a8c\u8bc1\u5176\u76f8\u4f3c\u6027 \u3002 \u4e3a\u4e86\u8ba1\u7b97\u65b9\u4fbf\u53c8\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u53d6\u5982\u4e0b\u56fe\u6240\u793a\u7684\u8ba1\u7b97\u6761\u4ef6\uff1a S_1 S_1 \u3001 S_2 S_2 \u5206\u522b\u4e3a\u5168\u5c40\u7edd\u5bf9\u5750\u6807\u7cfb S S \u4e0b\u7684\u4e24\u4e2a\u5c40\u90e8\u5750\u6807\u7cfb\uff08\u4ed6\u4eec\u7531\u622a\u53d6 P P \u70b9\u7684\u4e24\u4e24\u76f8\u4e92\u5782\u76f4\u7684\u5e73\u9762\u7684\u6cd5\u5411\u51b3\u5b9a\uff09\uff0c S_1 S_1 \u548c\u5168\u5c40\u5750\u6807\u7cfb\u91cd\u5408\uff0c S_2 S_2 \u4e3a\u5168\u5c40\u5750\u6807\u7cfb\u7ed5 z z \u8f74\u9006\u65f6\u9488\u65cb\u8f6c90\u00b0\u5f97\u5230\u3002 P P \u70b9\u5e94\u529b\u72b6\u6001\u5728 S_1 S_1 \u3001 S_2 S_2 \u7cfb\u4e0b\uff0c\u5206\u522b\u7528\u4e00\u4e2a\u5e94\u529b\u5f20\u91cf\u8868\u793a\uff0c\u5e76\u4e14\u662f\u76f8\u4f3c\u7684\u3002\u63a5\u4e0b\u6765\u5c31\u4ece\u7ebf\u6027\u53d8\u6362\u89d2\u5ea6\u8fdb\u884c\u8ba1\u7b97\u8bf4\u660e\u3002 \u5c40\u90e8\u5750\u6807\u7cfb\u7684\u57fa\u53ca\u8fc7\u6e21\u77e9\u9635 \u00b6 \u6839\u636e\u5c40\u90e8\u5750\u6807\u8f74\u5728\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u7684\u65b9\u5411\u4f59\u5f26\u5bb9\u6613\u5f97\u5230\u4ed6\u4eec\u7684\u57fa\u5206\u522b\u4e3a\uff1a \\[ \\alpha = \\left(\\alpha_1,\\,\\alpha_2,\\,\\alpha_3\\right) = \\begin{pmatrix} 1 & 0 & 0 \\\\\\ 0 & 1 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\\\\\ \\beta = \\left(\\beta_1,\\,\\beta_2,\\,\\beta_3\\right) = \\begin{pmatrix} 0 & -1 & 0 \\\\\\ 1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\] \\alpha \\alpha \u57fa\u5230 \\beta \\beta \u57fa\u7684\u8fc7\u6e21\u77e9\u9635 W W \u6ee1\u8db3 \\beta = \\alpha\\,W \\beta = \\alpha\\,W \u540c\u7406 \\beta \\beta \u57fa\u5230 \\alpha \\alpha \u57fa\u7684\u8fc7\u6e21\u77e9\u9635 W^{-1} W^{-1} \u6ee1\u8db3 \\alpha = \\beta\\,W^{-1} \\alpha = \\beta\\,W^{-1} \u89e3\u5f97\uff1a \\[ W = \\alpha^{-1}\\,\\beta = \\begin{pmatrix} 0 & -1 & 0 \\\\\\ 1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\\\\\ W^{-1} = \\beta^{-1}\\,\\alpha = \\begin{pmatrix} 0 & 1 & 0 \\\\\\ -1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\] \u7ebf\u6027\u53d8\u6362\u5728\u57fa\u4e0b\u7684\u77e9\u9635 \u00b6 \u8bbe\u5168\u5c40\u5750\u6807\u7cfb\u63cf\u8ff0\u4e0b\uff0c\u5e94\u529b\u5f20\u91cf\u8868\u793a\u4e3a \\[ \\sigma = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} & \\sigma_{13} \\\\\\ \\sigma_{21} & \\sigma_{22} & \\sigma_{23} \\\\\\ \\sigma_{31} & \\sigma_{32} & \\sigma_{33} \\end{pmatrix} \\] \u8bbe T T \u8868\u793a\u5e94\u529b\u5f20\u91cf\u5bf9\u5e94\u7684\u7ebf\u6027\u53d8\u6362\uff0c T(\\alpha_1) T(\\alpha_1) \u8868\u793a \\alpha_1 \\alpha_1 \u622a\u9762\u4e0a\u7684\u5e94\u529b\uff0c\u663e\u7136 T(\\alpha_1) = \\left(\\sigma_{11},\\,\\sigma_{12},\\,\\sigma_{13}\\right)^T T(\\alpha_1) = \\left(\\sigma_{11},\\,\\sigma_{12},\\,\\sigma_{13}\\right)^T T(\\beta_1) T(\\beta_1) \u8868\u793a S_2 S_2 \u5750\u6807\u7cfb\u4e0b \\beta_1 \\beta_1 \u622a\u9762\u4e0a\u7684\u5e94\u529b\uff0c\u5bf9\u5e94\u7684\u662f\u5168\u5c40\u5750\u6807\u7cfb\u4e0b y y \u622a\u9762\u7684\u5e94\u529b T(\\beta_1) = \\left(\\sigma_{21},\\,\\sigma_{22},\\,\\sigma_{23}\\right)^T T(\\beta_1) = \\left(\\sigma_{21},\\,\\sigma_{22},\\,\\sigma_{23}\\right)^T \u7c7b\u4f3c\u5904\u7406\u5176\u4ed6\u622a\u9762\u7684\u5e94\u529b\uff0c\u8fdb\u800c\u5f97\u5230 \\[ T(\\alpha) = T\\left(\\alpha_1,\\,\\alpha_2,\\,\\alpha_3\\right) = \\begin{pmatrix} \\sigma_{11} & \\sigma_{21} & \\sigma_{31} \\\\\\ \\sigma_{12} & \\sigma_{22} & \\sigma_{32} \\\\\\ \\sigma_{13} & \\sigma_{23} & \\sigma_{33} \\end{pmatrix} \\\\\\ T(\\beta) = T\\left(\\beta_1,\\,\\beta_2,\\,\\beta_3\\right) = \\begin{pmatrix} \\sigma_{21} & -\\sigma_{11} & \\sigma_{31} \\\\\\ \\sigma_{22} & -\\sigma_{12} & \\sigma_{32} \\\\\\ \\sigma_{23} & -\\sigma_{13} & \\sigma_{33} \\end{pmatrix} \\] \u6839\u636e T(\\alpha) = \\alpha\\,A T(\\alpha) = \\alpha\\,A \uff0c T(\\beta) = \\beta\\,B T(\\beta) = \\beta\\,B \uff0c\u5f97\u5230\u7ebf\u6027\u53d8\u6362\u5728\u57fa \\alpha,\\,\\beta \\alpha,\\,\\beta \u4e0b\u7684\u77e9\u9635\u5206\u522b\u4e3a \\[ A = \\alpha^{-1}\\,T(\\alpha) = \\begin{pmatrix} \\sigma_{11} & \\sigma_{21} & \\sigma_{31} \\\\\\ \\sigma_{12} & \\sigma_{22} & \\sigma_{32} \\\\\\ \\sigma_{13} & \\sigma_{23} & \\sigma_{33} \\end{pmatrix} \\\\\\ B = \\beta^{-1}\\,T(\\beta) = \\begin{pmatrix} \\sigma_{22} & -\\sigma_{12} & \\sigma_{32} \\\\\\ -\\sigma_{21} & \\sigma_{11} & -\\sigma_{31} \\\\\\ \\sigma_{23} & -\\sigma_{13} & \\sigma_{33} \\end{pmatrix} \\] \u4e5f\u5c31\u662f P P \u70b9\u5728 S_1 S_1 \u3001 S_2 S_2 \u5750\u6807\u7cfb\u4e0b\u7684\u5e94\u529b\u5f20\u91cf\u3002\u7531\u4e8e\u8868\u793a\u4e0a\u7684\u7f18\u6545\uff0c\u8fd9\u91cc\u4e3a\u8f6c\u7f6e\u5173\u7cfb\u3002 \u76f8\u4f3c\u5173\u7cfb \u00b6 \u9a8c\u8bc1\u53ef\u77e5 W^{-1}\\,A\\,W=B W^{-1}\\,A\\,W=B \uff0c\u5373 A \\sim B A \\sim B \\[ \\begin{align*} W^{-1}\\,A\\,W &= \\begin{pmatrix} 0 & 1 & 0 \\\\\\ -1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix}\\, \\begin{pmatrix} \\sigma_{11} & \\sigma_{21} & \\sigma_{31} \\\\\\ \\sigma_{12} & \\sigma_{22} & \\sigma_{32} \\\\\\ \\sigma_{13} & \\sigma_{23} & \\sigma_{33} \\end{pmatrix}\\, \\begin{pmatrix} 0 & -1 & 0 \\\\\\ 1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix}\\\\\\ &=\\begin{pmatrix} \\sigma_{22} & -\\sigma_{12} & \\sigma_{32} \\\\\\ -\\sigma_{21} & \\sigma_{11} & -\\sigma_{31} \\\\\\ \\sigma_{23} & -\\sigma_{13} & \\sigma_{33} \\end{pmatrix}\\\\\\ &= B \\end{align*} \\] \u81f3\u6b64\uff0c\u53ef\u4ee5\u6e05\u6670\u770b\u51fa\u4e0d\u540c\u5750\u6807\u7cfb\u4e0b\u5e94\u529b\u5f20\u91cf\u4e0e\u4e0d\u540c\u57fa\u4e0b\u7ebf\u6027\u53d8\u6362\u77e9\u9635\u7684\u7b49\u4ef7\u5173\u7cfb\u3002 \u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e \u00b6 \u4e0a\u8ff0\u5173\u4e8e\u7ebf\u6027\u53d8\u6362\u7684\u7406\u89e3\u90fd\u662f\u57fa\u4e8e \\sigma_{ij}\\,n_j=p_i \\sigma_{ij}\\,n_j=p_i \u7684\u5f62\u5f0f\u800c\u63a8\u51fa\u7684\uff0c\u663e\u5f97\u8fd8\u4e0d\u591f\u4e25\u8c28\u3002\u6bd4\u5982\uff0c\u6ca1\u6709\u8bc1\u660e\u622a\u9762\u4f4d\u7f6e\u3001\u622a\u9762\u5e94\u529b\u53ef\u4ee5\u505a\u6210\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4\uff0c\u4e5f\u6ca1\u6709\u8bc1\u660e\u4ece\u622a\u9762\u4f4d\u7f6e\u5230\u622a\u9762\u5e94\u529b\u7684\u53d8\u6362\u662f\u7ebf\u6027\u53d8\u6362\u3002 \u672c\u7740\u5f7b\u5e95\u6253\u901a\u8fd9\u6761\u601d\u8def\u7684\u5fc3\u601d\uff0c\u4e0b\u9762\u5f00\u59cb\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u5206\u6790\u3002 \u7ebf\u6027\u7a7a\u95f4\u7684\u5b9a\u4e49 \u00b6 \u8bbe V V \u662f\u4e00\u4e2a\u975e\u7a7a\u96c6\u5408\uff0c R R \u4e3a\u5b9e\u6570\u57df\u3002\u5982\u679c\u5bf9\u4e8e V V \u4e2d\u4efb\u610f\u4e24\u4e2a\u5143\u7d20 \\alpha,\\,\\beta \\alpha,\\,\\beta \uff0c V V \u4e2d\u603b\u6709\u552f\u4e00\u7684\u4e00\u4e2a\u5143\u7d20 \\gamma \\gamma \u4e0e\u4e4b\u5bf9\u5e94\uff0c\u79f0\u4e3a \\alpha \\alpha \u4e0e \\beta \\beta \u7684\u548c\uff0c\u8bb0\u4f5c \\gamma = \\alpha+\\beta \\gamma = \\alpha+\\beta \uff1b\u53c8\u5bf9\u4e8e R R \u4e2d\u4efb\u4e00\u6570 \\lambda \\lambda \u4e0e V V \u4e2d\u4efb\u4e00\u5143\u7d20 \\alpha \\alpha \uff0c V V \u4e2d\u603b\u6709\u552f\u4e00\u7684\u4e00\u4e2a\u5143\u7d20 \\delta \\delta \u4e0e\u4e4b\u5bf9\u5e94\uff0c\u79f0\u4e3a \\lambda \\lambda \u4e0e \\alpha \\alpha \u7684\u79ef\uff0c\u8bb0\u4f5c \\delta = \\lambda\\,\\alpha \\delta = \\lambda\\,\\alpha \u3002 \u5e76\u4e14\u8fd9\u4e24\u79cd\u8fd0\u7b97\u6ee1\u8db3\u4ee5\u4e0b\u516b\u6761\u8fd0\u7b97\u89c4\u5f8b\uff08\u5176\u4e2d \\alpha,\\,\\beta,\\,\\gamma \\in V \\alpha,\\,\\beta,\\,\\gamma \\in V \uff0c \\lambda,\\,\\mu \\in R \\lambda,\\,\\mu \\in R \uff09\uff1a \\alpha+\\beta=\\beta+\\alpha \\alpha+\\beta=\\beta+\\alpha (\\alpha+\\beta)+\\gamma = \\alpha + (\\beta+\\gamma) (\\alpha+\\beta)+\\gamma = \\alpha + (\\beta+\\gamma) \u5728 V V \u4e2d\u5b58\u5728\u96f6\u5143\u7d20 0 0 \uff0c\u5bf9\u4efb\u4f55 \\alpha \\alpha \u90fd\u6ee1\u8db3 \\alpha+0=\\alpha \\alpha+0=\\alpha \u5bf9\u4efb\u4f55 \\alpha \\alpha \uff0c\u90fd\u6709 \\alpha \\alpha \u7684\u8d1f\u5143\u7d20 \\beta \\beta \u6ee1\u8db3 \\alpha+\\beta=0 \\alpha+\\beta=0 1\\cdot\\alpha=\\alpha 1\\cdot\\alpha=\\alpha \\lambda\\,(\\mu\\,\\alpha) = (\\lambda\\,\\mu)\\,\\alpha \\lambda\\,(\\mu\\,\\alpha) = (\\lambda\\,\\mu)\\,\\alpha (\\lambda+\\mu)\\,\\alpha = \\lambda\\,\\alpha+\\mu\\,\\alpha (\\lambda+\\mu)\\,\\alpha = \\lambda\\,\\alpha+\\mu\\,\\alpha \\lambda\\,(\\alpha+\\beta) = \\lambda\\,\\alpha + \\lambda\\,\\beta \\lambda\\,(\\alpha+\\beta) = \\lambda\\,\\alpha + \\lambda\\,\\beta \u90a3\u4e48\uff0c V V \u5c31\u79f0\u4e3a\u5b9e\u6570\u57df R R \u4e0a\u7684\u7ebf\u6027\u7a7a\u95f4\uff08\u6216\u5411\u91cf\u7a7a\u95f4\uff09\u3002 \u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e \u00b6 \u622a\u9762\u5e94\u529b\u7a7a\u95f4\u663e\u7136\u662f\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4\uff0c\u56e0\u4e3a\u5b83\u662f\u4e00\u4e2a\u4e00\u822c\u7684\u4e09\u7ef4\u5411\u91cf\u7a7a\u95f4\u3002\u5bf9\u4e8e\u622a\u9762\u4f4d\u7f6e\u7a7a\u95f4\uff0c\u9700\u8981\u8bc1\u660e\u5176\u5bf9\u4e8e\u67d0\u79cd\u5b9a\u4e49\u7684\u52a0\u6cd5\u548c\u4e58\u6cd5\u8fd0\u7b97\u5c01\u95ed\uff0c\u4e14\u6ee1\u8db3\u4e0a\u8ff0\u8fd0\u7b97\u5f8b\u3002 \u622a\u9762\u4f4d\u7f6e\u7a7a\u95f4\u662f\u7531\u65b9\u5411\u4f59\u5f26\u63cf\u8ff0\u7684\uff0c \\[ \\begin{align*} \\alpha &= \\left(n_1,\\,n_2,\\,n_3\\right) = \\left(\\cos\\langle{\\vec{n},\\,x}\\rangle,\\,\\cos\\langle{\\vec{n},\\,y}\\rangle,\\,\\cos\\langle{\\vec{n},\\,z}\\rangle\\right) \\\\\\ \\beta &= \\left(m_1,\\,m_2,\\,m_3\\right) = \\left(\\cos\\langle{\\vec{m},\\,x}\\rangle,\\,\\cos\\langle{\\vec{m},\\,y}\\rangle,\\,\\cos\\langle{\\vec{m},\\,z}\\rangle\\right) \\end{align*} \\] \u5176\u4e2d\uff0c \\langle{\\vec{n},\\,x}\\rangle \\langle{\\vec{n},\\,x}\\rangle \u8868\u793a\u622a\u9762\u6cd5\u7ebf\u4e0ex\u8f74\u7684\u5939\u89d2\uff0c\u5176\u4f59\u4ee5\u6b64\u7c7b\u63a8\u3002 n_1,\\,n_2,\\,n_3 n_1,\\,n_2,\\,n_3 \u53d6\u503c\u8303\u56f4\u4e3a [-1,\\,1] [-1,\\,1] \uff0c\u4e14\u6ee1\u8db3 n_1^2+n_2^2+n_3^2=1 n_1^2+n_2^2+n_3^2=1 \u3002\u663e\u7136\u5e38\u89c4\u7684\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97\u4e0d\u6ee1\u8db3\u5c01\u95ed\u6761\u4ef6\u3002 \u8003\u8651\u5230\u622a\u9762\u7a7a\u95f4\u7684\u63cf\u8ff0\u7279\u5f81\uff0c\u91c7\u7528 \u7403\u5750\u6807\u7cfb\u4e0b\u89d2\u5ea6\u7684\u4ee3\u6570\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97 \u6765\u5b9a\u4e49\u3002 \u7403\u5750\u6807\u7cfb\u4e0b\uff0c \\[ \\begin{align*} \\alpha &= \\left(n_1,\\,n_2,\\,n_3\\right) = \\left(\\sin\\varphi_1\\,\\cos\\theta_1,\\,\\sin\\varphi_1\\,\\sin\\theta_1,\\,\\cos\\varphi_1\\right) \\\\\\ \\beta &= \\left(m_1,\\,m_2,\\,m_3\\right) = \\left(\\sin\\varphi_2\\,\\cos\\theta_2,\\,\\sin\\varphi_2\\,\\sin\\theta_2,\\,\\cos\\varphi_2\\right) \\end{align*} \\] \u5b9a\u4e49\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97 \\[ \\begin{align*} \\alpha + \\beta &\\triangleq \\Biggl(\\sin(\\varphi_1+\\varphi_2)\\,\\cos(\\theta_1+\\theta_2),\\,\\sin(\\varphi_1+\\varphi_2)\\,\\sin(\\theta_1+\\theta_2),\\,\\cos(\\varphi_1-\\varphi_2)\\Biggr) \\\\\\ \\lambda\\,\\alpha &\\triangleq \\Biggl(\\sin(\\lambda\\,\\varphi_1)\\,\\cos(\\lambda\\,\\theta_1),\\,\\sin(\\lambda\\,\\varphi_1)\\,\\sin(\\lambda\\,\\theta_1),\\,\\cos(\\lambda\\,\\varphi_1)\\Biggr) \\end{align*} \\] \u5728\u8fd9\u79cd\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97\u7684\u5b9a\u4e49\u4e0b\uff0c\u663e\u7136\u5bf9\u5143\u7d20\u662f\u5c01\u95ed\u7684\uff0c\u5e76\u4e14\u7b80\u5355\u9a8c\u8bc1\u5c31\u53ef\u77e5\u540c\u65f6\u6ee1\u8db3\u52a0\u6cd5\u7684\u4e24\u4e2a\u8fd0\u7b97\u5f8b\u3001\u6570\u4e58\u7684\u4e09\u4e2a\u8fd0\u7b97\u5f8b\u3002 \u96f6\u5143\u7d20\uff1a\u53d6 \\varphi=\\theta=0 \\varphi=\\theta=0 \u53ef\u5f97\u96f6\u5143\u7d20 (0,\\,0,\\,1) (0,\\,0,\\,1) \u8d1f\u5143\u7d20\uff1a\u53d6 \\beta=\\left(-\\sin\\varphi_1\\,\\cos\\theta_1,\\,-\\sin\\varphi_1\\,\\sin\\theta_1,\\,\\cos\\varphi_1\\right) \\beta=\\left(-\\sin\\varphi_1\\,\\cos\\theta_1,\\,-\\sin\\varphi_1\\,\\sin\\theta_1,\\,\\cos\\varphi_1\\right) \uff0c\u53ef\u5f97 \\alpha+\\beta=(0,\\,0,\\,1) \\alpha+\\beta=(0,\\,0,\\,1) \u4e3a\u96f6\u5143\u7d20 \u5355\u4f4d1\uff1a\u663e\u71361\u5373\u4e3a\u5355\u4f4d\u5143\u7d20 \u7efc\u4e0a\u53ef\u77e5\uff0c\u622a\u9762\u4f4d\u7f6e\u5bf9\u4e8e\u5982\u4e0a\u5b9a\u4e49\u7684\u8fd0\u7b97\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4\u3002 \u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e \u00b6 \u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e\u53ea\u9700\u8bc1\u660e\u53d8\u6362\u6ee1\u8db3\u7ebf\u6027\u8fd0\u7b97\uff0c\u5bf9\u4e8e\u6b64\u53d8\u6362 T(n)=\\sigma\\,n T(n)=\\sigma\\,n \u6ee1\u8db3 \\[ \\begin{align*} T(\\alpha + \\beta) &= \\sigma\\,(\\alpha+\\beta) = \\sigma\\,\\alpha+\\sigma\\,\\beta = T(\\alpha)+T(\\beta) \\\\\\ T(\\lambda\\,\\alpha) &= \\sigma(\\lambda\\,\\alpha) = \\lambda\\,(\\sigma\\,\\alpha) = \\lambda\\,T(\\alpha) \\end{align*} \\] \u603b\u7ed3 \u00b6 \u672c\u6587\u662f\u5bf9\u5173\u4e8e\u5e94\u529b\u5f20\u91cf\u4e0e\u7ebf\u6027\u53d8\u6362\u4e4b\u95f4\u7b49\u4ef7\u5173\u7cfb\u7684\u9a8c\u8bc1\u548c\u8bc1\u660e\uff0c\u4e3b\u8981\u662f\u7ebf\u6027\u7a7a\u95f4\u4e0e\u7ebf\u6027\u53d8\u6362\u7684\u5185\u5bb9\uff0c\u7531\u6b64\u4e5f\u53ef\u4f53\u4f1a\u76f8\u5173\u77e5\u8bc6\u7684\u8d2f\u901a\u6027\u3002\u4e3b\u8981\u77e5\u8bc6\u70b9\uff1a \u7ebf\u6027\u53d8\u6362\u5bf9\u5e94\u77e9\u9635\u7684\u6c42\u6cd5\u3002 \u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e\u65b9\u6cd5\uff1a\u5bf9\u5b9a\u4e49\u7684\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97\u5c01\u95ed\u4e14\u6ee1\u8db3\u516b\u6761\u8fd0\u7b97\u89c4\u5219\u3002","title":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2013-07-31 | \u5206\u7c7b\uff1a plasticity theory , mathematics \u524d\u9762\u4e24\u90e8\u5206\u5206\u522b\u4ecb\u7ecd\u4e86\u5e94\u529b\u5f20\u91cf\u7684\u57fa\u7840\u548c\u5bf9\u5176\u672c\u8d28\u7684\u601d\u8003\uff0c\u6700\u7ec8\u5f97\u51fa\u4e86\u5e94\u529b\u5f20\u91cf\u7684\u672c\u8d28\u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\u7684\u7ed3\u8bba\u3002\u8fd9\u4e00\u90e8\u5206\u662f\u5bf9\u4e0a\u8ff0\u7ed3\u8bba\u7684\u9a8c\u8bc1\u8ba1\u7b97\u548c\u5173\u4e8e\u4e25\u8c28\u6027\u65b9\u9762\u7684\u8865\u5145\u8bc1\u660e\u3002 \u4e3a\u4e86\u52a0\u6df1\u5bf9\u5e94\u529b\u5f20\u91cf\u662f\u7ebf\u6027\u53d8\u6362\u7684\u77e9\u9635\u7684\u7406\u89e3\uff0c\u8fdb\u884c\u5982\u4e0b\u8ba1\u7b97\uff1a \u4ece\u7ebf\u6027\u53d8\u6362\u7684\u89d2\u5ea6\u6c42\u51fa\u53d8\u6362\u77e9\u9635\uff08\u5373\u5e94\u529b\u5f20\u91cf\uff09\uff0c\u5e76\u9a8c\u8bc1\u5176\u76f8\u4f3c\u6027 \u3002 \u4e3a\u4e86\u8ba1\u7b97\u65b9\u4fbf\u53c8\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u53d6\u5982\u4e0b\u56fe\u6240\u793a\u7684\u8ba1\u7b97\u6761\u4ef6\uff1a S_1 S_1 \u3001 S_2 S_2 \u5206\u522b\u4e3a\u5168\u5c40\u7edd\u5bf9\u5750\u6807\u7cfb S S \u4e0b\u7684\u4e24\u4e2a\u5c40\u90e8\u5750\u6807\u7cfb\uff08\u4ed6\u4eec\u7531\u622a\u53d6 P P \u70b9\u7684\u4e24\u4e24\u76f8\u4e92\u5782\u76f4\u7684\u5e73\u9762\u7684\u6cd5\u5411\u51b3\u5b9a\uff09\uff0c S_1 S_1 \u548c\u5168\u5c40\u5750\u6807\u7cfb\u91cd\u5408\uff0c S_2 S_2 \u4e3a\u5168\u5c40\u5750\u6807\u7cfb\u7ed5 z z \u8f74\u9006\u65f6\u9488\u65cb\u8f6c90\u00b0\u5f97\u5230\u3002 P P \u70b9\u5e94\u529b\u72b6\u6001\u5728 S_1 S_1 \u3001 S_2 S_2 \u7cfb\u4e0b\uff0c\u5206\u522b\u7528\u4e00\u4e2a\u5e94\u529b\u5f20\u91cf\u8868\u793a\uff0c\u5e76\u4e14\u662f\u76f8\u4f3c\u7684\u3002\u63a5\u4e0b\u6765\u5c31\u4ece\u7ebf\u6027\u53d8\u6362\u89d2\u5ea6\u8fdb\u884c\u8ba1\u7b97\u8bf4\u660e\u3002","title":"\u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_2","text":"\u6839\u636e\u5c40\u90e8\u5750\u6807\u8f74\u5728\u5168\u5c40\u5750\u6807\u7cfb\u4e0b\u7684\u65b9\u5411\u4f59\u5f26\u5bb9\u6613\u5f97\u5230\u4ed6\u4eec\u7684\u57fa\u5206\u522b\u4e3a\uff1a \\[ \\alpha = \\left(\\alpha_1,\\,\\alpha_2,\\,\\alpha_3\\right) = \\begin{pmatrix} 1 & 0 & 0 \\\\\\ 0 & 1 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\\\\\ \\beta = \\left(\\beta_1,\\,\\beta_2,\\,\\beta_3\\right) = \\begin{pmatrix} 0 & -1 & 0 \\\\\\ 1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\] \\alpha \\alpha \u57fa\u5230 \\beta \\beta \u57fa\u7684\u8fc7\u6e21\u77e9\u9635 W W \u6ee1\u8db3 \\beta = \\alpha\\,W \\beta = \\alpha\\,W \u540c\u7406 \\beta \\beta \u57fa\u5230 \\alpha \\alpha \u57fa\u7684\u8fc7\u6e21\u77e9\u9635 W^{-1} W^{-1} \u6ee1\u8db3 \\alpha = \\beta\\,W^{-1} \\alpha = \\beta\\,W^{-1} \u89e3\u5f97\uff1a \\[ W = \\alpha^{-1}\\,\\beta = \\begin{pmatrix} 0 & -1 & 0 \\\\\\ 1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\\\\\ W^{-1} = \\beta^{-1}\\,\\alpha = \\begin{pmatrix} 0 & 1 & 0 \\\\\\ -1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix} \\]","title":"\u5c40\u90e8\u5750\u6807\u7cfb\u7684\u57fa\u53ca\u8fc7\u6e21\u77e9\u9635"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_3","text":"\u8bbe\u5168\u5c40\u5750\u6807\u7cfb\u63cf\u8ff0\u4e0b\uff0c\u5e94\u529b\u5f20\u91cf\u8868\u793a\u4e3a \\[ \\sigma = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} & \\sigma_{13} \\\\\\ \\sigma_{21} & \\sigma_{22} & \\sigma_{23} \\\\\\ \\sigma_{31} & \\sigma_{32} & \\sigma_{33} \\end{pmatrix} \\] \u8bbe T T \u8868\u793a\u5e94\u529b\u5f20\u91cf\u5bf9\u5e94\u7684\u7ebf\u6027\u53d8\u6362\uff0c T(\\alpha_1) T(\\alpha_1) \u8868\u793a \\alpha_1 \\alpha_1 \u622a\u9762\u4e0a\u7684\u5e94\u529b\uff0c\u663e\u7136 T(\\alpha_1) = \\left(\\sigma_{11},\\,\\sigma_{12},\\,\\sigma_{13}\\right)^T T(\\alpha_1) = \\left(\\sigma_{11},\\,\\sigma_{12},\\,\\sigma_{13}\\right)^T T(\\beta_1) T(\\beta_1) \u8868\u793a S_2 S_2 \u5750\u6807\u7cfb\u4e0b \\beta_1 \\beta_1 \u622a\u9762\u4e0a\u7684\u5e94\u529b\uff0c\u5bf9\u5e94\u7684\u662f\u5168\u5c40\u5750\u6807\u7cfb\u4e0b y y \u622a\u9762\u7684\u5e94\u529b T(\\beta_1) = \\left(\\sigma_{21},\\,\\sigma_{22},\\,\\sigma_{23}\\right)^T T(\\beta_1) = \\left(\\sigma_{21},\\,\\sigma_{22},\\,\\sigma_{23}\\right)^T \u7c7b\u4f3c\u5904\u7406\u5176\u4ed6\u622a\u9762\u7684\u5e94\u529b\uff0c\u8fdb\u800c\u5f97\u5230 \\[ T(\\alpha) = T\\left(\\alpha_1,\\,\\alpha_2,\\,\\alpha_3\\right) = \\begin{pmatrix} \\sigma_{11} & \\sigma_{21} & \\sigma_{31} \\\\\\ \\sigma_{12} & \\sigma_{22} & \\sigma_{32} \\\\\\ \\sigma_{13} & \\sigma_{23} & \\sigma_{33} \\end{pmatrix} \\\\\\ T(\\beta) = T\\left(\\beta_1,\\,\\beta_2,\\,\\beta_3\\right) = \\begin{pmatrix} \\sigma_{21} & -\\sigma_{11} & \\sigma_{31} \\\\\\ \\sigma_{22} & -\\sigma_{12} & \\sigma_{32} \\\\\\ \\sigma_{23} & -\\sigma_{13} & \\sigma_{33} \\end{pmatrix} \\] \u6839\u636e T(\\alpha) = \\alpha\\,A T(\\alpha) = \\alpha\\,A \uff0c T(\\beta) = \\beta\\,B T(\\beta) = \\beta\\,B \uff0c\u5f97\u5230\u7ebf\u6027\u53d8\u6362\u5728\u57fa \\alpha,\\,\\beta \\alpha,\\,\\beta \u4e0b\u7684\u77e9\u9635\u5206\u522b\u4e3a \\[ A = \\alpha^{-1}\\,T(\\alpha) = \\begin{pmatrix} \\sigma_{11} & \\sigma_{21} & \\sigma_{31} \\\\\\ \\sigma_{12} & \\sigma_{22} & \\sigma_{32} \\\\\\ \\sigma_{13} & \\sigma_{23} & \\sigma_{33} \\end{pmatrix} \\\\\\ B = \\beta^{-1}\\,T(\\beta) = \\begin{pmatrix} \\sigma_{22} & -\\sigma_{12} & \\sigma_{32} \\\\\\ -\\sigma_{21} & \\sigma_{11} & -\\sigma_{31} \\\\\\ \\sigma_{23} & -\\sigma_{13} & \\sigma_{33} \\end{pmatrix} \\] \u4e5f\u5c31\u662f P P \u70b9\u5728 S_1 S_1 \u3001 S_2 S_2 \u5750\u6807\u7cfb\u4e0b\u7684\u5e94\u529b\u5f20\u91cf\u3002\u7531\u4e8e\u8868\u793a\u4e0a\u7684\u7f18\u6545\uff0c\u8fd9\u91cc\u4e3a\u8f6c\u7f6e\u5173\u7cfb\u3002","title":"\u7ebf\u6027\u53d8\u6362\u5728\u57fa\u4e0b\u7684\u77e9\u9635"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_4","text":"\u9a8c\u8bc1\u53ef\u77e5 W^{-1}\\,A\\,W=B W^{-1}\\,A\\,W=B \uff0c\u5373 A \\sim B A \\sim B \\[ \\begin{align*} W^{-1}\\,A\\,W &= \\begin{pmatrix} 0 & 1 & 0 \\\\\\ -1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix}\\, \\begin{pmatrix} \\sigma_{11} & \\sigma_{21} & \\sigma_{31} \\\\\\ \\sigma_{12} & \\sigma_{22} & \\sigma_{32} \\\\\\ \\sigma_{13} & \\sigma_{23} & \\sigma_{33} \\end{pmatrix}\\, \\begin{pmatrix} 0 & -1 & 0 \\\\\\ 1 & 0 & 0 \\\\\\ 0 & 0 & 1 \\end{pmatrix}\\\\\\ &=\\begin{pmatrix} \\sigma_{22} & -\\sigma_{12} & \\sigma_{32} \\\\\\ -\\sigma_{21} & \\sigma_{11} & -\\sigma_{31} \\\\\\ \\sigma_{23} & -\\sigma_{13} & \\sigma_{33} \\end{pmatrix}\\\\\\ &= B \\end{align*} \\] \u81f3\u6b64\uff0c\u53ef\u4ee5\u6e05\u6670\u770b\u51fa\u4e0d\u540c\u5750\u6807\u7cfb\u4e0b\u5e94\u529b\u5f20\u91cf\u4e0e\u4e0d\u540c\u57fa\u4e0b\u7ebf\u6027\u53d8\u6362\u77e9\u9635\u7684\u7b49\u4ef7\u5173\u7cfb\u3002","title":"\u76f8\u4f3c\u5173\u7cfb"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_5","text":"\u4e0a\u8ff0\u5173\u4e8e\u7ebf\u6027\u53d8\u6362\u7684\u7406\u89e3\u90fd\u662f\u57fa\u4e8e \\sigma_{ij}\\,n_j=p_i \\sigma_{ij}\\,n_j=p_i \u7684\u5f62\u5f0f\u800c\u63a8\u51fa\u7684\uff0c\u663e\u5f97\u8fd8\u4e0d\u591f\u4e25\u8c28\u3002\u6bd4\u5982\uff0c\u6ca1\u6709\u8bc1\u660e\u622a\u9762\u4f4d\u7f6e\u3001\u622a\u9762\u5e94\u529b\u53ef\u4ee5\u505a\u6210\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4\uff0c\u4e5f\u6ca1\u6709\u8bc1\u660e\u4ece\u622a\u9762\u4f4d\u7f6e\u5230\u622a\u9762\u5e94\u529b\u7684\u53d8\u6362\u662f\u7ebf\u6027\u53d8\u6362\u3002 \u672c\u7740\u5f7b\u5e95\u6253\u901a\u8fd9\u6761\u601d\u8def\u7684\u5fc3\u601d\uff0c\u4e0b\u9762\u5f00\u59cb\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u5206\u6790\u3002","title":"\u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_6","text":"\u8bbe V V \u662f\u4e00\u4e2a\u975e\u7a7a\u96c6\u5408\uff0c R R \u4e3a\u5b9e\u6570\u57df\u3002\u5982\u679c\u5bf9\u4e8e V V \u4e2d\u4efb\u610f\u4e24\u4e2a\u5143\u7d20 \\alpha,\\,\\beta \\alpha,\\,\\beta \uff0c V V \u4e2d\u603b\u6709\u552f\u4e00\u7684\u4e00\u4e2a\u5143\u7d20 \\gamma \\gamma \u4e0e\u4e4b\u5bf9\u5e94\uff0c\u79f0\u4e3a \\alpha \\alpha \u4e0e \\beta \\beta \u7684\u548c\uff0c\u8bb0\u4f5c \\gamma = \\alpha+\\beta \\gamma = \\alpha+\\beta \uff1b\u53c8\u5bf9\u4e8e R R \u4e2d\u4efb\u4e00\u6570 \\lambda \\lambda \u4e0e V V \u4e2d\u4efb\u4e00\u5143\u7d20 \\alpha \\alpha \uff0c V V \u4e2d\u603b\u6709\u552f\u4e00\u7684\u4e00\u4e2a\u5143\u7d20 \\delta \\delta \u4e0e\u4e4b\u5bf9\u5e94\uff0c\u79f0\u4e3a \\lambda \\lambda \u4e0e \\alpha \\alpha \u7684\u79ef\uff0c\u8bb0\u4f5c \\delta = \\lambda\\,\\alpha \\delta = \\lambda\\,\\alpha \u3002 \u5e76\u4e14\u8fd9\u4e24\u79cd\u8fd0\u7b97\u6ee1\u8db3\u4ee5\u4e0b\u516b\u6761\u8fd0\u7b97\u89c4\u5f8b\uff08\u5176\u4e2d \\alpha,\\,\\beta,\\,\\gamma \\in V \\alpha,\\,\\beta,\\,\\gamma \\in V \uff0c \\lambda,\\,\\mu \\in R \\lambda,\\,\\mu \\in R \uff09\uff1a \\alpha+\\beta=\\beta+\\alpha \\alpha+\\beta=\\beta+\\alpha (\\alpha+\\beta)+\\gamma = \\alpha + (\\beta+\\gamma) (\\alpha+\\beta)+\\gamma = \\alpha + (\\beta+\\gamma) \u5728 V V \u4e2d\u5b58\u5728\u96f6\u5143\u7d20 0 0 \uff0c\u5bf9\u4efb\u4f55 \\alpha \\alpha \u90fd\u6ee1\u8db3 \\alpha+0=\\alpha \\alpha+0=\\alpha \u5bf9\u4efb\u4f55 \\alpha \\alpha \uff0c\u90fd\u6709 \\alpha \\alpha \u7684\u8d1f\u5143\u7d20 \\beta \\beta \u6ee1\u8db3 \\alpha+\\beta=0 \\alpha+\\beta=0 1\\cdot\\alpha=\\alpha 1\\cdot\\alpha=\\alpha \\lambda\\,(\\mu\\,\\alpha) = (\\lambda\\,\\mu)\\,\\alpha \\lambda\\,(\\mu\\,\\alpha) = (\\lambda\\,\\mu)\\,\\alpha (\\lambda+\\mu)\\,\\alpha = \\lambda\\,\\alpha+\\mu\\,\\alpha (\\lambda+\\mu)\\,\\alpha = \\lambda\\,\\alpha+\\mu\\,\\alpha \\lambda\\,(\\alpha+\\beta) = \\lambda\\,\\alpha + \\lambda\\,\\beta \\lambda\\,(\\alpha+\\beta) = \\lambda\\,\\alpha + \\lambda\\,\\beta \u90a3\u4e48\uff0c V V \u5c31\u79f0\u4e3a\u5b9e\u6570\u57df R R \u4e0a\u7684\u7ebf\u6027\u7a7a\u95f4\uff08\u6216\u5411\u91cf\u7a7a\u95f4\uff09\u3002","title":"\u7ebf\u6027\u7a7a\u95f4\u7684\u5b9a\u4e49"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_7","text":"\u622a\u9762\u5e94\u529b\u7a7a\u95f4\u663e\u7136\u662f\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4\uff0c\u56e0\u4e3a\u5b83\u662f\u4e00\u4e2a\u4e00\u822c\u7684\u4e09\u7ef4\u5411\u91cf\u7a7a\u95f4\u3002\u5bf9\u4e8e\u622a\u9762\u4f4d\u7f6e\u7a7a\u95f4\uff0c\u9700\u8981\u8bc1\u660e\u5176\u5bf9\u4e8e\u67d0\u79cd\u5b9a\u4e49\u7684\u52a0\u6cd5\u548c\u4e58\u6cd5\u8fd0\u7b97\u5c01\u95ed\uff0c\u4e14\u6ee1\u8db3\u4e0a\u8ff0\u8fd0\u7b97\u5f8b\u3002 \u622a\u9762\u4f4d\u7f6e\u7a7a\u95f4\u662f\u7531\u65b9\u5411\u4f59\u5f26\u63cf\u8ff0\u7684\uff0c \\[ \\begin{align*} \\alpha &= \\left(n_1,\\,n_2,\\,n_3\\right) = \\left(\\cos\\langle{\\vec{n},\\,x}\\rangle,\\,\\cos\\langle{\\vec{n},\\,y}\\rangle,\\,\\cos\\langle{\\vec{n},\\,z}\\rangle\\right) \\\\\\ \\beta &= \\left(m_1,\\,m_2,\\,m_3\\right) = \\left(\\cos\\langle{\\vec{m},\\,x}\\rangle,\\,\\cos\\langle{\\vec{m},\\,y}\\rangle,\\,\\cos\\langle{\\vec{m},\\,z}\\rangle\\right) \\end{align*} \\] \u5176\u4e2d\uff0c \\langle{\\vec{n},\\,x}\\rangle \\langle{\\vec{n},\\,x}\\rangle \u8868\u793a\u622a\u9762\u6cd5\u7ebf\u4e0ex\u8f74\u7684\u5939\u89d2\uff0c\u5176\u4f59\u4ee5\u6b64\u7c7b\u63a8\u3002 n_1,\\,n_2,\\,n_3 n_1,\\,n_2,\\,n_3 \u53d6\u503c\u8303\u56f4\u4e3a [-1,\\,1] [-1,\\,1] \uff0c\u4e14\u6ee1\u8db3 n_1^2+n_2^2+n_3^2=1 n_1^2+n_2^2+n_3^2=1 \u3002\u663e\u7136\u5e38\u89c4\u7684\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97\u4e0d\u6ee1\u8db3\u5c01\u95ed\u6761\u4ef6\u3002 \u8003\u8651\u5230\u622a\u9762\u7a7a\u95f4\u7684\u63cf\u8ff0\u7279\u5f81\uff0c\u91c7\u7528 \u7403\u5750\u6807\u7cfb\u4e0b\u89d2\u5ea6\u7684\u4ee3\u6570\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97 \u6765\u5b9a\u4e49\u3002 \u7403\u5750\u6807\u7cfb\u4e0b\uff0c \\[ \\begin{align*} \\alpha &= \\left(n_1,\\,n_2,\\,n_3\\right) = \\left(\\sin\\varphi_1\\,\\cos\\theta_1,\\,\\sin\\varphi_1\\,\\sin\\theta_1,\\,\\cos\\varphi_1\\right) \\\\\\ \\beta &= \\left(m_1,\\,m_2,\\,m_3\\right) = \\left(\\sin\\varphi_2\\,\\cos\\theta_2,\\,\\sin\\varphi_2\\,\\sin\\theta_2,\\,\\cos\\varphi_2\\right) \\end{align*} \\] \u5b9a\u4e49\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97 \\[ \\begin{align*} \\alpha + \\beta &\\triangleq \\Biggl(\\sin(\\varphi_1+\\varphi_2)\\,\\cos(\\theta_1+\\theta_2),\\,\\sin(\\varphi_1+\\varphi_2)\\,\\sin(\\theta_1+\\theta_2),\\,\\cos(\\varphi_1-\\varphi_2)\\Biggr) \\\\\\ \\lambda\\,\\alpha &\\triangleq \\Biggl(\\sin(\\lambda\\,\\varphi_1)\\,\\cos(\\lambda\\,\\theta_1),\\,\\sin(\\lambda\\,\\varphi_1)\\,\\sin(\\lambda\\,\\theta_1),\\,\\cos(\\lambda\\,\\varphi_1)\\Biggr) \\end{align*} \\] \u5728\u8fd9\u79cd\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97\u7684\u5b9a\u4e49\u4e0b\uff0c\u663e\u7136\u5bf9\u5143\u7d20\u662f\u5c01\u95ed\u7684\uff0c\u5e76\u4e14\u7b80\u5355\u9a8c\u8bc1\u5c31\u53ef\u77e5\u540c\u65f6\u6ee1\u8db3\u52a0\u6cd5\u7684\u4e24\u4e2a\u8fd0\u7b97\u5f8b\u3001\u6570\u4e58\u7684\u4e09\u4e2a\u8fd0\u7b97\u5f8b\u3002 \u96f6\u5143\u7d20\uff1a\u53d6 \\varphi=\\theta=0 \\varphi=\\theta=0 \u53ef\u5f97\u96f6\u5143\u7d20 (0,\\,0,\\,1) (0,\\,0,\\,1) \u8d1f\u5143\u7d20\uff1a\u53d6 \\beta=\\left(-\\sin\\varphi_1\\,\\cos\\theta_1,\\,-\\sin\\varphi_1\\,\\sin\\theta_1,\\,\\cos\\varphi_1\\right) \\beta=\\left(-\\sin\\varphi_1\\,\\cos\\theta_1,\\,-\\sin\\varphi_1\\,\\sin\\theta_1,\\,\\cos\\varphi_1\\right) \uff0c\u53ef\u5f97 \\alpha+\\beta=(0,\\,0,\\,1) \\alpha+\\beta=(0,\\,0,\\,1) \u4e3a\u96f6\u5143\u7d20 \u5355\u4f4d1\uff1a\u663e\u71361\u5373\u4e3a\u5355\u4f4d\u5143\u7d20 \u7efc\u4e0a\u53ef\u77e5\uff0c\u622a\u9762\u4f4d\u7f6e\u5bf9\u4e8e\u5982\u4e0a\u5b9a\u4e49\u7684\u8fd0\u7b97\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4\u3002","title":"\u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_8","text":"\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e\u53ea\u9700\u8bc1\u660e\u53d8\u6362\u6ee1\u8db3\u7ebf\u6027\u8fd0\u7b97\uff0c\u5bf9\u4e8e\u6b64\u53d8\u6362 T(n)=\\sigma\\,n T(n)=\\sigma\\,n \u6ee1\u8db3 \\[ \\begin{align*} T(\\alpha + \\beta) &= \\sigma\\,(\\alpha+\\beta) = \\sigma\\,\\alpha+\\sigma\\,\\beta = T(\\alpha)+T(\\beta) \\\\\\ T(\\lambda\\,\\alpha) &= \\sigma(\\lambda\\,\\alpha) = \\lambda\\,(\\sigma\\,\\alpha) = \\lambda\\,T(\\alpha) \\end{align*} \\]","title":"\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e"},{"location":"2013-07-31-%E5%BA%94%E5%8A%9B%E5%BC%A0%E9%87%8F%E7%9A%84%E8%AE%A4%E8%AF%86%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E8%AF%81%E6%98%8E/#_9","text":"\u672c\u6587\u662f\u5bf9\u5173\u4e8e\u5e94\u529b\u5f20\u91cf\u4e0e\u7ebf\u6027\u53d8\u6362\u4e4b\u95f4\u7b49\u4ef7\u5173\u7cfb\u7684\u9a8c\u8bc1\u548c\u8bc1\u660e\uff0c\u4e3b\u8981\u662f\u7ebf\u6027\u7a7a\u95f4\u4e0e\u7ebf\u6027\u53d8\u6362\u7684\u5185\u5bb9\uff0c\u7531\u6b64\u4e5f\u53ef\u4f53\u4f1a\u76f8\u5173\u77e5\u8bc6\u7684\u8d2f\u901a\u6027\u3002\u4e3b\u8981\u77e5\u8bc6\u70b9\uff1a \u7ebf\u6027\u53d8\u6362\u5bf9\u5e94\u77e9\u9635\u7684\u6c42\u6cd5\u3002 \u7ebf\u6027\u7a7a\u95f4\u7684\u8bc1\u660e\u65b9\u6cd5\uff1a\u5bf9\u5b9a\u4e49\u7684\u52a0\u6cd5\u548c\u6570\u4e58\u8fd0\u7b97\u5c01\u95ed\u4e14\u6ee1\u8db3\u516b\u6761\u8fd0\u7b97\u89c4\u5219\u3002","title":"\u603b\u7ed3"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/","text":"UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528 \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-08-05 | \u5206\u7c7b\uff1a CAD/CAE integration UG NX\u6839\u636e\u7528\u6237\u7684\u7ecf\u9a8c\u6c34\u5e73\u3001\u884c\u4e1a\u6216\u8005\u516c\u53f8\u6807\u51c6\u63d0\u4f9b\u4e86\u4e00\u79cd\u5148\u8fdb\u7684\u754c\u9762\u63a7\u5236\u65b9\u5f0f\u2014\u2014 \u89d2\u8272 \u3002\u7528\u6237\u53ef\u5728\u6307\u5b9a\u7684\u89d2\u8272\u4e0b\u4fdd\u5b58\u754c\u9762\u8bbe\u7f6e\uff0c\u8be5\u754c\u9762\u53ef\u4ee5\u4ec5\u4fdd\u7559\u5f53\u524d\u4efb\u52a1\u6240\u9700\u8981\u7684\u547d\u4ee4\uff0c\u4ece\u800c\u7b80\u5316\u7528\u6237\u754c\u9762\uff0c\u63d0\u9ad8\u64cd\u4f5c\u6548\u7387\u3002 \u7b2c\u4e00\u6b21\u542f\u52a8NX\u65f6\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f7f\u7528\u7684\u89d2\u8272\u4e3a\u57fa\u672c\u529f\u80fd\u89d2\u8272\uff0c\u5305\u62ec\u4e86\u4e00\u4e9b\u5e38\u7528\u547d\u4ee4\uff0c\u9002\u5408\u65b0\u624b\u7528\u6237\u6216\u4e34\u65f6\u7528\u6237\u3002\u968f\u7740\u4f7f\u7528\u7684\u6df1\u5165\uff0c\u7528\u6237\u81ea\u7136\u4f1a\u4ea7\u751f\u4e2a\u6027\u5316\u5b9a\u5236\u7684\u9700\u6c42\u3002\u672c\u6587\u5c06\u4ee5\u56fe\u6587\u6559\u7a0b\u7684\u65b9\u5f0f\uff0c\u8be6\u7ec6\u4ecb\u7ecdUG NX\u89d2\u8272\u7684\u5b9a\u5236\u4e0e\u4f7f\u7528\u3002 \u89d2\u8272\u7684\u7528\u6237\u754c\u9762\u5305\u62ec\u4e24\u4e2a\u65b9\u9762\uff1a \u5de5\u5177\u6761/\u83dc\u5355\u5185\u5bb9\uff0c\u5206\u4e3a\u7cfb\u7edf\u3001\u81ea\u5b9a\u4e49\u5de5\u5177\u6761/\u83dc\u5355\u7684\u5b9a\u5236\uff0c\u662f\u672c\u6587\u9610\u8ff0\u7684\u4e3b\u8981\u90e8\u5206\uff1b \u663e\u793a\u98ce\u683c\uff0c\u4e3b\u8981\u6839\u636e\u7528\u6237\u7684\u64cd\u4f5c\u4e60\u60ef\u8bbe\u7f6e\u5de5\u5177\u680f\u3001\u83dc\u5355\u663e\u793a\u4f4d\u7f6e\u3001\u65b9\u5f0f\u7b49\u3002 \u4e0b\u56fe\u4e3a\u5b9a\u5236\u540e\u7684\u754c\u9762\u793a\u610f\u56fe\u3002 \u7cfb\u7edf\u89d2\u8272 \u00b6 \u5728\u8d44\u6e90\u6761\u7684role\u89d2\u8272\u9009\u9879\u5361\u4e0a\u5df2\u7ecf\u5185\u7f6e\u4e86\u4e00\u4e9b\u89d2\u8272\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u5e76\u4f7f\u7528\u4ed6\u4eec\uff1b\u5e76\u4e14\u53ef\u4ee5\u5728\u5176\u57fa\u7840\u4e0a\u8fdb\u884c\u5b9a\u5236\uff0c\u4f46\u662f\u9700\u8981\u5c06\u5b9a\u5236\u7ed3\u679c\u65b0\u5efa\u4e3a\u7528\u6237\u89d2\u8272\u6216\u4fdd\u5b58\u89d2\u8272\u6587\u4ef6\uff0c\u624d\u53ef\u4ee5\u4fdd\u7559\u5b9a\u5236\u6548\u679c\u5e76\u5728\u4ee5\u540e\u8c03\u7528\u3002 \u4e3a\u4e86\u65b9\u4fbf\u4e0b\u9762\u7684\u5b9a\u5236\uff0c\u9009\u62e9\u5177\u6709\u5b8c\u5168\u83dc\u5355\u7684\u89d2\u8272\u2014\u2014Advanced with full menus\u3002 \u63a5\u4e0b\u6765\u5bf9\u7cfb\u7edf\u5df2\u6709\u83dc\u5355\u3001\u5de5\u5177\u6761\u8fdb\u884c\u83dc\u5355\u9879\u3001\u5de5\u5177\u6761\u6309\u94ae\u7684\u9009\u62e9\u6027\u663e\u793a\uff0c\u4e5f\u53ef\u4ee5\u5b8c\u5168\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684\u5de5\u5177\u6761\u3002\u8fd9\u91cc\u9700\u8981\u8bf4\u660e\u7684\u662f\uff1a\u4f7f\u7528\u7684\u4ecd\u7136\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u57fa\u672c\u5de5\u5177\u6761\u6309\u94ae\u3001\u83dc\u5355\u9879\uff0c\u53ea\u4e0d\u8fc7\u662f\u4ee5\u6211\u4eec\u9700\u8981\u7684\u65b9\u5f0f\u91cd\u65b0\u8fdb\u884c\u7ec4\u5408\uff1b\u5982\u679c\u9700\u8981\u5f00\u53d1\u81ea\u5b9a\u4e49\u529f\u80fd\u7684\u6309\u94ae\u3001\u83dc\u5355\u9879\uff0c\u5219\u9700\u8981\u4e8c\u6b21\u5f00\u53d1\u7684\u77e5\u8bc6\uff0c\u4e0d\u5728\u672c\u6587\u8ba8\u8bba\u8303\u56f4\u3002 \u5b9a\u5236\u7cfb\u7edf\u83dc\u5355 \u00b6 Tools -> Customize \u6216\u8005\u76f4\u63a5\u4f7f\u7528\u5feb\u6377\u952e Ctrl+1 \u6253\u5f00\u5de5\u5177\u6761/\u83dc\u5355\u81ea\u5b9a\u4e49\u9762\u677f\uff0c\u5373\u53ef\u901a\u8fc7\u62d6\u62fd\u81ea\u5b9a\u4e49\u83dc\u5355\u6216\u8005\u83dc\u5355\u9879\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5207\u6362\u5230 command \u9762\u677f\uff0c\u5728\u5de6\u4fa7 Categories \u4e2d\u9009\u62e9\u83dc\u5355\u680f Menu Bar \uff0c\u53ef\u4ee5\u4efb\u610f\u62d6\u62fd\u53f3\u4fa7\u7684\u83dc\u5355\u5230UG\u83dc\u5355\u680f\u7684\u4efb\u610f\u4f4d\u7f6e\u3002 \u70b9\u51fb\u67d0\u4e2a\u83dc\u5355\uff0c\u53ef\u4ee5\u4efb\u610f\u62d6\u62fd\u83dc\u5355\u9879\uff0c\u4e5f\u53ef\u4ee5\u5c06\u7528\u6237\u81ea\u5b9a\u4e49\u9762\u677f\u4e2d\u4efb\u610f\u6309\u94ae\u6216\u83dc\u5355\u9879\u62d6\u62fd\u8fdb\u53bb\u3002 \u5b9a\u5236\u7cfb\u7edf\u5de5\u5177\u6761 \u00b6 \u5728\u5e38\u89c4\u72b6\u6001\u4e0b\uff0c\u53f3\u51fb\u5de5\u5177\u680f\u7a7a\u767d\u5904\uff0c\u901a\u8fc7\u9009\u62e9/\u53d6\u6d88\u52fe\u9009\u53ef\u4ee5\u63a7\u5236\u5de5\u5177\u6761\u7684\u663e\u793a\u548c\u9690\u85cf\uff0c\u5bf9\u4e8e\u5df2\u7ecf\u663e\u793a\u7684\u5de5\u5177\u6761\uff0c\u5355\u51fb\u53f3\u4fa7\u7684\u5c0f\u4e09\u89d2\u56fe\u6807\uff0c\u53ef\u4ee5\u63a7\u5236\u5de5\u5177\u680f\u5185\u56fe\u6807\u7684\u663e\u793a\u548c\u9690\u85cf\u3002 \u5728\u81ea\u5b9a\u4e49\u72b6\u6001\u4e0b\uff08 Tools -> Customize \uff09\uff0c\u9009\u62e9\u5de5\u5177\u6761 Toolbars \u9762\u677f\u2460\uff0c\u53ef\u4ee5\u63a7\u5236\u7cfb\u7edf\u5de5\u5177\u6761\u7684\u663e\u9690\uff0c\u7136\u540e\u5207\u6362\u5230\u547d\u4ee4 Commands \u9762\u677f\u2461\uff0c\u914d\u5408 Categories \u548c Commands \u9009\u62e9\u9700\u8981\u7684\u529f\u80fd\u6309\u94ae\u2462\u2463\uff0c\u5c06\u5176\u62d6\u62fd\u5230\u7cfb\u7edf\u5de5\u5177\u6761\u4e0a\u2464\u3002 \u5728\u7528\u6237\u81ea\u5b9a\u4e49\u9762\u677f\u7684\u5de5\u5177\u6761\u9009\u9879\u5361\u4e0b\u6709\u4e09\u4e2a\u7cfb\u7edf\u5de5\u5177\u6761\u2014\u2014 Radial 1 \u3001 Radial 2 \u3001 Radial 3 \uff0c\u5206\u522b\u5bf9\u5e94\u5feb\u952e\u5de5\u5177\u6761 Ctrl+Shift+\u5de6\u952e \u3001 Ctrl+Shift+\u4e2d\u952e \u3001 Ctrl+Shift+\u53f3\u952e \uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\u62d6\u62fd\u5e03\u7f6e\u65b0\u7684\u6309\u94ae\u3002 \u5b9a\u5236\u7528\u6237\u5de5\u5177\u6761 \u00b6 \u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u5de5\u5177\u6761\uff0c\u7ec4\u7ec7\u4e00\u4e9b\u7279\u5b9a\u529f\u80fd\u7684\u6309\u94ae\u3002\u57fa\u672c\u6b65\u9aa4\u5982\u4e0b\uff1a \u5728\u7528\u6237\u81ea\u5b9a\u4e49\u9762\u677f\u4e2d\u70b9\u51fb New \u6309\u94ae\u65b0\u5efa\u5de5\u5177\u6761\uff0c\u547d\u540d\u5e76\u9009\u62e9\u542f\u7528\u7684\u6a21\u5757\uff08\u5373\u5728\u90a3\u4e9b\u6a21\u5757\u4e0b\uff0c\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\u662f\u53ef\u7528\u7684\uff09\u3002\u786e\u5b9a\u540e\u51fa\u73b0\u65b0\u7684\u7a7a\u767d\u5de5\u5177\u6761\u3002 \u7c7b\u4f3c\u81ea\u5b9a\u4e49\u7cfb\u7edf\u5de5\u5177\u6761\u7684\u65b9\u6cd5\uff0c\u4efb\u610f\u62d6\u62fd\u65b0\u7684\u5185\u5bb9\uff08\u83dc\u5355\u9879\u3001\u6309\u94ae\u6216\u8005\u83dc\u5355\uff09\u5230\u65b0\u5efa\u7684\u5de5\u5177\u6761\u4e2d\u3002\u4f8b\u5982\u4e0b\u9762\u4e24\u5e45\u56fe\u5206\u522b\u663e\u793a\u4e24\u79cd\u4e0d\u540c\u98ce\u683c\u7684\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u83dc\u5355\u5f62\u5f0f\u7684\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\uff0c\u8fd8\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\u5176\u663e\u793a\u540d\u79f0\u3002 \u5b9a\u5236\u5de5\u5177\u6761/\u83dc\u5355\u663e\u793a\u98ce\u683c \u00b6 \u5b8c\u6210\u5b9a\u5236\u540e\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u505c\u9760\u4f4d\u7f6e\uff0c\u663e\u793a\u7684\u98ce\u683c\u5982\u662f\u5426\u663e\u793a\u540d\u79f0\u3001\u56fe\u6807\u7684\u5927\u5c0f\u7b49\u3002 \u505c\u9760\u4f4d\u7f6e\uff1a\u6839\u636e\u9700\u8981\u548c\u4e60\u60ef\uff0c\u62d6\u62fd\u5de5\u5177\u6761\u5230\u56db\u5468\u4efb\u610f\u4f4d\u7f6e\uff0c\u5f85\u5176\u81ea\u52a8\u505c\u9760\u540e\u91ca\u653e\u9f20\u6807\u3002 \u901a\u8fc7\u52fe\u9009/\u53d6\u6d88 Text Below Icon \u590d\u9009\u6846\u51b3\u5b9a\u662f\u5426\u663e\u793a\u6309\u94ae\u540d\u79f0\u3002 \u5728 Costomize->Options \u9762\u677f\u4e0b\u8bbe\u7f6e\u56fe\u6807\u7684\u5927\u5c0f\u3002 \u521b\u5efa\u548c\u5e94\u7528\u89d2\u8272 \u00b6 \u5b8c\u6210\u4ee5\u4e0a\u8bbe\u7f6e\u540e\uff0c\u9700\u8981\u4fdd\u5b58\u8bbe\u7f6e\u4ee5\u4fbf\u4e0b\u6b21\u8c03\u7528\u3002\u53ef\u4ee5\u6709\u4e24\u4e2a\u65b9\u6cd5\uff1a \u65b0\u5efa\u7528\u6237\u89d2\u8272 \u5728\u8d44\u6e90\u6761\u89d2\u8272\u9762\u677f\u7a7a\u767d\u5904\u53f3\u51fb\uff0c\u9009\u62e9 New User Role \uff0c\u65b0\u5efa\u7528\u6237\u89d2\u8272\uff0c\u4f9d\u6b21\u586b\u5199\u7528\u6237\u89d2\u8272\u540d\u79f0\u3001\u663e\u793a\u56fe\u7247\u3001\u63cf\u8ff0\u8bf4\u660e\u7b49\uff0c\u6700\u7ec8\u5728\u7528\u6237\u89d2\u8272 User \u5206\u7ec4\u4e0b\u5373\u53ef\u67e5\u770b\u65b0\u5efa\u7684\u89d2\u8272\u3002\u5728\u4ee5\u540e\u7684\u5e94\u7528\u4e2d\uff0c\u53ea\u9700\u4ece\u8d44\u6e90\u6761\u89d2\u8272\u9762\u677f\u9009\u62e9\u8be5\u89d2\u8272\u56fe\u6807\uff0c\u5373\u53ef\u5bfc\u5165\u8be5\u89d2\u8272\u7684\u6240\u6709\u8bbe\u7f6e\u3002 \u4fdd\u5b58\u89d2\u8272\u6587\u4ef6 \u5c06\u7528\u6237\u81ea\u5b9a\u4e49 Costomize \u9762\u677f\u5207\u6362\u5230\u89d2\u8272 Roles \u9009\u9879\u5361\uff0c\u5355\u51fb Create \u521b\u5efa\u89d2\u8272\u914d\u7f6e .mtx \u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u8bb0\u5f55\u4e86\u4e4b\u524d\u5bf9\u5de5\u5177\u6761\u3001\u83dc\u5355\u7684\u6240\u6709\u8bbe\u7f6e\uff0c\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u914d\u7f6e\u65f6\uff0c\u70b9\u51fb Load \u9009\u62e9\u76f8\u5e94\u7684 .mtx \u89d2\u8272\u6587\u4ef6\u5373\u53ef\u3002 \u603b\u7ed3 \u00b6 \u672c\u6587\u8be6\u7ec6\u4ecb\u7ecd\u4e86UG NX\u89d2\u8272\u7684\u5b9a\u5236\u548c\u5e94\u7528\u65b9\u6cd5\uff0c\u57fa\u672c\u6d41\u7a0b\u6982\u62ec\u4e3a\uff1a \u5728\u8d44\u6e90\u6761\u9009\u62e9\u6700\u63a5\u8fd1\u9700\u6c42\u7684\u89d2\u8272\uff0c\u4ee5\u5176\u4e3a\u57fa\u7840\u5f00\u59cb\u5b9a\u5236\uff1b \u5728\u6700\u5e38\u7528\u7684\u5e94\u7528\u6a21\u5757\u4e2d\u5b9a\u5236\u7cfb\u7edf\u5de5\u5177\u6761\u3001\u83dc\u5355\u6216\u65b0\u5efa\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\uff0c\u8bbe\u7f6e\u5de5\u5177\u6761\u505c\u9760\u4f4d\u7f6e\u3001\u663e\u793a\u98ce\u683c\u7b49\uff1b \u5b8c\u6210\u8bbe\u7f6e\u540e\u521b\u5efa\u81ea\u5b9a\u4e49\u89d2\u8272\u6216\u8005\u76f4\u63a5\u5bfc\u51fa\u89d2\u8272\u6587\u4ef6\u4ee5\u4fbf\u4ee5\u540e\u52a0\u8f7d\u4f7f\u7528\u3002","title":"UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#ug nx","text":"\u53d1\u5e03\u4e8e\uff1a2013-08-05 | \u5206\u7c7b\uff1a CAD/CAE integration UG NX\u6839\u636e\u7528\u6237\u7684\u7ecf\u9a8c\u6c34\u5e73\u3001\u884c\u4e1a\u6216\u8005\u516c\u53f8\u6807\u51c6\u63d0\u4f9b\u4e86\u4e00\u79cd\u5148\u8fdb\u7684\u754c\u9762\u63a7\u5236\u65b9\u5f0f\u2014\u2014 \u89d2\u8272 \u3002\u7528\u6237\u53ef\u5728\u6307\u5b9a\u7684\u89d2\u8272\u4e0b\u4fdd\u5b58\u754c\u9762\u8bbe\u7f6e\uff0c\u8be5\u754c\u9762\u53ef\u4ee5\u4ec5\u4fdd\u7559\u5f53\u524d\u4efb\u52a1\u6240\u9700\u8981\u7684\u547d\u4ee4\uff0c\u4ece\u800c\u7b80\u5316\u7528\u6237\u754c\u9762\uff0c\u63d0\u9ad8\u64cd\u4f5c\u6548\u7387\u3002 \u7b2c\u4e00\u6b21\u542f\u52a8NX\u65f6\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f7f\u7528\u7684\u89d2\u8272\u4e3a\u57fa\u672c\u529f\u80fd\u89d2\u8272\uff0c\u5305\u62ec\u4e86\u4e00\u4e9b\u5e38\u7528\u547d\u4ee4\uff0c\u9002\u5408\u65b0\u624b\u7528\u6237\u6216\u4e34\u65f6\u7528\u6237\u3002\u968f\u7740\u4f7f\u7528\u7684\u6df1\u5165\uff0c\u7528\u6237\u81ea\u7136\u4f1a\u4ea7\u751f\u4e2a\u6027\u5316\u5b9a\u5236\u7684\u9700\u6c42\u3002\u672c\u6587\u5c06\u4ee5\u56fe\u6587\u6559\u7a0b\u7684\u65b9\u5f0f\uff0c\u8be6\u7ec6\u4ecb\u7ecdUG NX\u89d2\u8272\u7684\u5b9a\u5236\u4e0e\u4f7f\u7528\u3002 \u89d2\u8272\u7684\u7528\u6237\u754c\u9762\u5305\u62ec\u4e24\u4e2a\u65b9\u9762\uff1a \u5de5\u5177\u6761/\u83dc\u5355\u5185\u5bb9\uff0c\u5206\u4e3a\u7cfb\u7edf\u3001\u81ea\u5b9a\u4e49\u5de5\u5177\u6761/\u83dc\u5355\u7684\u5b9a\u5236\uff0c\u662f\u672c\u6587\u9610\u8ff0\u7684\u4e3b\u8981\u90e8\u5206\uff1b \u663e\u793a\u98ce\u683c\uff0c\u4e3b\u8981\u6839\u636e\u7528\u6237\u7684\u64cd\u4f5c\u4e60\u60ef\u8bbe\u7f6e\u5de5\u5177\u680f\u3001\u83dc\u5355\u663e\u793a\u4f4d\u7f6e\u3001\u65b9\u5f0f\u7b49\u3002 \u4e0b\u56fe\u4e3a\u5b9a\u5236\u540e\u7684\u754c\u9762\u793a\u610f\u56fe\u3002","title":"UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_1","text":"\u5728\u8d44\u6e90\u6761\u7684role\u89d2\u8272\u9009\u9879\u5361\u4e0a\u5df2\u7ecf\u5185\u7f6e\u4e86\u4e00\u4e9b\u89d2\u8272\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u5e76\u4f7f\u7528\u4ed6\u4eec\uff1b\u5e76\u4e14\u53ef\u4ee5\u5728\u5176\u57fa\u7840\u4e0a\u8fdb\u884c\u5b9a\u5236\uff0c\u4f46\u662f\u9700\u8981\u5c06\u5b9a\u5236\u7ed3\u679c\u65b0\u5efa\u4e3a\u7528\u6237\u89d2\u8272\u6216\u4fdd\u5b58\u89d2\u8272\u6587\u4ef6\uff0c\u624d\u53ef\u4ee5\u4fdd\u7559\u5b9a\u5236\u6548\u679c\u5e76\u5728\u4ee5\u540e\u8c03\u7528\u3002 \u4e3a\u4e86\u65b9\u4fbf\u4e0b\u9762\u7684\u5b9a\u5236\uff0c\u9009\u62e9\u5177\u6709\u5b8c\u5168\u83dc\u5355\u7684\u89d2\u8272\u2014\u2014Advanced with full menus\u3002 \u63a5\u4e0b\u6765\u5bf9\u7cfb\u7edf\u5df2\u6709\u83dc\u5355\u3001\u5de5\u5177\u6761\u8fdb\u884c\u83dc\u5355\u9879\u3001\u5de5\u5177\u6761\u6309\u94ae\u7684\u9009\u62e9\u6027\u663e\u793a\uff0c\u4e5f\u53ef\u4ee5\u5b8c\u5168\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684\u5de5\u5177\u6761\u3002\u8fd9\u91cc\u9700\u8981\u8bf4\u660e\u7684\u662f\uff1a\u4f7f\u7528\u7684\u4ecd\u7136\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u57fa\u672c\u5de5\u5177\u6761\u6309\u94ae\u3001\u83dc\u5355\u9879\uff0c\u53ea\u4e0d\u8fc7\u662f\u4ee5\u6211\u4eec\u9700\u8981\u7684\u65b9\u5f0f\u91cd\u65b0\u8fdb\u884c\u7ec4\u5408\uff1b\u5982\u679c\u9700\u8981\u5f00\u53d1\u81ea\u5b9a\u4e49\u529f\u80fd\u7684\u6309\u94ae\u3001\u83dc\u5355\u9879\uff0c\u5219\u9700\u8981\u4e8c\u6b21\u5f00\u53d1\u7684\u77e5\u8bc6\uff0c\u4e0d\u5728\u672c\u6587\u8ba8\u8bba\u8303\u56f4\u3002","title":"\u7cfb\u7edf\u89d2\u8272"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_2","text":"Tools -> Customize \u6216\u8005\u76f4\u63a5\u4f7f\u7528\u5feb\u6377\u952e Ctrl+1 \u6253\u5f00\u5de5\u5177\u6761/\u83dc\u5355\u81ea\u5b9a\u4e49\u9762\u677f\uff0c\u5373\u53ef\u901a\u8fc7\u62d6\u62fd\u81ea\u5b9a\u4e49\u83dc\u5355\u6216\u8005\u83dc\u5355\u9879\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5207\u6362\u5230 command \u9762\u677f\uff0c\u5728\u5de6\u4fa7 Categories \u4e2d\u9009\u62e9\u83dc\u5355\u680f Menu Bar \uff0c\u53ef\u4ee5\u4efb\u610f\u62d6\u62fd\u53f3\u4fa7\u7684\u83dc\u5355\u5230UG\u83dc\u5355\u680f\u7684\u4efb\u610f\u4f4d\u7f6e\u3002 \u70b9\u51fb\u67d0\u4e2a\u83dc\u5355\uff0c\u53ef\u4ee5\u4efb\u610f\u62d6\u62fd\u83dc\u5355\u9879\uff0c\u4e5f\u53ef\u4ee5\u5c06\u7528\u6237\u81ea\u5b9a\u4e49\u9762\u677f\u4e2d\u4efb\u610f\u6309\u94ae\u6216\u83dc\u5355\u9879\u62d6\u62fd\u8fdb\u53bb\u3002","title":"\u5b9a\u5236\u7cfb\u7edf\u83dc\u5355"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_3","text":"\u5728\u5e38\u89c4\u72b6\u6001\u4e0b\uff0c\u53f3\u51fb\u5de5\u5177\u680f\u7a7a\u767d\u5904\uff0c\u901a\u8fc7\u9009\u62e9/\u53d6\u6d88\u52fe\u9009\u53ef\u4ee5\u63a7\u5236\u5de5\u5177\u6761\u7684\u663e\u793a\u548c\u9690\u85cf\uff0c\u5bf9\u4e8e\u5df2\u7ecf\u663e\u793a\u7684\u5de5\u5177\u6761\uff0c\u5355\u51fb\u53f3\u4fa7\u7684\u5c0f\u4e09\u89d2\u56fe\u6807\uff0c\u53ef\u4ee5\u63a7\u5236\u5de5\u5177\u680f\u5185\u56fe\u6807\u7684\u663e\u793a\u548c\u9690\u85cf\u3002 \u5728\u81ea\u5b9a\u4e49\u72b6\u6001\u4e0b\uff08 Tools -> Customize \uff09\uff0c\u9009\u62e9\u5de5\u5177\u6761 Toolbars \u9762\u677f\u2460\uff0c\u53ef\u4ee5\u63a7\u5236\u7cfb\u7edf\u5de5\u5177\u6761\u7684\u663e\u9690\uff0c\u7136\u540e\u5207\u6362\u5230\u547d\u4ee4 Commands \u9762\u677f\u2461\uff0c\u914d\u5408 Categories \u548c Commands \u9009\u62e9\u9700\u8981\u7684\u529f\u80fd\u6309\u94ae\u2462\u2463\uff0c\u5c06\u5176\u62d6\u62fd\u5230\u7cfb\u7edf\u5de5\u5177\u6761\u4e0a\u2464\u3002 \u5728\u7528\u6237\u81ea\u5b9a\u4e49\u9762\u677f\u7684\u5de5\u5177\u6761\u9009\u9879\u5361\u4e0b\u6709\u4e09\u4e2a\u7cfb\u7edf\u5de5\u5177\u6761\u2014\u2014 Radial 1 \u3001 Radial 2 \u3001 Radial 3 \uff0c\u5206\u522b\u5bf9\u5e94\u5feb\u952e\u5de5\u5177\u6761 Ctrl+Shift+\u5de6\u952e \u3001 Ctrl+Shift+\u4e2d\u952e \u3001 Ctrl+Shift+\u53f3\u952e \uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\u62d6\u62fd\u5e03\u7f6e\u65b0\u7684\u6309\u94ae\u3002","title":"\u5b9a\u5236\u7cfb\u7edf\u5de5\u5177\u6761"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_4","text":"\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u5de5\u5177\u6761\uff0c\u7ec4\u7ec7\u4e00\u4e9b\u7279\u5b9a\u529f\u80fd\u7684\u6309\u94ae\u3002\u57fa\u672c\u6b65\u9aa4\u5982\u4e0b\uff1a \u5728\u7528\u6237\u81ea\u5b9a\u4e49\u9762\u677f\u4e2d\u70b9\u51fb New \u6309\u94ae\u65b0\u5efa\u5de5\u5177\u6761\uff0c\u547d\u540d\u5e76\u9009\u62e9\u542f\u7528\u7684\u6a21\u5757\uff08\u5373\u5728\u90a3\u4e9b\u6a21\u5757\u4e0b\uff0c\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\u662f\u53ef\u7528\u7684\uff09\u3002\u786e\u5b9a\u540e\u51fa\u73b0\u65b0\u7684\u7a7a\u767d\u5de5\u5177\u6761\u3002 \u7c7b\u4f3c\u81ea\u5b9a\u4e49\u7cfb\u7edf\u5de5\u5177\u6761\u7684\u65b9\u6cd5\uff0c\u4efb\u610f\u62d6\u62fd\u65b0\u7684\u5185\u5bb9\uff08\u83dc\u5355\u9879\u3001\u6309\u94ae\u6216\u8005\u83dc\u5355\uff09\u5230\u65b0\u5efa\u7684\u5de5\u5177\u6761\u4e2d\u3002\u4f8b\u5982\u4e0b\u9762\u4e24\u5e45\u56fe\u5206\u522b\u663e\u793a\u4e24\u79cd\u4e0d\u540c\u98ce\u683c\u7684\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u83dc\u5355\u5f62\u5f0f\u7684\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\uff0c\u8fd8\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\u5176\u663e\u793a\u540d\u79f0\u3002","title":"\u5b9a\u5236\u7528\u6237\u5de5\u5177\u6761"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_5","text":"\u5b8c\u6210\u5b9a\u5236\u540e\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u505c\u9760\u4f4d\u7f6e\uff0c\u663e\u793a\u7684\u98ce\u683c\u5982\u662f\u5426\u663e\u793a\u540d\u79f0\u3001\u56fe\u6807\u7684\u5927\u5c0f\u7b49\u3002 \u505c\u9760\u4f4d\u7f6e\uff1a\u6839\u636e\u9700\u8981\u548c\u4e60\u60ef\uff0c\u62d6\u62fd\u5de5\u5177\u6761\u5230\u56db\u5468\u4efb\u610f\u4f4d\u7f6e\uff0c\u5f85\u5176\u81ea\u52a8\u505c\u9760\u540e\u91ca\u653e\u9f20\u6807\u3002 \u901a\u8fc7\u52fe\u9009/\u53d6\u6d88 Text Below Icon \u590d\u9009\u6846\u51b3\u5b9a\u662f\u5426\u663e\u793a\u6309\u94ae\u540d\u79f0\u3002 \u5728 Costomize->Options \u9762\u677f\u4e0b\u8bbe\u7f6e\u56fe\u6807\u7684\u5927\u5c0f\u3002","title":"\u5b9a\u5236\u5de5\u5177\u6761/\u83dc\u5355\u663e\u793a\u98ce\u683c"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_6","text":"\u5b8c\u6210\u4ee5\u4e0a\u8bbe\u7f6e\u540e\uff0c\u9700\u8981\u4fdd\u5b58\u8bbe\u7f6e\u4ee5\u4fbf\u4e0b\u6b21\u8c03\u7528\u3002\u53ef\u4ee5\u6709\u4e24\u4e2a\u65b9\u6cd5\uff1a \u65b0\u5efa\u7528\u6237\u89d2\u8272 \u5728\u8d44\u6e90\u6761\u89d2\u8272\u9762\u677f\u7a7a\u767d\u5904\u53f3\u51fb\uff0c\u9009\u62e9 New User Role \uff0c\u65b0\u5efa\u7528\u6237\u89d2\u8272\uff0c\u4f9d\u6b21\u586b\u5199\u7528\u6237\u89d2\u8272\u540d\u79f0\u3001\u663e\u793a\u56fe\u7247\u3001\u63cf\u8ff0\u8bf4\u660e\u7b49\uff0c\u6700\u7ec8\u5728\u7528\u6237\u89d2\u8272 User \u5206\u7ec4\u4e0b\u5373\u53ef\u67e5\u770b\u65b0\u5efa\u7684\u89d2\u8272\u3002\u5728\u4ee5\u540e\u7684\u5e94\u7528\u4e2d\uff0c\u53ea\u9700\u4ece\u8d44\u6e90\u6761\u89d2\u8272\u9762\u677f\u9009\u62e9\u8be5\u89d2\u8272\u56fe\u6807\uff0c\u5373\u53ef\u5bfc\u5165\u8be5\u89d2\u8272\u7684\u6240\u6709\u8bbe\u7f6e\u3002 \u4fdd\u5b58\u89d2\u8272\u6587\u4ef6 \u5c06\u7528\u6237\u81ea\u5b9a\u4e49 Costomize \u9762\u677f\u5207\u6362\u5230\u89d2\u8272 Roles \u9009\u9879\u5361\uff0c\u5355\u51fb Create \u521b\u5efa\u89d2\u8272\u914d\u7f6e .mtx \u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u8bb0\u5f55\u4e86\u4e4b\u524d\u5bf9\u5de5\u5177\u6761\u3001\u83dc\u5355\u7684\u6240\u6709\u8bbe\u7f6e\uff0c\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u914d\u7f6e\u65f6\uff0c\u70b9\u51fb Load \u9009\u62e9\u76f8\u5e94\u7684 .mtx \u89d2\u8272\u6587\u4ef6\u5373\u53ef\u3002","title":"\u521b\u5efa\u548c\u5e94\u7528\u89d2\u8272"},{"location":"2013-08-05-UG-NX-%E8%A7%92%E8%89%B2%E5%AE%9A%E5%88%B6%E4%B8%8E%E5%BA%94%E7%94%A8/#_7","text":"\u672c\u6587\u8be6\u7ec6\u4ecb\u7ecd\u4e86UG NX\u89d2\u8272\u7684\u5b9a\u5236\u548c\u5e94\u7528\u65b9\u6cd5\uff0c\u57fa\u672c\u6d41\u7a0b\u6982\u62ec\u4e3a\uff1a \u5728\u8d44\u6e90\u6761\u9009\u62e9\u6700\u63a5\u8fd1\u9700\u6c42\u7684\u89d2\u8272\uff0c\u4ee5\u5176\u4e3a\u57fa\u7840\u5f00\u59cb\u5b9a\u5236\uff1b \u5728\u6700\u5e38\u7528\u7684\u5e94\u7528\u6a21\u5757\u4e2d\u5b9a\u5236\u7cfb\u7edf\u5de5\u5177\u6761\u3001\u83dc\u5355\u6216\u65b0\u5efa\u81ea\u5b9a\u4e49\u5de5\u5177\u6761\uff0c\u8bbe\u7f6e\u5de5\u5177\u6761\u505c\u9760\u4f4d\u7f6e\u3001\u663e\u793a\u98ce\u683c\u7b49\uff1b \u5b8c\u6210\u8bbe\u7f6e\u540e\u521b\u5efa\u81ea\u5b9a\u4e49\u89d2\u8272\u6216\u8005\u76f4\u63a5\u5bfc\u51fa\u89d2\u8272\u6587\u4ef6\u4ee5\u4fbf\u4ee5\u540e\u52a0\u8f7d\u4f7f\u7528\u3002","title":"\u603b\u7ed3"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/","text":"ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3 \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-09-28 | \u5206\u7c7b\uff1a web development \u672c\u6587\u9488\u5bf9ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\u90e8\u5206\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u51e0\u4e2a\u95ee\u9898\uff0c\u7ecf\u8fc7\u67e5\u9605\u6587\u6863\u53ca\u601d\u8003\u7406\u89e3\uff0c\u4f5c\u4e86\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u7684\u603b\u7ed3\u8bb0\u5f55\uff1a \u81ea\u52a8\u9a8c\u8bc1\u7684\u5b9e\u65bd unique\u9a8c\u8bc1\u89c4\u5219\u7684\u95ee\u9898 \u9a8c\u8bc1\u4fe1\u606f\u7684Ajax\u8fd4\u56de \u81ea\u52a8\u9a8c\u8bc1\u7684\u5b9e\u65bd \u00b6 \u81ea\u52a8\u9a8c\u8bc1\u662f\u901a\u8fc7\u5bf9\u8868\u5355\u63d0\u4ea4\u7684\u6570\u636e\uff08\u53ef\u4ee5\u662f\u5bf9\u5e94\u6570\u636e\u5e93\u8868\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u662f\u8868\u4e2d\u5b57\u6bb5\uff09\u8bbe\u5b9a\u4e00\u4e9b\u9a8c\u8bc1\u89c4\u5219\uff0c\u5728 create() \u64cd\u4f5c\u65f6\u4f1a\u6839\u636e\u6b64\u89c4\u5219\u8fdb\u884c\u9a8c\u8bc1\u5e76\u7ed9\u51fa\u76f8\u5e94\u4fe1\u606f\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u8fdb\u884c\u624b\u52a8\u9a8c\u8bc1\u3002\u5b83\u5305\u542b\u4e24\u79cd\u65b9\u5f0f 1 2 \uff1a \u9759\u6001\u65b9\u5f0f\uff1a\u5728\u6a21\u578b\u7c7b\u91cc\u9762\u901a\u8fc7$_validate\u5c5e\u6027\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219\u3002 \u52a8\u6001\u65b9\u5f0f\uff1a\u4f7f\u7528\u6a21\u578b\u7c7b\u7684validate\u65b9\u6cd5\u52a8\u6001\u521b\u5efa\u81ea\u52a8\u9a8c\u8bc1\u89c4\u5219\u3002 \u4f7f\u7528\u683c\u5f0f\uff1a array( array(\u9a8c\u8bc1\u5b57\u6bb51,\u9a8c\u8bc1\u89c4\u5219,\u9519\u8bef\u63d0\u793a,[\u9a8c\u8bc1\u6761\u4ef6,\u9644\u52a0\u89c4\u5219,\u9a8c\u8bc1\u65f6\u95f4]), array(\u9a8c\u8bc1\u5b57\u6bb52,\u9a8c\u8bc1\u89c4\u5219,\u9519\u8bef\u63d0\u793a,[\u9a8c\u8bc1\u6761\u4ef6,\u9644\u52a0\u89c4\u5219,\u9a8c\u8bc1\u65f6\u95f4]), ....); unique\u81ea\u52a8\u9a8c\u8bc1\u89c4\u5219\u7684\u95ee\u9898 \u00b6 \u6839\u636e\u7b2c\u4e00\u90e8\u5206\u7684\u5b66\u4e60\uff0c\u5df2\u7ecf\u53ef\u4ee5\u5efa\u7acb\u5982\u4e0b\u89c4\u5219\uff0c\u8868\u793a\u5728\u63d2\u5165\u6570\u636e\u65f6\uff0c\u9a8c\u8bc1username\u662f\u5426\u552f\u4e00\u3002 array('username',' ','\u7528\u6237\u540d\u5df2\u7ecf\u5b58\u5728\uff01',0,'unique',1) \u7136\u800c\u5728\u5b66\u4e60\u521d\u671f\u53ef\u80fd\u9047\u5230\u5982\u4e0b\u95ee\u9898\u3002 \u4fee\u6539\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u63d0\u793a\u7528\u6237\u540d\u5df2\u7ecf\u5b58\u5728 \u00b6 \u8fd9\u663e\u7136\u662f\u9a8c\u8bc1\u65f6\u673a\u7684\u6df7\u6dc6\uff0c\u6211\u4eec\u6839\u636e\u4e0a\u4e0b\u6587\u5f88\u5bb9\u6613\u5224\u65ad\u9700\u8981\u8fdb\u884c\u7684\u662f\u7f16\u8f91\u66f4\u65b0\u64cd\u4f5c\uff0c\u53ef\u662f\u7a0b\u5e8f\u5982\u4f55\u5224\u65ad\uff1f \u7a0b\u5e8f\u662f\u6839\u636e \u4e3b\u952e\u503c\u662f\u5426\u5b58\u5728 \u6765\u5224\u5b9a\u6240\u8981\u8fdb\u884c\u7684\u64cd\u4f5c\u7684\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u63d2\u5165\u64cd\u4f5c\u6765\u8bf4\uff0c\u4e3b\u952e\u503c\u663e\u7136\u4e0d\u5b58\u5728\uff1b\u800c\u7f16\u8f91\u64cd\u4f5c\u65f6\uff0c\u4e3b\u952e\u5df2\u7ecf\u5728\u4e4b\u524d\u7684\u63d2\u5165\u64cd\u4f5c\u4e2d\u5b58\u5728\u4e86\u3002\u6240\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u5173\u952e\u5728\u4e8e\u8ba9\u7a0b\u5e8f\u77e5\u9053\u76ee\u524d\u64cd\u4f5c\u662f\u63d2\u5165\u8fd8\u662f\u7f16\u8f91\u3002\u65b9\u6cd5\u6709\u4e24\u4e2a\uff1a \u57fa\u672c\u65b9\u6cd5\uff1a\u6839\u636e\u4ee5\u4e0a\u57fa\u672c\u539f\u7406\uff0c\u7f16\u8f91\u64cd\u4f5c\u65f6\uff0c\u5728\u8868\u5355\u7684\u9690\u85cf\u57df\u4e2d\u7ed9\u51fa\u5f85\u7f16\u8f91\u7684\u8bb0\u5f55\u7684\u4e3b\u952e\u503c\uff0c\u8fd9\u6837\u7a0b\u5e8f\u901a\u8fc7\u641c\u7d22\u6570\u636e\u5e93\u5c31\u53ef\u4ee5\u77e5\u9053\u8fd9\u6761\u8bb0\u5f55\u5df2\u7ecf\u5b58\u5728\uff0c\u5373\u662f\u7f16\u8f91\u64cd\u4f5c\u3002 \u76f4\u63a5\u65b9\u6cd5\uff1a\u5728\u8c03\u7528 create() \u51fd\u6570\u65f6\u660e\u786e\u6307\u660e\u9a8c\u8bc1\u65f6\u673a\uff1a create($data,2) \u3002 \u63d2\u5165\u4fe1\u606f\u65f6\uff0cusername\u660e\u660e\u6ca1\u6709\u91cd\u590d\u800c\u63d0\u793a\u7528\u6237\u540d\u5df2\u7ecf\u5b58\u5728 \u00b6 \u8fd9\u4e2a\u95ee\u9898\u6839\u6e90\u5728\u4e8e\u6b64\u65f6\u6070\u597d\u5c06username\u8bbe\u4e3a\u4e3b\u952e\u4e86\u3002\u89e3\u51b3\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u91cd\u65b0\u8bbe\u8ba1\u4e3b\u952e\u5373\u53ef\uff0c\u4f8b\u5982\u4e00\u4e2a\u81ea\u52a8\u589e\u957f\u7684id\u3002\u5176\u5b9e\u8fd9\u4e2a\u5728ThinkPHP\u6587\u6863\u4e2d\u4e5f\u6709\u4e00\u70b9\u8bf4\u660e\uff1a ThinkPHP\u7684\u9ed8\u8ba4\u7ea6\u5b9a\u6bcf\u4e2a\u6570\u636e\u8868\u7684\u4e3b\u952e\u540d\u91c7\u7528\u7edf\u4e00\u7684id\u4f5c\u4e3a\u6807\u8bc6\uff0c\u5e76\u4e14\u662f\u81ea\u52a8\u589e\u957f\u7c7b\u578b\u7684\u3002\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8bc6\u522b\u5f53\u524d\u64cd\u4f5c\u7684\u6570\u636e\u8868\u7684\u5b57\u6bb5\u4fe1\u606f\u548c\u4e3b\u952e\u540d\u79f0\uff0c\u6240\u4ee5\u5373\u4f7f\u4f60\u7684\u4e3b\u952e\u4e0d\u662fid\uff0c\u4e5f\u65e0\u9700\u8fdb\u884c\u989d\u5916\u7684\u8bbe\u7f6e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8bc6\u522b 3 \u3002 \u4e8b\u5b9e\u4e0a\uff0c\u5047\u5982\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u4e0e\u6570\u636e\u8868\u5185\u5bb9\u6709\u76f4\u63a5\u5173\u7cfb\u7684\u4e3b\u952e\uff0c\u4f8b\u5982\u8fd9\u91cc\u7684username\uff0c\u90a3\u4e48\u5728\u5bf9username\u7684\u63d2\u5165\u64cd\u4f5c\u65f6\u5c31\u4f1a\u51fa\u73b0\u95ee\u98982\u2014\u2014username\u660e\u660e\u662f\u552f\u4e00\u7684\u5374\u63d0\u793a\u91cd\u590d\u4e86\u3002\u5f15\u8d77\u8fd9\u4e00\u5207\u7684\u6839\u6e90\u5728\u4e8eunique\u9a8c\u8bc1\u89c4\u5219\u672c\u8eab\u7684\u8bbe\u8ba1\uff0c\u53c2\u7167ThinkPHP\u5f00\u53d1\u5305 Core \u6587\u4ef6\u5939\u4e0b Model.class.php \u6587\u4ef6\u5173\u4e8e unique \u7684\u4ee3\u7801\uff1a case 'unique': // \u9a8c\u8bc1\u67d0\u4e2a\u503c\u662f\u5426\u552f\u4e00 if(is_string($val[0]) && strpos($val[0],',')) $val[0] = explode(',',$val[0]); $map = array(); if(is_array($val[0])) { // \u652f\u6301\u591a\u4e2a\u5b57\u6bb5\u9a8c\u8bc1 foreach ($val[0] as $field) $map[$field] = $data[$field]; }else{ $map[$val[0]] = $data[$val[0]]; } if(!empty($data[$this->getPk()])) { // \u5b8c\u5584\u7f16\u8f91\u7684\u65f6\u5019\u9a8c\u8bc1\u552f\u4e00 $map[$this->getPk()] = array('neq',$data[$this->getPk()]); } if($this->where($map)->find()) return false; return true; \u4ece\u8fd9\u91cc\u53ef\u4ee5\u770b\u51faunique\u7684\u903b\u8f91\u662f\uff0c\u67e5\u627e\u6570\u636e\u5e93\u4e2d\u6709\u6ca1\u6709\u4e0e\u9a8c\u8bc1\u6570\u636e\u91cd\u590d\u7684\u8bb0\u5f55\uff0c\u67e5\u8be2\u6761\u4ef6\u6709\u4e24\u4e2a\u5e76\u4e14\u662f and \u7684\u5173\u7cfb\uff1a \u89c4\u5219\u7ed9\u51fa\u7684\u5b57\u6bb5\u3001\u8868\u5355\u63d0\u4ea4\u7684\u6570\u636e $map[$val[0]] = $data[$val[0]] \u4e3b\u952e\u82e5\u5b58\u5728\uff0c\u5219\u8981\u6c42\u8868\u5355\u63d0\u4ea4\u7684\u5b57\u6bb5\u503c\u4e0e\u4e3b\u952e\u4e0d\u76f8\u7b49 $map[$this->getPk()] = array('neq',$data[$this->getPk()]) \u8fd9\u6837\u5c31\u53ef\u4ee5\u7406\u89e3\u4e0a\u9762\u4e24\u4e2a\u95ee\u9898\u4e86\uff1a \u95ee\u98981\u7684\u7b2c\u4e00\u4e2a\u89e3\u51b3\u65b9\u6cd5\u7684\u9053\u7406\u5728\u4e8e\uff0c\u8868\u5355\u9690\u85cf\u57df\u4e2d\u7ed9\u51fa\u4e86\u4e3b\u952e\u503c\uff0c\u5219\u67e5\u8be2\u6761\u4ef62\u4fdd\u8bc1\u4e86\u4e0d\u4f1a\u6709\u91cd\u590d\u8bb0\u5f55\u3002 \u5bf9\u4e8e\u95ee\u98982\uff0c\u82e5\u8981\u63d2\u5165\u7684username\u6070\u597d\u662f\u4e3b\u952e\uff0c\u5219\u67e5\u8be2\u6761\u4ef62\u8986\u76d6\u4e86\u6761\u4ef61\uff0c\u800c\u6b64\u65f6\u7684\u6761\u4ef6\u662f\u8868\u5355\u63d0\u4ea4\u7684\u4e3b\u952e\u503c\u5728\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\uff0c\u8fd9\u663e\u7136\u662f\u6ee1\u8db3\u7684\uff0c\u6240\u4ee5\u63d0\u793a\u91cd\u590d\u4e86\u3002 \u9a8c\u8bc1\u4fe1\u606f\u7684Ajax\u8fd4\u56de \u00b6 \u81ea\u52a8\u9a8c\u8bc1\u7ed3\u5408Ajax\u8fd4\u56de\u53ef\u4ee5\u65e0\u5237\u65b0\u7ed9\u51fa\u76f8\u5173\u4fe1\u606f\uff0cThinkPHP\u63d0\u4f9b\u4e86 ajaxReturn() \u51fd\u6570 4 $this->ajaxReturn(\u8fd4\u56de\u6570\u636e,\u63d0\u793a\u4fe1\u606f,\u64cd\u4f5c\u72b6\u6001) \u4e0b\u9762\u901a\u8fc7 create() \u51fd\u6570\u81ea\u52a8\u9a8c\u8bc1\u5e76\u5c06 getError() \u5f97\u5230\u9519\u8bef\u4fe1\u606f\u901a\u8fc7 ajaxReturn() \u8fd4\u56de\u3002\u9519\u8bef\u4fe1\u606f\u4e3a\u6570\u7ec4\u5f62\u5f0f\uff0c\u952e\u4e3a\u9a8c\u8bc1\u5b57\u6bb5\uff0c\u503c\u4e3a\u76f8\u5e94\u7684\u9a8c\u8bc1\u4fe1\u606f\u3002 if (!$m->create()){ // \u5982\u679c\u521b\u5efa\u5931\u8d25 \u8868\u793a\u9a8c\u8bc1\u6ca1\u6709\u901a\u8fc7 \u8f93\u51fa\u9519\u8bef\u63d0\u793a\u4fe1\u606f $this->ajaxReturn('',$m->getError(),0); } \u524d\u7aefAjax\u8bf7\u6c42\u53ca\u83b7\u53d6\u6570\u636e\u7684Jquery\u4ee3\u7801\uff1a $(document).ready(function(){ $(\"input[type='button']\").click(function(){ $.post(\"adduser\",$('form').serialize(),function(data){ // $('form').serialize()\u63d0\u4ea4\u8868\u5355\u6570\u636e var json = eval('('+data+')'); // \u5f97\u5230Json\u5bf9\u8c61 // \u8f93\u5165\u4e0d\u5408\u6cd5 if(json.status == 0){ // to do } // \u5199\u5165\u6570\u636e\u5e93\u9519\u8bef else if(json.status == 1){ // to do } // \u6210\u529f\u65b0\u5efa else if(json.status == 2){ // to do } }); }); }) 6.15 \u81ea\u52a8\u9a8c\u8bc1 \u21a9 ThinkPHP3.1\u5feb\u901f\u5165\u95e8\uff0812\uff09\u81ea\u52a8\u9a8c\u8bc1 \u21a9 ThinkPHP\u5b8c\u5168\u5f00\u53d1\u624b\u518c-6.4-\u6570\u636e\u4e3b\u952e \u21a9 ThinkPHP\u5b8c\u5168\u5f00\u53d1\u624b\u518c-5.19-AJAX\u8fd4\u56de \u21a9","title":"ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/#thinkphpunique","text":"\u53d1\u5e03\u4e8e\uff1a2013-09-28 | \u5206\u7c7b\uff1a web development \u672c\u6587\u9488\u5bf9ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\u90e8\u5206\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u51e0\u4e2a\u95ee\u9898\uff0c\u7ecf\u8fc7\u67e5\u9605\u6587\u6863\u53ca\u601d\u8003\u7406\u89e3\uff0c\u4f5c\u4e86\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u7684\u603b\u7ed3\u8bb0\u5f55\uff1a \u81ea\u52a8\u9a8c\u8bc1\u7684\u5b9e\u65bd unique\u9a8c\u8bc1\u89c4\u5219\u7684\u95ee\u9898 \u9a8c\u8bc1\u4fe1\u606f\u7684Ajax\u8fd4\u56de","title":"ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/#_1","text":"\u81ea\u52a8\u9a8c\u8bc1\u662f\u901a\u8fc7\u5bf9\u8868\u5355\u63d0\u4ea4\u7684\u6570\u636e\uff08\u53ef\u4ee5\u662f\u5bf9\u5e94\u6570\u636e\u5e93\u8868\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u662f\u8868\u4e2d\u5b57\u6bb5\uff09\u8bbe\u5b9a\u4e00\u4e9b\u9a8c\u8bc1\u89c4\u5219\uff0c\u5728 create() \u64cd\u4f5c\u65f6\u4f1a\u6839\u636e\u6b64\u89c4\u5219\u8fdb\u884c\u9a8c\u8bc1\u5e76\u7ed9\u51fa\u76f8\u5e94\u4fe1\u606f\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u8fdb\u884c\u624b\u52a8\u9a8c\u8bc1\u3002\u5b83\u5305\u542b\u4e24\u79cd\u65b9\u5f0f 1 2 \uff1a \u9759\u6001\u65b9\u5f0f\uff1a\u5728\u6a21\u578b\u7c7b\u91cc\u9762\u901a\u8fc7$_validate\u5c5e\u6027\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219\u3002 \u52a8\u6001\u65b9\u5f0f\uff1a\u4f7f\u7528\u6a21\u578b\u7c7b\u7684validate\u65b9\u6cd5\u52a8\u6001\u521b\u5efa\u81ea\u52a8\u9a8c\u8bc1\u89c4\u5219\u3002 \u4f7f\u7528\u683c\u5f0f\uff1a array( array(\u9a8c\u8bc1\u5b57\u6bb51,\u9a8c\u8bc1\u89c4\u5219,\u9519\u8bef\u63d0\u793a,[\u9a8c\u8bc1\u6761\u4ef6,\u9644\u52a0\u89c4\u5219,\u9a8c\u8bc1\u65f6\u95f4]), array(\u9a8c\u8bc1\u5b57\u6bb52,\u9a8c\u8bc1\u89c4\u5219,\u9519\u8bef\u63d0\u793a,[\u9a8c\u8bc1\u6761\u4ef6,\u9644\u52a0\u89c4\u5219,\u9a8c\u8bc1\u65f6\u95f4]), ....);","title":"\u81ea\u52a8\u9a8c\u8bc1\u7684\u5b9e\u65bd"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/#unique","text":"\u6839\u636e\u7b2c\u4e00\u90e8\u5206\u7684\u5b66\u4e60\uff0c\u5df2\u7ecf\u53ef\u4ee5\u5efa\u7acb\u5982\u4e0b\u89c4\u5219\uff0c\u8868\u793a\u5728\u63d2\u5165\u6570\u636e\u65f6\uff0c\u9a8c\u8bc1username\u662f\u5426\u552f\u4e00\u3002 array('username',' ','\u7528\u6237\u540d\u5df2\u7ecf\u5b58\u5728\uff01',0,'unique',1) \u7136\u800c\u5728\u5b66\u4e60\u521d\u671f\u53ef\u80fd\u9047\u5230\u5982\u4e0b\u95ee\u9898\u3002","title":"unique\u81ea\u52a8\u9a8c\u8bc1\u89c4\u5219\u7684\u95ee\u9898"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/#_2","text":"\u8fd9\u663e\u7136\u662f\u9a8c\u8bc1\u65f6\u673a\u7684\u6df7\u6dc6\uff0c\u6211\u4eec\u6839\u636e\u4e0a\u4e0b\u6587\u5f88\u5bb9\u6613\u5224\u65ad\u9700\u8981\u8fdb\u884c\u7684\u662f\u7f16\u8f91\u66f4\u65b0\u64cd\u4f5c\uff0c\u53ef\u662f\u7a0b\u5e8f\u5982\u4f55\u5224\u65ad\uff1f \u7a0b\u5e8f\u662f\u6839\u636e \u4e3b\u952e\u503c\u662f\u5426\u5b58\u5728 \u6765\u5224\u5b9a\u6240\u8981\u8fdb\u884c\u7684\u64cd\u4f5c\u7684\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u63d2\u5165\u64cd\u4f5c\u6765\u8bf4\uff0c\u4e3b\u952e\u503c\u663e\u7136\u4e0d\u5b58\u5728\uff1b\u800c\u7f16\u8f91\u64cd\u4f5c\u65f6\uff0c\u4e3b\u952e\u5df2\u7ecf\u5728\u4e4b\u524d\u7684\u63d2\u5165\u64cd\u4f5c\u4e2d\u5b58\u5728\u4e86\u3002\u6240\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u5173\u952e\u5728\u4e8e\u8ba9\u7a0b\u5e8f\u77e5\u9053\u76ee\u524d\u64cd\u4f5c\u662f\u63d2\u5165\u8fd8\u662f\u7f16\u8f91\u3002\u65b9\u6cd5\u6709\u4e24\u4e2a\uff1a \u57fa\u672c\u65b9\u6cd5\uff1a\u6839\u636e\u4ee5\u4e0a\u57fa\u672c\u539f\u7406\uff0c\u7f16\u8f91\u64cd\u4f5c\u65f6\uff0c\u5728\u8868\u5355\u7684\u9690\u85cf\u57df\u4e2d\u7ed9\u51fa\u5f85\u7f16\u8f91\u7684\u8bb0\u5f55\u7684\u4e3b\u952e\u503c\uff0c\u8fd9\u6837\u7a0b\u5e8f\u901a\u8fc7\u641c\u7d22\u6570\u636e\u5e93\u5c31\u53ef\u4ee5\u77e5\u9053\u8fd9\u6761\u8bb0\u5f55\u5df2\u7ecf\u5b58\u5728\uff0c\u5373\u662f\u7f16\u8f91\u64cd\u4f5c\u3002 \u76f4\u63a5\u65b9\u6cd5\uff1a\u5728\u8c03\u7528 create() \u51fd\u6570\u65f6\u660e\u786e\u6307\u660e\u9a8c\u8bc1\u65f6\u673a\uff1a create($data,2) \u3002","title":"\u4fee\u6539\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u63d0\u793a\u7528\u6237\u540d\u5df2\u7ecf\u5b58\u5728"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/#username","text":"\u8fd9\u4e2a\u95ee\u9898\u6839\u6e90\u5728\u4e8e\u6b64\u65f6\u6070\u597d\u5c06username\u8bbe\u4e3a\u4e3b\u952e\u4e86\u3002\u89e3\u51b3\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u91cd\u65b0\u8bbe\u8ba1\u4e3b\u952e\u5373\u53ef\uff0c\u4f8b\u5982\u4e00\u4e2a\u81ea\u52a8\u589e\u957f\u7684id\u3002\u5176\u5b9e\u8fd9\u4e2a\u5728ThinkPHP\u6587\u6863\u4e2d\u4e5f\u6709\u4e00\u70b9\u8bf4\u660e\uff1a ThinkPHP\u7684\u9ed8\u8ba4\u7ea6\u5b9a\u6bcf\u4e2a\u6570\u636e\u8868\u7684\u4e3b\u952e\u540d\u91c7\u7528\u7edf\u4e00\u7684id\u4f5c\u4e3a\u6807\u8bc6\uff0c\u5e76\u4e14\u662f\u81ea\u52a8\u589e\u957f\u7c7b\u578b\u7684\u3002\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8bc6\u522b\u5f53\u524d\u64cd\u4f5c\u7684\u6570\u636e\u8868\u7684\u5b57\u6bb5\u4fe1\u606f\u548c\u4e3b\u952e\u540d\u79f0\uff0c\u6240\u4ee5\u5373\u4f7f\u4f60\u7684\u4e3b\u952e\u4e0d\u662fid\uff0c\u4e5f\u65e0\u9700\u8fdb\u884c\u989d\u5916\u7684\u8bbe\u7f6e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8bc6\u522b 3 \u3002 \u4e8b\u5b9e\u4e0a\uff0c\u5047\u5982\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u4e0e\u6570\u636e\u8868\u5185\u5bb9\u6709\u76f4\u63a5\u5173\u7cfb\u7684\u4e3b\u952e\uff0c\u4f8b\u5982\u8fd9\u91cc\u7684username\uff0c\u90a3\u4e48\u5728\u5bf9username\u7684\u63d2\u5165\u64cd\u4f5c\u65f6\u5c31\u4f1a\u51fa\u73b0\u95ee\u98982\u2014\u2014username\u660e\u660e\u662f\u552f\u4e00\u7684\u5374\u63d0\u793a\u91cd\u590d\u4e86\u3002\u5f15\u8d77\u8fd9\u4e00\u5207\u7684\u6839\u6e90\u5728\u4e8eunique\u9a8c\u8bc1\u89c4\u5219\u672c\u8eab\u7684\u8bbe\u8ba1\uff0c\u53c2\u7167ThinkPHP\u5f00\u53d1\u5305 Core \u6587\u4ef6\u5939\u4e0b Model.class.php \u6587\u4ef6\u5173\u4e8e unique \u7684\u4ee3\u7801\uff1a case 'unique': // \u9a8c\u8bc1\u67d0\u4e2a\u503c\u662f\u5426\u552f\u4e00 if(is_string($val[0]) && strpos($val[0],',')) $val[0] = explode(',',$val[0]); $map = array(); if(is_array($val[0])) { // \u652f\u6301\u591a\u4e2a\u5b57\u6bb5\u9a8c\u8bc1 foreach ($val[0] as $field) $map[$field] = $data[$field]; }else{ $map[$val[0]] = $data[$val[0]]; } if(!empty($data[$this->getPk()])) { // \u5b8c\u5584\u7f16\u8f91\u7684\u65f6\u5019\u9a8c\u8bc1\u552f\u4e00 $map[$this->getPk()] = array('neq',$data[$this->getPk()]); } if($this->where($map)->find()) return false; return true; \u4ece\u8fd9\u91cc\u53ef\u4ee5\u770b\u51faunique\u7684\u903b\u8f91\u662f\uff0c\u67e5\u627e\u6570\u636e\u5e93\u4e2d\u6709\u6ca1\u6709\u4e0e\u9a8c\u8bc1\u6570\u636e\u91cd\u590d\u7684\u8bb0\u5f55\uff0c\u67e5\u8be2\u6761\u4ef6\u6709\u4e24\u4e2a\u5e76\u4e14\u662f and \u7684\u5173\u7cfb\uff1a \u89c4\u5219\u7ed9\u51fa\u7684\u5b57\u6bb5\u3001\u8868\u5355\u63d0\u4ea4\u7684\u6570\u636e $map[$val[0]] = $data[$val[0]] \u4e3b\u952e\u82e5\u5b58\u5728\uff0c\u5219\u8981\u6c42\u8868\u5355\u63d0\u4ea4\u7684\u5b57\u6bb5\u503c\u4e0e\u4e3b\u952e\u4e0d\u76f8\u7b49 $map[$this->getPk()] = array('neq',$data[$this->getPk()]) \u8fd9\u6837\u5c31\u53ef\u4ee5\u7406\u89e3\u4e0a\u9762\u4e24\u4e2a\u95ee\u9898\u4e86\uff1a \u95ee\u98981\u7684\u7b2c\u4e00\u4e2a\u89e3\u51b3\u65b9\u6cd5\u7684\u9053\u7406\u5728\u4e8e\uff0c\u8868\u5355\u9690\u85cf\u57df\u4e2d\u7ed9\u51fa\u4e86\u4e3b\u952e\u503c\uff0c\u5219\u67e5\u8be2\u6761\u4ef62\u4fdd\u8bc1\u4e86\u4e0d\u4f1a\u6709\u91cd\u590d\u8bb0\u5f55\u3002 \u5bf9\u4e8e\u95ee\u98982\uff0c\u82e5\u8981\u63d2\u5165\u7684username\u6070\u597d\u662f\u4e3b\u952e\uff0c\u5219\u67e5\u8be2\u6761\u4ef62\u8986\u76d6\u4e86\u6761\u4ef61\uff0c\u800c\u6b64\u65f6\u7684\u6761\u4ef6\u662f\u8868\u5355\u63d0\u4ea4\u7684\u4e3b\u952e\u503c\u5728\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\uff0c\u8fd9\u663e\u7136\u662f\u6ee1\u8db3\u7684\uff0c\u6240\u4ee5\u63d0\u793a\u91cd\u590d\u4e86\u3002","title":"\u63d2\u5165\u4fe1\u606f\u65f6\uff0cusername\u660e\u660e\u6ca1\u6709\u91cd\u590d\u800c\u63d0\u793a\u7528\u6237\u540d\u5df2\u7ecf\u5b58\u5728"},{"location":"2013-09-28-ThinkPHP%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81%EF%BC%9Aunique%E8%A7%84%E5%88%99%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E7%90%86%E8%A7%A3/#ajax","text":"\u81ea\u52a8\u9a8c\u8bc1\u7ed3\u5408Ajax\u8fd4\u56de\u53ef\u4ee5\u65e0\u5237\u65b0\u7ed9\u51fa\u76f8\u5173\u4fe1\u606f\uff0cThinkPHP\u63d0\u4f9b\u4e86 ajaxReturn() \u51fd\u6570 4 $this->ajaxReturn(\u8fd4\u56de\u6570\u636e,\u63d0\u793a\u4fe1\u606f,\u64cd\u4f5c\u72b6\u6001) \u4e0b\u9762\u901a\u8fc7 create() \u51fd\u6570\u81ea\u52a8\u9a8c\u8bc1\u5e76\u5c06 getError() \u5f97\u5230\u9519\u8bef\u4fe1\u606f\u901a\u8fc7 ajaxReturn() \u8fd4\u56de\u3002\u9519\u8bef\u4fe1\u606f\u4e3a\u6570\u7ec4\u5f62\u5f0f\uff0c\u952e\u4e3a\u9a8c\u8bc1\u5b57\u6bb5\uff0c\u503c\u4e3a\u76f8\u5e94\u7684\u9a8c\u8bc1\u4fe1\u606f\u3002 if (!$m->create()){ // \u5982\u679c\u521b\u5efa\u5931\u8d25 \u8868\u793a\u9a8c\u8bc1\u6ca1\u6709\u901a\u8fc7 \u8f93\u51fa\u9519\u8bef\u63d0\u793a\u4fe1\u606f $this->ajaxReturn('',$m->getError(),0); } \u524d\u7aefAjax\u8bf7\u6c42\u53ca\u83b7\u53d6\u6570\u636e\u7684Jquery\u4ee3\u7801\uff1a $(document).ready(function(){ $(\"input[type='button']\").click(function(){ $.post(\"adduser\",$('form').serialize(),function(data){ // $('form').serialize()\u63d0\u4ea4\u8868\u5355\u6570\u636e var json = eval('('+data+')'); // \u5f97\u5230Json\u5bf9\u8c61 // \u8f93\u5165\u4e0d\u5408\u6cd5 if(json.status == 0){ // to do } // \u5199\u5165\u6570\u636e\u5e93\u9519\u8bef else if(json.status == 1){ // to do } // \u6210\u529f\u65b0\u5efa else if(json.status == 2){ // to do } }); }); }) 6.15 \u81ea\u52a8\u9a8c\u8bc1 \u21a9 ThinkPHP3.1\u5feb\u901f\u5165\u95e8\uff0812\uff09\u81ea\u52a8\u9a8c\u8bc1 \u21a9 ThinkPHP\u5b8c\u5168\u5f00\u53d1\u624b\u518c-6.4-\u6570\u636e\u4e3b\u952e \u21a9 ThinkPHP\u5b8c\u5168\u5f00\u53d1\u624b\u518c-5.19-AJAX\u8fd4\u56de \u21a9","title":"\u9a8c\u8bc1\u4fe1\u606f\u7684Ajax\u8fd4\u56de"},{"location":"2013-10-19-ThinkPHP%E6%A1%86%E6%9E%B6%E4%B8%8BMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E7%B1%BB/","text":"ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-10-19 | \u5206\u7c7b\uff1a web development \u6700\u8fd1\u5728\u7528ThinkPHP\u6846\u67b6\u5199\u4e00\u4e2a\u5b9e\u9a8c\u9884\u7ea6\u7f51\u7ad9\uff0c\u5230\u4e86\u6570\u636e\u5e93\u5907\u4efd\u4e0e\u8fd8\u539f\u4e00\u6b65\uff0c\u5728\u7f51\u4e0a\u627e\u4e86\u4e00\u4e2a\u73b0\u6210\u7684 MySQLReback \u7c7b\uff0c\u4ee5.sql\u6587\u4ef6\u65b9\u5f0f\u5907\u4efd\u548c\u8fd8\u539f\u6570\u636e\u5e93\u3002\u672c\u6587\u8bb0\u5f55\u4f7f\u7528\u8fc7\u7a0b\u4ee5\u4f5c\u5907\u5fd8\u3002 \u5907\u4efd\u8fd8\u539f\u9875\u9762\u603b\u4f53\u601d\u8def\u4e3a\uff1a \u8be5\u6a21\u5757\u7684 bacover() \u65b9\u6cd5\u8bfb\u53d6\u5907\u4efd\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u5217\u8868\u663e\u793a\u5728\u9759\u6001\u9875\u9762\uff0c\u5907\u4efd/\u8fd8\u539f/\u5220\u9664\u6587\u4ef6\u7b49\u64cd\u4f5c\u5219\u5f02\u6b65\u63d0\u4ea4\u7ed9\u540c\u6a21\u5757\u7684 dobacover() \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f7f\u7528 MySQLReback \u7c7b\u7684\u65b9\u6cd5\u5b8c\u6210\u6570\u636e\u5e93\u7684\u76f8\u5e94\u64cd\u4f5c\u3002 MySQLReback\u7c7b\u6587\u4ef6 \u00b6 \u8be5\u6587\u4ef6\u5305\u542b\u5907\u4efd\u8fd8\u539f\u6570\u636e\u5e93\u7684\u65b9\u6cd5 backup() \u548c recover($fileName) \uff0c\u7531\u4e8e\u9700\u8981\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u7c7b\u521d\u59cb\u5316\u9700\u8981\u4f20\u5165\u8fde\u63a5\u6570\u636e\u5e93\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u4ece\u914d\u7f6e\u6587\u4ef6\u6216\u7528\u6237\u8f93\u5165\u83b7\u53d6\u3002 \u7c7b\u6587\u4ef6\u5b58\u653e\u4f4d\u7f6e\u6ca1\u6709\u8981\u6c42\uff0c\u53ea\u8981\u80fd\u6b63\u786e\u5f15\u5165\u5373\u53ef\u3002\u6211\u5c06\u5176\u653e\u5728ThinkPHP\u6838\u5fc3\u6587\u4ef6\u5939 ORG \u76ee\u5f55\u4e0b\u65b0\u5efa\u7684 Backup \u6587\u4ef6\u5939\u4e0b\uff0c\u8fd9\u6837\u5f15\u7528\u76ee\u5f55\u5373\u4e3a\uff1a import(\"ORG.Backup.MySQLReback\"); \u663e\u793a\u9759\u6001\u9875\u9762\u548c\u76f8\u5e94\u64cd\u4f5c\u7684\u65b9\u6cd5 \u00b6 \u4ee5\u4e0b\u662f Other \u6a21\u5757\u4e0b\u7684\u4e24\u4e2a\u65b9\u6cd5 bacover() \uff1a\u67e5\u627e\u5907\u4efd\u76ee\u5f55\uff0c\u8bfb\u53d6\u6587\u4ef6\u4ee5\u4f9b\u524d\u53f0\u663e\u793a /* ** \u5907\u4efd\u8fd8\u539f\u6570\u636e\u9759\u6001\u9875\u9762 */ public function bacover(){ $DataDir = \"./Public/backup/\"; // \u8bbe\u7f6e\u670d\u52a1\u5668\u4e0a\u7684\u5907\u4efd\u76ee\u5f55 // \u67e5\u627e\u76ee\u5f55\u4e0b\u6587\u4ef6\u3001 $FilePath = opendir($DataDir); while (false !== ($filename = readdir($FilePath))) { $FileAndFolderAyy[] = $filename; } sort($FileAndFolderAyy); // \u9006\u5e8f\u6392\u5217 rsort($FileAndFolderAyy); foreach ($FileAndFolderAyy as $i => $n){ if($i>1){ // 0,1\u5206\u522b\u4e3a\u5f53\u524d\u53ca\u4e0a\u7ea7\u76ee\u5f55\uff0c2\u624d\u662f\u5f53\u524d\u6587\u4ef6\u5f00\u59cb $list[$i-2]['FileName'] = $n; $list[$i-2]['FileTime'] = date('Y-m-d H:i:s',filemtime($DataDir.$n)); $FileSize = filesize($DataDir.$n)/1024; if ($FileSize < 1024){ $list[$i-2]['FileSize'] = number_format($FileSize,2).' KB'; } else { $list[$i-2]['FileSize'] = number_format($FileSize/1024,2).' MB'; } } } $this->assign('list',$list); $this->display(); } dobacover() \uff1a\u8bfb\u53d6\u524d\u53f0\u4fe1\u606f\uff0c\u8c03\u7528 MySQLReback() \u65b9\u6cd5\u5b8c\u6210\u64cd\u4f5c /* ** \u5907\u4efd\u8fd8\u539f\u6570\u636e\u64cd\u4f5c */ public function dobacover(){ $DataDir = \"./Public/backup/\"; // \u8bbe\u7f6e\u670d\u52a1\u5668\u4e0a\u7684\u5907\u4efd\u76ee\u5f55 $action = I(\"action\"); $file = I(\"file\"); if (!empty($action)) { import(\"ORG.Backup.MySQLReback\"); // \u7b2c\u4e09\u65b9\u5907\u4efd\u8fd8\u539f\u7c7b // \u4ece\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\uff0c\u9ed8\u8ba4\u8981\u6c42\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f0f\u5206\u9879\u914d\u7f6e\u7684\uff0c\u800c\u4e0d\u662f'DB_DSN' $config = array( 'host' => C('DB_HOST'), 'port' => C('DB_PORT'), 'userName' => C('DB_USER'), 'userPassword' => C('DB_PWD'), 'dbprefix' => C('DB_PREFIX'), 'charset' => 'UTF8', 'path' => $DataDir, 'isCompress' => 0, //\u662f\u5426\u5f00\u542fgzip\u538b\u7f29 'isDownload' => 0 ); $mr = new MySQLReback($config); $mr->setDBName(C('DB_NAME')); if ($action == 'backup') { $mr->backup(); $this->ajaxReturn('','\u5907\u4efd\u6570\u636e\u5e93\u6210\u529f\uff01',2); } elseif ($action == 'recover') { $mr->recover($file); $this->ajaxReturn('','\u8fd8\u539f\u6570\u636e\u5e93\u6210\u529f\uff01',2); } elseif ($action == 'delete') { if (@unlink($DataDir . $file)) { $this->ajaxReturn('','\u5220\u9664\u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u6210\u529f\uff01',2); } else { $this->ajaxReturn('','\u5220\u9664\u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u5931\u8d25\uff01',1); } } if($action == 'download') { $fileName = $DataDir . $file; ob_end_clean(); header(\"Cache-Control: must-revalidate, post-check=0,pre-check=0\"); header('Content-Description: File Transfer'); header('Content-Type: application/octet-stream'); header('Content-Length: ' . filesize($fileName)); header('Content-Disposition: attachment; filename=' . basename($fileName)); readfile($fileName); exit(); } } } \u524d\u53f0\u89c6\u56fe \u00b6 \u4e00\u4e2atable\u663e\u793a\u540e\u53f0 bacover() \u4f20\u8f93\u7684\u5907\u4efd\u6587\u4ef6\u6570\u636e\uff0c\u7528Jquery\u7684ajax\u63d0\u4ea4\u8bf7\u6c42\uff0c ajax_submit_action() \u662f\u81ea\u5b9a\u4e49\u7684\u63d0\u4ea4\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u7565\u53bb\u3002 \u4e3b\u8981\u601d\u8def\uff1a\u901a\u8fc7\u8bbe\u7f6e\u4e0d\u540c\u64cd\u4f5c\u7684\u6309\u94ae\u7684\u7c7b\u540d\u6765\u533a\u5206\u4e0d\u540c\u7684\u4e1a\u52a1\uff1b\u53e6\u5916\uff0c\u7531\u4e8e\u4e0b\u8f7d\u6587\u4ef6\u64cd\u4f5c\u901a\u8fc7ajax\u65b9\u6cd5\u5b8c\u6210\uff0c\u76f4\u63a5\u63d0\u4ea4\u5230 dobacover() \u65b9\u6cd5\u5373\u53ef\u3002 <script> $(document).ready(function() { $(\":button\").click(function(){ var action = $(this).attr('class'); var id = $(this).attr('id'); var content_obj = {'action':action,'file':id}; var url = \"<{:U('Other/dobacover')}>\"; switch(action){ case 'recover': if(confirm(\"\u786e\u5b9a\u8fd8\u539f\u6570\u636e\u5e93\uff1f\")) ajax_submit_action(url,content_obj,0,1); break; case 'delete': if(confirm(\"\u786e\u5b9a\u5220\u9664\u8be5\u5907\u4efd\u6587\u4ef6\uff1f\")) ajax_submit_action(url,content_obj,0,1); break; case 'download': // \u4e0b\u8f7d\u6587\u4ef6\u4e0d\u80fd\u5f02\u6b65\u63d0\u4ea4 window.location.href = url + \"?action=\" +action +\"&file=\" + id; break; default: ajax_submit_action(url,content_obj,0,1); } }); }); </script> <table> <thead> <tr> <th width=\"7%\">\u5e8f\u53f7</th> <th width=\"35%\">\u6587\u4ef6\u540d</th> <th width=\"20%\">\u5907\u4efd\u65f6\u95f4</th> <th width=\"10%\">\u6587\u4ef6\u5927\u5c0f</th> <th width=\"28%\">\u7ba1\u7406\u9009\u9879</th> </tr> </thead> <tbody> <tr> <td><{$i}></td> <td><{$vo.FileName}></td> <td><{$vo.FileTime}></td> <td><{$vo.FileSize}></td> <td> <input id=\"<{$vo.FileName}>\" class=\"recover\" type=\"button\" value=\"\u8fd8\u539f\" /> <input id=\"<{$vo.FileName}>\" class=\"download\" type=\"button\" value=\"\u4e0b\u8f7d\" /> <input id=\"<{$vo.FileName}>\" class=\"delete\" type=\"button\" value=\"\u5220\u9664\" /> </td> </tr> <tr> <td colspan=\"5\" align=\"center\"> <input id=\"none\" class=\"backup\" type=\"button\" value=\"\u5907\u4efd\u6570\u636e\u5e93\" /> </td> </tr> </tbody> </table> \u6ce8\u610f \u6570\u636e\u5e93\u8868\u4e2d\u67d0\u4e9b\u5141\u8bb8\u4e3a\u7a7a\u7684\u5b57\u6bb5\uff0c\u5907\u4efd\u5bfc\u51fa\u65f6\u5b57\u6bb5\u4e3a '' \uff0c\u5728\u8fd8\u539f\u6570\u636e\u5e93\u65f6\u4f1a\u63d0\u793a\u5982\u4e0b\u9519\u8bef\uff1a MySQL Error : Incorrect date value: '' for column '\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7' at row 1 \u8fd9\u79cd\u95ee\u9898\u4e00\u822c\u51fa\u73b0\u5728 mysql 5.x \u4ee5\u4e0a\u7248\u672c\uff0c\u56e0\u4e3a\u8981\u6c42\u7a7a\u503c\u5199\u4e3a NULL \u3002\u53ef\u4ee5\u5728\u5b89\u88c5mysql\u7684\u65f6\u5019\u53bb\u9664\u9ed8\u8ba4\u52fe\u9009\u7684 enable strict SQL mode \uff0c\u5df2\u7ecf\u5b89\u88c5\u5219\u9700\u8981\u4fee\u6539mysql\u7684\u914d\u7f6e\u6587\u4ef6 my.ini \u3002\u5728 my.ini \u4e2d\u67e5\u627e sql-mode \uff0c\u5c06\u9ed8\u8ba4\u7684 sql-mode=\"STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\" \u4fee\u6539\u4e3a sql-mode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\" \u7136\u540e\u91cd\u65b0\u542f\u52a8Mysql\u670d\u52a1\u3002 \u672c\u6587\u4e0a\u8ff0\u4ee3\u7801\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u5f00\u53d1\u73af\u5883\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u4e91\u8ba1\u7b97\u5e73\u53f0\uff0c\u7531\u4e8e\u6ca1\u6709\u672c\u5730\u6587\u4ef6\u8bfb\u5199\u7684\u6743\u9650\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5404\u81ea\u63d0\u4f9b\u7684API\u6765\u4fee\u6b63\u6587\u4ef6\u64cd\u4f5c\u3002\u540e\u7eed\u5c06\u4ee5\u65b0\u6d6a\u4e91\u8ba1\u7b97\u5e73\u53f0SAE\u4e3a\u4f8b\uff0c\u7ed9\u51fa\u4fee\u6539\u65b9\u6848\u3002","title":"ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b"},{"location":"2013-10-19-ThinkPHP%E6%A1%86%E6%9E%B6%E4%B8%8BMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E7%B1%BB/#thinkphpmysql","text":"\u53d1\u5e03\u4e8e\uff1a2013-10-19 | \u5206\u7c7b\uff1a web development \u6700\u8fd1\u5728\u7528ThinkPHP\u6846\u67b6\u5199\u4e00\u4e2a\u5b9e\u9a8c\u9884\u7ea6\u7f51\u7ad9\uff0c\u5230\u4e86\u6570\u636e\u5e93\u5907\u4efd\u4e0e\u8fd8\u539f\u4e00\u6b65\uff0c\u5728\u7f51\u4e0a\u627e\u4e86\u4e00\u4e2a\u73b0\u6210\u7684 MySQLReback \u7c7b\uff0c\u4ee5.sql\u6587\u4ef6\u65b9\u5f0f\u5907\u4efd\u548c\u8fd8\u539f\u6570\u636e\u5e93\u3002\u672c\u6587\u8bb0\u5f55\u4f7f\u7528\u8fc7\u7a0b\u4ee5\u4f5c\u5907\u5fd8\u3002 \u5907\u4efd\u8fd8\u539f\u9875\u9762\u603b\u4f53\u601d\u8def\u4e3a\uff1a \u8be5\u6a21\u5757\u7684 bacover() \u65b9\u6cd5\u8bfb\u53d6\u5907\u4efd\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u5217\u8868\u663e\u793a\u5728\u9759\u6001\u9875\u9762\uff0c\u5907\u4efd/\u8fd8\u539f/\u5220\u9664\u6587\u4ef6\u7b49\u64cd\u4f5c\u5219\u5f02\u6b65\u63d0\u4ea4\u7ed9\u540c\u6a21\u5757\u7684 dobacover() \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f7f\u7528 MySQLReback \u7c7b\u7684\u65b9\u6cd5\u5b8c\u6210\u6570\u636e\u5e93\u7684\u76f8\u5e94\u64cd\u4f5c\u3002","title":"ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b"},{"location":"2013-10-19-ThinkPHP%E6%A1%86%E6%9E%B6%E4%B8%8BMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E7%B1%BB/#mysqlreback","text":"\u8be5\u6587\u4ef6\u5305\u542b\u5907\u4efd\u8fd8\u539f\u6570\u636e\u5e93\u7684\u65b9\u6cd5 backup() \u548c recover($fileName) \uff0c\u7531\u4e8e\u9700\u8981\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u7c7b\u521d\u59cb\u5316\u9700\u8981\u4f20\u5165\u8fde\u63a5\u6570\u636e\u5e93\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u4ece\u914d\u7f6e\u6587\u4ef6\u6216\u7528\u6237\u8f93\u5165\u83b7\u53d6\u3002 \u7c7b\u6587\u4ef6\u5b58\u653e\u4f4d\u7f6e\u6ca1\u6709\u8981\u6c42\uff0c\u53ea\u8981\u80fd\u6b63\u786e\u5f15\u5165\u5373\u53ef\u3002\u6211\u5c06\u5176\u653e\u5728ThinkPHP\u6838\u5fc3\u6587\u4ef6\u5939 ORG \u76ee\u5f55\u4e0b\u65b0\u5efa\u7684 Backup \u6587\u4ef6\u5939\u4e0b\uff0c\u8fd9\u6837\u5f15\u7528\u76ee\u5f55\u5373\u4e3a\uff1a import(\"ORG.Backup.MySQLReback\");","title":"MySQLReback\u7c7b\u6587\u4ef6"},{"location":"2013-10-19-ThinkPHP%E6%A1%86%E6%9E%B6%E4%B8%8BMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E7%B1%BB/#_1","text":"\u4ee5\u4e0b\u662f Other \u6a21\u5757\u4e0b\u7684\u4e24\u4e2a\u65b9\u6cd5 bacover() \uff1a\u67e5\u627e\u5907\u4efd\u76ee\u5f55\uff0c\u8bfb\u53d6\u6587\u4ef6\u4ee5\u4f9b\u524d\u53f0\u663e\u793a /* ** \u5907\u4efd\u8fd8\u539f\u6570\u636e\u9759\u6001\u9875\u9762 */ public function bacover(){ $DataDir = \"./Public/backup/\"; // \u8bbe\u7f6e\u670d\u52a1\u5668\u4e0a\u7684\u5907\u4efd\u76ee\u5f55 // \u67e5\u627e\u76ee\u5f55\u4e0b\u6587\u4ef6\u3001 $FilePath = opendir($DataDir); while (false !== ($filename = readdir($FilePath))) { $FileAndFolderAyy[] = $filename; } sort($FileAndFolderAyy); // \u9006\u5e8f\u6392\u5217 rsort($FileAndFolderAyy); foreach ($FileAndFolderAyy as $i => $n){ if($i>1){ // 0,1\u5206\u522b\u4e3a\u5f53\u524d\u53ca\u4e0a\u7ea7\u76ee\u5f55\uff0c2\u624d\u662f\u5f53\u524d\u6587\u4ef6\u5f00\u59cb $list[$i-2]['FileName'] = $n; $list[$i-2]['FileTime'] = date('Y-m-d H:i:s',filemtime($DataDir.$n)); $FileSize = filesize($DataDir.$n)/1024; if ($FileSize < 1024){ $list[$i-2]['FileSize'] = number_format($FileSize,2).' KB'; } else { $list[$i-2]['FileSize'] = number_format($FileSize/1024,2).' MB'; } } } $this->assign('list',$list); $this->display(); } dobacover() \uff1a\u8bfb\u53d6\u524d\u53f0\u4fe1\u606f\uff0c\u8c03\u7528 MySQLReback() \u65b9\u6cd5\u5b8c\u6210\u64cd\u4f5c /* ** \u5907\u4efd\u8fd8\u539f\u6570\u636e\u64cd\u4f5c */ public function dobacover(){ $DataDir = \"./Public/backup/\"; // \u8bbe\u7f6e\u670d\u52a1\u5668\u4e0a\u7684\u5907\u4efd\u76ee\u5f55 $action = I(\"action\"); $file = I(\"file\"); if (!empty($action)) { import(\"ORG.Backup.MySQLReback\"); // \u7b2c\u4e09\u65b9\u5907\u4efd\u8fd8\u539f\u7c7b // \u4ece\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\uff0c\u9ed8\u8ba4\u8981\u6c42\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f0f\u5206\u9879\u914d\u7f6e\u7684\uff0c\u800c\u4e0d\u662f'DB_DSN' $config = array( 'host' => C('DB_HOST'), 'port' => C('DB_PORT'), 'userName' => C('DB_USER'), 'userPassword' => C('DB_PWD'), 'dbprefix' => C('DB_PREFIX'), 'charset' => 'UTF8', 'path' => $DataDir, 'isCompress' => 0, //\u662f\u5426\u5f00\u542fgzip\u538b\u7f29 'isDownload' => 0 ); $mr = new MySQLReback($config); $mr->setDBName(C('DB_NAME')); if ($action == 'backup') { $mr->backup(); $this->ajaxReturn('','\u5907\u4efd\u6570\u636e\u5e93\u6210\u529f\uff01',2); } elseif ($action == 'recover') { $mr->recover($file); $this->ajaxReturn('','\u8fd8\u539f\u6570\u636e\u5e93\u6210\u529f\uff01',2); } elseif ($action == 'delete') { if (@unlink($DataDir . $file)) { $this->ajaxReturn('','\u5220\u9664\u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u6210\u529f\uff01',2); } else { $this->ajaxReturn('','\u5220\u9664\u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u5931\u8d25\uff01',1); } } if($action == 'download') { $fileName = $DataDir . $file; ob_end_clean(); header(\"Cache-Control: must-revalidate, post-check=0,pre-check=0\"); header('Content-Description: File Transfer'); header('Content-Type: application/octet-stream'); header('Content-Length: ' . filesize($fileName)); header('Content-Disposition: attachment; filename=' . basename($fileName)); readfile($fileName); exit(); } } }","title":"\u663e\u793a\u9759\u6001\u9875\u9762\u548c\u76f8\u5e94\u64cd\u4f5c\u7684\u65b9\u6cd5"},{"location":"2013-10-19-ThinkPHP%E6%A1%86%E6%9E%B6%E4%B8%8BMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E7%B1%BB/#_2","text":"\u4e00\u4e2atable\u663e\u793a\u540e\u53f0 bacover() \u4f20\u8f93\u7684\u5907\u4efd\u6587\u4ef6\u6570\u636e\uff0c\u7528Jquery\u7684ajax\u63d0\u4ea4\u8bf7\u6c42\uff0c ajax_submit_action() \u662f\u81ea\u5b9a\u4e49\u7684\u63d0\u4ea4\u8bf7\u6c42\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u7565\u53bb\u3002 \u4e3b\u8981\u601d\u8def\uff1a\u901a\u8fc7\u8bbe\u7f6e\u4e0d\u540c\u64cd\u4f5c\u7684\u6309\u94ae\u7684\u7c7b\u540d\u6765\u533a\u5206\u4e0d\u540c\u7684\u4e1a\u52a1\uff1b\u53e6\u5916\uff0c\u7531\u4e8e\u4e0b\u8f7d\u6587\u4ef6\u64cd\u4f5c\u901a\u8fc7ajax\u65b9\u6cd5\u5b8c\u6210\uff0c\u76f4\u63a5\u63d0\u4ea4\u5230 dobacover() \u65b9\u6cd5\u5373\u53ef\u3002 <script> $(document).ready(function() { $(\":button\").click(function(){ var action = $(this).attr('class'); var id = $(this).attr('id'); var content_obj = {'action':action,'file':id}; var url = \"<{:U('Other/dobacover')}>\"; switch(action){ case 'recover': if(confirm(\"\u786e\u5b9a\u8fd8\u539f\u6570\u636e\u5e93\uff1f\")) ajax_submit_action(url,content_obj,0,1); break; case 'delete': if(confirm(\"\u786e\u5b9a\u5220\u9664\u8be5\u5907\u4efd\u6587\u4ef6\uff1f\")) ajax_submit_action(url,content_obj,0,1); break; case 'download': // \u4e0b\u8f7d\u6587\u4ef6\u4e0d\u80fd\u5f02\u6b65\u63d0\u4ea4 window.location.href = url + \"?action=\" +action +\"&file=\" + id; break; default: ajax_submit_action(url,content_obj,0,1); } }); }); </script> <table> <thead> <tr> <th width=\"7%\">\u5e8f\u53f7</th> <th width=\"35%\">\u6587\u4ef6\u540d</th> <th width=\"20%\">\u5907\u4efd\u65f6\u95f4</th> <th width=\"10%\">\u6587\u4ef6\u5927\u5c0f</th> <th width=\"28%\">\u7ba1\u7406\u9009\u9879</th> </tr> </thead> <tbody> <tr> <td><{$i}></td> <td><{$vo.FileName}></td> <td><{$vo.FileTime}></td> <td><{$vo.FileSize}></td> <td> <input id=\"<{$vo.FileName}>\" class=\"recover\" type=\"button\" value=\"\u8fd8\u539f\" /> <input id=\"<{$vo.FileName}>\" class=\"download\" type=\"button\" value=\"\u4e0b\u8f7d\" /> <input id=\"<{$vo.FileName}>\" class=\"delete\" type=\"button\" value=\"\u5220\u9664\" /> </td> </tr> <tr> <td colspan=\"5\" align=\"center\"> <input id=\"none\" class=\"backup\" type=\"button\" value=\"\u5907\u4efd\u6570\u636e\u5e93\" /> </td> </tr> </tbody> </table> \u6ce8\u610f \u6570\u636e\u5e93\u8868\u4e2d\u67d0\u4e9b\u5141\u8bb8\u4e3a\u7a7a\u7684\u5b57\u6bb5\uff0c\u5907\u4efd\u5bfc\u51fa\u65f6\u5b57\u6bb5\u4e3a '' \uff0c\u5728\u8fd8\u539f\u6570\u636e\u5e93\u65f6\u4f1a\u63d0\u793a\u5982\u4e0b\u9519\u8bef\uff1a MySQL Error : Incorrect date value: '' for column '\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7\u00d7' at row 1 \u8fd9\u79cd\u95ee\u9898\u4e00\u822c\u51fa\u73b0\u5728 mysql 5.x \u4ee5\u4e0a\u7248\u672c\uff0c\u56e0\u4e3a\u8981\u6c42\u7a7a\u503c\u5199\u4e3a NULL \u3002\u53ef\u4ee5\u5728\u5b89\u88c5mysql\u7684\u65f6\u5019\u53bb\u9664\u9ed8\u8ba4\u52fe\u9009\u7684 enable strict SQL mode \uff0c\u5df2\u7ecf\u5b89\u88c5\u5219\u9700\u8981\u4fee\u6539mysql\u7684\u914d\u7f6e\u6587\u4ef6 my.ini \u3002\u5728 my.ini \u4e2d\u67e5\u627e sql-mode \uff0c\u5c06\u9ed8\u8ba4\u7684 sql-mode=\"STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\" \u4fee\u6539\u4e3a sql-mode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\" \u7136\u540e\u91cd\u65b0\u542f\u52a8Mysql\u670d\u52a1\u3002 \u672c\u6587\u4e0a\u8ff0\u4ee3\u7801\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u5f00\u53d1\u73af\u5883\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u4e91\u8ba1\u7b97\u5e73\u53f0\uff0c\u7531\u4e8e\u6ca1\u6709\u672c\u5730\u6587\u4ef6\u8bfb\u5199\u7684\u6743\u9650\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5404\u81ea\u63d0\u4f9b\u7684API\u6765\u4fee\u6b63\u6587\u4ef6\u64cd\u4f5c\u3002\u540e\u7eed\u5c06\u4ee5\u65b0\u6d6a\u4e91\u8ba1\u7b97\u5e73\u53f0SAE\u4e3a\u4f8b\uff0c\u7ed9\u51fa\u4fee\u6539\u65b9\u6848\u3002","title":"\u524d\u53f0\u89c6\u56fe"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/","text":"Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f \u00b6 \u53d1\u5e03\u4e8e\uff1a2013-10-31 | \u5206\u7c7b\uff1a python/vba/cpp Sublime Text \u662f\u4e00\u6b3e\u76f8\u5f53\u7ecf\u5178\u7684\u7f16\u8f91\u5668\uff0c\u81ea\u4ece\u7528\u4e0a\u4e4b\u540e\u4fbf\u7231\u4e0d\u91ca\u624b\uff1b\u5f53\u7528\u5176\u5199\u5b8c\u4e00\u6bb5Python\u4ee3\u7801\u800c\u9a6c\u4e0a\u53ef\u4ee5\u8fd0\u884c\u8c03\u8bd5\u4e4b\uff0c\u90a3\u5c31\u66f4\u60ec\u610f\u4e86\u3002\u968f\u7740\u4e0d\u65ad\u7684\u4f7f\u7528\u8fc7\u7a0b\u548c\u5982\u4e0a\u8feb\u5207\u7684\u9700\u6c42\uff0c\u9010\u6e10\u79ef\u7d2f\u4e86\u4e0b\u6587\u4ecb\u7ecd\u7684\u5728 Sublime Text \u7f16\u8f91\u5668\u4e2d\u76f4\u63a5\u8fd0\u884cPython\u7a0b\u5e8f\u7684\u4e24\u79cd\u65b9\u6cd5\u2014\u2014\u8f6f\u4ef6\u81ea\u5e26\u7684 Build \u529f\u80fd\u548c SublimeREPL \u63d2\u4ef6\u3002 Build\u529f\u80fd \u00b6 \u901a\u8fc7\u4e3a\u7f16\u8f91\u5668\u914d\u7f6e\u4ee3\u7801\u8fd0\u884c\u6240\u9700\u4fe1\u606f\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u4ee3\u7801\u3002\u67e5\u770b Tools => Build System \u5982\u4e0b\u56fe\u6240\u793a\u4e3a\u5185\u7f6e\u7684\u4e00\u4e9b\u914d\u7f6e\u60c5\u51b5\u3002 \u4eff\u7167\u76f8\u5e94\u7684\u683c\u5f0f\uff0c\u914d\u7f6ePython\u7a0b\u5e8f\u8fd0\u884c\u4fe1\u606f\u3002 Tools => Build System => New Build System \uff0c\u65b0\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u5220\u9664\u521d\u59cb\u5316\u7684\u5185\u5bb9\uff0c\u5199\u5165\u5982\u4e0b\u5185\u5bb9\u5e76\u4fdd\u5b58\u5230C:\\Users\\Administrator\\AppData\\Roaming\\Sublime Text 2\\Packages\\Python\\Python.sublime-build\u3002\u6ce8\u610f\uff1a Preferences => Browse Packages\u2026 \u53ef\u4ee5\u6253\u5f00\u5230 Packages \uff0c\u7136\u540e\u9009\u62e9 Python \u6587\u4ef6\u5939\u5373\u53ef\u3002 { \"cmd\": [\"python\", \"-u\", \"$file\"], \"path\":\"C:/Python27\", \"file_regex\": \"^[ ]*File \"(...*?)\", line ([0-9]*)\", \"selector\": \"source.python\" } path \u4e00\u884c\u6307\u5b9aPython\u7684\u5b89\u88c5\u4f4d\u7f6e\uff0c\u6839\u636e\u5177\u4f53\u60c5\u51b5\u786e\u5b9a\uff0c\u5176\u4f59\u5185\u5bb9\u53ef\u4fdd\u6301\u56fa\u5b9a\u3002 \u901a\u8fc7 Tools => Build System \u67e5\u770b\uff0c\u6b64\u65f6\u5bf9\u6bd4\u7b2c\u4e00\u5f20\u56fe\u7684\u521d\u59cb\u72b6\u6001\uff0c\u5373\u4f1a\u53d1\u73b0\u65b0\u589e\u4e86 Python \u9009\u9879\u3002\u5728 Build System \u83dc\u5355\u9009\u62e9Python\u9009\u9879\u540e\uff0c\u70b9\u51fb Build \u6216\u8005\u5feb\u6377\u952e Ctrl+B \uff0c\u5c31\u4f1a\u53d1\u73b0\u4ee3\u7801\u533a\u4e0b\u65b9\u51fa\u73b0\u4e86\u8fd0\u884c\u7ed3\u679c\u3002 \u8fd9\u4e2a\u65b9\u6cd5\u5bf9\u4e8e\u5e38\u89c4\u7684\u4ee3\u7801\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e9b\u7b2c\u4e09\u65b9\u7a0b\u5e8f\u5305\u5982 numpy \uff0c scipy \u7b49\uff0c\u6216\u8005\u4ea4\u4e92\u5f0f\u4ee3\u7801\u5982 raw_input() \u51fd\u6570\uff0c\u5219\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\u3002\u8fd9\u5c31\u9700\u8981\u4ecb\u7ecd SublimeREPL \u63d2\u4ef6\u3002 SublimeREPL\u63d2\u4ef6 \u00b6 SublimeREPL (Sublime Read-Evaluation-Print-Loop)\uff0c\u89e3\u91ca\u578b\u8bed\u8a00\u7f16\u8bd1\u8fd0\u884c\u7684\u8fc7\u7a0b\uff0c\u88c5\u4e86\u8be5\u63d2\u4ef6\u540e\u5373\u53ef\u652f\u6301\u76f4\u63a5\u5728Sublime\u7f16\u8f91\u5668\u4e0a\u7684\u7f16\u8bd1\u8fd0\u884c\u548c\u4ea4\u4e92\u3002 \u5b89\u88c5\u65b9\u6cd5\u4e0d\u5fc5\u591a\u8ff0\uff0c\u53ef\u4ee5\u5728\u7ebf\u6216\u8005\u624b\u52a8\u5b8c\u6210\u3002\u5b89\u88c5\u5b8c\u63d2\u4ef6\u540e\uff0c\u5728 Tools \u83dc\u5355\u4e0b\u5373\u53ef\u770b\u5230\u65b0\u589e\u7684SublimeREPL\u83dc\u5355\u9879\uff0c\u5982\u4e0b\u56fe\u9009\u62e9 Run Current File \u5373\u53ef\u8fd0\u884c\uff0c\u4e0a\u9762\u63d0\u5230\u7684 Build \u547d\u4ee4\u65e0\u6cd5\u5b9e\u73b0\u7684\u4e24\u7c7b\u95ee\u9898\u77ac\u95f4\u4e0d\u590d\u5b58\u5728\u3002 \u81f3\u6b64\uff0c\u7b97\u662f\u8fbe\u6210\u4e86\u5fc3\u613f\uff0c\u4e5f\u66f4\u52a0\u80af\u5b9a\u4e86\u8fd9\u6b3e\u795e\u5668\u3002\u7136\u800c\u6311\u5254\u4e00\u70b9\uff0c\u7f8e\u4e2d\u4e0d\u8db3\u7684\u662f\u8fd0\u884c\u7a0b\u5e8f\u9700\u8981\u70b9\u51fb\u7684\u83dc\u5355\u8fc7\u957f\uff0c\u591a\u4e48\u5e0c\u671b\u50cf\u5728\u5176\u4ed6IDE\u73af\u5883\u4e0b\u76f4\u63a5 F5 \u8fd0\u884c\u554a\u3002 Sublime\u4e0d\u4f1a\u8ba9\u4eba\u5931\u671b\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u5feb\u6377\u952e\u5373\u53ef\u3002 \u81ea\u5b9a\u4e49\u5feb\u6377\u952e \u00b6 Preferences \u83dc\u5355\u4e0b\u7684 Key Boundings-Default \u6587\u4ef6\u8fc7\u9664\u4e86\u8f6f\u4ef6\u9ed8\u8ba4\u7684\u5feb\u6377\u952e\uff0c\u540c\u65f6\u4e5f\u544a\u8bc9\u6211\u4eec\u4e86\u5b9a\u4e49\u5feb\u6377\u952e\u7684\u683c\u5f0f\uff0c\u65b9\u4fbf\u6211\u4eec\u5728 Key Boundings-User \u6587\u4ef6\u4e2d\u81ea\u884c\u5b9a\u4e49\u3002\u6240\u4ee5\u601d\u8def\u4e3a\u627e\u5230 SublimeREPL \u63d2\u4ef6\u83dc\u5355\u547d\u4ee4\u7684\u5b9a\u4e49\u6587\u4ef6\uff0c\u7136\u540e\u4e3a\u6211\u4eec\u9700\u8981\u7684\u547d\u4ee4\u5b9a\u4e49\u5feb\u6377\u952e\u3002 SublimeREPL\u63d2\u4ef6\u7684\u83dc\u5355\u547d\u4ee4 \u00b6 Preferences => Browser Packages\u2026 \u6253\u5f00\u63d2\u4ef6\u5b89\u88c5\u5305\u4f4d\u7f6e\uff0c\u4f9d\u6b21\u627e\u5230 SublimeREPL\\config\\Python \u6587\u4ef6\u5939\u4e0b\u7684 Main.sublime-menu \u5e76\u6253\u5f00\u3002\u8be5\u6587\u4ef6\u5373\u662f\u63d2\u4ef6\u83dc\u5355\u7684\u7ed3\u6784\u53ca\u76f8\u5173\u53c2\u6570\uff0c\u4ece\u4e2d\u627e\u5230\u8fd0\u884cPython\u6587\u4ef6\u7684\u83dc\u5355\u9879\u7684\u90e8\u5206\uff1a { \"command\": \"repl_open\", \"caption\": \"Python - RUN current file\", \"id\": \"repl_python_run\", \"mnemonic\": \"d\", \"args\": { \"type\": \"subprocess\", \"encoding\": \"utf8\", \"cmd\": [\"python\", \"-u\", \"$file_basename\"], \"cwd\": \"$file_path\", \"syntax\": \"Packages/Python/Python.tmLanguage\", \"external_id\": \"python\", \"extend_env\": {\"PYTHONIOENCODING\": \"utf-8\"} } }, ... \u5176\u4e2did\u7684\u503c\u662f\u6211\u4eec\u9700\u8981\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u6b63\u662f\u8981\u4e3a\u5176\u6dfb\u52a0\u5feb\u6377\u952e\u3002\u53e6\u5916\uff0c\u83dc\u5355\u6587\u4ef6\u7684\u4f4d\u7f6e\u4e5f\u662f\u9700\u8981\u5148\u8bb0\u4e0b\u7684\uff0c\u56e0\u4e3a\u9700\u8981\u4e3a\u8fd9\u4e2a\u547d\u4ee4\u6307\u5b9a\u5b9a\u4e49\u7684\u6765\u6e90\u3002 \u81ea\u5b9a\u4e49\u5feb\u6377\u952e \u00b6 Preferences => Key Boundings-User \u6253\u5f00\u81ea\u5b9a\u4e49\u5feb\u6377\u952e\u6587\u4ef6\uff0c\u5199\u5165\u5982\u4e0b\u5185\u5bb9\uff1a [ { \"keys\" : [\"f5\"], // \u5feb\u6377\u952e\uff0c\u6ce8\u610f\u5c0f\u5199 \"command\" : \"run_existing_window_command\", // \u8fd0\u884c\u5b9a\u4e49\u7684\u547d\u4ee4 \"args\" : // \u547d\u4ee4\u53c2\u6570 { \"id\" : \"repl_python_run\", // \u4e0a\u4e00\u6b65\u67e5\u770b\u7684\u547d\u4ee4\u7684id \"file\" : \"config/Python/Main.sublime-menu\" // \u83dc\u5355\u5b9a\u4e49\u6587\u4ef6\u4f4d\u7f6e } } ] \u5230\u6b64\u4e3a\u6b62\uff0c\u53ef\u4ee5\u4f7f\u7528\u5feb\u6377\u952e F5 \u5728 Sublime Text 2 \u7f16\u8f91\u5668\u4e2d\u5feb\u901f\u6267\u884cPython\u4ee3\u7801\u3002","title":"Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/#sublime text 2python","text":"\u53d1\u5e03\u4e8e\uff1a2013-10-31 | \u5206\u7c7b\uff1a python/vba/cpp Sublime Text \u662f\u4e00\u6b3e\u76f8\u5f53\u7ecf\u5178\u7684\u7f16\u8f91\u5668\uff0c\u81ea\u4ece\u7528\u4e0a\u4e4b\u540e\u4fbf\u7231\u4e0d\u91ca\u624b\uff1b\u5f53\u7528\u5176\u5199\u5b8c\u4e00\u6bb5Python\u4ee3\u7801\u800c\u9a6c\u4e0a\u53ef\u4ee5\u8fd0\u884c\u8c03\u8bd5\u4e4b\uff0c\u90a3\u5c31\u66f4\u60ec\u610f\u4e86\u3002\u968f\u7740\u4e0d\u65ad\u7684\u4f7f\u7528\u8fc7\u7a0b\u548c\u5982\u4e0a\u8feb\u5207\u7684\u9700\u6c42\uff0c\u9010\u6e10\u79ef\u7d2f\u4e86\u4e0b\u6587\u4ecb\u7ecd\u7684\u5728 Sublime Text \u7f16\u8f91\u5668\u4e2d\u76f4\u63a5\u8fd0\u884cPython\u7a0b\u5e8f\u7684\u4e24\u79cd\u65b9\u6cd5\u2014\u2014\u8f6f\u4ef6\u81ea\u5e26\u7684 Build \u529f\u80fd\u548c SublimeREPL \u63d2\u4ef6\u3002","title":"Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/#build","text":"\u901a\u8fc7\u4e3a\u7f16\u8f91\u5668\u914d\u7f6e\u4ee3\u7801\u8fd0\u884c\u6240\u9700\u4fe1\u606f\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u4ee3\u7801\u3002\u67e5\u770b Tools => Build System \u5982\u4e0b\u56fe\u6240\u793a\u4e3a\u5185\u7f6e\u7684\u4e00\u4e9b\u914d\u7f6e\u60c5\u51b5\u3002 \u4eff\u7167\u76f8\u5e94\u7684\u683c\u5f0f\uff0c\u914d\u7f6ePython\u7a0b\u5e8f\u8fd0\u884c\u4fe1\u606f\u3002 Tools => Build System => New Build System \uff0c\u65b0\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u5220\u9664\u521d\u59cb\u5316\u7684\u5185\u5bb9\uff0c\u5199\u5165\u5982\u4e0b\u5185\u5bb9\u5e76\u4fdd\u5b58\u5230C:\\Users\\Administrator\\AppData\\Roaming\\Sublime Text 2\\Packages\\Python\\Python.sublime-build\u3002\u6ce8\u610f\uff1a Preferences => Browse Packages\u2026 \u53ef\u4ee5\u6253\u5f00\u5230 Packages \uff0c\u7136\u540e\u9009\u62e9 Python \u6587\u4ef6\u5939\u5373\u53ef\u3002 { \"cmd\": [\"python\", \"-u\", \"$file\"], \"path\":\"C:/Python27\", \"file_regex\": \"^[ ]*File \"(...*?)\", line ([0-9]*)\", \"selector\": \"source.python\" } path \u4e00\u884c\u6307\u5b9aPython\u7684\u5b89\u88c5\u4f4d\u7f6e\uff0c\u6839\u636e\u5177\u4f53\u60c5\u51b5\u786e\u5b9a\uff0c\u5176\u4f59\u5185\u5bb9\u53ef\u4fdd\u6301\u56fa\u5b9a\u3002 \u901a\u8fc7 Tools => Build System \u67e5\u770b\uff0c\u6b64\u65f6\u5bf9\u6bd4\u7b2c\u4e00\u5f20\u56fe\u7684\u521d\u59cb\u72b6\u6001\uff0c\u5373\u4f1a\u53d1\u73b0\u65b0\u589e\u4e86 Python \u9009\u9879\u3002\u5728 Build System \u83dc\u5355\u9009\u62e9Python\u9009\u9879\u540e\uff0c\u70b9\u51fb Build \u6216\u8005\u5feb\u6377\u952e Ctrl+B \uff0c\u5c31\u4f1a\u53d1\u73b0\u4ee3\u7801\u533a\u4e0b\u65b9\u51fa\u73b0\u4e86\u8fd0\u884c\u7ed3\u679c\u3002 \u8fd9\u4e2a\u65b9\u6cd5\u5bf9\u4e8e\u5e38\u89c4\u7684\u4ee3\u7801\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e9b\u7b2c\u4e09\u65b9\u7a0b\u5e8f\u5305\u5982 numpy \uff0c scipy \u7b49\uff0c\u6216\u8005\u4ea4\u4e92\u5f0f\u4ee3\u7801\u5982 raw_input() \u51fd\u6570\uff0c\u5219\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\u3002\u8fd9\u5c31\u9700\u8981\u4ecb\u7ecd SublimeREPL \u63d2\u4ef6\u3002","title":"Build\u529f\u80fd"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/#sublimerepl","text":"SublimeREPL (Sublime Read-Evaluation-Print-Loop)\uff0c\u89e3\u91ca\u578b\u8bed\u8a00\u7f16\u8bd1\u8fd0\u884c\u7684\u8fc7\u7a0b\uff0c\u88c5\u4e86\u8be5\u63d2\u4ef6\u540e\u5373\u53ef\u652f\u6301\u76f4\u63a5\u5728Sublime\u7f16\u8f91\u5668\u4e0a\u7684\u7f16\u8bd1\u8fd0\u884c\u548c\u4ea4\u4e92\u3002 \u5b89\u88c5\u65b9\u6cd5\u4e0d\u5fc5\u591a\u8ff0\uff0c\u53ef\u4ee5\u5728\u7ebf\u6216\u8005\u624b\u52a8\u5b8c\u6210\u3002\u5b89\u88c5\u5b8c\u63d2\u4ef6\u540e\uff0c\u5728 Tools \u83dc\u5355\u4e0b\u5373\u53ef\u770b\u5230\u65b0\u589e\u7684SublimeREPL\u83dc\u5355\u9879\uff0c\u5982\u4e0b\u56fe\u9009\u62e9 Run Current File \u5373\u53ef\u8fd0\u884c\uff0c\u4e0a\u9762\u63d0\u5230\u7684 Build \u547d\u4ee4\u65e0\u6cd5\u5b9e\u73b0\u7684\u4e24\u7c7b\u95ee\u9898\u77ac\u95f4\u4e0d\u590d\u5b58\u5728\u3002 \u81f3\u6b64\uff0c\u7b97\u662f\u8fbe\u6210\u4e86\u5fc3\u613f\uff0c\u4e5f\u66f4\u52a0\u80af\u5b9a\u4e86\u8fd9\u6b3e\u795e\u5668\u3002\u7136\u800c\u6311\u5254\u4e00\u70b9\uff0c\u7f8e\u4e2d\u4e0d\u8db3\u7684\u662f\u8fd0\u884c\u7a0b\u5e8f\u9700\u8981\u70b9\u51fb\u7684\u83dc\u5355\u8fc7\u957f\uff0c\u591a\u4e48\u5e0c\u671b\u50cf\u5728\u5176\u4ed6IDE\u73af\u5883\u4e0b\u76f4\u63a5 F5 \u8fd0\u884c\u554a\u3002 Sublime\u4e0d\u4f1a\u8ba9\u4eba\u5931\u671b\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u5feb\u6377\u952e\u5373\u53ef\u3002","title":"SublimeREPL\u63d2\u4ef6"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/#_1","text":"Preferences \u83dc\u5355\u4e0b\u7684 Key Boundings-Default \u6587\u4ef6\u8fc7\u9664\u4e86\u8f6f\u4ef6\u9ed8\u8ba4\u7684\u5feb\u6377\u952e\uff0c\u540c\u65f6\u4e5f\u544a\u8bc9\u6211\u4eec\u4e86\u5b9a\u4e49\u5feb\u6377\u952e\u7684\u683c\u5f0f\uff0c\u65b9\u4fbf\u6211\u4eec\u5728 Key Boundings-User \u6587\u4ef6\u4e2d\u81ea\u884c\u5b9a\u4e49\u3002\u6240\u4ee5\u601d\u8def\u4e3a\u627e\u5230 SublimeREPL \u63d2\u4ef6\u83dc\u5355\u547d\u4ee4\u7684\u5b9a\u4e49\u6587\u4ef6\uff0c\u7136\u540e\u4e3a\u6211\u4eec\u9700\u8981\u7684\u547d\u4ee4\u5b9a\u4e49\u5feb\u6377\u952e\u3002","title":"\u81ea\u5b9a\u4e49\u5feb\u6377\u952e"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/#sublimerepl_1","text":"Preferences => Browser Packages\u2026 \u6253\u5f00\u63d2\u4ef6\u5b89\u88c5\u5305\u4f4d\u7f6e\uff0c\u4f9d\u6b21\u627e\u5230 SublimeREPL\\config\\Python \u6587\u4ef6\u5939\u4e0b\u7684 Main.sublime-menu \u5e76\u6253\u5f00\u3002\u8be5\u6587\u4ef6\u5373\u662f\u63d2\u4ef6\u83dc\u5355\u7684\u7ed3\u6784\u53ca\u76f8\u5173\u53c2\u6570\uff0c\u4ece\u4e2d\u627e\u5230\u8fd0\u884cPython\u6587\u4ef6\u7684\u83dc\u5355\u9879\u7684\u90e8\u5206\uff1a { \"command\": \"repl_open\", \"caption\": \"Python - RUN current file\", \"id\": \"repl_python_run\", \"mnemonic\": \"d\", \"args\": { \"type\": \"subprocess\", \"encoding\": \"utf8\", \"cmd\": [\"python\", \"-u\", \"$file_basename\"], \"cwd\": \"$file_path\", \"syntax\": \"Packages/Python/Python.tmLanguage\", \"external_id\": \"python\", \"extend_env\": {\"PYTHONIOENCODING\": \"utf-8\"} } }, ... \u5176\u4e2did\u7684\u503c\u662f\u6211\u4eec\u9700\u8981\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u6b63\u662f\u8981\u4e3a\u5176\u6dfb\u52a0\u5feb\u6377\u952e\u3002\u53e6\u5916\uff0c\u83dc\u5355\u6587\u4ef6\u7684\u4f4d\u7f6e\u4e5f\u662f\u9700\u8981\u5148\u8bb0\u4e0b\u7684\uff0c\u56e0\u4e3a\u9700\u8981\u4e3a\u8fd9\u4e2a\u547d\u4ee4\u6307\u5b9a\u5b9a\u4e49\u7684\u6765\u6e90\u3002","title":"SublimeREPL\u63d2\u4ef6\u7684\u83dc\u5355\u547d\u4ee4"},{"location":"2013-10-31-Sublime-Text-2%E4%B8%AD%E8%BF%90%E8%A1%8CPython%E7%A8%8B%E5%BA%8F/#_2","text":"Preferences => Key Boundings-User \u6253\u5f00\u81ea\u5b9a\u4e49\u5feb\u6377\u952e\u6587\u4ef6\uff0c\u5199\u5165\u5982\u4e0b\u5185\u5bb9\uff1a [ { \"keys\" : [\"f5\"], // \u5feb\u6377\u952e\uff0c\u6ce8\u610f\u5c0f\u5199 \"command\" : \"run_existing_window_command\", // \u8fd0\u884c\u5b9a\u4e49\u7684\u547d\u4ee4 \"args\" : // \u547d\u4ee4\u53c2\u6570 { \"id\" : \"repl_python_run\", // \u4e0a\u4e00\u6b65\u67e5\u770b\u7684\u547d\u4ee4\u7684id \"file\" : \"config/Python/Main.sublime-menu\" // \u83dc\u5355\u5b9a\u4e49\u6587\u4ef6\u4f4d\u7f6e } } ] \u5230\u6b64\u4e3a\u6b62\uff0c\u53ef\u4ee5\u4f7f\u7528\u5feb\u6377\u952e F5 \u5728 Sublime Text 2 \u7f16\u8f91\u5668\u4e2d\u5feb\u901f\u6267\u884cPython\u4ee3\u7801\u3002","title":"\u81ea\u5b9a\u4e49\u5feb\u6377\u952e"},{"location":"2014-07-02-Sublime-Text-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%E4%B8%BB%E9%A2%98/","text":"Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898 \u00b6 \u53d1\u5e03\u4e8e\uff1a2014-07-02 | \u5206\u7c7b\uff1a process automation Sublime Text\u7f16\u8f91\u5668\u63d0\u4f9b\u4e86\u5f88\u591a\u81ea\u5b9a\u4e49\u7684\u989c\u8272\u4e3b\u9898\uff0c\u4f7f\u4ee3\u7801\u754c\u9762\u663e\u5f97\u66f4\u4e3a\u6e05\u6670\u548c\u4f18\u96c5\u3002\u9ed8\u8ba4\u989c\u8272\u4e3b\u9898\u57fa\u672c\u53ef\u4ee5\u6ee1\u8db3\u6211\u4eec\u7684\u8981\u6c42\uff0c\u5e76\u4e14\u7f51\u4e0a\u4e5f\u6709\u65b0\u7684\u4e3b\u9898\u53ef\u4f9b\u4e0b\u8f7d\u3002\u4f46\u662f\u5bf9\u4e8e\u559c\u6b22\u6298\u817e\u6216\u8005\u4e3a\u4e86\u4f7f\u9009\u7528\u7684\u4e3b\u9898\u66f4\u7b26\u5408\u81ea\u5df1\u7684\u89c6\u89c9\u4e60\u60ef\uff0c\u6709\u5fc5\u8981\u65b0\u5efa\u6216\u8005\u4fee\u6539\u989c\u8272\u4e3b\u9898\u3002 \u4f8b\u5982\uff0c\u672c\u4eba\u6bd4\u8f83\u559c\u6b22\u9ed8\u8ba4\u7684Monokai\u4e3b\u9898\uff0c\u4f46\u662f\u5bf9\u4e8e\u5176\u7070\u8272\u663e\u793a\u7684\u6ce8\u91ca\u4e0d\u592a\u6ee1\u610f\uff0c\u5e0c\u671b\u53ef\u4ee5\u4fee\u6539\u4e3a\u7eff\u8272\u3002 \u5f53\u524d\u989c\u8272\u4e3b\u9898 \u00b6 \u6211\u4eec\u53ef\u4ee5\u4ece\u7a7a\u767d\u6587\u4ef6\u5f00\u59cb\u5efa\u7acb\u81ea\u5df1\u7684\u4e3b\u9898\u6587\u4ef6\uff0c\u4f46\u662f\u6bd4\u8f83\u6709\u6548\u7387\u7684\u65b9\u6cd5\u662f\u5728\u81ea\u5df1\u6bd4\u8f83\u611f\u5174\u8da3\u7684\u4e3b\u9898\u7684\u57fa\u7840\u4e0a\uff0c\u81ea\u5b9a\u4e49\u66f4\u7b26\u5408\u6211\u4eec\u4e60\u60ef\u7684\u989c\u8272\u6837\u5f0f\u3002\u4ee5\u4e0b\u6b65\u9aa4\u53ef\u4ee5\u627e\u5230\u5f53\u524d\u989c\u8272\u4e3b\u9898\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1a \u70b9\u51fb Preferences => color scheme \uff0c\u9009\u62e9\u5e76\u67e5\u770b\u5f53\u524d\u989c\u8272\u4e3b\u9898\uff0c\u786e\u5b9a\u81ea\u5df1\u949f\u610f\u5ea6\u8f83\u5927\u7684\u4e00\u6b3e\uff0c\u5047\u8bbe\u662fMonokai\u3002 \u70b9\u51fb Preferences => Browse Packages \uff0c\u5728\u5f39\u51fa\u7684\u7a97\u53e3\u4e2d\u6253\u5f00 Color Scheme - Default \u6587\u4ef6\u5939\uff0c\u627e\u5230 Monokai.tmTheme \u6587\u4ef6\u3002 \u81ea\u5b9a\u4e49\u6837\u5f0f \u00b6 \u5c06 Monokai.tmTheme \u62d6\u5230Sublime Text\u4e2d\u6253\u5f00\uff0c\u53ef\u4ee5\u53d1\u73b0\u662fxml\u683c\u5f0f\u7684\uff0c\u4f7f\u7528\u952e\u503c\u5bf9\u5b9a\u4e49\u6837\u5f0f\u3002\u6839\u636e\u952e\u540d\u5373\u53ef\u731c\u6d4b\u6837\u5f0f\u8bbe\u7f6e\u7684\u4f5c\u7528\uff0c\u4f8b\u5982\u6ce8\u91ca\uff0c\u67e5\u627ecomment\uff0c\u627e\u5230\u5982\u4e0b\u4e00\u6bb5\uff1a <dict> <key>name</key> <string>Comment</string> <key>scope</key> <string>comment</string> <key>settings</key> <dict> <key>foreground</key> <string>#3EE55A</string> </dict> </dict> \u5c06 <key>foreground</key> \u5bf9\u5e94\u7684 <string>#3EE55A</string> \u4fee\u6539\u4e3a\u9700\u8981\u7684\u989c\u8272\u5373\u53ef\uff0c\u4f8b\u5982 #3EE55A \u3002\u6ce8\u610f\u989c\u8272\u4e3a16\u8fdb\u5236\u503c\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5e38\u89c4\u7684\u5b9a\u4e49\u989c\u8272\uff1ared green blue white black \u7b49\u3002 \u5176\u4ed6\u9700\u8981\u81ea\u5b9a\u4e49\u7684\u6162\u6162\u67e5\u770b\u5373\u53ef\uff0c\u4f8b\u5982\uff1a \u6570\u5b57\u989c\u8272 <string>Number</string> \u5b57\u7b26\u4e32\u989c\u8272 <string>String</string> \u7c7b\u989c\u8272 <string>Class name</string> \u51fd\u6570\u989c\u8272 <string>Function name</string> \u4e3a\u4e86\u907f\u514d\u8986\u76d6\u6389\u539f\u6765\u7684\u6837\u5f0f\u6587\u4ef6\uff0c\u5728\u539f\u6709\u4e3b\u9898\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u6ce8\u610f\u53e6\u5b58\u4e3a\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u3002\u4fdd\u5b58\u7684\u6587\u4ef6\u540d\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u540e\u7f00\u540d\u5e94\u8be5\u4fdd\u6301\u4e0d\u53d8\uff0c\u4f8b\u5982\u4fdd\u5b58\u4e3a MyMonokai.tmTheme \uff0c\u8fd9\u6837\u4e00\u4e2a\u65b0\u7684\u989c\u8272\u4e3b\u9898 MyMonokai \u5c31\u505a\u597d\u4e86\u3002 \u542f\u7528\u65b0\u989c\u8272\u4e3b\u9898 \u00b6 \u5728 preferences => Color Scheme \u83dc\u5355\u4e0b\u53ef\u4ee5\u770b\u5230\u65b0\u5efa\u7684\u989c\u8272\u4e3b\u9898 MyMonokai \uff0c\u9009\u62e9\u8be5\u4e3b\u9898\u5373\u53ef\u542f\u7528\u3002","title":"Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898"},{"location":"2014-07-02-Sublime-Text-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%E4%B8%BB%E9%A2%98/#sublime text","text":"\u53d1\u5e03\u4e8e\uff1a2014-07-02 | \u5206\u7c7b\uff1a process automation Sublime Text\u7f16\u8f91\u5668\u63d0\u4f9b\u4e86\u5f88\u591a\u81ea\u5b9a\u4e49\u7684\u989c\u8272\u4e3b\u9898\uff0c\u4f7f\u4ee3\u7801\u754c\u9762\u663e\u5f97\u66f4\u4e3a\u6e05\u6670\u548c\u4f18\u96c5\u3002\u9ed8\u8ba4\u989c\u8272\u4e3b\u9898\u57fa\u672c\u53ef\u4ee5\u6ee1\u8db3\u6211\u4eec\u7684\u8981\u6c42\uff0c\u5e76\u4e14\u7f51\u4e0a\u4e5f\u6709\u65b0\u7684\u4e3b\u9898\u53ef\u4f9b\u4e0b\u8f7d\u3002\u4f46\u662f\u5bf9\u4e8e\u559c\u6b22\u6298\u817e\u6216\u8005\u4e3a\u4e86\u4f7f\u9009\u7528\u7684\u4e3b\u9898\u66f4\u7b26\u5408\u81ea\u5df1\u7684\u89c6\u89c9\u4e60\u60ef\uff0c\u6709\u5fc5\u8981\u65b0\u5efa\u6216\u8005\u4fee\u6539\u989c\u8272\u4e3b\u9898\u3002 \u4f8b\u5982\uff0c\u672c\u4eba\u6bd4\u8f83\u559c\u6b22\u9ed8\u8ba4\u7684Monokai\u4e3b\u9898\uff0c\u4f46\u662f\u5bf9\u4e8e\u5176\u7070\u8272\u663e\u793a\u7684\u6ce8\u91ca\u4e0d\u592a\u6ee1\u610f\uff0c\u5e0c\u671b\u53ef\u4ee5\u4fee\u6539\u4e3a\u7eff\u8272\u3002","title":"Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898"},{"location":"2014-07-02-Sublime-Text-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%E4%B8%BB%E9%A2%98/#_1","text":"\u6211\u4eec\u53ef\u4ee5\u4ece\u7a7a\u767d\u6587\u4ef6\u5f00\u59cb\u5efa\u7acb\u81ea\u5df1\u7684\u4e3b\u9898\u6587\u4ef6\uff0c\u4f46\u662f\u6bd4\u8f83\u6709\u6548\u7387\u7684\u65b9\u6cd5\u662f\u5728\u81ea\u5df1\u6bd4\u8f83\u611f\u5174\u8da3\u7684\u4e3b\u9898\u7684\u57fa\u7840\u4e0a\uff0c\u81ea\u5b9a\u4e49\u66f4\u7b26\u5408\u6211\u4eec\u4e60\u60ef\u7684\u989c\u8272\u6837\u5f0f\u3002\u4ee5\u4e0b\u6b65\u9aa4\u53ef\u4ee5\u627e\u5230\u5f53\u524d\u989c\u8272\u4e3b\u9898\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1a \u70b9\u51fb Preferences => color scheme \uff0c\u9009\u62e9\u5e76\u67e5\u770b\u5f53\u524d\u989c\u8272\u4e3b\u9898\uff0c\u786e\u5b9a\u81ea\u5df1\u949f\u610f\u5ea6\u8f83\u5927\u7684\u4e00\u6b3e\uff0c\u5047\u8bbe\u662fMonokai\u3002 \u70b9\u51fb Preferences => Browse Packages \uff0c\u5728\u5f39\u51fa\u7684\u7a97\u53e3\u4e2d\u6253\u5f00 Color Scheme - Default \u6587\u4ef6\u5939\uff0c\u627e\u5230 Monokai.tmTheme \u6587\u4ef6\u3002","title":"\u5f53\u524d\u989c\u8272\u4e3b\u9898"},{"location":"2014-07-02-Sublime-Text-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%E4%B8%BB%E9%A2%98/#_2","text":"\u5c06 Monokai.tmTheme \u62d6\u5230Sublime Text\u4e2d\u6253\u5f00\uff0c\u53ef\u4ee5\u53d1\u73b0\u662fxml\u683c\u5f0f\u7684\uff0c\u4f7f\u7528\u952e\u503c\u5bf9\u5b9a\u4e49\u6837\u5f0f\u3002\u6839\u636e\u952e\u540d\u5373\u53ef\u731c\u6d4b\u6837\u5f0f\u8bbe\u7f6e\u7684\u4f5c\u7528\uff0c\u4f8b\u5982\u6ce8\u91ca\uff0c\u67e5\u627ecomment\uff0c\u627e\u5230\u5982\u4e0b\u4e00\u6bb5\uff1a <dict> <key>name</key> <string>Comment</string> <key>scope</key> <string>comment</string> <key>settings</key> <dict> <key>foreground</key> <string>#3EE55A</string> </dict> </dict> \u5c06 <key>foreground</key> \u5bf9\u5e94\u7684 <string>#3EE55A</string> \u4fee\u6539\u4e3a\u9700\u8981\u7684\u989c\u8272\u5373\u53ef\uff0c\u4f8b\u5982 #3EE55A \u3002\u6ce8\u610f\u989c\u8272\u4e3a16\u8fdb\u5236\u503c\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5e38\u89c4\u7684\u5b9a\u4e49\u989c\u8272\uff1ared green blue white black \u7b49\u3002 \u5176\u4ed6\u9700\u8981\u81ea\u5b9a\u4e49\u7684\u6162\u6162\u67e5\u770b\u5373\u53ef\uff0c\u4f8b\u5982\uff1a \u6570\u5b57\u989c\u8272 <string>Number</string> \u5b57\u7b26\u4e32\u989c\u8272 <string>String</string> \u7c7b\u989c\u8272 <string>Class name</string> \u51fd\u6570\u989c\u8272 <string>Function name</string> \u4e3a\u4e86\u907f\u514d\u8986\u76d6\u6389\u539f\u6765\u7684\u6837\u5f0f\u6587\u4ef6\uff0c\u5728\u539f\u6709\u4e3b\u9898\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u6ce8\u610f\u53e6\u5b58\u4e3a\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u3002\u4fdd\u5b58\u7684\u6587\u4ef6\u540d\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u540e\u7f00\u540d\u5e94\u8be5\u4fdd\u6301\u4e0d\u53d8\uff0c\u4f8b\u5982\u4fdd\u5b58\u4e3a MyMonokai.tmTheme \uff0c\u8fd9\u6837\u4e00\u4e2a\u65b0\u7684\u989c\u8272\u4e3b\u9898 MyMonokai \u5c31\u505a\u597d\u4e86\u3002","title":"\u81ea\u5b9a\u4e49\u6837\u5f0f"},{"location":"2014-07-02-Sublime-Text-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%E4%B8%BB%E9%A2%98/#_3","text":"\u5728 preferences => Color Scheme \u83dc\u5355\u4e0b\u53ef\u4ee5\u770b\u5230\u65b0\u5efa\u7684\u989c\u8272\u4e3b\u9898 MyMonokai \uff0c\u9009\u62e9\u8be5\u4e3b\u9898\u5373\u53ef\u542f\u7528\u3002","title":"\u542f\u7528\u65b0\u989c\u8272\u4e3b\u9898"},{"location":"2014-11-28-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/","text":"\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206 \u00b6 \u53d1\u5e03\u4e8e\uff1a2014-11-28 | \u5206\u7c7b\uff1a numeric calculation \u4e0a\u9650\u6cd5\u662f\u4e00\u79cd\u89e3\u6790\u65b9\u6cd5\uff0c\u4f46\u6709\u65f6\u5019\u6a21\u578b\u6bd4\u8f83\u590d\u6742\uff0c\u5728\u5851\u6027\u529f\u79ef\u5206\u73af\u8282\u8fd8\u5f97\u6c42\u52a9\u4e8e\u6570\u503c\u79ef\u5206\u3002\u6839\u636e\u79ef\u5206\u65b9\u6cd5\u7684\u4e0d\u540c\uff0c\u5b58\u5728\u4ee5\u4e0b\u4e24\u79cd\u601d\u8def\uff1a \u76f4\u63a5\u8fdb\u884c\u9ad8\u65af\u79ef\u5206 \u5355\u5143\u79bb\u6563\u540e\u8fdb\u884c\u4f4e\u9636\u6570\u503c\u79ef\u5206 \u672c\u6587\u5206\u522b\u4f7f\u7528\u4ee5\u4e0a\u4e24\u79cd\u65b9\u6cd5\u8ba1\u7b97\u4e0b\u9762\u4e8c\u91cd\u79ef\u5206\uff0c\u4ee5\u76f4\u89c2\u8ba4\u8bc6\u53ca\u5206\u6790\u4e8c\u8005\u7684\u533a\u522b\uff1a W = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {f(x,\\,y)}} \\mathrm{d}x\\mathrm{d}y = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {\\cos\\dfrac{\\pi\\,(x + y)}{2}}}\\mathrm{d}x\\mathrm{d}y W = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {f(x,\\,y)}} \\mathrm{d}x\\mathrm{d}y = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {\\cos\\dfrac{\\pi\\,(x + y)}{2}}}\\mathrm{d}x\\mathrm{d}y \u7406\u8bba\u89e3 \u00b6 \\begin{align*} W &= -\\dfrac{2}{\\pi}\\,\\int\\limits_{-1}^1{\\left.{\\sin\\dfrac{\\pi\\,(x+y)}{2}} \\right|_{-1}^1} \\,\\mathrm{d}y\\\\ &= -\\dfrac{2}{\\pi}\\,\\int\\limits_{-1}^1{\\biggl[\\sin\\dfrac{\\pi\\,(y+1)}{2}-\\sin\\dfrac{\\pi\\,(y-1)}{2}\\biggr] }\\,\\mathrm{d}y \\\\ &= -\\frac{4}{\\pi^2}\\left. {\\biggl[ {\\cos\\frac{\\pi\\,(y+1)}{2} - \\cos\\frac{\\pi\\,(y-1)}{2}}\\biggr]}\\right|_{-1}^1 \\\\ &= -\\frac{16}{\\pi ^2} \\approx 1.6211 \\end{align*} \u9ad8\u65af\u79ef\u5206 \u00b6 \u7531\u4e8e\u76ee\u6807\u51fd\u6570\u6070\u597d\u5728Gauss-Legendre\u7684\u6807\u51c6\u79ef\u5206\u533a\u95f4 [-1,1] [-1,1] \uff0c\u53ef\u4ee5\u76f4\u63a5\u53d6\u79ef\u5206\u70b9\u4ee3\u5165\u4e8c\u91cd\u9ad8\u65af\u79ef\u5206\u516c\u5f0f\u3002\u4e8e\u662f W W \u7684 n n \u9636Gauss-Legendre\u79ef\u5206\u8fd1\u4f3c\u503c\u5c31\u53ef\u901a\u8fc7\u4e0b\u5f0f\u6c42\u5f97 {W_n} = \\sum\\limits_{i=0}^n {\\sum\\limits_{j=0}^n{A_i\\,A_j\\,f(x_i,\\,y_j)} } {W_n} = \\sum\\limits_{i=0}^n {\\sum\\limits_{j=0}^n{A_i\\,A_j\\,f(x_i,\\,y_j)} } \u5176\u4e2d x_i,\\,x_j x_i,\\,x_j \u5206\u522b\u4e3a x,\\,y x,\\,y \u65b9\u5411\u7684\u79ef\u5206\u70b9\uff0c A_i A_i \u4e3a\u5bf9\u5e94\u7684\u79ef\u5206\u7cfb\u6570\u3002 \u79ef\u5206\u70b9\u53ca\u6c42\u79ef\u7cfb\u6570\u7684\u6c42\u89e3\u53ef\u4ee5\u53c2\u8003\u76f8\u5173\u6587\u732e\u3002\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u524d2\u9636Gauss-Legendre\u6c42\u79ef\u516c\u5f0f\u7684\u8282\u70b9\u53ca\u7cfb\u6570\uff1a \u9636\u6570 n n \u79ef\u5206\u70b9 \\mathrm{x} \\mathrm{x} \u6c42\u79ef\u7cfb\u6570 \\mathrm{A} \\mathrm{A} 0 0 2 1 \\biggl[-\\dfrac{1}{\\sqrt{3}},\\,\\dfrac{1}{\\sqrt{3}}\\biggr] \\biggl[-\\dfrac{1}{\\sqrt{3}},\\,\\dfrac{1}{\\sqrt{3}}\\biggr] \\biggl[1,\\,1\\biggr] \\biggl[1,\\,1\\biggr] 2 \\biggl[-\\dfrac{\\sqrt{15}}{5},\\,0,\\,\\dfrac{\\sqrt{15}}{5}\\biggr] \\biggl[-\\dfrac{\\sqrt{15}}{5},\\,0,\\,\\dfrac{\\sqrt{15}}{5}\\biggr] \\biggl[\\dfrac{5}{9},\\,\\dfrac{8}{9},\\,\\dfrac{5}{9}\\biggr] \\biggl[\\dfrac{5}{9},\\,\\dfrac{8}{9},\\,\\dfrac{5}{9}\\biggr] \u4ee5\u4e0a\u516c\u5f0f\u5f88\u5bb9\u6613\u7f16\u5199\u4e3aMatlab\u4ee3\u7801\uff0c\u4ee52\u9636\u9ad8\u65af\u79ef\u5206\u4e3a\u4f8b function w = fun_gauss(f) x = [-sqrt(15)/5,0,sqrt(15)/5];y = x; [X,Y] = meshgrid(x,y); a = [5/9,8/9,5/9];b = a; [A,B] = meshgrid(a,b); w = sum(sum(A.*B.*f(X,Y))); \u4e8e\u662f\u5f97\u5230 {W_0} = 4,\\,{W_1} = 1.5188,\\,{W_2} = 1.6234 {W_0} = 4,\\,{W_1} = 1.5188,\\,{W_2} = 1.6234 \u5355\u5143\u79bb\u6563\u540e\u79ef\u5206 \u00b6 \u4e3a\u7b80\u5355\u8d77\u89c1\uff0c\u5c06\u79ef\u5206\u533a\u57df\u79bb\u6563\u4e3a N=n^2 N=n^2 \u4e2a\u9762\u79ef\u76f8\u7b49\u7684\u5c0f\u533a\u57df\uff0c\u5219\u6bcf\u4e2a\u5355\u5143\u7684\u9762\u79ef \\Delta S=\\dfrac{4}{N} \\Delta S=\\dfrac{4}{N} \u3002\u5f53\u5355\u5143 m m \u8db3\u591f\u5c0f\u65f6\uff0c\u53ef\u4ee5\u4ee5\u5355\u51434\u4e2a\u8282\u70b9\u5bf9\u5e94\u51fd\u6570\u503c\u7684\u5e73\u5747\u503c\u6765\u8fd1\u4f3c\u8be5\u5355\u5143\u533a\u57df\u5185\u88ab\u79ef\u51fd\u6570\u503c\uff0c\u4e8e\u662f W W \u53ef\u4ee5\u8868\u793a\u4e3a \\begin{align*} {W_n} &= \\sum_{m=1}^{N} {\\int\\limits_{y_{m-1}}^{y_m} {\\int\\limits_{x_{m-1}}^{x_m}} {f(x,\\,y)\\,\\mathrm{d}x\\mathrm{d}y} } \\\\ &= \\sum_{m=1}^{N} {\\left[{\\frac{1}{4}\\sum_{i=1}^2 {\\sum_{j=1}^2 {f(x_i,\\,y_j)\\,\\Delta S}}} \\right]} \\\\ &= \\Delta S\\,\\sum_{m=1}^{N} {\\sum_{i=1}^2 {\\sum_{j=1}^2 {\\frac{f(x_i,\\,y_j)}{4}} } } \\end{align*} \u5176\u4e2d x_1,\\,x_2 x_1,\\,x_2 \u4e3a\u5355\u5143 m m \u7684\u8282\u70b9\u7684\u4e24\u4e2a\u6a2a\u5750\u6807\u3002 \u4e0a\u5f0f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c06\u533a\u57df\u79bb\u6563\u540e\uff0c\u6bcf\u4e2a\u5355\u5143\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u4e3a\u6700\u7ec8\u7684\u79ef\u5206\u503c\u8d21\u732e\u00bc\u7684\u4f5c\u7528\u3002\u5355\u4ece\u8282\u70b9\u6765\u770b\uff0c\u5185\u5c42\u8282\u70b9\u8d21\u732e\u4e3a1\uff0c\u8fb9\u754c\u8282\u70b9\uff08\u96644\u4e2a\u89d2\u8282\u70b9\u5916\uff09\u8d21\u732e\u00bd\uff0c4\u4e2a\u89d2\u8282\u70b9\u8d21\u732e\u00bc\u3002\u8fd9\u5f88\u5bb9\u6613\u901a\u8fc7Matlab\u7f16\u7a0b\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a function w = fun_trapezoid(n,f) [X,Y] = meshgrid(linspace(-1,1,n)); a = f(X(2:n-1,2:n-1),Y(2:n-1,2:n-1)); b = f(X(1,:),Y(1,:))+f(X(n,:),Y(n,:)); c = f(X(:,1),Y(:,1))+f(X(:,n),Y(:,n)); d = f(X(1,1),Y(1,1))+f(X(1,n),Y(1,n))+f(X(n,1),Y(n,1))+f(X(n,n),Y(n,n)); t = sum(sum(a)) + sum(b)/2 + sum(c)/2 - d/4; w = 4*t/n^2; \u4e8e\u662f\u5f97\u5230 {W_{10}} = 1.2865,\\,{W_{100}} = 1.5886,\\,{W_{5000}} = 1.6205 {W_{10}} = 1.2865,\\,{W_{100}} = 1.5886,\\,{W_{5000}} = 1.6205 \u8fd9\u6837\u7684\u79ef\u5206\u7ed3\u679c\u5dee\u5f3a\u4eba\u610f\uff0c\u5355\u5143\u6570\u8fbe\u5230 5000\u00d75000 \u624d\u52c9\u5f3a\u4fdd\u8bc1\u5c0f\u6570\u70b9\u540e2\u4f4d\u7cbe\u5ea6\u3002 \u4e3a\u4e86\u6539\u5584\u7cbe\u5ea6\uff0c\u5728\u5b50\u57df\u4e0a\u4f7f\u7528Simpson\u6c42\u79ef\u516c\u5f0f\uff0c\u5f97\u5230 \\begin{align*} {W_n} &= \\sum_{m=1}^{N} {\\int\\limits_{y_{m-1}}^{y_m} \\int\\limits_{x_{m-1}}^{x_m} {f(x,\\,y)\\,\\mathrm{d}x\\mathrm{d}y} } \\\\ &= \\sum_{m=1}^{N} {\\left[{\\frac{1}{36} \\sum_{i=1}^3 {\\sum_{j=1}^3 {A_i\\,A_j\\,f(x_i,\\,y_j)\\,\\Delta S}}} \\right]} \\\\ &= \\dfrac{\\Delta S}{36}\\,\\sum_{m=1}^{N} {\\sum_{i=1}^3 {\\sum_{j=1}^3 {A_i\\,A_j\\,f(x_i,\\,y_j)} } } \\end{align*} \u5176\u4e2d x_1,\\,x_2,\\,x_3 x_1,\\,x_2,\\,x_3 \u5206\u522b\u4e3a\u5355\u5143 m m \u8fb9\u754c\u7684\u4e09\u4e2a\u7b49\u5206\u70b9\u7684\u6a2a\u5750\u6807\u3002 A=[1,4,1] A=[1,4,1] \u4e3a\u79ef\u5206\u7cfb\u6570\u3002 Matlab\u4ee3\u7801\u4e3a function w = fun_simpson(n,f) t = 2/n; [A,B] = meshgrid([1,4,1],[1,4,1]); w = 0.0; for i = 0:n^2-1 x = mod(i,n); y = floor(i/n); x = -1 + x*t; y = -1 + y*t; [X,Y] = meshgrid(linspace(x,x+t,3),linspace(y,y+t,3)); w = w + sum(sum(A.*B.*f(X,Y)/(3*n)^2)); end \u6700\u7ec8\u8ba1\u7b97\u7ed3\u679c\u4e3a {W_2} = 1.6285,\\,{W_5} = 1.6213,\\,{W_{10}} = 1.6211 {W_2} = 1.6285,\\,{W_5} = 1.6213,\\,{W_{10}} = 1.6211 \u603b\u7ed3 \u00b6 \u9ad8\u65af\u79ef\u5206\u4ee5\u79ef\u5206\u70b9\u7684\u8ba1\u7b97\u4e3a\u4ee3\u4ef7\u53ef\u4ee5\u5728\u8f83\u5c11\u79ef\u5206\u70b9\u7684\u60c5\u51b5\u4e0b\u83b7\u5f97\u4e00\u5b9a\u7684\u7cbe\u5ea6\uff0c\u800c\u79bb\u6563\u79ef\u5206\u7684\u65b9\u6cd5\u4ee5\u79bb\u6563\u5355\u5143\u6570\u4e3a\u4ee3\u4ef7\u6765\u63d0\u9ad8\u7cbe\u5ea6\uff1b\u4f46\u662f\u7cbe\u5ea6\u4f1a\u56e0\u4e3a\u5b50\u57df\u4e0a\u9009\u53d6\u7684\u79ef\u5206\u65b9\u5f0f\u7684\u4e0d\u540c\u800c\u8868\u73b0\u51fa\u8f83\u5927\u7684\u5dee\u5f02\uff1a\u53ea\u6709\u5355\u5143\u8282\u70b9\u53c2\u4e0e\u8ba1\u7b97\u65f6\uff0c\u7cbe\u5ea6\u76f8\u5bf9\u8f83\u4f4e\uff1b\u5f53\u5355\u5143\u8fb9\u754c\u4e2d\u70b9\u4e5f\u52a0\u5165\u8ba1\u7b97\uff0c\u7cbe\u5ea6\u5f97\u4ee5\u5927\u5e45\u5ea6\u63d0\u9ad8\u3002 \u533a\u57df\u79bb\u6563\u540e\u79ef\u5206\u7684\u65b9\u6cd5\u672c\u8d28\u4e0a\u662f\u590d\u5316\u6c42\u79ef\u6cd5\u3002\u901a\u8fc7\u5212\u5206\u5b50\u533a\u95f4\u5e76\u5728\u5b50\u533a\u95f4\u4e0a\u4f7f\u7528\u4f4e\u9636\u6c42\u79ef\u516c\u5f0f\u6765\u63d0\u9ad8\u7cbe\u5ea6\u5e76\u517c\u987e\u8ba1\u7b97\u590d\u6742\u7a0b\u5ea6\u3002\u7b2c\u4e00\u79cd\u6c42\u79ef\u65b9\u6cd5\u662f\u68af\u5f62\u516c\u5f0f\uff0c\u7b2c\u4e8c\u79cd\u662f\u7cbe\u5ea6\u66f4\u9ad8\u7684Simpson\u516c\u5f0f\uff08\u53732\u9636Newton-Cotes\u516c\u5f0f\uff09\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\u5728\u4e8e\u5f53\u79ef\u5206\u533a\u57df\u6781\u4e0d\u89c4\u5219\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u79bb\u6563\u7684\u65b9\u6cd5\u5728\u5b50\u533a\u95f4\u4e0a\u8fdb\u884c\u79ef\u5206\u5e76\u6700\u7ec8\u7d2f\u52a0\u3002\u4f8b\u5982\u5b9e\u9645\u4e09\u7ef4\u6210\u5f62\u95ee\u9898\uff0c\u7531\u4e8e\u79ef\u5206\u533a\u57df\u65e0\u6cd5\u76f4\u63a5\u5199\u6210\u663e\u5f0f\u7684\u79ef\u5206\u4e0a\u4e0b\u9650\u5f62\u5f0f\uff0c\u56e0\u6b64\u4e5f\u65e0\u6cd5\u76f4\u63a5\u5728\u5168\u57df\u4e0a\u4f7f\u7528\u9ad8\u65af\u6c42\u79ef\u516c\u5f0f\u3002 \u7efc\u5408\u6765\u770b\uff0c\u5728\u4e0a\u9650\u6cd5\u5206\u6790\u6a21\u578b\u4e2d\uff0c\u4e00\u822c\u4e8c\u7ef4\u5373\u5e73\u9762\u5e94\u53d8\u6216\u8f74\u5bf9\u79f0\u6a21\u578b\u7684\u79ef\u5206\u533a\u57df\u662f\u89c4\u5219\u7684\uff0c\u56e0\u6b64\u9ad8\u65af\u79ef\u5206\u6cd5\u76f8\u5bf9\u66f4\u6709\u5e94\u7528\u4f18\u52bf\uff1b\u800c\u4e09\u7ef4\u95ee\u9898\u53d8\u5f62\u533a\u901a\u5e38\u8f83\u4e3a\u590d\u6742\uff0c\u79bb\u6563\u6c42\u79ef\u7684\u65b9\u6cd5\u66f4\u5177\u4f18\u52bf\uff0c\u4e14\u79bb\u6563\u533a\u57df\u4e0a\u7684Simpson\u516c\u5f0f\u4e5f\u53ef\u4ee5\u4fdd\u8bc1\u7cbe\u5ea6\u3002","title":"\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206"},{"location":"2014-11-28-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2014-11-28 | \u5206\u7c7b\uff1a numeric calculation \u4e0a\u9650\u6cd5\u662f\u4e00\u79cd\u89e3\u6790\u65b9\u6cd5\uff0c\u4f46\u6709\u65f6\u5019\u6a21\u578b\u6bd4\u8f83\u590d\u6742\uff0c\u5728\u5851\u6027\u529f\u79ef\u5206\u73af\u8282\u8fd8\u5f97\u6c42\u52a9\u4e8e\u6570\u503c\u79ef\u5206\u3002\u6839\u636e\u79ef\u5206\u65b9\u6cd5\u7684\u4e0d\u540c\uff0c\u5b58\u5728\u4ee5\u4e0b\u4e24\u79cd\u601d\u8def\uff1a \u76f4\u63a5\u8fdb\u884c\u9ad8\u65af\u79ef\u5206 \u5355\u5143\u79bb\u6563\u540e\u8fdb\u884c\u4f4e\u9636\u6570\u503c\u79ef\u5206 \u672c\u6587\u5206\u522b\u4f7f\u7528\u4ee5\u4e0a\u4e24\u79cd\u65b9\u6cd5\u8ba1\u7b97\u4e0b\u9762\u4e8c\u91cd\u79ef\u5206\uff0c\u4ee5\u76f4\u89c2\u8ba4\u8bc6\u53ca\u5206\u6790\u4e8c\u8005\u7684\u533a\u522b\uff1a W = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {f(x,\\,y)}} \\mathrm{d}x\\mathrm{d}y = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {\\cos\\dfrac{\\pi\\,(x + y)}{2}}}\\mathrm{d}x\\mathrm{d}y W = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {f(x,\\,y)}} \\mathrm{d}x\\mathrm{d}y = \\int\\limits_{-1}^1 {\\int\\limits_{-1}^1 {\\cos\\dfrac{\\pi\\,(x + y)}{2}}}\\mathrm{d}x\\mathrm{d}y","title":"\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206"},{"location":"2014-11-28-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/#_2","text":"\\begin{align*} W &= -\\dfrac{2}{\\pi}\\,\\int\\limits_{-1}^1{\\left.{\\sin\\dfrac{\\pi\\,(x+y)}{2}} \\right|_{-1}^1} \\,\\mathrm{d}y\\\\ &= -\\dfrac{2}{\\pi}\\,\\int\\limits_{-1}^1{\\biggl[\\sin\\dfrac{\\pi\\,(y+1)}{2}-\\sin\\dfrac{\\pi\\,(y-1)}{2}\\biggr] }\\,\\mathrm{d}y \\\\ &= -\\frac{4}{\\pi^2}\\left. {\\biggl[ {\\cos\\frac{\\pi\\,(y+1)}{2} - \\cos\\frac{\\pi\\,(y-1)}{2}}\\biggr]}\\right|_{-1}^1 \\\\ &= -\\frac{16}{\\pi ^2} \\approx 1.6211 \\end{align*}","title":"\u7406\u8bba\u89e3"},{"location":"2014-11-28-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/#_3","text":"\u7531\u4e8e\u76ee\u6807\u51fd\u6570\u6070\u597d\u5728Gauss-Legendre\u7684\u6807\u51c6\u79ef\u5206\u533a\u95f4 [-1,1] [-1,1] \uff0c\u53ef\u4ee5\u76f4\u63a5\u53d6\u79ef\u5206\u70b9\u4ee3\u5165\u4e8c\u91cd\u9ad8\u65af\u79ef\u5206\u516c\u5f0f\u3002\u4e8e\u662f W W \u7684 n n \u9636Gauss-Legendre\u79ef\u5206\u8fd1\u4f3c\u503c\u5c31\u53ef\u901a\u8fc7\u4e0b\u5f0f\u6c42\u5f97 {W_n} = \\sum\\limits_{i=0}^n {\\sum\\limits_{j=0}^n{A_i\\,A_j\\,f(x_i,\\,y_j)} } {W_n} = \\sum\\limits_{i=0}^n {\\sum\\limits_{j=0}^n{A_i\\,A_j\\,f(x_i,\\,y_j)} } \u5176\u4e2d x_i,\\,x_j x_i,\\,x_j \u5206\u522b\u4e3a x,\\,y x,\\,y \u65b9\u5411\u7684\u79ef\u5206\u70b9\uff0c A_i A_i \u4e3a\u5bf9\u5e94\u7684\u79ef\u5206\u7cfb\u6570\u3002 \u79ef\u5206\u70b9\u53ca\u6c42\u79ef\u7cfb\u6570\u7684\u6c42\u89e3\u53ef\u4ee5\u53c2\u8003\u76f8\u5173\u6587\u732e\u3002\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u524d2\u9636Gauss-Legendre\u6c42\u79ef\u516c\u5f0f\u7684\u8282\u70b9\u53ca\u7cfb\u6570\uff1a \u9636\u6570 n n \u79ef\u5206\u70b9 \\mathrm{x} \\mathrm{x} \u6c42\u79ef\u7cfb\u6570 \\mathrm{A} \\mathrm{A} 0 0 2 1 \\biggl[-\\dfrac{1}{\\sqrt{3}},\\,\\dfrac{1}{\\sqrt{3}}\\biggr] \\biggl[-\\dfrac{1}{\\sqrt{3}},\\,\\dfrac{1}{\\sqrt{3}}\\biggr] \\biggl[1,\\,1\\biggr] \\biggl[1,\\,1\\biggr] 2 \\biggl[-\\dfrac{\\sqrt{15}}{5},\\,0,\\,\\dfrac{\\sqrt{15}}{5}\\biggr] \\biggl[-\\dfrac{\\sqrt{15}}{5},\\,0,\\,\\dfrac{\\sqrt{15}}{5}\\biggr] \\biggl[\\dfrac{5}{9},\\,\\dfrac{8}{9},\\,\\dfrac{5}{9}\\biggr] \\biggl[\\dfrac{5}{9},\\,\\dfrac{8}{9},\\,\\dfrac{5}{9}\\biggr] \u4ee5\u4e0a\u516c\u5f0f\u5f88\u5bb9\u6613\u7f16\u5199\u4e3aMatlab\u4ee3\u7801\uff0c\u4ee52\u9636\u9ad8\u65af\u79ef\u5206\u4e3a\u4f8b function w = fun_gauss(f) x = [-sqrt(15)/5,0,sqrt(15)/5];y = x; [X,Y] = meshgrid(x,y); a = [5/9,8/9,5/9];b = a; [A,B] = meshgrid(a,b); w = sum(sum(A.*B.*f(X,Y))); \u4e8e\u662f\u5f97\u5230 {W_0} = 4,\\,{W_1} = 1.5188,\\,{W_2} = 1.6234 {W_0} = 4,\\,{W_1} = 1.5188,\\,{W_2} = 1.6234","title":"\u9ad8\u65af\u79ef\u5206"},{"location":"2014-11-28-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/#_4","text":"\u4e3a\u7b80\u5355\u8d77\u89c1\uff0c\u5c06\u79ef\u5206\u533a\u57df\u79bb\u6563\u4e3a N=n^2 N=n^2 \u4e2a\u9762\u79ef\u76f8\u7b49\u7684\u5c0f\u533a\u57df\uff0c\u5219\u6bcf\u4e2a\u5355\u5143\u7684\u9762\u79ef \\Delta S=\\dfrac{4}{N} \\Delta S=\\dfrac{4}{N} \u3002\u5f53\u5355\u5143 m m \u8db3\u591f\u5c0f\u65f6\uff0c\u53ef\u4ee5\u4ee5\u5355\u51434\u4e2a\u8282\u70b9\u5bf9\u5e94\u51fd\u6570\u503c\u7684\u5e73\u5747\u503c\u6765\u8fd1\u4f3c\u8be5\u5355\u5143\u533a\u57df\u5185\u88ab\u79ef\u51fd\u6570\u503c\uff0c\u4e8e\u662f W W \u53ef\u4ee5\u8868\u793a\u4e3a \\begin{align*} {W_n} &= \\sum_{m=1}^{N} {\\int\\limits_{y_{m-1}}^{y_m} {\\int\\limits_{x_{m-1}}^{x_m}} {f(x,\\,y)\\,\\mathrm{d}x\\mathrm{d}y} } \\\\ &= \\sum_{m=1}^{N} {\\left[{\\frac{1}{4}\\sum_{i=1}^2 {\\sum_{j=1}^2 {f(x_i,\\,y_j)\\,\\Delta S}}} \\right]} \\\\ &= \\Delta S\\,\\sum_{m=1}^{N} {\\sum_{i=1}^2 {\\sum_{j=1}^2 {\\frac{f(x_i,\\,y_j)}{4}} } } \\end{align*} \u5176\u4e2d x_1,\\,x_2 x_1,\\,x_2 \u4e3a\u5355\u5143 m m \u7684\u8282\u70b9\u7684\u4e24\u4e2a\u6a2a\u5750\u6807\u3002 \u4e0a\u5f0f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c06\u533a\u57df\u79bb\u6563\u540e\uff0c\u6bcf\u4e2a\u5355\u5143\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u4e3a\u6700\u7ec8\u7684\u79ef\u5206\u503c\u8d21\u732e\u00bc\u7684\u4f5c\u7528\u3002\u5355\u4ece\u8282\u70b9\u6765\u770b\uff0c\u5185\u5c42\u8282\u70b9\u8d21\u732e\u4e3a1\uff0c\u8fb9\u754c\u8282\u70b9\uff08\u96644\u4e2a\u89d2\u8282\u70b9\u5916\uff09\u8d21\u732e\u00bd\uff0c4\u4e2a\u89d2\u8282\u70b9\u8d21\u732e\u00bc\u3002\u8fd9\u5f88\u5bb9\u6613\u901a\u8fc7Matlab\u7f16\u7a0b\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a function w = fun_trapezoid(n,f) [X,Y] = meshgrid(linspace(-1,1,n)); a = f(X(2:n-1,2:n-1),Y(2:n-1,2:n-1)); b = f(X(1,:),Y(1,:))+f(X(n,:),Y(n,:)); c = f(X(:,1),Y(:,1))+f(X(:,n),Y(:,n)); d = f(X(1,1),Y(1,1))+f(X(1,n),Y(1,n))+f(X(n,1),Y(n,1))+f(X(n,n),Y(n,n)); t = sum(sum(a)) + sum(b)/2 + sum(c)/2 - d/4; w = 4*t/n^2; \u4e8e\u662f\u5f97\u5230 {W_{10}} = 1.2865,\\,{W_{100}} = 1.5886,\\,{W_{5000}} = 1.6205 {W_{10}} = 1.2865,\\,{W_{100}} = 1.5886,\\,{W_{5000}} = 1.6205 \u8fd9\u6837\u7684\u79ef\u5206\u7ed3\u679c\u5dee\u5f3a\u4eba\u610f\uff0c\u5355\u5143\u6570\u8fbe\u5230 5000\u00d75000 \u624d\u52c9\u5f3a\u4fdd\u8bc1\u5c0f\u6570\u70b9\u540e2\u4f4d\u7cbe\u5ea6\u3002 \u4e3a\u4e86\u6539\u5584\u7cbe\u5ea6\uff0c\u5728\u5b50\u57df\u4e0a\u4f7f\u7528Simpson\u6c42\u79ef\u516c\u5f0f\uff0c\u5f97\u5230 \\begin{align*} {W_n} &= \\sum_{m=1}^{N} {\\int\\limits_{y_{m-1}}^{y_m} \\int\\limits_{x_{m-1}}^{x_m} {f(x,\\,y)\\,\\mathrm{d}x\\mathrm{d}y} } \\\\ &= \\sum_{m=1}^{N} {\\left[{\\frac{1}{36} \\sum_{i=1}^3 {\\sum_{j=1}^3 {A_i\\,A_j\\,f(x_i,\\,y_j)\\,\\Delta S}}} \\right]} \\\\ &= \\dfrac{\\Delta S}{36}\\,\\sum_{m=1}^{N} {\\sum_{i=1}^3 {\\sum_{j=1}^3 {A_i\\,A_j\\,f(x_i,\\,y_j)} } } \\end{align*} \u5176\u4e2d x_1,\\,x_2,\\,x_3 x_1,\\,x_2,\\,x_3 \u5206\u522b\u4e3a\u5355\u5143 m m \u8fb9\u754c\u7684\u4e09\u4e2a\u7b49\u5206\u70b9\u7684\u6a2a\u5750\u6807\u3002 A=[1,4,1] A=[1,4,1] \u4e3a\u79ef\u5206\u7cfb\u6570\u3002 Matlab\u4ee3\u7801\u4e3a function w = fun_simpson(n,f) t = 2/n; [A,B] = meshgrid([1,4,1],[1,4,1]); w = 0.0; for i = 0:n^2-1 x = mod(i,n); y = floor(i/n); x = -1 + x*t; y = -1 + y*t; [X,Y] = meshgrid(linspace(x,x+t,3),linspace(y,y+t,3)); w = w + sum(sum(A.*B.*f(X,Y)/(3*n)^2)); end \u6700\u7ec8\u8ba1\u7b97\u7ed3\u679c\u4e3a {W_2} = 1.6285,\\,{W_5} = 1.6213,\\,{W_{10}} = 1.6211 {W_2} = 1.6285,\\,{W_5} = 1.6213,\\,{W_{10}} = 1.6211","title":"\u5355\u5143\u79bb\u6563\u540e\u79ef\u5206"},{"location":"2014-11-28-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/#_5","text":"\u9ad8\u65af\u79ef\u5206\u4ee5\u79ef\u5206\u70b9\u7684\u8ba1\u7b97\u4e3a\u4ee3\u4ef7\u53ef\u4ee5\u5728\u8f83\u5c11\u79ef\u5206\u70b9\u7684\u60c5\u51b5\u4e0b\u83b7\u5f97\u4e00\u5b9a\u7684\u7cbe\u5ea6\uff0c\u800c\u79bb\u6563\u79ef\u5206\u7684\u65b9\u6cd5\u4ee5\u79bb\u6563\u5355\u5143\u6570\u4e3a\u4ee3\u4ef7\u6765\u63d0\u9ad8\u7cbe\u5ea6\uff1b\u4f46\u662f\u7cbe\u5ea6\u4f1a\u56e0\u4e3a\u5b50\u57df\u4e0a\u9009\u53d6\u7684\u79ef\u5206\u65b9\u5f0f\u7684\u4e0d\u540c\u800c\u8868\u73b0\u51fa\u8f83\u5927\u7684\u5dee\u5f02\uff1a\u53ea\u6709\u5355\u5143\u8282\u70b9\u53c2\u4e0e\u8ba1\u7b97\u65f6\uff0c\u7cbe\u5ea6\u76f8\u5bf9\u8f83\u4f4e\uff1b\u5f53\u5355\u5143\u8fb9\u754c\u4e2d\u70b9\u4e5f\u52a0\u5165\u8ba1\u7b97\uff0c\u7cbe\u5ea6\u5f97\u4ee5\u5927\u5e45\u5ea6\u63d0\u9ad8\u3002 \u533a\u57df\u79bb\u6563\u540e\u79ef\u5206\u7684\u65b9\u6cd5\u672c\u8d28\u4e0a\u662f\u590d\u5316\u6c42\u79ef\u6cd5\u3002\u901a\u8fc7\u5212\u5206\u5b50\u533a\u95f4\u5e76\u5728\u5b50\u533a\u95f4\u4e0a\u4f7f\u7528\u4f4e\u9636\u6c42\u79ef\u516c\u5f0f\u6765\u63d0\u9ad8\u7cbe\u5ea6\u5e76\u517c\u987e\u8ba1\u7b97\u590d\u6742\u7a0b\u5ea6\u3002\u7b2c\u4e00\u79cd\u6c42\u79ef\u65b9\u6cd5\u662f\u68af\u5f62\u516c\u5f0f\uff0c\u7b2c\u4e8c\u79cd\u662f\u7cbe\u5ea6\u66f4\u9ad8\u7684Simpson\u516c\u5f0f\uff08\u53732\u9636Newton-Cotes\u516c\u5f0f\uff09\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\u5728\u4e8e\u5f53\u79ef\u5206\u533a\u57df\u6781\u4e0d\u89c4\u5219\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u79bb\u6563\u7684\u65b9\u6cd5\u5728\u5b50\u533a\u95f4\u4e0a\u8fdb\u884c\u79ef\u5206\u5e76\u6700\u7ec8\u7d2f\u52a0\u3002\u4f8b\u5982\u5b9e\u9645\u4e09\u7ef4\u6210\u5f62\u95ee\u9898\uff0c\u7531\u4e8e\u79ef\u5206\u533a\u57df\u65e0\u6cd5\u76f4\u63a5\u5199\u6210\u663e\u5f0f\u7684\u79ef\u5206\u4e0a\u4e0b\u9650\u5f62\u5f0f\uff0c\u56e0\u6b64\u4e5f\u65e0\u6cd5\u76f4\u63a5\u5728\u5168\u57df\u4e0a\u4f7f\u7528\u9ad8\u65af\u6c42\u79ef\u516c\u5f0f\u3002 \u7efc\u5408\u6765\u770b\uff0c\u5728\u4e0a\u9650\u6cd5\u5206\u6790\u6a21\u578b\u4e2d\uff0c\u4e00\u822c\u4e8c\u7ef4\u5373\u5e73\u9762\u5e94\u53d8\u6216\u8f74\u5bf9\u79f0\u6a21\u578b\u7684\u79ef\u5206\u533a\u57df\u662f\u89c4\u5219\u7684\uff0c\u56e0\u6b64\u9ad8\u65af\u79ef\u5206\u6cd5\u76f8\u5bf9\u66f4\u6709\u5e94\u7528\u4f18\u52bf\uff1b\u800c\u4e09\u7ef4\u95ee\u9898\u53d8\u5f62\u533a\u901a\u5e38\u8f83\u4e3a\u590d\u6742\uff0c\u79bb\u6563\u6c42\u79ef\u7684\u65b9\u6cd5\u66f4\u5177\u4f18\u52bf\uff0c\u4e14\u79bb\u6563\u533a\u57df\u4e0a\u7684Simpson\u516c\u5f0f\u4e5f\u53ef\u4ee5\u4fdd\u8bc1\u7cbe\u5ea6\u3002","title":"\u603b\u7ed3"},{"location":"2014-12-19-Gauss-Legendre%E4%BA%8C%E9%87%8D%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/","text":"Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206 \u00b6 \u53d1\u5e03\u4e8e\uff1a2014-12-19 | \u5206\u7c7b\uff1a numeric calculation \u6570\u503c\u79ef\u5206\u4e00\u822c\u90fd\u662f\u673a\u68b0\u6c42\u79ef\uff0c\u907f\u5f00\u5bfb\u6c42\u539f\u51fd\u6570\u7684\u56f0\u96be\uff0c\u8f6c\u4e3a\u88ab\u79ef\u51fd\u6570\u503c\u7684\u8ba1\u7b97\u95ee\u9898\u3002\u5bf9\u4e8e\u63d2\u503c\u578b\u7684\u6c42\u79ef\u516c\u5f0f\uff0cn\u9636\u79ef\u5206\uff08n+1\u4e2a\u79ef\u5206\u70b9\uff09\u81f3\u5c11\u5177\u6709n\u9636\u4ee3\u6570\u7cbe\u5ea6\u3002\u5982\u679c\u5bf9\u63d2\u503c\u8282\u70b9\u7684\u9009\u53d6\u4f5c\u51fa\u8981\u6c42\uff0c\u5219\u53ef\u8fdb\u4e00\u6b65\u63d0\u9ad8\u79ef\u5206\u7cbe\u5ea6\u3002 \\int_{a}^{b}f(x)\\mathrm{d}x \\approx \\sum_{k=0}^{n}A_k\\,f(x_k) \\int_{a}^{b}f(x)\\mathrm{d}x \\approx \\sum_{k=0}^{n}A_k\\,f(x_k) \u4f8b\u5982\uff0c\u7b49\u8ddd\u9009\u53d6\u79ef\u5206\u70b9\u5219\u5f97\u5230 \u725b\u987f-\u79d1\u65af\u7279\uff08Newton-Cotes\uff09 \u516c\u5f0f\u3002\u7279\u522b\u5730\uff0c1\uff0c2\u9636\u7684\u725b\u987f-\u79d1\u65af\u7279\u516c\u5f0f\u5206\u522b\u662f\u5e38\u7528\u7684 \u68af\u5f62\u516c\u5f0f \u548c \u8f9b\u666e\u68ee\uff08Simpson\uff09 \u516c\u5f0f\u3002\u7531\u4e8e\u79ef\u5206\u70b9\u4f5c\u4e86\u7b49\u8ddd\u7684\u8981\u6c42\uff0c\u4f5c\u4e3a\u56de\u62a5\uff0c\u5f53\u9636\u6570n\u4e3a\u5076\u6570\u65f6\uff0c\u725b\u987f-\u79d1\u65af\u7279\u516c\u5f0f\u81f3\u5c11\u5177\u6709n+1\u6b21\u4ee3\u6570\u7cbe\u5ea6\u3002 \u4e0d\u8fc7\uff0c\u5f53\u9636\u6570\u8f83\u5927\uff08n \\ge \\ge 8\uff09\u65f6\uff0c\u79ef\u5206\u7cfb\u6570\u4f1a\u51fa\u73b0\u8d1f\u503c\uff0c\u5373\u8ba1\u7b97\u4e0d\u5177\u6709\u7a33\u5b9a\u6027\u3002\u6240\u4ee5\u53c8\u5f15\u8fdb\u4e86\u590d\u5316\u6c42\u79ef\u516c\u5f0f\u2014\u2014\u628a\u79ef\u5206\u533a\u95f4\u5212\u5206\u4e3a\u82e5\u5e72\u5b50\u533a\u95f4\uff0c\u518d\u5728\u6bcf\u4e2a\u5b50\u533a\u95f4\u91c7\u7528\u4f4e\u9636\u7684\u6c42\u79ef\u516c\u5f0f\u3002 \u518d\u5982\uff0c \u9ad8\u65af\u79ef\u5206\u516c\u5f0f \u5bf9\u79ef\u5206\u70b9\u7684\u9009\u53d6\u91c7\u7528\u4e86\u66f4\u9ad8\u7684\u8981\u6c42\u2014\u2014\u4ee5\u79ef\u5206\u70b9 x_0,x_1,\\cdots,x_n x_0,x_1,\\cdots,x_n \u4e3a\u96f6\u70b9\u7684\u591a\u9879\u5f0f \\omega_{n+1}(x) \\omega_{n+1}(x) \u6ee1\u8db3\uff1a\u4e0e\u4efb\u4f55\u6b21\u6570\u4e0d\u8d85\u8fc7n\u7684\u591a\u9879\u5f0f p_k(x) p_k(x) \u5e26\u6743\u6b63\u4ea4\u3002 \u76f8\u5e94\u7684\u56de\u62a5\u662f\uff1a n \u9636\u9ad8\u65af\u79ef\u5206\u516c\u5f0f\u5177\u6709 2n+1 \u6b21\u4ee3\u6570\u7cbe\u5ea6\u3002 a \\le x_0 \\le x_1 \\le \\cdots \\le x_n \\le b a \\le x_0 \\le x_1 \\le \\cdots \\le x_n \\le b \\omega_{n+1}(x) = (x-x_0)(x-x_1)\\cdots(x-x_n) \\omega_{n+1}(x) = (x-x_0)(x-x_1)\\cdots(x-x_n) p_k(x) = a_k x^k + a_{k-1} x^{k-1} + \\cdots + a_0 \\,\\,\\,(k \\le n) p_k(x) = a_k x^k + a_{k-1} x^{k-1} + \\cdots + a_0 \\,\\,\\,(k \\le n) \\int_{a}^{b}p_k(x) \\omega_{n+1}(x) \\rho(x) \\mathrm{d}x = 0 \\int_{a}^{b}p_k(x) \\omega_{n+1}(x) \\rho(x) \\mathrm{d}x = 0 Gauss-Legendre\u6c42\u79ef\u516c\u5f0f \u00b6 \u9009\u53d6\u4e0d\u540c\u7684\u6743\u7cfb\u6570\u53ca\u79ef\u5206\u533a\u95f4\uff0c\u53ef\u4ee5\u5f97\u5230\u4e0d\u540c\u7684\u9ad8\u65af\u578b\u6c42\u79ef\u516c\u5f0f\u3002 Legendre \u591a\u9879\u5f0f\u662f\u533a\u95f4 [-1,1] [-1,1] \uff0c\u6743\u51fd\u6570 \\rho(x)=1 \\rho(x)=1 \u65f6\uff0c \\lbrace 1,x,\\cdots,x^n,\\cdots\\rbrace \\lbrace 1,x,\\cdots,x^n,\\cdots\\rbrace \u6b63\u4ea4\u5316\u5f97\u5230\u7684\u591a\u9879\u5f0f\uff0c\u56e0\u6b64\u5176\u96f6\u70b9\u5373\u4e3a\u9ad8\u65af\u79ef\u5206\u70b9\u3002\u540c\u7406\uff0c Chebyshev \u591a\u9879\u5f0f\u7684\u96f6\u70b9\u662f\u53e6\u4e00\u7c7b\u9ad8\u65af\u578b\u6c42\u79ef\u516c\u5f0f\u7684\u79ef\u5206\u70b9\u3002 Gauss-Legendre \u6c42\u79ef\u516c\u5f0f\u8868\u793a\u4e3a\uff1a \\int_{-1}^{1} f(x) \\mathrm{d}x \\approx \\sum_{k=0}^n A_k\\,f(x_k) \\int_{-1}^{1} f(x) \\mathrm{d}x \\approx \\sum_{k=0}^n A_k\\,f(x_k) \u5176\u4e2d\uff0c x_k x_k \u662fn+1\u6b21 Legendre \u591a\u9879\u5f0f P_n(x) P_n(x) P_n(x) = \\frac{1}{2^n\\,n!}\\,\\frac{\\mathrm{d}^n}{\\mathrm{d}x^n}(x^2-1)^n \\quad n=0,1,2,\\cdots P_n(x) = \\frac{1}{2^n\\,n!}\\,\\frac{\\mathrm{d}^n}{\\mathrm{d}x^n}(x^2-1)^n \\quad n=0,1,2,\\cdots \u7684\u96f6\u70b9\u3002 Gauss-Legendre \u6570\u503c\u79ef\u5206\u7684\u601d\u8def\u540c\u6837\u4e3a\uff1a\u6c42\u89e3\u79ef\u5206\u70b9\u548c\u79ef\u5206\u7cfb\u6570\uff0c\u7136\u540e\u4ee3\u5165\u516c\u5f0f\u6c42\u548c\u3002 \u79ef\u5206\u70b9\u53ef\u4ee5\u901a\u8fc7\u6c42\u89e3 Legendre \u591a\u9879\u5f0f\u7684\u96f6\u70b9\u5f97\u5230\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662fn\u9636 gauss-Legendre \u516c\u5f0f\u7684\u79ef\u5206\u70b9\u662fn+1\u9636 Legendre \u591a\u9879\u5f0f\u7684\u96f6\u70b9\u3002 \u6839\u636e\u5b9a\u4e49\uff0c\u79ef\u5206\u7cfb\u6570\u53ef\u4ee5\u901a\u8fc7\u4f9d\u6b21\u4ee3\u5165\u88ab\u79ef\u51fd\u6570 x^k\\,\\,(k=0,1,2,\\cdots,2n+1) x^k\\,\\,(k=0,1,2,\\cdots,2n+1) \uff0c\u6c42\u89e3\u4ee3\u6570\u65b9\u7a0b\u7ec4\u5f97\u5230\u3002\u7136\u800c\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u8f83\u4e3a\u590d\u6742\uff0c\u4e00\u822c\u63a8\u8350\u4ee5\u4e0b\u4fbf\u4e8e\u8ba1\u7b97\u673a\u8ba1\u7b97\u7684\u65b9\u6cd5\uff1a \u6c42\u89e3\u7b2c k k \u4e2a\u79ef\u5206\u7cfb\u6570 A_k A_k \u65f6\uff0c\u6784\u9020\u88ab\u79ef\u51fd\u6570\uff1a \\begin{align*} f_k(x) &= \\frac{(x-x_0)(x-x_1)\\cdots(x-x_{k-1})(x-x_{k+1})\\cdots(x-x_n)}{(x_k-x_0)(x_k-x_1)\\cdots(x_k-x_{k-1})(x_k-x_{k+1})\\cdots(x_k-x_n)} \\\\ &= \\frac{\\omega_{n+1}(x)}{(x-x_k)\\,\\omega'_{n+1}(x_k)} \\end{align*} \u663e\u7136\u8be5\u51fd\u6570\u5728 x_k x_k \u70b9\u7684\u51fd\u6570\u503c\u4e3a1\uff0c\u5728\u5176\u4ed6\u79ef\u5206\u70b9\u4e0a\u7684\u51fd\u6570\u503c\u4e3a0\uff0c\u4e8e\u662f\u8fdb\u884c\u591a\u9879\u5f0f\u79ef\u5206\u5c31\u53ef\u4ee5\u5f97\u5230\u79ef\u5206\u7cfb\u6570 A_k = \\sum_{k=0}^{n}A_k\\,f(x_k) = \\int_{a}^{b}f_k(x)\\,\\mathrm{d}x A_k = \\sum_{k=0}^{n}A_k\\,f(x_k) = \\int_{a}^{b}f_k(x)\\,\\mathrm{d}x \u53e6\u5916\uff0c\u9700\u8981\u901a\u8fc7\u6362\u5143\uff0c\u5c06 Legendre \u591a\u9879\u5f0f\u7684\u6807\u51c6\u79ef\u5206\u533a\u95f4 [-1,1] [-1,1] \u8f6c\u6362\u5230\u4e00\u822c\u79ef\u5206\u533a\u95f4 [a,b] [a,b] \uff1a \\int_{a}^{b}f(x)\\mathrm{d}x = \\frac{b-a}{2}\\,\\int_{-1}^{1}f\\left(\\frac{b-a}{2}\\,t + \\frac{b+a}{2}\\right)\\mathrm{d}t \\int_{a}^{b}f(x)\\mathrm{d}x = \\frac{b-a}{2}\\,\\int_{-1}^{1}f\\left(\\frac{b-a}{2}\\,t + \\frac{b+a}{2}\\right)\\mathrm{d}t Gauss-Legendre\u4e8c\u91cd\u79ef\u5206 \u00b6 \u4ee5\u4e0a\u662f Gauss-Legendre \u6570\u503c\u79ef\u5206\u7684\u57fa\u672c\u539f\u7406\uff0c\u5bf9\u6bcf\u4e00\u5c42\u79ef\u5206\u5206\u522b\u4f7f\u7528\u4e0a\u8ff0\u8fc7\u7a0b\u5373\u53ef\u63a8\u5e7f\u81f3\u4e00\u822c\u533a\u95f4\u4e0a\u4e8c\u91cd\u79ef\u5206\u7684\u8ba1\u7b97\u3002 \\begin{align*} &\\quad\\int_a^b \\!\\! \\int_{c(x)}^{d(x)}\\,f(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\\\ &= \\int_a^b\\!\\! {\\int_{-1}^{1}\\,\\frac{d(x)-c(x)}{2}\\, f\\left(x,\\frac{d(x)-c(x)}{2}\\,v + \\frac{d(x)+c(x)}{2}\\right)\\mathrm{d}v\\,\\mathrm{d}x} \\\\ &\\approx \\int_a^b \\sum_{i=0}^n \\left[A_i\\,\\frac{d(x)-c(x)}{2}\\,f\\left(x,\\frac{d(x)-c(x)}{2}\\,v_i + \\frac{d(x)+c(x)}{2}\\right)\\right] \\mathrm{d}x \\\\ &= \\sum_{i=0}^{n} \\left[A_i\\int_a^b \\alpha(x)\\,f\\left(x,\\alpha(x)v_i+\\beta(x)\\right)\\mathrm{d}x\\right] \\\\ &= \\sum_{i=0}^n \\left[A_i\\int_{-1}^1 \\frac{b-a}{2} \\alpha\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2}\\right)\\,f\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2},\\alpha\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2}\\right)v_i+\\beta\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2}\\right)\\right)\\mathrm{d}u\\right] \\\\ &\\approx \\sum_{i=0}^n \\left[A_i \\sum_{j=0}^m B_j \\frac{b-a}{2} \\alpha\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2}\\right)\\,f\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2},\\alpha\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2}\\right)v_i+\\beta\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2}\\right)\\right)\\right] \\\\ &= \\frac{b-a}{2}\\,\\sum_{i=0}^n \\sum_{j=0}^m A_i\\,B_j\\,\\alpha(U_j)\\,f(U_j,V_{ji}) \\end{align*} \u5176\u4e2d\uff0c \\begin{align*} \\alpha(x) &= \\frac{d(x)-c(x)}{2} \\\\ \\beta(x) &= \\frac{d(x)+c(x)}{2} \\end{align*} \\begin{align*} U_j &= \\frac{b-a}{2}\\,u_j + \\frac{b+a}{2} \\\\ V_{ji} &= \\alpha(U_j)\\,v_i + \\beta(U_j) \\end{align*} v_i, \\, u_j v_i, \\, u_j \u5206\u522b\u662f y,\\, x y,\\, x \u65b9\u5411\u5728\u6807\u51c6\u533a\u95f4\u7684\u79ef\u5206\u70b9\uff0c n,\\,m n,\\,m \u5206\u522b\u662f\u8fd9\u4e24\u4e2a\u65b9\u5411\u7684\u79ef\u5206\u70b9\u4e2a\u6570\u3002 Matlab\u5b9e\u73b0 \u00b6 \u4ee5\u4e0a\u4e24\u8282\u4ecb\u7ecd\u4e86 Gauss-Legendre \u6570\u503c\u79ef\u5206\u4e2d\u79ef\u5206\u70b9\u3001\u79ef\u5206\u7cfb\u6570\u7684\u6c42\u89e3\u65b9\u6cd5\uff0c\u4ee5\u53ca\u4e8c\u91cd\u79ef\u5206\u7684\u8ba1\u7b97\u65b9\u6848\uff0c\u63a5\u4e0b\u6765\u4f7f\u7528Matlab\u5b9e\u73b0\u4ee5\u4e0a\u8fc7\u7a0b\u3002\u4e3a\u51cf\u5c0f\u53c2\u6570\u4e2a\u6570\uff0c\u5047\u8bbe\u4e24\u4e2a\u65b9\u5411\u7684\u79ef\u5206\u70b9\u6570\u76f8\u540c\uff0c\u5373\u4e4b\u524d\u5f0f\u5b50\u4e2d m=n m=n \u3002 function res = guasslegendre(fun, a, b, c, d, n) % ----------------------------------------------------------------------- % Gauss-Legendre\u6570\u503c\u79ef\u5206\u8ba1\u7b97\u4e8c\u91cd\u79ef\u5206 % \u53c2\u6570\u8bf4\u660e % fun\uff1a\u79ef\u5206\u8868\u8fbe\u5f0f\u51fd\u6570\u53e5\u67c4 fun=@(x,y)f(x,y) % a,b\uff1a\u5916\u5c42\u79ef\u5206\u533a\u95f4\uff0c\u5e38\u6570 % c,d\uff1a\u5185\u5c42\u79ef\u5206\u533a\u95f4\uff0c\u51fd\u6570\u53e5\u67c4 c=@(x)c(x), d=@(x)d(x) % n \uff1a\u79ef\u5206\u9636\u6570 % \u8f93\u51fa\u7ed3\u679c % res\uff1a\u79ef\u5206\u7ed3\u679c % ----------------------------------------------------------------------- % 1 \u8ba1\u7b97\u79ef\u5206\u70b9 syms x p = sym2poly(diff((x^2-1)^(n+1),n+1)); u = roots(p); % 2 \u8ba1\u7b97\u6c42\u79ef\u7cfb\u6570 Ak = zeros(n+1,1); for i=1:n+1 t = u; t(i) = []; pn = poly(t); fp = @(x)polyval(pn,x)/polyval(pn,u(i)); Ak(i)=integral(fp,-1,1); end % 3 \u53d8\u91cf\u4ee3\u6362 fa = @(x) (d(x)-c(x))/2.0; fb = @(x) (d(x)+c(x))/2.0; % 4 \u673a\u68b0\u6c42\u79ef [X,Y] = meshgrid(u,u); [A,B] = meshgrid(Ak,Ak); U = (b-a)/2.0*X + (b+a)/2.0; V = fa(U).*Y + fb(U); w = A.*B.*fa(U).*fun(U,V); res = (b-a)/2.0*sum(w(:)); \u4f5c\u4e3a\u6d4b\u8bd5\uff0c\u5206\u522b\u4f7f\u7528\u4ee5\u4e0a\u4ee3\u7801\u53caMatlab\u81ea\u5e26\u7684\u6570\u503c\u79ef\u5206\u51fd\u6570 integral2 \u5bf9\u4e0b\u9762\u4e8c\u91cd\u79ef\u5206\u8fdb\u884c\u8ba1\u7b97\uff1a I = \\int_{-1}^1\\!\\!\\int_x^{\\mathrm{e}^{x^2}}\\,e^{-\\left(x^2+y^2\\right)}\\,\\mathrm{d}y\\,\\mathrm{d}x I = \\int_{-1}^1\\!\\!\\int_x^{\\mathrm{e}^{x^2}}\\,e^{-\\left(x^2+y^2\\right)}\\,\\mathrm{d}y\\,\\mathrm{d}x \u9636\u6570 n n \u8ba1\u7b97\u503c 5 1.206565488320687 7 1.206561262089404 11 1.206561581890236 \u8868\u4e2d\u6570\u636e\u4e3a\u4ee5\u4e0a\u4ee3\u7801\u7684\u8ba1\u7b97\u503c\uff0c integral2 \u8ba1\u7b97\u503c\u4e3a\uff1a 1.206561586856674 1.206561586856674 \u3002\u7531\u4e8e\u79ef\u5206\u533a\u95f4\u6b63\u662f\u6807\u51c6\u7684 [-1,1] [-1,1] \uff0c5\u9636Gauss-Legendre\u6570\u503c\u79ef\u5206\u5373 6\\times6 6\\times6 \u4e2a\u79ef\u5206\u70b9\u5c31\u53ef\u5c06\u8bef\u5dee\u63a7\u5236\u5728 10^{-5} 10^{-5} \u4ee5\u4e0b\u3002 \u4e0d\u8fc7\uff0c\u4ee5\u4e0a\u4ee3\u7801\u4ec5\u4ec5\u662f Gauss-Legendre \u6570\u503c\u79ef\u5206\u57fa\u672c\u539f\u7406\u7684\u5b9e\u73b0\uff0c\u82e5\u60f3\u7528\u4e8e\u5b9e\u9645\u95ee\u9898\uff0c\u5c1a\u9700\u8fdb\u4e00\u6b65\u7684\u6539\u8fdb\u3002\u5f53\u79ef\u5206\u533a\u95f4\u8de8\u5ea6\u589e\u5927\u65f6\uff0c\u5176\u8ba1\u7b97\u7cbe\u5ea6\u5c06\u6025\u5267\u4e0b\u964d\uff0c\u4f8b\u5982\u4e0a\u8ff0\u79ef\u5206\u5728 [-2,11] [-2,11] \u533a\u95f4\u8fdb\u884c\u65f6\uff0c\u8ba1\u7b97\u7ed3\u679c\u5982\u4e0b\uff1a >> fun=@(x,y)exp(-x.^2-y.^2); >> integral2(fun,-2,11,@(x)x,@(x)exp(x.^2)) ans = 1.446305300237306 >> guasslegendre(fun,-2,11,@(x)x,@(x)exp(x.^2),11) ans = 1.467184820337763 \u6539\u8fdb\u7684\u65b9\u5411 \u00b6 \u6b63\u662f\u4e00\u5f00\u59cb\u63d0\u5230\u7684\uff1a \u590d\u5316\u6c42\u79ef \u65b9\u6cd5\u2014\u2014\u628a\u79ef\u5206\u533a\u95f4\u5212\u5206\u4e3a\u82e5\u5e72\u5b50\u533a\u95f4\uff0c\u518d\u5728\u6bcf\u4e2a\u5b50\u533a\u95f4\u91c7\u7528\u4f4e\u9636\u7684\u6c42\u79ef\u516c\u5f0f\u3002 \u5177\u4f53\u5b9e\u8df5\u7559\u5f85\u540e\u7eed\u3002","title":"Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206"},{"location":"2014-12-19-Gauss-Legendre%E4%BA%8C%E9%87%8D%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/#gauss legendre","text":"\u53d1\u5e03\u4e8e\uff1a2014-12-19 | \u5206\u7c7b\uff1a numeric calculation \u6570\u503c\u79ef\u5206\u4e00\u822c\u90fd\u662f\u673a\u68b0\u6c42\u79ef\uff0c\u907f\u5f00\u5bfb\u6c42\u539f\u51fd\u6570\u7684\u56f0\u96be\uff0c\u8f6c\u4e3a\u88ab\u79ef\u51fd\u6570\u503c\u7684\u8ba1\u7b97\u95ee\u9898\u3002\u5bf9\u4e8e\u63d2\u503c\u578b\u7684\u6c42\u79ef\u516c\u5f0f\uff0cn\u9636\u79ef\u5206\uff08n+1\u4e2a\u79ef\u5206\u70b9\uff09\u81f3\u5c11\u5177\u6709n\u9636\u4ee3\u6570\u7cbe\u5ea6\u3002\u5982\u679c\u5bf9\u63d2\u503c\u8282\u70b9\u7684\u9009\u53d6\u4f5c\u51fa\u8981\u6c42\uff0c\u5219\u53ef\u8fdb\u4e00\u6b65\u63d0\u9ad8\u79ef\u5206\u7cbe\u5ea6\u3002 \\int_{a}^{b}f(x)\\mathrm{d}x \\approx \\sum_{k=0}^{n}A_k\\,f(x_k) \\int_{a}^{b}f(x)\\mathrm{d}x \\approx \\sum_{k=0}^{n}A_k\\,f(x_k) \u4f8b\u5982\uff0c\u7b49\u8ddd\u9009\u53d6\u79ef\u5206\u70b9\u5219\u5f97\u5230 \u725b\u987f-\u79d1\u65af\u7279\uff08Newton-Cotes\uff09 \u516c\u5f0f\u3002\u7279\u522b\u5730\uff0c1\uff0c2\u9636\u7684\u725b\u987f-\u79d1\u65af\u7279\u516c\u5f0f\u5206\u522b\u662f\u5e38\u7528\u7684 \u68af\u5f62\u516c\u5f0f \u548c \u8f9b\u666e\u68ee\uff08Simpson\uff09 \u516c\u5f0f\u3002\u7531\u4e8e\u79ef\u5206\u70b9\u4f5c\u4e86\u7b49\u8ddd\u7684\u8981\u6c42\uff0c\u4f5c\u4e3a\u56de\u62a5\uff0c\u5f53\u9636\u6570n\u4e3a\u5076\u6570\u65f6\uff0c\u725b\u987f-\u79d1\u65af\u7279\u516c\u5f0f\u81f3\u5c11\u5177\u6709n+1\u6b21\u4ee3\u6570\u7cbe\u5ea6\u3002 \u4e0d\u8fc7\uff0c\u5f53\u9636\u6570\u8f83\u5927\uff08n \\ge \\ge 8\uff09\u65f6\uff0c\u79ef\u5206\u7cfb\u6570\u4f1a\u51fa\u73b0\u8d1f\u503c\uff0c\u5373\u8ba1\u7b97\u4e0d\u5177\u6709\u7a33\u5b9a\u6027\u3002\u6240\u4ee5\u53c8\u5f15\u8fdb\u4e86\u590d\u5316\u6c42\u79ef\u516c\u5f0f\u2014\u2014\u628a\u79ef\u5206\u533a\u95f4\u5212\u5206\u4e3a\u82e5\u5e72\u5b50\u533a\u95f4\uff0c\u518d\u5728\u6bcf\u4e2a\u5b50\u533a\u95f4\u91c7\u7528\u4f4e\u9636\u7684\u6c42\u79ef\u516c\u5f0f\u3002 \u518d\u5982\uff0c \u9ad8\u65af\u79ef\u5206\u516c\u5f0f \u5bf9\u79ef\u5206\u70b9\u7684\u9009\u53d6\u91c7\u7528\u4e86\u66f4\u9ad8\u7684\u8981\u6c42\u2014\u2014\u4ee5\u79ef\u5206\u70b9 x_0,x_1,\\cdots,x_n x_0,x_1,\\cdots,x_n \u4e3a\u96f6\u70b9\u7684\u591a\u9879\u5f0f \\omega_{n+1}(x) \\omega_{n+1}(x) \u6ee1\u8db3\uff1a\u4e0e\u4efb\u4f55\u6b21\u6570\u4e0d\u8d85\u8fc7n\u7684\u591a\u9879\u5f0f p_k(x) p_k(x) \u5e26\u6743\u6b63\u4ea4\u3002 \u76f8\u5e94\u7684\u56de\u62a5\u662f\uff1a n \u9636\u9ad8\u65af\u79ef\u5206\u516c\u5f0f\u5177\u6709 2n+1 \u6b21\u4ee3\u6570\u7cbe\u5ea6\u3002 a \\le x_0 \\le x_1 \\le \\cdots \\le x_n \\le b a \\le x_0 \\le x_1 \\le \\cdots \\le x_n \\le b \\omega_{n+1}(x) = (x-x_0)(x-x_1)\\cdots(x-x_n) \\omega_{n+1}(x) = (x-x_0)(x-x_1)\\cdots(x-x_n) p_k(x) = a_k x^k + a_{k-1} x^{k-1} + \\cdots + a_0 \\,\\,\\,(k \\le n) p_k(x) = a_k x^k + a_{k-1} x^{k-1} + \\cdots + a_0 \\,\\,\\,(k \\le n) \\int_{a}^{b}p_k(x) \\omega_{n+1}(x) \\rho(x) \\mathrm{d}x = 0 \\int_{a}^{b}p_k(x) \\omega_{n+1}(x) \\rho(x) \\mathrm{d}x = 0","title":"Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206"},{"location":"2014-12-19-Gauss-Legendre%E4%BA%8C%E9%87%8D%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/#gauss-legendre","text":"\u9009\u53d6\u4e0d\u540c\u7684\u6743\u7cfb\u6570\u53ca\u79ef\u5206\u533a\u95f4\uff0c\u53ef\u4ee5\u5f97\u5230\u4e0d\u540c\u7684\u9ad8\u65af\u578b\u6c42\u79ef\u516c\u5f0f\u3002 Legendre \u591a\u9879\u5f0f\u662f\u533a\u95f4 [-1,1] [-1,1] \uff0c\u6743\u51fd\u6570 \\rho(x)=1 \\rho(x)=1 \u65f6\uff0c \\lbrace 1,x,\\cdots,x^n,\\cdots\\rbrace \\lbrace 1,x,\\cdots,x^n,\\cdots\\rbrace \u6b63\u4ea4\u5316\u5f97\u5230\u7684\u591a\u9879\u5f0f\uff0c\u56e0\u6b64\u5176\u96f6\u70b9\u5373\u4e3a\u9ad8\u65af\u79ef\u5206\u70b9\u3002\u540c\u7406\uff0c Chebyshev \u591a\u9879\u5f0f\u7684\u96f6\u70b9\u662f\u53e6\u4e00\u7c7b\u9ad8\u65af\u578b\u6c42\u79ef\u516c\u5f0f\u7684\u79ef\u5206\u70b9\u3002 Gauss-Legendre \u6c42\u79ef\u516c\u5f0f\u8868\u793a\u4e3a\uff1a \\int_{-1}^{1} f(x) \\mathrm{d}x \\approx \\sum_{k=0}^n A_k\\,f(x_k) \\int_{-1}^{1} f(x) \\mathrm{d}x \\approx \\sum_{k=0}^n A_k\\,f(x_k) \u5176\u4e2d\uff0c x_k x_k \u662fn+1\u6b21 Legendre \u591a\u9879\u5f0f P_n(x) P_n(x) P_n(x) = \\frac{1}{2^n\\,n!}\\,\\frac{\\mathrm{d}^n}{\\mathrm{d}x^n}(x^2-1)^n \\quad n=0,1,2,\\cdots P_n(x) = \\frac{1}{2^n\\,n!}\\,\\frac{\\mathrm{d}^n}{\\mathrm{d}x^n}(x^2-1)^n \\quad n=0,1,2,\\cdots \u7684\u96f6\u70b9\u3002 Gauss-Legendre \u6570\u503c\u79ef\u5206\u7684\u601d\u8def\u540c\u6837\u4e3a\uff1a\u6c42\u89e3\u79ef\u5206\u70b9\u548c\u79ef\u5206\u7cfb\u6570\uff0c\u7136\u540e\u4ee3\u5165\u516c\u5f0f\u6c42\u548c\u3002 \u79ef\u5206\u70b9\u53ef\u4ee5\u901a\u8fc7\u6c42\u89e3 Legendre \u591a\u9879\u5f0f\u7684\u96f6\u70b9\u5f97\u5230\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662fn\u9636 gauss-Legendre \u516c\u5f0f\u7684\u79ef\u5206\u70b9\u662fn+1\u9636 Legendre \u591a\u9879\u5f0f\u7684\u96f6\u70b9\u3002 \u6839\u636e\u5b9a\u4e49\uff0c\u79ef\u5206\u7cfb\u6570\u53ef\u4ee5\u901a\u8fc7\u4f9d\u6b21\u4ee3\u5165\u88ab\u79ef\u51fd\u6570 x^k\\,\\,(k=0,1,2,\\cdots,2n+1) x^k\\,\\,(k=0,1,2,\\cdots,2n+1) \uff0c\u6c42\u89e3\u4ee3\u6570\u65b9\u7a0b\u7ec4\u5f97\u5230\u3002\u7136\u800c\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u8f83\u4e3a\u590d\u6742\uff0c\u4e00\u822c\u63a8\u8350\u4ee5\u4e0b\u4fbf\u4e8e\u8ba1\u7b97\u673a\u8ba1\u7b97\u7684\u65b9\u6cd5\uff1a \u6c42\u89e3\u7b2c k k \u4e2a\u79ef\u5206\u7cfb\u6570 A_k A_k \u65f6\uff0c\u6784\u9020\u88ab\u79ef\u51fd\u6570\uff1a \\begin{align*} f_k(x) &= \\frac{(x-x_0)(x-x_1)\\cdots(x-x_{k-1})(x-x_{k+1})\\cdots(x-x_n)}{(x_k-x_0)(x_k-x_1)\\cdots(x_k-x_{k-1})(x_k-x_{k+1})\\cdots(x_k-x_n)} \\\\ &= \\frac{\\omega_{n+1}(x)}{(x-x_k)\\,\\omega'_{n+1}(x_k)} \\end{align*} \u663e\u7136\u8be5\u51fd\u6570\u5728 x_k x_k \u70b9\u7684\u51fd\u6570\u503c\u4e3a1\uff0c\u5728\u5176\u4ed6\u79ef\u5206\u70b9\u4e0a\u7684\u51fd\u6570\u503c\u4e3a0\uff0c\u4e8e\u662f\u8fdb\u884c\u591a\u9879\u5f0f\u79ef\u5206\u5c31\u53ef\u4ee5\u5f97\u5230\u79ef\u5206\u7cfb\u6570 A_k = \\sum_{k=0}^{n}A_k\\,f(x_k) = \\int_{a}^{b}f_k(x)\\,\\mathrm{d}x A_k = \\sum_{k=0}^{n}A_k\\,f(x_k) = \\int_{a}^{b}f_k(x)\\,\\mathrm{d}x \u53e6\u5916\uff0c\u9700\u8981\u901a\u8fc7\u6362\u5143\uff0c\u5c06 Legendre \u591a\u9879\u5f0f\u7684\u6807\u51c6\u79ef\u5206\u533a\u95f4 [-1,1] [-1,1] \u8f6c\u6362\u5230\u4e00\u822c\u79ef\u5206\u533a\u95f4 [a,b] [a,b] \uff1a \\int_{a}^{b}f(x)\\mathrm{d}x = \\frac{b-a}{2}\\,\\int_{-1}^{1}f\\left(\\frac{b-a}{2}\\,t + \\frac{b+a}{2}\\right)\\mathrm{d}t \\int_{a}^{b}f(x)\\mathrm{d}x = \\frac{b-a}{2}\\,\\int_{-1}^{1}f\\left(\\frac{b-a}{2}\\,t + \\frac{b+a}{2}\\right)\\mathrm{d}t","title":"Gauss-Legendre\u6c42\u79ef\u516c\u5f0f"},{"location":"2014-12-19-Gauss-Legendre%E4%BA%8C%E9%87%8D%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/#gauss-legendre_1","text":"\u4ee5\u4e0a\u662f Gauss-Legendre \u6570\u503c\u79ef\u5206\u7684\u57fa\u672c\u539f\u7406\uff0c\u5bf9\u6bcf\u4e00\u5c42\u79ef\u5206\u5206\u522b\u4f7f\u7528\u4e0a\u8ff0\u8fc7\u7a0b\u5373\u53ef\u63a8\u5e7f\u81f3\u4e00\u822c\u533a\u95f4\u4e0a\u4e8c\u91cd\u79ef\u5206\u7684\u8ba1\u7b97\u3002 \\begin{align*} &\\quad\\int_a^b \\!\\! \\int_{c(x)}^{d(x)}\\,f(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\\\ &= \\int_a^b\\!\\! {\\int_{-1}^{1}\\,\\frac{d(x)-c(x)}{2}\\, f\\left(x,\\frac{d(x)-c(x)}{2}\\,v + \\frac{d(x)+c(x)}{2}\\right)\\mathrm{d}v\\,\\mathrm{d}x} \\\\ &\\approx \\int_a^b \\sum_{i=0}^n \\left[A_i\\,\\frac{d(x)-c(x)}{2}\\,f\\left(x,\\frac{d(x)-c(x)}{2}\\,v_i + \\frac{d(x)+c(x)}{2}\\right)\\right] \\mathrm{d}x \\\\ &= \\sum_{i=0}^{n} \\left[A_i\\int_a^b \\alpha(x)\\,f\\left(x,\\alpha(x)v_i+\\beta(x)\\right)\\mathrm{d}x\\right] \\\\ &= \\sum_{i=0}^n \\left[A_i\\int_{-1}^1 \\frac{b-a}{2} \\alpha\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2}\\right)\\,f\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2},\\alpha\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2}\\right)v_i+\\beta\\left(\\frac{b-a}{2}\\,u + \\frac{b+a}{2}\\right)\\right)\\mathrm{d}u\\right] \\\\ &\\approx \\sum_{i=0}^n \\left[A_i \\sum_{j=0}^m B_j \\frac{b-a}{2} \\alpha\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2}\\right)\\,f\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2},\\alpha\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2}\\right)v_i+\\beta\\left(\\frac{b-a}{2}\\,u_j + \\frac{b+a}{2}\\right)\\right)\\right] \\\\ &= \\frac{b-a}{2}\\,\\sum_{i=0}^n \\sum_{j=0}^m A_i\\,B_j\\,\\alpha(U_j)\\,f(U_j,V_{ji}) \\end{align*} \u5176\u4e2d\uff0c \\begin{align*} \\alpha(x) &= \\frac{d(x)-c(x)}{2} \\\\ \\beta(x) &= \\frac{d(x)+c(x)}{2} \\end{align*} \\begin{align*} U_j &= \\frac{b-a}{2}\\,u_j + \\frac{b+a}{2} \\\\ V_{ji} &= \\alpha(U_j)\\,v_i + \\beta(U_j) \\end{align*} v_i, \\, u_j v_i, \\, u_j \u5206\u522b\u662f y,\\, x y,\\, x \u65b9\u5411\u5728\u6807\u51c6\u533a\u95f4\u7684\u79ef\u5206\u70b9\uff0c n,\\,m n,\\,m \u5206\u522b\u662f\u8fd9\u4e24\u4e2a\u65b9\u5411\u7684\u79ef\u5206\u70b9\u4e2a\u6570\u3002","title":"Gauss-Legendre\u4e8c\u91cd\u79ef\u5206"},{"location":"2014-12-19-Gauss-Legendre%E4%BA%8C%E9%87%8D%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/#matlab","text":"\u4ee5\u4e0a\u4e24\u8282\u4ecb\u7ecd\u4e86 Gauss-Legendre \u6570\u503c\u79ef\u5206\u4e2d\u79ef\u5206\u70b9\u3001\u79ef\u5206\u7cfb\u6570\u7684\u6c42\u89e3\u65b9\u6cd5\uff0c\u4ee5\u53ca\u4e8c\u91cd\u79ef\u5206\u7684\u8ba1\u7b97\u65b9\u6848\uff0c\u63a5\u4e0b\u6765\u4f7f\u7528Matlab\u5b9e\u73b0\u4ee5\u4e0a\u8fc7\u7a0b\u3002\u4e3a\u51cf\u5c0f\u53c2\u6570\u4e2a\u6570\uff0c\u5047\u8bbe\u4e24\u4e2a\u65b9\u5411\u7684\u79ef\u5206\u70b9\u6570\u76f8\u540c\uff0c\u5373\u4e4b\u524d\u5f0f\u5b50\u4e2d m=n m=n \u3002 function res = guasslegendre(fun, a, b, c, d, n) % ----------------------------------------------------------------------- % Gauss-Legendre\u6570\u503c\u79ef\u5206\u8ba1\u7b97\u4e8c\u91cd\u79ef\u5206 % \u53c2\u6570\u8bf4\u660e % fun\uff1a\u79ef\u5206\u8868\u8fbe\u5f0f\u51fd\u6570\u53e5\u67c4 fun=@(x,y)f(x,y) % a,b\uff1a\u5916\u5c42\u79ef\u5206\u533a\u95f4\uff0c\u5e38\u6570 % c,d\uff1a\u5185\u5c42\u79ef\u5206\u533a\u95f4\uff0c\u51fd\u6570\u53e5\u67c4 c=@(x)c(x), d=@(x)d(x) % n \uff1a\u79ef\u5206\u9636\u6570 % \u8f93\u51fa\u7ed3\u679c % res\uff1a\u79ef\u5206\u7ed3\u679c % ----------------------------------------------------------------------- % 1 \u8ba1\u7b97\u79ef\u5206\u70b9 syms x p = sym2poly(diff((x^2-1)^(n+1),n+1)); u = roots(p); % 2 \u8ba1\u7b97\u6c42\u79ef\u7cfb\u6570 Ak = zeros(n+1,1); for i=1:n+1 t = u; t(i) = []; pn = poly(t); fp = @(x)polyval(pn,x)/polyval(pn,u(i)); Ak(i)=integral(fp,-1,1); end % 3 \u53d8\u91cf\u4ee3\u6362 fa = @(x) (d(x)-c(x))/2.0; fb = @(x) (d(x)+c(x))/2.0; % 4 \u673a\u68b0\u6c42\u79ef [X,Y] = meshgrid(u,u); [A,B] = meshgrid(Ak,Ak); U = (b-a)/2.0*X + (b+a)/2.0; V = fa(U).*Y + fb(U); w = A.*B.*fa(U).*fun(U,V); res = (b-a)/2.0*sum(w(:)); \u4f5c\u4e3a\u6d4b\u8bd5\uff0c\u5206\u522b\u4f7f\u7528\u4ee5\u4e0a\u4ee3\u7801\u53caMatlab\u81ea\u5e26\u7684\u6570\u503c\u79ef\u5206\u51fd\u6570 integral2 \u5bf9\u4e0b\u9762\u4e8c\u91cd\u79ef\u5206\u8fdb\u884c\u8ba1\u7b97\uff1a I = \\int_{-1}^1\\!\\!\\int_x^{\\mathrm{e}^{x^2}}\\,e^{-\\left(x^2+y^2\\right)}\\,\\mathrm{d}y\\,\\mathrm{d}x I = \\int_{-1}^1\\!\\!\\int_x^{\\mathrm{e}^{x^2}}\\,e^{-\\left(x^2+y^2\\right)}\\,\\mathrm{d}y\\,\\mathrm{d}x \u9636\u6570 n n \u8ba1\u7b97\u503c 5 1.206565488320687 7 1.206561262089404 11 1.206561581890236 \u8868\u4e2d\u6570\u636e\u4e3a\u4ee5\u4e0a\u4ee3\u7801\u7684\u8ba1\u7b97\u503c\uff0c integral2 \u8ba1\u7b97\u503c\u4e3a\uff1a 1.206561586856674 1.206561586856674 \u3002\u7531\u4e8e\u79ef\u5206\u533a\u95f4\u6b63\u662f\u6807\u51c6\u7684 [-1,1] [-1,1] \uff0c5\u9636Gauss-Legendre\u6570\u503c\u79ef\u5206\u5373 6\\times6 6\\times6 \u4e2a\u79ef\u5206\u70b9\u5c31\u53ef\u5c06\u8bef\u5dee\u63a7\u5236\u5728 10^{-5} 10^{-5} \u4ee5\u4e0b\u3002 \u4e0d\u8fc7\uff0c\u4ee5\u4e0a\u4ee3\u7801\u4ec5\u4ec5\u662f Gauss-Legendre \u6570\u503c\u79ef\u5206\u57fa\u672c\u539f\u7406\u7684\u5b9e\u73b0\uff0c\u82e5\u60f3\u7528\u4e8e\u5b9e\u9645\u95ee\u9898\uff0c\u5c1a\u9700\u8fdb\u4e00\u6b65\u7684\u6539\u8fdb\u3002\u5f53\u79ef\u5206\u533a\u95f4\u8de8\u5ea6\u589e\u5927\u65f6\uff0c\u5176\u8ba1\u7b97\u7cbe\u5ea6\u5c06\u6025\u5267\u4e0b\u964d\uff0c\u4f8b\u5982\u4e0a\u8ff0\u79ef\u5206\u5728 [-2,11] [-2,11] \u533a\u95f4\u8fdb\u884c\u65f6\uff0c\u8ba1\u7b97\u7ed3\u679c\u5982\u4e0b\uff1a >> fun=@(x,y)exp(-x.^2-y.^2); >> integral2(fun,-2,11,@(x)x,@(x)exp(x.^2)) ans = 1.446305300237306 >> guasslegendre(fun,-2,11,@(x)x,@(x)exp(x.^2),11) ans = 1.467184820337763","title":"Matlab\u5b9e\u73b0"},{"location":"2014-12-19-Gauss-Legendre%E4%BA%8C%E9%87%8D%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/#_1","text":"\u6b63\u662f\u4e00\u5f00\u59cb\u63d0\u5230\u7684\uff1a \u590d\u5316\u6c42\u79ef \u65b9\u6cd5\u2014\u2014\u628a\u79ef\u5206\u533a\u95f4\u5212\u5206\u4e3a\u82e5\u5e72\u5b50\u533a\u95f4\uff0c\u518d\u5728\u6bcf\u4e2a\u5b50\u533a\u95f4\u91c7\u7528\u4f4e\u9636\u7684\u6c42\u79ef\u516c\u5f0f\u3002 \u5177\u4f53\u5b9e\u8df5\u7559\u5f85\u540e\u7eed\u3002","title":"\u6539\u8fdb\u7684\u65b9\u5411"},{"location":"2014-12-22-NumPy%E5%BA%93frompyfunc%E4%B8%8Evectorize%E7%9A%84%E6%AF%94%E8%BE%83/","text":"NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 \u00b6 \u53d1\u5e03\u4e8e\uff1a2014-12-22 | \u5206\u7c7b\uff1a numeric calculation , python/vba/cpp NumPy\u63d0\u4f9b\u4e86\u4e24\u79cd\u57fa\u672c\u5bf9\u8c61 ndarray \uff08n-dimensional array\uff09\u548c ufunc \uff08universal function\uff09\uff0c\u540e\u8005\u6307\u80fd\u591f\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u63d0\u9ad8\u8fd0\u7b97\u901f\u5ea6\u3002\u4e3a\u4e86\u5c06\u666e\u901a\u7684\u8ba1\u7b97\u5355\u4e2a\u5143\u7d20\u7684\u51fd\u6570\u8f6c\u6362\u6210ufunc\u51fd\u6570\uff0cNumPy\u63d0\u4f9b\u4e86 frompyfunc() \u548c vectorize() \u4e24\u4e2a\u51fd\u6570\u3002\u901a\u8fc7\u8f6c\u6362\uff0c\u53ef\u4ee5\u4f7f\u539f\u6765\u7684\u51fd\u6570\u53c2\u6570\u63a5\u53d7\u5411\u91cf\u8f93\u5165\uff08\u6362\u53e5\u8bdd\u8bf4\u5c06\u8f6c\u6362\u540e\u7684\u51fd\u6570\u7684\u5411\u91cf\u4f5c\u4e3a\u6807\u91cf\u8f93\u5165\u539f\u6765\u7684\u51fd\u6570\uff09\uff0c\u6700\u7ec8\u8f93\u51fa\u76f8\u5e94\u7ef4\u5ea6\u7684\u7ed3\u679c\u3002\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c \u5f53\u6211\u539f\u6765\u7684\u51fd\u6570\u672c\u6765\u5c31\u662f\u8f93\u51fa\u6570\u7ec4\uff0c\u6700\u7ec8\u4f1a\u8f93\u51fa\u65b0\u7684\u4e8c\u7ef4\u6570\u7ec4\u4e48\uff1f \u5f53\u6211\u67d0\u4e9b\u8f93\u5165\u53c2\u6570\u5e76\u4e0d\u5e0c\u671b\u88ab\u5411\u91cf\u5316\uff0c\u90a3\u8be5\u600e\u4e48\u529e\uff1f \u672c\u6587\u9488\u5bf9\u5e94\u7528\u4e2d\u9047\u5230\u7684\u8fd9\u4e24\u4e2a\u95ee\u9898\u4f5c\u793a\u4f8b\u8bf4\u660e\u3002 \u51fd\u6570\u8bf4\u660e \u00b6 \u53c2\u8003Numpy\u5b98\u65b9\u624b\u518c\u5bf9\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u58f0\u660e 1 2 \uff1a numpy.frompyfunc(func, nin, nout) class numpy.vectorize(pyfunc, otypes='', doc=None, excluded=None, cache=False) frompyfunc() \u7684\u8f93\u5165\u53c2\u6570\u5206\u522b\u4e3a\u51fd\u6570\u540d\uff0c\u8f93\u5165\u53c2\u6570\u4e2a\u6570\uff0c\u8f93\u51fa\u53c2\u6570\u4e2a\u6570\u3002 vectorize() \u7684\u8f93\u51fa\u53c2\u6570\u8f83\u591a\uff0c\u5e38\u4f7f\u7528\u7684\u662f\u524d\u4e24\u4e2a\uff1a\u51fd\u6570\u540d\u548c\u8fd4\u56de\u7c7b\u578b\u3002 \u5e76\u4e14\u6ce8\u610f\u6587\u6863\u4e2d\u660e\u786e\u6307\u51fa\u7684\u4e00\u53e5\u8bdd\uff0c vectorize() \u51fd\u6570\u672c\u8d28\u4e0a\u662f\u901a\u8fc7\u5faa\u73af\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u5b83\u7684\u4f7f\u7528\u53ea\u662f\u4e3a\u4e86\u65b9\u4fbf\u800c\u4e0d\u662f\u6548\u7387\u3002\u4e5f\u5c31\u662f\u8bf4 frompyfunc() \u66f4\u4e3a\u5e95\u5c42\u4e9b\uff0c\u6548\u7387\u76f8\u5bf9\u66f4\u9ad8\u3002 \u95ee\u9898\u4e00 \u51fd\u6570\u8fd4\u56de\u6570\u7ec4 \u00b6 \u6d4b\u8bd5\u4ee3\u7801 import numpy as np def test1(x): return x*np.array([0.0,1.0]) fpf_test1 = np.frompyfunc(test1,1,1) vec_test1 = np.vectorize(test1) x = np.linspace(0,1,2) \u6d4b\u8bd5\u7ed3\u679c print fpf_test1(x) [array([ 0., 0.]) array([ 0., 1.])] print vec_test1(x) ValueError: setting an array element with a sequence. \u539f\u51fd\u6570\u8f93\u51fa\u7ed3\u679c\u4e5f\u4e3a\u4e00\u4e2a\u6570\u7ec4\uff0c\u6d4b\u8bd5\u7ed3\u679c\u8868\u660e\u4f7f\u7528 frompyfunc() \u51fd\u6570\u8fbe\u5230\u4e86\u9884\u671f\u7684\u6548\u679c\uff0c\u800c vectorize() \u51fd\u6570\u5374\u5bfc\u81f4\u4e86\u9519\u8bef\u3002 \u95ee\u9898\u4e8c \u53c2\u6570\u4e0d\u9700\u8981\u5411\u91cf\u5316 \u00b6 \u6d4b\u8bd5\u4ee3\u7801 import numpy as np def test2(x,y): '''\u8fd4\u56dex\u6570\u7ec4\u5bf9\u5e94y\u4f4d\u7f6e\u7684\u5143\u7d20''' return x[int(y)] fpf_test2 = np.frompyfunc(test2,2,1) vec_test2 = np.vectorize(test2) x = np.linspace(0,4,5) * 10 y = np.linspace(0,4,5) \u6d4b\u8bd5\u7ed3\u679c print fpf_test2(x,y) TypeError: 'float' object has no attribute '__getitem__' print vec_test2(x,y) IndexError: invalid index to scalar variable. vec_test2.excluded.add(0) # \u7b2c\u4e00\u4e2a\u53c2\u6570\u65e0\u9700\u5411\u91cf\u5316 print vec_test2(x,y) [ 0. 10. 20. 30. 40.] \u7ed3\u679c\u53ef\u4ee5\u770b\u51fa\uff0c\u76f4\u63a5\u4f7f\u7528\u65f6\u7531\u4e8e\u5c06x\u4e5f\u89c6\u4e3a\u9700\u8981\u5411\u91cf\u5316\u5904\u7406\u7684\u53c2\u6570\uff0c\u6240\u4ee5\u90fd\u51fa\u73b0\u7c7b\u578b\u9519\u8bef\uff08x\u6700\u7ec8\u88ab\u89c6\u4e3a\u4e00\u4e2a\u6807\u91cf\u4e86\uff09\u3002\u800c\u4f7f\u7528 vectorize \u51fd\u6570\u7c7b\u7684 excluded \u5c5e\u6027\u6dfb\u52a0\u4e0d\u8003\u8651\u5411\u91cf\u5316\u7684\u8f93\u5165\u53c2\u6570\u540e\uff0c\u5f97\u5230\u4e86\u6b63\u786e\u7684\u8f93\u51fa\u3002 \u6ce8\u610f excluded \u5c5e\u6027\u5728 NumPy 1.7 \u4e4b\u540e\u7248\u672c\u624d\u652f\u6301\u3002\u4e0d\u5de7\uff0c\u6211\u4f7f\u7528\u7684\u662f1.6\u7248\u672c\uff0c\u6240\u4ee5\u5347\u7ea7\u65b0\u7248\u672c\u540e\u89e3\u51b3\u95ee\u9898\u3002 \u7ed3\u8bba \u00b6 frompyfunc() \u548c vectorize() \u51fd\u6570\u90fd\u53ef\u4ee5\u4f7f\u81ea\u5b9a\u4e49\u7684\u5355\u8f93\u5165\u503c\u51fd\u6570\u8f6c\u4e3a ufunc \u51fd\u6570\uff0c\u4f46\u662f\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a frompyfunc() \u8f83 vectorize() \u6709\u66f4\u9ad8\u7684\u6267\u884c\u6548\u7387\uff0c\u5c24\u5176\u5728\u89c4\u6a21\u8f83\u5927\u65f6\u3002 frompyfunc() \u53ef\u4ee5\u9002\u7528\u4e8e\u539f\u51fd\u6570\u8f93\u51fa\u6570\u7ec4\u7684\u60c5\u5f62\uff0c\u800c vectorize() \u5219\u4e0d\u652f\u6301\u3002 vectorize() \u53ef\u4ee5\u6307\u5b9a\u4e0d\u9700\u8981\u5411\u91cf\u5316\u5904\u7406\u7684\u8f93\u5165\u53c2\u6570\uff0c\u4ece\u800c\u6ee1\u8db3\u5177\u4f53\u9700\u6c42\u3002 numpy.frompyfunc \u21a9 numpy.vectorize \u21a9","title":"NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83"},{"location":"2014-12-22-NumPy%E5%BA%93frompyfunc%E4%B8%8Evectorize%E7%9A%84%E6%AF%94%E8%BE%83/#numpyfrompyfuncvectorize","text":"\u53d1\u5e03\u4e8e\uff1a2014-12-22 | \u5206\u7c7b\uff1a numeric calculation , python/vba/cpp NumPy\u63d0\u4f9b\u4e86\u4e24\u79cd\u57fa\u672c\u5bf9\u8c61 ndarray \uff08n-dimensional array\uff09\u548c ufunc \uff08universal function\uff09\uff0c\u540e\u8005\u6307\u80fd\u591f\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u63d0\u9ad8\u8fd0\u7b97\u901f\u5ea6\u3002\u4e3a\u4e86\u5c06\u666e\u901a\u7684\u8ba1\u7b97\u5355\u4e2a\u5143\u7d20\u7684\u51fd\u6570\u8f6c\u6362\u6210ufunc\u51fd\u6570\uff0cNumPy\u63d0\u4f9b\u4e86 frompyfunc() \u548c vectorize() \u4e24\u4e2a\u51fd\u6570\u3002\u901a\u8fc7\u8f6c\u6362\uff0c\u53ef\u4ee5\u4f7f\u539f\u6765\u7684\u51fd\u6570\u53c2\u6570\u63a5\u53d7\u5411\u91cf\u8f93\u5165\uff08\u6362\u53e5\u8bdd\u8bf4\u5c06\u8f6c\u6362\u540e\u7684\u51fd\u6570\u7684\u5411\u91cf\u4f5c\u4e3a\u6807\u91cf\u8f93\u5165\u539f\u6765\u7684\u51fd\u6570\uff09\uff0c\u6700\u7ec8\u8f93\u51fa\u76f8\u5e94\u7ef4\u5ea6\u7684\u7ed3\u679c\u3002\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c \u5f53\u6211\u539f\u6765\u7684\u51fd\u6570\u672c\u6765\u5c31\u662f\u8f93\u51fa\u6570\u7ec4\uff0c\u6700\u7ec8\u4f1a\u8f93\u51fa\u65b0\u7684\u4e8c\u7ef4\u6570\u7ec4\u4e48\uff1f \u5f53\u6211\u67d0\u4e9b\u8f93\u5165\u53c2\u6570\u5e76\u4e0d\u5e0c\u671b\u88ab\u5411\u91cf\u5316\uff0c\u90a3\u8be5\u600e\u4e48\u529e\uff1f \u672c\u6587\u9488\u5bf9\u5e94\u7528\u4e2d\u9047\u5230\u7684\u8fd9\u4e24\u4e2a\u95ee\u9898\u4f5c\u793a\u4f8b\u8bf4\u660e\u3002","title":"NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83"},{"location":"2014-12-22-NumPy%E5%BA%93frompyfunc%E4%B8%8Evectorize%E7%9A%84%E6%AF%94%E8%BE%83/#_1","text":"\u53c2\u8003Numpy\u5b98\u65b9\u624b\u518c\u5bf9\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u58f0\u660e 1 2 \uff1a numpy.frompyfunc(func, nin, nout) class numpy.vectorize(pyfunc, otypes='', doc=None, excluded=None, cache=False) frompyfunc() \u7684\u8f93\u5165\u53c2\u6570\u5206\u522b\u4e3a\u51fd\u6570\u540d\uff0c\u8f93\u5165\u53c2\u6570\u4e2a\u6570\uff0c\u8f93\u51fa\u53c2\u6570\u4e2a\u6570\u3002 vectorize() \u7684\u8f93\u51fa\u53c2\u6570\u8f83\u591a\uff0c\u5e38\u4f7f\u7528\u7684\u662f\u524d\u4e24\u4e2a\uff1a\u51fd\u6570\u540d\u548c\u8fd4\u56de\u7c7b\u578b\u3002 \u5e76\u4e14\u6ce8\u610f\u6587\u6863\u4e2d\u660e\u786e\u6307\u51fa\u7684\u4e00\u53e5\u8bdd\uff0c vectorize() \u51fd\u6570\u672c\u8d28\u4e0a\u662f\u901a\u8fc7\u5faa\u73af\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u5b83\u7684\u4f7f\u7528\u53ea\u662f\u4e3a\u4e86\u65b9\u4fbf\u800c\u4e0d\u662f\u6548\u7387\u3002\u4e5f\u5c31\u662f\u8bf4 frompyfunc() \u66f4\u4e3a\u5e95\u5c42\u4e9b\uff0c\u6548\u7387\u76f8\u5bf9\u66f4\u9ad8\u3002","title":"\u51fd\u6570\u8bf4\u660e"},{"location":"2014-12-22-NumPy%E5%BA%93frompyfunc%E4%B8%8Evectorize%E7%9A%84%E6%AF%94%E8%BE%83/#_2","text":"\u6d4b\u8bd5\u4ee3\u7801 import numpy as np def test1(x): return x*np.array([0.0,1.0]) fpf_test1 = np.frompyfunc(test1,1,1) vec_test1 = np.vectorize(test1) x = np.linspace(0,1,2) \u6d4b\u8bd5\u7ed3\u679c print fpf_test1(x) [array([ 0., 0.]) array([ 0., 1.])] print vec_test1(x) ValueError: setting an array element with a sequence. \u539f\u51fd\u6570\u8f93\u51fa\u7ed3\u679c\u4e5f\u4e3a\u4e00\u4e2a\u6570\u7ec4\uff0c\u6d4b\u8bd5\u7ed3\u679c\u8868\u660e\u4f7f\u7528 frompyfunc() \u51fd\u6570\u8fbe\u5230\u4e86\u9884\u671f\u7684\u6548\u679c\uff0c\u800c vectorize() \u51fd\u6570\u5374\u5bfc\u81f4\u4e86\u9519\u8bef\u3002","title":"\u95ee\u9898\u4e00 \u51fd\u6570\u8fd4\u56de\u6570\u7ec4"},{"location":"2014-12-22-NumPy%E5%BA%93frompyfunc%E4%B8%8Evectorize%E7%9A%84%E6%AF%94%E8%BE%83/#_3","text":"\u6d4b\u8bd5\u4ee3\u7801 import numpy as np def test2(x,y): '''\u8fd4\u56dex\u6570\u7ec4\u5bf9\u5e94y\u4f4d\u7f6e\u7684\u5143\u7d20''' return x[int(y)] fpf_test2 = np.frompyfunc(test2,2,1) vec_test2 = np.vectorize(test2) x = np.linspace(0,4,5) * 10 y = np.linspace(0,4,5) \u6d4b\u8bd5\u7ed3\u679c print fpf_test2(x,y) TypeError: 'float' object has no attribute '__getitem__' print vec_test2(x,y) IndexError: invalid index to scalar variable. vec_test2.excluded.add(0) # \u7b2c\u4e00\u4e2a\u53c2\u6570\u65e0\u9700\u5411\u91cf\u5316 print vec_test2(x,y) [ 0. 10. 20. 30. 40.] \u7ed3\u679c\u53ef\u4ee5\u770b\u51fa\uff0c\u76f4\u63a5\u4f7f\u7528\u65f6\u7531\u4e8e\u5c06x\u4e5f\u89c6\u4e3a\u9700\u8981\u5411\u91cf\u5316\u5904\u7406\u7684\u53c2\u6570\uff0c\u6240\u4ee5\u90fd\u51fa\u73b0\u7c7b\u578b\u9519\u8bef\uff08x\u6700\u7ec8\u88ab\u89c6\u4e3a\u4e00\u4e2a\u6807\u91cf\u4e86\uff09\u3002\u800c\u4f7f\u7528 vectorize \u51fd\u6570\u7c7b\u7684 excluded \u5c5e\u6027\u6dfb\u52a0\u4e0d\u8003\u8651\u5411\u91cf\u5316\u7684\u8f93\u5165\u53c2\u6570\u540e\uff0c\u5f97\u5230\u4e86\u6b63\u786e\u7684\u8f93\u51fa\u3002 \u6ce8\u610f excluded \u5c5e\u6027\u5728 NumPy 1.7 \u4e4b\u540e\u7248\u672c\u624d\u652f\u6301\u3002\u4e0d\u5de7\uff0c\u6211\u4f7f\u7528\u7684\u662f1.6\u7248\u672c\uff0c\u6240\u4ee5\u5347\u7ea7\u65b0\u7248\u672c\u540e\u89e3\u51b3\u95ee\u9898\u3002","title":"\u95ee\u9898\u4e8c \u53c2\u6570\u4e0d\u9700\u8981\u5411\u91cf\u5316"},{"location":"2014-12-22-NumPy%E5%BA%93frompyfunc%E4%B8%8Evectorize%E7%9A%84%E6%AF%94%E8%BE%83/#_4","text":"frompyfunc() \u548c vectorize() \u51fd\u6570\u90fd\u53ef\u4ee5\u4f7f\u81ea\u5b9a\u4e49\u7684\u5355\u8f93\u5165\u503c\u51fd\u6570\u8f6c\u4e3a ufunc \u51fd\u6570\uff0c\u4f46\u662f\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a frompyfunc() \u8f83 vectorize() \u6709\u66f4\u9ad8\u7684\u6267\u884c\u6548\u7387\uff0c\u5c24\u5176\u5728\u89c4\u6a21\u8f83\u5927\u65f6\u3002 frompyfunc() \u53ef\u4ee5\u9002\u7528\u4e8e\u539f\u51fd\u6570\u8f93\u51fa\u6570\u7ec4\u7684\u60c5\u5f62\uff0c\u800c vectorize() \u5219\u4e0d\u652f\u6301\u3002 vectorize() \u53ef\u4ee5\u6307\u5b9a\u4e0d\u9700\u8981\u5411\u91cf\u5316\u5904\u7406\u7684\u8f93\u5165\u53c2\u6570\uff0c\u4ece\u800c\u6ee1\u8db3\u5177\u4f53\u9700\u6c42\u3002 numpy.frompyfunc \u21a9 numpy.vectorize \u21a9","title":"\u7ed3\u8bba"},{"location":"2014-12-24-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%B8%89%E9%87%8D%E7%A7%AF%E5%88%86/","text":"\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206 \u00b6 \u53d1\u5e03\u4e8e\uff1a2014-12-24 | \u5206\u7c7b\uff1a numeric calculation \u5f53\u4e0a\u9650\u6cd5\u62d3\u5c55\u5e94\u7528\u5230\u4e09\u7ef4\u6210\u5f62\u95ee\u9898\uff0c\u4e09\u91cd\u79ef\u5206\u5c31\u5728\u6240\u96be\u514d\u4e86\uff1b\u5e76\u4e14\u8003\u8651\u5230\u79ef\u5206\u533a\u57df\u65e0\u6cd5\u89e3\u6790\u8868\u8fbe\uff0c\u6b64\u65f6\u6570\u503c\u79ef\u5206\u662f\u552f\u4e00\u7684\u9009\u62e9\u3002\u4e4b\u524d\u6587\u7ae0\u7ed9\u51fa\u4e86\u5e73\u9762\u95ee\u9898\u4e2d\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff0c\u672c\u6587\u5373\u4ee5\u5177\u4f53\u793a\u4f8b\u4ecb\u7ecd\u4e09\u7ef4\u4e0a\u9650\u6cd5\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9047\u5230\u7684\u4f53\u79ef\u79ef\u5206\u95ee\u9898\u3002 \u7b97\u4f8b\uff1a\u5728\u534a\u5f84\u4e3a1\u7684\u516b\u5206\u4e4b\u4e00\u7403\u4f53\u533a\u57df \\Omega \\Omega \uff08\u7b2c\u4e00\u5366\u9650\uff09\u4e0a\u8ba1\u7b97 f(x,y,z) f(x,y,z) \u7684\u79ef\u5206 \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} \u7279\u522b\u5730\uff0c\u5f53 f(x,y,z)=1 f(x,y,z)=1 \u65f6\uff0c\u5176\u51e0\u4f55\u610f\u4e49\u4e3a\u516b\u5206\u4e4b\u4e00\u7403\u7684\u4f53\u79ef\u3002 \u8ba1\u7b97\u601d\u8def \u00b6 \u601d\u8def\u5176\u5b9e\u5f88\u660e\u6670\uff1a \u5efa\u7acb\u7403\u4f53\u7684\u51e0\u4f55\u6a21\u578b \u5212\u5206\u7f51\u683c\u5f97\u5230\u5355\u5143\u53ca\u8282\u70b9\u5750\u6807\u6570\u636e\uff0c\u7f16\u7a0b\u8bfb\u5165\u7f51\u683c\u6570\u636e \u8fd9\u4e2a\u53ef\u4ee5\u5728\u7f51\u683c\u5212\u5206\u8f6f\u4ef6\u4e2d\u6267\u884c\uff0c\u4fdd\u5b58\u7684\u6587\u4ef6\u683c\u5f0f\u9009\u53d6\u901a\u7528\u7684 Nastran \u683c\u5f0f\uff0c\u6216\u8005\u5176\u4ed6\u7684\u5305\u542b\u5355\u5143\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u4f8b\u5982Marc\u7684 .dat \u683c\u5f0f\u3002\u7136\u540e\u6839\u636e\u4fdd\u5b58\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u5c06\u6570\u636e\u8bfb\u5165\u5230\u81ea\u5df1\u7684\u7a0b\u5e8f\u4e2d\u6765\u3002 \u8fdb\u884c\u6570\u503c\u79ef\u5206 \u5c06\u79ef\u5206\u533a\u57df\u79bb\u6563\u540e\uff0c\u4ee5\u6709\u9650\u79ef\u5206\u70b9\u7684\u63d2\u503c\u6570\u636e\u6765\u66ff\u4ee3\u5355\u5143\u4e0a\u8fde\u7eed\u7684\u51fd\u6570\u503c\uff0c\u5f97\u5230\u6bcf\u4e2a\u5355\u5143\u7684\u6570\u503c\u79ef\u5206\u7ed3\u679c\uff0c\u6700\u540e\u6c42\u548c\u3002 \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} = \\sum_{i=1}^m{\\left[\\int_{V_i}f(x_i,y_i,z_i)\\,\\mathrm{d}V \\right]} = \\sum_{i=1}^m{f(x_i,y_i,z_i)\\,V_i} \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} = \\sum_{i=1}^m{\\left[\\int_{V_i}f(x_i,y_i,z_i)\\,\\mathrm{d}V \\right]} = \\sum_{i=1}^m{f(x_i,y_i,z_i)\\,V_i} \u8ba1\u7b97\u5b9e\u4f8b \u00b6 \u672c\u6587\u91c7\u7528\u5f00\u6e90\u7684\u96c6\u6210\u6709\u9650\u5143\u524d\u540e\u5904\u7406\u7684\u7f51\u683c\u751f\u6210\u7a0b\u5e8f Gmsh \u8fdb\u884c\u51e0\u4f55\u5efa\u6a21\u4e0e\u5355\u5143\u5212\u5206\uff0c\u7136\u540e\u501f\u52a9Python\u7684\u79d1\u5b66\u8ba1\u7b97\u5e93 NumPy \u5b8c\u6210\u5177\u4f53\u8ba1\u7b97\u8fc7\u7a0b\u3002 Gmsh \u7684\u9879\u76ee\u4e3b\u9875\u53c2\u89c1 Gmsh: a three-dimensional finite element mesh generator with built-in pre- and post-processing facilities \u672c\u6b21\u8ba1\u7b97\u4e2d\u91c7\u7528\u7684\u662f\u56db\u9762\u4f53\u5355\u5143\uff0c\u56e0\u4e3a\u56db\u9762\u4f53\u5177\u6709\u7b80\u6613\u7684\u4f53\u79ef\u8ba1\u7b97\u516c\u5f0f\u3002\u79ef\u5206\u65b9\u6848\u4e3aHammer\u79ef\u5206\uff0c\u6839\u636e\u79ef\u5206\u7cbe\u5ea6\u53ef\u9009\u53d6\u7ebf\u6027\u3001\u4e8c\u6b21\u53ca\u4e09\u6b21\u79ef\u5206\u70b9\uff0c\u53c2\u89c1\u738b\u52d6\u6210\u300a\u6709\u9650\u5355\u5143\u6cd5\u300bPage 151\u3002\u672c\u6b21\u8ba1\u7b97\u76f4\u63a5\u91c7\u7528\u7ebf\u6027\u7684\u79ef\u5206\u65b9\u6848\uff0c\u5373\u4ee5\u56db\u9762\u4f53\u5355\u5143\u56db\u4e2a\u8282\u70b9\u4e0a\u51fd\u6570\u503c\u7684\u5e73\u5747\u503c\u4f5c\u4e3a\u5355\u5143\u7684\u51fd\u6570\u503c\u3002 \u8ba1\u7b97\u8fc7\u7a0b\u4e2d\uff0c\u9009\u53d6\u4e0d\u540c\u7684\u88ab\u79ef\u51fd\u6570 f(x,y,z) f(x,y,z) \u3001\u540c\u65f6\u8bbe\u7f6e\u4e0d\u540c\u7684\u5355\u5143\u6570\uff0c\u5e76\u4e0ematlab\u6570\u503c\u79ef\u5206\u7ed3\u679c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u5982\u4e0b\u8868\u6240\u793a\u3002 \u88ab\u79ef\u51fd\u6570 19\u5355\u5143 370\u5355\u5143 4560\u5355\u5143 232705\u5355\u5143 matlab f(x,\\,y,\\,z)=1 f(x,\\,y,\\,z)=1 0.402571 0.515488 0.522304 0.523514 0.523599 f(x,\\,y,\\,z)=\\sin^2\\left(x+y^2+\\sqrt{z}\\right) f(x,\\,y,\\,z)=\\sin^2\\left(x+y^2+\\sqrt{z}\\right) 0.300058 0.405632 0.410014 0.410513 0.410495 \u53ef\u4ee5\u4f7f\u7528 triplequad() \u6216\u8005 integral3() \u8fdb\u884cmatlab\u4e09\u91cd\u6570\u503c\u79ef\u5206\uff0c\u5e76\u4e14\u672c\u4f8b\u79ef\u5206\u533a\u57df\u5728\u7403\u5750\u6807\u7cfb\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5e38\u6570\u79ef\u5206\u9650\u3002 triplequad(@(x,y,z) x.^2.*sin(y).*sin(x.*sin(y).*cos(z)+(x.*sin(y).*sin(z)).^2+(x.*cos(y)).^0.5).^2,0,1,0,pi/2,0,pi/2) \u6839\u636e\u4e0a\u8868\u4f5c\u56fe\u5373\u53ef\u5f97\u5230\u672c\u7b97\u4f8b\u7f51\u683c\u5212\u5206\u6570\u91cf\u4e0e\u89e3\u7684\u6536\u655b\u6027\u7684\u5173\u7cfb\uff0c\u7ed3\u679c\u8868\u660e\u79bb\u6563\u79ef\u5206\u5f97\u5230\u7684\u7ed3\u679c\u968f\u7740\u5355\u5143\u6570\u7684\u589e\u591a\u800c\u6536\u655b\u4e8e\u771f\u5b9e\u89e3\uff1b\u4f46\u662f\uff0c\u5f53\u5355\u5143\u7ec6\u5316\u5230\u4e00\u5b9a\u7ea7\u522b\u540e\uff0c\u7ee7\u7eed\u901a\u8fc7\u7ec6\u5316\u7684\u65b9\u5f0f\u63d0\u5347\u8ba1\u7b97\u7cbe\u5ea6\u7684\u6548\u7387\u6025\u5267\u4e0b\u964d\u3002","title":"\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206"},{"location":"2014-12-24-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%B8%89%E9%87%8D%E7%A7%AF%E5%88%86/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2014-12-24 | \u5206\u7c7b\uff1a numeric calculation \u5f53\u4e0a\u9650\u6cd5\u62d3\u5c55\u5e94\u7528\u5230\u4e09\u7ef4\u6210\u5f62\u95ee\u9898\uff0c\u4e09\u91cd\u79ef\u5206\u5c31\u5728\u6240\u96be\u514d\u4e86\uff1b\u5e76\u4e14\u8003\u8651\u5230\u79ef\u5206\u533a\u57df\u65e0\u6cd5\u89e3\u6790\u8868\u8fbe\uff0c\u6b64\u65f6\u6570\u503c\u79ef\u5206\u662f\u552f\u4e00\u7684\u9009\u62e9\u3002\u4e4b\u524d\u6587\u7ae0\u7ed9\u51fa\u4e86\u5e73\u9762\u95ee\u9898\u4e2d\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff0c\u672c\u6587\u5373\u4ee5\u5177\u4f53\u793a\u4f8b\u4ecb\u7ecd\u4e09\u7ef4\u4e0a\u9650\u6cd5\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9047\u5230\u7684\u4f53\u79ef\u79ef\u5206\u95ee\u9898\u3002 \u7b97\u4f8b\uff1a\u5728\u534a\u5f84\u4e3a1\u7684\u516b\u5206\u4e4b\u4e00\u7403\u4f53\u533a\u57df \\Omega \\Omega \uff08\u7b2c\u4e00\u5366\u9650\uff09\u4e0a\u8ba1\u7b97 f(x,y,z) f(x,y,z) \u7684\u79ef\u5206 \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} \u7279\u522b\u5730\uff0c\u5f53 f(x,y,z)=1 f(x,y,z)=1 \u65f6\uff0c\u5176\u51e0\u4f55\u610f\u4e49\u4e3a\u516b\u5206\u4e4b\u4e00\u7403\u7684\u4f53\u79ef\u3002","title":"\u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206"},{"location":"2014-12-24-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%B8%89%E9%87%8D%E7%A7%AF%E5%88%86/#_2","text":"\u601d\u8def\u5176\u5b9e\u5f88\u660e\u6670\uff1a \u5efa\u7acb\u7403\u4f53\u7684\u51e0\u4f55\u6a21\u578b \u5212\u5206\u7f51\u683c\u5f97\u5230\u5355\u5143\u53ca\u8282\u70b9\u5750\u6807\u6570\u636e\uff0c\u7f16\u7a0b\u8bfb\u5165\u7f51\u683c\u6570\u636e \u8fd9\u4e2a\u53ef\u4ee5\u5728\u7f51\u683c\u5212\u5206\u8f6f\u4ef6\u4e2d\u6267\u884c\uff0c\u4fdd\u5b58\u7684\u6587\u4ef6\u683c\u5f0f\u9009\u53d6\u901a\u7528\u7684 Nastran \u683c\u5f0f\uff0c\u6216\u8005\u5176\u4ed6\u7684\u5305\u542b\u5355\u5143\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u4f8b\u5982Marc\u7684 .dat \u683c\u5f0f\u3002\u7136\u540e\u6839\u636e\u4fdd\u5b58\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u5c06\u6570\u636e\u8bfb\u5165\u5230\u81ea\u5df1\u7684\u7a0b\u5e8f\u4e2d\u6765\u3002 \u8fdb\u884c\u6570\u503c\u79ef\u5206 \u5c06\u79ef\u5206\u533a\u57df\u79bb\u6563\u540e\uff0c\u4ee5\u6709\u9650\u79ef\u5206\u70b9\u7684\u63d2\u503c\u6570\u636e\u6765\u66ff\u4ee3\u5355\u5143\u4e0a\u8fde\u7eed\u7684\u51fd\u6570\u503c\uff0c\u5f97\u5230\u6bcf\u4e2a\u5355\u5143\u7684\u6570\u503c\u79ef\u5206\u7ed3\u679c\uff0c\u6700\u540e\u6c42\u548c\u3002 \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} = \\sum_{i=1}^m{\\left[\\int_{V_i}f(x_i,y_i,z_i)\\,\\mathrm{d}V \\right]} = \\sum_{i=1}^m{f(x_i,y_i,z_i)\\,V_i} \\int_{\\Omega}{f(x,y,z)\\,\\mathrm{d}V} = \\sum_{i=1}^m{\\left[\\int_{V_i}f(x_i,y_i,z_i)\\,\\mathrm{d}V \\right]} = \\sum_{i=1}^m{f(x_i,y_i,z_i)\\,V_i}","title":"\u8ba1\u7b97\u601d\u8def"},{"location":"2014-12-24-%E4%B8%8A%E9%99%90%E6%B3%95%E5%A1%91%E6%80%A7%E5%8A%9F%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E7%AE%97%E4%BE%8B%EF%BC%9A%E4%B8%89%E9%87%8D%E7%A7%AF%E5%88%86/#_3","text":"\u672c\u6587\u91c7\u7528\u5f00\u6e90\u7684\u96c6\u6210\u6709\u9650\u5143\u524d\u540e\u5904\u7406\u7684\u7f51\u683c\u751f\u6210\u7a0b\u5e8f Gmsh \u8fdb\u884c\u51e0\u4f55\u5efa\u6a21\u4e0e\u5355\u5143\u5212\u5206\uff0c\u7136\u540e\u501f\u52a9Python\u7684\u79d1\u5b66\u8ba1\u7b97\u5e93 NumPy \u5b8c\u6210\u5177\u4f53\u8ba1\u7b97\u8fc7\u7a0b\u3002 Gmsh \u7684\u9879\u76ee\u4e3b\u9875\u53c2\u89c1 Gmsh: a three-dimensional finite element mesh generator with built-in pre- and post-processing facilities \u672c\u6b21\u8ba1\u7b97\u4e2d\u91c7\u7528\u7684\u662f\u56db\u9762\u4f53\u5355\u5143\uff0c\u56e0\u4e3a\u56db\u9762\u4f53\u5177\u6709\u7b80\u6613\u7684\u4f53\u79ef\u8ba1\u7b97\u516c\u5f0f\u3002\u79ef\u5206\u65b9\u6848\u4e3aHammer\u79ef\u5206\uff0c\u6839\u636e\u79ef\u5206\u7cbe\u5ea6\u53ef\u9009\u53d6\u7ebf\u6027\u3001\u4e8c\u6b21\u53ca\u4e09\u6b21\u79ef\u5206\u70b9\uff0c\u53c2\u89c1\u738b\u52d6\u6210\u300a\u6709\u9650\u5355\u5143\u6cd5\u300bPage 151\u3002\u672c\u6b21\u8ba1\u7b97\u76f4\u63a5\u91c7\u7528\u7ebf\u6027\u7684\u79ef\u5206\u65b9\u6848\uff0c\u5373\u4ee5\u56db\u9762\u4f53\u5355\u5143\u56db\u4e2a\u8282\u70b9\u4e0a\u51fd\u6570\u503c\u7684\u5e73\u5747\u503c\u4f5c\u4e3a\u5355\u5143\u7684\u51fd\u6570\u503c\u3002 \u8ba1\u7b97\u8fc7\u7a0b\u4e2d\uff0c\u9009\u53d6\u4e0d\u540c\u7684\u88ab\u79ef\u51fd\u6570 f(x,y,z) f(x,y,z) \u3001\u540c\u65f6\u8bbe\u7f6e\u4e0d\u540c\u7684\u5355\u5143\u6570\uff0c\u5e76\u4e0ematlab\u6570\u503c\u79ef\u5206\u7ed3\u679c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u5982\u4e0b\u8868\u6240\u793a\u3002 \u88ab\u79ef\u51fd\u6570 19\u5355\u5143 370\u5355\u5143 4560\u5355\u5143 232705\u5355\u5143 matlab f(x,\\,y,\\,z)=1 f(x,\\,y,\\,z)=1 0.402571 0.515488 0.522304 0.523514 0.523599 f(x,\\,y,\\,z)=\\sin^2\\left(x+y^2+\\sqrt{z}\\right) f(x,\\,y,\\,z)=\\sin^2\\left(x+y^2+\\sqrt{z}\\right) 0.300058 0.405632 0.410014 0.410513 0.410495 \u53ef\u4ee5\u4f7f\u7528 triplequad() \u6216\u8005 integral3() \u8fdb\u884cmatlab\u4e09\u91cd\u6570\u503c\u79ef\u5206\uff0c\u5e76\u4e14\u672c\u4f8b\u79ef\u5206\u533a\u57df\u5728\u7403\u5750\u6807\u7cfb\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5e38\u6570\u79ef\u5206\u9650\u3002 triplequad(@(x,y,z) x.^2.*sin(y).*sin(x.*sin(y).*cos(z)+(x.*sin(y).*sin(z)).^2+(x.*cos(y)).^0.5).^2,0,1,0,pi/2,0,pi/2) \u6839\u636e\u4e0a\u8868\u4f5c\u56fe\u5373\u53ef\u5f97\u5230\u672c\u7b97\u4f8b\u7f51\u683c\u5212\u5206\u6570\u91cf\u4e0e\u89e3\u7684\u6536\u655b\u6027\u7684\u5173\u7cfb\uff0c\u7ed3\u679c\u8868\u660e\u79bb\u6563\u79ef\u5206\u5f97\u5230\u7684\u7ed3\u679c\u968f\u7740\u5355\u5143\u6570\u7684\u589e\u591a\u800c\u6536\u655b\u4e8e\u771f\u5b9e\u89e3\uff1b\u4f46\u662f\uff0c\u5f53\u5355\u5143\u7ec6\u5316\u5230\u4e00\u5b9a\u7ea7\u522b\u540e\uff0c\u7ee7\u7eed\u901a\u8fc7\u7ec6\u5316\u7684\u65b9\u5f0f\u63d0\u5347\u8ba1\u7b97\u7cbe\u5ea6\u7684\u6548\u7387\u6025\u5267\u4e0b\u964d\u3002","title":"\u8ba1\u7b97\u5b9e\u4f8b"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/","text":"SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93 \u00b6 \u53d1\u5e03\u4e8e\uff1a2015-06-16 | \u5206\u7c7b\uff1a web development \u4e4b\u524d\u4e00\u7bc7\u6587\u7ae0 \u4ecb\u7ecd\u4e86ThinkPHP\u6846\u67b6\u4e0b\u7684MySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b\u7684\u4f7f\u7528\uff0c\u540e\u6765\u5c06\u9879\u76ee\u8fc1\u79fb\u5230\u4e86\u65b0\u6d6a\u4e91\u8ba1\u7b97\u5e73\u53f0\u4e0a\uff0c\u7531\u4e8e\u65e0\u6cd5\u50cf\u672c\u5730\u4e00\u6837\u8bfb\u5199\u6587\u4ef6\uff0c\u5907\u4efd\u3001\u8fd8\u539f\u529f\u80fd\u4e5f\u5c31\u5931\u6548\u4e86\u3002\u672c\u6587\u5373\u9488\u5bf9\u6b64\u95ee\u9898\uff0c\u5bf9\u539f\u6765\u7684 MySQLReback.class.php \u6587\u4ef6\u4f5c\u76f8\u5e94\u4fee\u6539\uff0c\u4ee5\u9002\u5e94SAE\u73af\u5883\u3002 \u601d\u8def \u00b6 SAE\u4e0d\u652f\u6301\u672c\u5730\u6587\u4ef6\u7684\u8bfb\u5199\uff0c\u4f46\u662f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86 Storage \u7528\u4e8e\u6570\u636e\u7684\u5b58\u50a8\uff1a Storage\u662fSAE\u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u7684\u5206\u5e03\u5f0f\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\uff0c\u65e8\u5728\u5229\u7528SAE\u5728\u5206\u5e03\u5f0f\u4ee5\u53ca\u7f51\u7edc\u6280\u672f\u65b9\u9762\u7684\u4f18\u52bf\u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u5b89\u5168\u3001\u7b80\u5355\u3001\u9ad8\u6548\u7684\u5b58\u50a8\u670d\u52a1\u3002Storage\u652f\u6301\u6587\u672c\u3001\u591a\u5a92\u4f53\u3001\u4e8c\u8fdb\u5236\u7b49\u4efb\u4f55\u7c7b\u578b\u7684\u6570\u636e\u7684\u5b58\u50a8\u3002 \u56e0\u6b64\uff0c\u4fee\u6539\u601d\u8def\u4e3a\uff1a\u5c06\u539f\u6765\u7684\u672c\u5730\u6587\u4ef6\u64cd\u4f5c\u4ee3\u7801\u4fee\u6539\u4e3a\u517c\u5bb9 SAE Storage \u7684\u6587\u4ef6\u8bfb\u5199\u64cd\u4f5c 1 \u3002 \u8bfb\u53d6\u5907\u4efd\u76ee\u5f55\u4e0b\u5df2\u6709\u7684\u6587\u4ef6 \u00b6 \u5728\u9879\u76ee\u7684 Storage \u83dc\u5355\u4e0b\u65b0\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3a public \u7684 domain \uff0c\u5c06\u5907\u4efd\u6587\u4ef6\u653e\u5728\u6b64 domain \u4e0b\u7684 Backup \u6587\u4ef6\u5939\u4e0b\u3002\u8981\u5b9e\u73b0\u8bfb\u53d6\u8fd9\u4e9b\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528SAE\u63d0\u4f9b\u7684 getListByPath() \u65b9\u6cd5\u3002\u8be5\u65b9\u6cd5\u6267\u884c\u6210\u529f\u540e\u8fd4\u56de\u5305\u542b\u6587\u4ef6\u4fe1\u606f\uff08\u540d\u79f0\u3001\u5927\u5c0f\u3001\u4e0a\u4f20\u65f6\u95f4\u7b49\uff09\u7684\u6570\u7ec4\uff08\u6570\u7ec4\u7684\u5177\u4f53\u5f62\u5f0f\u7531\u6700\u540e\u4e00\u4e2a\u8f93\u5165\u53c2\u6570\u6307\u5b9a\uff09\uff0c\u6267\u884c\u5931\u8d25\u540e\u8fd4\u56de false \u3002\u53c2\u6570\u8bf4\u660e\u3001\u793a\u4f8b\u3001\u5b9e\u73b0\u4ee3\u7801\u53c2\u8003\u4e0a\u9762\u63d0\u4f9b\u7684\u5f00\u53d1\u6587\u6863\u3002\u4e0b\u9762\u7ed9\u51fa\u8bfb\u53d6\u5907\u4efd\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4ee3\u7801\uff1a public function getBacoverFiles(){ // \u672c\u5730\u5199\u6cd5 // .... // SAE\u4e0a\u5199\u6cd5 $domain = \"public\"; $s = new SaeStorage(); $files = $s->getListByPath($domain,\"Backup\",100); foreach($files[\"files\"] as $k => $v){ $list[$k]['FileName'] = $v[\"Name\"]; $list[$k]['FileTime'] = date(\"Y-m-d H:i:s\",$v[\"uploadTime\"]); $FileSize = $v[\"length\"]/1024; if ($FileSize < 1024){ $list[$k]['FileSize'] = number_format($FileSize,2).' KB'; } else { $list[$k]['FileSize'] = number_format($FileSize/1024,2).' MB'; } } $result[\"total\"] = count($list); $result[\"rows\"] = $list==null?array():$list; echo json_encode($list); } \u5907\u4efd\u6570\u636e\u5e93 \u00b6 \u6d4f\u89c8\u4e00\u4e0b MySQLReback \u7c7b\u7684\u5b9e\u73b0\u4ee3\u7801\uff0c\u53ef\u4ee5\u53d1\u73b0\u8be5\u7c7b\u5148\u751f\u6210\u5907\u4efd\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5199\u5165\u5230\u76ee\u6807\u6587\u4ef6\u5939\u3002\u56e0\u6b64\u4e3a\u4e86\u517c\u5bb9SAE\u73af\u5883\uff0c\u53ea\u9700\u8981\u4fee\u6539\u4fdd\u5b58\u6587\u4ef6\u7684 setFile() \u79c1\u6709\u65b9\u6cd5\u3002\u5bf9\u5e94\u8fd9\u90e8\u5206\u4fee\u6539\uff0cSAE\u63d0\u4f9b\u4e86 write() \u65b9\u6cd5\u4f9b\u5199\u5165\u6587\u4ef6\u5230Storage\u3002\u7531\u4e8e write() \u65b9\u6cd5\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3adomain\u7684\u540d\u79f0\uff0c\u6240\u4ee5\u4e3a MySQLReback \u7c7b\u7684\u914d\u7f6e\u53c2\u6570\u63d0\u4f9b\u4e00\u4e2a domain \u952e\u503c\u5bf9\uff1a $domain = \"public\"; $config = array( 'host' => C('DB_HOST'), 'port' => C('DB_PORT'), 'userName' => C('DB_USER'), 'userPassword' => C('DB_PWD'), 'dbprefix' => C('DB_PREFIX'), 'charset' => 'UTF8', 'domain' => $domain, 'path' => $DataDir, 'isCompress' => 0, //\u662f\u5426\u5f00\u542fgzip\u538b\u7f29 'isDownload' => 0 ); \u901a\u8fc7\u662f\u5426\u5b9a\u4e49\u4e00\u4e9bSAE\u5e38\u91cf\u6765\u5224\u65ad\u662fSAE\u8fd8\u662f\u672c\u5730\u5f00\u53d1\u73af\u5883\uff0c\u4ece\u800c\u4f7f\u7528\u76f8\u5e94\u7684\u6587\u4ef6\u64cd\u4f5c\u4ee3\u7801 private function setFile() { $recognize = ''; $recognize = implode('_', $this->dbName); $fileName = $this->trimPath($this->config['path'] . self::DIR_SEP . $recognize.'_'.date('YmdHis') . '_' . mt_rand(100000000,999999999) .'.sql'); if(defined('SAE_ACCESSKEY')){// SAE\u73af\u5883 $s = new SaeStorage(); $result = $s->write($this->config['domain'], $fileName, $this->content); if (!$result) { $this->throwException('\u5199\u5165\u6587\u4ef6\u5931\u8d25!'); } } else{ // \u672c\u5730 ... } if ($this->config['isDownload']) { $this->downloadFile($fileName); } } \u8fd8\u539f\u6570\u636e\u5e93 \u00b6 \u540c\u7406\uff0c\u8fd8\u539f\u6570\u636e\u5e93\u65f6\u53ea\u8981\u4fee\u6b63\u8bfb\u53d6\u8fd8\u539f\u6587\u4ef6\u7684\u4ee3\u7801\u5373\u53ef private function getFile($fileName) { $this->content = ''; $fileName = $this->trimPath($this->config['path'] . self::DIR_SEP .$fileName); if(defined('SAE_ACCESSKEY')){// SAE\u73af\u5883 $s = new SaeStorage(); $this->content = $s->read($this->config['domain'], $fileName); } else{ // \u672c\u5730 ... } } \u4e0b\u8f7d\u5907\u4efd\u6587\u4ef6 \u00b6 public function downloadFile($fileName) { ob_end_clean(); header (\"Cache-Control: must-revalidate, post-check=0, pre-check=0\"); header('Content-Description: File Transfer'); header('Content-Type: application/octet-stream'); header('Content-Disposition: attachment; filename=' . basename($fileName)); if(defined('SAE_ACCESSKEY')){// SAE\u73af\u5883 $s = new SaeStorage(); echo $s->read($this->config['domain'], $fileName); } else { readfile($fileName); } exit(); } Class SaeStorage \u21a9","title":"SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#saemysqlrebackmysql","text":"\u53d1\u5e03\u4e8e\uff1a2015-06-16 | \u5206\u7c7b\uff1a web development \u4e4b\u524d\u4e00\u7bc7\u6587\u7ae0 \u4ecb\u7ecd\u4e86ThinkPHP\u6846\u67b6\u4e0b\u7684MySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b\u7684\u4f7f\u7528\uff0c\u540e\u6765\u5c06\u9879\u76ee\u8fc1\u79fb\u5230\u4e86\u65b0\u6d6a\u4e91\u8ba1\u7b97\u5e73\u53f0\u4e0a\uff0c\u7531\u4e8e\u65e0\u6cd5\u50cf\u672c\u5730\u4e00\u6837\u8bfb\u5199\u6587\u4ef6\uff0c\u5907\u4efd\u3001\u8fd8\u539f\u529f\u80fd\u4e5f\u5c31\u5931\u6548\u4e86\u3002\u672c\u6587\u5373\u9488\u5bf9\u6b64\u95ee\u9898\uff0c\u5bf9\u539f\u6765\u7684 MySQLReback.class.php \u6587\u4ef6\u4f5c\u76f8\u5e94\u4fee\u6539\uff0c\u4ee5\u9002\u5e94SAE\u73af\u5883\u3002","title":"SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#_1","text":"SAE\u4e0d\u652f\u6301\u672c\u5730\u6587\u4ef6\u7684\u8bfb\u5199\uff0c\u4f46\u662f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86 Storage \u7528\u4e8e\u6570\u636e\u7684\u5b58\u50a8\uff1a Storage\u662fSAE\u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u7684\u5206\u5e03\u5f0f\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\uff0c\u65e8\u5728\u5229\u7528SAE\u5728\u5206\u5e03\u5f0f\u4ee5\u53ca\u7f51\u7edc\u6280\u672f\u65b9\u9762\u7684\u4f18\u52bf\u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u5b89\u5168\u3001\u7b80\u5355\u3001\u9ad8\u6548\u7684\u5b58\u50a8\u670d\u52a1\u3002Storage\u652f\u6301\u6587\u672c\u3001\u591a\u5a92\u4f53\u3001\u4e8c\u8fdb\u5236\u7b49\u4efb\u4f55\u7c7b\u578b\u7684\u6570\u636e\u7684\u5b58\u50a8\u3002 \u56e0\u6b64\uff0c\u4fee\u6539\u601d\u8def\u4e3a\uff1a\u5c06\u539f\u6765\u7684\u672c\u5730\u6587\u4ef6\u64cd\u4f5c\u4ee3\u7801\u4fee\u6539\u4e3a\u517c\u5bb9 SAE Storage \u7684\u6587\u4ef6\u8bfb\u5199\u64cd\u4f5c 1 \u3002","title":"\u601d\u8def"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#_2","text":"\u5728\u9879\u76ee\u7684 Storage \u83dc\u5355\u4e0b\u65b0\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3a public \u7684 domain \uff0c\u5c06\u5907\u4efd\u6587\u4ef6\u653e\u5728\u6b64 domain \u4e0b\u7684 Backup \u6587\u4ef6\u5939\u4e0b\u3002\u8981\u5b9e\u73b0\u8bfb\u53d6\u8fd9\u4e9b\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528SAE\u63d0\u4f9b\u7684 getListByPath() \u65b9\u6cd5\u3002\u8be5\u65b9\u6cd5\u6267\u884c\u6210\u529f\u540e\u8fd4\u56de\u5305\u542b\u6587\u4ef6\u4fe1\u606f\uff08\u540d\u79f0\u3001\u5927\u5c0f\u3001\u4e0a\u4f20\u65f6\u95f4\u7b49\uff09\u7684\u6570\u7ec4\uff08\u6570\u7ec4\u7684\u5177\u4f53\u5f62\u5f0f\u7531\u6700\u540e\u4e00\u4e2a\u8f93\u5165\u53c2\u6570\u6307\u5b9a\uff09\uff0c\u6267\u884c\u5931\u8d25\u540e\u8fd4\u56de false \u3002\u53c2\u6570\u8bf4\u660e\u3001\u793a\u4f8b\u3001\u5b9e\u73b0\u4ee3\u7801\u53c2\u8003\u4e0a\u9762\u63d0\u4f9b\u7684\u5f00\u53d1\u6587\u6863\u3002\u4e0b\u9762\u7ed9\u51fa\u8bfb\u53d6\u5907\u4efd\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4ee3\u7801\uff1a public function getBacoverFiles(){ // \u672c\u5730\u5199\u6cd5 // .... // SAE\u4e0a\u5199\u6cd5 $domain = \"public\"; $s = new SaeStorage(); $files = $s->getListByPath($domain,\"Backup\",100); foreach($files[\"files\"] as $k => $v){ $list[$k]['FileName'] = $v[\"Name\"]; $list[$k]['FileTime'] = date(\"Y-m-d H:i:s\",$v[\"uploadTime\"]); $FileSize = $v[\"length\"]/1024; if ($FileSize < 1024){ $list[$k]['FileSize'] = number_format($FileSize,2).' KB'; } else { $list[$k]['FileSize'] = number_format($FileSize/1024,2).' MB'; } } $result[\"total\"] = count($list); $result[\"rows\"] = $list==null?array():$list; echo json_encode($list); }","title":"\u8bfb\u53d6\u5907\u4efd\u76ee\u5f55\u4e0b\u5df2\u6709\u7684\u6587\u4ef6"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#_3","text":"\u6d4f\u89c8\u4e00\u4e0b MySQLReback \u7c7b\u7684\u5b9e\u73b0\u4ee3\u7801\uff0c\u53ef\u4ee5\u53d1\u73b0\u8be5\u7c7b\u5148\u751f\u6210\u5907\u4efd\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5199\u5165\u5230\u76ee\u6807\u6587\u4ef6\u5939\u3002\u56e0\u6b64\u4e3a\u4e86\u517c\u5bb9SAE\u73af\u5883\uff0c\u53ea\u9700\u8981\u4fee\u6539\u4fdd\u5b58\u6587\u4ef6\u7684 setFile() \u79c1\u6709\u65b9\u6cd5\u3002\u5bf9\u5e94\u8fd9\u90e8\u5206\u4fee\u6539\uff0cSAE\u63d0\u4f9b\u4e86 write() \u65b9\u6cd5\u4f9b\u5199\u5165\u6587\u4ef6\u5230Storage\u3002\u7531\u4e8e write() \u65b9\u6cd5\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3adomain\u7684\u540d\u79f0\uff0c\u6240\u4ee5\u4e3a MySQLReback \u7c7b\u7684\u914d\u7f6e\u53c2\u6570\u63d0\u4f9b\u4e00\u4e2a domain \u952e\u503c\u5bf9\uff1a $domain = \"public\"; $config = array( 'host' => C('DB_HOST'), 'port' => C('DB_PORT'), 'userName' => C('DB_USER'), 'userPassword' => C('DB_PWD'), 'dbprefix' => C('DB_PREFIX'), 'charset' => 'UTF8', 'domain' => $domain, 'path' => $DataDir, 'isCompress' => 0, //\u662f\u5426\u5f00\u542fgzip\u538b\u7f29 'isDownload' => 0 ); \u901a\u8fc7\u662f\u5426\u5b9a\u4e49\u4e00\u4e9bSAE\u5e38\u91cf\u6765\u5224\u65ad\u662fSAE\u8fd8\u662f\u672c\u5730\u5f00\u53d1\u73af\u5883\uff0c\u4ece\u800c\u4f7f\u7528\u76f8\u5e94\u7684\u6587\u4ef6\u64cd\u4f5c\u4ee3\u7801 private function setFile() { $recognize = ''; $recognize = implode('_', $this->dbName); $fileName = $this->trimPath($this->config['path'] . self::DIR_SEP . $recognize.'_'.date('YmdHis') . '_' . mt_rand(100000000,999999999) .'.sql'); if(defined('SAE_ACCESSKEY')){// SAE\u73af\u5883 $s = new SaeStorage(); $result = $s->write($this->config['domain'], $fileName, $this->content); if (!$result) { $this->throwException('\u5199\u5165\u6587\u4ef6\u5931\u8d25!'); } } else{ // \u672c\u5730 ... } if ($this->config['isDownload']) { $this->downloadFile($fileName); } }","title":"\u5907\u4efd\u6570\u636e\u5e93"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#_4","text":"\u540c\u7406\uff0c\u8fd8\u539f\u6570\u636e\u5e93\u65f6\u53ea\u8981\u4fee\u6b63\u8bfb\u53d6\u8fd8\u539f\u6587\u4ef6\u7684\u4ee3\u7801\u5373\u53ef private function getFile($fileName) { $this->content = ''; $fileName = $this->trimPath($this->config['path'] . self::DIR_SEP .$fileName); if(defined('SAE_ACCESSKEY')){// SAE\u73af\u5883 $s = new SaeStorage(); $this->content = $s->read($this->config['domain'], $fileName); } else{ // \u672c\u5730 ... } }","title":"\u8fd8\u539f\u6570\u636e\u5e93"},{"location":"2015-06-16-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8MySQLReback%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9FMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#_5","text":"public function downloadFile($fileName) { ob_end_clean(); header (\"Cache-Control: must-revalidate, post-check=0, pre-check=0\"); header('Content-Description: File Transfer'); header('Content-Type: application/octet-stream'); header('Content-Disposition: attachment; filename=' . basename($fileName)); if(defined('SAE_ACCESSKEY')){// SAE\u73af\u5883 $s = new SaeStorage(); echo $s->read($this->config['domain'], $fileName); } else { readfile($fileName); } exit(); } Class SaeStorage \u21a9","title":"\u4e0b\u8f7d\u5907\u4efd\u6587\u4ef6"},{"location":"2015-06-17-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8PHPExcel%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/","text":"SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e \u00b6 \u53d1\u5e03\u4e8e\uff1a2015-06-17 | \u5206\u7c7b\uff1a web development \u5f53\u6211\u4eec\u5c06\u4e00\u4e9b\u6d89\u53ca\u6587\u4ef6\u8bfb\u5199\u7684\u9879\u76ee\u79fb\u5230\u4e91\u8ba1\u7b97\u5e73\u53f0\u4e0a\uff0c\u53ef\u80fd\u53d1\u73b0\u67d0\u4e9b\u5728\u672c\u5730\u8fd0\u884c\u5f97\u597d\u597d\u7684\u529f\u80fd\u4f1a\u7a81\u7136\u5931\u6548\u3002\u4f8b\u5982\uff0c\u4e4b\u524d\u5904\u7406\u7684\u662fMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u529f\u80fd\u5728\u65b0\u6d6a\u4e91\u4e0a\u7684\u4fee\u6539\u3002\u672c\u6587\u5c06\u4ee5ThinkPHP\u6846\u67b6\u4e3a\u4f8b\uff0c\u5904\u7406SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u63d2\u4ef6\u5bfc\u5165\u6570\u636e\u7684\u95ee\u9898\u3002 \u672c\u5730\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e\u7684\u6d41\u7a0b\u4e3a\uff1a\u5148\u4e0a\u4f20\u6587\u4ef6\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u6587\u4ef6\u8def\u5f84\u63d0\u4f9b\u7ed9PHPExcel\u4ee5\u4fbf\u8bfb\u53d6\u6587\u4ef6\uff0c\u6700\u540e\u64cd\u4f5cExcel\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a Vendor('Classes.PHPExcel'); //\u5c06phpExcel\u63d2\u4ef6\u653e\u5728vender\u6587\u4ef6\u5939\u4e0b // 1\u3001\u4e0a\u4f20\u6587\u4ef6\u5230\u670d\u52a1\u5668 // ... // 2\u3001\u83b7\u53d6\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84 // $filetmpname = ... // 3\u3001\u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 $objPHPExcel = PHPExcel_IOFactory::load($filetmpname); $arrExcel = $objPHPExcel->getSheet(0)->toArray(); // \u5355\u5143\u683c\u5185\u5bb9\u4e8c\u7ef4\u6570\u7ec4 // ... \u8fd9\u4e2a\u6d41\u7a0b\u5728SAE\u73af\u5883\u4e0b\u8fd8\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7Storage\u4e2d\u7684\u6587\u4ef6\u65e0\u6cd5\u50cf\u672c\u5730\u6587\u4ef6\u90a3\u6837\u76f4\u63a5\u88ab PHPExcel_IOFactory::load() \u6240\u8bfb\u53d6\u3002\u56e0\u6b64\uff0c\u9700\u8981\u5904\u7406\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684\u7b2c\u4e8c\u6b65\uff0c\u4e3aPHPExcel\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u8bfb\u53d6\u7684\u8def\u5f84\u3002\u7ecf\u6d4b\u8bd5\uff0c\u4e0b\u9762\u4e09\u79cd\u65b9\u6cd5\u90fd\u662f\u53ef\u884c\u7684\u3002 \u76f4\u63a5\u8bfb\u53d6\u5230TmpFS \u00b6 SAE\u4e0a\u4e0d\u5141\u8bb8\u5199\u672c\u5730\u6587\u4ef6\uff0c\u4f46\u662f\u63d0\u4f9b\u4e86\u5e38\u91cf SAE_TMP_PATH \uff0c\u53ef\u4ee5\u5f80\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5199\u5165\u4e34\u65f6\u6587\u4ef6\u3002\u8fd9\u91cc\u7684\u4e34\u65f6\u6587\u4ef6\u6709\u7740\u7279\u522b\u7684\u751f\u547d\u5468\u671f\uff0c\u5f53\u524d\u9875\u9762\u7684\u8bf7\u6c42\u6267\u884c\u5b8c\u4ee5\u540e\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5c31\u4f1a\u88ab\u5220\u9664\u3002TMPFS\u7684\u4ecb\u7ecd\u548c\u793a\u4f8b 1 \u3002 TMPFS\u76f8\u5f53\u4e8e\u628a\u6587\u4ef6\u8bfb\u53d6\u5230\u5185\u5b58\u4e2d\uff0c\u5bf9\u5e94_1\u4e0a\u4f20\u6587\u4ef6\u5230\u670d\u52a1\u5668_\u7684\u6b65\u9aa4\u3002\u7b2c\u4e8c\u6b65\uff0c\u83b7\u53d6\u6587\u4ef6\u8def\u5f84\u53ef\u53c2\u8003\u5982\u4e0b\u4ee3\u7801 // \u8bbe\u7f6e\u4e00\u4e2a\u4e34\u65f6\u8def\u5f84 $filetmpname = SAE_TMP_PATH . \"temp.xlsx\"; // \u5c06\u5f85\u4e0a\u4f20\u7684\u6587\u4ef6\u76f4\u63a5\u4e0a\u4f20\u5230\u4e0a\u9762\u7684\u8def\u5f84 file_put_contents($filetmpname,file_get_contents($_FILES['file']['tmp_name'])); // \u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 ... \u4e0a\u4f20\u5230Storage \u00b6 \u5982\u679c\u5e0c\u671b\u5728Storage\u4e2d\u4e5f\u4fdd\u5b58\u4e00\u4efd\u5bfc\u5165\u6570\u636e\u7684\u6587\u4ef6\uff0c\u90a3\u5c31\u4f7f\u7528\u4e0b\u9762\u7684\u6d41\u7a0b\uff1a\u4e0a\u4f20\u5230Storage\u2192\u4eceStorage\u8bfb\u53d6\u5230\u5185\u5b58\u2192\u63d0\u4f9b\u7ed9PHPExcel\u64cd\u4f5c\u3002\u672c\u8d28\u4e0a\uff0c\u8fd9\u4e5f\u662f\u4f7f\u7528\u4e86TmpFS\u529f\u80fd\u3002 // 1\u3001\u4e0a\u4f20\u6587\u4ef6\u5230storage if ($_FILES[\"file\"][\"error\"] > 0){ $this->ajaxReturn(\"\",$_FILES[\"file\"][\"error\"],0); } else{ $domain = \"public\"; // storage\u540d\u79f0\uff0c\u9700\u8981\u4e8b\u5148\u5efa\u7acb $filename_arr = explode(\".\",$_FILES[\"file\"][\"name\"]); $filename_arr[0] = 'Uploads/' . date(\"ymdHis\") . '_' . rand(10000, 99999); $filename = implode(\".\",$filename_arr); $tmp_name = $_FILES['file']['tmp_name']; $q = new SaeStorage(); $result = $q->upload($domain, $filename, $tmp_name); if(!$result) { $this->ajaxReturn(\"\",\"\u6587\u4ef6\u4e0a\u4f20\u9519\u8bef\",0); } } // 2\u3001\u4eceStorage\u8bfb\u53d6\u5230\u5185\u5b58\uff0c\u83b7\u53d6\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84 $filetmpname = SAE_TMP_PATH . \"temp.xlsx\"; file_put_contents($filetmpname,$q->read($domain, $filename)); // 3\u3001\u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 $objPHPExcel = PHPExcel_IOFactory::load($filetmpname); $arrExcel = $objPHPExcel->getSheet(0)->toArray(); // \u5355\u5143\u683c\u5185\u5bb9\u4e8c\u7ef4\u6570\u7ec4 \u4f7f\u7528ThinkPHP\u7684\u517c\u5bb9SAE\u7684\u6587\u4ef6\u4e0a\u4f20\u7c7b\u2014\u2014UploadFile() \u00b6 ThinkPHP\u7684\u6587\u4ef6\u4e0a\u4f20\u7c7b\u5df2\u7ecf\u517c\u5bb9\u4e86\u672c\u5730\u548cSAE\u7684\u6587\u4ef6\u64cd\u4f5c\uff0c\u56e0\u6b64\u4e0a\u4e00\u8282\u7684\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528UploadFile\u7c7b\u6765\u5b9e\u73b0\u3002 // \u517c\u5bb9\u672c\u5730\u53caSAE\u7684\u73af\u5883\u7684\u5199\u6cd5 // 1\u3001\u4e0a\u4f20\u6587\u4ef6\uff1a\u672c\u5730\u4e0a\u4f20\u5230\u6307\u5b9a\u7684\u78c1\u76d8\u76ee\u5f55\uff0cSAE\u4e0a\u4f20\u5230\u6307\u5b9a\u7684Storage\u76ee\u5f55 import('ORG.Net.UploadFile'); $upload = new UploadFile();// \u5b9e\u4f8b\u5316\u4e0a\u4f20\u7c7b $upload->maxSize = 3145728 ;// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5927\u5c0f\u4e3a3M $upload->allowExts = array('xlsx', 'xls');// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u7c7b\u578b $upload->savePath = './Public/Uploads/';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u76ee\u5f55 if(!$upload->upload()) {// \u4e0a\u4f20\u9519\u8bef\u63d0\u793a\u9519\u8bef\u4fe1\u606f $this->ajaxReturn(\"\",$upload->getErrorMsg(),0); } else{// \u4e0a\u4f20\u6210\u529f \u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u4fe1\u606f $info = $upload->getUploadFileInfo(); } // 2\u3001\u83b7\u53d6\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84 if(defined('SAE_ACCESSKEY')){ // SAE\u73af\u5883 $filename = $info[0][savepath].$info[0][savename]; $filetmpname = SAE_TMP_PATH . \"temp.xlsx\"; $q = new SaeStorage(); file_put_contents($filetmpname,$q->read($domain, $filename)); } else{ // \u672c\u5730\u73af\u5883 $filetmpname = $info[0][savepath].$info[0][savename]; } // 3\u3001\u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 $objPHPExcel = PHPExcel_IOFactory::load($filetmpname); $arrExcel = $objPHPExcel->getSheet(0)->toArray(); // \u5355\u5143\u683c\u5185\u5bb9\u4e8c\u7ef4\u6570\u7ec4 Alpha2\u65b0\u529f\u80fd\u4e4bTMPFS \u21a9","title":"SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e"},{"location":"2015-06-17-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8PHPExcel%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/#saephpexcel","text":"\u53d1\u5e03\u4e8e\uff1a2015-06-17 | \u5206\u7c7b\uff1a web development \u5f53\u6211\u4eec\u5c06\u4e00\u4e9b\u6d89\u53ca\u6587\u4ef6\u8bfb\u5199\u7684\u9879\u76ee\u79fb\u5230\u4e91\u8ba1\u7b97\u5e73\u53f0\u4e0a\uff0c\u53ef\u80fd\u53d1\u73b0\u67d0\u4e9b\u5728\u672c\u5730\u8fd0\u884c\u5f97\u597d\u597d\u7684\u529f\u80fd\u4f1a\u7a81\u7136\u5931\u6548\u3002\u4f8b\u5982\uff0c\u4e4b\u524d\u5904\u7406\u7684\u662fMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u529f\u80fd\u5728\u65b0\u6d6a\u4e91\u4e0a\u7684\u4fee\u6539\u3002\u672c\u6587\u5c06\u4ee5ThinkPHP\u6846\u67b6\u4e3a\u4f8b\uff0c\u5904\u7406SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u63d2\u4ef6\u5bfc\u5165\u6570\u636e\u7684\u95ee\u9898\u3002 \u672c\u5730\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e\u7684\u6d41\u7a0b\u4e3a\uff1a\u5148\u4e0a\u4f20\u6587\u4ef6\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u6587\u4ef6\u8def\u5f84\u63d0\u4f9b\u7ed9PHPExcel\u4ee5\u4fbf\u8bfb\u53d6\u6587\u4ef6\uff0c\u6700\u540e\u64cd\u4f5cExcel\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a Vendor('Classes.PHPExcel'); //\u5c06phpExcel\u63d2\u4ef6\u653e\u5728vender\u6587\u4ef6\u5939\u4e0b // 1\u3001\u4e0a\u4f20\u6587\u4ef6\u5230\u670d\u52a1\u5668 // ... // 2\u3001\u83b7\u53d6\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84 // $filetmpname = ... // 3\u3001\u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 $objPHPExcel = PHPExcel_IOFactory::load($filetmpname); $arrExcel = $objPHPExcel->getSheet(0)->toArray(); // \u5355\u5143\u683c\u5185\u5bb9\u4e8c\u7ef4\u6570\u7ec4 // ... \u8fd9\u4e2a\u6d41\u7a0b\u5728SAE\u73af\u5883\u4e0b\u8fd8\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7Storage\u4e2d\u7684\u6587\u4ef6\u65e0\u6cd5\u50cf\u672c\u5730\u6587\u4ef6\u90a3\u6837\u76f4\u63a5\u88ab PHPExcel_IOFactory::load() \u6240\u8bfb\u53d6\u3002\u56e0\u6b64\uff0c\u9700\u8981\u5904\u7406\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684\u7b2c\u4e8c\u6b65\uff0c\u4e3aPHPExcel\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u8bfb\u53d6\u7684\u8def\u5f84\u3002\u7ecf\u6d4b\u8bd5\uff0c\u4e0b\u9762\u4e09\u79cd\u65b9\u6cd5\u90fd\u662f\u53ef\u884c\u7684\u3002","title":"SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e"},{"location":"2015-06-17-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8PHPExcel%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/#tmpfs","text":"SAE\u4e0a\u4e0d\u5141\u8bb8\u5199\u672c\u5730\u6587\u4ef6\uff0c\u4f46\u662f\u63d0\u4f9b\u4e86\u5e38\u91cf SAE_TMP_PATH \uff0c\u53ef\u4ee5\u5f80\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5199\u5165\u4e34\u65f6\u6587\u4ef6\u3002\u8fd9\u91cc\u7684\u4e34\u65f6\u6587\u4ef6\u6709\u7740\u7279\u522b\u7684\u751f\u547d\u5468\u671f\uff0c\u5f53\u524d\u9875\u9762\u7684\u8bf7\u6c42\u6267\u884c\u5b8c\u4ee5\u540e\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5c31\u4f1a\u88ab\u5220\u9664\u3002TMPFS\u7684\u4ecb\u7ecd\u548c\u793a\u4f8b 1 \u3002 TMPFS\u76f8\u5f53\u4e8e\u628a\u6587\u4ef6\u8bfb\u53d6\u5230\u5185\u5b58\u4e2d\uff0c\u5bf9\u5e94_1\u4e0a\u4f20\u6587\u4ef6\u5230\u670d\u52a1\u5668_\u7684\u6b65\u9aa4\u3002\u7b2c\u4e8c\u6b65\uff0c\u83b7\u53d6\u6587\u4ef6\u8def\u5f84\u53ef\u53c2\u8003\u5982\u4e0b\u4ee3\u7801 // \u8bbe\u7f6e\u4e00\u4e2a\u4e34\u65f6\u8def\u5f84 $filetmpname = SAE_TMP_PATH . \"temp.xlsx\"; // \u5c06\u5f85\u4e0a\u4f20\u7684\u6587\u4ef6\u76f4\u63a5\u4e0a\u4f20\u5230\u4e0a\u9762\u7684\u8def\u5f84 file_put_contents($filetmpname,file_get_contents($_FILES['file']['tmp_name'])); // \u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 ...","title":"\u76f4\u63a5\u8bfb\u53d6\u5230TmpFS"},{"location":"2015-06-17-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8PHPExcel%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/#storage","text":"\u5982\u679c\u5e0c\u671b\u5728Storage\u4e2d\u4e5f\u4fdd\u5b58\u4e00\u4efd\u5bfc\u5165\u6570\u636e\u7684\u6587\u4ef6\uff0c\u90a3\u5c31\u4f7f\u7528\u4e0b\u9762\u7684\u6d41\u7a0b\uff1a\u4e0a\u4f20\u5230Storage\u2192\u4eceStorage\u8bfb\u53d6\u5230\u5185\u5b58\u2192\u63d0\u4f9b\u7ed9PHPExcel\u64cd\u4f5c\u3002\u672c\u8d28\u4e0a\uff0c\u8fd9\u4e5f\u662f\u4f7f\u7528\u4e86TmpFS\u529f\u80fd\u3002 // 1\u3001\u4e0a\u4f20\u6587\u4ef6\u5230storage if ($_FILES[\"file\"][\"error\"] > 0){ $this->ajaxReturn(\"\",$_FILES[\"file\"][\"error\"],0); } else{ $domain = \"public\"; // storage\u540d\u79f0\uff0c\u9700\u8981\u4e8b\u5148\u5efa\u7acb $filename_arr = explode(\".\",$_FILES[\"file\"][\"name\"]); $filename_arr[0] = 'Uploads/' . date(\"ymdHis\") . '_' . rand(10000, 99999); $filename = implode(\".\",$filename_arr); $tmp_name = $_FILES['file']['tmp_name']; $q = new SaeStorage(); $result = $q->upload($domain, $filename, $tmp_name); if(!$result) { $this->ajaxReturn(\"\",\"\u6587\u4ef6\u4e0a\u4f20\u9519\u8bef\",0); } } // 2\u3001\u4eceStorage\u8bfb\u53d6\u5230\u5185\u5b58\uff0c\u83b7\u53d6\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84 $filetmpname = SAE_TMP_PATH . \"temp.xlsx\"; file_put_contents($filetmpname,$q->read($domain, $filename)); // 3\u3001\u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 $objPHPExcel = PHPExcel_IOFactory::load($filetmpname); $arrExcel = $objPHPExcel->getSheet(0)->toArray(); // \u5355\u5143\u683c\u5185\u5bb9\u4e8c\u7ef4\u6570\u7ec4","title":"\u4e0a\u4f20\u5230Storage"},{"location":"2015-06-17-SAE%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8PHPExcel%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/#thinkphpsaeuploadfile","text":"ThinkPHP\u7684\u6587\u4ef6\u4e0a\u4f20\u7c7b\u5df2\u7ecf\u517c\u5bb9\u4e86\u672c\u5730\u548cSAE\u7684\u6587\u4ef6\u64cd\u4f5c\uff0c\u56e0\u6b64\u4e0a\u4e00\u8282\u7684\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528UploadFile\u7c7b\u6765\u5b9e\u73b0\u3002 // \u517c\u5bb9\u672c\u5730\u53caSAE\u7684\u73af\u5883\u7684\u5199\u6cd5 // 1\u3001\u4e0a\u4f20\u6587\u4ef6\uff1a\u672c\u5730\u4e0a\u4f20\u5230\u6307\u5b9a\u7684\u78c1\u76d8\u76ee\u5f55\uff0cSAE\u4e0a\u4f20\u5230\u6307\u5b9a\u7684Storage\u76ee\u5f55 import('ORG.Net.UploadFile'); $upload = new UploadFile();// \u5b9e\u4f8b\u5316\u4e0a\u4f20\u7c7b $upload->maxSize = 3145728 ;// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5927\u5c0f\u4e3a3M $upload->allowExts = array('xlsx', 'xls');// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u7c7b\u578b $upload->savePath = './Public/Uploads/';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u76ee\u5f55 if(!$upload->upload()) {// \u4e0a\u4f20\u9519\u8bef\u63d0\u793a\u9519\u8bef\u4fe1\u606f $this->ajaxReturn(\"\",$upload->getErrorMsg(),0); } else{// \u4e0a\u4f20\u6210\u529f \u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u4fe1\u606f $info = $upload->getUploadFileInfo(); } // 2\u3001\u83b7\u53d6\u751f\u6210\u7684\u6587\u4ef6\u8def\u5f84 if(defined('SAE_ACCESSKEY')){ // SAE\u73af\u5883 $filename = $info[0][savepath].$info[0][savename]; $filetmpname = SAE_TMP_PATH . \"temp.xlsx\"; $q = new SaeStorage(); file_put_contents($filetmpname,$q->read($domain, $filename)); } else{ // \u672c\u5730\u73af\u5883 $filetmpname = $info[0][savepath].$info[0][savename]; } // 3\u3001\u8bfb\u53d6\u548c\u64cd\u4f5c\u6587\u4ef6 $objPHPExcel = PHPExcel_IOFactory::load($filetmpname); $arrExcel = $objPHPExcel->getSheet(0)->toArray(); // \u5355\u5143\u683c\u5185\u5bb9\u4e8c\u7ef4\u6570\u7ec4 Alpha2\u65b0\u529f\u80fd\u4e4bTMPFS \u21a9","title":"\u4f7f\u7528ThinkPHP\u7684\u517c\u5bb9SAE\u7684\u6587\u4ef6\u4e0a\u4f20\u7c7b\u2014\u2014UploadFile()"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/","text":"\u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861 \u00b6 \u53d1\u5e03\u4e8e\uff1a2015-11-04 | \u5206\u7c7b\uff1a mathematics \u6700\u8fd1\u534f\u52a9\u4e00\u4f4d\u7ecf\u6d4e\u5b66\u4e13\u4e1a\u7684\u540c\u5b66\u5b8c\u6210\u4e86\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08Social Accounting Matrix\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861\uff0c\u73b0\u8bb0\u5f55\u6b64\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u8981\u70b9\uff0c\u4ee5\u4f5c\u5907\u5fd8\u3002 \u9996\u5148\u4f7f\u7528 0-1\u77e9\u9635\u6cd5 \u96c6\u7ed3\u8d26\u6237\uff0c\u7136\u540e\u4f7f\u7528 \u76f4\u63a5\u4ea4\u53c9\u71b5\u6cd5 \u5e73\u8861SAM\uff0c\u5177\u4f53\u6d41\u7a0b\u4e3a\uff1a \u4f7f\u7528Matlab\u8f6f\u4ef6\u4eceExcel\u6587\u4ef6\u8bfb\u5165\u539f\u59cb\u6570\u636e \u5206\u522b\u5de6\u4e58\u548c\u53f3\u4e58\u76f8\u5e94\u7684\u77e9\u9635\u96c6\u7ed3\u8d26\u6237 \u8f93\u51fa\u96c6\u7ed3\u540e\u7684SAM\u6570\u636e\u5230Excel\u6587\u4ef6 \u4f7f\u7528GAMS\u8f6f\u4ef6\u8bfb\u5165\u4e0a\u4e00\u6b65\u8f93\u51fa\u7684SAM\u6570\u636e \u4f18\u5316\u5f97\u5230\u5e73\u8861\u540e\u7684SAM\u6570\u636e \u8f93\u51fa\u5230Excel\u6587\u4ef6 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u7531\u4e8e\u4e0d\u4e86\u89e3\u76f8\u5173\u4e13\u4e1a\u80cc\u666f\uff0c\u4e0b\u9762\u5c31\u76f4\u63a5\u4ece\u6570\u5b66\u89d2\u5ea6\u8fdb\u884c\u63cf\u8ff0\u3002\u4e00\u4e2a\u7b80\u5316\u7248\uff08\u51cf\u5c11\u8d26\u6237\u6570\u548c\u8981\u7d20\u6570\uff09\u7684SAM\u8868\u5373\u4e00\u4e2a\u77e9\u9635\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u7684\u9700\u6c42\u662f\uff1a \u5c06\u8d26\u6237B\u548cD\u5408\u5e76\u4e3a\u8d26\u6237BD \u8003\u8651\u5230B\u3001D\u5546\u54c1\u8d26\u6237\u5206\u522b\u5bf9\u5e94\u4e86B\u3001D\u6d3b\u52a8\u8d26\u6237\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u9700\u8981\u5408\u5e76\u77e9\u9635\u4e2dB\u5546\u54c1\u3001D\u5546\u54c1\u5217\u4e3a\u4e00\u4e2aBD\u5546\u54c1\u5217\uff0c\u540c\u65f6\u5408\u5e76B\u6d3b\u52a8\u3001D\u6d3b\u52a8\u5217\u4e3aBD\u6d3b\u52a8\u5217\u3002 \u5e73\u8861SAM\u8868 \u901a\u8fc7\u4ea4\u53c9\u71b5\u5b9a\u4e49\u7684\u6a21\u578b\u8c03\u6574\u77e9\u9635\u7684\u5143\u7d20\uff0c\u4f7f\u4e4b\u6ee1\u8db3\u7b2ci\u884c\u5143\u7d20\u4e4b\u548c\u4e0e\u7b2ci\u5217\u5143\u7d20\u4e4b\u548c\u76f8\u7b49\u3002 \u5408\u5e76\u77e9\u9635 \u00b6 \u5047\u8bbe \\alpha \\alpha \u662f\u4e00\u4e2a\u5143\u7d20\u4e3a0\u62161\u7684\u884c\u5411\u91cf\uff0c\u5219\u6839\u636e\u77e9\u9635\u4e58\u6cd5\u8fd0\u7b97\u89c4\u5f8b\u53ef\u77e5\uff0c\u77e9\u9635 M M \u5de6\u4e58 \\alpha \\alpha \u7684\u6548\u679c\u4e3a\uff1a\u5c06\u77e9\u9635 M M \u7684\u67d0\u4e9b\u884c\u76f8\u52a0\uff0c\u800c\u8fd9\u4e9b\u884c\u6070\u597d\u662f\u884c\u5411\u91cf \\alpha \\alpha \u4e2d\u5143\u7d201\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u540c\u7406\uff0c\u77e9\u9635 M M \u53f3\u4e58\u5143\u7d20\u4e3a0\u62161\u7684\u5217\u5411\u91cf \\beta \\beta \uff0c\u53ef\u4ee5\u5c06 \\beta \\beta \u4e2d\u5143\u7d201\u4f4d\u7f6e\u5bf9\u5e94\u77e9\u9635 M M \u7684\u5217\u6c42\u548c\u3002 \u56e0\u6b64\uff0c\u5f97\u5230\u7ed3\u8bba\uff1a \u5de6\u4e580-1\u884c\u5411\u91cf\u53ef\u4ee5\u5408\u5e76\u884c\uff0c\u53f3\u4e580-1\u5217\u5411\u91cf\u53ef\u4ee5\u5408\u5e76\u5217 \u3002 \u4e8e\u662f\uff0c\u5c06\u5408\u5e76\u4e0d\u540c\u884c\u7684\u884c\u5411\u91cf (\\alpha_1, \\alpha_2, \\cdots) (\\alpha_1, \\alpha_2, \\cdots) \u7ec4\u5408\u4e3a\u77e9\u9635 A A \uff1b\u7531\u4e8e\u9700\u8981\u5408\u5e76\u7684\u5217\u4e0e\u884c\u662f\u76f8\u5bf9\u5e94\u7684\uff0c\u6240\u4ee5\u53f3\u4e58\u7684\u5408\u5e76\u77e9\u9635\u5373\u4e3a A A \u7684\u8f6c\u7f6e\u77e9\u9635 A^T A^T \u3002\u6700\u7ec8\uff0c\u5408\u5e76\u540e\u7684\u77e9\u9635 N=A\\,M\\,A^T N=A\\,M\\,A^T \u3002 \u6839\u636e\u4ee5\u4e0a\u63a8\u7406\uff0c\u672c\u4f8b\u7684\u5408\u5e76\u77e9\u9635 A A \u5982\u4e0b\u56fe\u6240\u793a\uff1a \u4f8b\u5982\uff0c\u7b2c\u4e00\u884c\u7684\u884c\u5411\u91cf\u53ea\u6709\u7b2c1\u4e2a\u5143\u7d20\u4e3a1\uff0c\u8868\u793a\u63d0\u53d6\u539f\u77e9\u9635\u7684\u7b2c\u4e00\u884c\uff1b\u7b2c\u4e8c\u884c\u7684\u7b2c2,4\u4e2a\u5143\u7d20\u4e3a1\uff0c\u8868\u793a\u63d0\u53d6\u539f\u77e9\u9635\u7684\u7b2c\u4e8c\u3001\u56db\u884c\uff0c\u5373\u5408\u5e76B\u3001D\u5546\u54c1\uff0c\u5176\u4ed6\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bf9\u4e8e\u672c\u4f8bSAM\u77e9\u9635\u884c\u5217\u6570\u8f83\u5c11\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\u5408\u5e76\u77e9\u9635A\u3002\u4f46\u662f\uff0c\u5982\u679c\u5b9e\u9645\u60c5\u51b5\u4e0b\u884c\u5217\u6570\u975e\u5e38\u591a\uff08\u4f8b\u5982\u5b9e\u9645\u5904\u7406\u65f6\u4e3a94\u00d794\uff09\uff0c\u5219\u9700\u8981\u7a0b\u5e8f\u81ea\u52a8\u751f\u6210\u3002\u89c2\u5bdf\u4ee5\u4e0a\u793a\u4f8b\u77e9\u9635\uff0c\u53ef\u77e5\u5176\u5177\u6709\u5982\u4e0b\u89c4\u5f8b\uff1a \u9664\u4e86\u56fe\u4e2d\u7d2b\u8272\u3001\u6a59\u8272\u6807\u793a\u51fa\u7684\u77e9\u9635\u5757\u4e4b\u5916\uff0c\u5176\u4f59\u5143\u7d20\u90fd\u4e3a0\uff1b \u4e24\u4e2a\u7d2b\u8272\u7684\u77e9\u9635\u5757\u5b8c\u5168\u4e00\u81f4\uff0c\u5176\u7279\u70b9\u4e3a\u9700\u8981\u5408\u5e76\u4f4d\u7f6e\u7684\u5143\u7d20\u4e3a1\uff0c\u5176\u4f59\u4f4d\u7f6e\u5143\u7d20\u4e3a0\uff1b \u6a59\u8272\u77e9\u9635\u5757\u4e3a\u4e00\u4e2a\u5355\u4f4d\u77e9\u9635\u3002 \u6240\u4ee5\u6784\u9020\u5408\u5e76\u77e9\u9635 A A \u7684\u601d\u8def\u4e3a\uff1a\u751f\u6210\u7d2b\u8272\u7684\u77e9\u9635\u5757\u2192\u6269\u5145\u4e3a\u5de6\u4e0a\u89d2\u90e8\u5206\u77e9\u9635\u2192\u751f\u6210\u53f3\u4e0b\u89d2\u5355\u4f4d\u77e9\u9635\u2192\u6269\u5145\u4e3a\u5b8c\u6574\u7684\u5408\u5e76\u77e9\u9635\u3002\u8fd9\u5728Matlab\u4e2d\u5f88\u5bb9\u6613\u5b9e\u73b0\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a % \u8bfb\u5165\u6307\u5b9a\u533a\u57df\u7684\u539f\u59cb\u6570\u636e data = xlsread(filename,input_sheet,range); data(isnan(data)) = 0.0; % \u5c06\u7a7a\u503c\u8bbe\u4e3a0 % \u5408\u5e76\u89c4\u5219 col = {1,[2,4],3}; % \u8868\u793aA\u3001B+D\u3001C N = length(cell2mat(col)); % \u5408\u5e76\u524d\u5546\u54c1/\u6d3b\u52a8\u6570 T = length(col); % \u5408\u5e76\u540e\u5546\u54c1/\u6d3b\u52a8\u6570 M = size(data,1) - 2*N; % \u5176\u4ed6\u9879\u76ee\u6570\uff08\u4f8b\u5982\u793a\u4f8b\u7684X\uff0cY\uff0cZ\u7b49\uff09 % \u6784\u9020\u7d2b\u8272\u77e9\u9635\u5757 sub_a = zeros(T, N); for i =1:T sub_a(i,col{i}) = 1; % \u5c06\u5408\u5e76\u8981\u6c42\u4e2d\u6307\u5b9a\u4f4d\u7f6e\u7684\u5143\u7d20\u8bbe\u7f6e\u4e3a1 end % \u6269\u5145\u4e3a\u9488\u5bf9\u5546\u54c1&amp;\u6d3b\u52a8\u7684\u77e9\u9635\u5757 sub_a = [sub_a zeros(size(sub_a)); zeros(size(sub_a)) sub_a]; % \u7ec4\u88c5\u4e3a\u603b\u7684\u5408\u5e76\u77e9\u9635 A = [sub_a zeros(2*T,M);zeros(M,2*N) eye(M)]; % \u5408\u5e76\u77e9\u9635 ydata = A*data*A'; \u5e73\u8861\u77e9\u9635 \u00b6 \u5e73\u8861SAM\u8868\u4f7f\u7528\u7684\u662f\u76f4\u63a5\u4ea4\u53c9\u71b5\u6cd5\uff0c\u6a21\u578b\u53ca\u539f\u7406\u4e0d\u5728\u6b64\u9610\u8ff0\uff0cGAMS\u6c42\u89e3\u7a0b\u5e8f\u53ef\u4ee5\u53c2\u8003\u76f8\u5173\u4e13\u4e1a\u7684\u6750\u6599\uff0c\u4f8b\u5982\u300a\u53ef\u8ba1\u7b97\u4e00\u822c\u5747\u8861\u6a21\u578b\u7684\u57fa\u672c\u539f\u7406\u4e0e\u7f16\u7a0b\u300b\u7684\u7b2c\u4e94\u7ae0\u300aSAM\u8868\u7684\u5e73\u8861\u300b\u3002\u5b9e\u9645\u64cd\u4f5c\u4e2d\u9700\u8981\u6ce8\u610fSAM\u8868\u7684\u8bfb\u5199\uff0c\u8fd9\u53ef\u4ee5\u53c2\u8003GAMS\u76f8\u5173\u6587\u6863 1 \u3002 SAM\u8868\u7684\u8bfb\u5165 \u00b6 \u5bf9\u4e8e\u6570\u636e\u8f83\u5c11\u7684\u60c5\u51b5\uff0c\u4f8b\u5982\u672c\u4f8b\u53ef\u4ee5\u76f4\u63a5\u4ee5 table \u7684\u5f62\u5f0f\u8f93\u5165\uff1b\u4f46\u662f\uff0c\u5982\u679c\u6570\u636e\u91cf\u5f88\u5927\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u8bfb\u5165Excel\u6587\u4ef6\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a set i \"\u5b9a\u4e49\u9879\u76ee\u96c6\u5408\uff0c\u5047\u8bbe\u670960\u4e2a\u8d26\u6237\" /data1*data60/ ; alias(i,j) ; Parameters sam(i,j) \"\u6838\u7b97\u77e9\u9635\" ; * \u8bfb\u5165\u5408\u5e76\u540e\u7684SAM\u8868\uff0c\u8d4b\u503c\u7ed9sam\u53c2\u6570 $libinclude xlimport sam C:\\Users\\Administrator\\GAMS\\SAM.xlsx sheet2!A1:BI61 SAM\u8868\u7684\u5199\u51fa \u00b6 \u7c7b\u4f3c\u5730\uff0c\u5c06\u5e73\u8861\u540e\u7684SAM\u8868\u6570\u636e\u5199\u51fa\u5230Excel\u6587\u4ef6\u7684\u4ee3\u7801\u5982\u4e0b\uff1a * \u5199Excel\u6587\u4ef6, Q\u4e3a\u5e73\u8861\u8c03\u6574\u540e\u7684\u6570\u636e $LIBInclude Xlexport Q.l C:\\Users\\Administrator\\Desktop\\temp\\GAMS\\SAM.xlsx sheet3!A1:BI61 \u6700\u540e\u7279\u522b\u6ce8\u610f\uff1a \u8bfb\u5165\u7684SAM\u8868\u4e2d\u5fc5\u987b\u5305\u542b\u4e0eGAMS\u7a0b\u5e8f\u4e2d\u7684 set \u4e00\u81f4\u7684\u7d22\u5f15\uff08\u8868\u5934\uff09\uff0c\u5199\u51faExcel\u6587\u4ef6\u7684\u5de5\u4f5c\u8868\u4e2d\u4e5f\u5fc5\u987b\u4e8b\u5148\u5b58\u5728\u4e0eSAM\u8868\u4e00\u81f4\u7684\u7d22\u5f15\u3002 Customized data interchange links for spreadsheets ] \u21a9","title":"\u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/#sam","text":"\u53d1\u5e03\u4e8e\uff1a2015-11-04 | \u5206\u7c7b\uff1a mathematics \u6700\u8fd1\u534f\u52a9\u4e00\u4f4d\u7ecf\u6d4e\u5b66\u4e13\u4e1a\u7684\u540c\u5b66\u5b8c\u6210\u4e86\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08Social Accounting Matrix\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861\uff0c\u73b0\u8bb0\u5f55\u6b64\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u8981\u70b9\uff0c\u4ee5\u4f5c\u5907\u5fd8\u3002 \u9996\u5148\u4f7f\u7528 0-1\u77e9\u9635\u6cd5 \u96c6\u7ed3\u8d26\u6237\uff0c\u7136\u540e\u4f7f\u7528 \u76f4\u63a5\u4ea4\u53c9\u71b5\u6cd5 \u5e73\u8861SAM\uff0c\u5177\u4f53\u6d41\u7a0b\u4e3a\uff1a \u4f7f\u7528Matlab\u8f6f\u4ef6\u4eceExcel\u6587\u4ef6\u8bfb\u5165\u539f\u59cb\u6570\u636e \u5206\u522b\u5de6\u4e58\u548c\u53f3\u4e58\u76f8\u5e94\u7684\u77e9\u9635\u96c6\u7ed3\u8d26\u6237 \u8f93\u51fa\u96c6\u7ed3\u540e\u7684SAM\u6570\u636e\u5230Excel\u6587\u4ef6 \u4f7f\u7528GAMS\u8f6f\u4ef6\u8bfb\u5165\u4e0a\u4e00\u6b65\u8f93\u51fa\u7684SAM\u6570\u636e \u4f18\u5316\u5f97\u5230\u5e73\u8861\u540e\u7684SAM\u6570\u636e \u8f93\u51fa\u5230Excel\u6587\u4ef6","title":"\u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/#_1","text":"\u7531\u4e8e\u4e0d\u4e86\u89e3\u76f8\u5173\u4e13\u4e1a\u80cc\u666f\uff0c\u4e0b\u9762\u5c31\u76f4\u63a5\u4ece\u6570\u5b66\u89d2\u5ea6\u8fdb\u884c\u63cf\u8ff0\u3002\u4e00\u4e2a\u7b80\u5316\u7248\uff08\u51cf\u5c11\u8d26\u6237\u6570\u548c\u8981\u7d20\u6570\uff09\u7684SAM\u8868\u5373\u4e00\u4e2a\u77e9\u9635\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u7684\u9700\u6c42\u662f\uff1a \u5c06\u8d26\u6237B\u548cD\u5408\u5e76\u4e3a\u8d26\u6237BD \u8003\u8651\u5230B\u3001D\u5546\u54c1\u8d26\u6237\u5206\u522b\u5bf9\u5e94\u4e86B\u3001D\u6d3b\u52a8\u8d26\u6237\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u9700\u8981\u5408\u5e76\u77e9\u9635\u4e2dB\u5546\u54c1\u3001D\u5546\u54c1\u5217\u4e3a\u4e00\u4e2aBD\u5546\u54c1\u5217\uff0c\u540c\u65f6\u5408\u5e76B\u6d3b\u52a8\u3001D\u6d3b\u52a8\u5217\u4e3aBD\u6d3b\u52a8\u5217\u3002 \u5e73\u8861SAM\u8868 \u901a\u8fc7\u4ea4\u53c9\u71b5\u5b9a\u4e49\u7684\u6a21\u578b\u8c03\u6574\u77e9\u9635\u7684\u5143\u7d20\uff0c\u4f7f\u4e4b\u6ee1\u8db3\u7b2ci\u884c\u5143\u7d20\u4e4b\u548c\u4e0e\u7b2ci\u5217\u5143\u7d20\u4e4b\u548c\u76f8\u7b49\u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/#_2","text":"\u5047\u8bbe \\alpha \\alpha \u662f\u4e00\u4e2a\u5143\u7d20\u4e3a0\u62161\u7684\u884c\u5411\u91cf\uff0c\u5219\u6839\u636e\u77e9\u9635\u4e58\u6cd5\u8fd0\u7b97\u89c4\u5f8b\u53ef\u77e5\uff0c\u77e9\u9635 M M \u5de6\u4e58 \\alpha \\alpha \u7684\u6548\u679c\u4e3a\uff1a\u5c06\u77e9\u9635 M M \u7684\u67d0\u4e9b\u884c\u76f8\u52a0\uff0c\u800c\u8fd9\u4e9b\u884c\u6070\u597d\u662f\u884c\u5411\u91cf \\alpha \\alpha \u4e2d\u5143\u7d201\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u540c\u7406\uff0c\u77e9\u9635 M M \u53f3\u4e58\u5143\u7d20\u4e3a0\u62161\u7684\u5217\u5411\u91cf \\beta \\beta \uff0c\u53ef\u4ee5\u5c06 \\beta \\beta \u4e2d\u5143\u7d201\u4f4d\u7f6e\u5bf9\u5e94\u77e9\u9635 M M \u7684\u5217\u6c42\u548c\u3002 \u56e0\u6b64\uff0c\u5f97\u5230\u7ed3\u8bba\uff1a \u5de6\u4e580-1\u884c\u5411\u91cf\u53ef\u4ee5\u5408\u5e76\u884c\uff0c\u53f3\u4e580-1\u5217\u5411\u91cf\u53ef\u4ee5\u5408\u5e76\u5217 \u3002 \u4e8e\u662f\uff0c\u5c06\u5408\u5e76\u4e0d\u540c\u884c\u7684\u884c\u5411\u91cf (\\alpha_1, \\alpha_2, \\cdots) (\\alpha_1, \\alpha_2, \\cdots) \u7ec4\u5408\u4e3a\u77e9\u9635 A A \uff1b\u7531\u4e8e\u9700\u8981\u5408\u5e76\u7684\u5217\u4e0e\u884c\u662f\u76f8\u5bf9\u5e94\u7684\uff0c\u6240\u4ee5\u53f3\u4e58\u7684\u5408\u5e76\u77e9\u9635\u5373\u4e3a A A \u7684\u8f6c\u7f6e\u77e9\u9635 A^T A^T \u3002\u6700\u7ec8\uff0c\u5408\u5e76\u540e\u7684\u77e9\u9635 N=A\\,M\\,A^T N=A\\,M\\,A^T \u3002 \u6839\u636e\u4ee5\u4e0a\u63a8\u7406\uff0c\u672c\u4f8b\u7684\u5408\u5e76\u77e9\u9635 A A \u5982\u4e0b\u56fe\u6240\u793a\uff1a \u4f8b\u5982\uff0c\u7b2c\u4e00\u884c\u7684\u884c\u5411\u91cf\u53ea\u6709\u7b2c1\u4e2a\u5143\u7d20\u4e3a1\uff0c\u8868\u793a\u63d0\u53d6\u539f\u77e9\u9635\u7684\u7b2c\u4e00\u884c\uff1b\u7b2c\u4e8c\u884c\u7684\u7b2c2,4\u4e2a\u5143\u7d20\u4e3a1\uff0c\u8868\u793a\u63d0\u53d6\u539f\u77e9\u9635\u7684\u7b2c\u4e8c\u3001\u56db\u884c\uff0c\u5373\u5408\u5e76B\u3001D\u5546\u54c1\uff0c\u5176\u4ed6\u4ee5\u6b64\u7c7b\u63a8\u3002\u5bf9\u4e8e\u672c\u4f8bSAM\u77e9\u9635\u884c\u5217\u6570\u8f83\u5c11\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\u5408\u5e76\u77e9\u9635A\u3002\u4f46\u662f\uff0c\u5982\u679c\u5b9e\u9645\u60c5\u51b5\u4e0b\u884c\u5217\u6570\u975e\u5e38\u591a\uff08\u4f8b\u5982\u5b9e\u9645\u5904\u7406\u65f6\u4e3a94\u00d794\uff09\uff0c\u5219\u9700\u8981\u7a0b\u5e8f\u81ea\u52a8\u751f\u6210\u3002\u89c2\u5bdf\u4ee5\u4e0a\u793a\u4f8b\u77e9\u9635\uff0c\u53ef\u77e5\u5176\u5177\u6709\u5982\u4e0b\u89c4\u5f8b\uff1a \u9664\u4e86\u56fe\u4e2d\u7d2b\u8272\u3001\u6a59\u8272\u6807\u793a\u51fa\u7684\u77e9\u9635\u5757\u4e4b\u5916\uff0c\u5176\u4f59\u5143\u7d20\u90fd\u4e3a0\uff1b \u4e24\u4e2a\u7d2b\u8272\u7684\u77e9\u9635\u5757\u5b8c\u5168\u4e00\u81f4\uff0c\u5176\u7279\u70b9\u4e3a\u9700\u8981\u5408\u5e76\u4f4d\u7f6e\u7684\u5143\u7d20\u4e3a1\uff0c\u5176\u4f59\u4f4d\u7f6e\u5143\u7d20\u4e3a0\uff1b \u6a59\u8272\u77e9\u9635\u5757\u4e3a\u4e00\u4e2a\u5355\u4f4d\u77e9\u9635\u3002 \u6240\u4ee5\u6784\u9020\u5408\u5e76\u77e9\u9635 A A \u7684\u601d\u8def\u4e3a\uff1a\u751f\u6210\u7d2b\u8272\u7684\u77e9\u9635\u5757\u2192\u6269\u5145\u4e3a\u5de6\u4e0a\u89d2\u90e8\u5206\u77e9\u9635\u2192\u751f\u6210\u53f3\u4e0b\u89d2\u5355\u4f4d\u77e9\u9635\u2192\u6269\u5145\u4e3a\u5b8c\u6574\u7684\u5408\u5e76\u77e9\u9635\u3002\u8fd9\u5728Matlab\u4e2d\u5f88\u5bb9\u6613\u5b9e\u73b0\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a % \u8bfb\u5165\u6307\u5b9a\u533a\u57df\u7684\u539f\u59cb\u6570\u636e data = xlsread(filename,input_sheet,range); data(isnan(data)) = 0.0; % \u5c06\u7a7a\u503c\u8bbe\u4e3a0 % \u5408\u5e76\u89c4\u5219 col = {1,[2,4],3}; % \u8868\u793aA\u3001B+D\u3001C N = length(cell2mat(col)); % \u5408\u5e76\u524d\u5546\u54c1/\u6d3b\u52a8\u6570 T = length(col); % \u5408\u5e76\u540e\u5546\u54c1/\u6d3b\u52a8\u6570 M = size(data,1) - 2*N; % \u5176\u4ed6\u9879\u76ee\u6570\uff08\u4f8b\u5982\u793a\u4f8b\u7684X\uff0cY\uff0cZ\u7b49\uff09 % \u6784\u9020\u7d2b\u8272\u77e9\u9635\u5757 sub_a = zeros(T, N); for i =1:T sub_a(i,col{i}) = 1; % \u5c06\u5408\u5e76\u8981\u6c42\u4e2d\u6307\u5b9a\u4f4d\u7f6e\u7684\u5143\u7d20\u8bbe\u7f6e\u4e3a1 end % \u6269\u5145\u4e3a\u9488\u5bf9\u5546\u54c1&amp;\u6d3b\u52a8\u7684\u77e9\u9635\u5757 sub_a = [sub_a zeros(size(sub_a)); zeros(size(sub_a)) sub_a]; % \u7ec4\u88c5\u4e3a\u603b\u7684\u5408\u5e76\u77e9\u9635 A = [sub_a zeros(2*T,M);zeros(M,2*N) eye(M)]; % \u5408\u5e76\u77e9\u9635 ydata = A*data*A';","title":"\u5408\u5e76\u77e9\u9635"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/#_3","text":"\u5e73\u8861SAM\u8868\u4f7f\u7528\u7684\u662f\u76f4\u63a5\u4ea4\u53c9\u71b5\u6cd5\uff0c\u6a21\u578b\u53ca\u539f\u7406\u4e0d\u5728\u6b64\u9610\u8ff0\uff0cGAMS\u6c42\u89e3\u7a0b\u5e8f\u53ef\u4ee5\u53c2\u8003\u76f8\u5173\u4e13\u4e1a\u7684\u6750\u6599\uff0c\u4f8b\u5982\u300a\u53ef\u8ba1\u7b97\u4e00\u822c\u5747\u8861\u6a21\u578b\u7684\u57fa\u672c\u539f\u7406\u4e0e\u7f16\u7a0b\u300b\u7684\u7b2c\u4e94\u7ae0\u300aSAM\u8868\u7684\u5e73\u8861\u300b\u3002\u5b9e\u9645\u64cd\u4f5c\u4e2d\u9700\u8981\u6ce8\u610fSAM\u8868\u7684\u8bfb\u5199\uff0c\u8fd9\u53ef\u4ee5\u53c2\u8003GAMS\u76f8\u5173\u6587\u6863 1 \u3002","title":"\u5e73\u8861\u77e9\u9635"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/#sam_1","text":"\u5bf9\u4e8e\u6570\u636e\u8f83\u5c11\u7684\u60c5\u51b5\uff0c\u4f8b\u5982\u672c\u4f8b\u53ef\u4ee5\u76f4\u63a5\u4ee5 table \u7684\u5f62\u5f0f\u8f93\u5165\uff1b\u4f46\u662f\uff0c\u5982\u679c\u6570\u636e\u91cf\u5f88\u5927\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u8bfb\u5165Excel\u6587\u4ef6\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a set i \"\u5b9a\u4e49\u9879\u76ee\u96c6\u5408\uff0c\u5047\u8bbe\u670960\u4e2a\u8d26\u6237\" /data1*data60/ ; alias(i,j) ; Parameters sam(i,j) \"\u6838\u7b97\u77e9\u9635\" ; * \u8bfb\u5165\u5408\u5e76\u540e\u7684SAM\u8868\uff0c\u8d4b\u503c\u7ed9sam\u53c2\u6570 $libinclude xlimport sam C:\\Users\\Administrator\\GAMS\\SAM.xlsx sheet2!A1:BI61","title":"SAM\u8868\u7684\u8bfb\u5165"},{"location":"2015-11-04-%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%A4%BE%E4%BC%9A%E6%A0%B8%E7%AE%97%E7%9F%A9%E9%98%B5%EF%BC%88SAM%EF%BC%89%E7%9A%84%E8%B4%A6%E6%88%B7%E9%9B%86%E7%BB%93%E4%B8%8E%E5%B9%B3%E8%A1%A1/#sam_2","text":"\u7c7b\u4f3c\u5730\uff0c\u5c06\u5e73\u8861\u540e\u7684SAM\u8868\u6570\u636e\u5199\u51fa\u5230Excel\u6587\u4ef6\u7684\u4ee3\u7801\u5982\u4e0b\uff1a * \u5199Excel\u6587\u4ef6, Q\u4e3a\u5e73\u8861\u8c03\u6574\u540e\u7684\u6570\u636e $LIBInclude Xlexport Q.l C:\\Users\\Administrator\\Desktop\\temp\\GAMS\\SAM.xlsx sheet3!A1:BI61 \u6700\u540e\u7279\u522b\u6ce8\u610f\uff1a \u8bfb\u5165\u7684SAM\u8868\u4e2d\u5fc5\u987b\u5305\u542b\u4e0eGAMS\u7a0b\u5e8f\u4e2d\u7684 set \u4e00\u81f4\u7684\u7d22\u5f15\uff08\u8868\u5934\uff09\uff0c\u5199\u51faExcel\u6587\u4ef6\u7684\u5de5\u4f5c\u8868\u4e2d\u4e5f\u5fc5\u987b\u4e8b\u5148\u5b58\u5728\u4e0eSAM\u8868\u4e00\u81f4\u7684\u7d22\u5f15\u3002 Customized data interchange links for spreadsheets ] \u21a9","title":"SAM\u8868\u7684\u5199\u51fa"},{"location":"2015-11-15-python%E4%B8%AD%E4%BD%BF%E7%94%A8mlab%E5%BA%93%E5%AE%9E%E7%8E%B0%E4%B8%8EMATLAB%E4%BA%A4%E4%BA%92/","text":"python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92 \u00b6 \u53d1\u5e03\u4e8e\uff1a2015-11-15 | \u5206\u7c7b\uff1a numeric calculation numpy \u3001 scipy \u3001 sympy \u7b49\u6269\u5c55\u5e93\u589e\u52a0\u4e86Python\u5728\u79d1\u5b66\u8ba1\u7b97\u4e0a\u7684\u4f18\u52bf\uff0c\u4f46\u662f\uff0c\u67d0\u4e9b\u51fd\u6570\u7684\u6267\u884c\u6548\u7387\u4f9d\u65e7\u6bd4\u4e0d\u4e0a\u5546\u4e1a\u5316\u7684Matlab\u3002\u4f8b\u5982\uff0c\u9488\u5bf9\u672c\u4eba\u7684\u4e00\u4e2a\u7ea6\u675f\u6781\u503c\u95ee\u9898\uff0cmatlab\u4f18\u5316\u5de5\u5177\u7bb1\u7684 fmincon() \u51fd\u6570\u76f8\u6bd4scipy.optimize\u7684 minimize() \u51fd\u6570\u8868\u73b0\u51fa\u66f4\u9ad8\u7684\u8ba1\u7b97\u6548\u7387\u3002\u56e0\u6b64\uff0c\u5728\u67d0\u4e9b\u573a\u5408\u4e0b\uff0c\u9700\u8981\u5728python\u4ee3\u7801\u4e2d\u6267\u884cmatlab\u547d\u4ee4\u3002 \u5e86\u5e78\u7684\u662f\uff0c\u5df2\u7ecf\u6709\u5f00\u6e90\u9879\u76ee\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u9700\u6c42\u3002\u5176\u4e2d\u503c\u5f97\u63a8\u8350\u7684\u662f\uff1aAlexander Schmolck \u548c Vivek Rathod \u8d1f\u8d23\u7684 mlabwrap \u3002\u6b64\u9879\u76ee\u4f5c\u8005\u7684\u672c\u610f\u662f\u5728Linux\u4e0b\u5199\u7684\uff0c\u5bf9\u4e8ewindows\u7528\u6237\u9700\u8981C++\u7f16\u8bd1\u5668\u624d\u80fd\u6210\u529f\u5b89\u88c5\u3002Yauhen Yakimovich\u5728mlabwrap\u7684\u57fa\u7840\u4e0a\u5f00\u53d1\u4e86\u5e76\u4e0d\u4f9d\u8d56\u4e8eC++\u7f16\u8bd1\u5668\u7684 mlab \uff0c\u672c\u6587\u5373\u5bf9\u5176\u5b89\u88c5\u548c\u4f7f\u7528\u4f5c\u7b80\u8981\u8bf4\u660e\u3002 mlab\u7b80\u4ecb \u00b6 mlab\u7528\u4e8e\u5728python\u4e2d\u76f4\u63a5\u8c03\u7528matlab\u51fd\u6570\uff0c\u800c\u4e0d\u5fc5\u6253\u5f00matlab\u7684\u7a0b\u5e8f\u754c\u9762\uff0c\u4ece\u800c\u4f7f\u5f97 matlab\u5c31\u50cfpython\u7684\u4e00\u4e2a\u6269\u5c55\u5e93\u4e00\u6837\u3002\u5f15\u7528 mlabwrap \u9879\u76ee\u7684\u63cf\u8ff0\uff1a Mlab is a high-level python to Matlab\u00ae bridge that lets Matlab look like a normal python library. mlab\u662f\u57fa\u4e8eAlexander Schmolck\u548cVivek Rathod\u8d1f\u8d23\u7684 mlabwrap \u53caDani Valevski\u8d1f\u8d23\u7684 matlabpipe \u5f00\u53d1\u7684\u3002\u5176\u9879\u76ee\u4e3b\u9875\u4e3a\uff1a https://github.com/ewiger/mlab mlab\u83b7\u53d6\u548c\u5b89\u88c5 \u00b6 mlab\u9075\u5faa MIT \u8bb8\u53ef\u534f\u8bae\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u9879\u76ee\u5730\u5740\u4e0b\u8f7d\u6e90\u7801\uff0c\u6216\u8005\u4ecepython\u5b98\u7f51\u7684Package index\u4e0b\u8f7d\u3002\u672c\u6587\u4f7f\u7528\u7248\u672c\u4e3a mlab 1.1.4 \u3002 windows\u4e0b\u5b89\u88c5\u65b9\u6cd5\uff1a # 1\u3001\u4e8b\u5148\u5b89\u88c5\u597d numpy \u5e93\uff0cmatlab 6\u6216\u4ee5\u4e0a\u7248\u672c # 2\u3001\u5728\u547d\u4ee4\u884c\u5de5\u5177\u4e2d\uff0c\u5c06\u76ee\u5f55\u5207\u6362\u5230\u6e90\u7801\u6240\u5728\u6587\u4ef6\u5939\uff0c\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a python setup.py install \u5bfc\u5165mlab\u5e93\u540e\u5373\u53ef\u65b9\u4fbf\u5730\u4f7f\u7528matlab\u51fd\u6570\u4e86\uff1a from mlab.releases import latest_release as matlab \u5b98\u65b9\u793a\u4f8b 1 \u00b6 from mlab.releases import latest_release as matlab import numpy as np x = np.arange(-2*np.pi, 2*np.pi, 0.2) matlab.surf(np.subtract.outer(np.sin(x),np.cos(x))) \u8c03\u7528\u81ea\u5b9a\u4e49\u51fd\u6570 \u00b6 \u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u8c03\u7528\u81ea\u5b9a\u4e49\u7684matlab\u51fd\u6570\u3002\u4f8b\u5982\u65b0\u5efa\u51fd\u6570\u6587\u4ef6 myfun.m \uff0c\u4fdd\u5b58\u5728\u5f53\u524dpython\u4ee3\u7801\u6240\u5728\u76ee\u5f55\uff1a function [y1, y2] = myfun(x,y) y1 = x + 1; y2 = x.^3; \u5728python\u4ee3\u7801\u7684\u8c03\u7528\u8fc7\u7a0b\u4e2d\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u4e09\u4e2a\u95ee\u9898\uff1a \u53c2\u6570\u52a1\u5fc5\u4ee5\u6570\u7ec4/\u5217\u8868\u7684\u5f62\u5f0f\u8f93\u5165 ``` python x = matlab.myfun(1,2) print x # output: # <MlabObjectProxy of matlab-class: u'int32'; internal name: 'PROXY_VAL0__'; has parent: no> ``` ``` python x = matlab.myfun([1],[2]) print x # output: 2.0 ``` \u4f7f\u7528 nout \u53c2\u6570\u6307\u5b9a\u8f93\u51fa\u4e2a\u6570 ``` python x,y = matlab.myfun([1],[2,3,4]) print y # output: TypeError: 'float' object is not iterable ``` ``` python x,y = matlab.myfun([1],[2,3,4], nout=2) print y # output: [[ 8.] [ 27.] [ 64.]] ``` myfun.m\u6587\u4ef6\u683c\u5f0f\u5fc5\u987b\u4e3a ANSI \u5426\u5219\u5c06\u5bfc\u81f4\u5982\u4e0b\u9519\u8bef\u63d0\u793a\u3002\u5f53\u65f6\u5c31\u662f\u56f0\u6270\u597d\u4e45\u624d\u53d1\u73b0\u539f\u6765\u662f\u6587\u4ef6\u683c\u5f0f\u7684\u95ee\u9898\u3002 UserWarning: Couldn't ascertain number of output args for 'myfun', assuming 1. mlabwrap Documentation \u21a9","title":"python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92"},{"location":"2015-11-15-python%E4%B8%AD%E4%BD%BF%E7%94%A8mlab%E5%BA%93%E5%AE%9E%E7%8E%B0%E4%B8%8EMATLAB%E4%BA%A4%E4%BA%92/#pythonmlabmatlab","text":"\u53d1\u5e03\u4e8e\uff1a2015-11-15 | \u5206\u7c7b\uff1a numeric calculation numpy \u3001 scipy \u3001 sympy \u7b49\u6269\u5c55\u5e93\u589e\u52a0\u4e86Python\u5728\u79d1\u5b66\u8ba1\u7b97\u4e0a\u7684\u4f18\u52bf\uff0c\u4f46\u662f\uff0c\u67d0\u4e9b\u51fd\u6570\u7684\u6267\u884c\u6548\u7387\u4f9d\u65e7\u6bd4\u4e0d\u4e0a\u5546\u4e1a\u5316\u7684Matlab\u3002\u4f8b\u5982\uff0c\u9488\u5bf9\u672c\u4eba\u7684\u4e00\u4e2a\u7ea6\u675f\u6781\u503c\u95ee\u9898\uff0cmatlab\u4f18\u5316\u5de5\u5177\u7bb1\u7684 fmincon() \u51fd\u6570\u76f8\u6bd4scipy.optimize\u7684 minimize() \u51fd\u6570\u8868\u73b0\u51fa\u66f4\u9ad8\u7684\u8ba1\u7b97\u6548\u7387\u3002\u56e0\u6b64\uff0c\u5728\u67d0\u4e9b\u573a\u5408\u4e0b\uff0c\u9700\u8981\u5728python\u4ee3\u7801\u4e2d\u6267\u884cmatlab\u547d\u4ee4\u3002 \u5e86\u5e78\u7684\u662f\uff0c\u5df2\u7ecf\u6709\u5f00\u6e90\u9879\u76ee\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u9700\u6c42\u3002\u5176\u4e2d\u503c\u5f97\u63a8\u8350\u7684\u662f\uff1aAlexander Schmolck \u548c Vivek Rathod \u8d1f\u8d23\u7684 mlabwrap \u3002\u6b64\u9879\u76ee\u4f5c\u8005\u7684\u672c\u610f\u662f\u5728Linux\u4e0b\u5199\u7684\uff0c\u5bf9\u4e8ewindows\u7528\u6237\u9700\u8981C++\u7f16\u8bd1\u5668\u624d\u80fd\u6210\u529f\u5b89\u88c5\u3002Yauhen Yakimovich\u5728mlabwrap\u7684\u57fa\u7840\u4e0a\u5f00\u53d1\u4e86\u5e76\u4e0d\u4f9d\u8d56\u4e8eC++\u7f16\u8bd1\u5668\u7684 mlab \uff0c\u672c\u6587\u5373\u5bf9\u5176\u5b89\u88c5\u548c\u4f7f\u7528\u4f5c\u7b80\u8981\u8bf4\u660e\u3002","title":"python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92"},{"location":"2015-11-15-python%E4%B8%AD%E4%BD%BF%E7%94%A8mlab%E5%BA%93%E5%AE%9E%E7%8E%B0%E4%B8%8EMATLAB%E4%BA%A4%E4%BA%92/#mlab","text":"mlab\u7528\u4e8e\u5728python\u4e2d\u76f4\u63a5\u8c03\u7528matlab\u51fd\u6570\uff0c\u800c\u4e0d\u5fc5\u6253\u5f00matlab\u7684\u7a0b\u5e8f\u754c\u9762\uff0c\u4ece\u800c\u4f7f\u5f97 matlab\u5c31\u50cfpython\u7684\u4e00\u4e2a\u6269\u5c55\u5e93\u4e00\u6837\u3002\u5f15\u7528 mlabwrap \u9879\u76ee\u7684\u63cf\u8ff0\uff1a Mlab is a high-level python to Matlab\u00ae bridge that lets Matlab look like a normal python library. mlab\u662f\u57fa\u4e8eAlexander Schmolck\u548cVivek Rathod\u8d1f\u8d23\u7684 mlabwrap \u53caDani Valevski\u8d1f\u8d23\u7684 matlabpipe \u5f00\u53d1\u7684\u3002\u5176\u9879\u76ee\u4e3b\u9875\u4e3a\uff1a https://github.com/ewiger/mlab","title":"mlab\u7b80\u4ecb"},{"location":"2015-11-15-python%E4%B8%AD%E4%BD%BF%E7%94%A8mlab%E5%BA%93%E5%AE%9E%E7%8E%B0%E4%B8%8EMATLAB%E4%BA%A4%E4%BA%92/#mlab_1","text":"mlab\u9075\u5faa MIT \u8bb8\u53ef\u534f\u8bae\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u9879\u76ee\u5730\u5740\u4e0b\u8f7d\u6e90\u7801\uff0c\u6216\u8005\u4ecepython\u5b98\u7f51\u7684Package index\u4e0b\u8f7d\u3002\u672c\u6587\u4f7f\u7528\u7248\u672c\u4e3a mlab 1.1.4 \u3002 windows\u4e0b\u5b89\u88c5\u65b9\u6cd5\uff1a # 1\u3001\u4e8b\u5148\u5b89\u88c5\u597d numpy \u5e93\uff0cmatlab 6\u6216\u4ee5\u4e0a\u7248\u672c # 2\u3001\u5728\u547d\u4ee4\u884c\u5de5\u5177\u4e2d\uff0c\u5c06\u76ee\u5f55\u5207\u6362\u5230\u6e90\u7801\u6240\u5728\u6587\u4ef6\u5939\uff0c\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a python setup.py install \u5bfc\u5165mlab\u5e93\u540e\u5373\u53ef\u65b9\u4fbf\u5730\u4f7f\u7528matlab\u51fd\u6570\u4e86\uff1a from mlab.releases import latest_release as matlab","title":"mlab\u83b7\u53d6\u548c\u5b89\u88c5"},{"location":"2015-11-15-python%E4%B8%AD%E4%BD%BF%E7%94%A8mlab%E5%BA%93%E5%AE%9E%E7%8E%B0%E4%B8%8EMATLAB%E4%BA%A4%E4%BA%92/#1","text":"from mlab.releases import latest_release as matlab import numpy as np x = np.arange(-2*np.pi, 2*np.pi, 0.2) matlab.surf(np.subtract.outer(np.sin(x),np.cos(x)))","title":"\u5b98\u65b9\u793a\u4f8b 1"},{"location":"2015-11-15-python%E4%B8%AD%E4%BD%BF%E7%94%A8mlab%E5%BA%93%E5%AE%9E%E7%8E%B0%E4%B8%8EMATLAB%E4%BA%A4%E4%BA%92/#_1","text":"\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u8c03\u7528\u81ea\u5b9a\u4e49\u7684matlab\u51fd\u6570\u3002\u4f8b\u5982\u65b0\u5efa\u51fd\u6570\u6587\u4ef6 myfun.m \uff0c\u4fdd\u5b58\u5728\u5f53\u524dpython\u4ee3\u7801\u6240\u5728\u76ee\u5f55\uff1a function [y1, y2] = myfun(x,y) y1 = x + 1; y2 = x.^3; \u5728python\u4ee3\u7801\u7684\u8c03\u7528\u8fc7\u7a0b\u4e2d\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u4e09\u4e2a\u95ee\u9898\uff1a \u53c2\u6570\u52a1\u5fc5\u4ee5\u6570\u7ec4/\u5217\u8868\u7684\u5f62\u5f0f\u8f93\u5165 ``` python x = matlab.myfun(1,2) print x # output: # <MlabObjectProxy of matlab-class: u'int32'; internal name: 'PROXY_VAL0__'; has parent: no> ``` ``` python x = matlab.myfun([1],[2]) print x # output: 2.0 ``` \u4f7f\u7528 nout \u53c2\u6570\u6307\u5b9a\u8f93\u51fa\u4e2a\u6570 ``` python x,y = matlab.myfun([1],[2,3,4]) print y # output: TypeError: 'float' object is not iterable ``` ``` python x,y = matlab.myfun([1],[2,3,4], nout=2) print y # output: [[ 8.] [ 27.] [ 64.]] ``` myfun.m\u6587\u4ef6\u683c\u5f0f\u5fc5\u987b\u4e3a ANSI \u5426\u5219\u5c06\u5bfc\u81f4\u5982\u4e0b\u9519\u8bef\u63d0\u793a\u3002\u5f53\u65f6\u5c31\u662f\u56f0\u6270\u597d\u4e45\u624d\u53d1\u73b0\u539f\u6765\u662f\u6587\u4ef6\u683c\u5f0f\u7684\u95ee\u9898\u3002 UserWarning: Couldn't ascertain number of output args for 'myfun', assuming 1. mlabwrap Documentation \u21a9","title":"\u8c03\u7528\u81ea\u5b9a\u4e49\u51fd\u6570"},{"location":"2016-01-20-%E4%BD%BF%E7%94%A8Python%E5%AF%BC%E5%87%BAMSC.Marc%E5%90%8E%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/","text":"\u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e \u00b6 \u53d1\u5e03\u4e8e\uff1a2016-01-20 | \u5206\u7c7b\uff1a finite element analysis \u5728Marc\u540e\u5904\u7406\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u5e0c\u671b\u5c06\u67d0\u4e9b\u6570\u636e\u5bfc\u51fa\u540e\u91cd\u65b0\u7ed8\u56fe\u3002\u5bf9\u4e8e\u5c11\u91cf\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528 PATH PLOT \u548c HISTORY PLOT \u91c7\u96c6\u6570\u636e\uff0c\u7136\u540e\u76f4\u63a5\u4f7f\u7528\u754c\u9762\u4e0a\u7684 SAVE \u6309\u94ae\u4fdd\u5b58\u5230\u6587\u4ef6\uff0c\u6216\u8005\u4f7f\u7528 COPY TO CLIPBOARD \u6309\u94ae\u590d\u5236\u5230\u526a\u5207\u677f\u3002 PATH PLOT \u6536\u96c6\u4e0d\u540c\u8282\u70b9\u5728\u67d0\u4e2a\u65f6\u523b\u7684\u540e\u5904\u7406\u6570\u636e HISTORY PLOT \u6536\u96c6\u67d0\u4e2a\u8282\u70b9\u5728\u4e0d\u540c\u65f6\u523b\u7684\u540e\u5904\u7406\u6570\u636e \u7136\u800c\u6b64\u65b9\u6cd5\u96be\u4ee5\u5bfc\u51fa\u5927\u91cf\u7684\u4e0d\u89c4\u5219\u533a\u57df\u7684\u6570\u636e\u3002\u67e5\u9605Marc\u5e2e\u52a9\u624b\u518c\u7684Python Manual\u90e8\u5206\uff0c\u53d1\u73b0\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4f7f\u7528Python\u811a\u672c\u83b7\u53d6\u540e\u5904\u7406\u6570\u636e\u7684\u65b9\u6cd5\u3002 \u672c\u6587\u5373\u4ee5 \u5bfc\u51fa\u6a21\u578b\u6240\u6709\u8282\u70b9\u4f4d\u79fb\u6570\u636e\u5e76\u91cd\u7ed8\u4e91\u56fe \u4e3a\u4f8b\uff0c\u8bb0\u5f55py_post\u6a21\u5757\u7684\u4f7f\u7528\u65b9\u6cd5\u3002 PyPost\u4ecb\u7ecd \u00b6 Marc\u63d0\u4f9b\u4e86 PyMentat \u548c PyPost \u4e24\u4e2aPython\u6a21\u5757\u7528\u4ee5\u524d\u540e\u5904\u7406\u6570\u636e\u7684\u83b7\u53d6\u548c\u4fee\u6539\u3002\u524d\u8005\u7684\u6267\u884c\u4f9d\u8d56\u4e8eMentat\u754c\u9762\uff0c\u53ea\u80fd\u5728Mentat\u754c\u9762\u4e2d\u8c03\u7528Python\u811a\u672c\uff0c\u800c\u540e\u8005\u53ef\u4ee5\u5b8c\u5168\u72ec\u7acb\u4e8eMentat\u3002 PyPost \u6a21\u5757\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u5185\u7f6e\u51fd\u6570\uff0c\u7528\u4e8e\u8bfb\u53d6Marc\u7684\u540e\u5904\u7406\u6587\u4ef6\uff08 *.t16 \uff09\uff0c\u83b7\u53d6\u6807\u91cf\u3001\u5411\u91cf\u3001\u5f20\u91cf\u6570\u636e\u7b49\u3002\u5177\u4f53\u53c2\u8003Marc\u5e2e\u52a9\u624b\u518cPython Manual\u5377\u3002 \u51c6\u5907\u5de5\u4f5c \u00b6 \u4e3a\u4e86\u987a\u5229\u4f7f\u7528PyPost\u6a21\u5757\uff0c\u9700\u8981\u5c06\u6a21\u5757\u6587\u4ef6 py_post.pyd \uff08 \\mentat2012\\shlib\\ \uff09\u590d\u5236\u5230Python\u7684\u5e93\u6587\u4ef6\u76ee\u5f55\uff08 \\mentat2012\\python\\win64\\Lib \uff09\uff0c\u5e76\u4e14\u786e\u4fddPython\u73af\u5883\u53d8\u91cf PYTHONPATH \u5df2\u7ecf\u6307\u5411Python\u5e93\u6587\u4ef6\u76ee\u5f55\u3002 \u8fd9\u4e0e\u4f7f\u7528\u5176\u4ed6Python\u6a21\u5757\u662f\u4e00\u6837\u7684\uff0c\u76ee\u7684\u662f\u8ba9Python\u77e5\u9053\u6a21\u5757\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0c\u7136\u540e\u624d\u80fd\u7528 from py_post import * \u8bed\u53e5\u5bfc\u5165\u3002 \u5b9e\u4f8b \u00b6 \u4ece\u540e\u5904\u7406\u6587\u4ef6\u4e2d\u8bfb\u53d6\u4f4d\u79fb\u6570\u636e\u7684\u57fa\u672c\u601d\u8def\u4e3a\uff1a \u6253\u5f00\u540e\u5904\u7406\u6587\u4ef6 \u8df3\u8f6c\u5230\u6307\u5b9a\u589e\u91cf\u6b65 \u83b7\u53d6\u8282\u70b9\u603b\u6570\u53ca\u6bcf\u4e2a\u8282\u70b9\u7684\u5750\u6807\u548c\u4f4d\u79fb # encoding: utf8 from py_post import * # \u5bfc\u5165PyPost\u6a21\u5757 # \u8bfb\u53d6\u540e\u5904\u7406\u6587\u4ef6 fname = \"test_job1.t16\" # \u5f53\u524d\u76ee\u5f55\u4e0b\u7684Marc\u540e\u5904\u7406\u6587\u4ef6\uff0c\u5426\u5219\u7ed9\u51fa\u5177\u4f53\u8def\u5f84 p = post_open(fname) # \u6253\u5f00\u540e\u5904\u7406\u6587\u4ef6 p.moveto(26) # \u8df3\u8f6c\u5230\u7b2c26\u589e\u91cf\u6b65 # \u8282\u70b9\u6570 num = p.nodes() data = [] k = 0 # \u83b7\u53d6\u6bcf\u4e2a\u8282\u70b9\u7684\u4f4d\u79fb\u503c while k < num: pk = p.node(k) # \u7b2ck\u4e2a\u8282\u70b9\u5bf9\u8c61\uff0cx\uff0cy\uff0cz\u5c5e\u6027\u5206\u522b\u4e3a\u4e09\u4e2a\u5750\u6807\u503c if pk.x>=-8 and pk.x<=27: # \u9009\u62e9x\u5750\u6807\u5728[-8, 27]\u8303\u56f4\u5185\u7684\u8282\u70b9 dx, dy, _ = p.node_displacement(k) # \u83b7\u53d6\u4f4d\u79fb data.append([pk.x, pk.y, dx, dy]) k += 1 \u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u5b9e\u73b0\u8282\u70b9\u5750\u6807\u3001\u4f4d\u79fb\u7684\u83b7\u53d6\uff0c\u63a5\u4e0b\u6765\u5373\u53ef\u8fdb\u884c\u4e91\u56fe\u7684\u7ed8\u5236\u3002 \u7ed8\u5236\u4e91\u56fe\u7684 contourf() \u51fd\u6570\u63a5\u53d7\u7684\u662f\u7f51\u683c\u5316\u6570\u636e\uff0c\u800c\u5f53\u524d data \u5217\u8868\u4e2d\u7684\u662f\u79bb\u6563\u6570\u636e\uff0c\u6240\u4ee5\u9700\u8981\u5148\u751f\u6210\u7f51\u683c\u5316\u7684\u5750\u6807\u6570\u636e\uff0c\u7136\u540e\u6839\u636e data \u4e2d\u7684\u6570\u636e\u63d2\u503c\u5f97\u5230\u6307\u5b9a\u8282\u70b9\u4e0a\u7684\u4f4d\u79fb\u6570\u636e\uff0c\u6700\u540e\u4ee5\u65b0\u7684\u6570\u636e\u7ed8\u5236\u4e91\u56fe\u3002 \u501f\u52a9Python\u79d1\u5b66\u8ba1\u7b97\u5e93 Numpy \u548c\u7ed8\u56fe\u5e93 matplotlib \uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a # \u63a5\u524d\u9762\u4ee3\u7801 import numpy as np import matplotlib.pyplot as plt from matplotlib.mlab import griddata data = np.array(data) # \u8bfb\u53d6\u540e\u5904\u7406\u6587\u4ef6\u5f97\u5230\u7684\u79bb\u6563\u6570\u636e xi = data[:,0] + 87.64 yi = data[:,1] dzi = data[:,2] dri = data[:,3] # \u751f\u6210\u7f51\u683c\u5316\u7684\u5750\u6807 dx = np.linspace(np.min(xi), np.max(xi), 500) dy = np.linspace(np.min(yi), np.max(yi), 250) x, y = np.meshgrid(dx, dy) # \u4f7f\u7528griddata\u63d2\u503c\u5f97\u5230\u8282\u70b9\u4e0a\u7684\u4f4d\u79fb\u503c dz = griddata(xi, yi, dzi, x, y) dr = griddata(xi, yi, dri, x, y) # \u6839\u636e\u6a21\u578b\u51e0\u4f55\u7ed3\u6784\u663e\u793a\u6570\u636e k = 0.075 t = (y>k*x) * (y>6.59) dz[t] = np.nan dr[t] = np.nan # \u4ee5\u8f74\u5411\u4f4d\u79fb\u4e3a\u4f8b\u4f5c\u4e91\u56fe plt.figure() c = plt.contourf(x, y, dz) plt.colorbar(c) plt.gca().set_aspect('equal') plt.gca().set_axis_off() plt.show() \u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a","title":"\u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e"},{"location":"2016-01-20-%E4%BD%BF%E7%94%A8Python%E5%AF%BC%E5%87%BAMSC.Marc%E5%90%8E%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/#pythonmscmarc","text":"\u53d1\u5e03\u4e8e\uff1a2016-01-20 | \u5206\u7c7b\uff1a finite element analysis \u5728Marc\u540e\u5904\u7406\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u5e0c\u671b\u5c06\u67d0\u4e9b\u6570\u636e\u5bfc\u51fa\u540e\u91cd\u65b0\u7ed8\u56fe\u3002\u5bf9\u4e8e\u5c11\u91cf\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528 PATH PLOT \u548c HISTORY PLOT \u91c7\u96c6\u6570\u636e\uff0c\u7136\u540e\u76f4\u63a5\u4f7f\u7528\u754c\u9762\u4e0a\u7684 SAVE \u6309\u94ae\u4fdd\u5b58\u5230\u6587\u4ef6\uff0c\u6216\u8005\u4f7f\u7528 COPY TO CLIPBOARD \u6309\u94ae\u590d\u5236\u5230\u526a\u5207\u677f\u3002 PATH PLOT \u6536\u96c6\u4e0d\u540c\u8282\u70b9\u5728\u67d0\u4e2a\u65f6\u523b\u7684\u540e\u5904\u7406\u6570\u636e HISTORY PLOT \u6536\u96c6\u67d0\u4e2a\u8282\u70b9\u5728\u4e0d\u540c\u65f6\u523b\u7684\u540e\u5904\u7406\u6570\u636e \u7136\u800c\u6b64\u65b9\u6cd5\u96be\u4ee5\u5bfc\u51fa\u5927\u91cf\u7684\u4e0d\u89c4\u5219\u533a\u57df\u7684\u6570\u636e\u3002\u67e5\u9605Marc\u5e2e\u52a9\u624b\u518c\u7684Python Manual\u90e8\u5206\uff0c\u53d1\u73b0\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4f7f\u7528Python\u811a\u672c\u83b7\u53d6\u540e\u5904\u7406\u6570\u636e\u7684\u65b9\u6cd5\u3002 \u672c\u6587\u5373\u4ee5 \u5bfc\u51fa\u6a21\u578b\u6240\u6709\u8282\u70b9\u4f4d\u79fb\u6570\u636e\u5e76\u91cd\u7ed8\u4e91\u56fe \u4e3a\u4f8b\uff0c\u8bb0\u5f55py_post\u6a21\u5757\u7684\u4f7f\u7528\u65b9\u6cd5\u3002","title":"\u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e"},{"location":"2016-01-20-%E4%BD%BF%E7%94%A8Python%E5%AF%BC%E5%87%BAMSC.Marc%E5%90%8E%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/#pypost","text":"Marc\u63d0\u4f9b\u4e86 PyMentat \u548c PyPost \u4e24\u4e2aPython\u6a21\u5757\u7528\u4ee5\u524d\u540e\u5904\u7406\u6570\u636e\u7684\u83b7\u53d6\u548c\u4fee\u6539\u3002\u524d\u8005\u7684\u6267\u884c\u4f9d\u8d56\u4e8eMentat\u754c\u9762\uff0c\u53ea\u80fd\u5728Mentat\u754c\u9762\u4e2d\u8c03\u7528Python\u811a\u672c\uff0c\u800c\u540e\u8005\u53ef\u4ee5\u5b8c\u5168\u72ec\u7acb\u4e8eMentat\u3002 PyPost \u6a21\u5757\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u5185\u7f6e\u51fd\u6570\uff0c\u7528\u4e8e\u8bfb\u53d6Marc\u7684\u540e\u5904\u7406\u6587\u4ef6\uff08 *.t16 \uff09\uff0c\u83b7\u53d6\u6807\u91cf\u3001\u5411\u91cf\u3001\u5f20\u91cf\u6570\u636e\u7b49\u3002\u5177\u4f53\u53c2\u8003Marc\u5e2e\u52a9\u624b\u518cPython Manual\u5377\u3002","title":"PyPost\u4ecb\u7ecd"},{"location":"2016-01-20-%E4%BD%BF%E7%94%A8Python%E5%AF%BC%E5%87%BAMSC.Marc%E5%90%8E%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/#_1","text":"\u4e3a\u4e86\u987a\u5229\u4f7f\u7528PyPost\u6a21\u5757\uff0c\u9700\u8981\u5c06\u6a21\u5757\u6587\u4ef6 py_post.pyd \uff08 \\mentat2012\\shlib\\ \uff09\u590d\u5236\u5230Python\u7684\u5e93\u6587\u4ef6\u76ee\u5f55\uff08 \\mentat2012\\python\\win64\\Lib \uff09\uff0c\u5e76\u4e14\u786e\u4fddPython\u73af\u5883\u53d8\u91cf PYTHONPATH \u5df2\u7ecf\u6307\u5411Python\u5e93\u6587\u4ef6\u76ee\u5f55\u3002 \u8fd9\u4e0e\u4f7f\u7528\u5176\u4ed6Python\u6a21\u5757\u662f\u4e00\u6837\u7684\uff0c\u76ee\u7684\u662f\u8ba9Python\u77e5\u9053\u6a21\u5757\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0c\u7136\u540e\u624d\u80fd\u7528 from py_post import * \u8bed\u53e5\u5bfc\u5165\u3002","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"2016-01-20-%E4%BD%BF%E7%94%A8Python%E5%AF%BC%E5%87%BAMSC.Marc%E5%90%8E%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/#_2","text":"\u4ece\u540e\u5904\u7406\u6587\u4ef6\u4e2d\u8bfb\u53d6\u4f4d\u79fb\u6570\u636e\u7684\u57fa\u672c\u601d\u8def\u4e3a\uff1a \u6253\u5f00\u540e\u5904\u7406\u6587\u4ef6 \u8df3\u8f6c\u5230\u6307\u5b9a\u589e\u91cf\u6b65 \u83b7\u53d6\u8282\u70b9\u603b\u6570\u53ca\u6bcf\u4e2a\u8282\u70b9\u7684\u5750\u6807\u548c\u4f4d\u79fb # encoding: utf8 from py_post import * # \u5bfc\u5165PyPost\u6a21\u5757 # \u8bfb\u53d6\u540e\u5904\u7406\u6587\u4ef6 fname = \"test_job1.t16\" # \u5f53\u524d\u76ee\u5f55\u4e0b\u7684Marc\u540e\u5904\u7406\u6587\u4ef6\uff0c\u5426\u5219\u7ed9\u51fa\u5177\u4f53\u8def\u5f84 p = post_open(fname) # \u6253\u5f00\u540e\u5904\u7406\u6587\u4ef6 p.moveto(26) # \u8df3\u8f6c\u5230\u7b2c26\u589e\u91cf\u6b65 # \u8282\u70b9\u6570 num = p.nodes() data = [] k = 0 # \u83b7\u53d6\u6bcf\u4e2a\u8282\u70b9\u7684\u4f4d\u79fb\u503c while k < num: pk = p.node(k) # \u7b2ck\u4e2a\u8282\u70b9\u5bf9\u8c61\uff0cx\uff0cy\uff0cz\u5c5e\u6027\u5206\u522b\u4e3a\u4e09\u4e2a\u5750\u6807\u503c if pk.x>=-8 and pk.x<=27: # \u9009\u62e9x\u5750\u6807\u5728[-8, 27]\u8303\u56f4\u5185\u7684\u8282\u70b9 dx, dy, _ = p.node_displacement(k) # \u83b7\u53d6\u4f4d\u79fb data.append([pk.x, pk.y, dx, dy]) k += 1 \u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u5b9e\u73b0\u8282\u70b9\u5750\u6807\u3001\u4f4d\u79fb\u7684\u83b7\u53d6\uff0c\u63a5\u4e0b\u6765\u5373\u53ef\u8fdb\u884c\u4e91\u56fe\u7684\u7ed8\u5236\u3002 \u7ed8\u5236\u4e91\u56fe\u7684 contourf() \u51fd\u6570\u63a5\u53d7\u7684\u662f\u7f51\u683c\u5316\u6570\u636e\uff0c\u800c\u5f53\u524d data \u5217\u8868\u4e2d\u7684\u662f\u79bb\u6563\u6570\u636e\uff0c\u6240\u4ee5\u9700\u8981\u5148\u751f\u6210\u7f51\u683c\u5316\u7684\u5750\u6807\u6570\u636e\uff0c\u7136\u540e\u6839\u636e data \u4e2d\u7684\u6570\u636e\u63d2\u503c\u5f97\u5230\u6307\u5b9a\u8282\u70b9\u4e0a\u7684\u4f4d\u79fb\u6570\u636e\uff0c\u6700\u540e\u4ee5\u65b0\u7684\u6570\u636e\u7ed8\u5236\u4e91\u56fe\u3002 \u501f\u52a9Python\u79d1\u5b66\u8ba1\u7b97\u5e93 Numpy \u548c\u7ed8\u56fe\u5e93 matplotlib \uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a # \u63a5\u524d\u9762\u4ee3\u7801 import numpy as np import matplotlib.pyplot as plt from matplotlib.mlab import griddata data = np.array(data) # \u8bfb\u53d6\u540e\u5904\u7406\u6587\u4ef6\u5f97\u5230\u7684\u79bb\u6563\u6570\u636e xi = data[:,0] + 87.64 yi = data[:,1] dzi = data[:,2] dri = data[:,3] # \u751f\u6210\u7f51\u683c\u5316\u7684\u5750\u6807 dx = np.linspace(np.min(xi), np.max(xi), 500) dy = np.linspace(np.min(yi), np.max(yi), 250) x, y = np.meshgrid(dx, dy) # \u4f7f\u7528griddata\u63d2\u503c\u5f97\u5230\u8282\u70b9\u4e0a\u7684\u4f4d\u79fb\u503c dz = griddata(xi, yi, dzi, x, y) dr = griddata(xi, yi, dri, x, y) # \u6839\u636e\u6a21\u578b\u51e0\u4f55\u7ed3\u6784\u663e\u793a\u6570\u636e k = 0.075 t = (y>k*x) * (y>6.59) dz[t] = np.nan dr[t] = np.nan # \u4ee5\u8f74\u5411\u4f4d\u79fb\u4e3a\u4f8b\u4f5c\u4e91\u56fe plt.figure() c = plt.contourf(x, y, dz) plt.colorbar(c) plt.gca().set_aspect('equal') plt.gca().set_axis_off() plt.show() \u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a","title":"\u5b9e\u4f8b"},{"location":"2016-11-05-%E6%95%B4%E5%90%88UEditor%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97%E4%B8%BA%E4%B8%8A%E4%BC%A0%E6%8F%92%E4%BB%B6/","text":"\u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6 \u00b6 \u53d1\u5e03\u4e8e\uff1a2016-11-05 | \u5206\u7c7b\uff1a web development UEditor\u662f\u767e\u5ea6web\u524d\u7aef\u7814\u53d1\u56e2\u961ffex-team\u5f00\u53d1\u7684\u6240\u89c1\u5373\u6240\u5f97\u5bcc\u6587\u672c\u7f16\u8f91\u5668\uff0c\u5177\u6709\u8f7b\u91cf\uff0c\u53ef\u5b9a\u5236\u7684\u7279\u70b9\u3002\u672c\u6587\u7ed3\u5408 \u7a3b\u58f3\u4e92\u8054\u53d1\u5e03\u7684\u535a\u6587 \u63d0\u4f9b\u7684\u601d\u8def\uff0c\u5c06UEditor\u7684\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u529f\u80fd\u6574\u5408\u4e3a\u4e0a\u4f20\u63d2\u4ef6\uff0c\u5e76\u5bf9\u5176\u4f7f\u7528\u65b9\u6cd5\u505a\u7b80\u8981\u8bf4\u660e\u3002 \u63d2\u4ef6\u4ee3\u7801 \u00b6 \u601d\u8def\uff1a\u521d\u59cb\u5316\u4e00\u4e2a\u9690\u85cf\u81ea\u8eab\u3001\u4ec5\u5e26\u6709\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u6309\u94ae\u7684UEditor\uff0c\u5e76\u76d1\u542c\u5176\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u7ec4\u4ef6\u7684\u63d2\u5165\u52a8\u4f5c\uff1b\u7136\u540e\u5728\u76ee\u6807\u5bf9\u8c61\u7684\u5355\u51fb\u4e8b\u4ef6\u4e2d\u6253\u5f00\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u5bf9\u8bdd\u6846\u3002 /** * \u57fa\u4e8eueditor\u81ea\u5b9a\u4e49\u4e0a\u4f20\u7ec4\u4ef6 * \u9700\u8981\u5728ueditor.all.js\u6587\u4ef6me.execCommand('insertHtml', html);\u4e4b\u540e\u589e\u52a0\uff1ame.fireEvent('afterUpfile', filelist); */ (function($) { $.fn.ueditor_upload = function(options) { // \u9ed8\u8ba4\u53c2\u6570 var defaults = { editorid: null, // \u767e\u5ea6\u7f16\u8f91\u5668\u5bb9\u5668 uploadtype: 0, // 0 \u56fe\u7247 1 \u6587\u4ef6 title: '\u9009\u62e9\u6587\u4ef6...', // \u9009\u62e9\u6587\u4ef6\u5bf9\u8bdd\u6846\u7684\u6807\u9898 success: function() {} // \u4e0a\u4f20\u5b8c\u6210\u540e\u7684\u56de\u8c03\u51fd\u6570 }; // \u521d\u59cb\u5316ueditor\uff0c\u5e76\u9690\u85cf\u4e4b function getEditor(editorid, tool) { return UE.getEditor(editorid, { isShow: false, focus: false, enableAutoSave: false, autoSyncData: false, autoFloatEnabled: false, wordCount: false, sourceEditor: null, scaleEnabled: true, toolbars: [ [tool] ] }); }; var o = $.extend(defaults, options || {}); var me = null; // \u5f53\u524d\u88ab\u70b9\u51fb\u7684\u5bf9\u8c61 if (o.uploadtype === 0) { // \u4e0a\u4f20\u56fe\u7247 var listener = 'beforeInsertImage'; var dialogtype = 'insertimage'; var tool = 'insertimage'; } else { // \u4e0a\u4f20\u6587\u4ef6 var listener = 'afterUpfile'; var dialogtype = 'attachment'; var tool = 'attachment'; } // \u521d\u59cb\u5316\u7f16\u8f91\u5668 var editor = getEditor(o.editorid, tool); // \u6839\u636e\u4e0a\u4f20\u7c7b\u578b\u6ce8\u518c\u76d1\u542c\u4e8b\u4ef6 editor.ready(function() { editor.addListener(listener, function(t, args) { if (typeof(o.success) == 'function') { o.success(me, args); // \u56de\u8c03\u51fd\u6570 } }); }); // \u70b9\u51fb\u5bf9\u8c61\u5f39\u51fa\u4e0a\u4f20\u5bf9\u8bdd\u6846 $(this).click(function(event) { me = $(this); // \u83b7\u53d6\u88ab\u70b9\u51fb\u7684\u5bf9\u8c61\uff0c\u4f5c\u4e3a\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570 var dialog = editor.getDialog(dialogtype); dialog.title = o.title; dialog.render(); dialog.open(); }); } })(jQuery); \u53c2\u6570\u8bf4\u660e \u00b6 \u521d\u59cb\u5316\u63d2\u4ef6\u65f6\u63a5\u53d7\u7684\u53c2\u6570\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5176\u5c5e\u6027\u4e3a\uff1a editorid : string \u521d\u59cb\u5316UEditor\u7f16\u8f91\u5668\u7684\u5bb9\u5668 uploadtype : int \u4e0a\u4f20\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3a\u56fe\u7247\uff080\uff09\u6216\u8005\u4fee\u6539\u4e3a\u6587\u4ef6\uff081\uff09 title : string \u4e0a\u4f20\u5bf9\u8bdd\u6846\u7684\u663e\u793a\u6807\u9898 success : function \u4e0a\u4f20\u6587\u4ef6\u6210\u529f\u540e\u7684\u56de\u8c03\u51fd\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u89e6\u53d1\u6587\u4ef6\u4e0a\u4f20\u7684\u81ea\u5b9a\u4e49\u5bf9\u8c61\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u4e0a\u4f20\u6210\u529f\u7684\u6587\u4ef6\u4fe1\u606f\u6570\u7ec4\uff1a [{url: // \u65b0\u751f\u6210\u7684\u6587\u4ef6\u540d, alt: // \u539f\u59cb\u6587\u4ef6\u540d}, {}, ...] \u4f7f\u7528\u793a\u4f8b \u00b6 \u4ee5\u4e0b\u793a\u4f8b\u5728\u540c\u4e00\u9875\u9762\u4e0b\u591a\u6b21\u4f7f\u7528\u6b64\u63d2\u4ef6\u5b9e\u73b0\u4e0d\u540c\u680f\u76ee\u56fe\u7247\u7684\u4e0a\u4f20\uff1a \u6309\u7167UEditor\u7684\u4f7f\u7528\u8bf4\u660e\u5f15\u5165\u5fc5\u8981\u7684js\u6587\u4ef6 <script src=\"/js/ueditor/ueditor.config.js\"></script> <script src=\"/js/ueditor/ueditor.all.min.js\"></script> <script src=\"/js/ueditor_upload.js\"></script> HTML\u7ed3\u6784 <!--\u52a0\u8f7d\u7f16\u8f91\u5668--> <textarea id=\"uploadImgEditor\" class=\"hidden\"></textarea> <!-- \u9009\u9879\u5361\uff1a\u5168\u5c40\u56fe --> <div class=\"layui-tab-item\"> <div class=\"upload_img_wrap\"> <div class=\"addpic\"> <img class=\"upload_img_btn\" src=\"/images/product/addpic.png\" alt=\"\u6dfb\u52a0\u56fe\u7247\"> </div> </div> </div> <!-- \u9009\u9879\u5361\uff1a\u7d27\u56fa\u4ef6\u56fe --> <div class=\"layui-tab-item\"> <div class=\"upload_img_wrap\"> <div class=\"addpic\"> <img class=\"upload_img_btn\" src=\"/images/product/addpic.png\" alt=\"\u6dfb\u52a0\u56fe\u7247\"> </div> </div> </div> <!-- \u9009\u9879\u5361\uff1a\u6d4b\u91cf\u56fe --> <div class=\"layui-tab-item\"> <div class=\"upload_img_wrap\"> <div class=\"addpic\"> <img class=\"upload_img_btn\" src=\"/images/product/addpic.png\" alt=\"\u6dfb\u52a0\u56fe\u7247\"> </div> </div> </div> \u8c03\u7528\u63d2\u4ef6 $('.upload_img_btn').ueditor_upload({ editorid: \"uploadImgEditor\", uploadtype:0, title:\"\u9009\u62e9\u56fe\u7247...\", success: function(obj, res){ var imageHtml = ''; for(var i in res){ imageHtml += '<div class=\"thumblist\"><img src=\"'+res[i].src+'\" alt=\"'+res[i].alt+'\"><div class=\"del_upload\"></div></div>'; } $(obj).parent(\".addpic\").before(imageHtml); } }) \u6548\u679c\u793a\u4f8b","title":"\u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6"},{"location":"2016-11-05-%E6%95%B4%E5%90%88UEditor%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97%E4%B8%BA%E4%B8%8A%E4%BC%A0%E6%8F%92%E4%BB%B6/#ueditor","text":"\u53d1\u5e03\u4e8e\uff1a2016-11-05 | \u5206\u7c7b\uff1a web development UEditor\u662f\u767e\u5ea6web\u524d\u7aef\u7814\u53d1\u56e2\u961ffex-team\u5f00\u53d1\u7684\u6240\u89c1\u5373\u6240\u5f97\u5bcc\u6587\u672c\u7f16\u8f91\u5668\uff0c\u5177\u6709\u8f7b\u91cf\uff0c\u53ef\u5b9a\u5236\u7684\u7279\u70b9\u3002\u672c\u6587\u7ed3\u5408 \u7a3b\u58f3\u4e92\u8054\u53d1\u5e03\u7684\u535a\u6587 \u63d0\u4f9b\u7684\u601d\u8def\uff0c\u5c06UEditor\u7684\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u529f\u80fd\u6574\u5408\u4e3a\u4e0a\u4f20\u63d2\u4ef6\uff0c\u5e76\u5bf9\u5176\u4f7f\u7528\u65b9\u6cd5\u505a\u7b80\u8981\u8bf4\u660e\u3002","title":"\u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6"},{"location":"2016-11-05-%E6%95%B4%E5%90%88UEditor%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97%E4%B8%BA%E4%B8%8A%E4%BC%A0%E6%8F%92%E4%BB%B6/#_1","text":"\u601d\u8def\uff1a\u521d\u59cb\u5316\u4e00\u4e2a\u9690\u85cf\u81ea\u8eab\u3001\u4ec5\u5e26\u6709\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u6309\u94ae\u7684UEditor\uff0c\u5e76\u76d1\u542c\u5176\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u7ec4\u4ef6\u7684\u63d2\u5165\u52a8\u4f5c\uff1b\u7136\u540e\u5728\u76ee\u6807\u5bf9\u8c61\u7684\u5355\u51fb\u4e8b\u4ef6\u4e2d\u6253\u5f00\u6587\u4ef6/\u56fe\u7247\u4e0a\u4f20\u5bf9\u8bdd\u6846\u3002 /** * \u57fa\u4e8eueditor\u81ea\u5b9a\u4e49\u4e0a\u4f20\u7ec4\u4ef6 * \u9700\u8981\u5728ueditor.all.js\u6587\u4ef6me.execCommand('insertHtml', html);\u4e4b\u540e\u589e\u52a0\uff1ame.fireEvent('afterUpfile', filelist); */ (function($) { $.fn.ueditor_upload = function(options) { // \u9ed8\u8ba4\u53c2\u6570 var defaults = { editorid: null, // \u767e\u5ea6\u7f16\u8f91\u5668\u5bb9\u5668 uploadtype: 0, // 0 \u56fe\u7247 1 \u6587\u4ef6 title: '\u9009\u62e9\u6587\u4ef6...', // \u9009\u62e9\u6587\u4ef6\u5bf9\u8bdd\u6846\u7684\u6807\u9898 success: function() {} // \u4e0a\u4f20\u5b8c\u6210\u540e\u7684\u56de\u8c03\u51fd\u6570 }; // \u521d\u59cb\u5316ueditor\uff0c\u5e76\u9690\u85cf\u4e4b function getEditor(editorid, tool) { return UE.getEditor(editorid, { isShow: false, focus: false, enableAutoSave: false, autoSyncData: false, autoFloatEnabled: false, wordCount: false, sourceEditor: null, scaleEnabled: true, toolbars: [ [tool] ] }); }; var o = $.extend(defaults, options || {}); var me = null; // \u5f53\u524d\u88ab\u70b9\u51fb\u7684\u5bf9\u8c61 if (o.uploadtype === 0) { // \u4e0a\u4f20\u56fe\u7247 var listener = 'beforeInsertImage'; var dialogtype = 'insertimage'; var tool = 'insertimage'; } else { // \u4e0a\u4f20\u6587\u4ef6 var listener = 'afterUpfile'; var dialogtype = 'attachment'; var tool = 'attachment'; } // \u521d\u59cb\u5316\u7f16\u8f91\u5668 var editor = getEditor(o.editorid, tool); // \u6839\u636e\u4e0a\u4f20\u7c7b\u578b\u6ce8\u518c\u76d1\u542c\u4e8b\u4ef6 editor.ready(function() { editor.addListener(listener, function(t, args) { if (typeof(o.success) == 'function') { o.success(me, args); // \u56de\u8c03\u51fd\u6570 } }); }); // \u70b9\u51fb\u5bf9\u8c61\u5f39\u51fa\u4e0a\u4f20\u5bf9\u8bdd\u6846 $(this).click(function(event) { me = $(this); // \u83b7\u53d6\u88ab\u70b9\u51fb\u7684\u5bf9\u8c61\uff0c\u4f5c\u4e3a\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570 var dialog = editor.getDialog(dialogtype); dialog.title = o.title; dialog.render(); dialog.open(); }); } })(jQuery);","title":"\u63d2\u4ef6\u4ee3\u7801"},{"location":"2016-11-05-%E6%95%B4%E5%90%88UEditor%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97%E4%B8%BA%E4%B8%8A%E4%BC%A0%E6%8F%92%E4%BB%B6/#_2","text":"\u521d\u59cb\u5316\u63d2\u4ef6\u65f6\u63a5\u53d7\u7684\u53c2\u6570\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5176\u5c5e\u6027\u4e3a\uff1a editorid : string \u521d\u59cb\u5316UEditor\u7f16\u8f91\u5668\u7684\u5bb9\u5668 uploadtype : int \u4e0a\u4f20\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3a\u56fe\u7247\uff080\uff09\u6216\u8005\u4fee\u6539\u4e3a\u6587\u4ef6\uff081\uff09 title : string \u4e0a\u4f20\u5bf9\u8bdd\u6846\u7684\u663e\u793a\u6807\u9898 success : function \u4e0a\u4f20\u6587\u4ef6\u6210\u529f\u540e\u7684\u56de\u8c03\u51fd\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u89e6\u53d1\u6587\u4ef6\u4e0a\u4f20\u7684\u81ea\u5b9a\u4e49\u5bf9\u8c61\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u4e0a\u4f20\u6210\u529f\u7684\u6587\u4ef6\u4fe1\u606f\u6570\u7ec4\uff1a [{url: // \u65b0\u751f\u6210\u7684\u6587\u4ef6\u540d, alt: // \u539f\u59cb\u6587\u4ef6\u540d}, {}, ...]","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"2016-11-05-%E6%95%B4%E5%90%88UEditor%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E6%A8%A1%E5%9D%97%E4%B8%BA%E4%B8%8A%E4%BC%A0%E6%8F%92%E4%BB%B6/#_3","text":"\u4ee5\u4e0b\u793a\u4f8b\u5728\u540c\u4e00\u9875\u9762\u4e0b\u591a\u6b21\u4f7f\u7528\u6b64\u63d2\u4ef6\u5b9e\u73b0\u4e0d\u540c\u680f\u76ee\u56fe\u7247\u7684\u4e0a\u4f20\uff1a \u6309\u7167UEditor\u7684\u4f7f\u7528\u8bf4\u660e\u5f15\u5165\u5fc5\u8981\u7684js\u6587\u4ef6 <script src=\"/js/ueditor/ueditor.config.js\"></script> <script src=\"/js/ueditor/ueditor.all.min.js\"></script> <script src=\"/js/ueditor_upload.js\"></script> HTML\u7ed3\u6784 <!--\u52a0\u8f7d\u7f16\u8f91\u5668--> <textarea id=\"uploadImgEditor\" class=\"hidden\"></textarea> <!-- \u9009\u9879\u5361\uff1a\u5168\u5c40\u56fe --> <div class=\"layui-tab-item\"> <div class=\"upload_img_wrap\"> <div class=\"addpic\"> <img class=\"upload_img_btn\" src=\"/images/product/addpic.png\" alt=\"\u6dfb\u52a0\u56fe\u7247\"> </div> </div> </div> <!-- \u9009\u9879\u5361\uff1a\u7d27\u56fa\u4ef6\u56fe --> <div class=\"layui-tab-item\"> <div class=\"upload_img_wrap\"> <div class=\"addpic\"> <img class=\"upload_img_btn\" src=\"/images/product/addpic.png\" alt=\"\u6dfb\u52a0\u56fe\u7247\"> </div> </div> </div> <!-- \u9009\u9879\u5361\uff1a\u6d4b\u91cf\u56fe --> <div class=\"layui-tab-item\"> <div class=\"upload_img_wrap\"> <div class=\"addpic\"> <img class=\"upload_img_btn\" src=\"/images/product/addpic.png\" alt=\"\u6dfb\u52a0\u56fe\u7247\"> </div> </div> </div> \u8c03\u7528\u63d2\u4ef6 $('.upload_img_btn').ueditor_upload({ editorid: \"uploadImgEditor\", uploadtype:0, title:\"\u9009\u62e9\u56fe\u7247...\", success: function(obj, res){ var imageHtml = ''; for(var i in res){ imageHtml += '<div class=\"thumblist\"><img src=\"'+res[i].src+'\" alt=\"'+res[i].alt+'\"><div class=\"del_upload\"></div></div>'; } $(obj).parent(\".addpic\").before(imageHtml); } }) \u6548\u679c\u793a\u4f8b","title":"\u4f7f\u7528\u793a\u4f8b"},{"location":"2017-01-07-%E5%AD%A6%E4%BD%8D%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E7%BB%84%E5%90%88/","text":"\u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-01-07 | \u5206\u7c7b\uff1a process automation \u524d\u540e\u5386\u7ecf\u4e00\u5e74\u7684\u65f6\u95f4\uff0c\u5b66\u4f4d\u8bba\u6587\u7ec8\u4e8e\u5b8c\u7a3f\u3002\u5f80\u7b80\u5355\u65b9\u9762\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ec4\u7ec7\u548c\u6574\u5408\u5df2\u53d1\u8868\u5c0f\u8bba\u6587\u5185\u5bb9\u7684\u8fc7\u7a0b\u2014\u2014\u64b0\u5199\u5185\u5bb9\u672c\u8eab\u4e0d\u518d\u662f\u4e3b\u8981\u95ee\u9898\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u5185\u5bb9\u7684\u8fde\u8d2f\u548c\u6587\u7ae0\u7684\u6392\u7248\u3002\u7136\u800c\uff0c\u8fd9\u4f9d\u65e7\u662f\u4e00\u9879\u6d69\u5927\u7684\u5de5\u7a0b\uff0c\u672c\u6587\u5373\u8bb0\u5f55\u6b64\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u5de5\u5177\u96c6\u5408\u3002 \u6587\u732e\u7efc\u8ff0\u2014\u2014Endnote+Prezi \u00b6 EndNote \u662f\u4e00\u6b3e\u5927\u4f17\u666e\u53ca\u7684\u6587\u732e\u7ba1\u7406\u5de5\u5177\uff0c\u5176\u5907\u6ce8\u3001\u5206\u7ec4\u3001\u683c\u5f0f\u5316\u5bfc\u51fa\u7b49\u529f\u80fd\u5df2\u7ecf\u5728\u5e73\u65f6\u7684\u6587\u732e\u9605\u8bfb\u3001\u671f\u520a\u8bba\u6587\u5199\u4f5c\u65b9\u9762\uff0c\u4e3a\u6211\u4eec\u5e26\u6765\u4e86\u6781\u5927\u7684\u4fbf\u5229\u3002\u4e0d\u8fc7\uff0c\u5f53\u6211\u4eec\u5904\u7406\u5b66\u4f4d\u8bba\u6587\u7efc\u8ff0\u90e8\u5206\u4e0a\u767e\u7bc7\u6587\u732e\u53ca\u5176\u76f8\u4e92\u5173\u8054\u65f6\uff0c Endnote \u4e2d\u4e00\u6761\u6761\u6587\u732e\u8bb0\u5f55\u7684\u7ebf\u6027\u6392\u5217\u65b9\u5f0f\u96be\u4ee5\u65b9\u4fbf\u5730\u7ed9\u4e88\u6211\u4eec\u4e00\u4e2a\u4ece\u5168\u5c40\u5230\u7ec6\u8282\u7684\u5b8c\u5168\u638c\u63a7\u3002 \u8fd9\u65f6\u5019\uff0c\u5e0c\u671b\u5c06 EndNote \u4e2d\u4f9d\u6b21\u6392\u5217\u7684\u5206\u7ec4/\u6587\u732e\u5e73\u644a\u5230\u4e00\u5f20\u65e0\u9650\u5927\u7684\u767d\u7eb8\u4e0a\uff0c\u5b8f\u89c2\u4e0a\u53ef\u4ee5\u628a\u63e1\u5404\u4e2a\u5206\u7c7b\uff1b\u5f53\u9700\u8981\u5173\u6ce8\u67d0\u4e00\u4e3b\u9898\u65f6\uff0c\u7ec6\u8282\u4e0a\u53c8\u53ef\u4ee5\u4e00\u89c8\u65e0\u4f59\u3002\u8fd9\u4e00\u5207\uff0c\u53ef\u4ee5\u501f\u52a9 Prezi \u5b9e\u73b0\uff01\u5f53\u7136\uff0c\u540c\u7c7b\u578b\u7684\u8f6f\u4ef6\u8fd8\u6709 iPresst \u548c Focusky \u3002 Prezi \u662f\u4e00\u79cd\u4e3b\u8981\u901a\u8fc7\u7f29\u653e\u52a8\u4f5c\u548c\u5feb\u6377\u52a8\u4f5c\u4f7f\u60f3\u6cd5\u66f4\u52a0\u751f\u52a8\u6709\u8da3\u7684\u6f14\u793a\u6587\u7a3f\u8f6f\u4ef6\uff0c\u5b83\u6253\u7834\u4e86\u4f20\u7edfPowerpoint\u7684\u5355\u7ebf\u6761\u65f6\u5e8f\uff0c\u91c7\u7528\u7cfb\u7edf\u6027\u4e0e\u7ed3\u6784\u6027\u4e00\u4f53\u5316\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u6f14\u793a\u3002 \u5b83\u7684 \u7f29\u653e \u529f\u80fd\u6b63\u662f\u6211\u6240\u9700\u8981\u7684\uff0c\u5b8f\u89c2\u4e0a\u4fbf\u4e8e\u628a\u63e1\u5404\u4e2a\u4e3b\u9898\uff0c\u653e\u5927\u540e\u5373\u53ef\u5173\u6ce8\u5177\u4f53\u5185\u5bb9\uff0c\u4e5f\u5c31\u662f\u62d3\u5c55\u4e86\u6211\u4eec\u7684\u89c6\u91ce\u3002\u4ee5\u4e0b\u4e24\u5e45\u56fe\u7247\u4e3a\u5b8f\u89c2\u548c\u7ec6\u8282\u7684\u4e24\u4e2a\u72b6\u6001\uff0c\u6b64\u8fc7\u7a0b\u53ef\u4ee5\u901a\u8fc7\u9f20\u6807\u7684\u6eda\u8f6e\u8fde\u7eed\u5730\u3001\u5e73\u6ed1\u5730\u8fc7\u6e21\u3002 \u5728\u8fd9\u4e2a\u7ec4\u5408\u4e2d\uff0c Prezi \u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u5927\u5c4f\u5e55\uff0c\u5176\u6570\u636e\u6e90\u4e3a EndNote \uff0c\u8fd9\u5c31\u65b9\u4fbf\u4e86\u5bf9\u6570\u91cf\u8f83\u5927\u7684\u6587\u732e\u7684\u7efc\u5408\u89c2\u5bdf\u548c\u5206\u6790\u3002\u6ce8\u610f\uff0c\u56fe2\u53f3\u4e0a\u89d2\u84dd\u8272\u65b9\u6846\u4e2d\u4f5c\u8005+\u5e74\u4efd\u7684 label \u7528\u4e8e\u5efa\u7acb EndNote \u4e0e Prezi \u4e2d\u6587\u732e\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5e76\u4e14\u4e0b\u4e00\u8282\u5c06\u4ecb\u7ecd\u8fd9\u4e2a label \u3002 Prezi \u5e76\u4e0d\u662f\u6587\u732e\u7ba1\u7406\u5de5\u5177\uff0c\u7136\u800c\u4e00\u65e6\u7ed3\u5408 Endnote \u4f7f\u7528\uff0c\u5219\u662f\u5982\u864e\u6dfb\u7ffc\u3002 \u6b63\u6587\u5199\u4f5c\u2014\u2014LaTeX+Adobe illustrator \u00b6 \\LaTeX \\LaTeX \u5728\u957f\u6587\u6863\u6392\u7248\u53ca\u6570\u5b66\u516c\u5f0f\u7684\u5c55\u73b0\u4e0a\u5177\u6709\u65e0\u6bd4\u7684\u4f18\u52bf\uff0c\u5e76\u4e14\u5404\u5927\u9ad8\u6821\u4e00\u822c\u90fd\u6709 \\LaTeX \\LaTeX \u683c\u5f0f\u5b66\u4f4d\u8bba\u6587\u7684\u6a21\u677f\u3002\u8fd9\u5c31\u4f7f\u6211\u4eec\u80fd\u591f\u4e13\u5fc3\u4e8e\u7801\u5b57\uff0c\u57fa\u672c\u7701\u53bb\u4e86\u540e\u671f\u624b\u5de5\u6392\u7248\u7684\u5fe7\u8651\uff1b\u5c24\u5176\u662f\u8bba\u6587\u5b9a\u7a3f\u540e\u7531\u4e8e\u4e0d\u53ef\u6297\u62d2\u56e0\u7d20\u7a81\u5982\u5176\u6765\u7684\u4fee\u6539\uff0c\u4e00\u5b57\u4e4b\u591a\u4fbf\u53ef\u81f4\u4e4b\u524d\u6392\u7248\u5929\u4e0b\u5927\u4e71\u3002\u4ee5\u4e0b\u662f\u6258\u7ba1\u5728Github\u4e0a\u7684\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u5b66\u4f4d\u8bba\u6587\u6a21\u677f\u4e3b\u9875\uff1a https://github.com/dothinking/SJTUThesis \u8fd9\u6837\uff0c\u6b63\u6587\u7684\u5199\u4f5c\u65e0\u975e\u662f\u6587\u5b57\u3001\u516c\u5f0f\u3001\u56fe\u7247\u53ca\u53c2\u8003\u6587\u732e\uff0c\u6587\u5b57\u4e00\u4e2a\u4e2a\u7801\uff0c\u516c\u5f0f\u6709 \\LaTeX \\LaTeX \u7684\u8bed\u6cd5\u53c2\u8003\uff0c\u4ee5\u4e0b\u5206\u522b\u8bf4\u4e00\u4e0b\u56fe\u7247\u548c\u53c2\u8003\u6587\u732e\uff1a \u8003\u8651\u56fe\u7247\u7684\u7f8e\u89c2\u6027\uff0c\u4e00\u822c\u63a8\u8350 eps \u683c\u5f0f\u7684\u77e2\u91cf\u56fe\uff1b\u5e76\u4e14\uff0c\u4fbf\u4e8e\u540e\u671f\u5bf9\u56fe\u7247\u4e2d\u5185\u5bb9\u7684\u4fee\u6539\u3002 Adobe illustrator \uff08\u4ee5\u4e0b\u7b80\u79f0\u4e3a AI \uff09\u3001 CorelDraw \u7b49\u90fd\u662f\u4f18\u79c0\u7684\u77e2\u91cf\u56fe\u7f16\u8f91\u5de5\u5177\u3002 SJTUThesis \u4e2d\u91c7\u7528 bibtex \u7f16\u8bd1\u53c2\u8003\u6587\u732e\uff0c\u8fd9\u5c31\u9700\u8981\u4ece EndNote \u4e2d\u5bfc\u51fa BibTeX \u683c\u5f0f\u7684\u53c2\u8003\u6587\u732e\u6761\u76ee\u3002 \u5728 EndNote \u4e2d\u8bbe\u7f6e\u9700\u8981\u5f15\u7528\u7684\u6587\u732e\u7684 Label \u5c5e\u6027\uff0c\u4f8b\u5982\u4e0b\u56fe\u4e2d\u7684 Bai2015 \uff08\u8fd9\u5c31\u662f\u4e0a\u4e00\u8282\u63d0\u53ca\u7684 Label \uff09\uff0c\u5e76\u4e14\u6ce8\u610f\uff1a\u5bf9\u4e8e\u4e2d\u6587\u6587\u732e\uff0c\u9700\u8981\u8bbe\u7f6e Language \u5c5e\u6027\u4e3a chinese \u3002 \u9009\u62e9\u6587\u732e\u7684\u5bfc\u51fa\u683c\u5f0f\u4e3a BibTeX \uff1a Edit -> Output Styles \u9009\u62e9\u9700\u8981\u5bfc\u51fa\u7684\u8bb0\u5f55\uff1a File -> Export... \u6f14\u793a\u6587\u7a3f\u5236\u4f5c\u2014\u2014Prezi+AI+MathType+PhantomPDF \u00b6 \u5fae\u8f6f\u7684 PPT \u662f\u6587\u7a3f\u6f14\u793a\u8f6f\u4ef6\u7684\u7fd8\u695a\uff0c\u4e0d\u8fc7\u9274\u4e8e Prezi \u975e\u7ebf\u6027\u7684\u3001\u4e8c\u7ef4\u7684\u5185\u5bb9\u7ec4\u7ec7\u65b9\u5f0f\uff0c\u6709\u5229\u4e8e\u66f4\u597d\u5730\u5448\u73b0\u51fa\u5185\u5bb9\u95f4\u7684\u903b\u8f91\u5173\u7cfb\uff0c\u6240\u4ee5\u9009\u62e9\u4e86 Prezi \u4f5c\u4e3a\u7b54\u8fa9\u5185\u5bb9\u7684\u6f14\u793a\u8f6f\u4ef6\u3002 \u8fd9\u4e00\u9636\u6bb5\u53ea\u9700\u6309\u9700\u622a\u53d6 \\LaTeX \\LaTeX \u751f\u6210\u7684PDF\u683c\u5f0f\u7684\u5b66\u4f4d\u8bba\u6587\u5373\u53ef\uff0c\u5982\u679c\u4f60\u5bf9\u76f4\u63a5\u622a\u56fe\u7684\u6570\u5b66\u516c\u5f0f\u7684\u6e05\u6670\u5ea6\u4e0d\u6ee1\u610f\uff0c\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\u7684\u8f6c\u6362\u6b65\u9aa4\uff1a \u590d\u5236\u6e90\u6587\u4ef6\u4e2d \\LaTeX \\LaTeX \u8bed\u6cd5\u683c\u5f0f\u7684\u516c\u5f0f\u5230 MathType \u8f6f\u4ef6\u4e2d\uff0c\u6b64\u65f6\u751f\u6210\u4e86\u6e32\u67d3\u540e\u7684\u516c\u5f0f\uff08\u5982\u679c\u7565\u6709\u9519\u8bef\uff0c\u624b\u52a8\u4fee\u6b63\u5373\u53ef\uff09\u3002 \u590d\u5236\u6e32\u67d3\u540e\u7684\u516c\u5f0f\u5230 AI \uff0c\u6b64\u65f6\u4e3a\u77e2\u91cf\u5316\u7684\u53ef\u7f16\u8f91\u56fe\u5f62\uff1b\u8bbe\u7f6e\u9700\u8981\u7684\u5206\u8fa8\u7387\uff0c\u8f93\u51fa\u900f\u660e\u80cc\u666f\u7684 PNG \u56fe\u7247\u5373\u53ef\u3002 \u53e6\u5916\uff0c\u5982\u679c\u9700\u8981\u5c55\u793a\u8868\u683c\uff0c\u800c\u4f60\u65e2\u4e0d\u60f3\u91cd\u65b0\u8f93\u4e00\u904d\u8868\u683c\u6570\u636e\u53c8\u5bf9\u622a\u56fePDF\u7684\u6548\u679c\u4e0d\u6ee1\u610f\uff0c\u90a3\u4e48\u53ef\u4ee5\u501f\u52a9 PhantomPDF \u548c AI \u5b9e\u73b0\uff1a \u4f7f\u7528 PhantomPDF \u6253\u5f00\u8bba\u6587\uff0c\u5728\u5de6\u4fa7\u7f29\u7565\u56fe\u533a\u57df\u627e\u5230\u5305\u542b\u6240\u9700\u8868\u683c\u7684\u9875\u9762\uff0c\u53f3\u952e\u83dc\u5355\u9009\u62e9 Extract Pages... \uff0c\u4fdd\u5b58\u4e3a\u4e00\u4e2a\u5355\u9875\u6587\u4ef6\u3002 \u4f7f\u7528 AI \u6253\u5f00\u4e0a\u8ff0\u6587\u4ef6\uff0c\u5f97\u5230\u4e86\u77e2\u91cf\u5316\u7684\u5185\u5bb9\uff0c\u5220\u9664\u8868\u683c\u4e4b\u5916\u7684\u5176\u4ed6\u5143\u7d20\uff0c\u6309\u7167\u9700\u8981\u7684\u5206\u8fa8\u7387\u5b58\u50a8\u8868\u683c\u4e3a PNG \u56fe\u7247\u5373\u53ef\u3002","title":"\u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408"},{"location":"2017-01-07-%E5%AD%A6%E4%BD%8D%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E7%BB%84%E5%90%88/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2017-01-07 | \u5206\u7c7b\uff1a process automation \u524d\u540e\u5386\u7ecf\u4e00\u5e74\u7684\u65f6\u95f4\uff0c\u5b66\u4f4d\u8bba\u6587\u7ec8\u4e8e\u5b8c\u7a3f\u3002\u5f80\u7b80\u5355\u65b9\u9762\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ec4\u7ec7\u548c\u6574\u5408\u5df2\u53d1\u8868\u5c0f\u8bba\u6587\u5185\u5bb9\u7684\u8fc7\u7a0b\u2014\u2014\u64b0\u5199\u5185\u5bb9\u672c\u8eab\u4e0d\u518d\u662f\u4e3b\u8981\u95ee\u9898\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u5185\u5bb9\u7684\u8fde\u8d2f\u548c\u6587\u7ae0\u7684\u6392\u7248\u3002\u7136\u800c\uff0c\u8fd9\u4f9d\u65e7\u662f\u4e00\u9879\u6d69\u5927\u7684\u5de5\u7a0b\uff0c\u672c\u6587\u5373\u8bb0\u5f55\u6b64\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u5de5\u5177\u96c6\u5408\u3002","title":"\u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408"},{"location":"2017-01-07-%E5%AD%A6%E4%BD%8D%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E7%BB%84%E5%90%88/#endnoteprezi","text":"EndNote \u662f\u4e00\u6b3e\u5927\u4f17\u666e\u53ca\u7684\u6587\u732e\u7ba1\u7406\u5de5\u5177\uff0c\u5176\u5907\u6ce8\u3001\u5206\u7ec4\u3001\u683c\u5f0f\u5316\u5bfc\u51fa\u7b49\u529f\u80fd\u5df2\u7ecf\u5728\u5e73\u65f6\u7684\u6587\u732e\u9605\u8bfb\u3001\u671f\u520a\u8bba\u6587\u5199\u4f5c\u65b9\u9762\uff0c\u4e3a\u6211\u4eec\u5e26\u6765\u4e86\u6781\u5927\u7684\u4fbf\u5229\u3002\u4e0d\u8fc7\uff0c\u5f53\u6211\u4eec\u5904\u7406\u5b66\u4f4d\u8bba\u6587\u7efc\u8ff0\u90e8\u5206\u4e0a\u767e\u7bc7\u6587\u732e\u53ca\u5176\u76f8\u4e92\u5173\u8054\u65f6\uff0c Endnote \u4e2d\u4e00\u6761\u6761\u6587\u732e\u8bb0\u5f55\u7684\u7ebf\u6027\u6392\u5217\u65b9\u5f0f\u96be\u4ee5\u65b9\u4fbf\u5730\u7ed9\u4e88\u6211\u4eec\u4e00\u4e2a\u4ece\u5168\u5c40\u5230\u7ec6\u8282\u7684\u5b8c\u5168\u638c\u63a7\u3002 \u8fd9\u65f6\u5019\uff0c\u5e0c\u671b\u5c06 EndNote \u4e2d\u4f9d\u6b21\u6392\u5217\u7684\u5206\u7ec4/\u6587\u732e\u5e73\u644a\u5230\u4e00\u5f20\u65e0\u9650\u5927\u7684\u767d\u7eb8\u4e0a\uff0c\u5b8f\u89c2\u4e0a\u53ef\u4ee5\u628a\u63e1\u5404\u4e2a\u5206\u7c7b\uff1b\u5f53\u9700\u8981\u5173\u6ce8\u67d0\u4e00\u4e3b\u9898\u65f6\uff0c\u7ec6\u8282\u4e0a\u53c8\u53ef\u4ee5\u4e00\u89c8\u65e0\u4f59\u3002\u8fd9\u4e00\u5207\uff0c\u53ef\u4ee5\u501f\u52a9 Prezi \u5b9e\u73b0\uff01\u5f53\u7136\uff0c\u540c\u7c7b\u578b\u7684\u8f6f\u4ef6\u8fd8\u6709 iPresst \u548c Focusky \u3002 Prezi \u662f\u4e00\u79cd\u4e3b\u8981\u901a\u8fc7\u7f29\u653e\u52a8\u4f5c\u548c\u5feb\u6377\u52a8\u4f5c\u4f7f\u60f3\u6cd5\u66f4\u52a0\u751f\u52a8\u6709\u8da3\u7684\u6f14\u793a\u6587\u7a3f\u8f6f\u4ef6\uff0c\u5b83\u6253\u7834\u4e86\u4f20\u7edfPowerpoint\u7684\u5355\u7ebf\u6761\u65f6\u5e8f\uff0c\u91c7\u7528\u7cfb\u7edf\u6027\u4e0e\u7ed3\u6784\u6027\u4e00\u4f53\u5316\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u6f14\u793a\u3002 \u5b83\u7684 \u7f29\u653e \u529f\u80fd\u6b63\u662f\u6211\u6240\u9700\u8981\u7684\uff0c\u5b8f\u89c2\u4e0a\u4fbf\u4e8e\u628a\u63e1\u5404\u4e2a\u4e3b\u9898\uff0c\u653e\u5927\u540e\u5373\u53ef\u5173\u6ce8\u5177\u4f53\u5185\u5bb9\uff0c\u4e5f\u5c31\u662f\u62d3\u5c55\u4e86\u6211\u4eec\u7684\u89c6\u91ce\u3002\u4ee5\u4e0b\u4e24\u5e45\u56fe\u7247\u4e3a\u5b8f\u89c2\u548c\u7ec6\u8282\u7684\u4e24\u4e2a\u72b6\u6001\uff0c\u6b64\u8fc7\u7a0b\u53ef\u4ee5\u901a\u8fc7\u9f20\u6807\u7684\u6eda\u8f6e\u8fde\u7eed\u5730\u3001\u5e73\u6ed1\u5730\u8fc7\u6e21\u3002 \u5728\u8fd9\u4e2a\u7ec4\u5408\u4e2d\uff0c Prezi \u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u5927\u5c4f\u5e55\uff0c\u5176\u6570\u636e\u6e90\u4e3a EndNote \uff0c\u8fd9\u5c31\u65b9\u4fbf\u4e86\u5bf9\u6570\u91cf\u8f83\u5927\u7684\u6587\u732e\u7684\u7efc\u5408\u89c2\u5bdf\u548c\u5206\u6790\u3002\u6ce8\u610f\uff0c\u56fe2\u53f3\u4e0a\u89d2\u84dd\u8272\u65b9\u6846\u4e2d\u4f5c\u8005+\u5e74\u4efd\u7684 label \u7528\u4e8e\u5efa\u7acb EndNote \u4e0e Prezi \u4e2d\u6587\u732e\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5e76\u4e14\u4e0b\u4e00\u8282\u5c06\u4ecb\u7ecd\u8fd9\u4e2a label \u3002 Prezi \u5e76\u4e0d\u662f\u6587\u732e\u7ba1\u7406\u5de5\u5177\uff0c\u7136\u800c\u4e00\u65e6\u7ed3\u5408 Endnote \u4f7f\u7528\uff0c\u5219\u662f\u5982\u864e\u6dfb\u7ffc\u3002","title":"\u6587\u732e\u7efc\u8ff0\u2014\u2014Endnote+Prezi"},{"location":"2017-01-07-%E5%AD%A6%E4%BD%8D%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E7%BB%84%E5%90%88/#latexadobe illustrator","text":"\\LaTeX \\LaTeX \u5728\u957f\u6587\u6863\u6392\u7248\u53ca\u6570\u5b66\u516c\u5f0f\u7684\u5c55\u73b0\u4e0a\u5177\u6709\u65e0\u6bd4\u7684\u4f18\u52bf\uff0c\u5e76\u4e14\u5404\u5927\u9ad8\u6821\u4e00\u822c\u90fd\u6709 \\LaTeX \\LaTeX \u683c\u5f0f\u5b66\u4f4d\u8bba\u6587\u7684\u6a21\u677f\u3002\u8fd9\u5c31\u4f7f\u6211\u4eec\u80fd\u591f\u4e13\u5fc3\u4e8e\u7801\u5b57\uff0c\u57fa\u672c\u7701\u53bb\u4e86\u540e\u671f\u624b\u5de5\u6392\u7248\u7684\u5fe7\u8651\uff1b\u5c24\u5176\u662f\u8bba\u6587\u5b9a\u7a3f\u540e\u7531\u4e8e\u4e0d\u53ef\u6297\u62d2\u56e0\u7d20\u7a81\u5982\u5176\u6765\u7684\u4fee\u6539\uff0c\u4e00\u5b57\u4e4b\u591a\u4fbf\u53ef\u81f4\u4e4b\u524d\u6392\u7248\u5929\u4e0b\u5927\u4e71\u3002\u4ee5\u4e0b\u662f\u6258\u7ba1\u5728Github\u4e0a\u7684\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u5b66\u4f4d\u8bba\u6587\u6a21\u677f\u4e3b\u9875\uff1a https://github.com/dothinking/SJTUThesis \u8fd9\u6837\uff0c\u6b63\u6587\u7684\u5199\u4f5c\u65e0\u975e\u662f\u6587\u5b57\u3001\u516c\u5f0f\u3001\u56fe\u7247\u53ca\u53c2\u8003\u6587\u732e\uff0c\u6587\u5b57\u4e00\u4e2a\u4e2a\u7801\uff0c\u516c\u5f0f\u6709 \\LaTeX \\LaTeX \u7684\u8bed\u6cd5\u53c2\u8003\uff0c\u4ee5\u4e0b\u5206\u522b\u8bf4\u4e00\u4e0b\u56fe\u7247\u548c\u53c2\u8003\u6587\u732e\uff1a \u8003\u8651\u56fe\u7247\u7684\u7f8e\u89c2\u6027\uff0c\u4e00\u822c\u63a8\u8350 eps \u683c\u5f0f\u7684\u77e2\u91cf\u56fe\uff1b\u5e76\u4e14\uff0c\u4fbf\u4e8e\u540e\u671f\u5bf9\u56fe\u7247\u4e2d\u5185\u5bb9\u7684\u4fee\u6539\u3002 Adobe illustrator \uff08\u4ee5\u4e0b\u7b80\u79f0\u4e3a AI \uff09\u3001 CorelDraw \u7b49\u90fd\u662f\u4f18\u79c0\u7684\u77e2\u91cf\u56fe\u7f16\u8f91\u5de5\u5177\u3002 SJTUThesis \u4e2d\u91c7\u7528 bibtex \u7f16\u8bd1\u53c2\u8003\u6587\u732e\uff0c\u8fd9\u5c31\u9700\u8981\u4ece EndNote \u4e2d\u5bfc\u51fa BibTeX \u683c\u5f0f\u7684\u53c2\u8003\u6587\u732e\u6761\u76ee\u3002 \u5728 EndNote \u4e2d\u8bbe\u7f6e\u9700\u8981\u5f15\u7528\u7684\u6587\u732e\u7684 Label \u5c5e\u6027\uff0c\u4f8b\u5982\u4e0b\u56fe\u4e2d\u7684 Bai2015 \uff08\u8fd9\u5c31\u662f\u4e0a\u4e00\u8282\u63d0\u53ca\u7684 Label \uff09\uff0c\u5e76\u4e14\u6ce8\u610f\uff1a\u5bf9\u4e8e\u4e2d\u6587\u6587\u732e\uff0c\u9700\u8981\u8bbe\u7f6e Language \u5c5e\u6027\u4e3a chinese \u3002 \u9009\u62e9\u6587\u732e\u7684\u5bfc\u51fa\u683c\u5f0f\u4e3a BibTeX \uff1a Edit -> Output Styles \u9009\u62e9\u9700\u8981\u5bfc\u51fa\u7684\u8bb0\u5f55\uff1a File -> Export...","title":"\u6b63\u6587\u5199\u4f5c\u2014\u2014LaTeX+Adobe illustrator"},{"location":"2017-01-07-%E5%AD%A6%E4%BD%8D%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E4%B8%AD%E7%9A%84%E8%BD%AF%E4%BB%B6%E7%BB%84%E5%90%88/#preziaimathtypephantompdf","text":"\u5fae\u8f6f\u7684 PPT \u662f\u6587\u7a3f\u6f14\u793a\u8f6f\u4ef6\u7684\u7fd8\u695a\uff0c\u4e0d\u8fc7\u9274\u4e8e Prezi \u975e\u7ebf\u6027\u7684\u3001\u4e8c\u7ef4\u7684\u5185\u5bb9\u7ec4\u7ec7\u65b9\u5f0f\uff0c\u6709\u5229\u4e8e\u66f4\u597d\u5730\u5448\u73b0\u51fa\u5185\u5bb9\u95f4\u7684\u903b\u8f91\u5173\u7cfb\uff0c\u6240\u4ee5\u9009\u62e9\u4e86 Prezi \u4f5c\u4e3a\u7b54\u8fa9\u5185\u5bb9\u7684\u6f14\u793a\u8f6f\u4ef6\u3002 \u8fd9\u4e00\u9636\u6bb5\u53ea\u9700\u6309\u9700\u622a\u53d6 \\LaTeX \\LaTeX \u751f\u6210\u7684PDF\u683c\u5f0f\u7684\u5b66\u4f4d\u8bba\u6587\u5373\u53ef\uff0c\u5982\u679c\u4f60\u5bf9\u76f4\u63a5\u622a\u56fe\u7684\u6570\u5b66\u516c\u5f0f\u7684\u6e05\u6670\u5ea6\u4e0d\u6ee1\u610f\uff0c\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\u7684\u8f6c\u6362\u6b65\u9aa4\uff1a \u590d\u5236\u6e90\u6587\u4ef6\u4e2d \\LaTeX \\LaTeX \u8bed\u6cd5\u683c\u5f0f\u7684\u516c\u5f0f\u5230 MathType \u8f6f\u4ef6\u4e2d\uff0c\u6b64\u65f6\u751f\u6210\u4e86\u6e32\u67d3\u540e\u7684\u516c\u5f0f\uff08\u5982\u679c\u7565\u6709\u9519\u8bef\uff0c\u624b\u52a8\u4fee\u6b63\u5373\u53ef\uff09\u3002 \u590d\u5236\u6e32\u67d3\u540e\u7684\u516c\u5f0f\u5230 AI \uff0c\u6b64\u65f6\u4e3a\u77e2\u91cf\u5316\u7684\u53ef\u7f16\u8f91\u56fe\u5f62\uff1b\u8bbe\u7f6e\u9700\u8981\u7684\u5206\u8fa8\u7387\uff0c\u8f93\u51fa\u900f\u660e\u80cc\u666f\u7684 PNG \u56fe\u7247\u5373\u53ef\u3002 \u53e6\u5916\uff0c\u5982\u679c\u9700\u8981\u5c55\u793a\u8868\u683c\uff0c\u800c\u4f60\u65e2\u4e0d\u60f3\u91cd\u65b0\u8f93\u4e00\u904d\u8868\u683c\u6570\u636e\u53c8\u5bf9\u622a\u56fePDF\u7684\u6548\u679c\u4e0d\u6ee1\u610f\uff0c\u90a3\u4e48\u53ef\u4ee5\u501f\u52a9 PhantomPDF \u548c AI \u5b9e\u73b0\uff1a \u4f7f\u7528 PhantomPDF \u6253\u5f00\u8bba\u6587\uff0c\u5728\u5de6\u4fa7\u7f29\u7565\u56fe\u533a\u57df\u627e\u5230\u5305\u542b\u6240\u9700\u8868\u683c\u7684\u9875\u9762\uff0c\u53f3\u952e\u83dc\u5355\u9009\u62e9 Extract Pages... \uff0c\u4fdd\u5b58\u4e3a\u4e00\u4e2a\u5355\u9875\u6587\u4ef6\u3002 \u4f7f\u7528 AI \u6253\u5f00\u4e0a\u8ff0\u6587\u4ef6\uff0c\u5f97\u5230\u4e86\u77e2\u91cf\u5316\u7684\u5185\u5bb9\uff0c\u5220\u9664\u8868\u683c\u4e4b\u5916\u7684\u5176\u4ed6\u5143\u7d20\uff0c\u6309\u7167\u9700\u8981\u7684\u5206\u8fa8\u7387\u5b58\u50a8\u8868\u683c\u4e3a PNG \u56fe\u7247\u5373\u53ef\u3002","title":"\u6f14\u793a\u6587\u7a3f\u5236\u4f5c\u2014\u2014Prezi+AI+MathType+PhantomPDF"},{"location":"2017-03-08-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E8%A7%A3%E4%B8%89%E8%A7%92%E5%BD%A2%E6%B3%95/","text":"\u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-03-08 | \u5206\u7c7b\uff1a mathematics \u6839\u636e\u5730\u7403\u4e0a\u4efb\u610f\u4e24\u5730\u7684\u7ecf\u7eac\u5ea6\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5b83\u4eec\u5728\u7403\u9762\u4e0a\u7684\u6700\u77ed\u8ddd\u79bb\uff08Great-circle Distance / Orthodromic Distance\uff09 \u53ca\u76f8\u5bf9\u59cb\u672b\u4f4d\u7f6e\u7684\u65b9\u4f4d\u89d2\uff08Bearing\uff09\u3002 \u672c\u6587\u57fa\u4e8e\u5730\u7403\u662f\u6807\u51c6\u7403\u4f53\u7684\u5047\u8bbe\uff0c\u4f7f\u7528\u89e3\u4e09\u89d2\u5f62\u6cd5\uff08\u5e73\u9762\u4e09\u89d2\u5f62\u548c\u7403\u9762\u4e09\u89d2\u5f62\uff09\u63a8\u5bfc\u4e0a\u8ff0\u516c\u5f0f\u3002 \u57fa\u672c\u6982\u5ff5 \u00b6 \u7eac\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u4e0e\u7403\u5fc3\u7684\u8fde\u7ebf\u4e0e\u5730\u7403\u8d64\u9053\u9762\u6240\u6210\u7684\u7ebf\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a \\varphi \\varphi \uff09\uff0c\u5317\u7eac\u4e3a\u6b63\u6570\uff0c\u5357\u7eac\u4e3a\u8d1f\u6570\u3002 \u7ecf\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u7ecf\u7ebf\u5e73\u9762\u4e0e\u672c\u521d\u5b50\u5348\u9762\u6240\u6210\u7684\u4e8c\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a\u7684 \\lambda \\lambda \uff09\uff0c\u4e1c\u7ecf\u4e3a\u6b63\u6570\uff0c\u897f\u7ecf\u4e3a\u8d1f\u6570\u3002 \u65b9\u4f4d\u89d2 \u662f\u4ece\u67d0\u70b9\u7684\u6307\u5317\u65b9\u5411\u7ebf\u8d77\uff0c\u4f9d\u987a\u65f6\u9488\u65b9\u5411\u5230\u76ee\u6807\u65b9\u5411\u7ebf\u4e4b\u95f4\u7684\u6c34\u5e73\u5939\u89d2\uff08\u5982\u56fe\u6240\u793a \\theta \\theta \uff09\u3002 \u7403\u9762\u4e0a\u4e24\u70b9P\u3001Q\u7684\u6700\u77ed\u8ddd\u79bb\u4e3a\u8fc7P\u3001Q\u7684\u5927\u5706\u5bf9\u5e94\u4e24\u70b9\u4e4b\u95f4\u7684\u52a3\u5f27\u7684\u957f\u5ea6\uff08\u5982\u56fe\u5b9e\u7ebf\u6240\u793a \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \uff09\u3002\u5c06\u4e0a\u8ff0\u7269\u7406\u91cf\u7b49\u6548\u5230\u5355\u4f4d\u7403\u4e2d\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7403\u9762\u8ddd\u79bb\u516c\u5f0f \u00b6 \u7403\u9762\u8ddd\u79bb d d \u7684\u5e38\u7528\u8ba1\u7b97\u516c\u5f0f\u4e3a Haversine \u516c\u5f0f 1 2 \uff1a \\begin{align*} a &= \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\, sin^2\\frac{\\Delta\\lambda}{2}\\\\ \\delta &= 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \\\\ d &= R\\,\\delta\\\\ \\tag{I} \\end{align*} \u5176\u4e2d\uff0c \\varphi \\varphi \u662f\u7eac\u5ea6\uff0c \\lambda \\lambda \u662f\u7ecf\u5ea6\uff0c R R \u662f\u5730\u7403\u5e73\u5747\u534a\u5f84\uff08 R=6371km R=6371km \uff09\u3002 \\Delta\\varphi=\\varphi_2-\\varphi_1 \\Delta\\varphi=\\varphi_2-\\varphi_1 \uff0c \\Delta\\lambda=\\lambda_2-\\lambda_1 \\Delta\\lambda=\\lambda_2-\\lambda_1 \u5206\u522b\u4e3a\u7eac\u5ea6\u3001\u7ecf\u5ea6\u7684\u5dee\u503c\u3002 \u6ce8\u610f\uff1a \u4ee3\u5165\u8ba1\u7b97\u7684\u7ecf\u3001\u7eac\u5ea6\u4e3a\u6362\u7b97\u540e\u7684\u5f27\u5ea6\u503c\u3002 \u516c\u5f0f\u4e2d\u53cd\u6b63\u5207\u51fd\u6570 atan2() \u533a\u522b\u4e8e\u5e38\u89c4\u7684 atan() \u3002 \u63a8\u5bfc\u601d\u8def \uff1a\u6c42\u51fa \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \u5bf9\u5e94\u7684\u7403\u5fc3\u89d2 \\delta \\delta \uff0c\u7136\u540e\u4f7f\u7528 d = R\\,\\delta d = R\\,\\delta \u6c42\u51fa\u7403\u9762\u8ddd\u79bb\u3002 \u5728\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u76f4\u63a5\u4f7f\u7528\u7403\u9762\u4e09\u89d2\u5f62\u7684\u4f59\u5f26\u5b9a\u7406\uff08Spherical law of cosines\uff09 3 4 \\begin{equation*} \\cos\\delta = \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{*}\\label{eq:1} \\end{equation*} \u4e0a\u5f0f\u5373\u53ef\u6c42\u51fa \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \u5bf9\u5e94\u7684\u7403\u5fc3\u89d2\uff0c\u4f46\u662f\uff0c\u5f53P\u3001Q\u76f8\u90bb\u5f88\u8fd1\uff08\u4f8b\u5982\uff0c\u6570\u7c73\u4e4b\u95f4\uff09\u5373 \\delta \\delta \u8d8b\u8fd1\u4e8e0\u65f6\uff0c \\cos\\delta \\cos\\delta \u5c06\u8d8b\u8fd1\u4e8e1\uff080.99999999\uff09\u3002 \u5176\u540e\u679c\u662f\u5bf9\u4e8e\u4f4e\u6d6e\u70b9\u7cbe\u5ea6\uff08low floating-point precision\uff09\u7684\u8ba1\u7b97\u8bbe\u5907\uff0c\u53ef\u80fd\u7531\u4e8e\u820d\u5165\u8bef\u5dee\u800c\u9020\u6210\u9519\u8bef\u7684\u7ed3\u679c\u3002\u5f53\u7136\uff0c\u5bf9\u4e8e\u73b0\u4ee3\u768464\u4f4d\u6d6e\u70b9\u6570\u8fd0\u7b97 \u7684\u8ba1\u7b97\u673a\uff0c\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0\u4e0a\u8ff0\u95ee\u9898\u3002 \u4e3a\u4e86\u4f7f\u4e0a\u8ff0\u516c\u5f0f\u5177\u6709\u66f4\u597d\u7684\u8ba1\u7b97\u517c\u5bb9\u6027\uff0c\u5728 \\Delta{OPQ} \\Delta{OPQ} \u4e2d\u4f7f\u7528\u5e73\u9762\u4e09\u89d2\u5f62\u4f59\u5f26\u5b9a\u7406 \\begin{align*} {PQ}^2 &= {OP}^2 + {OQ}^2 - 2\\,{OP}\\,{OQ}\\,\\cos\\delta \\\\ &= 2 - 2\\,( \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda )\\\\ &= 2 - 2\\,\\left[ \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\left( 1-2\\,\\sin^2\\frac{\\Delta\\lambda}{2} \\right) \\right ]\\\\ &= 2 - 2(\\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2) + 4\\,\\cos\\varphi_1 \\cos\\varphi_2\\,\\sin^2\\frac{\\Delta\\lambda}{2} \\\\ &= 2\\,\\left( 1-\\cos\\Delta\\varphi \\right) + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} \\\\ &= 4\\,\\sin^2\\frac{\\Delta\\varphi}{2} + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} \\\\ \\end{align*} \u4ee4 a=(PQ/2)^2 a=(PQ/2)^2 \uff0c\u5219\u4e0a\u5f0f\u5199\u4e3a\uff1a a = \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} a = \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} \u8fdb\u800c\u5f97\u5230\u7403\u5fc3\u89d2 \\delta \\delta \u4e3a\uff1a \\delta = 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \\delta = 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \u8bf4\u660e\uff1a \u4ee5\u4e0a\u5173\u4e8e\u89d2\u5ea6\u7684\u63a8\u5bfc\u57fa\u4e8e\u5355\u4f4d\u7403\uff0c\u5373 OP=OQ=1 OP=OQ=1 \u3002 \u65b9\u4f4d\u89d2\u516c\u5f0f \u00b6 \u65b9\u4f4d\u89d2 \\theta \\theta \u7684\u8ba1\u7b97\u516c\u5f0f\uff1a \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \u63a8\u5bfc\u601d\u8def \uff1a\u7403\u9762\u4e09\u89d2\u5f62\u7684\u6b63\u5f26\u5b9a\u7406\u548c\u4f59\u5f26\u5b9a\u7406\u3002 \u5728\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u5206\u522b\u4f7f\u7528\u6b63\u5f26\u5b9a\u7406\u548c\u4f59\u5f26\u5b9a\u7406\uff1a \\begin{align*} \\frac{\\sin\\theta}{\\cos\\varphi_2} &= \\frac{\\sin\\Delta\\lambda}{\\sin\\delta} \\\\ \\sin\\varphi_2 &= \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\, \\cos\\theta \\tag{**}\\label{eq:2} \\end{align*} \u5f97\u5230\uff1a \\begin{align*} \\sin\\theta &= \\frac{\\cos\\varphi_2}{\\sin\\delta} \\, \\sin\\Delta\\lambda\\\\ \\cos\\theta &= \\frac{\\sin\\varphi_2-\\sin\\varphi_1 \\cos\\delta}{\\cos\\varphi_1 \\sin\\delta} \\end{align*} \u4e24\u5f0f\u76f8\u9664\uff0c\u5e76\u5c06\u5f0f\\eqref{eq:1}\u4ee3\u5165\u5f97\uff1a \\begin{align*} \\tan\\theta &= \\frac{\\sin\\Delta\\lambda \\cos\\varphi_1 \\cos\\varphi_2}{\\sin\\varphi_2-\\sin\\varphi_1 \\cos\\delta} \\\\ &= \\frac{\\sin\\Delta\\lambda \\cos\\varphi_1 \\cos\\varphi_2}{\\sin\\varphi_2-\\left( \\sin^2\\varphi_1 \\sin\\varphi_2 + \\sin\\varphi_1 \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\right)}\\\\ &= \\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{ \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda} \\end{align*} \u53d6\u53cd\u51fd\u6570\u5373\u53ef\u5f97\u5230\u65b9\u4f4d\u89d2 \\theta \\theta \u7684\u8868\u8fbe\u5f0f\u3002 \u5df2\u77e5\u8d77\u59cb\u70b9\u3001\u65b9\u4f4d\u89d2\u53ca\u8ddd\u79bb\uff0c\u6c42\u76ee\u6807\u4f4d\u7f6e \u00b6 \u5df2\u77e5\u8d77\u59cb\u70b9\u7ecf\u7eac\u5ea6 P(\\varphi_1,\\lambda_1) P(\\varphi_1,\\lambda_1) \uff0c\u65b9\u5411\u89d2 \\theta \\theta \u53ca\u7403\u9762\u8ddd\u79bb d d \uff0c\u8ba1\u7b97\u76ee\u6807\u4f4d\u7f6e Q(\\varphi_2,\\lambda_2) Q(\\varphi_2,\\lambda_2) \u7684\u516c\u5f0f\u4e3a\uff1a \\begin{align*} \\varphi_2 &= asin \\left( \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \\right)\\\\ \\lambda_2 &= \\lambda_1 + atan2 \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \\tag{III} \\end{align*} \u5176\u4e2d\uff0c\u7403\u5fc3\u89d2 \\delta = d/R \\delta = d/R \u3002 \u63a8\u5bfc\u601d\u8def \uff1a\u5df2\u77e5\u4e24\u8fb9\u53ca\u5939\u89d2\uff0c\u89e3\u7403\u9762\u4e09\u89d2\u5f62\u95ee\u9898\u3002 \u6839\u636e\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u7684\u4f59\u5f26\u5b9a\u7406\uff0c\u5373\u5f0f\\eqref{eq:2}\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\uff0c\u53ef\u76f4\u63a5\u5f97\u5230Q\u70b9\u7684\u7eac\u5ea6\u503c \\varphi_2 \\varphi_2 \u3002 \u6839\u636e\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u7684\u6b63\u5f26\u5b9a\u7406\uff0c\u5373\u5f0f\\eqref{eq:2}\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5f0f\u5b50\uff0c\u5f97\u5230\uff1a \\cos\\varphi_2 \\sin\\Delta\\lambda = \\sin\\theta \\sin\\delta \\cos\\varphi_2 \\sin\\Delta\\lambda = \\sin\\theta \\sin\\delta \u6839\u636e\u5f0f\\eqref{eq:1}\u53ef\u77e5\uff1a \\cos\\varphi_2 \\cos\\Delta\\lambda = \\frac{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2}{\\cos\\varphi_1} \\cos\\varphi_2 \\cos\\Delta\\lambda = \\frac{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2}{\\cos\\varphi_1} \u4ee5\u4e0a\u4e8c\u5f0f\u76f8\u9664\uff1a \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2} \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2} \u4ece\u4e0a\u5f0f\u5373\u53ef\u76f4\u63a5\u89e3\u51faQ\u70b9\u7684\u7ecf\u5ea6 \\lambda_2 = \\lambda_1 + \\Delta\\lambda \\lambda_2 = \\lambda_1 + \\Delta\\lambda \u3002 Calculate distance, bearing and more between Latitude/Longitude points \u21a9 Haversine formula \u21a9 Spherical law of cosines \u21a9 Spherical trigonometry \u21a9","title":"\u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5"},{"location":"2017-03-08-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E8%A7%A3%E4%B8%89%E8%A7%92%E5%BD%A2%E6%B3%95/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2017-03-08 | \u5206\u7c7b\uff1a mathematics \u6839\u636e\u5730\u7403\u4e0a\u4efb\u610f\u4e24\u5730\u7684\u7ecf\u7eac\u5ea6\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5b83\u4eec\u5728\u7403\u9762\u4e0a\u7684\u6700\u77ed\u8ddd\u79bb\uff08Great-circle Distance / Orthodromic Distance\uff09 \u53ca\u76f8\u5bf9\u59cb\u672b\u4f4d\u7f6e\u7684\u65b9\u4f4d\u89d2\uff08Bearing\uff09\u3002 \u672c\u6587\u57fa\u4e8e\u5730\u7403\u662f\u6807\u51c6\u7403\u4f53\u7684\u5047\u8bbe\uff0c\u4f7f\u7528\u89e3\u4e09\u89d2\u5f62\u6cd5\uff08\u5e73\u9762\u4e09\u89d2\u5f62\u548c\u7403\u9762\u4e09\u89d2\u5f62\uff09\u63a8\u5bfc\u4e0a\u8ff0\u516c\u5f0f\u3002","title":"\u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5"},{"location":"2017-03-08-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E8%A7%A3%E4%B8%89%E8%A7%92%E5%BD%A2%E6%B3%95/#_2","text":"\u7eac\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u4e0e\u7403\u5fc3\u7684\u8fde\u7ebf\u4e0e\u5730\u7403\u8d64\u9053\u9762\u6240\u6210\u7684\u7ebf\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a \\varphi \\varphi \uff09\uff0c\u5317\u7eac\u4e3a\u6b63\u6570\uff0c\u5357\u7eac\u4e3a\u8d1f\u6570\u3002 \u7ecf\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u7ecf\u7ebf\u5e73\u9762\u4e0e\u672c\u521d\u5b50\u5348\u9762\u6240\u6210\u7684\u4e8c\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a\u7684 \\lambda \\lambda \uff09\uff0c\u4e1c\u7ecf\u4e3a\u6b63\u6570\uff0c\u897f\u7ecf\u4e3a\u8d1f\u6570\u3002 \u65b9\u4f4d\u89d2 \u662f\u4ece\u67d0\u70b9\u7684\u6307\u5317\u65b9\u5411\u7ebf\u8d77\uff0c\u4f9d\u987a\u65f6\u9488\u65b9\u5411\u5230\u76ee\u6807\u65b9\u5411\u7ebf\u4e4b\u95f4\u7684\u6c34\u5e73\u5939\u89d2\uff08\u5982\u56fe\u6240\u793a \\theta \\theta \uff09\u3002 \u7403\u9762\u4e0a\u4e24\u70b9P\u3001Q\u7684\u6700\u77ed\u8ddd\u79bb\u4e3a\u8fc7P\u3001Q\u7684\u5927\u5706\u5bf9\u5e94\u4e24\u70b9\u4e4b\u95f4\u7684\u52a3\u5f27\u7684\u957f\u5ea6\uff08\u5982\u56fe\u5b9e\u7ebf\u6240\u793a \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \uff09\u3002\u5c06\u4e0a\u8ff0\u7269\u7406\u91cf\u7b49\u6548\u5230\u5355\u4f4d\u7403\u4e2d\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u57fa\u672c\u6982\u5ff5"},{"location":"2017-03-08-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E8%A7%A3%E4%B8%89%E8%A7%92%E5%BD%A2%E6%B3%95/#_3","text":"\u7403\u9762\u8ddd\u79bb d d \u7684\u5e38\u7528\u8ba1\u7b97\u516c\u5f0f\u4e3a Haversine \u516c\u5f0f 1 2 \uff1a \\begin{align*} a &= \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\, sin^2\\frac{\\Delta\\lambda}{2}\\\\ \\delta &= 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \\\\ d &= R\\,\\delta\\\\ \\tag{I} \\end{align*} \u5176\u4e2d\uff0c \\varphi \\varphi \u662f\u7eac\u5ea6\uff0c \\lambda \\lambda \u662f\u7ecf\u5ea6\uff0c R R \u662f\u5730\u7403\u5e73\u5747\u534a\u5f84\uff08 R=6371km R=6371km \uff09\u3002 \\Delta\\varphi=\\varphi_2-\\varphi_1 \\Delta\\varphi=\\varphi_2-\\varphi_1 \uff0c \\Delta\\lambda=\\lambda_2-\\lambda_1 \\Delta\\lambda=\\lambda_2-\\lambda_1 \u5206\u522b\u4e3a\u7eac\u5ea6\u3001\u7ecf\u5ea6\u7684\u5dee\u503c\u3002 \u6ce8\u610f\uff1a \u4ee3\u5165\u8ba1\u7b97\u7684\u7ecf\u3001\u7eac\u5ea6\u4e3a\u6362\u7b97\u540e\u7684\u5f27\u5ea6\u503c\u3002 \u516c\u5f0f\u4e2d\u53cd\u6b63\u5207\u51fd\u6570 atan2() \u533a\u522b\u4e8e\u5e38\u89c4\u7684 atan() \u3002 \u63a8\u5bfc\u601d\u8def \uff1a\u6c42\u51fa \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \u5bf9\u5e94\u7684\u7403\u5fc3\u89d2 \\delta \\delta \uff0c\u7136\u540e\u4f7f\u7528 d = R\\,\\delta d = R\\,\\delta \u6c42\u51fa\u7403\u9762\u8ddd\u79bb\u3002 \u5728\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u76f4\u63a5\u4f7f\u7528\u7403\u9762\u4e09\u89d2\u5f62\u7684\u4f59\u5f26\u5b9a\u7406\uff08Spherical law of cosines\uff09 3 4 \\begin{equation*} \\cos\\delta = \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{*}\\label{eq:1} \\end{equation*} \u4e0a\u5f0f\u5373\u53ef\u6c42\u51fa \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \u5bf9\u5e94\u7684\u7403\u5fc3\u89d2\uff0c\u4f46\u662f\uff0c\u5f53P\u3001Q\u76f8\u90bb\u5f88\u8fd1\uff08\u4f8b\u5982\uff0c\u6570\u7c73\u4e4b\u95f4\uff09\u5373 \\delta \\delta \u8d8b\u8fd1\u4e8e0\u65f6\uff0c \\cos\\delta \\cos\\delta \u5c06\u8d8b\u8fd1\u4e8e1\uff080.99999999\uff09\u3002 \u5176\u540e\u679c\u662f\u5bf9\u4e8e\u4f4e\u6d6e\u70b9\u7cbe\u5ea6\uff08low floating-point precision\uff09\u7684\u8ba1\u7b97\u8bbe\u5907\uff0c\u53ef\u80fd\u7531\u4e8e\u820d\u5165\u8bef\u5dee\u800c\u9020\u6210\u9519\u8bef\u7684\u7ed3\u679c\u3002\u5f53\u7136\uff0c\u5bf9\u4e8e\u73b0\u4ee3\u768464\u4f4d\u6d6e\u70b9\u6570\u8fd0\u7b97 \u7684\u8ba1\u7b97\u673a\uff0c\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0\u4e0a\u8ff0\u95ee\u9898\u3002 \u4e3a\u4e86\u4f7f\u4e0a\u8ff0\u516c\u5f0f\u5177\u6709\u66f4\u597d\u7684\u8ba1\u7b97\u517c\u5bb9\u6027\uff0c\u5728 \\Delta{OPQ} \\Delta{OPQ} \u4e2d\u4f7f\u7528\u5e73\u9762\u4e09\u89d2\u5f62\u4f59\u5f26\u5b9a\u7406 \\begin{align*} {PQ}^2 &= {OP}^2 + {OQ}^2 - 2\\,{OP}\\,{OQ}\\,\\cos\\delta \\\\ &= 2 - 2\\,( \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda )\\\\ &= 2 - 2\\,\\left[ \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\left( 1-2\\,\\sin^2\\frac{\\Delta\\lambda}{2} \\right) \\right ]\\\\ &= 2 - 2(\\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2) + 4\\,\\cos\\varphi_1 \\cos\\varphi_2\\,\\sin^2\\frac{\\Delta\\lambda}{2} \\\\ &= 2\\,\\left( 1-\\cos\\Delta\\varphi \\right) + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} \\\\ &= 4\\,\\sin^2\\frac{\\Delta\\varphi}{2} + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} \\\\ \\end{align*} \u4ee4 a=(PQ/2)^2 a=(PQ/2)^2 \uff0c\u5219\u4e0a\u5f0f\u5199\u4e3a\uff1a a = \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} a = \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\,\\sin^2\\frac{\\Delta\\lambda}{2} \u8fdb\u800c\u5f97\u5230\u7403\u5fc3\u89d2 \\delta \\delta \u4e3a\uff1a \\delta = 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \\delta = 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \u8bf4\u660e\uff1a \u4ee5\u4e0a\u5173\u4e8e\u89d2\u5ea6\u7684\u63a8\u5bfc\u57fa\u4e8e\u5355\u4f4d\u7403\uff0c\u5373 OP=OQ=1 OP=OQ=1 \u3002","title":"\u7403\u9762\u8ddd\u79bb\u516c\u5f0f"},{"location":"2017-03-08-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E8%A7%A3%E4%B8%89%E8%A7%92%E5%BD%A2%E6%B3%95/#_4","text":"\u65b9\u4f4d\u89d2 \\theta \\theta \u7684\u8ba1\u7b97\u516c\u5f0f\uff1a \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \u63a8\u5bfc\u601d\u8def \uff1a\u7403\u9762\u4e09\u89d2\u5f62\u7684\u6b63\u5f26\u5b9a\u7406\u548c\u4f59\u5f26\u5b9a\u7406\u3002 \u5728\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u5206\u522b\u4f7f\u7528\u6b63\u5f26\u5b9a\u7406\u548c\u4f59\u5f26\u5b9a\u7406\uff1a \\begin{align*} \\frac{\\sin\\theta}{\\cos\\varphi_2} &= \\frac{\\sin\\Delta\\lambda}{\\sin\\delta} \\\\ \\sin\\varphi_2 &= \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\, \\cos\\theta \\tag{**}\\label{eq:2} \\end{align*} \u5f97\u5230\uff1a \\begin{align*} \\sin\\theta &= \\frac{\\cos\\varphi_2}{\\sin\\delta} \\, \\sin\\Delta\\lambda\\\\ \\cos\\theta &= \\frac{\\sin\\varphi_2-\\sin\\varphi_1 \\cos\\delta}{\\cos\\varphi_1 \\sin\\delta} \\end{align*} \u4e24\u5f0f\u76f8\u9664\uff0c\u5e76\u5c06\u5f0f\\eqref{eq:1}\u4ee3\u5165\u5f97\uff1a \\begin{align*} \\tan\\theta &= \\frac{\\sin\\Delta\\lambda \\cos\\varphi_1 \\cos\\varphi_2}{\\sin\\varphi_2-\\sin\\varphi_1 \\cos\\delta} \\\\ &= \\frac{\\sin\\Delta\\lambda \\cos\\varphi_1 \\cos\\varphi_2}{\\sin\\varphi_2-\\left( \\sin^2\\varphi_1 \\sin\\varphi_2 + \\sin\\varphi_1 \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\right)}\\\\ &= \\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{ \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda} \\end{align*} \u53d6\u53cd\u51fd\u6570\u5373\u53ef\u5f97\u5230\u65b9\u4f4d\u89d2 \\theta \\theta \u7684\u8868\u8fbe\u5f0f\u3002","title":"\u65b9\u4f4d\u89d2\u516c\u5f0f"},{"location":"2017-03-08-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E8%A7%A3%E4%B8%89%E8%A7%92%E5%BD%A2%E6%B3%95/#_5","text":"\u5df2\u77e5\u8d77\u59cb\u70b9\u7ecf\u7eac\u5ea6 P(\\varphi_1,\\lambda_1) P(\\varphi_1,\\lambda_1) \uff0c\u65b9\u5411\u89d2 \\theta \\theta \u53ca\u7403\u9762\u8ddd\u79bb d d \uff0c\u8ba1\u7b97\u76ee\u6807\u4f4d\u7f6e Q(\\varphi_2,\\lambda_2) Q(\\varphi_2,\\lambda_2) \u7684\u516c\u5f0f\u4e3a\uff1a \\begin{align*} \\varphi_2 &= asin \\left( \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \\right)\\\\ \\lambda_2 &= \\lambda_1 + atan2 \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \\tag{III} \\end{align*} \u5176\u4e2d\uff0c\u7403\u5fc3\u89d2 \\delta = d/R \\delta = d/R \u3002 \u63a8\u5bfc\u601d\u8def \uff1a\u5df2\u77e5\u4e24\u8fb9\u53ca\u5939\u89d2\uff0c\u89e3\u7403\u9762\u4e09\u89d2\u5f62\u95ee\u9898\u3002 \u6839\u636e\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u7684\u4f59\u5f26\u5b9a\u7406\uff0c\u5373\u5f0f\\eqref{eq:2}\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\uff0c\u53ef\u76f4\u63a5\u5f97\u5230Q\u70b9\u7684\u7eac\u5ea6\u503c \\varphi_2 \\varphi_2 \u3002 \u6839\u636e\u7403\u9762\u4e09\u89d2\u5f62NPQ\u4e2d\u7684\u6b63\u5f26\u5b9a\u7406\uff0c\u5373\u5f0f\\eqref{eq:2}\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5f0f\u5b50\uff0c\u5f97\u5230\uff1a \\cos\\varphi_2 \\sin\\Delta\\lambda = \\sin\\theta \\sin\\delta \\cos\\varphi_2 \\sin\\Delta\\lambda = \\sin\\theta \\sin\\delta \u6839\u636e\u5f0f\\eqref{eq:1}\u53ef\u77e5\uff1a \\cos\\varphi_2 \\cos\\Delta\\lambda = \\frac{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2}{\\cos\\varphi_1} \\cos\\varphi_2 \\cos\\Delta\\lambda = \\frac{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2}{\\cos\\varphi_1} \u4ee5\u4e0a\u4e8c\u5f0f\u76f8\u9664\uff1a \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2} \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta - \\sin\\varphi_1 \\sin\\varphi_2} \u4ece\u4e0a\u5f0f\u5373\u53ef\u76f4\u63a5\u89e3\u51faQ\u70b9\u7684\u7ecf\u5ea6 \\lambda_2 = \\lambda_1 + \\Delta\\lambda \\lambda_2 = \\lambda_1 + \\Delta\\lambda \u3002 Calculate distance, bearing and more between Latitude/Longitude points \u21a9 Haversine formula \u21a9 Spherical law of cosines \u21a9 Spherical trigonometry \u21a9","title":"\u5df2\u77e5\u8d77\u59cb\u70b9\u3001\u65b9\u4f4d\u89d2\u53ca\u8ddd\u79bb\uff0c\u6c42\u76ee\u6807\u4f4d\u7f6e"},{"location":"2017-03-09-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E5%90%91%E9%87%8F%E4%BB%A3%E6%95%B0%E6%B3%95/","text":"\u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-03-09 | \u5206\u7c7b\uff1a mathematics \u524d\u4e00\u7bc7\u6587\u7ae0 \u4ece\u51e0\u4f55\u7684\u89d2\u5ea6\uff0c \u4f7f\u7528\u5e38\u89c4\u7684\u89e3\u4e09\u89d2\u5f62\u6cd5\u63a8\u5bfc\u4e86\u7403\u9762\u4e0a\u4e24\u70b9\u95f4\u7684\u6700\u77ed\u8ddd\u79bb\u3001\u65b9\u4f4d\u89d2\u516c\u5f0f\uff1b\u672c\u6587\u5c06\u4ece\u4ee3\u6570\u7684\u89d2\u5ea6\uff0c\u76f4\u63a5\u4f7f\u7528\u5411\u91cf\u8ba1\u7b97\u7684\u65b9\u6cd5\u8fdb\u884c\u63a8\u5bfc\u3002 \u6982\u8ff0 \u00b6 \u672c\u6587\u9700\u8981\u63a8\u5bfc\u7684\u516c\u5f0f\u90fd\u662f\u57fa\u4e8e\u6807\u51c6\u7403\u4f53\u7684\u5047\u8bbe\uff0c\u5e76\u4e14\u7ecf\u7eac\u5ea6\u5750\u6807\u7684\u5b9a\u4e49\u7c7b\u4f3c\u4e8e\u7403\u5750\u6807\u7cfb\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u7403\u5750\u6807\u7cfb\u6765\u63cf\u8ff0\u7a7a\u95f4\u4f4d\u7f6e\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u7ecf\u7eac\u5ea6\u7684\u5b9a\u4e49\u548c\u6807\u51c6\u7403\u5750\u6807\u7cfb\u4e0d\u540c\u4e4b\u5904\uff0c\u5176\u4e2d\u5de6\u56fe\u4e3a\u7ecf\u7eac\u5ea6\u7b49\u7269\u7406\u91cf\u5728\u5355\u4f4d\u7403\u4e2d\u7684\u793a\u610f\uff0c\u53f3\u56fe\u4e3a\u6807\u51c6\u7403\u5750\u6807\u7cfb\u7684\u5b9a\u4e49\u3002 \u7eac\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u4e0e\u7403\u5fc3\u7684\u8fde\u7ebf\u4e0e\u5730\u7403\u8d64\u9053\u9762\u6240\u6210\u7684\u7ebf\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a \\varphi \\varphi \uff09\uff0c\u5317\u7eac\u4e3a\u6b63\u6570\uff0c\u5357\u7eac\u4e3a\u8d1f\u6570\u3002 \u7ecf\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u7ecf\u7ebf\u5e73\u9762\u4e0e\u672c\u521d\u5b50\u5348\u9762\u6240\u6210\u7684\u4e8c\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a\u7684 \\lambda \\lambda \uff09\uff0c\u4e1c\u7ecf\u4e3a\u6b63\u6570\uff0c\u897f\u7ecf\u4e3a\u8d1f\u6570\u3002 \u65b9\u4f4d\u89d2 \u662f\u4ece\u67d0\u70b9\u7684\u6307\u5317\u65b9\u5411\u7ebf\u8d77\uff0c\u4f9d\u987a\u65f6\u9488\u65b9\u5411\u5230\u76ee\u6807\u65b9\u5411\u7ebf\u4e4b\u95f4\u7684\u6c34\u5e73\u5939\u89d2\uff08\u5982\u56fe\u6240\u793a \\theta \\theta \uff09\u3002 \u6839\u636e\u4e0a\u8ff0\u5b9a\u4e49\u53ef\u77e5\uff0c\u5728\u5355\u4f4d\u7403\u9762\u4e0a\uff0c\u7ecf\u7eac\u5ea6 (\\varphi,\\lambda) (\\varphi,\\lambda) \u4e0e\u7403\u5750\u6807 (\\Phi, \\Theta) (\\Phi, \\Theta) \u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u4e3a\uff1a \\begin{align*} \\Phi &= \\frac{\\pi}{2} - \\varphi \\\\ \\Theta &= \\begin{cases} \\lambda + 2\\,\\pi & -\\pi \\le \\lambda \\le 0 \\\\ \\lambda & 0 \\le \\lambda \\le \\pi \\end{cases} \\end{align*} \u4e8e\u662f\uff0c\u76f4\u89d2\u5750\u6807\u7cfb\u4e0e\u7403\u5750\u6807\u7cfb\u7684\u5bf9\u5e94\u5173\u7cfb \\left\\{ \\begin{array}{c} x = \\sin\\Phi \\cos\\Theta \\\\ y = \\sin\\Phi \\sin\\Theta \\\\ z = \\cos\\Phi \\end{array} \\right. \\left\\{ \\begin{array}{c} x = \\sin\\Phi \\cos\\Theta \\\\ y = \\sin\\Phi \\sin\\Theta \\\\ z = \\cos\\Phi \\end{array} \\right. \u8f6c\u6362\u5230\u7ecf\u7eac\u5ea6\u5750\u6807\u7cfb\u4e0b\u4e3a\uff1a \\left\\{ \\begin{array}{c} x = \\cos\\varphi \\cos\\lambda \\\\ y = \\cos\\varphi \\sin\\lambda \\\\ z = \\sin\\varphi \\end{array} \\right. \\left\\{ \\begin{array}{c} x = \\cos\\varphi \\cos\\lambda \\\\ y = \\cos\\varphi \\sin\\lambda \\\\ z = \\sin\\varphi \\end{array} \\right. \u7403\u9762\u8ddd\u79bb\u516c\u5f0f \u00b6 \u7403\u9762\u4e0a\u4e24\u70b9P\u3001Q\u7684\u6700\u77ed\u8ddd\u79bb\u4e3a\u8fc7P\u3001Q\u7684\u5927\u5706\u5bf9\u5e94\u4e24\u70b9\u4e4b\u95f4\u7684\u52a3\u5f27\u7684\u957f\u5ea6\uff08\u5982\u56fe\u5b9e\u7ebf\u6240\u793a \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \uff09\u3002 \u7403\u9762\u8ddd\u79bb d d \u7684\u5e38\u7528\u8ba1\u7b97\u516c\u5f0f\u4e3a Haversine \u516c\u5f0f 1 2 \uff1a \\begin{align*} a &= \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\, sin^2\\frac{\\Delta\\lambda}{2}\\\\ \\delta &= 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \\\\ d &= R\\,\\delta\\\\ \\tag{I} \\end{align*} \u5176\u4e2d\uff0c \\varphi \\varphi \u662f\u7eac\u5ea6\uff0c \\lambda \\lambda \u662f\u7ecf\u5ea6\uff0c R R \u662f\u5730\u7403\u5e73\u5747\u534a\u5f84\uff08 R=6371km R=6371km \uff09\u3002 \\Delta\\varphi=\\varphi_2-\\varphi_1 \\Delta\\varphi=\\varphi_2-\\varphi_1 \uff0c \\Delta\\lambda=\\lambda_2-\\lambda_1 \\Delta\\lambda=\\lambda_2-\\lambda_1 \u5206\u522b\u4e3a\u7eac\u5ea6\u3001\u7ecf\u5ea6\u7684\u5dee\u503c\u3002 \u6ce8\u610f\uff1a \u4ee3\u5165\u8ba1\u7b97\u7684\u7ecf\u3001\u7eac\u5ea6\u4e3a\u6362\u7b97\u540e\u7684\u5f27\u5ea6\u503c\u3002 \u516c\u5f0f\u4e2d\u53cd\u6b63\u5207\u51fd\u6570 atan2() \u533a\u522b\u4e8e\u5e38\u89c4\u7684 atan() \u3002 \u5206\u6790\uff1a \u6839\u636e\u7ecf\u7eac\u5ea6\u5f97\u5230P\u3001Q\u70b9\u7684\u7b1b\u5361\u5c14\u5750\u6807\uff0c\u4ee3\u5165\u4e24\u70b9\u95f4\u8ddd\u79bb\u516c\u5f0f\u8ba1\u7b97\u7403\u5fc3\u89d2\u5bf9\u5e94\u7684\u5f26\u957f\uff0c\u6700\u7ec8\u5f97\u5230\u7403\u5fc3\u89d2\u3002 P\u3001Q\u5728\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\u4e0b\u8868\u793a\u4e3a\uff1a \\left\\{ \\begin{array}{c} x_1 = \\cos\\varphi_1 \\cos\\lambda_1 \\\\ y_1 = \\cos\\varphi_1 \\sin\\lambda_1 \\\\ z_1 = \\sin\\varphi_1 \\end{array} \\right. \\quad \\left\\{ \\begin{array}{c} x_2 = \\cos\\varphi_2 \\cos\\lambda_2 \\\\ y_2 = \\cos\\varphi_2 \\sin\\lambda_2 \\\\ z_2 = \\sin\\varphi_2 \\end{array} \\right. \\left\\{ \\begin{array}{c} x_1 = \\cos\\varphi_1 \\cos\\lambda_1 \\\\ y_1 = \\cos\\varphi_1 \\sin\\lambda_1 \\\\ z_1 = \\sin\\varphi_1 \\end{array} \\right. \\quad \\left\\{ \\begin{array}{c} x_2 = \\cos\\varphi_2 \\cos\\lambda_2 \\\\ y_2 = \\cos\\varphi_2 \\sin\\lambda_2 \\\\ z_2 = \\sin\\varphi_2 \\end{array} \\right. \u4ee3\u5165\u4e24\u70b9\u95f4\u8ddd\u79bb\u516c\u5f0f\uff1a \\begin{align*} PQ^2 &= (\\Delta x)^2 + (\\Delta y)^2 + (\\Delta z)^2 \\\\ &= (\\cos\\varphi_1 \\cos\\lambda_1 - \\cos\\varphi_2 \\cos\\lambda_2)^2 + (\\cos\\varphi_1 \\sin\\lambda_1 - \\cos\\varphi_2 \\sin\\lambda_2)^2 + (\\sin\\varphi_1 - \\sin\\varphi_2)^2 \\\\ &= 2 - 2\\,\\sin\\varphi_1 \\sin\\varphi_2 - 2\\,\\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda\\\\ &= 2 - 2\\,\\cos\\Delta\\varphi + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\sin^2\\frac{\\Delta\\lambda}{2}\\\\ &= 4\\,sin^2\\frac{\\Delta\\varphi}{2} + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\sin^2\\frac{\\Delta\\lambda}{2} \\end{align*} \u4ee4 a=(PQ/2)^2 a=(PQ/2)^2 \u5373\u53ef\u5f97\u5230 Haversine \u516c\u5f0f\u3002 \u4ee5\u4e0a\u5f0f\u4e3a\u57fa\u7840\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63a8\u5bfc\u4f59\u5f26\u5f62\u5f0f\u7684\u7403\u9762\u8ddd\u79bb\u516c\u5f0f\uff1a a = \\sin^2\\frac{\\delta}{2} a = \\sin^2\\frac{\\delta}{2} \u4e8e\u662f\uff0c \\begin{align*} \\cos\\delta &= 1 - 2\\,\\sin^2\\frac{\\delta}{2} = 1 - 2\\,a \\\\ &= 1 - 2\\,sin^2\\frac{\\Delta\\varphi}{2}- 2\\,\\cos\\varphi_1 \\cos\\varphi_2 \\sin^2\\frac{\\Delta\\lambda}{2}\\\\ &= \\cos\\Delta\\varphi - \\cos\\varphi_1 \\cos\\varphi_2 \\left( 1 - \\cos\\Delta\\lambda \\right) \\\\ &= \\left( \\cos\\Delta\\varphi - \\cos\\varphi_1 \\cos\\varphi_2 \\right) + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\\\ &= \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{*}\\label{eq:1} \\end{align*} \u8bf4\u660e\uff1a \u4ee5\u4e0a\u5173\u4e8e\u89d2\u5ea6\u7684\u63a8\u5bfc\u57fa\u4e8e\u5355\u4f4d\u7403\uff0c\u5373 OP=OQ=1 OP=OQ=1 \u3002 \u65b9\u4f4d\u89d2\u516c\u5f0f \u00b6 \u65b9\u4f4d\u89d2 \\theta \\theta \u7684\u8ba1\u7b97\u516c\u5f0f\uff1a \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \u5206\u6790\uff1a \u5982\u4e0b\u56fe\u6240\u793a\uff0cP\u70b9\u5904\u65b9\u4f4d\u89d2 \\theta \\theta \u4e3a\u8fc7P\u70b9\u7684\u4e24\u4e2a\u5927\u5706\u5728\u8be5\u70b9\u5904\u5207\u7ebf\u65b9\u5411\u5411\u91cf \\boldsymbol{\\tau_1},\\,\\boldsymbol{\\tau_2} \\boldsymbol{\\tau_1},\\,\\boldsymbol{\\tau_2} \u7684\u5939\u89d2\u3002 \\begin{align*} \\boldsymbol{\\tau_1} &= \\boldsymbol{\\alpha} \\times \\boldsymbol{n_1} = \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\\\ \\boldsymbol{\\tau_2} &= \\boldsymbol{\\alpha} \\times \\boldsymbol{n_2} = \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\end{align*} \u5176\u4e2d\uff0c \\begin{align*} \\boldsymbol{\\alpha} &= \\left( \\cos\\varphi_1 \\cos\\lambda_1, \\, \\cos\\varphi_1 \\sin\\lambda_1, \\, \\sin\\varphi_1 \\right)\\\\ \\boldsymbol{\\beta} &= \\left( \\cos\\varphi_2 \\cos\\lambda_2, \\, \\cos\\varphi_2 \\sin\\lambda_2, \\, \\sin\\varphi_2 \\right)\\\\ \\boldsymbol{\\gamma} &= \\left( 0, \\, 0, \\, 1\\right) \\end{align*} \u6613\u77e5 \\Vert \\boldsymbol{\\alpha} \\Vert = \\Vert \\boldsymbol{\\beta} \\Vert = \\Vert \\boldsymbol{\\gamma} \\Vert = 1 \\Vert \\boldsymbol{\\alpha} \\Vert = \\Vert \\boldsymbol{\\beta} \\Vert = \\Vert \\boldsymbol{\\gamma} \\Vert = 1 \uff0c \u8fdb\u800c\u53ef\u77e5 \\Vert \\boldsymbol{\\tau_1} \\Vert = \\sin\\delta \\Vert \\boldsymbol{\\tau_1} \\Vert = \\sin\\delta \uff0c \\Vert \\boldsymbol{\\tau_2} \\Vert = \\cos\\varphi_1 \\Vert \\boldsymbol{\\tau_2} \\Vert = \\cos\\varphi_1 \u3002 \u53c2\u8003\u5411\u91cf\u53c9\u79ef\u7684\u8fd0\u7b97\u89c4\u5f8b 3 4 \uff0c\u8fdb\u884c\u5982\u4e0b\u8ba1\u7b97\uff1a \\begin{align*} \\boldsymbol{\\tau_1} \\cdot \\boldsymbol{\\tau_2} &= \\left[ \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\right] \\cdot \\left[ \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\right]\\\\ &= \\left ( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\alpha} \\right) \\cdot \\left[ \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\cdot \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\right] - \\left[ \\boldsymbol{\\alpha} \\cdot \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\right] \\cdot \\left[ \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\cdot \\boldsymbol{\\alpha} \\right] \\\\ &= \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\cdot \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right)\\\\ &= \\left( \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\gamma} \\right) \\cdot \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\alpha} \\right) - \\left( \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\alpha} \\right) \\cdot \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\gamma} \\right)\\\\ &= \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\gamma} - \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\beta} \\right) \\cdot \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\gamma} \\right) \\end{align*} \u5176\u4e2d\uff0c \\begin{align*} \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\gamma} &= \\sin\\varphi_1\\\\ \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\gamma} &= \\sin\\varphi_2\\\\ \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\beta} &= \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\end{align*} \u4ee3\u5165\u8ba1\u7b97\uff1a \\begin{align*} \\boldsymbol{\\tau_1} \\cdot \\boldsymbol{\\tau_2} &= \\sin\\varphi_2 - \\sin^2\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda\\\\ &= \\cos^2\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda\\\\ &= \\cos\\varphi_1 \\left( \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\right) \\end{align*} \u4e8e\u662f\uff0c \\begin{align*} \\cos\\theta &= \\frac{\\boldsymbol{\\tau_1} \\cdot \\boldsymbol{\\tau_2}}{\\Vert \\boldsymbol{\\tau_1} \\Vert \\, \\Vert \\boldsymbol{\\tau_2} \\Vert}\\\\ &= \\frac{\\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda}{\\sin\\delta}\\\\ &= \\frac{t}{\\sin\\delta} \\tag{**}\\label{eq:2} \\end{align*} \u5176\u4e2d\uff0c t = \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda t = \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \u3002 \u7ed3\u5408\u5f0f\\eqref{eq:1}\u548c\u5f0f\\eqref{eq:2}\u53ef\u5f97\uff1a \\begin{align*} \\tan^2\\theta &= \\sec^2\\theta - 1\\\\ &= \\frac{1}{t^2}\\,\\left( \\sin^2\\delta - t^2 \\right)\\\\ &= \\frac{1}{t^2}\\,\\left( 1-\\cos^2 \\delta-t^2 \\right)\\\\ &= \\frac{1}{t^2}\\,\\left( 1-\\sin^2 \\varphi_2-\\cos^2 \\varphi_2 \\cos^2\\Delta\\lambda \\right)\\\\ &= \\left( \\frac{\\cos\\varphi_2 \\, \\sin\\Delta\\lambda}{t} \\right)^2 \\tag{***}\\label{eq:2.5} \\end{align*} \u5373\u53ef\u89e3\u51fa \\theta \\theta \u7684\u8868\u8fbe\u5f0f\u3002 \u5df2\u77e5\u8d77\u59cb\u70b9\u3001\u65b9\u4f4d\u89d2\u53ca\u8ddd\u79bb\uff0c\u6c42\u76ee\u6807\u4f4d\u7f6e \u00b6 \u5df2\u77e5\u8d77\u59cb\u70b9\u7ecf\u7eac\u5ea6 P(\\varphi_1,\\lambda_1) P(\\varphi_1,\\lambda_1) \uff0c\u65b9\u5411\u89d2 \\theta \\theta \u53ca\u7403\u9762\u8ddd\u79bb d d \uff0c\u8ba1\u7b97\u76ee\u6807\u4f4d\u7f6e Q(\\varphi_2,\\lambda_2) Q(\\varphi_2,\\lambda_2) \u7684\u516c\u5f0f\u4e3a\uff1a \\begin{align*} \\varphi_2 &= asin \\left( \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \\right)\\\\ \\lambda_2 &= \\lambda_1 + atan2 \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \\tag{III}\\label{eq:3} \\end{align*} \u5176\u4e2d\uff0c\u7403\u5fc3\u89d2 \\delta = d/R \\delta = d/R \u3002 \u5206\u6790\uff1a \u6839\u636e\u7403\u9762\u8ddd\u79bb\u516c\u5f0f\u548c\u65b9\u4f4d\u89d2\u516c\u5f0f\u53cd\u6c42\u76ee\u6807\u4f4d\u7f6e\u5373\u53ef\u3002 \u7ed3\u5408\u5f0f\\eqref{eq:1}\u548c\u5f0f\\eqref{eq:2}\u5206\u522b\u5f97\u5230\uff1a \\begin{align*} \\sin\\delta \\cos\\theta &= \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{\u2460}\\label{eq:4}\\\\ \\cos\\delta &= \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{\u2461}\\label{eq:5} \\end{align*} \\eqref{eq:4} \\times \\cos\\varphi_1 + \\eqref{eq:5} \\times \\sin\\varphi_1 \\eqref{eq:4} \\times \\cos\\varphi_1 + \\eqref{eq:5} \\times \\sin\\varphi_1 \u5f97\uff1a \\sin\\varphi_2 = \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \\sin\\varphi_2 = \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \u5373\u53ef\u89e3\u51fa\\eqref{eq:3}\u7684\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u3002 \u7ed3\u5408\u5f0f\\eqref{eq:2}\u548c\u5f0f\\eqref{eq:2.5}\u53ef\u5f97\uff1a \\sin\\theta = \\frac{\\sin\\Delta\\lambda \\, \\cos\\varphi_2}{\\sin\\delta} \\sin\\theta = \\frac{\\sin\\Delta\\lambda \\, \\cos\\varphi_2}{\\sin\\delta} \u5373 \\sin\\Delta\\lambda = \\frac{\\sin\\theta\\,\\sin\\delta}{\\cos\\varphi_2} \\sin\\Delta\\lambda = \\frac{\\sin\\theta\\,\\sin\\delta}{\\cos\\varphi_2} \u7531\u5f0f\\eqref{eq:1}\u53ef\u77e5\uff1a \\cos\\Delta\\lambda = \\frac{\\cos\\delta-\\sin\\varphi_1 \\, \\sin\\varphi_2}{\\cos\\varphi_1 \\, \\cos\\varphi_2} \\cos\\Delta\\lambda = \\frac{\\cos\\delta-\\sin\\varphi_1 \\, \\sin\\varphi_2}{\\cos\\varphi_1 \\, \\cos\\varphi_2} \u4ee5\u4e0a\u4e24\u4e2a\u5f0f\u5b50\u76f8\u9664\u5373\u53ef\u5f97\u5230\uff1a \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \u4e8e\u662f\uff0c\u89e3\u51faQ\u70b9\u7684\u7ecf\u5ea6 \\lambda_2 = \\lambda_1 + \\Delta\\lambda \\lambda_2 = \\lambda_1 + \\Delta\\lambda \u5982\u5f0f\\eqref{eq:5}\u7684\u7b2c\u4e8c\u5f0f\u6240\u793a\u3002 Calculate distance, bearing and more between Latitude/Longitude points \u21a9 Haversine formula \u21a9 Cross product \u21a9 Triple product \u21a9","title":"\u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5"},{"location":"2017-03-09-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E5%90%91%E9%87%8F%E4%BB%A3%E6%95%B0%E6%B3%95/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2017-03-09 | \u5206\u7c7b\uff1a mathematics \u524d\u4e00\u7bc7\u6587\u7ae0 \u4ece\u51e0\u4f55\u7684\u89d2\u5ea6\uff0c \u4f7f\u7528\u5e38\u89c4\u7684\u89e3\u4e09\u89d2\u5f62\u6cd5\u63a8\u5bfc\u4e86\u7403\u9762\u4e0a\u4e24\u70b9\u95f4\u7684\u6700\u77ed\u8ddd\u79bb\u3001\u65b9\u4f4d\u89d2\u516c\u5f0f\uff1b\u672c\u6587\u5c06\u4ece\u4ee3\u6570\u7684\u89d2\u5ea6\uff0c\u76f4\u63a5\u4f7f\u7528\u5411\u91cf\u8ba1\u7b97\u7684\u65b9\u6cd5\u8fdb\u884c\u63a8\u5bfc\u3002","title":"\u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5"},{"location":"2017-03-09-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E5%90%91%E9%87%8F%E4%BB%A3%E6%95%B0%E6%B3%95/#_2","text":"\u672c\u6587\u9700\u8981\u63a8\u5bfc\u7684\u516c\u5f0f\u90fd\u662f\u57fa\u4e8e\u6807\u51c6\u7403\u4f53\u7684\u5047\u8bbe\uff0c\u5e76\u4e14\u7ecf\u7eac\u5ea6\u5750\u6807\u7684\u5b9a\u4e49\u7c7b\u4f3c\u4e8e\u7403\u5750\u6807\u7cfb\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u7403\u5750\u6807\u7cfb\u6765\u63cf\u8ff0\u7a7a\u95f4\u4f4d\u7f6e\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u7ecf\u7eac\u5ea6\u7684\u5b9a\u4e49\u548c\u6807\u51c6\u7403\u5750\u6807\u7cfb\u4e0d\u540c\u4e4b\u5904\uff0c\u5176\u4e2d\u5de6\u56fe\u4e3a\u7ecf\u7eac\u5ea6\u7b49\u7269\u7406\u91cf\u5728\u5355\u4f4d\u7403\u4e2d\u7684\u793a\u610f\uff0c\u53f3\u56fe\u4e3a\u6807\u51c6\u7403\u5750\u6807\u7cfb\u7684\u5b9a\u4e49\u3002 \u7eac\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u4e0e\u7403\u5fc3\u7684\u8fde\u7ebf\u4e0e\u5730\u7403\u8d64\u9053\u9762\u6240\u6210\u7684\u7ebf\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a \\varphi \\varphi \uff09\uff0c\u5317\u7eac\u4e3a\u6b63\u6570\uff0c\u5357\u7eac\u4e3a\u8d1f\u6570\u3002 \u7ecf\u5ea6 \u662f\u5730\u7403\u4e0a\u67d0\u70b9\u7ecf\u7ebf\u5e73\u9762\u4e0e\u672c\u521d\u5b50\u5348\u9762\u6240\u6210\u7684\u4e8c\u9762\u89d2\uff08\u5982\u56fe\u6240\u793a\u7684 \\lambda \\lambda \uff09\uff0c\u4e1c\u7ecf\u4e3a\u6b63\u6570\uff0c\u897f\u7ecf\u4e3a\u8d1f\u6570\u3002 \u65b9\u4f4d\u89d2 \u662f\u4ece\u67d0\u70b9\u7684\u6307\u5317\u65b9\u5411\u7ebf\u8d77\uff0c\u4f9d\u987a\u65f6\u9488\u65b9\u5411\u5230\u76ee\u6807\u65b9\u5411\u7ebf\u4e4b\u95f4\u7684\u6c34\u5e73\u5939\u89d2\uff08\u5982\u56fe\u6240\u793a \\theta \\theta \uff09\u3002 \u6839\u636e\u4e0a\u8ff0\u5b9a\u4e49\u53ef\u77e5\uff0c\u5728\u5355\u4f4d\u7403\u9762\u4e0a\uff0c\u7ecf\u7eac\u5ea6 (\\varphi,\\lambda) (\\varphi,\\lambda) \u4e0e\u7403\u5750\u6807 (\\Phi, \\Theta) (\\Phi, \\Theta) \u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u4e3a\uff1a \\begin{align*} \\Phi &= \\frac{\\pi}{2} - \\varphi \\\\ \\Theta &= \\begin{cases} \\lambda + 2\\,\\pi & -\\pi \\le \\lambda \\le 0 \\\\ \\lambda & 0 \\le \\lambda \\le \\pi \\end{cases} \\end{align*} \u4e8e\u662f\uff0c\u76f4\u89d2\u5750\u6807\u7cfb\u4e0e\u7403\u5750\u6807\u7cfb\u7684\u5bf9\u5e94\u5173\u7cfb \\left\\{ \\begin{array}{c} x = \\sin\\Phi \\cos\\Theta \\\\ y = \\sin\\Phi \\sin\\Theta \\\\ z = \\cos\\Phi \\end{array} \\right. \\left\\{ \\begin{array}{c} x = \\sin\\Phi \\cos\\Theta \\\\ y = \\sin\\Phi \\sin\\Theta \\\\ z = \\cos\\Phi \\end{array} \\right. \u8f6c\u6362\u5230\u7ecf\u7eac\u5ea6\u5750\u6807\u7cfb\u4e0b\u4e3a\uff1a \\left\\{ \\begin{array}{c} x = \\cos\\varphi \\cos\\lambda \\\\ y = \\cos\\varphi \\sin\\lambda \\\\ z = \\sin\\varphi \\end{array} \\right. \\left\\{ \\begin{array}{c} x = \\cos\\varphi \\cos\\lambda \\\\ y = \\cos\\varphi \\sin\\lambda \\\\ z = \\sin\\varphi \\end{array} \\right.","title":"\u6982\u8ff0"},{"location":"2017-03-09-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E5%90%91%E9%87%8F%E4%BB%A3%E6%95%B0%E6%B3%95/#_3","text":"\u7403\u9762\u4e0a\u4e24\u70b9P\u3001Q\u7684\u6700\u77ed\u8ddd\u79bb\u4e3a\u8fc7P\u3001Q\u7684\u5927\u5706\u5bf9\u5e94\u4e24\u70b9\u4e4b\u95f4\u7684\u52a3\u5f27\u7684\u957f\u5ea6\uff08\u5982\u56fe\u5b9e\u7ebf\u6240\u793a \\overset{\\frown}{PQ} \\overset{\\frown}{PQ} \uff09\u3002 \u7403\u9762\u8ddd\u79bb d d \u7684\u5e38\u7528\u8ba1\u7b97\u516c\u5f0f\u4e3a Haversine \u516c\u5f0f 1 2 \uff1a \\begin{align*} a &= \\sin^2\\frac{\\Delta\\varphi}{2} + \\cos\\varphi_1 \\cos\\varphi_2 \\, sin^2\\frac{\\Delta\\lambda}{2}\\\\ \\delta &= 2\\,atan2\\frac{\\sqrt{a}}{\\sqrt{1-a}} \\\\ d &= R\\,\\delta\\\\ \\tag{I} \\end{align*} \u5176\u4e2d\uff0c \\varphi \\varphi \u662f\u7eac\u5ea6\uff0c \\lambda \\lambda \u662f\u7ecf\u5ea6\uff0c R R \u662f\u5730\u7403\u5e73\u5747\u534a\u5f84\uff08 R=6371km R=6371km \uff09\u3002 \\Delta\\varphi=\\varphi_2-\\varphi_1 \\Delta\\varphi=\\varphi_2-\\varphi_1 \uff0c \\Delta\\lambda=\\lambda_2-\\lambda_1 \\Delta\\lambda=\\lambda_2-\\lambda_1 \u5206\u522b\u4e3a\u7eac\u5ea6\u3001\u7ecf\u5ea6\u7684\u5dee\u503c\u3002 \u6ce8\u610f\uff1a \u4ee3\u5165\u8ba1\u7b97\u7684\u7ecf\u3001\u7eac\u5ea6\u4e3a\u6362\u7b97\u540e\u7684\u5f27\u5ea6\u503c\u3002 \u516c\u5f0f\u4e2d\u53cd\u6b63\u5207\u51fd\u6570 atan2() \u533a\u522b\u4e8e\u5e38\u89c4\u7684 atan() \u3002 \u5206\u6790\uff1a \u6839\u636e\u7ecf\u7eac\u5ea6\u5f97\u5230P\u3001Q\u70b9\u7684\u7b1b\u5361\u5c14\u5750\u6807\uff0c\u4ee3\u5165\u4e24\u70b9\u95f4\u8ddd\u79bb\u516c\u5f0f\u8ba1\u7b97\u7403\u5fc3\u89d2\u5bf9\u5e94\u7684\u5f26\u957f\uff0c\u6700\u7ec8\u5f97\u5230\u7403\u5fc3\u89d2\u3002 P\u3001Q\u5728\u7b1b\u5361\u5c14\u5750\u6807\u7cfb\u4e0b\u8868\u793a\u4e3a\uff1a \\left\\{ \\begin{array}{c} x_1 = \\cos\\varphi_1 \\cos\\lambda_1 \\\\ y_1 = \\cos\\varphi_1 \\sin\\lambda_1 \\\\ z_1 = \\sin\\varphi_1 \\end{array} \\right. \\quad \\left\\{ \\begin{array}{c} x_2 = \\cos\\varphi_2 \\cos\\lambda_2 \\\\ y_2 = \\cos\\varphi_2 \\sin\\lambda_2 \\\\ z_2 = \\sin\\varphi_2 \\end{array} \\right. \\left\\{ \\begin{array}{c} x_1 = \\cos\\varphi_1 \\cos\\lambda_1 \\\\ y_1 = \\cos\\varphi_1 \\sin\\lambda_1 \\\\ z_1 = \\sin\\varphi_1 \\end{array} \\right. \\quad \\left\\{ \\begin{array}{c} x_2 = \\cos\\varphi_2 \\cos\\lambda_2 \\\\ y_2 = \\cos\\varphi_2 \\sin\\lambda_2 \\\\ z_2 = \\sin\\varphi_2 \\end{array} \\right. \u4ee3\u5165\u4e24\u70b9\u95f4\u8ddd\u79bb\u516c\u5f0f\uff1a \\begin{align*} PQ^2 &= (\\Delta x)^2 + (\\Delta y)^2 + (\\Delta z)^2 \\\\ &= (\\cos\\varphi_1 \\cos\\lambda_1 - \\cos\\varphi_2 \\cos\\lambda_2)^2 + (\\cos\\varphi_1 \\sin\\lambda_1 - \\cos\\varphi_2 \\sin\\lambda_2)^2 + (\\sin\\varphi_1 - \\sin\\varphi_2)^2 \\\\ &= 2 - 2\\,\\sin\\varphi_1 \\sin\\varphi_2 - 2\\,\\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda\\\\ &= 2 - 2\\,\\cos\\Delta\\varphi + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\sin^2\\frac{\\Delta\\lambda}{2}\\\\ &= 4\\,sin^2\\frac{\\Delta\\varphi}{2} + 4\\,\\cos\\varphi_1 \\cos\\varphi_2 \\sin^2\\frac{\\Delta\\lambda}{2} \\end{align*} \u4ee4 a=(PQ/2)^2 a=(PQ/2)^2 \u5373\u53ef\u5f97\u5230 Haversine \u516c\u5f0f\u3002 \u4ee5\u4e0a\u5f0f\u4e3a\u57fa\u7840\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63a8\u5bfc\u4f59\u5f26\u5f62\u5f0f\u7684\u7403\u9762\u8ddd\u79bb\u516c\u5f0f\uff1a a = \\sin^2\\frac{\\delta}{2} a = \\sin^2\\frac{\\delta}{2} \u4e8e\u662f\uff0c \\begin{align*} \\cos\\delta &= 1 - 2\\,\\sin^2\\frac{\\delta}{2} = 1 - 2\\,a \\\\ &= 1 - 2\\,sin^2\\frac{\\Delta\\varphi}{2}- 2\\,\\cos\\varphi_1 \\cos\\varphi_2 \\sin^2\\frac{\\Delta\\lambda}{2}\\\\ &= \\cos\\Delta\\varphi - \\cos\\varphi_1 \\cos\\varphi_2 \\left( 1 - \\cos\\Delta\\lambda \\right) \\\\ &= \\left( \\cos\\Delta\\varphi - \\cos\\varphi_1 \\cos\\varphi_2 \\right) + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\\\ &= \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{*}\\label{eq:1} \\end{align*} \u8bf4\u660e\uff1a \u4ee5\u4e0a\u5173\u4e8e\u89d2\u5ea6\u7684\u63a8\u5bfc\u57fa\u4e8e\u5355\u4f4d\u7403\uff0c\u5373 OP=OQ=1 OP=OQ=1 \u3002","title":"\u7403\u9762\u8ddd\u79bb\u516c\u5f0f"},{"location":"2017-03-09-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E5%90%91%E9%87%8F%E4%BB%A3%E6%95%B0%E6%B3%95/#_4","text":"\u65b9\u4f4d\u89d2 \\theta \\theta \u7684\u8ba1\u7b97\u516c\u5f0f\uff1a \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \\theta = atan2\\frac{\\sin\\Delta\\lambda \\cos\\varphi_2}{\\cos\\varphi_1 \\sin\\varphi_2-\\sin\\varphi_1 \\cos\\varphi_2\\,\\cos\\Delta\\lambda} \\tag{II} \u5206\u6790\uff1a \u5982\u4e0b\u56fe\u6240\u793a\uff0cP\u70b9\u5904\u65b9\u4f4d\u89d2 \\theta \\theta \u4e3a\u8fc7P\u70b9\u7684\u4e24\u4e2a\u5927\u5706\u5728\u8be5\u70b9\u5904\u5207\u7ebf\u65b9\u5411\u5411\u91cf \\boldsymbol{\\tau_1},\\,\\boldsymbol{\\tau_2} \\boldsymbol{\\tau_1},\\,\\boldsymbol{\\tau_2} \u7684\u5939\u89d2\u3002 \\begin{align*} \\boldsymbol{\\tau_1} &= \\boldsymbol{\\alpha} \\times \\boldsymbol{n_1} = \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\\\ \\boldsymbol{\\tau_2} &= \\boldsymbol{\\alpha} \\times \\boldsymbol{n_2} = \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\end{align*} \u5176\u4e2d\uff0c \\begin{align*} \\boldsymbol{\\alpha} &= \\left( \\cos\\varphi_1 \\cos\\lambda_1, \\, \\cos\\varphi_1 \\sin\\lambda_1, \\, \\sin\\varphi_1 \\right)\\\\ \\boldsymbol{\\beta} &= \\left( \\cos\\varphi_2 \\cos\\lambda_2, \\, \\cos\\varphi_2 \\sin\\lambda_2, \\, \\sin\\varphi_2 \\right)\\\\ \\boldsymbol{\\gamma} &= \\left( 0, \\, 0, \\, 1\\right) \\end{align*} \u6613\u77e5 \\Vert \\boldsymbol{\\alpha} \\Vert = \\Vert \\boldsymbol{\\beta} \\Vert = \\Vert \\boldsymbol{\\gamma} \\Vert = 1 \\Vert \\boldsymbol{\\alpha} \\Vert = \\Vert \\boldsymbol{\\beta} \\Vert = \\Vert \\boldsymbol{\\gamma} \\Vert = 1 \uff0c \u8fdb\u800c\u53ef\u77e5 \\Vert \\boldsymbol{\\tau_1} \\Vert = \\sin\\delta \\Vert \\boldsymbol{\\tau_1} \\Vert = \\sin\\delta \uff0c \\Vert \\boldsymbol{\\tau_2} \\Vert = \\cos\\varphi_1 \\Vert \\boldsymbol{\\tau_2} \\Vert = \\cos\\varphi_1 \u3002 \u53c2\u8003\u5411\u91cf\u53c9\u79ef\u7684\u8fd0\u7b97\u89c4\u5f8b 3 4 \uff0c\u8fdb\u884c\u5982\u4e0b\u8ba1\u7b97\uff1a \\begin{align*} \\boldsymbol{\\tau_1} \\cdot \\boldsymbol{\\tau_2} &= \\left[ \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\right] \\cdot \\left[ \\boldsymbol{\\alpha} \\times \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\right]\\\\ &= \\left ( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\alpha} \\right) \\cdot \\left[ \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\cdot \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\right] - \\left[ \\boldsymbol{\\alpha} \\cdot \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right) \\right] \\cdot \\left[ \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\cdot \\boldsymbol{\\alpha} \\right] \\\\ &= \\left( \\boldsymbol{\\beta} \\times \\boldsymbol{\\alpha} \\right) \\cdot \\left( \\boldsymbol{\\gamma} \\times \\boldsymbol{\\alpha} \\right)\\\\ &= \\left( \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\gamma} \\right) \\cdot \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\alpha} \\right) - \\left( \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\alpha} \\right) \\cdot \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\gamma} \\right)\\\\ &= \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\gamma} - \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\beta} \\right) \\cdot \\left( \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\gamma} \\right) \\end{align*} \u5176\u4e2d\uff0c \\begin{align*} \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\gamma} &= \\sin\\varphi_1\\\\ \\boldsymbol{\\beta} \\cdot \\boldsymbol{\\gamma} &= \\sin\\varphi_2\\\\ \\boldsymbol{\\alpha} \\cdot \\boldsymbol{\\beta} &= \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\end{align*} \u4ee3\u5165\u8ba1\u7b97\uff1a \\begin{align*} \\boldsymbol{\\tau_1} \\cdot \\boldsymbol{\\tau_2} &= \\sin\\varphi_2 - \\sin^2\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda\\\\ &= \\cos^2\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda\\\\ &= \\cos\\varphi_1 \\left( \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\right) \\end{align*} \u4e8e\u662f\uff0c \\begin{align*} \\cos\\theta &= \\frac{\\boldsymbol{\\tau_1} \\cdot \\boldsymbol{\\tau_2}}{\\Vert \\boldsymbol{\\tau_1} \\Vert \\, \\Vert \\boldsymbol{\\tau_2} \\Vert}\\\\ &= \\frac{\\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda}{\\sin\\delta}\\\\ &= \\frac{t}{\\sin\\delta} \\tag{**}\\label{eq:2} \\end{align*} \u5176\u4e2d\uff0c t = \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda t = \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \u3002 \u7ed3\u5408\u5f0f\\eqref{eq:1}\u548c\u5f0f\\eqref{eq:2}\u53ef\u5f97\uff1a \\begin{align*} \\tan^2\\theta &= \\sec^2\\theta - 1\\\\ &= \\frac{1}{t^2}\\,\\left( \\sin^2\\delta - t^2 \\right)\\\\ &= \\frac{1}{t^2}\\,\\left( 1-\\cos^2 \\delta-t^2 \\right)\\\\ &= \\frac{1}{t^2}\\,\\left( 1-\\sin^2 \\varphi_2-\\cos^2 \\varphi_2 \\cos^2\\Delta\\lambda \\right)\\\\ &= \\left( \\frac{\\cos\\varphi_2 \\, \\sin\\Delta\\lambda}{t} \\right)^2 \\tag{***}\\label{eq:2.5} \\end{align*} \u5373\u53ef\u89e3\u51fa \\theta \\theta \u7684\u8868\u8fbe\u5f0f\u3002","title":"\u65b9\u4f4d\u89d2\u516c\u5f0f"},{"location":"2017-03-09-%E7%90%83%E9%9D%A2%E8%B7%9D%E7%A6%BB%E4%B8%8E%E6%96%B9%E4%BD%8D%E8%A7%92%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC%EF%BC%9A%E5%90%91%E9%87%8F%E4%BB%A3%E6%95%B0%E6%B3%95/#_5","text":"\u5df2\u77e5\u8d77\u59cb\u70b9\u7ecf\u7eac\u5ea6 P(\\varphi_1,\\lambda_1) P(\\varphi_1,\\lambda_1) \uff0c\u65b9\u5411\u89d2 \\theta \\theta \u53ca\u7403\u9762\u8ddd\u79bb d d \uff0c\u8ba1\u7b97\u76ee\u6807\u4f4d\u7f6e Q(\\varphi_2,\\lambda_2) Q(\\varphi_2,\\lambda_2) \u7684\u516c\u5f0f\u4e3a\uff1a \\begin{align*} \\varphi_2 &= asin \\left( \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \\right)\\\\ \\lambda_2 &= \\lambda_1 + atan2 \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \\tag{III}\\label{eq:3} \\end{align*} \u5176\u4e2d\uff0c\u7403\u5fc3\u89d2 \\delta = d/R \\delta = d/R \u3002 \u5206\u6790\uff1a \u6839\u636e\u7403\u9762\u8ddd\u79bb\u516c\u5f0f\u548c\u65b9\u4f4d\u89d2\u516c\u5f0f\u53cd\u6c42\u76ee\u6807\u4f4d\u7f6e\u5373\u53ef\u3002 \u7ed3\u5408\u5f0f\\eqref{eq:1}\u548c\u5f0f\\eqref{eq:2}\u5206\u522b\u5f97\u5230\uff1a \\begin{align*} \\sin\\delta \\cos\\theta &= \\cos\\varphi_1 \\sin\\varphi_2 - \\sin\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{\u2460}\\label{eq:4}\\\\ \\cos\\delta &= \\sin\\varphi_1 \\sin\\varphi_2 + \\cos\\varphi_1 \\cos\\varphi_2 \\cos\\Delta\\lambda \\tag{\u2461}\\label{eq:5} \\end{align*} \\eqref{eq:4} \\times \\cos\\varphi_1 + \\eqref{eq:5} \\times \\sin\\varphi_1 \\eqref{eq:4} \\times \\cos\\varphi_1 + \\eqref{eq:5} \\times \\sin\\varphi_1 \u5f97\uff1a \\sin\\varphi_2 = \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \\sin\\varphi_2 = \\sin\\varphi_1 \\cos\\delta + \\cos\\varphi_1 \\sin\\delta \\cos\\theta \u5373\u53ef\u89e3\u51fa\\eqref{eq:3}\u7684\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u3002 \u7ed3\u5408\u5f0f\\eqref{eq:2}\u548c\u5f0f\\eqref{eq:2.5}\u53ef\u5f97\uff1a \\sin\\theta = \\frac{\\sin\\Delta\\lambda \\, \\cos\\varphi_2}{\\sin\\delta} \\sin\\theta = \\frac{\\sin\\Delta\\lambda \\, \\cos\\varphi_2}{\\sin\\delta} \u5373 \\sin\\Delta\\lambda = \\frac{\\sin\\theta\\,\\sin\\delta}{\\cos\\varphi_2} \\sin\\Delta\\lambda = \\frac{\\sin\\theta\\,\\sin\\delta}{\\cos\\varphi_2} \u7531\u5f0f\\eqref{eq:1}\u53ef\u77e5\uff1a \\cos\\Delta\\lambda = \\frac{\\cos\\delta-\\sin\\varphi_1 \\, \\sin\\varphi_2}{\\cos\\varphi_1 \\, \\cos\\varphi_2} \\cos\\Delta\\lambda = \\frac{\\cos\\delta-\\sin\\varphi_1 \\, \\sin\\varphi_2}{\\cos\\varphi_1 \\, \\cos\\varphi_2} \u4ee5\u4e0a\u4e24\u4e2a\u5f0f\u5b50\u76f8\u9664\u5373\u53ef\u5f97\u5230\uff1a \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \\tan\\Delta\\lambda = \\frac{\\sin\\theta \\sin\\delta \\cos\\varphi_1}{\\cos\\delta-\\sin\\varphi_1 \\sin\\varphi_2} \u4e8e\u662f\uff0c\u89e3\u51faQ\u70b9\u7684\u7ecf\u5ea6 \\lambda_2 = \\lambda_1 + \\Delta\\lambda \\lambda_2 = \\lambda_1 + \\Delta\\lambda \u5982\u5f0f\\eqref{eq:5}\u7684\u7b2c\u4e8c\u5f0f\u6240\u793a\u3002 Calculate distance, bearing and more between Latitude/Longitude points \u21a9 Haversine formula \u21a9 Cross product \u21a9 Triple product \u21a9","title":"\u5df2\u77e5\u8d77\u59cb\u70b9\u3001\u65b9\u4f4d\u89d2\u53ca\u8ddd\u79bb\uff0c\u6c42\u76ee\u6807\u4f4d\u7f6e"},{"location":"2017-04-24-Selenium%2BPhantomJS%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E6%96%87%E6%9C%AC%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","text":"Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-04-24 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Selenium \u662f\u4e00\u4e2aWeb\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u5316\u6d4b\u8bd5\u5de5\u5177\uff0c\u53ef\u4ee5\u7ed3\u5408\u4e0d\u540c\u7684webDriver\uff08\u5982Chrome\u3001Firefox\u3001Opera\u3001PhantomJs\uff09\u8fdb\u884c\u7a0b\u5e8f\u529f\u80fd\u3001\u517c\u5bb9\u6027\u65b9\u9762\u7684\u6d4b\u8bd5\uff0c\u4e5f\u53ef\u8fdb\u884c\u722c\u866b\u76f8\u5173\u7684\u9875\u9762\u83b7\u53d6\u548c\u5206\u6790\u3002 \u672c\u6587\u8bb0\u5f55\u4f7f\u7528Selenium Python\u7684 send_keys \u65b9\u6cd5\u8fdb\u884c\u6587\u672c\u8f93\u5165\u65f6\u9047\u5230\u7684\u95ee\u9898\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5\u3002 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u4f7f\u7528PhantomJS\u7684WebDriver\uff0c\u65e0\u6cd5\u5728\u767e\u5ea6\u77e5\u9053\u56de\u7b54\u9875\u9762\u7684\u7f16\u8f91\u5668\u4e2d\u8f93\u5165\u6587\u672c\uff1b\u6539\u7528Chrome\u9a71\u52a8\uff0c\u5219\u4e0d\u5b58\u5728\u6b64\u95ee\u9898\u3002 # encoding=utf8 from selenium import webdriver from selenium.webdriver.support.ui import WebDriverWait # \u521d\u59cb\u5316webdriver driver = webdriver.PhantomJS() # driver = webdriver.Chrome() # \u7a97\u53e3\u6700\u5927\u5316 \u2460 driver.maximize_window() # \u83b7\u53d6\u9875\u9762 driver.get(\"https://zhidao.baidu.com/question/524279537996642125.html\") # \u7b49\u5f85\u9875\u9762\u52a0\u8f7d\u5b8c\u6bd5 \u2461 wait = WebDriverWait(driver, 5) try: wait.until(lambda the_driver: the_driver.find_element_by_id('ueditor_0').is_displayed()) except: driver.quit() raise Exception('load page failed.') # \u8f93\u5165\u5185\u5bb9 content = u'\u8fd9\u662f\u4e00\u6bb5\u81ea\u52a8\u8f93\u5165\u7684\u6d4b\u8bd5\u5185\u5bb9' driver.switch_to.frame('ueditor_0') content = driver.find_element_by_tag_name('body') content.clear() content.send_keys(content) # \u622a\u56fe\u89c2\u5bdf\u7ed3\u679c driver.save_screenshot('results.png') driver.quit() \u6ce8\u89e3\uff1a \u2460 \u5bf9\u4e8ePhantomJS\uff0c\u9700\u8981\u6700\u5927\u5316\u7a97\u53e3\uff08\u6216\u8005\u8bbe\u7f6e\u5bbd\u9ad8\uff09\uff0c\u5426\u5219\u67d0\u4e9b\u9875\u9762\u5143\u7d20\u53ef\u80fd\u65e0\u6cd5\u663e\u793a\u800c\u5bfc\u81f4\u51fa\u9519 \u2461 \u8fd9\u91cc\u91c7\u7528 \u663e\u5f0f\u7b49\u5f85 \uff0c\u76ee\u6807\u5143\u7d20\u51fa\u73b0\u5219\u8868\u660e\u9875\u9762\u52a0\u8f7d\u5b8c\u6210 \u4f7f\u7528PhantomJS\u548cChrome\u9a71\u52a8\u7684\u7ed3\u679c\u5206\u522b\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u89c1\u524d\u8005\u65e0\u6cd5\u5b9e\u73b0\u6587\u672c\u7684\u6b63\u786e\u8f93\u5165\u3002 \u539f\u56e0\u5206\u6790 \u00b6 \u4e00\u5f00\u59cb\u6000\u7591\u662f\u4e3a input \uff0c textarea \u7b49\u4e4b\u5916\u7684\u4e0d\u5177\u5907\u8f93\u5165\u5c5e\u6027\u7684\u5143\u7d20\u4f7f\u7528 send_keys \u65b9\u6cd5\u800c\u51fa\u73b0\u7684bug\uff0c\u7136\u800c \u767e\u5ea6\u7f16\u8f91\u5668\u6d4b\u8bd5\u9875\u9762 \u5177\u6709\u7c7b\u4f3c\u7684\u7ed3\u6784\uff0c\u4f7f\u7528\u4e0a\u8ff0\u4ee3\u7801\u5374\u53ef\u4ee5\u5b9e\u73b0\u6587\u672c\u7684\u6b63\u5e38\u8f93\u5165\u3002\u56e0\u6b64\u6392\u9664 iframe \u7684\u5f71\u54cd\uff0c\u6392\u9664 body \u4f5c\u4e3a\u8f93\u5165\u5bb9\u5668\u7684\u539f\u56e0\u3002 \u5177\u4f53\u539f\u56e0\u6682\u4e14\u672a\u77e5\u3002 \u89e3\u51b3\u65b9\u6cd5 \u00b6 \u65e2\u7136\u65e0\u6cd5\u4f7f\u7528 send_keys \u65b9\u6cd5\uff0c\u90a3\u5c31\u6539\u7528javascript\u4ee3\u7801\u8bbe\u7f6e\u5143\u7d20\u5185\u5bb9 \uff1a js = \"document.getElementById('id').innerHTML = ' % s'\" % content driver.execute_script(js) \u672c\u95ee\u9898\u4e2d\uff0c\u76ee\u6807\u5143\u7d20\u5728 iframe \u6807\u7b7e\u5185\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u5982\u4e0b\u83b7\u53d6\u5143\u7d20\u7684\u65b9\u6cd5\uff1a obj = document.getElementById('frame_id').contentWindow.document.getElementsById('target_id') \u7efc\u4e0a\uff0c\u89e3\u51b3\u672c\u95ee\u9898\u7684\u4e3b\u8981\u4ee3\u7801\u4e3a\uff1a # \u8f93\u5165\u5185\u5bb9 content = u'\u8fd9\u662f\u4e00\u6bb5\u81ea\u52a8\u8f93\u5165\u7684\u6d4b\u8bd5\u5185\u5bb9' js = \"document.getElementById('ueditor_0').contentWindow.\\ document.getElementsByTagName('body')[0].innerHTML = ' % s'\" % content driver.execute_script(js)","title":"Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5"},{"location":"2017-04-24-Selenium%2BPhantomJS%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E6%96%87%E6%9C%AC%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#seleniumphantomjs","text":"\u53d1\u5e03\u4e8e\uff1a2017-04-24 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Selenium \u662f\u4e00\u4e2aWeb\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u5316\u6d4b\u8bd5\u5de5\u5177\uff0c\u53ef\u4ee5\u7ed3\u5408\u4e0d\u540c\u7684webDriver\uff08\u5982Chrome\u3001Firefox\u3001Opera\u3001PhantomJs\uff09\u8fdb\u884c\u7a0b\u5e8f\u529f\u80fd\u3001\u517c\u5bb9\u6027\u65b9\u9762\u7684\u6d4b\u8bd5\uff0c\u4e5f\u53ef\u8fdb\u884c\u722c\u866b\u76f8\u5173\u7684\u9875\u9762\u83b7\u53d6\u548c\u5206\u6790\u3002 \u672c\u6587\u8bb0\u5f55\u4f7f\u7528Selenium Python\u7684 send_keys \u65b9\u6cd5\u8fdb\u884c\u6587\u672c\u8f93\u5165\u65f6\u9047\u5230\u7684\u95ee\u9898\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5\u3002","title":"Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5"},{"location":"2017-04-24-Selenium%2BPhantomJS%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E6%96%87%E6%9C%AC%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#_1","text":"\u4f7f\u7528PhantomJS\u7684WebDriver\uff0c\u65e0\u6cd5\u5728\u767e\u5ea6\u77e5\u9053\u56de\u7b54\u9875\u9762\u7684\u7f16\u8f91\u5668\u4e2d\u8f93\u5165\u6587\u672c\uff1b\u6539\u7528Chrome\u9a71\u52a8\uff0c\u5219\u4e0d\u5b58\u5728\u6b64\u95ee\u9898\u3002 # encoding=utf8 from selenium import webdriver from selenium.webdriver.support.ui import WebDriverWait # \u521d\u59cb\u5316webdriver driver = webdriver.PhantomJS() # driver = webdriver.Chrome() # \u7a97\u53e3\u6700\u5927\u5316 \u2460 driver.maximize_window() # \u83b7\u53d6\u9875\u9762 driver.get(\"https://zhidao.baidu.com/question/524279537996642125.html\") # \u7b49\u5f85\u9875\u9762\u52a0\u8f7d\u5b8c\u6bd5 \u2461 wait = WebDriverWait(driver, 5) try: wait.until(lambda the_driver: the_driver.find_element_by_id('ueditor_0').is_displayed()) except: driver.quit() raise Exception('load page failed.') # \u8f93\u5165\u5185\u5bb9 content = u'\u8fd9\u662f\u4e00\u6bb5\u81ea\u52a8\u8f93\u5165\u7684\u6d4b\u8bd5\u5185\u5bb9' driver.switch_to.frame('ueditor_0') content = driver.find_element_by_tag_name('body') content.clear() content.send_keys(content) # \u622a\u56fe\u89c2\u5bdf\u7ed3\u679c driver.save_screenshot('results.png') driver.quit() \u6ce8\u89e3\uff1a \u2460 \u5bf9\u4e8ePhantomJS\uff0c\u9700\u8981\u6700\u5927\u5316\u7a97\u53e3\uff08\u6216\u8005\u8bbe\u7f6e\u5bbd\u9ad8\uff09\uff0c\u5426\u5219\u67d0\u4e9b\u9875\u9762\u5143\u7d20\u53ef\u80fd\u65e0\u6cd5\u663e\u793a\u800c\u5bfc\u81f4\u51fa\u9519 \u2461 \u8fd9\u91cc\u91c7\u7528 \u663e\u5f0f\u7b49\u5f85 \uff0c\u76ee\u6807\u5143\u7d20\u51fa\u73b0\u5219\u8868\u660e\u9875\u9762\u52a0\u8f7d\u5b8c\u6210 \u4f7f\u7528PhantomJS\u548cChrome\u9a71\u52a8\u7684\u7ed3\u679c\u5206\u522b\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u89c1\u524d\u8005\u65e0\u6cd5\u5b9e\u73b0\u6587\u672c\u7684\u6b63\u786e\u8f93\u5165\u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"2017-04-24-Selenium%2BPhantomJS%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E6%96%87%E6%9C%AC%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#_2","text":"\u4e00\u5f00\u59cb\u6000\u7591\u662f\u4e3a input \uff0c textarea \u7b49\u4e4b\u5916\u7684\u4e0d\u5177\u5907\u8f93\u5165\u5c5e\u6027\u7684\u5143\u7d20\u4f7f\u7528 send_keys \u65b9\u6cd5\u800c\u51fa\u73b0\u7684bug\uff0c\u7136\u800c \u767e\u5ea6\u7f16\u8f91\u5668\u6d4b\u8bd5\u9875\u9762 \u5177\u6709\u7c7b\u4f3c\u7684\u7ed3\u6784\uff0c\u4f7f\u7528\u4e0a\u8ff0\u4ee3\u7801\u5374\u53ef\u4ee5\u5b9e\u73b0\u6587\u672c\u7684\u6b63\u5e38\u8f93\u5165\u3002\u56e0\u6b64\u6392\u9664 iframe \u7684\u5f71\u54cd\uff0c\u6392\u9664 body \u4f5c\u4e3a\u8f93\u5165\u5bb9\u5668\u7684\u539f\u56e0\u3002 \u5177\u4f53\u539f\u56e0\u6682\u4e14\u672a\u77e5\u3002","title":"\u539f\u56e0\u5206\u6790"},{"location":"2017-04-24-Selenium%2BPhantomJS%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E6%96%87%E6%9C%AC%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#_3","text":"\u65e2\u7136\u65e0\u6cd5\u4f7f\u7528 send_keys \u65b9\u6cd5\uff0c\u90a3\u5c31\u6539\u7528javascript\u4ee3\u7801\u8bbe\u7f6e\u5143\u7d20\u5185\u5bb9 \uff1a js = \"document.getElementById('id').innerHTML = ' % s'\" % content driver.execute_script(js) \u672c\u95ee\u9898\u4e2d\uff0c\u76ee\u6807\u5143\u7d20\u5728 iframe \u6807\u7b7e\u5185\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u5982\u4e0b\u83b7\u53d6\u5143\u7d20\u7684\u65b9\u6cd5\uff1a obj = document.getElementById('frame_id').contentWindow.document.getElementsById('target_id') \u7efc\u4e0a\uff0c\u89e3\u51b3\u672c\u95ee\u9898\u7684\u4e3b\u8981\u4ee3\u7801\u4e3a\uff1a # \u8f93\u5165\u5185\u5bb9 content = u'\u8fd9\u662f\u4e00\u6bb5\u81ea\u52a8\u8f93\u5165\u7684\u6d4b\u8bd5\u5185\u5bb9' js = \"document.getElementById('ueditor_0').contentWindow.\\ document.getElementsByTagName('body')[0].innerHTML = ' % s'\" % content driver.execute_script(js)","title":"\u89e3\u51b3\u65b9\u6cd5"},{"location":"2017-04-24-Selenium-Python%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%A4%87%E5%BF%98/","text":"Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-04-24 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Selenium \u662f\u4e00\u4e2a\u7528\u4e8eWeb\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u6a21\u62df\u4eba\u7c7b\u4f7f\u7528\u6d4f\u89c8\u5668\u6d4f\u89c8\u9875\u9762\u3001\u8fdb\u884c\u4ea4\u4e92\u7684\u884c\u4e3a\u3002Selenium\u65e2\u652f\u6301Chrome\u3001IE\u3001Firefox\u3001Opera\u7b49\u5e38\u89c4\u6d4f\u89c8\u5668\uff0c\u4e5f\u652f\u6301 PhantomJs \u3001 HtmlUnit \u8fd9\u7c7b\u65e0\u754c\u9762\u6d4f\u89c8\u5668\uff08headless WebKit\uff09\u3002 Selenium\u652f\u6301.Net\u3001Java\u3001Perl\u3001Python\u7b49\u4e0d\u540c\u8bed\u8a00\u7f16\u5199\u7684\u6d4b\u8bd5\u811a\u672c\uff0c\u672c\u6587\u4f7f\u7528\u7684\u662fSelenium Python\u3002\u53c2\u8003\u5e2e\u52a9\u624b\u518c 1 \u3002 Selenium Python bindings provide a convenient API to access Selenium WebDrivers like Firefox, Ie, Chrome, Remote etc. \u5b89\u88c5 \u00b6 \u4f7f\u7528Selenium Python\u5904\u7406\u9875\u9762\u524d\uff0c\u9700\u8981\u5b89\u88c5Selenium\u548c\u81f3\u5c11\u4e00\u4e2aWebDriver\u3002\u672c\u6587\u4f7f\u7528\u7684\u662fChrome\u6d4f\u89c8\u5668\u5bf9\u5e94\u7684chromedriver\uff0c\u4ee5\u53ca\u65e0\u754c\u9762\u6d4f\u89c8\u5668phantomjs\u3002 \u4f7f\u7528 pip \u5b89\u88c5Selenium Python pip install selenium \u4e0b\u8f7dWebDriver\uff08\u901a\u5e38\u662f*.exe\u6587\u4ef6\uff09 Selenium\u5b98\u7f51\u7ed9\u51fa\u4e86\u4e00\u4e9b\u7b2c\u4e09\u65b9\u7684WebDriver\u9a71\u52a8 2 \uff0c\u4e0b\u8f7d\u76f8\u5e94\u9a71\u52a8\u5e76\u4fdd\u5b58\u5230Python\u53ef\u4ee5\u8bc6\u522b\u7684\u76ee\u5f55\uff0c\u4f8b\u5982 C:\\Python27\\Scripts \u3002 \u4ee5\u4e0a\u5b8c\u6210\u4e86\u57fa\u7840\u5de5\u4f5c\uff0c\u672c\u6587\u4f7f\u7528\u7684\u7248\u672c\u4e3a\uff1a Python: 2.7 Selenium: 3.3.3 Chrome Driver: 2.29 PhantomJS: 2.1 \u5b9a\u4f4d\u5143\u7d20 \u00b6 \u5b9a\u4f4d\u5230\u76ee\u6807\u5143\u7d20\u540e\u624d\u80fd\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u5143\u7d20\u5b9a\u4f4d\u662f\u4ee5\u4e0b\u64cd\u4f5c\u7684\u57fa\u7840\u3002Selenium\u63d0\u4f9b\u4e86\u5982\u4e0b\u7684\u5143\u7d20\u5b9a\u4f4d\u65b9\u6cd5\uff1a find_element_by_id() find_element_by_name() find_element_by_xpath() find_element_by_link_text() find_element_by_partial_link_text() find_element_by_tag_name() find_element_by_class_name() find_element_by_css_selector() \u5177\u4f53\u53c2\u6570\u53ca\u4f7f\u7528\u793a\u4f8b\u53c2\u8003\u6587\u6863 3 \u3002 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u67e5\u627e\u6548\u7387\u6309id, name, css_selector, xpath\u9012\u51cf \u3002 \u5f53\u9875\u9762\u4e2d\u5b58\u5728 iframe \u65f6\uff0c\u5219\u9700\u8981\u4f7f\u7528 switch_to.frame() \u65b9\u6cd5\u8df3\u8f6c\u5230\u76f8\u5e94 iframe \uff0c\u6216\u8005\u4f7f\u7528 switch_to.default_content() \u65b9\u6cd5\u5207\u6362\u56de\u9876\u5c42\u7ed3\u6784\u540e\uff0c\u624d\u80fd\u4f7f\u7528\u4e0a\u8ff0\u67e5\u627e\u65b9\u6cd5\u3002\u793a\u4f8bHTML\u7ed3\u6784\uff1a <!DOCTYPE html> <html> <head> <title>test</title> </head> <body> <div id='div_id'></div> <iframe id=\"frame_name\"> <html> <head> <title>frame title</title> </head> <body> <div id='frame_div_id'></div> </body> </html> </iframe> </body> </html> \u793a\u4f8bPython\u811a\u672c\uff1a # encoding=utf8 from selenium import webdriver driver = webdriver.PhantomJS() driver.get(url) # \u5207\u6362\u5230iframe\u540e\u67e5\u627e\u5185\u5c42\u5143\u7d20 driver.switch_to.frame('frame_name') # \u53c2\u6570\u4e3aiframe\u7684id\u6216\u8005name\u5c5e\u6027\u503c frame_div = driver.find_element_by_id('frame_div_id') # \u5207\u6362\u540e\u5916\u5c42\u540e\u67e5\u627e\u5143\u7d20 driver.switch_to.default_content() div = driver.find_element_by_id('div_id') \u83b7\u53d6\u5185\u5bb9 \u00b6 # \u83b7\u53d6\u89e3\u6790\u540e\u7684\u7f51\u9875\u4ee3\u7801 driver.page_source # \u83b7\u53d6\u5143\u7d20\u7684\u5185\u5bb9 / \u503c obj = driver.find_element_by_id('id') print obj.text # \u83b7\u53d6\u6807\u7b7e\u5185\u5bb9\uff0c\u5bf9\u5e94JQuery\u4e2d\u7684html()\u51fd\u6570 print obj.value # \u83b7\u53d6\u6807\u7b7e\u503c\uff0c\u5bf9\u5e94JQuery\u7684val()\u51fd\u6570 # \u83b7\u53d6\u5143\u7d20\u5c5e\u6027 obj.get_attribute('href') # \u83b7\u53d6\u5143\u7d20\u7684css\u5c5e\u6027 obj.value_off_css_property('font') \u9875\u9762\u8f93\u5165 \u00b6 \u4e3b\u8981\u64cd\u4f5c\u6709\u952e\u76d8\u8f93\u5165\u6587\u672c\uff0c\u9f20\u6807\u5355\u51fb\u53ca\u6267\u884cjavascript\u4ee3\u7801\uff1a # \u6587\u672c\u8f93\u5165 obj.send_keys('something') # \u9f20\u6807\u5355\u51fb obj.click() # \u6267\u884cjavascript\u4ee3\u7801 obj.execute_script('alert(\"hello world\")') \u4ee5\u4e0a\u603b\u7ed3\u4e86Selenium Python\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u4e0b\u4e00\u7bc7\u5c06\u5177\u4f53\u4ecb\u7ecd\u4f7f\u7528 send_keys() \u65b9\u6cd5\u8f93\u5165\u6587\u672c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9047\u5230\u7684\u95ee\u9898\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5\u3002 Selenium with Python \u21a9 Third Party Drivers, Bindings, and Plugins \u21a9 Locating Elements \u21a9","title":"Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8"},{"location":"2017-04-24-Selenium-Python%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%A4%87%E5%BF%98/#selenium python","text":"\u53d1\u5e03\u4e8e\uff1a2017-04-24 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Selenium \u662f\u4e00\u4e2a\u7528\u4e8eWeb\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u6a21\u62df\u4eba\u7c7b\u4f7f\u7528\u6d4f\u89c8\u5668\u6d4f\u89c8\u9875\u9762\u3001\u8fdb\u884c\u4ea4\u4e92\u7684\u884c\u4e3a\u3002Selenium\u65e2\u652f\u6301Chrome\u3001IE\u3001Firefox\u3001Opera\u7b49\u5e38\u89c4\u6d4f\u89c8\u5668\uff0c\u4e5f\u652f\u6301 PhantomJs \u3001 HtmlUnit \u8fd9\u7c7b\u65e0\u754c\u9762\u6d4f\u89c8\u5668\uff08headless WebKit\uff09\u3002 Selenium\u652f\u6301.Net\u3001Java\u3001Perl\u3001Python\u7b49\u4e0d\u540c\u8bed\u8a00\u7f16\u5199\u7684\u6d4b\u8bd5\u811a\u672c\uff0c\u672c\u6587\u4f7f\u7528\u7684\u662fSelenium Python\u3002\u53c2\u8003\u5e2e\u52a9\u624b\u518c 1 \u3002 Selenium Python bindings provide a convenient API to access Selenium WebDrivers like Firefox, Ie, Chrome, Remote etc.","title":"Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8"},{"location":"2017-04-24-Selenium-Python%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%A4%87%E5%BF%98/#_1","text":"\u4f7f\u7528Selenium Python\u5904\u7406\u9875\u9762\u524d\uff0c\u9700\u8981\u5b89\u88c5Selenium\u548c\u81f3\u5c11\u4e00\u4e2aWebDriver\u3002\u672c\u6587\u4f7f\u7528\u7684\u662fChrome\u6d4f\u89c8\u5668\u5bf9\u5e94\u7684chromedriver\uff0c\u4ee5\u53ca\u65e0\u754c\u9762\u6d4f\u89c8\u5668phantomjs\u3002 \u4f7f\u7528 pip \u5b89\u88c5Selenium Python pip install selenium \u4e0b\u8f7dWebDriver\uff08\u901a\u5e38\u662f*.exe\u6587\u4ef6\uff09 Selenium\u5b98\u7f51\u7ed9\u51fa\u4e86\u4e00\u4e9b\u7b2c\u4e09\u65b9\u7684WebDriver\u9a71\u52a8 2 \uff0c\u4e0b\u8f7d\u76f8\u5e94\u9a71\u52a8\u5e76\u4fdd\u5b58\u5230Python\u53ef\u4ee5\u8bc6\u522b\u7684\u76ee\u5f55\uff0c\u4f8b\u5982 C:\\Python27\\Scripts \u3002 \u4ee5\u4e0a\u5b8c\u6210\u4e86\u57fa\u7840\u5de5\u4f5c\uff0c\u672c\u6587\u4f7f\u7528\u7684\u7248\u672c\u4e3a\uff1a Python: 2.7 Selenium: 3.3.3 Chrome Driver: 2.29 PhantomJS: 2.1","title":"\u5b89\u88c5"},{"location":"2017-04-24-Selenium-Python%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%A4%87%E5%BF%98/#_2","text":"\u5b9a\u4f4d\u5230\u76ee\u6807\u5143\u7d20\u540e\u624d\u80fd\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u5143\u7d20\u5b9a\u4f4d\u662f\u4ee5\u4e0b\u64cd\u4f5c\u7684\u57fa\u7840\u3002Selenium\u63d0\u4f9b\u4e86\u5982\u4e0b\u7684\u5143\u7d20\u5b9a\u4f4d\u65b9\u6cd5\uff1a find_element_by_id() find_element_by_name() find_element_by_xpath() find_element_by_link_text() find_element_by_partial_link_text() find_element_by_tag_name() find_element_by_class_name() find_element_by_css_selector() \u5177\u4f53\u53c2\u6570\u53ca\u4f7f\u7528\u793a\u4f8b\u53c2\u8003\u6587\u6863 3 \u3002 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u67e5\u627e\u6548\u7387\u6309id, name, css_selector, xpath\u9012\u51cf \u3002 \u5f53\u9875\u9762\u4e2d\u5b58\u5728 iframe \u65f6\uff0c\u5219\u9700\u8981\u4f7f\u7528 switch_to.frame() \u65b9\u6cd5\u8df3\u8f6c\u5230\u76f8\u5e94 iframe \uff0c\u6216\u8005\u4f7f\u7528 switch_to.default_content() \u65b9\u6cd5\u5207\u6362\u56de\u9876\u5c42\u7ed3\u6784\u540e\uff0c\u624d\u80fd\u4f7f\u7528\u4e0a\u8ff0\u67e5\u627e\u65b9\u6cd5\u3002\u793a\u4f8bHTML\u7ed3\u6784\uff1a <!DOCTYPE html> <html> <head> <title>test</title> </head> <body> <div id='div_id'></div> <iframe id=\"frame_name\"> <html> <head> <title>frame title</title> </head> <body> <div id='frame_div_id'></div> </body> </html> </iframe> </body> </html> \u793a\u4f8bPython\u811a\u672c\uff1a # encoding=utf8 from selenium import webdriver driver = webdriver.PhantomJS() driver.get(url) # \u5207\u6362\u5230iframe\u540e\u67e5\u627e\u5185\u5c42\u5143\u7d20 driver.switch_to.frame('frame_name') # \u53c2\u6570\u4e3aiframe\u7684id\u6216\u8005name\u5c5e\u6027\u503c frame_div = driver.find_element_by_id('frame_div_id') # \u5207\u6362\u540e\u5916\u5c42\u540e\u67e5\u627e\u5143\u7d20 driver.switch_to.default_content() div = driver.find_element_by_id('div_id')","title":"\u5b9a\u4f4d\u5143\u7d20"},{"location":"2017-04-24-Selenium-Python%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%A4%87%E5%BF%98/#_3","text":"# \u83b7\u53d6\u89e3\u6790\u540e\u7684\u7f51\u9875\u4ee3\u7801 driver.page_source # \u83b7\u53d6\u5143\u7d20\u7684\u5185\u5bb9 / \u503c obj = driver.find_element_by_id('id') print obj.text # \u83b7\u53d6\u6807\u7b7e\u5185\u5bb9\uff0c\u5bf9\u5e94JQuery\u4e2d\u7684html()\u51fd\u6570 print obj.value # \u83b7\u53d6\u6807\u7b7e\u503c\uff0c\u5bf9\u5e94JQuery\u7684val()\u51fd\u6570 # \u83b7\u53d6\u5143\u7d20\u5c5e\u6027 obj.get_attribute('href') # \u83b7\u53d6\u5143\u7d20\u7684css\u5c5e\u6027 obj.value_off_css_property('font')","title":"\u83b7\u53d6\u5185\u5bb9"},{"location":"2017-04-24-Selenium-Python%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%A4%87%E5%BF%98/#_4","text":"\u4e3b\u8981\u64cd\u4f5c\u6709\u952e\u76d8\u8f93\u5165\u6587\u672c\uff0c\u9f20\u6807\u5355\u51fb\u53ca\u6267\u884cjavascript\u4ee3\u7801\uff1a # \u6587\u672c\u8f93\u5165 obj.send_keys('something') # \u9f20\u6807\u5355\u51fb obj.click() # \u6267\u884cjavascript\u4ee3\u7801 obj.execute_script('alert(\"hello world\")') \u4ee5\u4e0a\u603b\u7ed3\u4e86Selenium Python\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u4e0b\u4e00\u7bc7\u5c06\u5177\u4f53\u4ecb\u7ecd\u4f7f\u7528 send_keys() \u65b9\u6cd5\u8f93\u5165\u6587\u672c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9047\u5230\u7684\u95ee\u9898\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5\u3002 Selenium with Python \u21a9 Third Party Drivers, Bindings, and Plugins \u21a9 Locating Elements \u21a9","title":"\u9875\u9762\u8f93\u5165"},{"location":"2017-07-23-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E6%89%8B%E5%B7%A5%E5%88%9B%E5%BB%BA/","text":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-07-23 | \u5206\u7c7b\uff1a process automation \u5728 Microsoft Excel \u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u501f\u52a9 VBA \uff08Visual Basic for Application\uff09\u5c06\u4e00\u4e9b\u901a\u7528\u6216\u8005\u4e13\u7528\u7684\u529f\u80fd\u5b9a\u4e49\u4e3a\u8fc7\u7a0b\uff08Procedure\uff09\uff0c\u7136\u540e\u7ed1\u5b9a\u5230\u5feb\u6377\u952e\u3001\u6309\u94ae\u6216\u8005\u81ea\u5b9a\u4e49\u83dc\u5355\u4e0a\uff0c\u4ee5\u65b9\u4fbf\u4f7f\u7528\u3002\u672c\u6587\u4ece\u53ef\u79fb\u690d\u6027\u7684\u89d2\u5ea6\uff0c\u8bb0\u5f55\u81ea\u5b9a\u4e49 Excel 2010 \u529f\u80fd\u533a\uff08Ribbon\uff09\u83dc\u5355\u7684\u65b9\u6cd5\u3002 \u5f15\u8a00 \u00b6 \u5047\u8bbe\u81ea\u5b9a\u4e49\u7684\u529f\u80fd\u662f say Hello World \uff1a Sub user_fun() MsgBox \"Hello world.\" End Sub \u6211\u4eec\u901a\u5e38\u5c06\u5176\u4fdd\u5b58\u4e3a\u542f\u7528\u5b8f\u7684\u5de5\u4f5c\u7c3f\uff08hello_world.xlsm\uff09\uff0c\u7136\u540e\u4f7f\u7528\u5feb\u6377\u952e\u6216\u8005\u7ed1\u5b9a\u6309\u94ae\u4e8b\u4ef6\u7684\u65b9\u6cd5\u8fdb\u884c\u8c03\u7528\uff1a \u5f53\u6211\u4eec\u9700\u8981\u5bf9\u591a\u4e2aExcel\u6587\u4ef6\u90fd\u8fdb\u884c say Hello World \u5904\u7406\u65f6\uff0c\u5c31\u9700\u8981\u590d\u5236\u4ee5\u4e0aVBA\u4ee3\u7801\u5230\u6bcf\u4e2a\u6587\u4ef6\u6216\u8005\u5c06\u5404\u4e2a\u6587\u4ef6\u5185\u5bb9\u590d\u5236\u5230\u5f53\u524d\u7684 hello_world.xlsm \u5de5\u4f5c\u8868\u4e2d\u53bb\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0a\u8ff0\u5904\u7406\u65b9\u5f0f\u89e3\u51b3\u4e86\u5355\u4e2aExcel\u6587\u4ef6\u7684\u7279\u5b9a\u95ee\u9898\uff0c\u4f46\u662f\u5728\u53ef\u79fb\u690d\u6027\u4e0a\u5b58\u5728\u4e0d\u8db3\u3002 \u4e8e\u662f\u6211\u4eec\u5e0c\u671b\u5c06 say Hello World \u7684\u529f\u80fd\u56fa\u5b9a\u5230\u83dc\u5355\u680f\uff0c\u4ee5\u65b9\u4fbf\u968f\u65f6\u5bf9\u6709\u9700\u8981\u7684\u6587\u4ef6\u8fdb\u884c\u5904\u7406\u3002\u8fd9\u6837\u7684\u65b9\u5f0f\u5176\u5b9e\u662f\u521b\u5efaExcel\u63d2\u4ef6\uff08Add-in\uff09\uff0c\u5bf9\u5e94\u6587\u4ef6\u6269\u5c55\u540d\u4e3a .xlam \u3002 \u76f8\u5bf9\u542f\u7528\u5b8f\u7684 .xlsm \u6587\u4ef6\uff0c .xlam \u63d2\u4ef6\u5206\u79bb\u4e86\u6570\u636e\u548c\u4ee3\u7801\uff0c\u7528\u6237\u53ea\u9700\u5173\u5fc3\u6570\u636e\u6587\u4ef6\uff0c\u5305\u542b\u4ee3\u7801\u7684 .xlam \u63d2\u4ef6\u5219\u5728\u540e\u53f0\u9ed8\u9ed8\u5730\u542f\u52a8\uff08\u5373\u4e0d\u5177\u5907\u56fe\u5f62\u754c\u9762\uff09\u3002\u5426\u5219\uff0c\u5982\u679c\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u8c03\u7528 .xlsm \u6587\u4ef6\u4e2d\u7684\u8fc7\u7a0b\uff0c .xlsm \u6587\u4ef6\u4e5f\u4f1a\u88ab\u4e00\u5e76\u6253\u5f00\uff0c\u800c\u8fd9\u5bf9\u4e8e\u5173\u5fc3\u6570\u636e\u5904\u7406\u7684\u7528\u6237\u6765\u8bf4\u5b8c\u5168\u6ca1\u6709\u5fc5\u8981\u3002 \u4e8e\u662f\u6211\u4eec\u628a\u4e00\u5f00\u59cb\u7684\u4ee3\u7801\u53e6\u5b58\u4e3a hello_world.xlam \u3002 \u624b\u5de5\u521b\u5efaRibbon\u83dc\u5355 \u00b6 Excel 2010\u5df2\u7ecf\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684\u529f\u80fd\uff0c \u6587\u4ef6 -> \u9009\u9879 -> \u81ea\u5b9a\u4e49\u529f\u80fd\u533a \uff0c\u901a\u8fc7 \u65b0\u5efa\u9009\u9879\u5361 \u548c \u65b0\u5efa\u7ec4 \u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u5361\u548c\u5206\u7ec4\u3002 \u4fdd\u5b58\u540e\u53ef\u4ee5\u770b\u5230\u4e3b\u9009\u9879\u5361\u533a\u57df\u51fa\u73b0\u4e86\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u5361\uff0c\u5f53\u7136\u9009\u9879\u5361\u4e0b\u7a7a\u7a7a\u5982\u4e5f\u3002\u63a5\u4e0b\u6765\u4e3a\u5176\u6dfb\u52a0\u5177\u4f53\u7684\u83dc\u5355\u9879\uff1a\u5728\u4e0a\u8ff0\u5bf9\u8bdd\u6846\u4e2d\u7eff\u8272\u6846\u51fa\u533a\u57df\u9009\u62e9 \u5b8f \uff0c\u7136\u540e\u5c06\u76f8\u5e94\u7684\u5b8f\u62d6\u653e\u5230\u521a\u624d\u65b0\u5efa\u7684\u5206\u7ec4\u4e2d\u5373\u53ef\u3002\u5f53\u7136\uff0c\u6b64\u65f6\u7684\u5b8f\u5217\u8868\u4e5f\u662f\u7a7a\u7a7a\u5982\u4e5f\u3002 \u53cc\u51fb hello_world.xlam \u6253\u5f00\u63d2\u4ef6\uff0c\u6b64\u65f6\u5e76\u65e0\u989d\u5916\u7684\u7a97\u53e3\u51fa\u73b0\uff0c\u4f46\u662f\u4e4b\u524d\u7684\u5b8f\u4ee3\u7801\u5df2\u7136\u88ab\u9ed8\u9ed8\u52a0\u8f7d\u4e86\u3002\u91cd\u65b0\u6309\u524d\u8ff0\u64cd\u4f5c\u6765\u5230 Excel \u9009\u9879 \u5bf9\u8bdd\u6846\u7684 \u81ea\u5b9a\u4e49\u529f\u80fd\u533a \uff0c\u6b64\u65f6\u4e0a\u8ff0\u5b8f\u5217\u8868\u533a\u57df\u51fa\u73b0\u4e86\u81ea\u5b9a\u4e49\u7684 user_fun \uff0c\u5c06\u5176\u62d6\u653e\u5230\u6211\u4eec\u521b\u5efa\u7684 \u81ea\u5b9a\u4e49\u7ec4 \u4e0b\uff0c\u5e76\u4e14\u53ef\u4ee5\u91cd\u547d\u540d\u548c\u9009\u62e9\u56fe\u6807\uff0c\u4fdd\u5b58\u540e\u5f97\u5230\u5982\u4e0b\u5b8c\u6210\u6548\u679c\u3002 \u6b64\u65f6\u5373\u4fbf\u91cd\u65b0\u6253\u5f00\u5176\u4ed6Excel\u6587\u4ef6\uff0c\u81ea\u5b9a\u4e49\u83dc\u5355\u680f\u59cb\u7ec8\u5b58\u5728\uff0c\u83dc\u5355\u9879\u7684\u529f\u80fd\u4f9d\u7136\u751f\u6548\u3002\u4ece\u4e0a\u8ff0\u8fc7\u7a0b\u53ef\u77e5\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u63d2\u4ef6 hello_world.xlam \u5f15\u7528\u4f4d\u7f6e\u4fdd\u6301\u4e0d\u53d8\uff0c\u4e00\u65e6\u5b83\u88ab\u79fb\u52a8\u6216\u8005\u91cd\u547d\u540d\uff0c\u76f8\u5e94\u7684\u529f\u80fd\u4e5f\u5c31\u67e5\u65e0\u6b64\u4eba\u4e86\u3002\u6240\u4ee5\uff0c\u4e00\u822c\u63a8\u8350\u5c06\u5176\u4fdd\u5b58\u5230Excel\u9ed8\u8ba4\u7684\u63d2\u4ef6\u76ee\u5f55\u3002 \u81f3\u6b64\uff0c\u53ef\u4ee5\u6109\u5feb\u5730\u5728\u81ea\u5df1\u7535\u8111\u7684\u4efb\u610fExcel\u6587\u4ef6\u4e0a say hello world \u4e86\u3002\u7136\u800c\uff0c\u5982\u679c\u8d75\u3001\u94b1\u3001\u5b59\u3001\u674e\u4e5f\u90fd\u60f3 say hello world \uff0c\u96be\u9053\u6bcf\u4eba\u90fd\u9700\u8981\u5982\u6b64\u91cd\u590d\u4e00\u904d\uff1f \u663e\u7136\uff0c\u4e0a\u8ff0\u65b9\u6848\u7684\u53ef\u79fb\u690d\u6027\u4f9d\u7136\u4e0d\u5f3a\uff0c\u6211\u4eec\u5e0c\u671b\u8d75\u3001\u94b1\u3001\u5b59\u3001\u674e\u6536\u5230 hello_world.xlam \u6587\u4ef6\u540e\uff0c\u53ef\u4ee5\u81ea\u52a8\u5b8c\u6210\u4e0a\u8ff0\u8fc7\u7a0b\u3002\u4e8e\u662f\uff0c\u8fd9\u5c31\u9700\u8981\uff1a \u5728Excel\u63d2\u4ef6\u4e2d\u81ea\u52a8\u521b\u5efaRibbon\u83dc\u5355","title":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa"},{"location":"2017-07-23-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E6%89%8B%E5%B7%A5%E5%88%9B%E5%BB%BA/#microsoft excel 2010","text":"\u53d1\u5e03\u4e8e\uff1a2017-07-23 | \u5206\u7c7b\uff1a process automation \u5728 Microsoft Excel \u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u501f\u52a9 VBA \uff08Visual Basic for Application\uff09\u5c06\u4e00\u4e9b\u901a\u7528\u6216\u8005\u4e13\u7528\u7684\u529f\u80fd\u5b9a\u4e49\u4e3a\u8fc7\u7a0b\uff08Procedure\uff09\uff0c\u7136\u540e\u7ed1\u5b9a\u5230\u5feb\u6377\u952e\u3001\u6309\u94ae\u6216\u8005\u81ea\u5b9a\u4e49\u83dc\u5355\u4e0a\uff0c\u4ee5\u65b9\u4fbf\u4f7f\u7528\u3002\u672c\u6587\u4ece\u53ef\u79fb\u690d\u6027\u7684\u89d2\u5ea6\uff0c\u8bb0\u5f55\u81ea\u5b9a\u4e49 Excel 2010 \u529f\u80fd\u533a\uff08Ribbon\uff09\u83dc\u5355\u7684\u65b9\u6cd5\u3002","title":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa"},{"location":"2017-07-23-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E6%89%8B%E5%B7%A5%E5%88%9B%E5%BB%BA/#_1","text":"\u5047\u8bbe\u81ea\u5b9a\u4e49\u7684\u529f\u80fd\u662f say Hello World \uff1a Sub user_fun() MsgBox \"Hello world.\" End Sub \u6211\u4eec\u901a\u5e38\u5c06\u5176\u4fdd\u5b58\u4e3a\u542f\u7528\u5b8f\u7684\u5de5\u4f5c\u7c3f\uff08hello_world.xlsm\uff09\uff0c\u7136\u540e\u4f7f\u7528\u5feb\u6377\u952e\u6216\u8005\u7ed1\u5b9a\u6309\u94ae\u4e8b\u4ef6\u7684\u65b9\u6cd5\u8fdb\u884c\u8c03\u7528\uff1a \u5f53\u6211\u4eec\u9700\u8981\u5bf9\u591a\u4e2aExcel\u6587\u4ef6\u90fd\u8fdb\u884c say Hello World \u5904\u7406\u65f6\uff0c\u5c31\u9700\u8981\u590d\u5236\u4ee5\u4e0aVBA\u4ee3\u7801\u5230\u6bcf\u4e2a\u6587\u4ef6\u6216\u8005\u5c06\u5404\u4e2a\u6587\u4ef6\u5185\u5bb9\u590d\u5236\u5230\u5f53\u524d\u7684 hello_world.xlsm \u5de5\u4f5c\u8868\u4e2d\u53bb\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0a\u8ff0\u5904\u7406\u65b9\u5f0f\u89e3\u51b3\u4e86\u5355\u4e2aExcel\u6587\u4ef6\u7684\u7279\u5b9a\u95ee\u9898\uff0c\u4f46\u662f\u5728\u53ef\u79fb\u690d\u6027\u4e0a\u5b58\u5728\u4e0d\u8db3\u3002 \u4e8e\u662f\u6211\u4eec\u5e0c\u671b\u5c06 say Hello World \u7684\u529f\u80fd\u56fa\u5b9a\u5230\u83dc\u5355\u680f\uff0c\u4ee5\u65b9\u4fbf\u968f\u65f6\u5bf9\u6709\u9700\u8981\u7684\u6587\u4ef6\u8fdb\u884c\u5904\u7406\u3002\u8fd9\u6837\u7684\u65b9\u5f0f\u5176\u5b9e\u662f\u521b\u5efaExcel\u63d2\u4ef6\uff08Add-in\uff09\uff0c\u5bf9\u5e94\u6587\u4ef6\u6269\u5c55\u540d\u4e3a .xlam \u3002 \u76f8\u5bf9\u542f\u7528\u5b8f\u7684 .xlsm \u6587\u4ef6\uff0c .xlam \u63d2\u4ef6\u5206\u79bb\u4e86\u6570\u636e\u548c\u4ee3\u7801\uff0c\u7528\u6237\u53ea\u9700\u5173\u5fc3\u6570\u636e\u6587\u4ef6\uff0c\u5305\u542b\u4ee3\u7801\u7684 .xlam \u63d2\u4ef6\u5219\u5728\u540e\u53f0\u9ed8\u9ed8\u5730\u542f\u52a8\uff08\u5373\u4e0d\u5177\u5907\u56fe\u5f62\u754c\u9762\uff09\u3002\u5426\u5219\uff0c\u5982\u679c\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u8c03\u7528 .xlsm \u6587\u4ef6\u4e2d\u7684\u8fc7\u7a0b\uff0c .xlsm \u6587\u4ef6\u4e5f\u4f1a\u88ab\u4e00\u5e76\u6253\u5f00\uff0c\u800c\u8fd9\u5bf9\u4e8e\u5173\u5fc3\u6570\u636e\u5904\u7406\u7684\u7528\u6237\u6765\u8bf4\u5b8c\u5168\u6ca1\u6709\u5fc5\u8981\u3002 \u4e8e\u662f\u6211\u4eec\u628a\u4e00\u5f00\u59cb\u7684\u4ee3\u7801\u53e6\u5b58\u4e3a hello_world.xlam \u3002","title":"\u5f15\u8a00"},{"location":"2017-07-23-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E6%89%8B%E5%B7%A5%E5%88%9B%E5%BB%BA/#ribbon","text":"Excel 2010\u5df2\u7ecf\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684\u529f\u80fd\uff0c \u6587\u4ef6 -> \u9009\u9879 -> \u81ea\u5b9a\u4e49\u529f\u80fd\u533a \uff0c\u901a\u8fc7 \u65b0\u5efa\u9009\u9879\u5361 \u548c \u65b0\u5efa\u7ec4 \u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u5361\u548c\u5206\u7ec4\u3002 \u4fdd\u5b58\u540e\u53ef\u4ee5\u770b\u5230\u4e3b\u9009\u9879\u5361\u533a\u57df\u51fa\u73b0\u4e86\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u5361\uff0c\u5f53\u7136\u9009\u9879\u5361\u4e0b\u7a7a\u7a7a\u5982\u4e5f\u3002\u63a5\u4e0b\u6765\u4e3a\u5176\u6dfb\u52a0\u5177\u4f53\u7684\u83dc\u5355\u9879\uff1a\u5728\u4e0a\u8ff0\u5bf9\u8bdd\u6846\u4e2d\u7eff\u8272\u6846\u51fa\u533a\u57df\u9009\u62e9 \u5b8f \uff0c\u7136\u540e\u5c06\u76f8\u5e94\u7684\u5b8f\u62d6\u653e\u5230\u521a\u624d\u65b0\u5efa\u7684\u5206\u7ec4\u4e2d\u5373\u53ef\u3002\u5f53\u7136\uff0c\u6b64\u65f6\u7684\u5b8f\u5217\u8868\u4e5f\u662f\u7a7a\u7a7a\u5982\u4e5f\u3002 \u53cc\u51fb hello_world.xlam \u6253\u5f00\u63d2\u4ef6\uff0c\u6b64\u65f6\u5e76\u65e0\u989d\u5916\u7684\u7a97\u53e3\u51fa\u73b0\uff0c\u4f46\u662f\u4e4b\u524d\u7684\u5b8f\u4ee3\u7801\u5df2\u7136\u88ab\u9ed8\u9ed8\u52a0\u8f7d\u4e86\u3002\u91cd\u65b0\u6309\u524d\u8ff0\u64cd\u4f5c\u6765\u5230 Excel \u9009\u9879 \u5bf9\u8bdd\u6846\u7684 \u81ea\u5b9a\u4e49\u529f\u80fd\u533a \uff0c\u6b64\u65f6\u4e0a\u8ff0\u5b8f\u5217\u8868\u533a\u57df\u51fa\u73b0\u4e86\u81ea\u5b9a\u4e49\u7684 user_fun \uff0c\u5c06\u5176\u62d6\u653e\u5230\u6211\u4eec\u521b\u5efa\u7684 \u81ea\u5b9a\u4e49\u7ec4 \u4e0b\uff0c\u5e76\u4e14\u53ef\u4ee5\u91cd\u547d\u540d\u548c\u9009\u62e9\u56fe\u6807\uff0c\u4fdd\u5b58\u540e\u5f97\u5230\u5982\u4e0b\u5b8c\u6210\u6548\u679c\u3002 \u6b64\u65f6\u5373\u4fbf\u91cd\u65b0\u6253\u5f00\u5176\u4ed6Excel\u6587\u4ef6\uff0c\u81ea\u5b9a\u4e49\u83dc\u5355\u680f\u59cb\u7ec8\u5b58\u5728\uff0c\u83dc\u5355\u9879\u7684\u529f\u80fd\u4f9d\u7136\u751f\u6548\u3002\u4ece\u4e0a\u8ff0\u8fc7\u7a0b\u53ef\u77e5\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u63d2\u4ef6 hello_world.xlam \u5f15\u7528\u4f4d\u7f6e\u4fdd\u6301\u4e0d\u53d8\uff0c\u4e00\u65e6\u5b83\u88ab\u79fb\u52a8\u6216\u8005\u91cd\u547d\u540d\uff0c\u76f8\u5e94\u7684\u529f\u80fd\u4e5f\u5c31\u67e5\u65e0\u6b64\u4eba\u4e86\u3002\u6240\u4ee5\uff0c\u4e00\u822c\u63a8\u8350\u5c06\u5176\u4fdd\u5b58\u5230Excel\u9ed8\u8ba4\u7684\u63d2\u4ef6\u76ee\u5f55\u3002 \u81f3\u6b64\uff0c\u53ef\u4ee5\u6109\u5feb\u5730\u5728\u81ea\u5df1\u7535\u8111\u7684\u4efb\u610fExcel\u6587\u4ef6\u4e0a say hello world \u4e86\u3002\u7136\u800c\uff0c\u5982\u679c\u8d75\u3001\u94b1\u3001\u5b59\u3001\u674e\u4e5f\u90fd\u60f3 say hello world \uff0c\u96be\u9053\u6bcf\u4eba\u90fd\u9700\u8981\u5982\u6b64\u91cd\u590d\u4e00\u904d\uff1f \u663e\u7136\uff0c\u4e0a\u8ff0\u65b9\u6848\u7684\u53ef\u79fb\u690d\u6027\u4f9d\u7136\u4e0d\u5f3a\uff0c\u6211\u4eec\u5e0c\u671b\u8d75\u3001\u94b1\u3001\u5b59\u3001\u674e\u6536\u5230 hello_world.xlam \u6587\u4ef6\u540e\uff0c\u53ef\u4ee5\u81ea\u52a8\u5b8c\u6210\u4e0a\u8ff0\u8fc7\u7a0b\u3002\u4e8e\u662f\uff0c\u8fd9\u5c31\u9700\u8981\uff1a \u5728Excel\u63d2\u4ef6\u4e2d\u81ea\u52a8\u521b\u5efaRibbon\u83dc\u5355","title":"\u624b\u5de5\u521b\u5efaRibbon\u83dc\u5355"},{"location":"2017-07-24-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E4%BF%AE%E6%94%B9XML/","text":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-07-24 | \u5206\u7c7b\uff1a process automation \u624b\u5de5\u521b\u5efa\u81ea\u5b9a\u4e49Excel\u9009\u9879\u5361 \u7684\u65b9\u6cd5\u5728\u53ef\u79fb\u690d\u6027\u65b9\u9762\u5b58\u5728\u4e0d\u8db3\uff0c\u672c\u6587\u5c06\u4ee5\u524d\u6587\u7684 hello_world.xlam \u4e3a\u57fa\u7840\uff0c\u8bb0\u5f55\u5c06\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684\u83dc\u5355\u9879\u96c6\u6210\u5230\u63d2\u4ef6\u4e2d\u53bb\u7684\u57fa\u672c\u6b65\u9aa4\u3002 \u521b\u5efa\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684 xml \u6587\u4ef6 \u00b6 \u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684\u9009\u9879\u5361\u3001\u5206\u7ec4\u3001\u83dc\u5355\u9879\u53ef\u4ee5\u4f7f\u7528 xml \u683c\u5f0f\u6587\u4ef6\u7684 tab \uff0c group \uff0c button \u7b49\u6807\u7b7e\u6765\u7ec4\u7ec7\uff0c\u5176\u4e2d\u5e38\u7528\u7684\u5c5e\u6027\u6709\uff1a label \u5c5e\u6027\u4e3a\u663e\u793a\u7684\u540d\u79f0 onAction \u5c5e\u6027\u4e3a\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\uff0c\u4f8b\u5982 btn1 \u5bf9\u5e94\u7684\u51fd\u6570\u4e3a user_fun imageMso \u5c5e\u6027\u63a7\u5236\u83dc\u5355\u9879\u7684\u663e\u793a\u56fe\u6807 1 \u4ee5\u4e0b\u662f\u672c\u6587\u7b80\u5355\u793a\u4f8b\u7684 xml \u7ed3\u6784\uff1a <customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"> <ribbon startFromScratch=\"false\"> <tabs> <tab id=\"userRibbon\" label=\"\u81ea\u5b9a\u4e49Ribbon\u9009\u9879\u5361\"> <group id=\"g1\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e00\"> <button id=\"btn1\" imageMso=\"Alerts\" size=\"large\" label=\"say hello world\" onAction=\"user_fun\"/> </group> <group id=\"g2\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e8c\"> <button id=\"btn2\" imageMso=\"Help\" size=\"large\" label=\"About\" onAction=\"about_fun\"/> </group> </tab> </tabs> </ribbon> </customUI> \u5173\u4e8e\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684 xml \u6587\u4ef6\u7684\u5177\u4f53\u8bf4\u660e\uff0c\u53ef\u4ee5\u53c2\u8003\u5fae\u8f6f\u63d0\u4f9b\u7684\u6587\u6863 2 3 4 5 \u3002 \u5927\u81f4\u4e86\u89e3\u4ee5\u4e0a\u80cc\u666f\u77e5\u8bc6\u540e\uff0c\u6b63\u5f0f\u5f00\u59cb\u64cd\u4f5c\u6b65\u9aa4\uff1a \u65b0\u5efa customUI \u6587\u4ef6\u5939\uff0c\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u65b0\u5efa CustomUI.xml \u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u4ee5\u4e0a\u793a\u4f8b xml \u4ee3\u7801\u3002\u6ce8\u610f\u4fdd\u5b58\u4ee5 UTF-8 \u7f16\u7801\u4fdd\u5b58\u6587\u4ef6\u3002 \u4ee5\u89e3\u538b\u7f29\u8f6f\u4ef6\u4f8b\u5982 7-zip \u76f4\u63a5\u6253\u5f00 hello_world.xlam \uff0c\u7136\u540e\u5c06\u6574\u4e2a customUI \u6587\u4ef6\u5939\u62d6\u5165\u5230\u538b\u7f29\u6587\u4ef6\u4e2d\u5e76\u4fdd\u5b58\u3002 \u4fee\u6539 .res \u6587\u4ef6 \u00b6 \u63a5\u4e0b\u6765\u7ee7\u7eed\u5728\u4ee5\u538b\u7f29\u5305\u5f62\u5f0f\u6253\u5f00\u7684 hello_world.xlam \u6587\u4ef6\u4e0a\u8fdb\u884c\u64cd\u4f5c\uff1a \u53f3\u952e\u538b\u7f29\u5305\u4e2d _res \u6587\u4ef6\u5939\u4e0b\u7684 .res \u6587\u4ef6\uff0c\u5728\u5f39\u51fa\u83dc\u5355\u4e2d\u9009\u62e9 \u7f16\u8f91 \uff0c\u4ee5\u8bb0\u4e8b\u672c\u65b9\u5f0f\u6253\u5f00 .res \u6587\u4ef6\u3002 \u5728 .rels \u6587\u4ef6\u6700\u540e\u4e00\u4e2a </Relationships> \u6807\u7b7e\u4e4b\u524d\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff0c\u4fdd\u5b58\u5e76\u5728\u63d0\u793a\u66f4\u65b0\u538b\u7f29\u6587\u4ef6\u65f6\u9009\u62e9\u786e\u5b9a\u3002 <Relationship Id=\"customUIRelID\" Type=\"http://schemas.microsoft.com/office/2006/relationships/ui/extensibility\" Target=\"customUI/customUI.xml\"/> \u5b8c\u6210\u4ee5\u4e0a\u6b65\u9aa4\u540e\u6253\u5f00 hello_world.xlam \u5f97\u5230\u5982\u4e0b\u6548\u679c\uff1a \u7f16\u8f91 VBA \u4ee3\u7801 \u00b6 xml \u4e2d\u4e3a say hello world \u6307\u5b9a\u7684\u56de\u8c03\u51fd\u6570\u662f user_fun \uff0c\u6240\u4ee5\u6700\u540e\u5b8c\u6210\u8be5\u5b50\u8fc7\u7a0b\u5373\u53ef\u3002\u65b0\u5efa\u6a21\u5757\uff08module\uff09\u91cd\u547d\u540d\u4e3a user_function \uff0c\u5728\u5176\u4e2d\u5199\u5165\u4ee5\u4e0b\u4ee3\u7801\uff1a Sub user_fun(Control As IRibbonControl) MsgBox \"Hello world.\" End Sub \u7279\u522b\u6ce8\u610f\uff0c\u8be5\u8fc7\u7a0b\u9700\u8981\u5e26\u53c2\u6570 control As IRibbon \u3002 \u6700\u540e\uff0c\u672c\u6587\u793a\u4f8b\u6587\u4ef6 hello_world_addin.xlam \u4f9b\u53c2\u8003\u3002 Office 2010 Add-In: Icons Gallery \u21a9 A Guide to Customizing the Office 2007 Ribbon \u21a9 Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3) \u21a9 Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3) \u21a9 Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3) \u21a9","title":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML"},{"location":"2017-07-24-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E4%BF%AE%E6%94%B9XML/#microsoft excel 2010xml","text":"\u53d1\u5e03\u4e8e\uff1a2017-07-24 | \u5206\u7c7b\uff1a process automation \u624b\u5de5\u521b\u5efa\u81ea\u5b9a\u4e49Excel\u9009\u9879\u5361 \u7684\u65b9\u6cd5\u5728\u53ef\u79fb\u690d\u6027\u65b9\u9762\u5b58\u5728\u4e0d\u8db3\uff0c\u672c\u6587\u5c06\u4ee5\u524d\u6587\u7684 hello_world.xlam \u4e3a\u57fa\u7840\uff0c\u8bb0\u5f55\u5c06\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684\u83dc\u5355\u9879\u96c6\u6210\u5230\u63d2\u4ef6\u4e2d\u53bb\u7684\u57fa\u672c\u6b65\u9aa4\u3002","title":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML"},{"location":"2017-07-24-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E4%BF%AE%E6%94%B9XML/#xml","text":"\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684\u9009\u9879\u5361\u3001\u5206\u7ec4\u3001\u83dc\u5355\u9879\u53ef\u4ee5\u4f7f\u7528 xml \u683c\u5f0f\u6587\u4ef6\u7684 tab \uff0c group \uff0c button \u7b49\u6807\u7b7e\u6765\u7ec4\u7ec7\uff0c\u5176\u4e2d\u5e38\u7528\u7684\u5c5e\u6027\u6709\uff1a label \u5c5e\u6027\u4e3a\u663e\u793a\u7684\u540d\u79f0 onAction \u5c5e\u6027\u4e3a\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\uff0c\u4f8b\u5982 btn1 \u5bf9\u5e94\u7684\u51fd\u6570\u4e3a user_fun imageMso \u5c5e\u6027\u63a7\u5236\u83dc\u5355\u9879\u7684\u663e\u793a\u56fe\u6807 1 \u4ee5\u4e0b\u662f\u672c\u6587\u7b80\u5355\u793a\u4f8b\u7684 xml \u7ed3\u6784\uff1a <customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"> <ribbon startFromScratch=\"false\"> <tabs> <tab id=\"userRibbon\" label=\"\u81ea\u5b9a\u4e49Ribbon\u9009\u9879\u5361\"> <group id=\"g1\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e00\"> <button id=\"btn1\" imageMso=\"Alerts\" size=\"large\" label=\"say hello world\" onAction=\"user_fun\"/> </group> <group id=\"g2\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e8c\"> <button id=\"btn2\" imageMso=\"Help\" size=\"large\" label=\"About\" onAction=\"about_fun\"/> </group> </tab> </tabs> </ribbon> </customUI> \u5173\u4e8e\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684 xml \u6587\u4ef6\u7684\u5177\u4f53\u8bf4\u660e\uff0c\u53ef\u4ee5\u53c2\u8003\u5fae\u8f6f\u63d0\u4f9b\u7684\u6587\u6863 2 3 4 5 \u3002 \u5927\u81f4\u4e86\u89e3\u4ee5\u4e0a\u80cc\u666f\u77e5\u8bc6\u540e\uff0c\u6b63\u5f0f\u5f00\u59cb\u64cd\u4f5c\u6b65\u9aa4\uff1a \u65b0\u5efa customUI \u6587\u4ef6\u5939\uff0c\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u65b0\u5efa CustomUI.xml \u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u4ee5\u4e0a\u793a\u4f8b xml \u4ee3\u7801\u3002\u6ce8\u610f\u4fdd\u5b58\u4ee5 UTF-8 \u7f16\u7801\u4fdd\u5b58\u6587\u4ef6\u3002 \u4ee5\u89e3\u538b\u7f29\u8f6f\u4ef6\u4f8b\u5982 7-zip \u76f4\u63a5\u6253\u5f00 hello_world.xlam \uff0c\u7136\u540e\u5c06\u6574\u4e2a customUI \u6587\u4ef6\u5939\u62d6\u5165\u5230\u538b\u7f29\u6587\u4ef6\u4e2d\u5e76\u4fdd\u5b58\u3002","title":"\u521b\u5efa\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\u7684xml\u6587\u4ef6"},{"location":"2017-07-24-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E4%BF%AE%E6%94%B9XML/#res","text":"\u63a5\u4e0b\u6765\u7ee7\u7eed\u5728\u4ee5\u538b\u7f29\u5305\u5f62\u5f0f\u6253\u5f00\u7684 hello_world.xlam \u6587\u4ef6\u4e0a\u8fdb\u884c\u64cd\u4f5c\uff1a \u53f3\u952e\u538b\u7f29\u5305\u4e2d _res \u6587\u4ef6\u5939\u4e0b\u7684 .res \u6587\u4ef6\uff0c\u5728\u5f39\u51fa\u83dc\u5355\u4e2d\u9009\u62e9 \u7f16\u8f91 \uff0c\u4ee5\u8bb0\u4e8b\u672c\u65b9\u5f0f\u6253\u5f00 .res \u6587\u4ef6\u3002 \u5728 .rels \u6587\u4ef6\u6700\u540e\u4e00\u4e2a </Relationships> \u6807\u7b7e\u4e4b\u524d\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff0c\u4fdd\u5b58\u5e76\u5728\u63d0\u793a\u66f4\u65b0\u538b\u7f29\u6587\u4ef6\u65f6\u9009\u62e9\u786e\u5b9a\u3002 <Relationship Id=\"customUIRelID\" Type=\"http://schemas.microsoft.com/office/2006/relationships/ui/extensibility\" Target=\"customUI/customUI.xml\"/> \u5b8c\u6210\u4ee5\u4e0a\u6b65\u9aa4\u540e\u6253\u5f00 hello_world.xlam \u5f97\u5230\u5982\u4e0b\u6548\u679c\uff1a","title":"\u4fee\u6539.res\u6587\u4ef6"},{"location":"2017-07-24-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E4%BF%AE%E6%94%B9XML/#vba","text":"xml \u4e2d\u4e3a say hello world \u6307\u5b9a\u7684\u56de\u8c03\u51fd\u6570\u662f user_fun \uff0c\u6240\u4ee5\u6700\u540e\u5b8c\u6210\u8be5\u5b50\u8fc7\u7a0b\u5373\u53ef\u3002\u65b0\u5efa\u6a21\u5757\uff08module\uff09\u91cd\u547d\u540d\u4e3a user_function \uff0c\u5728\u5176\u4e2d\u5199\u5165\u4ee5\u4e0b\u4ee3\u7801\uff1a Sub user_fun(Control As IRibbonControl) MsgBox \"Hello world.\" End Sub \u7279\u522b\u6ce8\u610f\uff0c\u8be5\u8fc7\u7a0b\u9700\u8981\u5e26\u53c2\u6570 control As IRibbon \u3002 \u6700\u540e\uff0c\u672c\u6587\u793a\u4f8b\u6587\u4ef6 hello_world_addin.xlam \u4f9b\u53c2\u8003\u3002 Office 2010 Add-In: Icons Gallery \u21a9 A Guide to Customizing the Office 2007 Ribbon \u21a9 Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3) \u21a9 Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3) \u21a9 Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3) \u21a9","title":"\u7f16\u8f91VBA\u4ee3\u7801"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/","text":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-07-31 | \u5206\u7c7b\uff1a process automation \u4e4b\u524d\u7684\u6587\u7ae0 \u6f14\u793a\u4e86\u5728Excel\u63d2\u4ef6\u4e2d\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u57fa\u672c\u6b65\u9aa4\uff0c\u672c\u6587\u5c06\u4ee5\u524d\u6587\u7684 hello_world_addin.xlam \u4e3a\u57fa\u7840\uff0c\u8bb0\u5f55\u8fdb\u4e00\u6b65\u63a7\u5236\u5355\u4e2a\u83dc\u5355\u9879\u53ef\u7528/\u7981\u7528\u72b6\u6001\u7684\u65b9\u6cd5\u3002 \u5047\u8bbe\u76ee\u6807\u9700\u6c42\u662f\uff1a\u53ea\u6709\u5f53\u524dWorkSheet\u7684\u540d\u5b57\u662f hello \u65f6\uff0c\u624d\u5141\u8bb8\u70b9\u51fb say hello world \u3002\u6362\u8a00\u4e4b\uff0c\u81ea\u5b9a\u4e49\u83dc\u5355\u9879 say hello world \u4e00\u76f4\u5904\u4e8e\u7981\u7528\u72b6\u6001\uff0c\u9664\u975e\u5f53\u524d\u5de5\u4f5c\u8868\u540d\u79f0\u4e3a hello \u3002 \u8fd9\u5b9e\u9645\u4e0a\u6d89\u53ca\u4e24\u4e2a\u65b9\u9762\u7684\u95ee\u9898\uff1a\u83dc\u5355\u9879\u72b6\u6001\u7684\u63a7\u5236\u548c\u5de5\u4f5c\u8868\u4e8b\u4ef6\u7684\u76d1\u542c\u3002 \u83dc\u5355\u9879\u72b6\u6001\u63a7\u5236 \u00b6 \u63a7\u5236Ribbon\u533a\u57df\u7684 xml \u4ee3\u7801\u63d0\u4f9b\u4e86\u83dc\u5355\u9879\u663e\u793a\u72b6\u6001( getVisible )\u3001\u53ef\u7528\u72b6\u6001( getEnabled )\u7684\u5c5e\u6027\uff0c\u5e76\u4e3a\u5176\u6307\u5b9a\u54cd\u5e94\u51fd\u6570\u3002\u5176\u57fa\u672c\u683c\u5f0f\u4e3a\uff1a Sub user_enabled(control As IRibbonControl, ByRef Enabled) ' @param control\u4e3a\u5f53\u524d\u83dc\u5355\u9879 ' \u53ef\u4ee5\u5728xml\u4e2d\u81ea\u5b9a\u4e49key1 = \"val1\"\uff0c\u7136\u540e\u6b64\u5904control.key1\u8c03\u7528 ' @param Enabled\u4e3a\u8fd4\u56de\u7684\u53ef\u7528\u72b6\u6001 ' to do End Sub \u5f53\u7136\u6211\u4eec\u8fd8\u9700\u8981\u4e3a customUI \u6307\u5b9a\u521d\u59cb\u5316\u7684\u5c5e\u6027 onLoad \u3002\u4ee5\u4e0b\u662f xml \u7684\u793a\u4f8b\u4ee3\u7801\uff1a <customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" onLoad=\"OnRibbonLoad\"> <ribbon startFromScratch=\"false\"> <tabs> <tab id=\"userRibbon\" label=\"\u81ea\u5b9a\u4e49Ribbon\u9009\u9879\u5361\"> <group id=\"g1\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e00\"> <button id=\"btn1\" imageMso=\"Alerts\" size=\"large\" label=\"say hello world\" onAction=\"user_fun\" getEnabled=\"user_enabled\"/> </group> <group id=\"g2\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e8c\"> <button id=\"btn2\" imageMso=\"Help\" size=\"large\" label=\"About\" onAction=\"about_fun\"/> </group> </tab> </tabs> </ribbon> </customUI> \u63a5\u4e0b\u6765\u65b0\u5efa ribbon_control \u6a21\u5757\uff0c\u5199\u5165\u5982\u4e0b\u7684\u54cd\u5e94\u4e8b\u4ef6\u7684\u4ee3\u7801\uff1a ''' ' ribbon control ''' Public MyRibbonUI As IRibbonUI ' on load Private Sub OnRibbonLoad(ribbonUI As IRibbonUI) Set MyRibbonUI = ribbonUI End Sub ' enable status Sub user_enabled(control As IRibbonControl, ByRef Enabled) If ActiveSheet.Name = \"hello\" Then Enabled = True Else Enable = False End If MyRibbonUI.Invalidate ' submit status End Sub \u6ce8\u610f\uff0c\u5176\u4e2d MyRibbonUI.Invalidate \u5f3a\u5236\u8fdb\u884cRibbon UI\u72b6\u6001\u7684\u66f4\u65b0\u3002 \u4e8b\u4ef6\u76d1\u542c \u00b6 \u6b64\u65f6\u4efb\u610f\u6253\u5f00\u4e00\u4e2a\u5de5\u4f5c\u7c3f\uff0c\u7136\u540e\u53cc\u51fb\u52a0\u8f7d\u63d2\u4ef6 hello_world.xlam \uff0c\u6548\u679c\u5982\u4e0b\uff1a \u5982\u679c\u52a0\u8f7d\u63d2\u4ef6\u65f6\uff0c\u5f53\u524d\u5de5\u4f5c\u8868\u6070\u597d\u662f hello \uff0c\u5219 say hello world \u83dc\u5355\u9879\u59cb\u7ec8\u5904\u4e8e\u53ef\u7528\u72b6\u6001\uff1b\u5426\u5219\u5c06\u5904\u4e8e\u7981\u7528\u72b6\u6001\u3002\u5e76\u4e14\u65e0\u8bba\u5982\u4f55\u5207\u6362\u5de5\u4f5c\u8868\uff0c say hello world \u4e00\u76f4\u4fdd\u6301\u521d\u59cb\u72b6\u6001\u4e0d\u53d8\u3002\u8fd9\u662f\u56e0\u4e3a\u5f53\u524d\u4ee3\u7801\u53ea\u5728\u521d\u59cb\u5316Ribbon\u533a\u57df\u65f6\u6839\u636e\u5f53\u524d\u5de5\u4f5c\u8868\u540d\u79f0\u66f4\u65b0\u4e86\u4e00\u6b21\u72b6\u6001\u3002 \u56e0\u6b64\uff0c\u63a5\u4e0b\u6765\u9700\u8981\u5728\u89e6\u53d1 \u6fc0\u6d3b\u5de5\u4f5c\u8868 \u4e8b\u4ef6\u65f6\u5f3a\u5236\u5237\u65b0Ribbon\u72b6\u6001\u3002\u597d\u5728 VBA \u5df2\u7ecf\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u8be5\u4e8b\u4ef6\uff1a \u5c1d\u8bd5\u4e00\uff1aworkbook\u4e8b\u4ef6 \u00b6 \u5728 hello_world.xlam \u7684 ThisWorkBook \u6a21\u5757\u4e0b\u63d2\u5165\u5de5\u4f5c\u8868\u6fc0\u6d3b\u4e8b\u4ef6 Workbook_SheetActivate \uff1a \u586b\u5165\u5237\u65b0Ribbon\u533a\u57df\u7684\u4ee3\u7801\uff1a Private Sub Workbook_SheetActivate(ByVal Sh As Object) MyRibbonUI.Invalidate ' update status End Sub \u4e0d\u51fa\u610f\u5916\u7684\u8bdd\uff0c\u6211\u4eec\u662f\u770b\u4e0d\u5230\u9884\u671f\u6548\u679c\u7684\u3002 \u56e0\u4e3a\u4ee5\u4e0a\u5199\u7684\u662f hello_world.xlam \u5de5\u4f5c\u7c3f\u8303\u56f4\u5185\u7684\u5207\u6362\u5de5\u4f5c\u8868\u4e8b\u4ef6\uff0c\u800c\u6211\u4eec\u5b9e\u9645\u5207\u6362\u7684\u5374\u662f\u5176\u4ed6Excel\u6570\u636e\u6587\u4ef6\u7684\u5de5\u4f5c\u8868\uff0c\u81ea\u7136\u5c31\u65e0\u6cd5\u6b63\u786e\u54cd\u5e94\u4e86\u3002 \u5c1d\u8bd5\u4e8c\uff1aApplication\u4e8b\u4ef6 \u00b6 \u6211\u4eec\u7684\u4ee3\u7801\u5199\u5728\u63d2\u4ef6 hello_world.xlam \u4e2d\uff0c\u9700\u8981\u76d1\u542c\u7684\u5374\u662f\u8de8\u5de5\u4f5c\u7c3f\u7684\u4e8b\u4ef6\uff0c\u8fd9\u5c31\u9700\u8981 Application \u7ea7\u522b\u7684\u4e8b\u4ef6\u76d1\u542c\uff0c\u4ee5\u54cd\u5e94\u6240\u6709\u6253\u5f00\u7684\u5de5\u4f5c\u7c3f\u4e8b\u4ef6\u3002 \u9996\u5148\u5c06 hello_world.xlam \u7684 ThisWorkBook \u6a21\u5757\u66f4\u6539\u4e3a\u4ee5\u4e0b\u4ee3\u7801\uff1a ' ThisWorkBook in hello_world.xlam Private WithEvents App As Application ' \u5b9a\u4e49Application\u7c7b\u578b\u7684\u4e8b\u4ef6\u76d1\u542cApp Private Sub Workbook_Open() Set App = Application ' \u5728\u6253\u5f00\u5de5\u4f5c\u7c3f\u540e\u8fdb\u884c\u521d\u59cb\u5316 End Sub \u6b64\u65f6\uff0c\u5373\u53ef\u5728\u4ee3\u7801\u7a97\u53e3\u9876\u90e8\u7684\u5de6\u4fa7\u4e0b\u62c9\u83dc\u5355\u4e2d\uff0c\u9009\u62e9\u521a\u521a\u521b\u5efa\u7684 App \u5bf9\u8c61\uff0c\u7136\u540e\u5728\u53f3\u4fa7\u4e0b\u62c9\u83dc\u5355\u9009\u62e9\u5bf9\u5e94\u7684 SheetActivate \u4e8b\u4ef6\uff1a \u6700\u540e\u586b\u5165\u5f3a\u5236\u5237\u65b0Ribbon\u533a\u57df\u7684\u4ee3\u7801\uff1a Private Sub App_SheetActivate(ByVal Sh As Object) MyRibbonUI.Invalidate ' submit status End Sub \u4fdd\u5b58\u540e\u91cd\u65b0\u6253\u5f00\u5373\u53ef\u5b9e\u73b0\u9884\u671f\u6548\u679c\uff0c\u53c2\u8003\u793a\u4f8b\u6587\u4ef6 hello_world_addin_enable_status.xlam \u3002 \u6269\u5c55\u9605\u8bfb \u00b6 How to enable/disable buttons on the Excel ribbon via VBA Application Events Events And Event Procedures In VBA","title":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/#microsoft excel 2010enable","text":"\u53d1\u5e03\u4e8e\uff1a2017-07-31 | \u5206\u7c7b\uff1a process automation \u4e4b\u524d\u7684\u6587\u7ae0 \u6f14\u793a\u4e86\u5728Excel\u63d2\u4ef6\u4e2d\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u57fa\u672c\u6b65\u9aa4\uff0c\u672c\u6587\u5c06\u4ee5\u524d\u6587\u7684 hello_world_addin.xlam \u4e3a\u57fa\u7840\uff0c\u8bb0\u5f55\u8fdb\u4e00\u6b65\u63a7\u5236\u5355\u4e2a\u83dc\u5355\u9879\u53ef\u7528/\u7981\u7528\u72b6\u6001\u7684\u65b9\u6cd5\u3002 \u5047\u8bbe\u76ee\u6807\u9700\u6c42\u662f\uff1a\u53ea\u6709\u5f53\u524dWorkSheet\u7684\u540d\u5b57\u662f hello \u65f6\uff0c\u624d\u5141\u8bb8\u70b9\u51fb say hello world \u3002\u6362\u8a00\u4e4b\uff0c\u81ea\u5b9a\u4e49\u83dc\u5355\u9879 say hello world \u4e00\u76f4\u5904\u4e8e\u7981\u7528\u72b6\u6001\uff0c\u9664\u975e\u5f53\u524d\u5de5\u4f5c\u8868\u540d\u79f0\u4e3a hello \u3002 \u8fd9\u5b9e\u9645\u4e0a\u6d89\u53ca\u4e24\u4e2a\u65b9\u9762\u7684\u95ee\u9898\uff1a\u83dc\u5355\u9879\u72b6\u6001\u7684\u63a7\u5236\u548c\u5de5\u4f5c\u8868\u4e8b\u4ef6\u7684\u76d1\u542c\u3002","title":"Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/#_1","text":"\u63a7\u5236Ribbon\u533a\u57df\u7684 xml \u4ee3\u7801\u63d0\u4f9b\u4e86\u83dc\u5355\u9879\u663e\u793a\u72b6\u6001( getVisible )\u3001\u53ef\u7528\u72b6\u6001( getEnabled )\u7684\u5c5e\u6027\uff0c\u5e76\u4e3a\u5176\u6307\u5b9a\u54cd\u5e94\u51fd\u6570\u3002\u5176\u57fa\u672c\u683c\u5f0f\u4e3a\uff1a Sub user_enabled(control As IRibbonControl, ByRef Enabled) ' @param control\u4e3a\u5f53\u524d\u83dc\u5355\u9879 ' \u53ef\u4ee5\u5728xml\u4e2d\u81ea\u5b9a\u4e49key1 = \"val1\"\uff0c\u7136\u540e\u6b64\u5904control.key1\u8c03\u7528 ' @param Enabled\u4e3a\u8fd4\u56de\u7684\u53ef\u7528\u72b6\u6001 ' to do End Sub \u5f53\u7136\u6211\u4eec\u8fd8\u9700\u8981\u4e3a customUI \u6307\u5b9a\u521d\u59cb\u5316\u7684\u5c5e\u6027 onLoad \u3002\u4ee5\u4e0b\u662f xml \u7684\u793a\u4f8b\u4ee3\u7801\uff1a <customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" onLoad=\"OnRibbonLoad\"> <ribbon startFromScratch=\"false\"> <tabs> <tab id=\"userRibbon\" label=\"\u81ea\u5b9a\u4e49Ribbon\u9009\u9879\u5361\"> <group id=\"g1\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e00\"> <button id=\"btn1\" imageMso=\"Alerts\" size=\"large\" label=\"say hello world\" onAction=\"user_fun\" getEnabled=\"user_enabled\"/> </group> <group id=\"g2\" label=\"\u81ea\u5b9a\u4e49\u7ec4\u4e8c\"> <button id=\"btn2\" imageMso=\"Help\" size=\"large\" label=\"About\" onAction=\"about_fun\"/> </group> </tab> </tabs> </ribbon> </customUI> \u63a5\u4e0b\u6765\u65b0\u5efa ribbon_control \u6a21\u5757\uff0c\u5199\u5165\u5982\u4e0b\u7684\u54cd\u5e94\u4e8b\u4ef6\u7684\u4ee3\u7801\uff1a ''' ' ribbon control ''' Public MyRibbonUI As IRibbonUI ' on load Private Sub OnRibbonLoad(ribbonUI As IRibbonUI) Set MyRibbonUI = ribbonUI End Sub ' enable status Sub user_enabled(control As IRibbonControl, ByRef Enabled) If ActiveSheet.Name = \"hello\" Then Enabled = True Else Enable = False End If MyRibbonUI.Invalidate ' submit status End Sub \u6ce8\u610f\uff0c\u5176\u4e2d MyRibbonUI.Invalidate \u5f3a\u5236\u8fdb\u884cRibbon UI\u72b6\u6001\u7684\u66f4\u65b0\u3002","title":"\u83dc\u5355\u9879\u72b6\u6001\u63a7\u5236"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/#_2","text":"\u6b64\u65f6\u4efb\u610f\u6253\u5f00\u4e00\u4e2a\u5de5\u4f5c\u7c3f\uff0c\u7136\u540e\u53cc\u51fb\u52a0\u8f7d\u63d2\u4ef6 hello_world.xlam \uff0c\u6548\u679c\u5982\u4e0b\uff1a \u5982\u679c\u52a0\u8f7d\u63d2\u4ef6\u65f6\uff0c\u5f53\u524d\u5de5\u4f5c\u8868\u6070\u597d\u662f hello \uff0c\u5219 say hello world \u83dc\u5355\u9879\u59cb\u7ec8\u5904\u4e8e\u53ef\u7528\u72b6\u6001\uff1b\u5426\u5219\u5c06\u5904\u4e8e\u7981\u7528\u72b6\u6001\u3002\u5e76\u4e14\u65e0\u8bba\u5982\u4f55\u5207\u6362\u5de5\u4f5c\u8868\uff0c say hello world \u4e00\u76f4\u4fdd\u6301\u521d\u59cb\u72b6\u6001\u4e0d\u53d8\u3002\u8fd9\u662f\u56e0\u4e3a\u5f53\u524d\u4ee3\u7801\u53ea\u5728\u521d\u59cb\u5316Ribbon\u533a\u57df\u65f6\u6839\u636e\u5f53\u524d\u5de5\u4f5c\u8868\u540d\u79f0\u66f4\u65b0\u4e86\u4e00\u6b21\u72b6\u6001\u3002 \u56e0\u6b64\uff0c\u63a5\u4e0b\u6765\u9700\u8981\u5728\u89e6\u53d1 \u6fc0\u6d3b\u5de5\u4f5c\u8868 \u4e8b\u4ef6\u65f6\u5f3a\u5236\u5237\u65b0Ribbon\u72b6\u6001\u3002\u597d\u5728 VBA \u5df2\u7ecf\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u8be5\u4e8b\u4ef6\uff1a","title":"\u4e8b\u4ef6\u76d1\u542c"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/#workbook","text":"\u5728 hello_world.xlam \u7684 ThisWorkBook \u6a21\u5757\u4e0b\u63d2\u5165\u5de5\u4f5c\u8868\u6fc0\u6d3b\u4e8b\u4ef6 Workbook_SheetActivate \uff1a \u586b\u5165\u5237\u65b0Ribbon\u533a\u57df\u7684\u4ee3\u7801\uff1a Private Sub Workbook_SheetActivate(ByVal Sh As Object) MyRibbonUI.Invalidate ' update status End Sub \u4e0d\u51fa\u610f\u5916\u7684\u8bdd\uff0c\u6211\u4eec\u662f\u770b\u4e0d\u5230\u9884\u671f\u6548\u679c\u7684\u3002 \u56e0\u4e3a\u4ee5\u4e0a\u5199\u7684\u662f hello_world.xlam \u5de5\u4f5c\u7c3f\u8303\u56f4\u5185\u7684\u5207\u6362\u5de5\u4f5c\u8868\u4e8b\u4ef6\uff0c\u800c\u6211\u4eec\u5b9e\u9645\u5207\u6362\u7684\u5374\u662f\u5176\u4ed6Excel\u6570\u636e\u6587\u4ef6\u7684\u5de5\u4f5c\u8868\uff0c\u81ea\u7136\u5c31\u65e0\u6cd5\u6b63\u786e\u54cd\u5e94\u4e86\u3002","title":"\u5c1d\u8bd5\u4e00\uff1aworkbook\u4e8b\u4ef6"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/#application","text":"\u6211\u4eec\u7684\u4ee3\u7801\u5199\u5728\u63d2\u4ef6 hello_world.xlam \u4e2d\uff0c\u9700\u8981\u76d1\u542c\u7684\u5374\u662f\u8de8\u5de5\u4f5c\u7c3f\u7684\u4e8b\u4ef6\uff0c\u8fd9\u5c31\u9700\u8981 Application \u7ea7\u522b\u7684\u4e8b\u4ef6\u76d1\u542c\uff0c\u4ee5\u54cd\u5e94\u6240\u6709\u6253\u5f00\u7684\u5de5\u4f5c\u7c3f\u4e8b\u4ef6\u3002 \u9996\u5148\u5c06 hello_world.xlam \u7684 ThisWorkBook \u6a21\u5757\u66f4\u6539\u4e3a\u4ee5\u4e0b\u4ee3\u7801\uff1a ' ThisWorkBook in hello_world.xlam Private WithEvents App As Application ' \u5b9a\u4e49Application\u7c7b\u578b\u7684\u4e8b\u4ef6\u76d1\u542cApp Private Sub Workbook_Open() Set App = Application ' \u5728\u6253\u5f00\u5de5\u4f5c\u7c3f\u540e\u8fdb\u884c\u521d\u59cb\u5316 End Sub \u6b64\u65f6\uff0c\u5373\u53ef\u5728\u4ee3\u7801\u7a97\u53e3\u9876\u90e8\u7684\u5de6\u4fa7\u4e0b\u62c9\u83dc\u5355\u4e2d\uff0c\u9009\u62e9\u521a\u521a\u521b\u5efa\u7684 App \u5bf9\u8c61\uff0c\u7136\u540e\u5728\u53f3\u4fa7\u4e0b\u62c9\u83dc\u5355\u9009\u62e9\u5bf9\u5e94\u7684 SheetActivate \u4e8b\u4ef6\uff1a \u6700\u540e\u586b\u5165\u5f3a\u5236\u5237\u65b0Ribbon\u533a\u57df\u7684\u4ee3\u7801\uff1a Private Sub App_SheetActivate(ByVal Sh As Object) MyRibbonUI.Invalidate ' submit status End Sub \u4fdd\u5b58\u540e\u91cd\u65b0\u6253\u5f00\u5373\u53ef\u5b9e\u73b0\u9884\u671f\u6548\u679c\uff0c\u53c2\u8003\u793a\u4f8b\u6587\u4ef6 hello_world_addin_enable_status.xlam \u3002","title":"\u5c1d\u8bd5\u4e8c\uff1aApplication\u4e8b\u4ef6"},{"location":"2017-07-31-Microsoft-Excel-2010%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%9F%E8%83%BD%E5%8C%BA%EF%BC%9A%E8%8F%9C%E5%8D%95%E9%A1%B9Enable%E7%8A%B6%E6%80%81/#_3","text":"How to enable/disable buttons on the Excel ribbon via VBA Application Events Events And Event Procedures In VBA","title":"\u6269\u5c55\u9605\u8bfb"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/","text":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-08-08 | \u5206\u7c7b\uff1a CAD/CAE integration NX FEM\u4e0eSimulation\u90e8\u5206\u7ecf\u5e38\u4f1a\u9047\u5230\u4e24\u4e2a\u6982\u5ff5 Groups \u4e0e Regions \uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u4e00\u4e9b\u53ef\u91cd\u7528\u7684\u5bf9\u8c61\uff0c\u4fbf\u4e8e\u7edf\u4e00\u7ba1\u7406\u3002\u90a3\u4e48\uff0c\u4e8c\u8005\u6709\u4f55\u533a\u522b\uff1f\u672c\u6587\u4ee5NX\u5e2e\u52a9\u6587\u6863\u4e3a\u57fa\u7840\uff0c\u4ecb\u7ecdGroups\u4e0eRegions\u7684\u6982\u5ff5\u53ca\u5176\u5dee\u5f02\uff0c\u4ee5\u4f5c\u5b66\u4e60\u8bb0\u5f55\u548c\u5907\u5fd8\u3002 \u5b9a\u4e49 \u00b6 Groups \u662f\u51e0\u4f55\uff08\u70b9/\u7ebf/\u9762\u7b49\uff09\u6216\u6709\u9650\u5143\u5bf9\u8c61\uff08\u7f51\u683c/\u8282\u70b9/\u5355\u5143\u7b49\uff09\u7684\u96c6\u5408\u3002\u4eba\u4e3a\u9009\u53d6\u67d0\u4e9b\u5bf9\u8c61\u5e76\u5c06\u5176\u5b9a\u4e49\u4e3a\u4e00\u4e2aGroup\uff0c\u4ee5\u4fbf\u4e8e\u901a\u8fc7\u8fd9\u4e2aGroup\u6765\u7edf\u4e00\u64cd\u4f5c\u6240\u6709\u88ab\u5305\u542b\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\u5bfc\u51fa\u3001\u65bd\u52a0\u8fb9\u754c\u6761\u4ef6\u3001\u63a7\u5236\u663e\u793a/\u9690\u85cf\u3002\u8fd9\u7c7b\u4f3c\u4e8eMSC.Marc\u4e2d\u7684 Set \uff0cHypermesh\u4e2d\u7684 Component \u7684\u6982\u5ff5\u3002 Groups are collections of FE and geometric entities. You can use groups to organize a large model into a small number of easily-managed containers. Regions \u662fSimulation\u73af\u5883\u4e0b\u4ee5\u8fb9\u754c\u6761\u4ef6\u65bd\u52a0\u4e3a\u76ee\u7684\u7684\u591a\u8fb9\u5f62\u51e0\u4f55\u6216CAE\u5bf9\u8c61\u7684\u96c6\u5408\u3002 A region is a collection of homogenous entities, such as polygon faces. You can then use a region to define the source faces or target faces in boundary condition definitions. \u5b58\u50a8\u5bf9\u8c61\u7c7b\u578b \u00b6 Groups\u548cRegions\u4e2d\u5b58\u50a8\u5bf9\u8c61\u7684\u7c7b\u578b\u5305\u62ec\uff1a Group Region Node, Element Node, Element Element edge/face Element edge/face Polygon edges/faces/bodies Polygon edges/faces meshes, Mesh points - Curves, Points - Coordinate systems - \u4f7f\u7528\u73af\u5883 \u00b6 \u6211\u4eec\u53ef\u4ee5\u5728FEM\u6216\u8005Simulation\u73af\u5883\u521b\u5efaGroups\uff0c\u5b83\u4eec\u90fd\u663e\u793a\u4e8eSimulation Navigator\u5bfc\u822a\u6811\u4e0a\u3002\u4f46\u662f\u6ce8\u610f\uff0c \u65e0\u6cd5\u5728Simulation\u73af\u5883\u4fee\u6539FEM\u73af\u5883\u521b\u5efa\u7684Groups\uff0c\u53cd\u4e4b\u540c\u7406 \u3002 \u5f53\u524d\u663e\u793a\u90e8\u4ef6\u4e3aSimulation Part\u65f6\uff0cFEM\u73af\u5883\u521b\u5efa\u7684Groups\u5c06\u9644\u52a0FEM\u6587\u4ef6\u540d\u540e\u663e\u793a\u4e8eSimulation Navigator\uff08\u4f8b\u5982\u540d\u79f0 body => body(CD1-fem_1.prt) \uff09\u3002\u56e0\u6b64\uff0cFEM Groups\u53ef\u7528\u4e8eSimulation\u73af\u5883\u8fb9\u754c\u6761\u4ef6\u7684\u5b9a\u4e49\u3002 \u5f53\u524d\u663e\u793a\u90e8\u4ef6\u4e3aFEM Part\u65f6\uff0cSimulation\u73af\u5883\u521b\u5efa\u7684Groups\u4e0d\u4f1a\u663e\u793a\u4e8eSimulation Navigator\u3002 \u5f53\u524d\u5de5\u4f5c\u90e8\u4ef6\u4e3aFEM Part\u65f6\uff0cSimulation\u73af\u5883\u521b\u5efa\u7684Groups\u5219\u4f1a\u663e\u793a\u4e8eSimulation Navigator\u3002\u56e0\u6b64\uff0cSimulation Groups\u53ef\u7528\u4e8eFEM\u73af\u5883\u4e0b\u7f51\u683c\u5212\u5206\u533a\u57df\u7684\u8bbe\u7f6e\u3002 \u5bfc\u51fa\u6c42\u89e3\u6587\u4ef6 \u00b6 \u5b58\u50a8\u5728 Groups \u4e0e Regions \u4e2d\u7684\u5143\u7d20\u90fd\u53ef\u4ee5\u5bfc\u51fa\u4e3a\u6709\u9650\u5143\u6c42\u89e3\u6587\u4ef6\uff0c\u4ee5\u4e0b\u662f\u5b83\u4eec\u7684\u4e00\u4e9b\u5f02\u540c\u70b9\uff1a \u4f7f\u7528NX\u5185\u7f6e\u7684 File -> Export -> Export Simulation \u5c06\u5f53\u524d\u6a21\u578b\u5bfc\u51fa\u4e3a\u6709\u9650\u5143\u8f93\u5165\u6587\u4ef6 *.inp \u65f6\uff0cGroups\u4e2d\u5b58\u50a8\u7684Node\u548cElement\u7c7b\u578b\u5bf9\u8c61\u9ed8\u8ba4\u5c06\u88ab\u81ea\u52a8\u5bfc\u51fa\u4e3a\u4ee5\u7ec4\u540d\u547d\u540d\u7684\u96c6\u5408\uff1b\u800cRegions\u4e2d\u7684\u5bf9\u8c61\u5219\u4e0d\u4f1a\u88ab\u5bfc\u51fa\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u5bfc\u51fa\u5bf9\u8bdd\u6846\u4e2d\u5173\u95ed\u5bfc\u51faGroup\u7684\u9009\u9879\uff0c\u5219\u4e0d\u518d\u5bfc\u51faGroup\u3002 Groups\u4e2d\u7684Node\u548cElement\u7c7b\u578b\u5bf9\u8c61\u5c06\u5206\u522b\u5bfc\u51fa\u4e3a\u8282\u70b9\u548c\u5355\u5143\uff0c\u5176\u4ed6\u51e0\u4f55\u5bf9\u8c61\u5982Polygon Face\u3001Polygon Edge\u5219\u5bfc\u51fa\u4e3a\u7a7a\uff1bRegions\u4e2d\u6240\u6709\u7c7b\u578b\u5bf9\u8c61\uff0c\u5373\u4fbf\u662fElements\uff0c\u90fd\u5c06\u88ab\u5bfc\u51fa\u4e3a\u79bb\u6563\u540e\u540e\u7684\u8282\u70b9\u96c6\u5408\u3002 \u4fee\u6539\u51e0\u4f55\u6a21\u578b\u5c06\u5bfc\u81f4\u7f51\u683c\u7684\u66f4\u65b0\uff0c\u6b64\u65f6Groups\u548cRegions\u4e2d\u5b58\u50a8\u7684Node\u53caElement\u7c7b\u578b\u5bf9\u8c61\u90fd\u5c06\u5931\u6548\uff0c\u8868\u73b0\u4e3a\u96c6\u5408\u4e3a\u7a7a\uff1b\u800cPolygon Face\u3001Polygon Edge\u7c7b\u578b\u4f9d\u65e7\u53ef\u4ee5\u4fdd\u6301\u6b63\u786e\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u6240\u4ee5\u53ef\u4ee5\u5bfc\u51fa\u4e3a\u66f4\u65b0\u540e\u7684\u8282\u70b9\u96c6\u5408\u3002 \u5c0f\u7ed3 \u00b6 Groups\u662fFEM\u6216Simulation\u73af\u5883\u4e0b\u4e00\u7cfb\u5217\u53ef\u91cd\u7528\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u65b9\u4fbf\u540e\u7eed\u4f5c\u4e3a\u6574\u4f53\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\u3002Regions\u662f\u4ee5CAE\u4e2d\u65bd\u52a0\u8fb9\u754c\u6761\u4ef6\u4e3a\u76ee\u7684\u800c\u7ec4\u7ec7\u7684CAE\u5143\u7d20\u7684\u96c6\u5408\u3002\u6982\u62ec\u800c\u8a00\uff0cGroups\u53ef\u5b58\u50a8\u7684\u7c7b\u578b\u66f4\u591a\uff0cRegions\u4e3b\u8981\u9762\u5411CAE\u8fb9\u754c\u6761\u4ef6\u7684\u65bd\u52a0\u3002 Groups\u4e2d\u7684Node\u3001Element\u5bf9\u8c61\u5c06\u81ea\u52a8\u5bfc\u51fa\u4e3a\u76f8\u5e94\u7c7b\u578b\u96c6\u5408\uff0cRegions\u4e2d\u6240\u6709\u7c7b\u578b\u53ef\u4ee5\u624b\u52a8\u5bfc\u51fa\u4e3a\u8282\u70b9\u7684\u96c6\u5408\u3002 \u6a21\u578b\u66f4\u65b0\u540e\uff0c\u65e0\u8bbaGroups\u8fd8\u662fRegions\u4e2d\u7684Node\u53caElement\u7c7b\u65b0\u5bf9\u8c61\u90fd\u5c06\u5931\u6548\uff0c\u800cPolygon\u7c7b\u578b\u5bf9\u8c61\u5c06\u81ea\u52a8\u66f4\u65b0\u3002 \u53c2\u8003\u8d44\u6599 \u00b6 Simcenter 3D (CAE)Simcenter Pre/PostGroups Working with reusable regions Region dialog box (Samcef)","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#nxopen caegroupsregions","text":"\u53d1\u5e03\u4e8e\uff1a2017-08-08 | \u5206\u7c7b\uff1a CAD/CAE integration NX FEM\u4e0eSimulation\u90e8\u5206\u7ecf\u5e38\u4f1a\u9047\u5230\u4e24\u4e2a\u6982\u5ff5 Groups \u4e0e Regions \uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u4e00\u4e9b\u53ef\u91cd\u7528\u7684\u5bf9\u8c61\uff0c\u4fbf\u4e8e\u7edf\u4e00\u7ba1\u7406\u3002\u90a3\u4e48\uff0c\u4e8c\u8005\u6709\u4f55\u533a\u522b\uff1f\u672c\u6587\u4ee5NX\u5e2e\u52a9\u6587\u6863\u4e3a\u57fa\u7840\uff0c\u4ecb\u7ecdGroups\u4e0eRegions\u7684\u6982\u5ff5\u53ca\u5176\u5dee\u5f02\uff0c\u4ee5\u4f5c\u5b66\u4e60\u8bb0\u5f55\u548c\u5907\u5fd8\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#_1","text":"Groups \u662f\u51e0\u4f55\uff08\u70b9/\u7ebf/\u9762\u7b49\uff09\u6216\u6709\u9650\u5143\u5bf9\u8c61\uff08\u7f51\u683c/\u8282\u70b9/\u5355\u5143\u7b49\uff09\u7684\u96c6\u5408\u3002\u4eba\u4e3a\u9009\u53d6\u67d0\u4e9b\u5bf9\u8c61\u5e76\u5c06\u5176\u5b9a\u4e49\u4e3a\u4e00\u4e2aGroup\uff0c\u4ee5\u4fbf\u4e8e\u901a\u8fc7\u8fd9\u4e2aGroup\u6765\u7edf\u4e00\u64cd\u4f5c\u6240\u6709\u88ab\u5305\u542b\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\u5bfc\u51fa\u3001\u65bd\u52a0\u8fb9\u754c\u6761\u4ef6\u3001\u63a7\u5236\u663e\u793a/\u9690\u85cf\u3002\u8fd9\u7c7b\u4f3c\u4e8eMSC.Marc\u4e2d\u7684 Set \uff0cHypermesh\u4e2d\u7684 Component \u7684\u6982\u5ff5\u3002 Groups are collections of FE and geometric entities. You can use groups to organize a large model into a small number of easily-managed containers. Regions \u662fSimulation\u73af\u5883\u4e0b\u4ee5\u8fb9\u754c\u6761\u4ef6\u65bd\u52a0\u4e3a\u76ee\u7684\u7684\u591a\u8fb9\u5f62\u51e0\u4f55\u6216CAE\u5bf9\u8c61\u7684\u96c6\u5408\u3002 A region is a collection of homogenous entities, such as polygon faces. You can then use a region to define the source faces or target faces in boundary condition definitions.","title":"\u5b9a\u4e49"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#_2","text":"Groups\u548cRegions\u4e2d\u5b58\u50a8\u5bf9\u8c61\u7684\u7c7b\u578b\u5305\u62ec\uff1a Group Region Node, Element Node, Element Element edge/face Element edge/face Polygon edges/faces/bodies Polygon edges/faces meshes, Mesh points - Curves, Points - Coordinate systems -","title":"\u5b58\u50a8\u5bf9\u8c61\u7c7b\u578b"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#_3","text":"\u6211\u4eec\u53ef\u4ee5\u5728FEM\u6216\u8005Simulation\u73af\u5883\u521b\u5efaGroups\uff0c\u5b83\u4eec\u90fd\u663e\u793a\u4e8eSimulation Navigator\u5bfc\u822a\u6811\u4e0a\u3002\u4f46\u662f\u6ce8\u610f\uff0c \u65e0\u6cd5\u5728Simulation\u73af\u5883\u4fee\u6539FEM\u73af\u5883\u521b\u5efa\u7684Groups\uff0c\u53cd\u4e4b\u540c\u7406 \u3002 \u5f53\u524d\u663e\u793a\u90e8\u4ef6\u4e3aSimulation Part\u65f6\uff0cFEM\u73af\u5883\u521b\u5efa\u7684Groups\u5c06\u9644\u52a0FEM\u6587\u4ef6\u540d\u540e\u663e\u793a\u4e8eSimulation Navigator\uff08\u4f8b\u5982\u540d\u79f0 body => body(CD1-fem_1.prt) \uff09\u3002\u56e0\u6b64\uff0cFEM Groups\u53ef\u7528\u4e8eSimulation\u73af\u5883\u8fb9\u754c\u6761\u4ef6\u7684\u5b9a\u4e49\u3002 \u5f53\u524d\u663e\u793a\u90e8\u4ef6\u4e3aFEM Part\u65f6\uff0cSimulation\u73af\u5883\u521b\u5efa\u7684Groups\u4e0d\u4f1a\u663e\u793a\u4e8eSimulation Navigator\u3002 \u5f53\u524d\u5de5\u4f5c\u90e8\u4ef6\u4e3aFEM Part\u65f6\uff0cSimulation\u73af\u5883\u521b\u5efa\u7684Groups\u5219\u4f1a\u663e\u793a\u4e8eSimulation Navigator\u3002\u56e0\u6b64\uff0cSimulation Groups\u53ef\u7528\u4e8eFEM\u73af\u5883\u4e0b\u7f51\u683c\u5212\u5206\u533a\u57df\u7684\u8bbe\u7f6e\u3002","title":"\u4f7f\u7528\u73af\u5883"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#_4","text":"\u5b58\u50a8\u5728 Groups \u4e0e Regions \u4e2d\u7684\u5143\u7d20\u90fd\u53ef\u4ee5\u5bfc\u51fa\u4e3a\u6709\u9650\u5143\u6c42\u89e3\u6587\u4ef6\uff0c\u4ee5\u4e0b\u662f\u5b83\u4eec\u7684\u4e00\u4e9b\u5f02\u540c\u70b9\uff1a \u4f7f\u7528NX\u5185\u7f6e\u7684 File -> Export -> Export Simulation \u5c06\u5f53\u524d\u6a21\u578b\u5bfc\u51fa\u4e3a\u6709\u9650\u5143\u8f93\u5165\u6587\u4ef6 *.inp \u65f6\uff0cGroups\u4e2d\u5b58\u50a8\u7684Node\u548cElement\u7c7b\u578b\u5bf9\u8c61\u9ed8\u8ba4\u5c06\u88ab\u81ea\u52a8\u5bfc\u51fa\u4e3a\u4ee5\u7ec4\u540d\u547d\u540d\u7684\u96c6\u5408\uff1b\u800cRegions\u4e2d\u7684\u5bf9\u8c61\u5219\u4e0d\u4f1a\u88ab\u5bfc\u51fa\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u5bfc\u51fa\u5bf9\u8bdd\u6846\u4e2d\u5173\u95ed\u5bfc\u51faGroup\u7684\u9009\u9879\uff0c\u5219\u4e0d\u518d\u5bfc\u51faGroup\u3002 Groups\u4e2d\u7684Node\u548cElement\u7c7b\u578b\u5bf9\u8c61\u5c06\u5206\u522b\u5bfc\u51fa\u4e3a\u8282\u70b9\u548c\u5355\u5143\uff0c\u5176\u4ed6\u51e0\u4f55\u5bf9\u8c61\u5982Polygon Face\u3001Polygon Edge\u5219\u5bfc\u51fa\u4e3a\u7a7a\uff1bRegions\u4e2d\u6240\u6709\u7c7b\u578b\u5bf9\u8c61\uff0c\u5373\u4fbf\u662fElements\uff0c\u90fd\u5c06\u88ab\u5bfc\u51fa\u4e3a\u79bb\u6563\u540e\u540e\u7684\u8282\u70b9\u96c6\u5408\u3002 \u4fee\u6539\u51e0\u4f55\u6a21\u578b\u5c06\u5bfc\u81f4\u7f51\u683c\u7684\u66f4\u65b0\uff0c\u6b64\u65f6Groups\u548cRegions\u4e2d\u5b58\u50a8\u7684Node\u53caElement\u7c7b\u578b\u5bf9\u8c61\u90fd\u5c06\u5931\u6548\uff0c\u8868\u73b0\u4e3a\u96c6\u5408\u4e3a\u7a7a\uff1b\u800cPolygon Face\u3001Polygon Edge\u7c7b\u578b\u4f9d\u65e7\u53ef\u4ee5\u4fdd\u6301\u6b63\u786e\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u6240\u4ee5\u53ef\u4ee5\u5bfc\u51fa\u4e3a\u66f4\u65b0\u540e\u7684\u8282\u70b9\u96c6\u5408\u3002","title":"\u5bfc\u51fa\u6c42\u89e3\u6587\u4ef6"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#_5","text":"Groups\u662fFEM\u6216Simulation\u73af\u5883\u4e0b\u4e00\u7cfb\u5217\u53ef\u91cd\u7528\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u65b9\u4fbf\u540e\u7eed\u4f5c\u4e3a\u6574\u4f53\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\u3002Regions\u662f\u4ee5CAE\u4e2d\u65bd\u52a0\u8fb9\u754c\u6761\u4ef6\u4e3a\u76ee\u7684\u800c\u7ec4\u7ec7\u7684CAE\u5143\u7d20\u7684\u96c6\u5408\u3002\u6982\u62ec\u800c\u8a00\uff0cGroups\u53ef\u5b58\u50a8\u7684\u7c7b\u578b\u66f4\u591a\uff0cRegions\u4e3b\u8981\u9762\u5411CAE\u8fb9\u754c\u6761\u4ef6\u7684\u65bd\u52a0\u3002 Groups\u4e2d\u7684Node\u3001Element\u5bf9\u8c61\u5c06\u81ea\u52a8\u5bfc\u51fa\u4e3a\u76f8\u5e94\u7c7b\u578b\u96c6\u5408\uff0cRegions\u4e2d\u6240\u6709\u7c7b\u578b\u53ef\u4ee5\u624b\u52a8\u5bfc\u51fa\u4e3a\u8282\u70b9\u7684\u96c6\u5408\u3002 \u6a21\u578b\u66f4\u65b0\u540e\uff0c\u65e0\u8bbaGroups\u8fd8\u662fRegions\u4e2d\u7684Node\u53caElement\u7c7b\u65b0\u5bf9\u8c61\u90fd\u5c06\u5931\u6548\uff0c\u800cPolygon\u7c7b\u578b\u5bf9\u8c61\u5c06\u81ea\u52a8\u66f4\u65b0\u3002","title":"\u5c0f\u7ed3"},{"location":"2017-08-08-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AGroups%E4%B8%8ERegions/#_6","text":"Simcenter 3D (CAE)Simcenter Pre/PostGroups Working with reusable regions Region dialog box (Samcef)","title":"\u53c2\u8003\u8d44\u6599"},{"location":"2017-08-27-NXOpen%EF%BC%9A%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%9A%84%E8%AE%A4%E8%AF%86/","text":"NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-08-27 | \u5206\u7c7b\uff1a CAD/CAE integration \u5bf9\u8bdd\u6846\uff08Block UI Styler\uff09\u662fNXOpen\u4e8c\u6b21\u5f00\u53d1\u4e2d\u7684\u5e38\u89c1\u5bf9\u8c61\uff0c\u672c\u6587\u9646\u7eed\u8bb0\u5f55\u5b66\u4e60\u548c\u4f7f\u7528\u5bf9\u8bdd\u6846\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u8ba4\u8bc6\u548c\u4f53\u4f1a\u3002 Apply \u54cd\u5e94\u4e8b\u4ef6 \u00b6 Apply \u6309\u94ae\u662f\u5728\u6267\u884c\u5b8c Apply_cb() \u51fd\u6570\u4f53\u5185\u5bb9\u540e\u518d\u6b21\u663e\u793a\u5bf9\u8bdd\u6846\uff0c\u5373\u6267\u884c dialogShow_cb() \u56de\u8c03\u51fd\u6570\u3002 Apply / OK / Cancel \u4e0e\u66f4\u65b0 \u00b6 NX\u5728\u6253\u5f00\u5bf9\u8bdd\u6846\u4e4b\u524d\u521b\u5efa\u4e86 Undo Mark \uff0c\u70b9\u51fb Apply / OK \u63d0\u4ea4\u5bf9\u8bdd\u6846\u671f\u95f4\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u70b9\u51fb Cancel \u5219\u56de\u9000\u5230\u539f\u59cb\u72b6\u6001\u3002\u5373\u4fbf\u5728\u5bf9\u8bdd\u6846\u6253\u5f00\u671f\u95f4\u7684\u64cd\u4f5c\u786e\u5b9e\u5f71\u54cd\u4e86\u76ee\u5f55\u6811\u3002 \u8c03\u7528\u5b50\u5bf9\u8bdd\u6846\u4e8b\u4ef6\u6d41\u7a0b \u00b6 \u5728\u4e3b\u5bf9\u8bdd\u6846\u4e2d\u89e6\u53d1\u663e\u793a\u5b50\u5bf9\u8bdd\u6846\u4e8b\u4ef6\u540e\uff0c\u4e8b\u4ef6\u8fdb\u7a0b\u5c06\u8f6c\u79fb\u5230\u5b50\u5bf9\u8bdd\u6846\u4e0a\uff0c\u4e3b\u5bf9\u8bdd\u6846\u81ea\u52a8\u9690\u85cf\u76f4\u81f3\u5b50\u5bf9\u8bdd\u6846\u4e8b\u4ef6\u7ed3\u675f\uff08Apply/OK/Cancel/Close\uff09\u3002","title":"NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6"},{"location":"2017-08-27-NXOpen%EF%BC%9A%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%9A%84%E8%AE%A4%E8%AF%86/#nxopen","text":"\u53d1\u5e03\u4e8e\uff1a2017-08-27 | \u5206\u7c7b\uff1a CAD/CAE integration \u5bf9\u8bdd\u6846\uff08Block UI Styler\uff09\u662fNXOpen\u4e8c\u6b21\u5f00\u53d1\u4e2d\u7684\u5e38\u89c1\u5bf9\u8c61\uff0c\u672c\u6587\u9646\u7eed\u8bb0\u5f55\u5b66\u4e60\u548c\u4f7f\u7528\u5bf9\u8bdd\u6846\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u8ba4\u8bc6\u548c\u4f53\u4f1a\u3002","title":"NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6"},{"location":"2017-08-27-NXOpen%EF%BC%9A%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%9A%84%E8%AE%A4%E8%AF%86/#apply","text":"Apply \u6309\u94ae\u662f\u5728\u6267\u884c\u5b8c Apply_cb() \u51fd\u6570\u4f53\u5185\u5bb9\u540e\u518d\u6b21\u663e\u793a\u5bf9\u8bdd\u6846\uff0c\u5373\u6267\u884c dialogShow_cb() \u56de\u8c03\u51fd\u6570\u3002","title":"Apply\u54cd\u5e94\u4e8b\u4ef6"},{"location":"2017-08-27-NXOpen%EF%BC%9A%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%9A%84%E8%AE%A4%E8%AF%86/#apply ok cancel","text":"NX\u5728\u6253\u5f00\u5bf9\u8bdd\u6846\u4e4b\u524d\u521b\u5efa\u4e86 Undo Mark \uff0c\u70b9\u51fb Apply / OK \u63d0\u4ea4\u5bf9\u8bdd\u6846\u671f\u95f4\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u70b9\u51fb Cancel \u5219\u56de\u9000\u5230\u539f\u59cb\u72b6\u6001\u3002\u5373\u4fbf\u5728\u5bf9\u8bdd\u6846\u6253\u5f00\u671f\u95f4\u7684\u64cd\u4f5c\u786e\u5b9e\u5f71\u54cd\u4e86\u76ee\u5f55\u6811\u3002","title":"Apply / OK / Cancel\u4e0e\u66f4\u65b0"},{"location":"2017-08-27-NXOpen%EF%BC%9A%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%9A%84%E8%AE%A4%E8%AF%86/#_1","text":"\u5728\u4e3b\u5bf9\u8bdd\u6846\u4e2d\u89e6\u53d1\u663e\u793a\u5b50\u5bf9\u8bdd\u6846\u4e8b\u4ef6\u540e\uff0c\u4e8b\u4ef6\u8fdb\u7a0b\u5c06\u8f6c\u79fb\u5230\u5b50\u5bf9\u8bdd\u6846\u4e0a\uff0c\u4e3b\u5bf9\u8bdd\u6846\u81ea\u52a8\u9690\u85cf\u76f4\u81f3\u5b50\u5bf9\u8bdd\u6846\u4e8b\u4ef6\u7ed3\u675f\uff08Apply/OK/Cancel/Close\uff09\u3002","title":"\u8c03\u7528\u5b50\u5bf9\u8bdd\u6846\u4e8b\u4ef6\u6d41\u7a0b"},{"location":"2017-09-01-NXOpen%EF%BC%9AMenu-Script%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95/","text":"NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-09-01 | \u5206\u7c7b\uff1a CAD/CAE integration NX\u81ea\u5b9a\u4e49\u83dc\u5355\u680f\u53ef\u4ee5\u6839\u636e\u5f53\u524d\u6240\u5728\u7684\u4e0d\u540c\u6a21\u5757\u800c\u663e\u793a\u4e0d\u540c\u5185\u5bb9\uff0c\u672c\u6587\u8bb0\u5f55\u521b\u5efa\u6309\u6a21\u5757\u663e\u793a\u7684\u83dc\u5355\u680f\u7684\u57fa\u672c\u6d41\u7a0b\u3002\u4ee5\u81ea\u5b9a\u4e49\u83dc\u5355 TEST MENU \u4e3a\u4f8b\uff0c\u8be5\u83dc\u5355\u5305\u542b\u4e09\u4e2a\u5206\u7ec4\uff1a Public \u3001 Modeling \u548c FEM \u3002\u5176\u4e2d\uff0c Public \u5206\u7ec4\u663e\u793a\u5728\u4efb\u610f\u6a21\u5757\u4e0b Modeling \u53ca FEM \u5206\u7ec4\u4ec5\u5728 Modeling \u6216 Pre/Post \u6a21\u5757\u663e\u793a Modeling \u5206\u7ec4\u5728 Modeling \u548c Pre/Post \u6a21\u5757\u663e\u793a\u4e0d\u540c\u7684\u83dc\u5355\u9879\uff0c FEM \u5206\u7ec4\u540c\u7406 \u793a\u4f8b\u6548\u679c\u53c2\u8003\uff1a \u4e3b\u83dc\u5355 \u00b6 \u6587\u4ef6\u5939 Startup \u4e2d\u521b\u5efa\u7684\u83dc\u5355\u811a\u672c\u6587\u4ef6\u5c06\u5728NX\u542f\u52a8\u65f6\u8fdb\u884c\u52a0\u8f7d\uff0c\u5373\u53ef\u4ee5\u663e\u793a\u5728\u4efb\u610f\u6a21\u5757\u4e0b\u3002\u672c\u4f8b\u4e2d\u9700\u8981\u6309\u7167\u4e0d\u540c\u6a21\u5757\u52a0\u8f7d\uff0c\u5219\u9700\u8981 APPLICATION_BUTTON \u547d\u4ee4\u6307\u5b9a\u52a0\u8f7d\u7684\u83dc\u5355\u6587\u4ef6\u3002 \u4e3b\u83dc\u5355\u6587\u4ef6 test_main.men \uff1a VERSION 170 EDIT UG_GATEWAY_MAIN_MENUBAR !------------------------------------------------- ! user defined menu !------------------------------------------------- BEFORE UG_HELP CASCADE_BUTTON TEST_MENU LABEL TEST MENU END_OF_BEFORE !------------------------------------------------- ! contents of user defined menu ! ------------------------------------------------ ! public menus show in all applications MENU TEST_MENU BUTTON TEST_MENU_PUBLIC LABEL Public Button END_OF_MENU ! Application dependent menus show ! in specified application MODIFY APPLICATION_BUTTON UG_APP_MODELING MENU_FILES test_modeling.men END_OF_MODIFY MODIFY APPLICATION_BUTTON UG_APP_SFEM MENU_FILES test_fem.men END_OF_MODIFY \u5176\u4e2d\uff0c TEST_MENU_PUBLIC \u6309\u94ae\u5bf9\u4efb\u610f\u6a21\u5757\u751f\u6548\uff0c test_modeling.men \u548c test_fem.men \u662f\u6a21\u5757\u76f8\u5173\u7684\u83dc\u5355\u811a\u672c\u6587\u4ef6\uff0c\u5206\u522b\u63a7\u5236 TEST MENU \u5728 Modeling \u6a21\u5757\u3001 Pre/Post \u6a21\u5757\u4e0b\u7684\u663e\u793a\u5185\u5bb9\u3002 \u6a21\u5757\u83dc\u5355 \u5c06\u5728\u7b2c\u4e8c\u90e8\u5206\u4ecb\u7ecd\u3002 \u6839\u636eMenuScript\u8bed\u8a00\u57fa\u672c\u89c4\u5219\uff0c \u4f7f\u7528.menu\u811a\u672c\u53ef\u4ee5\u521b\u5efa\u57fa\u672c\u7684\u83dc\u5355\u9879\u547d\u4ee4\uff0c\u5206\u7c7b\u7ec4\u7ec7\u57fa\u672c\u83dc\u5355\u9879\u547d\u4ee4\u5230.tbr\u811a\u672c\u5373\u4e3a\u5de5\u5177\u6761\uff0c\u6309Group\u7ec4\u7ec7\u5de5\u5177\u6761.tbr\u6587\u4ef6\u5219\u5f62\u6210\u65b0\u7248\u7684Ribbon\u754c\u9762 \u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5b9e\u73b0\u5f00\u59cb\u6240\u8ff0 Public \u3001 Modeling \u548c FEM \u4e09\u4e2a\u5206\u7ec4\uff0c\u9700\u8981\u5206\u522b\u521b\u5efa\u4e09\u4e2a\u5de5\u5177\u6761\u6587\u4ef6\uff0c\u4f8b\u5982 test_public.tbr \u3001 test_modeling.tbr \u53ca test_fem.tbr \u3002 \u6a21\u5757\u5206\u7ec4 \u5c06\u5728\u7b2c\u4e09\u90e8\u5206\u4ecb\u7ecd\u3002 \u8003\u8651\u5230\u65b0\u7248\u7684Ribbon\u754c\u9762\uff0c\u53ef\u4ee5\u5728 Startup \u6587\u4ef6\u5939\u4e0b\u521b\u5efa test_main.rtb \uff0c\u4e3b\u8981\u5185\u5bb9\u5373\u4e3a TEST MENU \u7684\u4e09\u4e2a\u5206\u7ec4\u5de5\u5177\u6761\u6587\u4ef6\uff1a !------------------------------------------------- ! scripts for new style RIBBON UI! ! toolbar files will be transferred to ribbon groups !------------------------------------------------- TITLE TEST MENU VERSION 170 GROUP test_public.tbr GROUP test_modeling.tbr GROUP test_fem.tbr \u6a21\u5757\u83dc\u5355 \u00b6 \u6309\u6a21\u5757\u52a0\u8f7d\u7684\u83dc\u5355\u811a\u672c\u5b58\u653e\u4e8e Application \u6587\u4ef6\u5939\u4e0b \u3002 \u9664\u4e86 Gateway \u4e2d\u5b9a\u4e49\u7684\u83dc\u5355\u9879\u547d\u4ee4\u4e4b\u5916\uff0cNX\u8fd8\u5c06\u6309\u5f53\u524d\u6a21\u5757\u52a0\u8f7d\u76f8\u5e94\u83dc\u5355\u811a\u672c\u4e2d\u5b9a\u4e49\u7684\u83dc\u5355\u9879\u547d\u4ee4\uff0c\u5171\u540c\u7ec4\u6210 TEST MENU \u3002\u6839\u636e\u56fe1\uff0c\u672c\u4f8b\u7684\u6a21\u5757\u83dc\u5355\u811a\u672c\u6587\u4ef6\u53c2\u8003\uff1a test_modeling.men VERSION 139 EDIT UG_GATEWAY_MAIN_MENUBAR !------------------------------------------------- ! user defined menu !------------------------------------------------- BEFORE UG_HELP CASCADE_BUTTON TEST_MENU LABEL Main test menu END_OF_BEFORE !------------------------------------------------- ! contents of user defined menu ! ------------------------------------------------ MENU TEST_MENU SEPARATOR BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 BUTTON TEST_MENU_MODELING_2 LABEL Modeling Button 2 BUTTON TEST_MENU_MODELING_3 LABEL Modeling Button 3 SEPARATOR BUTTON TEST_MENU_FEM_1 LABEL FEM Button 1 END_OF_MENU test_fem.men VERSION 139 EDIT UG_GATEWAY_MAIN_MENUBAR !------------------------------------------------- ! user defined menu !------------------------------------------------- BEFORE UG_HELP CASCADE_BUTTON TEST_MENU LABEL Main test menu END_OF_BEFORE !------------------------------------------------- ! contents of user defined menu ! ------------------------------------------------ MENU TEST_MENU SEPARATOR BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 SEPARATOR BUTTON TEST_MENU_FEM_1 LABEL FEM Button 1 BUTTON TEST_MENU_FEM_2 LABEL FEM Button 2 END_OF_MENU \u6309\u6a21\u5757\u5206\u7ec4 \u00b6 \u5982\u7b2c\u4e00\u90e8\u5206\u6240\u8ff0\uff0c Public \u3001 Modeling \u548c FEM \u4e09\u4e2a\u5206\u7ec4\u5206\u522b\u5bf9\u5e94\u4e86 test_public.tbr \u3001 test_modeling.tbr \u548c test_fem.tbr \u4e09\u4e2a\u5de5\u5177\u680f\u6587\u4ef6\uff0c\u56e0\u6b64\u8fd9\u4e00\u90e8\u5206\u6765\u5b9e\u73b0\u5b83\u4eec\u3002 \u6839\u636e\u5f00\u59cb\u8bbe\u5b9a\u7684\u9700\u6c42\uff0c Public \u4e3a\u516c\u5171\u5206\u7ec4\uff0c\u56e0\u6b64\u5728 Startup \u4e0b\u521b\u5efa\u811a\u672c\u6587\u4ef6 test_public.tbr \uff0c\u5185\u5bb9\u5373\u4e3a\u83dc\u5355\u811a\u672c test_main.men \u4e2d\u5b9a\u4e49\u597d\u7684\u83dc\u5355\u9879\u547d\u4ee4\uff1a TITLE PUBLIC VERSION 170 BUTTON TEST_MENU_PUBLIC \u5bf9\u4e8e\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u5206\u7ec4 Modeling \u548c FEM \uff0c\u9700\u8981\u5b58\u653e\u4e8e Application \u4e0b\u7684\u7279\u5b9a\u76ee\u5f55\uff1a Profiles/UG_APP_MODELING/ \u4e0b\u7684\u5de5\u5177\u6761\u6587\u4ef6\u5c06\u5728 Modeling \u73af\u5883\u4e0b\u52a0\u8f7d\uff0c Profiles/UG_APP_SFEM/ \u4e0b\u7684\u5de5\u5177\u6761\u6587\u4ef6\u5c06\u5728 Pre/Post \u73af\u5883\u4e0b\u52a0\u8f7d\u3002 \u56e0\u6b64\u5728 Profiles/UG_APP_MODELING/ \u4e0b\u521b\u5efa test_modeling.tbr \u548c test_fem.tbr \uff0c\u5176\u5185\u5bb9\u6765\u81ea test_modeling.men \u4e2d\u5b9a\u4e49\u597d\u7684\u56db\u4e2a\u547d\u4ee4\uff1a TEST_MENU_MODELING_1-TEST_MENU_MODELING_3 \u548c TEST_MENU_FEM_1 \u3002\u663e\u7136\uff0c\u524d\u4e09\u4e2a\u5c5e\u4e8e Modeling \u5206\u7ec4\uff0c\u6700\u540e\u4e00\u4e2a\u5c5e\u4e8e FEM \u5206\u7ec4\u3002\u56e0\u6b64\uff0c\u5206\u522b\u5206\u7c7b\u5199\u5165\uff1a test_modeling.tbr TITLE MODELING VERSION 170 BUTTON TEST_MENU_MODELING_1 BUTTON TEST_MENU_MODELING_2 BUTTON TEST_MENU_MODELING_3 test_fem.tbr TITLE FEM VERSION 170 BUTTON TEST_MENU_FEM_1 \u540c\u7406\u5728 Profiles/UG_APP_SFEM/ \u4e0b\u521b\u5efa\uff1a test_modeling.tbr TITLE MODELING VERSION 170 BUTTON TEST_MENU_MODELING_1 test_fem.tbr TITLE FEM VERSION 170 BUTTON TEST_MENU_FEM_1 BUTTON TEST_MENU_FEM_2 \u603b\u7ed3 \u00b6 \u4ee5\u4e0a\u5373\u4e3a\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u57fa\u672c\u521b\u5efa\u6d41\u7a0b\uff0c\u7b80\u8981\u5f52\u7eb3\u4e3a\uff1a \u5728\u4e3b\u83dc\u5355\u6587\u4ef6\u4e2d\u5b9a\u4e49\u516c\u5171\u83dc\u5355\u9879\u6216\u8005\u6307\u5b9a\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u83dc\u5355\u6587\u4ef6 \u5728\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u83dc\u5355\u6587\u4ef6\u4e2d\u5b9a\u5236\u76f8\u5e94\u7684\u83dc\u5355\u9879 \u7ec4\u7ec7\u6240\u6709\u83dc\u5355\u9879\u547d\u4ee4\u4e3a\u76f8\u5e94\u7684\u5206\u7ec4\uff0c\u9ed8\u8ba4\u5206\u7ec4\u4f4d\u4e8e startup \uff0c\u6309\u9700\u52a0\u8f7d\u5206\u7ec4\u4f4d\u4e8e application/profiles \u6700\u540e\uff0c\u672c\u6587\u6d89\u53ca\u83dc\u5355\u811a\u672c\u6c47\u603b\u4e8e nx_menu_script \uff0c\u5e76\u5c06\u5176\u57fa\u672c\u6d41\u7a0b\u56fe\u793a\u5982\u4e0b\uff1a","title":"NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355"},{"location":"2017-09-01-NXOpen%EF%BC%9AMenu-Script%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95/#nxopenmenu script","text":"\u53d1\u5e03\u4e8e\uff1a2017-09-01 | \u5206\u7c7b\uff1a CAD/CAE integration NX\u81ea\u5b9a\u4e49\u83dc\u5355\u680f\u53ef\u4ee5\u6839\u636e\u5f53\u524d\u6240\u5728\u7684\u4e0d\u540c\u6a21\u5757\u800c\u663e\u793a\u4e0d\u540c\u5185\u5bb9\uff0c\u672c\u6587\u8bb0\u5f55\u521b\u5efa\u6309\u6a21\u5757\u663e\u793a\u7684\u83dc\u5355\u680f\u7684\u57fa\u672c\u6d41\u7a0b\u3002\u4ee5\u81ea\u5b9a\u4e49\u83dc\u5355 TEST MENU \u4e3a\u4f8b\uff0c\u8be5\u83dc\u5355\u5305\u542b\u4e09\u4e2a\u5206\u7ec4\uff1a Public \u3001 Modeling \u548c FEM \u3002\u5176\u4e2d\uff0c Public \u5206\u7ec4\u663e\u793a\u5728\u4efb\u610f\u6a21\u5757\u4e0b Modeling \u53ca FEM \u5206\u7ec4\u4ec5\u5728 Modeling \u6216 Pre/Post \u6a21\u5757\u663e\u793a Modeling \u5206\u7ec4\u5728 Modeling \u548c Pre/Post \u6a21\u5757\u663e\u793a\u4e0d\u540c\u7684\u83dc\u5355\u9879\uff0c FEM \u5206\u7ec4\u540c\u7406 \u793a\u4f8b\u6548\u679c\u53c2\u8003\uff1a","title":"NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355"},{"location":"2017-09-01-NXOpen%EF%BC%9AMenu-Script%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95/#_1","text":"\u6587\u4ef6\u5939 Startup \u4e2d\u521b\u5efa\u7684\u83dc\u5355\u811a\u672c\u6587\u4ef6\u5c06\u5728NX\u542f\u52a8\u65f6\u8fdb\u884c\u52a0\u8f7d\uff0c\u5373\u53ef\u4ee5\u663e\u793a\u5728\u4efb\u610f\u6a21\u5757\u4e0b\u3002\u672c\u4f8b\u4e2d\u9700\u8981\u6309\u7167\u4e0d\u540c\u6a21\u5757\u52a0\u8f7d\uff0c\u5219\u9700\u8981 APPLICATION_BUTTON \u547d\u4ee4\u6307\u5b9a\u52a0\u8f7d\u7684\u83dc\u5355\u6587\u4ef6\u3002 \u4e3b\u83dc\u5355\u6587\u4ef6 test_main.men \uff1a VERSION 170 EDIT UG_GATEWAY_MAIN_MENUBAR !------------------------------------------------- ! user defined menu !------------------------------------------------- BEFORE UG_HELP CASCADE_BUTTON TEST_MENU LABEL TEST MENU END_OF_BEFORE !------------------------------------------------- ! contents of user defined menu ! ------------------------------------------------ ! public menus show in all applications MENU TEST_MENU BUTTON TEST_MENU_PUBLIC LABEL Public Button END_OF_MENU ! Application dependent menus show ! in specified application MODIFY APPLICATION_BUTTON UG_APP_MODELING MENU_FILES test_modeling.men END_OF_MODIFY MODIFY APPLICATION_BUTTON UG_APP_SFEM MENU_FILES test_fem.men END_OF_MODIFY \u5176\u4e2d\uff0c TEST_MENU_PUBLIC \u6309\u94ae\u5bf9\u4efb\u610f\u6a21\u5757\u751f\u6548\uff0c test_modeling.men \u548c test_fem.men \u662f\u6a21\u5757\u76f8\u5173\u7684\u83dc\u5355\u811a\u672c\u6587\u4ef6\uff0c\u5206\u522b\u63a7\u5236 TEST MENU \u5728 Modeling \u6a21\u5757\u3001 Pre/Post \u6a21\u5757\u4e0b\u7684\u663e\u793a\u5185\u5bb9\u3002 \u6a21\u5757\u83dc\u5355 \u5c06\u5728\u7b2c\u4e8c\u90e8\u5206\u4ecb\u7ecd\u3002 \u6839\u636eMenuScript\u8bed\u8a00\u57fa\u672c\u89c4\u5219\uff0c \u4f7f\u7528.menu\u811a\u672c\u53ef\u4ee5\u521b\u5efa\u57fa\u672c\u7684\u83dc\u5355\u9879\u547d\u4ee4\uff0c\u5206\u7c7b\u7ec4\u7ec7\u57fa\u672c\u83dc\u5355\u9879\u547d\u4ee4\u5230.tbr\u811a\u672c\u5373\u4e3a\u5de5\u5177\u6761\uff0c\u6309Group\u7ec4\u7ec7\u5de5\u5177\u6761.tbr\u6587\u4ef6\u5219\u5f62\u6210\u65b0\u7248\u7684Ribbon\u754c\u9762 \u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5b9e\u73b0\u5f00\u59cb\u6240\u8ff0 Public \u3001 Modeling \u548c FEM \u4e09\u4e2a\u5206\u7ec4\uff0c\u9700\u8981\u5206\u522b\u521b\u5efa\u4e09\u4e2a\u5de5\u5177\u6761\u6587\u4ef6\uff0c\u4f8b\u5982 test_public.tbr \u3001 test_modeling.tbr \u53ca test_fem.tbr \u3002 \u6a21\u5757\u5206\u7ec4 \u5c06\u5728\u7b2c\u4e09\u90e8\u5206\u4ecb\u7ecd\u3002 \u8003\u8651\u5230\u65b0\u7248\u7684Ribbon\u754c\u9762\uff0c\u53ef\u4ee5\u5728 Startup \u6587\u4ef6\u5939\u4e0b\u521b\u5efa test_main.rtb \uff0c\u4e3b\u8981\u5185\u5bb9\u5373\u4e3a TEST MENU \u7684\u4e09\u4e2a\u5206\u7ec4\u5de5\u5177\u6761\u6587\u4ef6\uff1a !------------------------------------------------- ! scripts for new style RIBBON UI! ! toolbar files will be transferred to ribbon groups !------------------------------------------------- TITLE TEST MENU VERSION 170 GROUP test_public.tbr GROUP test_modeling.tbr GROUP test_fem.tbr","title":"\u4e3b\u83dc\u5355"},{"location":"2017-09-01-NXOpen%EF%BC%9AMenu-Script%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95/#_2","text":"\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u83dc\u5355\u811a\u672c\u5b58\u653e\u4e8e Application \u6587\u4ef6\u5939\u4e0b \u3002 \u9664\u4e86 Gateway \u4e2d\u5b9a\u4e49\u7684\u83dc\u5355\u9879\u547d\u4ee4\u4e4b\u5916\uff0cNX\u8fd8\u5c06\u6309\u5f53\u524d\u6a21\u5757\u52a0\u8f7d\u76f8\u5e94\u83dc\u5355\u811a\u672c\u4e2d\u5b9a\u4e49\u7684\u83dc\u5355\u9879\u547d\u4ee4\uff0c\u5171\u540c\u7ec4\u6210 TEST MENU \u3002\u6839\u636e\u56fe1\uff0c\u672c\u4f8b\u7684\u6a21\u5757\u83dc\u5355\u811a\u672c\u6587\u4ef6\u53c2\u8003\uff1a test_modeling.men VERSION 139 EDIT UG_GATEWAY_MAIN_MENUBAR !------------------------------------------------- ! user defined menu !------------------------------------------------- BEFORE UG_HELP CASCADE_BUTTON TEST_MENU LABEL Main test menu END_OF_BEFORE !------------------------------------------------- ! contents of user defined menu ! ------------------------------------------------ MENU TEST_MENU SEPARATOR BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 BUTTON TEST_MENU_MODELING_2 LABEL Modeling Button 2 BUTTON TEST_MENU_MODELING_3 LABEL Modeling Button 3 SEPARATOR BUTTON TEST_MENU_FEM_1 LABEL FEM Button 1 END_OF_MENU test_fem.men VERSION 139 EDIT UG_GATEWAY_MAIN_MENUBAR !------------------------------------------------- ! user defined menu !------------------------------------------------- BEFORE UG_HELP CASCADE_BUTTON TEST_MENU LABEL Main test menu END_OF_BEFORE !------------------------------------------------- ! contents of user defined menu ! ------------------------------------------------ MENU TEST_MENU SEPARATOR BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 SEPARATOR BUTTON TEST_MENU_FEM_1 LABEL FEM Button 1 BUTTON TEST_MENU_FEM_2 LABEL FEM Button 2 END_OF_MENU","title":"\u6a21\u5757\u83dc\u5355"},{"location":"2017-09-01-NXOpen%EF%BC%9AMenu-Script%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95/#_3","text":"\u5982\u7b2c\u4e00\u90e8\u5206\u6240\u8ff0\uff0c Public \u3001 Modeling \u548c FEM \u4e09\u4e2a\u5206\u7ec4\u5206\u522b\u5bf9\u5e94\u4e86 test_public.tbr \u3001 test_modeling.tbr \u548c test_fem.tbr \u4e09\u4e2a\u5de5\u5177\u680f\u6587\u4ef6\uff0c\u56e0\u6b64\u8fd9\u4e00\u90e8\u5206\u6765\u5b9e\u73b0\u5b83\u4eec\u3002 \u6839\u636e\u5f00\u59cb\u8bbe\u5b9a\u7684\u9700\u6c42\uff0c Public \u4e3a\u516c\u5171\u5206\u7ec4\uff0c\u56e0\u6b64\u5728 Startup \u4e0b\u521b\u5efa\u811a\u672c\u6587\u4ef6 test_public.tbr \uff0c\u5185\u5bb9\u5373\u4e3a\u83dc\u5355\u811a\u672c test_main.men \u4e2d\u5b9a\u4e49\u597d\u7684\u83dc\u5355\u9879\u547d\u4ee4\uff1a TITLE PUBLIC VERSION 170 BUTTON TEST_MENU_PUBLIC \u5bf9\u4e8e\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u5206\u7ec4 Modeling \u548c FEM \uff0c\u9700\u8981\u5b58\u653e\u4e8e Application \u4e0b\u7684\u7279\u5b9a\u76ee\u5f55\uff1a Profiles/UG_APP_MODELING/ \u4e0b\u7684\u5de5\u5177\u6761\u6587\u4ef6\u5c06\u5728 Modeling \u73af\u5883\u4e0b\u52a0\u8f7d\uff0c Profiles/UG_APP_SFEM/ \u4e0b\u7684\u5de5\u5177\u6761\u6587\u4ef6\u5c06\u5728 Pre/Post \u73af\u5883\u4e0b\u52a0\u8f7d\u3002 \u56e0\u6b64\u5728 Profiles/UG_APP_MODELING/ \u4e0b\u521b\u5efa test_modeling.tbr \u548c test_fem.tbr \uff0c\u5176\u5185\u5bb9\u6765\u81ea test_modeling.men \u4e2d\u5b9a\u4e49\u597d\u7684\u56db\u4e2a\u547d\u4ee4\uff1a TEST_MENU_MODELING_1-TEST_MENU_MODELING_3 \u548c TEST_MENU_FEM_1 \u3002\u663e\u7136\uff0c\u524d\u4e09\u4e2a\u5c5e\u4e8e Modeling \u5206\u7ec4\uff0c\u6700\u540e\u4e00\u4e2a\u5c5e\u4e8e FEM \u5206\u7ec4\u3002\u56e0\u6b64\uff0c\u5206\u522b\u5206\u7c7b\u5199\u5165\uff1a test_modeling.tbr TITLE MODELING VERSION 170 BUTTON TEST_MENU_MODELING_1 BUTTON TEST_MENU_MODELING_2 BUTTON TEST_MENU_MODELING_3 test_fem.tbr TITLE FEM VERSION 170 BUTTON TEST_MENU_FEM_1 \u540c\u7406\u5728 Profiles/UG_APP_SFEM/ \u4e0b\u521b\u5efa\uff1a test_modeling.tbr TITLE MODELING VERSION 170 BUTTON TEST_MENU_MODELING_1 test_fem.tbr TITLE FEM VERSION 170 BUTTON TEST_MENU_FEM_1 BUTTON TEST_MENU_FEM_2","title":"\u6309\u6a21\u5757\u5206\u7ec4"},{"location":"2017-09-01-NXOpen%EF%BC%9AMenu-Script%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95/#_4","text":"\u4ee5\u4e0a\u5373\u4e3a\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u57fa\u672c\u521b\u5efa\u6d41\u7a0b\uff0c\u7b80\u8981\u5f52\u7eb3\u4e3a\uff1a \u5728\u4e3b\u83dc\u5355\u6587\u4ef6\u4e2d\u5b9a\u4e49\u516c\u5171\u83dc\u5355\u9879\u6216\u8005\u6307\u5b9a\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u83dc\u5355\u6587\u4ef6 \u5728\u6309\u6a21\u5757\u52a0\u8f7d\u7684\u83dc\u5355\u6587\u4ef6\u4e2d\u5b9a\u5236\u76f8\u5e94\u7684\u83dc\u5355\u9879 \u7ec4\u7ec7\u6240\u6709\u83dc\u5355\u9879\u547d\u4ee4\u4e3a\u76f8\u5e94\u7684\u5206\u7ec4\uff0c\u9ed8\u8ba4\u5206\u7ec4\u4f4d\u4e8e startup \uff0c\u6309\u9700\u52a0\u8f7d\u5206\u7ec4\u4f4d\u4e8e application/profiles \u6700\u540e\uff0c\u672c\u6587\u6d89\u53ca\u83dc\u5355\u811a\u672c\u6c47\u603b\u4e8e nx_menu_script \uff0c\u5e76\u5c06\u5176\u57fa\u672c\u6d41\u7a0b\u56fe\u793a\u5982\u4e0b\uff1a","title":"\u603b\u7ed3"},{"location":"2017-10-10-%E5%85%BC%E5%AE%B9Windows%E5%92%8CLinux%E7%9A%84C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93%E6%A8%A1%E6%9D%BF/","text":"\u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-10-10 | \u5206\u7c7b\uff1a python/vba/cpp \u5173\u952e\u70b9 \u00b6 Windows\u4e0b\u53ef\u4ee5\u4f7f\u7528 __declspec() \u4fee\u9970\u7c7b\u7684\u5bfc\u51fa\u548c\u5bfc\u5165\uff0c\u4f7f\u7528 __stdcall \u4fee\u9970\u5bfc\u51fa\u51fd\u6570 Linux\u5e73\u53f0\u65e0\u9700\u6307\u5b9a\u5bfc\u5165\u5bfc\u51fa\u7c7b\u65f6\u65e0\u9700\u6307\u5b9a\u4ee5\u4e0a\u4fee\u9970\u540d\u79f0 \u8003\u8651\u5230C++\u7684 Name Mangling \uff0c\u53ef\u4ee5\u4f7f\u7528 extern \"C\" {...} \u4fee\u9970\u9700\u8981\u5bfc\u51fa\u7684\u51fd\u6570 \u6a21\u677f \u00b6 // interface.h # ifndef INTERFACE_H # define INTERFACE_H # ifdef _WIN32 # ifdef INTERFACE_LIB # define INTERFACE_EXPORT __declspec(dllexport) # else # define INTERFACE_EXPORT __declspec(dllimport) # endif # define INTERFACE_EXPORT_C __stdcall # endif # ifdef linux # define INTERFACE_EXPORT # define INTERFACE_EXPORT_C # endif // exported class class INTERFACE_EXPORT FOO{ ... }; // exported functions extern \"C\" { void INTERFACE_EXPORT_C bar(); } # endif ``` ``` // interface.cpp # define INTERFACE_LIB # include \"interface.h\" // exported class FOO::FOO() { ... } void FOO::foo() { ... } // exported functions void INTERFACE_EXPORT_C bar() { ... }","title":"\u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f"},{"location":"2017-10-10-%E5%85%BC%E5%AE%B9Windows%E5%92%8CLinux%E7%9A%84C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93%E6%A8%A1%E6%9D%BF/#windowslinuxc","text":"\u53d1\u5e03\u4e8e\uff1a2017-10-10 | \u5206\u7c7b\uff1a python/vba/cpp","title":"\u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f"},{"location":"2017-10-10-%E5%85%BC%E5%AE%B9Windows%E5%92%8CLinux%E7%9A%84C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93%E6%A8%A1%E6%9D%BF/#_1","text":"Windows\u4e0b\u53ef\u4ee5\u4f7f\u7528 __declspec() \u4fee\u9970\u7c7b\u7684\u5bfc\u51fa\u548c\u5bfc\u5165\uff0c\u4f7f\u7528 __stdcall \u4fee\u9970\u5bfc\u51fa\u51fd\u6570 Linux\u5e73\u53f0\u65e0\u9700\u6307\u5b9a\u5bfc\u5165\u5bfc\u51fa\u7c7b\u65f6\u65e0\u9700\u6307\u5b9a\u4ee5\u4e0a\u4fee\u9970\u540d\u79f0 \u8003\u8651\u5230C++\u7684 Name Mangling \uff0c\u53ef\u4ee5\u4f7f\u7528 extern \"C\" {...} \u4fee\u9970\u9700\u8981\u5bfc\u51fa\u7684\u51fd\u6570","title":"\u5173\u952e\u70b9"},{"location":"2017-10-10-%E5%85%BC%E5%AE%B9Windows%E5%92%8CLinux%E7%9A%84C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93%E6%A8%A1%E6%9D%BF/#_2","text":"// interface.h # ifndef INTERFACE_H # define INTERFACE_H # ifdef _WIN32 # ifdef INTERFACE_LIB # define INTERFACE_EXPORT __declspec(dllexport) # else # define INTERFACE_EXPORT __declspec(dllimport) # endif # define INTERFACE_EXPORT_C __stdcall # endif # ifdef linux # define INTERFACE_EXPORT # define INTERFACE_EXPORT_C # endif // exported class class INTERFACE_EXPORT FOO{ ... }; // exported functions extern \"C\" { void INTERFACE_EXPORT_C bar(); } # endif ``` ``` // interface.cpp # define INTERFACE_LIB # include \"interface.h\" // exported class FOO::FOO() { ... } void FOO::foo() { ... } // exported functions void INTERFACE_EXPORT_C bar() { ... }","title":"\u6a21\u677f"},{"location":"2017-11-25-VBA%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/","text":"VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-11-25 | \u5206\u7c7b\uff1a python/vba/cpp \u95ee\u9898\u6765\u6e90\u4e8e\u4e00\u4e2a\u5b9e\u9645\u5e94\u7528\u573a\u666f\uff1aVBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u8be5\u94fe\u63a5\u5e93\u4f7f\u7528 QtNetwork \u53d1\u8d77Https\u8bf7\u6c42\u548c\u83b7\u53d6\u54cd\u5e94\u6570\u636e\u3002 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5047\u8bbe\u81ea\u5b9a\u4e49\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u4e3a test.dll \uff0c\u5219 test.dll \u4f9d\u8d56\u4e8e Qt5Core.dll \u3001 Qt5Network.dll \u7b49Qt\u6a21\u5757\u94fe\u63a5\u5e93\uff0c\u800c Qt5Network.dll \u5219\u9700\u8981SSL\u652f\u6301\u5373\u4f9d\u8d56\u4e8e libeay32.dll \u548c ssleay32.dll \u3002 \u90e8\u7f72\u9636\u6bb5\uff0c Qt5Core.dll \u548c Qt5Network.dll \u663e\u7136\u5fc5\u987b\u4f4d\u4e8e test.dll \u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\uff1b\u800c\u5c06 libeay32.dll \u548c ssleay32.dll \u653e\u5728\u8be5\u76ee\u5f55\u5219\u4e0d\u8d77\u4f5c\u7528\u3002 \u731c\u6d4b\u539f\u56e0\uff1a\u7cfb\u7edf\u641c\u7d22 libeay32.dll \u548c ssleay32.dll \u7684\u76ee\u5f55\u662f\u7cfb\u7edf\u8def\u5f84\u6216\u8005\u8c03\u7528\u8005\u5373 Qt5Network.dll \u6240\u5728\u76ee\u5f55\uff0c\u800c\u5f53\u524d\u6240\u5728\u7684\u53ea\u662f test.dll \u7684\u76ee\u5f55\u3002\u867d\u7136 Qt5Network.dll \u4e5f\u5728\u5f53\u524d\u76ee\u5f55\uff0c\u4f46\u5b83\u5374\u662f\u4f5c\u4e3a test.dll \u7684\u4f9d\u8d56\u5e93\u88ab\u67e5\u627e\u5230\u7684\uff0c\u7cfb\u7edf\u5e76\u4e0d\u76f4\u63a5\u8bc6\u522b\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 Qt5Network.dll \u3002 \u76f4\u63a5\u7684\u89e3\u51b3\u65b9\u6cd5\u4e3a\u5c06 libeay32.dll \u548c ssleay32.dll \u4fdd\u5b58\u4e8e\u7cfb\u7edf\u8def\u5f84\uff0c\u4f8b\u598232-bit\u7684 C:\\Windows\\System32 \u621664-bit\u7684 C:\\Windows\\SysWOW64 \u3002\u4f46\u662f\uff0c\u6b64\u65b9\u6cd5\u5bf9\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\u65e0\u6548\uff08\u6bd5\u7adf\u5de5\u4f5c\u4e2d\u4f7f\u7528\u7684\u7535\u8111\u4e0d\u4e00\u5b9a\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002\u90a3\u4e48\uff0c\u8003\u8651\u5c06\u5f53\u524d\u76ee\u5f55\u6dfb\u52a0\u5230\u7cfb\u7edf\u641c\u7d22\u8def\u5f84\u5373 path \u73af\u5883\u53d8\u91cf\u4e2d\u3002\u867d\u7136\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\uff0c\u6211\u4eec\u5374\u53ef\u4ee5\u8bbe\u7f6e \u7528\u6237\u73af\u5883\u53d8\u91cf \u3002 VBA\u793a\u4f8b \u00b6 \u5bf9\u4e8e\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\uff0c\u7ba1\u7406\u7528\u6237\u73af\u5883\u53d8\u91cf\u7684\u64cd\u4f5c\u6d41\u7a0b\uff1a \u63a7\u5236\u9762\u677f -> \u7528\u6237\u8d26\u6237 -> \u7528\u6237\u8d26\u6237 -> \u66f4\u6539\u6211\u7684\u73af\u5883\u53d8\u91cf \u3002 Dim objUserEnv As Object, strPath$, strNewPath$ Set objUserEnv = createObject(\"WScript.Shell\").Environment(\"User\") strNewPath = \"path/to/be/added\" strPath = objUserEnv.Item(\"path\") ' \u83b7\u53d6 objUserEnv.Item(\"path\") = strPath & \";\" & strNewPath ' \u8bbe\u7f6e \u53e6\u5916\uff0c\u5982\u679c\u53ea\u662f\u83b7\u53d6\u73af\u5883\u53d8\u91cf\uff08\u5305\u62ec\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a ' \u7efc\u5408\u7cfb\u7edfpath\u53d8\u91cf\u8def\u5f84\u53ca\u7528\u6237path\u53d8\u91cf\u8def\u5f84 strPath = Environ(\"path\") \u547d\u4ee4\u884c\u8bbe\u7f6e\u4e34\u65f6\u73af\u5883\u53d8\u91cf \u00b6 set \u53ef\u4ee5\u8bbe\u7f6e\u4e34\u65f6\u73af\u5883\u53d8\u91cf\uff0c\u5373\u4ec5\u5728\u5f53\u524d\u547d\u4ee4\u7a97\u53e3\u751f\u6548 rem \u663e\u793apath\u73af\u5883\u53d8\u91cf set path rem \u8bbe\u7f6e\u7a7a\u503c\u5373\u5220\u9664\u73af\u5883\u53d8\u91cf set path= rem \u5728path\u73af\u5883\u53d8\u91cf\u5185\u5bb9\u4e4b\u524d\u6dfb\u52a0\u8def\u5f84new/path set path=\"%path% new/path;\" \u547d\u4ee4\u884c\u8bbe\u7f6e\u6c38\u4e45\u73af\u5883\u53d8\u91cf \u00b6 setx \u8bbe\u7f6e\u6c38\u4e45\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5e76\u4e14\u53ef\u4ee5\u8bbe\u7f6e\u7528\u6237/\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\uff0c\u5341\u5206\u9002\u7528\u4e8e\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\u3002\u6ce8\u610f\uff0c setx \u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u5c06\u5728\u4e0b\u6b21\u6253\u5f00\u547d\u4ee4\u7a97\u53e3\u65f6\u751f\u6548\u3002 rem \u8bbe\u7f6e\u5f53\u524d\u7528\u6237\u7684\u73af\u5883\u53d8\u91cf setx ENV_NAME env_value rem \u8bbe\u7f6e\u7cfb\u7edf\u73af\u5883\u53d8\u91cf set ENV_NAME env_value /m rem \u8bbe\u7f6e\u7a7a\u503c\u5373\u5220\u9664\u73af\u5883\u53d8\u91cf setx ENV_NAME \"\" \u76f4\u63a5\u8bbe\u7f6e\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4f1a\u9047\u5230\u5982\u4e0b\u9519\u8bef\u63d0\u793a\uff1a C:\\Users\\TRAIN>setx TRAIN 123 /m \u9519\u8bef: \u62d2\u7edd\u8bbf\u95ee\u6ce8\u518c\u8868\u8def\u5f84\u3002 \u8fd9\u65f6\u9700\u8981\u542f\u7528\u5177\u5907\u7cfb\u7edf\u7ba1\u7406\u5458\u6743\u9650\u7684\u7ec8\u7aef\uff0c\u4ee5 Win10 \u4e3a\u4f8b\uff0c\u53f3\u952e\u5de6\u4e0b\u89d2\u5f00\u59cb\u83dc\u5355\uff0c\u9009\u62e9\u201cWindows PowerShell(\u7ba1\u7406\u5458)\u201d\u5373\u53ef\u3002","title":"VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf"},{"location":"2017-11-25-VBA%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/#vba","text":"\u53d1\u5e03\u4e8e\uff1a2017-11-25 | \u5206\u7c7b\uff1a python/vba/cpp \u95ee\u9898\u6765\u6e90\u4e8e\u4e00\u4e2a\u5b9e\u9645\u5e94\u7528\u573a\u666f\uff1aVBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u8be5\u94fe\u63a5\u5e93\u4f7f\u7528 QtNetwork \u53d1\u8d77Https\u8bf7\u6c42\u548c\u83b7\u53d6\u54cd\u5e94\u6570\u636e\u3002","title":"VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf"},{"location":"2017-11-25-VBA%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/#_1","text":"\u5047\u8bbe\u81ea\u5b9a\u4e49\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u4e3a test.dll \uff0c\u5219 test.dll \u4f9d\u8d56\u4e8e Qt5Core.dll \u3001 Qt5Network.dll \u7b49Qt\u6a21\u5757\u94fe\u63a5\u5e93\uff0c\u800c Qt5Network.dll \u5219\u9700\u8981SSL\u652f\u6301\u5373\u4f9d\u8d56\u4e8e libeay32.dll \u548c ssleay32.dll \u3002 \u90e8\u7f72\u9636\u6bb5\uff0c Qt5Core.dll \u548c Qt5Network.dll \u663e\u7136\u5fc5\u987b\u4f4d\u4e8e test.dll \u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\uff1b\u800c\u5c06 libeay32.dll \u548c ssleay32.dll \u653e\u5728\u8be5\u76ee\u5f55\u5219\u4e0d\u8d77\u4f5c\u7528\u3002 \u731c\u6d4b\u539f\u56e0\uff1a\u7cfb\u7edf\u641c\u7d22 libeay32.dll \u548c ssleay32.dll \u7684\u76ee\u5f55\u662f\u7cfb\u7edf\u8def\u5f84\u6216\u8005\u8c03\u7528\u8005\u5373 Qt5Network.dll \u6240\u5728\u76ee\u5f55\uff0c\u800c\u5f53\u524d\u6240\u5728\u7684\u53ea\u662f test.dll \u7684\u76ee\u5f55\u3002\u867d\u7136 Qt5Network.dll \u4e5f\u5728\u5f53\u524d\u76ee\u5f55\uff0c\u4f46\u5b83\u5374\u662f\u4f5c\u4e3a test.dll \u7684\u4f9d\u8d56\u5e93\u88ab\u67e5\u627e\u5230\u7684\uff0c\u7cfb\u7edf\u5e76\u4e0d\u76f4\u63a5\u8bc6\u522b\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 Qt5Network.dll \u3002 \u76f4\u63a5\u7684\u89e3\u51b3\u65b9\u6cd5\u4e3a\u5c06 libeay32.dll \u548c ssleay32.dll \u4fdd\u5b58\u4e8e\u7cfb\u7edf\u8def\u5f84\uff0c\u4f8b\u598232-bit\u7684 C:\\Windows\\System32 \u621664-bit\u7684 C:\\Windows\\SysWOW64 \u3002\u4f46\u662f\uff0c\u6b64\u65b9\u6cd5\u5bf9\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\u65e0\u6548\uff08\u6bd5\u7adf\u5de5\u4f5c\u4e2d\u4f7f\u7528\u7684\u7535\u8111\u4e0d\u4e00\u5b9a\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\uff09\u3002\u90a3\u4e48\uff0c\u8003\u8651\u5c06\u5f53\u524d\u76ee\u5f55\u6dfb\u52a0\u5230\u7cfb\u7edf\u641c\u7d22\u8def\u5f84\u5373 path \u73af\u5883\u53d8\u91cf\u4e2d\u3002\u867d\u7136\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\uff0c\u6211\u4eec\u5374\u53ef\u4ee5\u8bbe\u7f6e \u7528\u6237\u73af\u5883\u53d8\u91cf \u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"2017-11-25-VBA%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/#vba_1","text":"\u5bf9\u4e8e\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\uff0c\u7ba1\u7406\u7528\u6237\u73af\u5883\u53d8\u91cf\u7684\u64cd\u4f5c\u6d41\u7a0b\uff1a \u63a7\u5236\u9762\u677f -> \u7528\u6237\u8d26\u6237 -> \u7528\u6237\u8d26\u6237 -> \u66f4\u6539\u6211\u7684\u73af\u5883\u53d8\u91cf \u3002 Dim objUserEnv As Object, strPath$, strNewPath$ Set objUserEnv = createObject(\"WScript.Shell\").Environment(\"User\") strNewPath = \"path/to/be/added\" strPath = objUserEnv.Item(\"path\") ' \u83b7\u53d6 objUserEnv.Item(\"path\") = strPath & \";\" & strNewPath ' \u8bbe\u7f6e \u53e6\u5916\uff0c\u5982\u679c\u53ea\u662f\u83b7\u53d6\u73af\u5883\u53d8\u91cf\uff08\u5305\u62ec\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a ' \u7efc\u5408\u7cfb\u7edfpath\u53d8\u91cf\u8def\u5f84\u53ca\u7528\u6237path\u53d8\u91cf\u8def\u5f84 strPath = Environ(\"path\")","title":"VBA\u793a\u4f8b"},{"location":"2017-11-25-VBA%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/#_2","text":"set \u53ef\u4ee5\u8bbe\u7f6e\u4e34\u65f6\u73af\u5883\u53d8\u91cf\uff0c\u5373\u4ec5\u5728\u5f53\u524d\u547d\u4ee4\u7a97\u53e3\u751f\u6548 rem \u663e\u793apath\u73af\u5883\u53d8\u91cf set path rem \u8bbe\u7f6e\u7a7a\u503c\u5373\u5220\u9664\u73af\u5883\u53d8\u91cf set path= rem \u5728path\u73af\u5883\u53d8\u91cf\u5185\u5bb9\u4e4b\u524d\u6dfb\u52a0\u8def\u5f84new/path set path=\"%path% new/path;\"","title":"\u547d\u4ee4\u884c\u8bbe\u7f6e\u4e34\u65f6\u73af\u5883\u53d8\u91cf"},{"location":"2017-11-25-VBA%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/#_3","text":"setx \u8bbe\u7f6e\u6c38\u4e45\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5e76\u4e14\u53ef\u4ee5\u8bbe\u7f6e\u7528\u6237/\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\uff0c\u5341\u5206\u9002\u7528\u4e8e\u4e0d\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\u3002\u6ce8\u610f\uff0c setx \u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u5c06\u5728\u4e0b\u6b21\u6253\u5f00\u547d\u4ee4\u7a97\u53e3\u65f6\u751f\u6548\u3002 rem \u8bbe\u7f6e\u5f53\u524d\u7528\u6237\u7684\u73af\u5883\u53d8\u91cf setx ENV_NAME env_value rem \u8bbe\u7f6e\u7cfb\u7edf\u73af\u5883\u53d8\u91cf set ENV_NAME env_value /m rem \u8bbe\u7f6e\u7a7a\u503c\u5373\u5220\u9664\u73af\u5883\u53d8\u91cf setx ENV_NAME \"\" \u76f4\u63a5\u8bbe\u7f6e\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4f1a\u9047\u5230\u5982\u4e0b\u9519\u8bef\u63d0\u793a\uff1a C:\\Users\\TRAIN>setx TRAIN 123 /m \u9519\u8bef: \u62d2\u7edd\u8bbf\u95ee\u6ce8\u518c\u8868\u8def\u5f84\u3002 \u8fd9\u65f6\u9700\u8981\u542f\u7528\u5177\u5907\u7cfb\u7edf\u7ba1\u7406\u5458\u6743\u9650\u7684\u7ec8\u7aef\uff0c\u4ee5 Win10 \u4e3a\u4f8b\uff0c\u53f3\u952e\u5de6\u4e0b\u89d2\u5f00\u59cb\u83dc\u5355\uff0c\u9009\u62e9\u201cWindows PowerShell(\u7ba1\u7406\u5458)\u201d\u5373\u53ef\u3002","title":"\u547d\u4ee4\u884c\u8bbe\u7f6e\u6c38\u4e45\u73af\u5883\u53d8\u91cf"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/","text":"VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-11-30 | \u5206\u7c7b\uff1a python/vba/cpp Excel\u7684VBA\u53ef\u4ee5\u4f7f\u7528 Declare Function \u8bed\u53e5\u76f4\u63a5\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u672c\u6587\u4ecb\u7ecd\u6b64\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u6d89\u53ca\u7684\u53c2\u6570\u4f20\u9012\u3001\u5bfc\u5165\u8def\u5f84\u3001\u94fe\u63a5\u5e93\u4f4d\u6570\u7b49\u65b9\u9762\u7684\u95ee\u9898\u3002 \u57fa\u672c\u8bed\u53e5 \u00b6 ' 64 bit dll Private Declare PtrSafe Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] ' 32 bit dll Private Declare Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] \u4ee5\u4e0a\u793a\u4f8b\u5355\u4e2a\u51fd\u6570\u7684\u5bfc\u5165\uff0c\u540c\u7406\u5bfc\u5165\u540c\u4e00\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u5176\u4ed6\u51fd\u6570 Private \u9650\u5b9a\u5728 module \u4e2d\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u51fd\u6570\uff0c\u4e0d\u5141\u8bb8\u76f4\u63a5\u5728\u516c\u5f0f\u680f\u4f7f\u7528\uff1b\u5426\u5219\u53ef\u4ee5\u76f4\u63a5\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f PtrSafe \u8868\u660e\u9488\u5bf964-bit\u7248\u672cExcel\u8f6f\u4ef6 path_to_dll \u6307\u5b9a\u52a0\u8f7dDLL\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\uff0c\u5fc5\u987b\u4e3a\u5b57\u7b26\u4e32\u5e38\u91cf\uff0c\u4e0d\u5141\u8bb8\u62fc\u63a5\u52a8\u6001\u8def\u5f84 \u5199\u660eDLL\u6587\u4ef6\u540d\uff0c\u7136\u540e\u4ece\u9ed8\u8ba4\u4f4d\u7f6e\u52a0\u8f7d DLL\u52a0\u8f7d\u8def\u5f84 \u00b6 \u4e3a\u907f\u514d\u786c\u7f16\u7801\u7edd\u5bf9\u8def\u5f84\uff0c\u91c7\u7528 Declare \u65b9\u5f0f\u5f15\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u51fd\u6570\u65f6\u4e00\u822c\u53ea\u6307\u5b9a\u5176\u6587\u4ef6\u540d\uff0c\u7136\u540e\u5c3d\u91cf\u5c06\u5176\u6240\u5728\u76ee\u5f55\u52a0\u8f7d\u5230\u9ed8\u8ba4\u641c\u7d22\u8def\u5f84\u4e2d\u53bb\u3002\u4f8b\u5982\u5f15\u7528Excel\u540c\u7ea7 bin \u6587\u4ef6\u5939\u4e0b\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u6587\u4ef6 bar.dll \uff1a Private Declare PtrSafe Function foo Lib \"bar.dll\" () As Double \u65b9\u5f0f\u4e00\uff1a\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 \u00b6 Excel \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 \u5e76\u4e0d\u4e00\u5b9a\u662fExcel\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0c\u800c\u662f\u901a\u8fc7 ChDir() \u51fd\u6570\u6765\u52a8\u6001\u8bbe\u7f6e\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6240\u6709\u6253\u5f00\u7684Excel\u5de5\u4f5c\u7c3f\u5171\u4eab\u540c\u4e00\u4e2a\u5de5\u4f5c\u76ee\u5f55\uff0c\u5e76\u4e14\u67d0\u4e9b\u624b\u52a8\u64cd\u4f5c\u4f8b\u5982\u6d4f\u89c8\u6587\u4ef6\u53ef\u80fd\u6539\u53d8\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff0c \u56e0\u6b64\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5b58\u5728\u4e00\u5b9a\u98ce\u9669\u3002\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u6bcf\u6b21\u6fc0\u6d3b\u5f53\u524d\u5de5\u4f5c\u7c3f\u65f6\u90fd\u91cd\u7f6e\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u5230\u76ee\u6807\u4f4d\u7f6e\u6765\u5c3d\u53ef\u80fd\u907f\u514d\u4e0d\u671f\u671b\u7684\u5de5\u4f5c\u76ee\u5f55\u6539\u53d8\uff1a Private Sub Workbook_Activate() Dim DLLPath As String ' set current path to load DLL DLLPath = ThisWorkbook.Path & \"\\bin\" ChDrive Left$(ThisWorkbook.Path, 1) If Dir(DLLPath, 16) <> Empty Then ChDir DLLPath End Sub \u4ee5\u4e0a\u4ee3\u7801\u4e2d ChDrive \u8fdb\u5165\u5355\u4e2a\u5b57\u7b26\u8868\u793a\u7684\u76d8\u7b26\uff0c\u4f8b\u5982C\u76d8\u3001D\u76d8\uff1b\u4e00\u65e6\u4e0d\u6ee1\u8db3\u6b64\u6761\u4ef6\uff0c\u4f8b\u5982\u5904\u5728\u7f51\u7edc\u6587\u4ef6\u5939 \\\\server\\this\\that \uff0c\u5219\u4f1a\u51fa\u9519\u3002\u6240\u4ee5\uff0c\u8981\u4e48\u907f\u514d\u7f51\u7edc\u8def\u5f84\uff0c\u8981\u4e48\u5c06\u7f51\u7edc\u8def\u5f84\u6620\u5c04\u5230\u5355\u5b57\u7b26\u7684\u76d8\u7b26\u3002 \u65b9\u5f0f\u4e8c\uff1aPATH\u73af\u5883\u53d8\u91cf \u00b6 \u66f4\u7a33\u5b9a\u7684\u65b9\u5f0f\u662f\u5c06\u52a8\u6001\u94fe\u63a5\u5e93\u6240\u5728\u8def\u5f84\u52a0\u5230 PATH \u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u3002\u597d\u5904\u662f\u65e0\u9700\u589e\u52a0\u989d\u5916\u7684\u4ee3\u7801\uff0c\u4e0d\u8db3\u662f\u9700\u8981\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u540e\u624d\u80fd\u6b63\u786e\u4f7f\u7528\u3002 \u65b9\u5f0f\u4e09\uff1a LoadLibrary \u52a8\u6001\u52a0\u8f7d \u00b6 Declare \u58f0\u660e\u4e2d\u4e0d\u80fd\u4f7f\u7528\u52a8\u6001\u8def\u5f84\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u501f\u52a9Windows API LoadLibrary \u6765\u5b9e\u73b0\u3002\u4e3b\u8981\u6b65\u9aa4\u4e3a\uff1a \u8c03\u7528 LoadLibrary \u52a0\u8f7d\u52a8\u6001\u62fc\u63a5\u8def\u5f84\u8868\u793a\u7684DLL \u6309\u7167\u5e38\u89c4\u65b9\u5f0f Declare \u58f0\u660e\u548c\u4f7f\u7528DLL\u4e2d\u7684API \u8c03\u7528 FreeLibrary \u91ca\u653eDLL ' -------- ' module: ThisWorkbook: load/free DLL when open/close workbook ' -------- Private Declare Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As Long Private Declare Function FreeLibrary Lib \"kernel32\" (ByVal hLibModule As Long) As Long Public hModule As Long ' load DLL when open workbook Private Sub Workbook_Open() Dim DLLPath As String DLLPath = ThisWorkbook.path & \"\\bin\\bar.dll\" hModule = LoadLibrary(DLLPath) If hModule <= 0 Then MsgBox \"load dll error\" End Sub ' release DLL whe close Private Sub Workbook_BeforeClose(Cancel As Boolean) If hModule > 0 Then FreeLibrary hModule End Sub \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6b63\u786e\u52a0\u8f7d\u4e86 bar.dll \uff0c\u56e0\u6b64\u5176\u4ed6\u6a21\u5757\u4e2d\u5373\u53ef\u6309\u5e38\u89c4\u65b9\u5f0f\u4f7f\u7528\u51fd\u6570 foo \uff1a Private Declare Function foo Lib \"bar.dll\" () As Double Sub test() Debug.Print foo() End Sub \u53c2\u6570\u7c7b\u578b\u5bf9\u5e94 \u00b6 VBA \u4e0e C++ \u4e2d\u57fa\u672c\u53c2\u6570\u7c7b\u578b\u7684\u5bf9\u5e94\u5173\u7cfb\uff1a C++ VBA int Long bool Integer float Single double Double char* String \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8e C++ \u4e2d\u6570\u7ec4\u7c7b\u578b\u7684\u53d8\u91cf\uff0c VBA \u4e2d\u9700\u8981\u58f0\u660e\u4e3a\u5f15\u7528 Byref \uff0c\u4f7f\u7528\u65f6\u4f20\u5165\u6570\u7ec4\u53c2\u6570\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5373\u53ef\uff0c\u53c2\u8003\u4f8b\u5b50\uff1a // C++ test.dll int __stdcall foo(float*, float[]); ' VBA Declare Function foo lib \"path/to/test.dll\" (Byref a!, Byref b!) As Long Dim a(2), b(3) call foo(a(0), b(0)) \u5176\u4e2d ! \u662f VBA \u4e2d float \u7c7b\u578b\u7684\u7b80\u5199\uff0c\u5176\u4ed6\u7684\u8fd8\u6709\uff1a Integer(%) Long(&) float(!) double(#) string($) \u51fd\u6570\u540d\u79f0 \u00b6 C++ \u4e2d\u51fd\u6570\u540d\u6df7\u80b4\u673a\u5236\u5c06\u5bfc\u81f4\u7f16\u8bd1\u540e\u7684\u51fd\u6570\u540d\u4e0e\u6e90\u7801\u4e2d\u7684\u4e0d\u540c\uff0c\u4e3a\u4e86\u907f\u514d\u6b64\u7c7b\u8f6c\u6362\uff0c\u53ef\u4ee5\u8bbe\u7f6e .def \u6587\u4ef6\uff0c\u57fa\u672c\u683c\u5f0f\u53c2\u8003\uff1a LIBRARY [library name] EXPORTS [user_defined_exported_name_1] = [function_name_in_source_code_1] [user_defined_exported_name_2] = [function_name_in_source_code_2] \u4ee5\u4e0a\u5185\u5bb9\u4e2d [] \u8868\u793a\u9700\u8981\u586b\u5165\u7684\u5185\u5bb9\uff08 [] \u672c\u8eab\u5e76\u4e0d\u9700\u8981\uff09 \u7136\u540e\u5728 Visual Studio \u4e2d\u7f16\u8bd1\u524d\u901a\u8fc7 Configuration -> Properties -> Linker -> InputModule Definition File \u6307\u5b9a\u81ea\u5b9a\u4e49\u7684 .def \u6587\u4ef6\u5373\u53ef\u3002 Excel\u7248\u672c\u4e0e\u52a8\u6001\u94fe\u63a5\u5e93\u7248\u672c \u00b6 Excel\u8f6f\u4ef6\uff08\u800c\u975e\u64cd\u4f5c\u7cfb\u7edf\uff09\u4f4d\u6570\u5fc5\u987b\u4e0e\u7f16\u8bd1\u52a8\u6001\u94fe\u63a5\u5e93\u65f6\u9009\u62e9\u7684\u5e73\u53f0\u4f4d\u6570\u4e00\u81f4 \uff0c\u5426\u5219\u5bfc\u5165\u51fd\u6570\u65f6\u5c06\u4f1a\u63d0\u793a\uff1a Error 48: file can not be found. \u6b64\u524d\u4e00\u4e2a\u6848\u4f8b\u6d89\u53ca Qt \u5e93\u7684 QNetwork \u6a21\u5757\uff0c\u76f8\u5173\u7684\u4e24\u70b9\u5ef6\u4f38\uff1a \u4e3a\u4e86\u6210\u529f\u7f16\u8bd1\u51fa32-bit\u548c64-bit\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u9700\u8981\u540c\u65f6\u5b89\u88c532-bit\u548c64-bit\u7684 Qt \u5e93\uff0c\u5728\u7f16\u8bd1\u65f6\u6307\u5b9a\u76f8\u5e94\u7248\u672c\u7684\u5e93 QNetwork \u7684https\u8bbf\u95ee\u9700\u8981\u7528\u5230SSL\u8ba4\u8bc1\uff0c\u56e0\u6b64\u9700\u8981\u63d0\u4f9b\u76f8\u5e94\u5e93\u51fd\u6570\uff0c\u4f8b\u5982 libeay32.dll \u548c ssleay32.dll \uff0c\u540c\u65f6\u8981\u6c42\u76f8\u5e94\u7684\u4f4d\u6570\u5fc5\u987b\u4e00\u81f4 \u53e6\u5916\uff0c32\u4f4d/64\u4f4dExcel\u4e4b\u524d\u8fc1\u79fb\u4ee3\u7801\u9700\u8981\u6ce8\u610f\uff1a 32\u4f4d\u7684\u6307\u9488\u5730\u5740\u7c7b\u578b Long \u5bf9\u5e9464\u4f4d\u7684 LongPtr \u5bf9\u4e8e32\u4f4dExcel\uff0c Declare \u58f0\u660e\u7684API\u540c\u65f6\u4f1aVBA\u548c\u5de5\u4f5c\u8868\u5355\u5143\u683c\u6709\u6548\uff1b\u5bf964\u4f4dExcel\uff0c\u76f4\u63a5\u58f0\u660e\u7684API\u9700\u8981\u7ecf\u8fc7VBA\u51fd\u6570\u7684\u5305\u88c5\u624d\u80fd\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f \u53c2\u8003\u8d44\u6599 \u00b6 Programmatically set DLL search path in VBA macro How to call C functions from Excel using a DLL written in C (or C++) Excel 2013 64 bit: can not call DLL from worksheet (arguments are passed incorrectly)","title":"VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#vbac","text":"\u53d1\u5e03\u4e8e\uff1a2017-11-30 | \u5206\u7c7b\uff1a python/vba/cpp Excel\u7684VBA\u53ef\u4ee5\u4f7f\u7528 Declare Function \u8bed\u53e5\u76f4\u63a5\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u672c\u6587\u4ecb\u7ecd\u6b64\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u6d89\u53ca\u7684\u53c2\u6570\u4f20\u9012\u3001\u5bfc\u5165\u8def\u5f84\u3001\u94fe\u63a5\u5e93\u4f4d\u6570\u7b49\u65b9\u9762\u7684\u95ee\u9898\u3002","title":"VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#_1","text":"' 64 bit dll Private Declare PtrSafe Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] ' 32 bit dll Private Declare Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] \u4ee5\u4e0a\u793a\u4f8b\u5355\u4e2a\u51fd\u6570\u7684\u5bfc\u5165\uff0c\u540c\u7406\u5bfc\u5165\u540c\u4e00\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u5176\u4ed6\u51fd\u6570 Private \u9650\u5b9a\u5728 module \u4e2d\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u51fd\u6570\uff0c\u4e0d\u5141\u8bb8\u76f4\u63a5\u5728\u516c\u5f0f\u680f\u4f7f\u7528\uff1b\u5426\u5219\u53ef\u4ee5\u76f4\u63a5\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f PtrSafe \u8868\u660e\u9488\u5bf964-bit\u7248\u672cExcel\u8f6f\u4ef6 path_to_dll \u6307\u5b9a\u52a0\u8f7dDLL\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\uff0c\u5fc5\u987b\u4e3a\u5b57\u7b26\u4e32\u5e38\u91cf\uff0c\u4e0d\u5141\u8bb8\u62fc\u63a5\u52a8\u6001\u8def\u5f84 \u5199\u660eDLL\u6587\u4ef6\u540d\uff0c\u7136\u540e\u4ece\u9ed8\u8ba4\u4f4d\u7f6e\u52a0\u8f7d","title":"\u57fa\u672c\u8bed\u53e5"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#dll","text":"\u4e3a\u907f\u514d\u786c\u7f16\u7801\u7edd\u5bf9\u8def\u5f84\uff0c\u91c7\u7528 Declare \u65b9\u5f0f\u5f15\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u51fd\u6570\u65f6\u4e00\u822c\u53ea\u6307\u5b9a\u5176\u6587\u4ef6\u540d\uff0c\u7136\u540e\u5c3d\u91cf\u5c06\u5176\u6240\u5728\u76ee\u5f55\u52a0\u8f7d\u5230\u9ed8\u8ba4\u641c\u7d22\u8def\u5f84\u4e2d\u53bb\u3002\u4f8b\u5982\u5f15\u7528Excel\u540c\u7ea7 bin \u6587\u4ef6\u5939\u4e0b\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u6587\u4ef6 bar.dll \uff1a Private Declare PtrSafe Function foo Lib \"bar.dll\" () As Double","title":"DLL\u52a0\u8f7d\u8def\u5f84"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#_2","text":"Excel \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 \u5e76\u4e0d\u4e00\u5b9a\u662fExcel\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0c\u800c\u662f\u901a\u8fc7 ChDir() \u51fd\u6570\u6765\u52a8\u6001\u8bbe\u7f6e\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6240\u6709\u6253\u5f00\u7684Excel\u5de5\u4f5c\u7c3f\u5171\u4eab\u540c\u4e00\u4e2a\u5de5\u4f5c\u76ee\u5f55\uff0c\u5e76\u4e14\u67d0\u4e9b\u624b\u52a8\u64cd\u4f5c\u4f8b\u5982\u6d4f\u89c8\u6587\u4ef6\u53ef\u80fd\u6539\u53d8\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff0c \u56e0\u6b64\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5b58\u5728\u4e00\u5b9a\u98ce\u9669\u3002\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u6bcf\u6b21\u6fc0\u6d3b\u5f53\u524d\u5de5\u4f5c\u7c3f\u65f6\u90fd\u91cd\u7f6e\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u5230\u76ee\u6807\u4f4d\u7f6e\u6765\u5c3d\u53ef\u80fd\u907f\u514d\u4e0d\u671f\u671b\u7684\u5de5\u4f5c\u76ee\u5f55\u6539\u53d8\uff1a Private Sub Workbook_Activate() Dim DLLPath As String ' set current path to load DLL DLLPath = ThisWorkbook.Path & \"\\bin\" ChDrive Left$(ThisWorkbook.Path, 1) If Dir(DLLPath, 16) <> Empty Then ChDir DLLPath End Sub \u4ee5\u4e0a\u4ee3\u7801\u4e2d ChDrive \u8fdb\u5165\u5355\u4e2a\u5b57\u7b26\u8868\u793a\u7684\u76d8\u7b26\uff0c\u4f8b\u5982C\u76d8\u3001D\u76d8\uff1b\u4e00\u65e6\u4e0d\u6ee1\u8db3\u6b64\u6761\u4ef6\uff0c\u4f8b\u5982\u5904\u5728\u7f51\u7edc\u6587\u4ef6\u5939 \\\\server\\this\\that \uff0c\u5219\u4f1a\u51fa\u9519\u3002\u6240\u4ee5\uff0c\u8981\u4e48\u907f\u514d\u7f51\u7edc\u8def\u5f84\uff0c\u8981\u4e48\u5c06\u7f51\u7edc\u8def\u5f84\u6620\u5c04\u5230\u5355\u5b57\u7b26\u7684\u76d8\u7b26\u3002","title":"\u65b9\u5f0f\u4e00\uff1a\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#path","text":"\u66f4\u7a33\u5b9a\u7684\u65b9\u5f0f\u662f\u5c06\u52a8\u6001\u94fe\u63a5\u5e93\u6240\u5728\u8def\u5f84\u52a0\u5230 PATH \u73af\u5883\u53d8\u91cf\u4e2d\u53bb\u3002\u597d\u5904\u662f\u65e0\u9700\u589e\u52a0\u989d\u5916\u7684\u4ee3\u7801\uff0c\u4e0d\u8db3\u662f\u9700\u8981\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u540e\u624d\u80fd\u6b63\u786e\u4f7f\u7528\u3002","title":"\u65b9\u5f0f\u4e8c\uff1aPATH\u73af\u5883\u53d8\u91cf"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#loadlibrary","text":"Declare \u58f0\u660e\u4e2d\u4e0d\u80fd\u4f7f\u7528\u52a8\u6001\u8def\u5f84\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u501f\u52a9Windows API LoadLibrary \u6765\u5b9e\u73b0\u3002\u4e3b\u8981\u6b65\u9aa4\u4e3a\uff1a \u8c03\u7528 LoadLibrary \u52a0\u8f7d\u52a8\u6001\u62fc\u63a5\u8def\u5f84\u8868\u793a\u7684DLL \u6309\u7167\u5e38\u89c4\u65b9\u5f0f Declare \u58f0\u660e\u548c\u4f7f\u7528DLL\u4e2d\u7684API \u8c03\u7528 FreeLibrary \u91ca\u653eDLL ' -------- ' module: ThisWorkbook: load/free DLL when open/close workbook ' -------- Private Declare Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As Long Private Declare Function FreeLibrary Lib \"kernel32\" (ByVal hLibModule As Long) As Long Public hModule As Long ' load DLL when open workbook Private Sub Workbook_Open() Dim DLLPath As String DLLPath = ThisWorkbook.path & \"\\bin\\bar.dll\" hModule = LoadLibrary(DLLPath) If hModule <= 0 Then MsgBox \"load dll error\" End Sub ' release DLL whe close Private Sub Workbook_BeforeClose(Cancel As Boolean) If hModule > 0 Then FreeLibrary hModule End Sub \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6b63\u786e\u52a0\u8f7d\u4e86 bar.dll \uff0c\u56e0\u6b64\u5176\u4ed6\u6a21\u5757\u4e2d\u5373\u53ef\u6309\u5e38\u89c4\u65b9\u5f0f\u4f7f\u7528\u51fd\u6570 foo \uff1a Private Declare Function foo Lib \"bar.dll\" () As Double Sub test() Debug.Print foo() End Sub","title":"\u65b9\u5f0f\u4e09\uff1aLoadLibrary\u52a8\u6001\u52a0\u8f7d"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#_3","text":"VBA \u4e0e C++ \u4e2d\u57fa\u672c\u53c2\u6570\u7c7b\u578b\u7684\u5bf9\u5e94\u5173\u7cfb\uff1a C++ VBA int Long bool Integer float Single double Double char* String \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8e C++ \u4e2d\u6570\u7ec4\u7c7b\u578b\u7684\u53d8\u91cf\uff0c VBA \u4e2d\u9700\u8981\u58f0\u660e\u4e3a\u5f15\u7528 Byref \uff0c\u4f7f\u7528\u65f6\u4f20\u5165\u6570\u7ec4\u53c2\u6570\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5373\u53ef\uff0c\u53c2\u8003\u4f8b\u5b50\uff1a // C++ test.dll int __stdcall foo(float*, float[]); ' VBA Declare Function foo lib \"path/to/test.dll\" (Byref a!, Byref b!) As Long Dim a(2), b(3) call foo(a(0), b(0)) \u5176\u4e2d ! \u662f VBA \u4e2d float \u7c7b\u578b\u7684\u7b80\u5199\uff0c\u5176\u4ed6\u7684\u8fd8\u6709\uff1a Integer(%) Long(&) float(!) double(#) string($)","title":"\u53c2\u6570\u7c7b\u578b\u5bf9\u5e94"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#_4","text":"C++ \u4e2d\u51fd\u6570\u540d\u6df7\u80b4\u673a\u5236\u5c06\u5bfc\u81f4\u7f16\u8bd1\u540e\u7684\u51fd\u6570\u540d\u4e0e\u6e90\u7801\u4e2d\u7684\u4e0d\u540c\uff0c\u4e3a\u4e86\u907f\u514d\u6b64\u7c7b\u8f6c\u6362\uff0c\u53ef\u4ee5\u8bbe\u7f6e .def \u6587\u4ef6\uff0c\u57fa\u672c\u683c\u5f0f\u53c2\u8003\uff1a LIBRARY [library name] EXPORTS [user_defined_exported_name_1] = [function_name_in_source_code_1] [user_defined_exported_name_2] = [function_name_in_source_code_2] \u4ee5\u4e0a\u5185\u5bb9\u4e2d [] \u8868\u793a\u9700\u8981\u586b\u5165\u7684\u5185\u5bb9\uff08 [] \u672c\u8eab\u5e76\u4e0d\u9700\u8981\uff09 \u7136\u540e\u5728 Visual Studio \u4e2d\u7f16\u8bd1\u524d\u901a\u8fc7 Configuration -> Properties -> Linker -> InputModule Definition File \u6307\u5b9a\u81ea\u5b9a\u4e49\u7684 .def \u6587\u4ef6\u5373\u53ef\u3002","title":"\u51fd\u6570\u540d\u79f0"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#excel","text":"Excel\u8f6f\u4ef6\uff08\u800c\u975e\u64cd\u4f5c\u7cfb\u7edf\uff09\u4f4d\u6570\u5fc5\u987b\u4e0e\u7f16\u8bd1\u52a8\u6001\u94fe\u63a5\u5e93\u65f6\u9009\u62e9\u7684\u5e73\u53f0\u4f4d\u6570\u4e00\u81f4 \uff0c\u5426\u5219\u5bfc\u5165\u51fd\u6570\u65f6\u5c06\u4f1a\u63d0\u793a\uff1a Error 48: file can not be found. \u6b64\u524d\u4e00\u4e2a\u6848\u4f8b\u6d89\u53ca Qt \u5e93\u7684 QNetwork \u6a21\u5757\uff0c\u76f8\u5173\u7684\u4e24\u70b9\u5ef6\u4f38\uff1a \u4e3a\u4e86\u6210\u529f\u7f16\u8bd1\u51fa32-bit\u548c64-bit\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u9700\u8981\u540c\u65f6\u5b89\u88c532-bit\u548c64-bit\u7684 Qt \u5e93\uff0c\u5728\u7f16\u8bd1\u65f6\u6307\u5b9a\u76f8\u5e94\u7248\u672c\u7684\u5e93 QNetwork \u7684https\u8bbf\u95ee\u9700\u8981\u7528\u5230SSL\u8ba4\u8bc1\uff0c\u56e0\u6b64\u9700\u8981\u63d0\u4f9b\u76f8\u5e94\u5e93\u51fd\u6570\uff0c\u4f8b\u5982 libeay32.dll \u548c ssleay32.dll \uff0c\u540c\u65f6\u8981\u6c42\u76f8\u5e94\u7684\u4f4d\u6570\u5fc5\u987b\u4e00\u81f4 \u53e6\u5916\uff0c32\u4f4d/64\u4f4dExcel\u4e4b\u524d\u8fc1\u79fb\u4ee3\u7801\u9700\u8981\u6ce8\u610f\uff1a 32\u4f4d\u7684\u6307\u9488\u5730\u5740\u7c7b\u578b Long \u5bf9\u5e9464\u4f4d\u7684 LongPtr \u5bf9\u4e8e32\u4f4dExcel\uff0c Declare \u58f0\u660e\u7684API\u540c\u65f6\u4f1aVBA\u548c\u5de5\u4f5c\u8868\u5355\u5143\u683c\u6709\u6548\uff1b\u5bf964\u4f4dExcel\uff0c\u76f4\u63a5\u58f0\u660e\u7684API\u9700\u8981\u7ecf\u8fc7VBA\u51fd\u6570\u7684\u5305\u88c5\u624d\u80fd\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f","title":"Excel\u7248\u672c\u4e0e\u52a8\u6001\u94fe\u63a5\u5e93\u7248\u672c"},{"location":"2017-11-30-VBA%E8%B0%83%E7%94%A8C%2B%2B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/#_5","text":"Programmatically set DLL search path in VBA macro How to call C functions from Excel using a DLL written in C (or C++) Excel 2013 64 bit: can not call DLL from worksheet (arguments are passed incorrectly)","title":"\u53c2\u8003\u8d44\u6599"},{"location":"2017-12-12-NXOpen%EF%BC%9AExpression%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D/","text":"NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d \u00b6 \u53d1\u5e03\u4e8e\uff1a2017-12-12 | \u5206\u7c7b\uff1a CAD/CAE integration \u672c\u6587\u53c2\u8003 NXOpen::Expression Class Reference \uff0c\u8bb0\u5f55NX\u8868\u8fbe\u5f0f\u77e5\u8bc6\u53ca\u76f8\u5173\u7684NX Open C++\u51fd\u6570\u3002 \u8868\u8fbe\u5f0f\u7c7b\u578b\u53ca\u83b7\u53d6\u503c\u7684\u51fd\u6570 \u00b6 \u5e38\u7528\u8868\u8fbe\u5f0f\u7c7b\u578b\u53ca\u83b7\u53d6\u76f8\u5e94\u8868\u8fbe\u5f0f\u7684\u503c\u7684\u6210\u5458\u51fd\u6570\u5982\u4e0b\u8868\u6240\u793a\uff1a \u7c7b\u578b \u65b9\u6cd5 Number Value() String StringValue() Integer IntegerValue() Boolean BooleanValue() Point PointValue() Vector VectorValue() Expression\u7c7b\u7684 Type() \u6210\u5458\u51fd\u6570\u53ef\u4ee5\u8fd4\u56deNXString\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u7c7b\u578b\u540d\u79f0 RightSideHand() \u65b9\u6cd5\u53ef\u4ee5\u8fd4\u56deNXString\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u53f3\u4fa7\u7684\u503c Number\u7c7b\u578b\u4e0eUnits \u00b6 \u4ee5\u4e0a\u7c7b\u578b\u4ec5Number\u7c7b\u578b\u8868\u8fbe\u5f0f\u5e26\u6709Units\uff08Number\u7c7b\u578b\u4e0d\u4e3aConstant\u5373\u8868\u793a\u5e26\u6709\u5355\u4f4d\uff09\u3002\u76f8\u5e94\u5730\uff0c Value() \u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u57fa\u4e8e\u57fa\u672c\u5355\u4f4d\uff08base part unit\uff09\u7684\u503c\u3002\u4e8e\u662f\uff0c\u76f4\u63a5\u4f7f\u7528 Value() \u65b9\u6cd5\u83b7\u53d6\u7684\u8868\u8fbe\u5f0f\u503c\u53ef\u80fd\u548c\u9884\u671f\u4e0d\u4e00\u81f4\u3002 \u4ee5Number\u8868\u8fbe\u5f0fUnit\u4e3aPressure\u4e3a\u4f8b\uff0c\u9009\u62e9\u5355\u4f4d\"PresureNewtonPerSquareMillimeter\"\uff0c\u5373 N/mm^2 \uff0c\u4ea6\u5373 MPa \uff0c\u521b\u5efa\u8868\u8fbe\u5f0f f=2 MPa \uff0c\u4f7f\u7528 Value() \u51fd\u6570\u83b7\u53d6\u7684\u7ed3\u679c\u5374\u662f 2000.0 \u3002\u8fd9\u662f\u56e0\u4e3a\u57fa\u672c\u5355\u4f4d\u662f\"PressurePerUnitLength\"\uff0c\u5373 m*N/mm^3 \uff0c\u4e8e\u662f\uff1a value = 2 m*N/mm^3 = 2000.0 MPa \u540c\u7406\uff0c\u5bf9\u4e8eNumber\u7c7b\u578b\u8868\u8fbe\u5f0f\u7279\u6709\u7684 SetValue(double) \u65b9\u6cd5\uff0c\u4e5f\u662f\u4ee5\u57fa\u672c\u5355\u4f4d\u4e3a\u53c2\u8003\u7684\u6570\u503c\u3002 \u4e3a\u4e86\u907f\u514d\u4ee5\u4e0a\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u51fd\u6570\uff1a GetValueUsingUnits(Expression::UnitOption) \u5373\u6839\u636e\u6307\u5b9a\u5355\u4f4d\u8fd4\u56de\u8868\u8fbe\u5f0f\u7684\u503c\uff0c\u5176\u4e2d Enum UnitOption { UnitOptionBase, UnitOptionExpression }","title":"NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d"},{"location":"2017-12-12-NXOpen%EF%BC%9AExpression%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D/#nxopenexpression","text":"\u53d1\u5e03\u4e8e\uff1a2017-12-12 | \u5206\u7c7b\uff1a CAD/CAE integration \u672c\u6587\u53c2\u8003 NXOpen::Expression Class Reference \uff0c\u8bb0\u5f55NX\u8868\u8fbe\u5f0f\u77e5\u8bc6\u53ca\u76f8\u5173\u7684NX Open C++\u51fd\u6570\u3002","title":"NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d"},{"location":"2017-12-12-NXOpen%EF%BC%9AExpression%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D/#_1","text":"\u5e38\u7528\u8868\u8fbe\u5f0f\u7c7b\u578b\u53ca\u83b7\u53d6\u76f8\u5e94\u8868\u8fbe\u5f0f\u7684\u503c\u7684\u6210\u5458\u51fd\u6570\u5982\u4e0b\u8868\u6240\u793a\uff1a \u7c7b\u578b \u65b9\u6cd5 Number Value() String StringValue() Integer IntegerValue() Boolean BooleanValue() Point PointValue() Vector VectorValue() Expression\u7c7b\u7684 Type() \u6210\u5458\u51fd\u6570\u53ef\u4ee5\u8fd4\u56deNXString\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u7c7b\u578b\u540d\u79f0 RightSideHand() \u65b9\u6cd5\u53ef\u4ee5\u8fd4\u56deNXString\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u53f3\u4fa7\u7684\u503c","title":"\u8868\u8fbe\u5f0f\u7c7b\u578b\u53ca\u83b7\u53d6\u503c\u7684\u51fd\u6570"},{"location":"2017-12-12-NXOpen%EF%BC%9AExpression%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D/#numberunits","text":"\u4ee5\u4e0a\u7c7b\u578b\u4ec5Number\u7c7b\u578b\u8868\u8fbe\u5f0f\u5e26\u6709Units\uff08Number\u7c7b\u578b\u4e0d\u4e3aConstant\u5373\u8868\u793a\u5e26\u6709\u5355\u4f4d\uff09\u3002\u76f8\u5e94\u5730\uff0c Value() \u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u57fa\u4e8e\u57fa\u672c\u5355\u4f4d\uff08base part unit\uff09\u7684\u503c\u3002\u4e8e\u662f\uff0c\u76f4\u63a5\u4f7f\u7528 Value() \u65b9\u6cd5\u83b7\u53d6\u7684\u8868\u8fbe\u5f0f\u503c\u53ef\u80fd\u548c\u9884\u671f\u4e0d\u4e00\u81f4\u3002 \u4ee5Number\u8868\u8fbe\u5f0fUnit\u4e3aPressure\u4e3a\u4f8b\uff0c\u9009\u62e9\u5355\u4f4d\"PresureNewtonPerSquareMillimeter\"\uff0c\u5373 N/mm^2 \uff0c\u4ea6\u5373 MPa \uff0c\u521b\u5efa\u8868\u8fbe\u5f0f f=2 MPa \uff0c\u4f7f\u7528 Value() \u51fd\u6570\u83b7\u53d6\u7684\u7ed3\u679c\u5374\u662f 2000.0 \u3002\u8fd9\u662f\u56e0\u4e3a\u57fa\u672c\u5355\u4f4d\u662f\"PressurePerUnitLength\"\uff0c\u5373 m*N/mm^3 \uff0c\u4e8e\u662f\uff1a value = 2 m*N/mm^3 = 2000.0 MPa \u540c\u7406\uff0c\u5bf9\u4e8eNumber\u7c7b\u578b\u8868\u8fbe\u5f0f\u7279\u6709\u7684 SetValue(double) \u65b9\u6cd5\uff0c\u4e5f\u662f\u4ee5\u57fa\u672c\u5355\u4f4d\u4e3a\u53c2\u8003\u7684\u6570\u503c\u3002 \u4e3a\u4e86\u907f\u514d\u4ee5\u4e0a\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u51fd\u6570\uff1a GetValueUsingUnits(Expression::UnitOption) \u5373\u6839\u636e\u6307\u5b9a\u5355\u4f4d\u8fd4\u56de\u8868\u8fbe\u5f0f\u7684\u503c\uff0c\u5176\u4e2d Enum UnitOption { UnitOptionBase, UnitOptionExpression }","title":"Number\u7c7b\u578b\u4e0eUnits"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/","text":"\u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-01-12 | \u5206\u7c7b\uff1a python/vba/cpp \u4ecepython2.4\u5f00\u59cb\uff0c\u5185\u7f6e\u7684 subprocess \u6a21\u5757\u53ef\u4ee5\u521b\u5efa\u5b50\u8fdb\u7a0b\u5e76\u8fde\u63a5\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u6765\u6267\u884c\u5916\u90e8\u7a0b\u5e8f\u5e76\u83b7\u53d6\u6267\u884c\u7ed3\u679c\u548c\u8f93\u51fa\u3002\u672c\u6587\u793a\u4f8b\u57fa\u4e8ePython2.7\uff0c\u8f6c\u4e3aPython3\u4ee3\u7801\u65f6\u9700\u8981\u8003\u8651\u5bf9 bytes \u7c7b\u578b\u8fd4\u56de\u503c\u7684 decode() \u8f6c\u7801\u3002 Popen\u7c7b\u65b9\u6cd5 \u00b6 subprocess \u6a21\u5757\u901a\u8fc7 Popen \u7c7b\u5b8c\u6210\u521b\u5efa\u5b50\u8fdb\u7a0b\u5e76\u4e0e\u5176\u4ea4\u4e92\u7684\u529f\u80fd\uff0c\u5e38\u89c1\u7684\u51e0\u4e2a\u6210\u5458\u51fd\u6570\u5982\u4e0b\uff1a Popen.poll() \u68c0\u67e5\u5b50\u8fdb\u7a0b\u662f\u5426\u5df2\u7ecf\u7ed3\u675f\uff0c\u672a\u7ed3\u675f\u8fd4\u56de None \uff0c\u7ed3\u675f\u8fd4\u56de returncode \u5c5e\u6027\u503c Popen.wait() \uff0c Popen.communicate() \u90fd\u4f1a\u963b\u585e\u7236\u8fdb\u7a0b\uff0c\u76f4\u5230\u5b50\u8fdb\u7a0b\u7ed3\u675f Popen.communicate(input=None) \u4e0e\u5b50\u8fdb\u7a0b\u4ea4\u4e92\uff1a\u5411 stdin \u53d1\u9001\u6570\u636e\uff0c\u4ece stdout \u548c stderr \u8bfb\u53d6\u6570\u636e \u521b\u5efa Popen \u5bf9\u8c61\u540e\uff0c\u4e3b\u7a0b\u5e8f\u4e0d\u4f1a\u81ea\u52a8\u7b49\u5f85\u5b50\u8fdb\u7a0b\u5b8c\u6210 \u3002 \u4ee5\u4e0a\u4e09\u4e2a\u6210\u5458\u51fd\u6570\u90fd\u53ef\u4ee5\u7528\u4e8e\u7b49\u5f85\u5b50\u8fdb\u7a0b\u8fd4\u56de\uff1a while \u5faa\u73af\u914d\u5408 Popen.poll() \u3001 Popen.wait() \u3001 Popen.communicate() \u3002\u7531\u4e8e\u540e\u9762\u4e8c\u8005\u90fd\u4f1a\u963b\u585e\u7236\u8fdb\u7a0b\uff0c\u6240\u4ee5\u65e0\u6cd5 \u5b9e\u65f6 \u83b7\u53d6\u5b50\u8fdb\u7a0b\u8f93\u51fa\uff0c\u800c\u662f\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7ed3\u675f\u540e\u4e00\u5e76\u8f93\u51fa\u6240\u6709\u6253\u5370\u4fe1\u606f\u3002\u53e6\u5916\uff0c Popen.wait() \u3001 Popen.communicate() \u5206\u522b\u5c06\u8f93\u51fa\u5b58\u653e\u4e8e\u7ba1\u9053\u548c\u5185\u5b58\uff0c\u524d\u8005\u5bb9\u6613\u8d85\u51fa\u9ed8\u8ba4\u5927\u5c0f\u800c\u5bfc\u81f4\u6b7b\u9501\uff0c\u56e0\u6b64\u4e0d\u63a8\u8350\u4f7f\u7528\u3002 Popen\u7c7b\u5c5e\u6027 \u00b6 Popen \u7c7b\u5177\u6709\u4e09\u4e2a\u4e0e\u8f93\u5165\u8f93\u51fa\u76f8\u5173\u7684\u5c5e\u6027\uff1a Popen.stdin , Popen.stdout \u548c Popen.stderr \uff0c\u5206\u522b\u5bf9\u5e94\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u3002Python\u7684 sys \u6a21\u5757\u5b9a\u4e49\u4e86\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\uff1a sys.stdin # \u6807\u51c6\u8f93\u5165 sys.stdout # \u6807\u51c6\u8f93\u51fa sys.stderr # \u6807\u51c6\u9519\u8bef\u4fe1\u606f \u4ee5\u4e0a\u4e09\u4e2a\u5bf9\u8c61\u7c7b\u4f3c\u4e8e\u6587\u4ef6\u6d41\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528 readline() \u548c write() \u65b9\u6cd5\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002\u4f8b\u5982\u6253\u5370\u6807\u51c6\u8f93\u51fa\u7684 print \u6307\u4ee4\u7b49\u6548\u4e8e sys.stdout.write() \u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u9664\u4e86\u76f4\u63a5\u5411\u63a7\u5236\u53f0\u6253\u5370\u8f93\u51fa\u5916\uff0c\u6807\u51c6\u8f93\u51fa/\u9519\u8bef\u7684\u6253\u5370\u5b58\u5728\u7f13\u5b58\uff0c\u4e3a\u4e86\u5b9e\u65f6\u8f93\u51fa\u6253\u5370\u4fe1\u606f\uff0c\u9700\u8981\u6267\u884c sys.stdout.flush() sys.stderr.flush() \u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u53c2\u6570 \u00b6 Popen \u7c7b\u6784\u9020\u51fd\u6570\u4e2d\u7684\u4e09\u4e2a\u53c2\u6570 stdin , stdout \u548c stderr \u7528\u4ee5\u6307\u5b9a\u6267\u884c\u7a0b\u5e8f\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u7684\u6587\u4ef6\u53e5\u67c4\u3002\u5b83\u4eec\u7684\u503c\u53ef\u4ee5\u662f PIPE \u3001\u6587\u4ef6\u63cf\u8ff0\u7b26(\u6b63\u6574\u6570)\u3001\u6587\u4ef6\u5bf9\u8c61\u6216 None \uff1a PIPE \u8868\u793a\u521b\u5efa\u4e00\u4e2a\u8fde\u63a5\u5b50\u8fdb\u7a0b\u7684\u65b0\u7ba1\u9053\uff0c\u9ed8\u8ba4\u503c None , \u8868\u793a\u4e0d\u505a\u91cd\u5b9a\u5411\u3002 \u5b50\u8fdb\u7a0b\u7684\u6587\u4ef6\u53e5\u67c4\u53ef\u4ee5\u4ece\u7236\u8fdb\u7a0b\u4e2d\u7ee7\u627f\u5f97\u5230\u3002 stderr \u53ef\u4ee5\u8bbe\u7f6e\u4e3a STDOUT \uff0c\u8868\u793a\u5c06\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\u3002 \u53c2\u8003\u793a\u4f8b\uff1a import subprocess child1 = subprocess.Popen([\"ls\",\"-l\"], stdout=subprocess.PIPE) child2 = subprocess.Popen([\"wc\"], stdin=child1.stdout, stdout=subprocess.PIPE, stderr=subprocess.STDOUT) out = child2.communicate() \u5176\u4e2d\uff0c subprocess.PIPE \u4e3a\u6587\u672c\u6d41\u63d0\u4f9b\u4e00\u4e2a\u7f13\u5b58\u533a\uff0cchild1\u7684 stdout \u5c06\u6587\u672c\u8f93\u51fa\u5230\u7f13\u5b58\u533a\uff1b\u968f\u540echild2\u7684 stdin \u4ece\u8be5 PIPE \u8bfb\u53d6\u6587\u672c\uff0cchild2\u7684\u8f93\u51fa\u6587\u672c\u4e5f\u88ab\u5b58\u653e\u5728 PIPE \u4e2d\uff0c\u800c\u6807\u51c6\u9519\u8bef\u4fe1\u606f\u5219\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff1b\u6700\u540e\uff0c communicate() \u65b9\u6cd5\u4ece PIPE \u4e2d\u8bfb\u53d6child2\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u3002 \u793a\u4f8b \u00b6 \u5047\u8bbe\u88ab\u8c03\u7528\u7684Python\u4ee3\u7801\u5982\u4e0b\uff0c\u5176\u4e2d\u7684 flush() \u65b9\u6cd5\u4f5c\u7528\u4e3a\u53ca\u65f6\u6e05\u7a7a\u7f13\u5b58\uff0c\u4ee5\u4fbf\u4e3b\u7a0b\u5e8f\u5b9e\u65f6\u83b7\u53d6\u5176\u8f93\u51fa\u4fe1\u606f\u3002 # coding:utf-8 # file: called.py import time, sys try: # \u83b7\u53d6\u6807\u51c6\u8f93\u5165 N = int(sys.stdin.readline()) except ValueError: # \u6807\u51c6\u9519\u8bef\u4fe1\u606f sys.stdout.write(\"numeric input required!!\\n\") sys.stdout.flush() exit(1) else: for i in range(N): # \u6807\u51c6\u8f93\u51fa sys.stdout.write(\"%d\\n\" %i) sys.stdout.flush() time.sleep(1) exit(0) \u4e3b\u7a0b\u5e8f call.py \uff1a import subprocess, shlex command = \"python called.py\" p = subprocess.Popen(shlex.split(command), stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT) # \u4e3a\u5b50\u8fdb\u7a0b\u4f20\u9012\u53c2\u6570 p.stdin.write('5\\n') # \u5b9e\u65f6\u83b7\u53d6\u8f93\u51fa while p.poll() == None: out = p.stdout.readline().strip() if out: print \"sub process output: \", out # \u5b50\u8fdb\u7a0b\u8fd4\u56de\u503c print \"return code: \", p.returncode stdin=subprocess.PIPE \u6307\u5b9a\u5b50\u7a0b\u5e8f\u8f93\u5165\u65b9\u5f0f\uff0c\u63a5\u7740\u7531 p.stdin.write('5\\n') \u7ed9\u5b9a\uff1b\u5b50\u7a0b\u5e8f\u4e2d\u4f7f\u7528 sys.stdin.readline() \u83b7\u53d6 stderr=subprocess.STDOUT \u5c06\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528 p.stdout.readline() \u7edf\u4e00\u83b7\u53d6\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u4fe1\u606f \u53c2\u8003\u8d44\u6599 \u00b6 17.1. subprocess \u2014 Subprocess management python\u5b50\u8fdb\u7a0b\u6a21\u5757subprocess\u8be6\u89e3 python\u5b50\u8fdb\u7a0b\u6a21\u5757subprocess\u8be6\u89e3\u4e0e\u5e94\u7528\u5b9e\u4f8b \u4e4b\u4e09 Python\u4e2dprint\u5982\u4f55\u5237\u65b0\u7f13\u51b2\u7acb\u523b\u6253\u5370\u8f93\u51fa\u7ed3\u679c","title":"\u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#subprocess","text":"\u53d1\u5e03\u4e8e\uff1a2018-01-12 | \u5206\u7c7b\uff1a python/vba/cpp \u4ecepython2.4\u5f00\u59cb\uff0c\u5185\u7f6e\u7684 subprocess \u6a21\u5757\u53ef\u4ee5\u521b\u5efa\u5b50\u8fdb\u7a0b\u5e76\u8fde\u63a5\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u6765\u6267\u884c\u5916\u90e8\u7a0b\u5e8f\u5e76\u83b7\u53d6\u6267\u884c\u7ed3\u679c\u548c\u8f93\u51fa\u3002\u672c\u6587\u793a\u4f8b\u57fa\u4e8ePython2.7\uff0c\u8f6c\u4e3aPython3\u4ee3\u7801\u65f6\u9700\u8981\u8003\u8651\u5bf9 bytes \u7c7b\u578b\u8fd4\u56de\u503c\u7684 decode() \u8f6c\u7801\u3002","title":"\u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#popen","text":"subprocess \u6a21\u5757\u901a\u8fc7 Popen \u7c7b\u5b8c\u6210\u521b\u5efa\u5b50\u8fdb\u7a0b\u5e76\u4e0e\u5176\u4ea4\u4e92\u7684\u529f\u80fd\uff0c\u5e38\u89c1\u7684\u51e0\u4e2a\u6210\u5458\u51fd\u6570\u5982\u4e0b\uff1a Popen.poll() \u68c0\u67e5\u5b50\u8fdb\u7a0b\u662f\u5426\u5df2\u7ecf\u7ed3\u675f\uff0c\u672a\u7ed3\u675f\u8fd4\u56de None \uff0c\u7ed3\u675f\u8fd4\u56de returncode \u5c5e\u6027\u503c Popen.wait() \uff0c Popen.communicate() \u90fd\u4f1a\u963b\u585e\u7236\u8fdb\u7a0b\uff0c\u76f4\u5230\u5b50\u8fdb\u7a0b\u7ed3\u675f Popen.communicate(input=None) \u4e0e\u5b50\u8fdb\u7a0b\u4ea4\u4e92\uff1a\u5411 stdin \u53d1\u9001\u6570\u636e\uff0c\u4ece stdout \u548c stderr \u8bfb\u53d6\u6570\u636e \u521b\u5efa Popen \u5bf9\u8c61\u540e\uff0c\u4e3b\u7a0b\u5e8f\u4e0d\u4f1a\u81ea\u52a8\u7b49\u5f85\u5b50\u8fdb\u7a0b\u5b8c\u6210 \u3002 \u4ee5\u4e0a\u4e09\u4e2a\u6210\u5458\u51fd\u6570\u90fd\u53ef\u4ee5\u7528\u4e8e\u7b49\u5f85\u5b50\u8fdb\u7a0b\u8fd4\u56de\uff1a while \u5faa\u73af\u914d\u5408 Popen.poll() \u3001 Popen.wait() \u3001 Popen.communicate() \u3002\u7531\u4e8e\u540e\u9762\u4e8c\u8005\u90fd\u4f1a\u963b\u585e\u7236\u8fdb\u7a0b\uff0c\u6240\u4ee5\u65e0\u6cd5 \u5b9e\u65f6 \u83b7\u53d6\u5b50\u8fdb\u7a0b\u8f93\u51fa\uff0c\u800c\u662f\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7ed3\u675f\u540e\u4e00\u5e76\u8f93\u51fa\u6240\u6709\u6253\u5370\u4fe1\u606f\u3002\u53e6\u5916\uff0c Popen.wait() \u3001 Popen.communicate() \u5206\u522b\u5c06\u8f93\u51fa\u5b58\u653e\u4e8e\u7ba1\u9053\u548c\u5185\u5b58\uff0c\u524d\u8005\u5bb9\u6613\u8d85\u51fa\u9ed8\u8ba4\u5927\u5c0f\u800c\u5bfc\u81f4\u6b7b\u9501\uff0c\u56e0\u6b64\u4e0d\u63a8\u8350\u4f7f\u7528\u3002","title":"Popen\u7c7b\u65b9\u6cd5"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#popen_1","text":"Popen \u7c7b\u5177\u6709\u4e09\u4e2a\u4e0e\u8f93\u5165\u8f93\u51fa\u76f8\u5173\u7684\u5c5e\u6027\uff1a Popen.stdin , Popen.stdout \u548c Popen.stderr \uff0c\u5206\u522b\u5bf9\u5e94\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u3002Python\u7684 sys \u6a21\u5757\u5b9a\u4e49\u4e86\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\uff1a sys.stdin # \u6807\u51c6\u8f93\u5165 sys.stdout # \u6807\u51c6\u8f93\u51fa sys.stderr # \u6807\u51c6\u9519\u8bef\u4fe1\u606f \u4ee5\u4e0a\u4e09\u4e2a\u5bf9\u8c61\u7c7b\u4f3c\u4e8e\u6587\u4ef6\u6d41\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528 readline() \u548c write() \u65b9\u6cd5\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002\u4f8b\u5982\u6253\u5370\u6807\u51c6\u8f93\u51fa\u7684 print \u6307\u4ee4\u7b49\u6548\u4e8e sys.stdout.write() \u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u9664\u4e86\u76f4\u63a5\u5411\u63a7\u5236\u53f0\u6253\u5370\u8f93\u51fa\u5916\uff0c\u6807\u51c6\u8f93\u51fa/\u9519\u8bef\u7684\u6253\u5370\u5b58\u5728\u7f13\u5b58\uff0c\u4e3a\u4e86\u5b9e\u65f6\u8f93\u51fa\u6253\u5370\u4fe1\u606f\uff0c\u9700\u8981\u6267\u884c sys.stdout.flush() sys.stderr.flush()","title":"Popen\u7c7b\u5c5e\u6027"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#_1","text":"Popen \u7c7b\u6784\u9020\u51fd\u6570\u4e2d\u7684\u4e09\u4e2a\u53c2\u6570 stdin , stdout \u548c stderr \u7528\u4ee5\u6307\u5b9a\u6267\u884c\u7a0b\u5e8f\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u7684\u6587\u4ef6\u53e5\u67c4\u3002\u5b83\u4eec\u7684\u503c\u53ef\u4ee5\u662f PIPE \u3001\u6587\u4ef6\u63cf\u8ff0\u7b26(\u6b63\u6574\u6570)\u3001\u6587\u4ef6\u5bf9\u8c61\u6216 None \uff1a PIPE \u8868\u793a\u521b\u5efa\u4e00\u4e2a\u8fde\u63a5\u5b50\u8fdb\u7a0b\u7684\u65b0\u7ba1\u9053\uff0c\u9ed8\u8ba4\u503c None , \u8868\u793a\u4e0d\u505a\u91cd\u5b9a\u5411\u3002 \u5b50\u8fdb\u7a0b\u7684\u6587\u4ef6\u53e5\u67c4\u53ef\u4ee5\u4ece\u7236\u8fdb\u7a0b\u4e2d\u7ee7\u627f\u5f97\u5230\u3002 stderr \u53ef\u4ee5\u8bbe\u7f6e\u4e3a STDOUT \uff0c\u8868\u793a\u5c06\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\u3002 \u53c2\u8003\u793a\u4f8b\uff1a import subprocess child1 = subprocess.Popen([\"ls\",\"-l\"], stdout=subprocess.PIPE) child2 = subprocess.Popen([\"wc\"], stdin=child1.stdout, stdout=subprocess.PIPE, stderr=subprocess.STDOUT) out = child2.communicate() \u5176\u4e2d\uff0c subprocess.PIPE \u4e3a\u6587\u672c\u6d41\u63d0\u4f9b\u4e00\u4e2a\u7f13\u5b58\u533a\uff0cchild1\u7684 stdout \u5c06\u6587\u672c\u8f93\u51fa\u5230\u7f13\u5b58\u533a\uff1b\u968f\u540echild2\u7684 stdin \u4ece\u8be5 PIPE \u8bfb\u53d6\u6587\u672c\uff0cchild2\u7684\u8f93\u51fa\u6587\u672c\u4e5f\u88ab\u5b58\u653e\u5728 PIPE \u4e2d\uff0c\u800c\u6807\u51c6\u9519\u8bef\u4fe1\u606f\u5219\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff1b\u6700\u540e\uff0c communicate() \u65b9\u6cd5\u4ece PIPE \u4e2d\u8bfb\u53d6child2\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u3002","title":"\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u53c2\u6570"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#_2","text":"\u5047\u8bbe\u88ab\u8c03\u7528\u7684Python\u4ee3\u7801\u5982\u4e0b\uff0c\u5176\u4e2d\u7684 flush() \u65b9\u6cd5\u4f5c\u7528\u4e3a\u53ca\u65f6\u6e05\u7a7a\u7f13\u5b58\uff0c\u4ee5\u4fbf\u4e3b\u7a0b\u5e8f\u5b9e\u65f6\u83b7\u53d6\u5176\u8f93\u51fa\u4fe1\u606f\u3002 # coding:utf-8 # file: called.py import time, sys try: # \u83b7\u53d6\u6807\u51c6\u8f93\u5165 N = int(sys.stdin.readline()) except ValueError: # \u6807\u51c6\u9519\u8bef\u4fe1\u606f sys.stdout.write(\"numeric input required!!\\n\") sys.stdout.flush() exit(1) else: for i in range(N): # \u6807\u51c6\u8f93\u51fa sys.stdout.write(\"%d\\n\" %i) sys.stdout.flush() time.sleep(1) exit(0) \u4e3b\u7a0b\u5e8f call.py \uff1a import subprocess, shlex command = \"python called.py\" p = subprocess.Popen(shlex.split(command), stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT) # \u4e3a\u5b50\u8fdb\u7a0b\u4f20\u9012\u53c2\u6570 p.stdin.write('5\\n') # \u5b9e\u65f6\u83b7\u53d6\u8f93\u51fa while p.poll() == None: out = p.stdout.readline().strip() if out: print \"sub process output: \", out # \u5b50\u8fdb\u7a0b\u8fd4\u56de\u503c print \"return code: \", p.returncode stdin=subprocess.PIPE \u6307\u5b9a\u5b50\u7a0b\u5e8f\u8f93\u5165\u65b9\u5f0f\uff0c\u63a5\u7740\u7531 p.stdin.write('5\\n') \u7ed9\u5b9a\uff1b\u5b50\u7a0b\u5e8f\u4e2d\u4f7f\u7528 sys.stdin.readline() \u83b7\u53d6 stderr=subprocess.STDOUT \u5c06\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528 p.stdout.readline() \u7edf\u4e00\u83b7\u53d6\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u4fe1\u606f","title":"\u793a\u4f8b"},{"location":"2018-01-12-%E4%BD%BF%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#_3","text":"17.1. subprocess \u2014 Subprocess management python\u5b50\u8fdb\u7a0b\u6a21\u5757subprocess\u8be6\u89e3 python\u5b50\u8fdb\u7a0b\u6a21\u5757subprocess\u8be6\u89e3\u4e0e\u5e94\u7528\u5b9e\u4f8b \u4e4b\u4e09 Python\u4e2dprint\u5982\u4f55\u5237\u65b0\u7f13\u51b2\u7acb\u523b\u6253\u5370\u8f93\u51fa\u7ed3\u679c","title":"\u53c2\u8003\u8d44\u6599"},{"location":"2018-01-13-PyQt%E4%BD%BF%E7%94%A8QProcess%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/","text":"PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-01-13 | \u5206\u7c7b\uff1a python/vba/cpp QProcess() \u7c7b\u53ef\u4ee5\u521b\u5efa\u5b50\u8fdb\u7a0b\u6267\u884c\u5916\u90e8\u7a0b\u5e8f\uff0c\u4f7f\u7528 readyReadStandardOutput \u4fe1\u53f7\u76d1\u542c\u5b50\u8fdb\u7a0b\u4e2d\u7684\u6807\u51c6\u8f93\u51fa\u4e8b\u4ef6\uff0c\u4f7f\u7528 readAllStandardOutput() \u8bfb\u53d6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u51fa\uff1b\u5bf9\u6807\u51c6\u9519\u8bef\u7684\u64cd\u4f5c\u540c\u7406\u3002\u672c\u6587\u57fa\u4e8ePython3\u548cPyQt5\u793a\u4f8b\u4ee5\u4e0a\u6d41\u7a0b\u7684\u4ee3\u7801\u3002 \u521b\u5efaQProcess\u5e76\u5173\u8054\u76d1\u542c\u4e8b\u4ef6 \u00b6 self.process = QProcess() self.process.readReadStandardOutput.connect(self.addStdOut) self.process.readReadStandardError.connect(self.addStdErr) self.process.finished.connect(self.stop) \u542f\u52a8\u5b50\u7a0b\u5e8f \u00b6 self.process.start(\"command_line\") \u54cd\u5e94\u69fd\u51fd\u6570 \u00b6 def addStdOut(self): output = bytes(self.process.readAllStandardOutput()).decode() readAllStandardOutput() \u8fd4\u56de\u7684\u662fQt\u7684 QbyteArray \u7c7b\u578b\u6570\u636e\uff0c\u5bf9\u5e94Python\u7684 bytes \uff0c\u4e8c\u8005\u53ef\u4ee5\u76f4\u63a5\u8f6c\u6362\u3002\u7136\u540e\u4f7f\u7528 bytes \u7c7b\u578b\u5bf9\u8c61\u7684 decode() \u65b9\u6cd5\u8f6c\u4e3apython\u7684 str \u3002","title":"PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa"},{"location":"2018-01-13-PyQt%E4%BD%BF%E7%94%A8QProcess%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#pyqtqprocess","text":"\u53d1\u5e03\u4e8e\uff1a2018-01-13 | \u5206\u7c7b\uff1a python/vba/cpp QProcess() \u7c7b\u53ef\u4ee5\u521b\u5efa\u5b50\u8fdb\u7a0b\u6267\u884c\u5916\u90e8\u7a0b\u5e8f\uff0c\u4f7f\u7528 readyReadStandardOutput \u4fe1\u53f7\u76d1\u542c\u5b50\u8fdb\u7a0b\u4e2d\u7684\u6807\u51c6\u8f93\u51fa\u4e8b\u4ef6\uff0c\u4f7f\u7528 readAllStandardOutput() \u8bfb\u53d6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u51fa\uff1b\u5bf9\u6807\u51c6\u9519\u8bef\u7684\u64cd\u4f5c\u540c\u7406\u3002\u672c\u6587\u57fa\u4e8ePython3\u548cPyQt5\u793a\u4f8b\u4ee5\u4e0a\u6d41\u7a0b\u7684\u4ee3\u7801\u3002","title":"PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa"},{"location":"2018-01-13-PyQt%E4%BD%BF%E7%94%A8QProcess%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#qprocess","text":"self.process = QProcess() self.process.readReadStandardOutput.connect(self.addStdOut) self.process.readReadStandardError.connect(self.addStdErr) self.process.finished.connect(self.stop)","title":"\u521b\u5efaQProcess\u5e76\u5173\u8054\u76d1\u542c\u4e8b\u4ef6"},{"location":"2018-01-13-PyQt%E4%BD%BF%E7%94%A8QProcess%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#_1","text":"self.process.start(\"command_line\")","title":"\u542f\u52a8\u5b50\u7a0b\u5e8f"},{"location":"2018-01-13-PyQt%E4%BD%BF%E7%94%A8QProcess%E8%B0%83%E7%94%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B9%B6%E8%8E%B7%E5%8F%96%E8%BE%93%E5%87%BA/#_2","text":"def addStdOut(self): output = bytes(self.process.readAllStandardOutput()).decode() readAllStandardOutput() \u8fd4\u56de\u7684\u662fQt\u7684 QbyteArray \u7c7b\u578b\u6570\u636e\uff0c\u5bf9\u5e94Python\u7684 bytes \uff0c\u4e8c\u8005\u53ef\u4ee5\u76f4\u63a5\u8f6c\u6362\u3002\u7136\u540e\u4f7f\u7528 bytes \u7c7b\u578b\u5bf9\u8c61\u7684 decode() \u65b9\u6cd5\u8f6c\u4e3apython\u7684 str \u3002","title":"\u54cd\u5e94\u69fd\u51fd\u6570"},{"location":"2018-01-23-%E8%87%AA%E5%AE%9A%E4%B9%89Microsoft-Office-Ribbon%E5%8C%BA%E5%9F%9F/","text":"\u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-01-23 | \u5206\u7c7b\uff1a process automation \u524d\u6587 \u4ee5 Microsoft Excel 2010 \u4e3a\u4f8b\u4ecb\u7ecd\u4e86\u5236\u4f5c\u5e26\u6709\u81ea\u5b9a\u4e49Ribbon\u83dc\u5355\u7684Excel\u63d2\u4ef6\u7684\u57fa\u672c\u6d41\u7a0b\uff0c\u5b9e\u9645\u4e0a\u6b64\u65b9\u6cd5\u901a\u7528\u4e8e MicroSoft Office \u7684\u5e38\u7528\u7ec4\u4ef6\uff1aWord\uff0cExcel\uff0cPPT\u3002\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e9bOffice\u5e94\u7528\u7a0b\u5e8f\u6587\u6863\u90fd\u662f\u57fa\u4e8e Office Open XML \u683c\u5f0f\uff1a Office Open XML (also informally known as OOXML or Microsoft Open XML (MOX)) is a zipped, XML-based file format developed by Microsoft for representing spreadsheets, charts, presentations and word processing documents. -- Wikipedia \u8fd9\u79cd\u5f00\u653e\u7684XML\u6587\u4ef6\u683c\u5f0f\u6539\u8fdb\u4e86\u6587\u4ef6\u548c\u6570\u636e\u7ba1\u7406\u3001\u6570\u636e\u6062\u590d\u548c\u53ef\u4ea4\u4e92\u64cd\u4f5c\u7684\u80fd\u529b\u3002\u5b83\u5b9e\u9645\u4e0a\u662f\u538b\u7f29\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u89e3\u538b\u8f6f\u4ef6\u67e5\u770b\u6587\u4ef6\u5185\u90e8\u7684\u60c5\u51b5\uff1b\u5e76\u4e14\u4efb\u4f55\u652f\u6301XML\u7684\u5e94\u7528\u7a0b\u5e8f\u90fd\u80fd\u8bbf\u95ee\u548c\u5904\u7406Office\u6587\u4ef6\u4fe1\u606f\uff0c\u5373\u53ea\u8981\u63d0\u4f9b\u4e86\u5bf9XML\u7684\u652f\u6301\uff0c\u5373\u4fbf\u7cfb\u7edf\u6ca1\u6709\u5b89\u88c5Office\u8f6f\u4ef6\u3001\u975eOffice\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u65b9\u4fbf\u5730\u521b\u5efa\u548c\u64cd\u7eb5Office\u6587\u4ef6\u3002 \u6b63\u662f\u57fa\u4e8e\u8fd9\u79cd\u5f00\u653e\u7684XML\u6587\u4ef6\u683c\u5f0f\uff0c\u624d\u4f7f\u5f97 \u524d\u6587 \u7f16\u8f91 XML \u6587\u4ef6\u7684\u65b9\u6cd5\u6709\u8ff9\u53ef\u5bfb\u3002 Office Open XML \u6587\u6863\u7c7b\u578b \u00b6 \u5982 Introducing the Office (2007) Open XML File Formats \u6240\u8ff0\uff0c\u6309Word\u3001Excel\u3001PPT\u5206\u4e3a\u4e09\u5927\u7c7b\uff1a \u6587\u6863\u7c7b\u578b \u6269\u5c55\u540d word\u6587\u6863 .docx \u542f\u7528\u5b8f\u7684word\u6587\u6863 .docm word\u6a21\u677f .dotx \u542f\u7528\u5b8f\u7684word\u6a21\u677f .dotm \u6587\u6863\u7c7b\u578b \u6269\u5c55\u540d Excel\u5de5\u4f5c\u7c3f .xlsx \u542f\u7528\u5b8f\u7684Excel\u5de5\u4f5c\u7c3f .xlsm Excel\u6a21\u677f .xltx \u542f\u7528\u5b8f\u7684Excel\u6a21\u677f .xltm \u542f\u7528\u5b8f\u7684Excel\u63d2\u4ef6/\u52a0\u8f7d\u9879 .xlsa \u6587\u6863\u7c7b\u578b \u6269\u5c55\u540d PPT\u6f14\u793a\u6587\u6863 .pptx \u542f\u7528\u5b8f\u7684PPT\u6f14\u793a\u6587\u6863 .pptm PPT\u6a21\u677f .potx \u542f\u7528\u5b8f\u7684PPT\u6a21\u677f .potm \u542f\u7528\u5b8f\u7684PPT\u63d2\u4ef6 .ppam \u4e3b\u8981\u533a\u522b \u00b6 \u4ee5\u4e0a\u7c7b\u578b\u53ef\u4ee5\u5f52\u7eb3\u4e3a\u666e\u901a/\u542f\u7528\u5b8f\u6587\u6863\u3001\u666e\u901a/\u542f\u7528\u5b8f\u6a21\u677f\u3001\u63d2\u4ef6\uff0c\u4e3b\u8981\u533a\u522b\u5728\u4e8e\uff1a \u662f\u5426\u542f\u7528\u5b8f\u51b3\u5b9a\u4e86\u80fd\u5426\u4fdd\u5b58\u548c\u6267\u884c\u81ea\u5b9a\u4e49VBA\u4ee3\u7801\uff0c\u901a\u5e38\u4ee5 m \u7ed3\u5c3e\u7684\u6587\u6863\u4e3a\u542f\u7528\u5b8f\u7684\u7c7b\u578b \u5bf9\u6587\u6863\uff08\u666e\u901a/\u5b8f\uff09\u7684\u81ea\u5b9a\u4e49Ribbon\u64cd\u4f5c\u4ec5\u4ec5\u5f71\u54cd\u5f53\u524d\u6587\u6863 \u5bf9\u6a21\u677f\u6216\u8005\u63d2\u4ef6\u7684\u81ea\u5b9a\u4e49Ribbon\u64cd\u4f5c\u5c06\u5728\u52a0\u8f7d\u5b83\u4eec\u540e\u5bf9\u6240\u6709\u6587\u6863\u751f\u6548 \u56e0\u6b64\uff0c\u6211\u4eec\u901a\u5e38\u4ee5\u6a21\u677f\u6216\u8005\u63d2\u4ef6\u7684\u5f62\u5f0f\u5236\u4f5c\u901a\u7528\u7684\u529f\u80fd\uff0c\u4f7f\u5176\u53ef\u4ee5\u88ab\u6240\u6709\u9700\u8981\u7684\u6587\u6863\u4f7f\u7528\u3002 \u5982\u4f55\u7406\u89e3\u201c\u81ea\u52a0\u8f7d\u540e...\u201d \u63d2\u4ef6\u4e00\u65e6\u88ab\u542f\u7528\u540e\uff0c\u5c06\u5728\u6bcf\u6b21\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\u7684\u65f6\u5019\u5b8c\u6210\u52a0\u8f7d \u6a21\u677f\u5206\u4e3a\u5168\u5c40\u6a21\u677f\uff08global template\uff09\u548c\u666e\u901a\u6a21\u677f\uff0c\u524d\u8005\u4f34\u968f\u5e94\u7528\u7a0b\u5e8f\u7684\u542f\u52a8\u800c\u52a0\u8f7d\uff0c\u540e\u8005\u9700\u8981\u624b\u5de5\u52a0\u8f7d \u4ec0\u4e48\u662f \u5168\u5c40\u6a21\u677f \uff08global template\uff09? \u4ee5Word\u4e3a\u4f8b\uff0c\u4f4d\u4e8e C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Word\\Startup \u4e0b\u7684\u6a21\u677f\u6587\u4ef6\uff08 .dot, .dotx, .dotm \uff09\u5c06\u5728Word\u542f\u52a8\u540e\u5b8c\u6210\u52a0\u8f7d\uff0c\u56e0\u6b64\u79f0\u4e3a\u5168\u5c40\u6a21\u677f\u3002 \u53ef\u4ee5\u901a\u8fc7 Developer -> Add-Ins \u67e5\u770b\u5df2\u52a0\u8f7d\u548c\u542f\u7528\u7684\u6a21\u677f\u3002\u5f53\u7136\uff0c\u901a\u8fc7 Add... \u6309\u94ae\u53ef\u4ee5\u4e34\u65f6\u6dfb\u52a0\u5176\u4ed6\u4efb\u610f\u4f4d\u7f6e\u7684\u6a21\u677f\u6587\u4ef6\u3002\u4f46\u662f\u5b83\u4eec\u5728\u4e0b\u6b21\u542f\u52a8Word\u540e\u5e76\u4e0d\u4f1a\u81ea\u52a8\u5b8c\u6210\u52a0\u8f7d\uff0c\u8fd8\u9700\u8981\u624b\u5de5\u542f\u7528\u3002 \u793a\u4f8b \u00b6 \u4ee5Word\u4e3a\u4f8b\u6f14\u793a\u5e26\u6709\u81ea\u5b9a\u4e49Ribbon\u83dc\u5355\u7684\u63d2\u4ef6\u7684\u5236\u4f5c\uff1a \u65b0\u5efaWord\u6587\u6863\u53e6\u5b58\u4e3a\u542f\u7528\u5b8f\u7684\u6a21\u677f .dotm \u6587\u4ef6\uff0c\u7f16\u5199\u76f8\u5e94VBA\u4ee3\u7801 \u6309\u7167 \u524d\u6587 \u6d41\u7a0b\u5b8c\u6210\u81ea\u5b9a\u4e49Ribbon\u64cd\u4f5c \u5c06\u5236\u4f5c\u597d\u7684 .dotm \u6a21\u677f\u6587\u4ef6\u7f6e\u4e8e Startup \u76ee\u5f55\u81ea\u52a8\u52a0\u8f7d\u6216\u8005\u624b\u5de5\u6309\u9700\u52a0\u8f7d","title":"\u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df"},{"location":"2018-01-23-%E8%87%AA%E5%AE%9A%E4%B9%89Microsoft-Office-Ribbon%E5%8C%BA%E5%9F%9F/#microsoft office ribbon","text":"\u53d1\u5e03\u4e8e\uff1a2018-01-23 | \u5206\u7c7b\uff1a process automation \u524d\u6587 \u4ee5 Microsoft Excel 2010 \u4e3a\u4f8b\u4ecb\u7ecd\u4e86\u5236\u4f5c\u5e26\u6709\u81ea\u5b9a\u4e49Ribbon\u83dc\u5355\u7684Excel\u63d2\u4ef6\u7684\u57fa\u672c\u6d41\u7a0b\uff0c\u5b9e\u9645\u4e0a\u6b64\u65b9\u6cd5\u901a\u7528\u4e8e MicroSoft Office \u7684\u5e38\u7528\u7ec4\u4ef6\uff1aWord\uff0cExcel\uff0cPPT\u3002\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e9bOffice\u5e94\u7528\u7a0b\u5e8f\u6587\u6863\u90fd\u662f\u57fa\u4e8e Office Open XML \u683c\u5f0f\uff1a Office Open XML (also informally known as OOXML or Microsoft Open XML (MOX)) is a zipped, XML-based file format developed by Microsoft for representing spreadsheets, charts, presentations and word processing documents. -- Wikipedia \u8fd9\u79cd\u5f00\u653e\u7684XML\u6587\u4ef6\u683c\u5f0f\u6539\u8fdb\u4e86\u6587\u4ef6\u548c\u6570\u636e\u7ba1\u7406\u3001\u6570\u636e\u6062\u590d\u548c\u53ef\u4ea4\u4e92\u64cd\u4f5c\u7684\u80fd\u529b\u3002\u5b83\u5b9e\u9645\u4e0a\u662f\u538b\u7f29\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u89e3\u538b\u8f6f\u4ef6\u67e5\u770b\u6587\u4ef6\u5185\u90e8\u7684\u60c5\u51b5\uff1b\u5e76\u4e14\u4efb\u4f55\u652f\u6301XML\u7684\u5e94\u7528\u7a0b\u5e8f\u90fd\u80fd\u8bbf\u95ee\u548c\u5904\u7406Office\u6587\u4ef6\u4fe1\u606f\uff0c\u5373\u53ea\u8981\u63d0\u4f9b\u4e86\u5bf9XML\u7684\u652f\u6301\uff0c\u5373\u4fbf\u7cfb\u7edf\u6ca1\u6709\u5b89\u88c5Office\u8f6f\u4ef6\u3001\u975eOffice\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u65b9\u4fbf\u5730\u521b\u5efa\u548c\u64cd\u7eb5Office\u6587\u4ef6\u3002 \u6b63\u662f\u57fa\u4e8e\u8fd9\u79cd\u5f00\u653e\u7684XML\u6587\u4ef6\u683c\u5f0f\uff0c\u624d\u4f7f\u5f97 \u524d\u6587 \u7f16\u8f91 XML \u6587\u4ef6\u7684\u65b9\u6cd5\u6709\u8ff9\u53ef\u5bfb\u3002","title":"\u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df"},{"location":"2018-01-23-%E8%87%AA%E5%AE%9A%E4%B9%89Microsoft-Office-Ribbon%E5%8C%BA%E5%9F%9F/#office open xml","text":"\u5982 Introducing the Office (2007) Open XML File Formats \u6240\u8ff0\uff0c\u6309Word\u3001Excel\u3001PPT\u5206\u4e3a\u4e09\u5927\u7c7b\uff1a \u6587\u6863\u7c7b\u578b \u6269\u5c55\u540d word\u6587\u6863 .docx \u542f\u7528\u5b8f\u7684word\u6587\u6863 .docm word\u6a21\u677f .dotx \u542f\u7528\u5b8f\u7684word\u6a21\u677f .dotm \u6587\u6863\u7c7b\u578b \u6269\u5c55\u540d Excel\u5de5\u4f5c\u7c3f .xlsx \u542f\u7528\u5b8f\u7684Excel\u5de5\u4f5c\u7c3f .xlsm Excel\u6a21\u677f .xltx \u542f\u7528\u5b8f\u7684Excel\u6a21\u677f .xltm \u542f\u7528\u5b8f\u7684Excel\u63d2\u4ef6/\u52a0\u8f7d\u9879 .xlsa \u6587\u6863\u7c7b\u578b \u6269\u5c55\u540d PPT\u6f14\u793a\u6587\u6863 .pptx \u542f\u7528\u5b8f\u7684PPT\u6f14\u793a\u6587\u6863 .pptm PPT\u6a21\u677f .potx \u542f\u7528\u5b8f\u7684PPT\u6a21\u677f .potm \u542f\u7528\u5b8f\u7684PPT\u63d2\u4ef6 .ppam","title":"Office Open XML\u6587\u6863\u7c7b\u578b"},{"location":"2018-01-23-%E8%87%AA%E5%AE%9A%E4%B9%89Microsoft-Office-Ribbon%E5%8C%BA%E5%9F%9F/#_1","text":"\u4ee5\u4e0a\u7c7b\u578b\u53ef\u4ee5\u5f52\u7eb3\u4e3a\u666e\u901a/\u542f\u7528\u5b8f\u6587\u6863\u3001\u666e\u901a/\u542f\u7528\u5b8f\u6a21\u677f\u3001\u63d2\u4ef6\uff0c\u4e3b\u8981\u533a\u522b\u5728\u4e8e\uff1a \u662f\u5426\u542f\u7528\u5b8f\u51b3\u5b9a\u4e86\u80fd\u5426\u4fdd\u5b58\u548c\u6267\u884c\u81ea\u5b9a\u4e49VBA\u4ee3\u7801\uff0c\u901a\u5e38\u4ee5 m \u7ed3\u5c3e\u7684\u6587\u6863\u4e3a\u542f\u7528\u5b8f\u7684\u7c7b\u578b \u5bf9\u6587\u6863\uff08\u666e\u901a/\u5b8f\uff09\u7684\u81ea\u5b9a\u4e49Ribbon\u64cd\u4f5c\u4ec5\u4ec5\u5f71\u54cd\u5f53\u524d\u6587\u6863 \u5bf9\u6a21\u677f\u6216\u8005\u63d2\u4ef6\u7684\u81ea\u5b9a\u4e49Ribbon\u64cd\u4f5c\u5c06\u5728\u52a0\u8f7d\u5b83\u4eec\u540e\u5bf9\u6240\u6709\u6587\u6863\u751f\u6548 \u56e0\u6b64\uff0c\u6211\u4eec\u901a\u5e38\u4ee5\u6a21\u677f\u6216\u8005\u63d2\u4ef6\u7684\u5f62\u5f0f\u5236\u4f5c\u901a\u7528\u7684\u529f\u80fd\uff0c\u4f7f\u5176\u53ef\u4ee5\u88ab\u6240\u6709\u9700\u8981\u7684\u6587\u6863\u4f7f\u7528\u3002 \u5982\u4f55\u7406\u89e3\u201c\u81ea\u52a0\u8f7d\u540e...\u201d \u63d2\u4ef6\u4e00\u65e6\u88ab\u542f\u7528\u540e\uff0c\u5c06\u5728\u6bcf\u6b21\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\u7684\u65f6\u5019\u5b8c\u6210\u52a0\u8f7d \u6a21\u677f\u5206\u4e3a\u5168\u5c40\u6a21\u677f\uff08global template\uff09\u548c\u666e\u901a\u6a21\u677f\uff0c\u524d\u8005\u4f34\u968f\u5e94\u7528\u7a0b\u5e8f\u7684\u542f\u52a8\u800c\u52a0\u8f7d\uff0c\u540e\u8005\u9700\u8981\u624b\u5de5\u52a0\u8f7d \u4ec0\u4e48\u662f \u5168\u5c40\u6a21\u677f \uff08global template\uff09? \u4ee5Word\u4e3a\u4f8b\uff0c\u4f4d\u4e8e C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Word\\Startup \u4e0b\u7684\u6a21\u677f\u6587\u4ef6\uff08 .dot, .dotx, .dotm \uff09\u5c06\u5728Word\u542f\u52a8\u540e\u5b8c\u6210\u52a0\u8f7d\uff0c\u56e0\u6b64\u79f0\u4e3a\u5168\u5c40\u6a21\u677f\u3002 \u53ef\u4ee5\u901a\u8fc7 Developer -> Add-Ins \u67e5\u770b\u5df2\u52a0\u8f7d\u548c\u542f\u7528\u7684\u6a21\u677f\u3002\u5f53\u7136\uff0c\u901a\u8fc7 Add... \u6309\u94ae\u53ef\u4ee5\u4e34\u65f6\u6dfb\u52a0\u5176\u4ed6\u4efb\u610f\u4f4d\u7f6e\u7684\u6a21\u677f\u6587\u4ef6\u3002\u4f46\u662f\u5b83\u4eec\u5728\u4e0b\u6b21\u542f\u52a8Word\u540e\u5e76\u4e0d\u4f1a\u81ea\u52a8\u5b8c\u6210\u52a0\u8f7d\uff0c\u8fd8\u9700\u8981\u624b\u5de5\u542f\u7528\u3002","title":"\u4e3b\u8981\u533a\u522b"},{"location":"2018-01-23-%E8%87%AA%E5%AE%9A%E4%B9%89Microsoft-Office-Ribbon%E5%8C%BA%E5%9F%9F/#_2","text":"\u4ee5Word\u4e3a\u4f8b\u6f14\u793a\u5e26\u6709\u81ea\u5b9a\u4e49Ribbon\u83dc\u5355\u7684\u63d2\u4ef6\u7684\u5236\u4f5c\uff1a \u65b0\u5efaWord\u6587\u6863\u53e6\u5b58\u4e3a\u542f\u7528\u5b8f\u7684\u6a21\u677f .dotm \u6587\u4ef6\uff0c\u7f16\u5199\u76f8\u5e94VBA\u4ee3\u7801 \u6309\u7167 \u524d\u6587 \u6d41\u7a0b\u5b8c\u6210\u81ea\u5b9a\u4e49Ribbon\u64cd\u4f5c \u5c06\u5236\u4f5c\u597d\u7684 .dotm \u6a21\u677f\u6587\u4ef6\u7f6e\u4e8e Startup \u76ee\u5f55\u81ea\u52a8\u52a0\u8f7d\u6216\u8005\u624b\u5de5\u6309\u9700\u52a0\u8f7d","title":"\u793a\u4f8b"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/","text":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-02-07 | \u5206\u7c7b\uff1a python/vba/cpp \u94fe\u5f0f\u6bd4\u8f83 \u00b6 \u533a\u95f4\u5224\u65ad\u65f6\u53ef\u4ee5\u4f7f\u7528\u66f4\u4e3a\u76f4\u89c2\u7684\u94fe\u5f0f\u6bd4\u8f83\uff1a score = 88 if 80<score<90: print(\"come on...\") # come on... \u89e3\u538b\u53ef\u8fed\u4ee3\u5bf9\u8c61 \u00b6 \u4f7f\u7528\u8d4b\u503c\u8bed\u53e5\u53ef\u4ee5\u89e3\u538b\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08\u5143\u7ec4\u3001\u5217\u8868\u3001\u5b57\u7b26\u4e32\u7b49\uff09\u5e76\u5c06\u5404\u4e2a\u5143\u7d20\u5206\u522b\u8d4b\u503c\u7ed9\u591a\u4e2a\u53d8\u91cf\u3002 x,y = 3,5 x,y = y,x # x=5, y=3 x,y = y, x+y # x=3, y=8 L = [1,2,(3,4)] a,b,c = L # a=1,b=2,c=(3,4) \u53d8\u91cf\u7684\u6570\u91cf\u5fc5\u987b\u8ddf\u5e8f\u5217\u5143\u7d20\u7684\u6570\u91cf\u4e00\u6837\uff0c\u5426\u5219\u4f1a\u4ea7\u751f ValueError \u5f02\u5e38\u3002 p = (4, 5) x, y, z = p Traceback (most recent call last): File \"<stdin>\", line 1, in <module> ValueError: need more than 2 values to unpack \u5f53\u786e\u5b9e\u9700\u8981\u4ee5\u8f83\u5c11\u6570\u91cf\u7684\u53d8\u91cf\u53bb\u89e3\u538b\u66f4\u591a\u5143\u7d20\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 \u661f\u53f7\u8868\u8fbe\u5f0f \u3002\u5176\u6548\u679c\u7c7b\u4f3c\u4e8e\u51fd\u6570\u7684\u53ef\u53d8\u4f4d\u7f6e\u53c2\u6570 *argv \u3002 x,*y,z = [3,5,7,9] # x=3, y=[5,7], z=9 # \u6ce8\u610f\u89e3\u538b\u51fa\u7684\u53d8\u91cfy\u4e3a\u5217\u8868\u7c7b\u578b\uff0c\u5373\u4fbf\u5143\u7d20\u6570\u91cf\u53ef\u80fd\u4e3a0 x,*y,z = [3,5] # x=3, y=[], z=5 # *x\u5c06x\u89e3\u538b\u4e3a(1,2,3), (4,5,6), (7,8,9) # \u7136\u540e\u4f5c\u4e3azip\u7684\u53c2\u6570 x=[[1,2,3],[4,5,6],[7,8,9]] [list(item) for item in zip(*x)] # [[1, 4, 7], [2, 5, 8], [3, 6, 9]] \u5982\u679c\u53ea\u60f3\u89e3\u538b\u4e00\u90e8\u5206\u800c\u4e22\u5f03\u5176\u4ed6\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u53d8\u91cf\u540d\u5360\u4f4d\uff1a L = [1,2,(3,4)] _, _, x = L # x=(3,4) \u904d\u5386\u5217\u8868/\u5143\u7ec4 \u00b6 \u76f4\u63a5\u4f7f\u7528 for...in \u8bed\u53e5\u904d\u5386\uff0c\u7ed3\u5408 reversed() \u548c sorted() \u51fd\u6570\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u987a\u5e8f\u904d\u5386\uff1a colors = ['red', 'green', 'blue', 'yellow'] # \u904d\u5386\u5217\u8868 for color in colors: print(color) # \u53cd\u5411\u904d\u5386 for color in reversed(colors): print(color) # \u6309\u5b57\u6bcd\u6392\u5e8f\u904d\u5386 for color in sorted(colors): print(color) # \u6309\u5b57\u6bcd\u9006\u5e8f\u904d\u5386 for color in sorted(colors, reverse=True): print(color) # \u81ea\u5b9a\u4e49\u6392\u5e8f\uff08\u4f8b\u5982\u5b57\u7b26\u4e32\u957f\u5ea6\uff09\u904d\u5386 for color in sorted(colors, key=len): # key\u53ef\u4ee5\u4f7f\u7528lambda\u8868\u8fbe\u5f0f print(color) \u4f7f\u7528 enumerate() \u83b7\u53d6\u904d\u5386\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f7f\u7528 zip() \u540c\u65f6\u904d\u5386\u591a\u4e2a\u5217\u8868\uff1a colors = ['red', 'green', 'blue', 'yellow'] bodies = ['sphere', 'cylinder', 'block'] for i, color in enumerate(colors, start=100): print(i, '--->', color) # 100 ---> red # 101 ---> green # 102 ---> blue # 103 ---> yellow for body, color in zip(bodies, colors): print(body, '--->', color) # sphere ---> red # cylinder ---> green # block ---> blue \u904d\u5386\u5b57\u5178 \u00b6 # \u4ece\u4e24\u4e2a\u5217\u8868\u521b\u5efa\u5b57\u5178 colors = ['red', 'green', 'blue', 'yellow'] bodies = ['sphere', 'cylinder', 'block'] d = dict(zip(bodies, colors)) # d = {'sphere':'red', 'cylinder':'green', 'block':'blue'} # \u904d\u5386\u5b57\u5178 for k, v in d.items(): print(k, '--->', v) \u96c6\u5408\u8fd0\u7b97 \u00b6 \u96c6\u5408\u7684\u4ea4\u3001\u5dee\u3001\u5e76\u8fd0\u7b97\uff1a x=set([1,2,4]) y=set([3,4,5]) x&y # \u4ea4\u96c6 # {4} x-y # \u5dee\u96c6 # {1, 2} x|y # \u5e76\u96c6 # {1, 2, 3, 4, 5} \u5b57\u5178\u662f \u952e\u96c6\u5408 \u4e0e \u503c\u96c6\u5408 \u7684\u6620\u5c04\u5173\u7cfb\u3002\u5b57\u5178\u7684 keys() \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5c55\u73b0\u952e\u96c6\u5408\u7684\u952e\u89c6\u56fe\u5bf9\u8c61\u3002\u952e\u89c6\u56fe\u4e5f\u652f\u6301\u96c6\u5408\u64cd\u4f5c\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u952e\u89c6\u56fe\u5bf9\u8c61\u6267\u884c\u666e\u901a\u7684\u96c6\u5408\u64cd\u4f5c\u3002 a = {'x' : 1, 'y' : 2, 'z' : 3} b = {'w' : 10, 'x' : 11, 'y' : 2} # \u4e24\u4e2a\u5b57\u5178\u7684\u516c\u5171\u952e a.keys() & b.keys() # { 'x', 'y' } # \u4ec5\u5728\u5b57\u5178a\u4e2d\u5b58\u5728\u7684\u952e a.keys() - b.keys() # { 'z' } # \u4e24\u4e2a\u5b57\u5178\u7684\u516c\u5171\u5143\u7d20 a.items() & b.items() # { ('y', 2) } \u5b57\u5178\u7684 items() \u65b9\u6cd5\u540c\u7406\uff0c\u4f46\u662f\u7531\u4e8e\u4e0d\u80fd\u4fdd\u8bc1 values() \u65b9\u6cd5\u7684\u6240\u6709\u503c\u4e92\u4e0d\u76f8\u540c\uff0c\u6545\u4e0d\u80fd\u76f4\u63a5\u8fdb\u884c\u96c6\u5408\u64cd\u4f5c\u2014\u2014\u4e0d\u8fc7\u53ef\u4ee5\u5148\u5c06\u503c\u96c6\u5408\u8f6c\u6362\u6210 set \uff0c\u7136\u540e\u518d\u6267\u884c\u96c6\u5408\u8fd0\u7b97\u3002 \u5217\u8868\u63a8\u5bfc\u5f0f \u00b6 \u5217\u8868\u63a8\u5bfc\u5f0f\uff08List Comprehensions\uff09\u662fPython\u5185\u7f6e\u7684\u4e00\u79cd\u751f\u6210\u5217\u8868\u7684\u7b80\u6d01\u65b9\u5f0f\uff0c\u540c\u7406\u53ef\u4ee5\u4f7f\u7528\u5b57\u5178\u63a8\u5bfc\u5f0f\u3001\u96c6\u5408\u63a8\u5bfc\u5f0f\u3002\u6ce8\u610f\u4e0d\u5b58\u5728\u5143\u7ec4\u63a8\u5bfc\u5f0f\u3002 # \u5217\u8868\u63a8\u5bfc\u5f0f\uff1a\u751f\u62101-100\u7684\u5947\u6570 odd = [i for i in range(1, 100) if i%2] # \u5b57\u5178\u63a8\u5bfc\u5f0f\uff1a\u7edf\u8ba1\u5b57\u7b26\u6570 word = 'hello word' letter_counts = {letter: word.count(letter) for letter in word if letter.strip()} # {'d': 1, 'w': 1, 'e': 1, 'r': 1, 'o': 2, 'l': 2, 'h': 1} # \u751f\u6210\u5668\u63a8\u5bfc\u5f0f # num_generator = (number for number in range(1, 6)) type(num_generator) # <class 'generotor'> for number in num_generator: print(number) \u5217\u8868\u63a8\u5bfc\u5f0f\u7684\u4e00\u4e2a\u6f5c\u5728\u7f3a\u9677\u662f\u5f53\u8f93\u5165\u975e\u5e38\u5927\u65f6\u4f1a\u4ea7\u751f\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u7ed3\u679c\u96c6\uff0c\u5360\u7528\u5927\u91cf\u5185\u5b58\uff1b\u5bf9\u5e94\u63aa\u65bd\u4e3a\u4f7f\u7528\u751f\u6210\u5668\uff08generator\uff09\u8868\u8fbe\u5f0f\u3002 \u751f\u6210\u5668\u8868\u8fbe\u5f0f\u7684\u4e00\u4e2a\u975e\u5e38\u4f18\u96c5\u7684\u5e94\u7528\u662f\u5148\u8f6c\u6362\u6216\u8fc7\u6ee4\u6570\u636e\uff0c\u7136\u540e\u4f5c\u4e3a\u805a\u96c6\u51fd\u6570\u5982 sum() \u3001 min() \u3001 max() \u7684\u53c2\u6570\u8fdb\u884c\u8ba1\u7b97 \u751f\u6210\u5668\u4ec5\u5728\u8fd0\u884c\u4e2d\u4ea7\u751f\u503c\uff0c\u518d\u6b21\u4f7f\u7528\u65f6\u5df2\u88ab\u64e6\u9664 # \u6c42\u5e73\u65b9\u548c nums = [1, 2, 3, 4, 5] s = sum(x * x for x in nums) # \u5224\u65ad\u662f\u5426\u5b58\u5728\u67d0\u7c7b\u578b\u6587\u4ef6 import os files = os.listdir('dirname') if any(name.endswith('.py') for name in files): print('There be python!') else: print('Sorry, no python.') \u5f53\u8fc7\u6ee4\u89c4\u5219\u6bd4\u8f83\u590d\u6742\uff0c\u4e0d\u80fd\u7b80\u5355\u5730\u5728\u5217\u8868\u63a8\u5bfc\u5f0f\u6216\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u4e2d\u8868\u8fbe\u51fa\u6765\uff08\u4f8b\u5982\u8fc7\u6ee4\u89c4\u5219\u6d89\u53ca\u5f02\u5e38\uff09\u65f6\uff0c\u53ef\u4ee5\u5c06\u8fc7\u6ee4\u4ee3\u7801\u653e\u5230\u4e00\u4e2a\u51fd\u6570\u4e2d\uff0c\u7136\u540e\u4f7f\u7528\u5185\u5efa\u7684 filter() \u51fd\u6570\u3002 filter() \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002 values = ['1', '2', '-3', '-', '4', 'N/A', '5'] def is_int(val): try: x = int(val) return True except ValueError: return False ivals = list(filter(is_int, values)) # ['1', '2', '-3', '4', '5'] \u547d\u540d\u5207\u7247 \u00b6 \u8fc7\u591a\u7684\u786c\u7f16\u7801\u7d22\u5f15\u503c\u5c06\u5bfc\u81f4\u4ee3\u7801\u53ef\u8bfb\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u964d\u4f4e\uff0c\u4f7f\u7528\u5185\u7f6e\u7684slice()\u51fd\u6570\u521b\u5efa\u5207\u7247\u5bf9\u8c61\uff0c\u53ef\u4ee5\u7528\u5728\u4efb\u4f55\u5141\u8bb8\u8fdb\u884c\u5207\u7247\u64cd\u4f5c\u7684\u5730\u65b9\u3002 items = [0, 1, 2, 3, 4, 5, 6] last_two = slice(-2, None) items[last_two] # [5, 6] else\u5b50\u53e5 \u00b6 for / while / try \u8bed\u53e5\u4e2d\u7684 else \u5b50\u53e5\u5c06\u5728\u5faa\u73af/\u5f02\u5e38\u68c0\u6d4b\u6b63\u5e38\u8fd0\u884c\u7ed3\u675f\uff0c\u5373\u4e0d\u662f\u901a\u8fc7 break / return \u8bed\u53e5\u6216\u662f\u5f02\u5e38\u9000\u51fa\u65f6\u6267\u884c\u3002 pools = [2,4,6] for num in pools: if num%2: break else: print(\"nothing found...\") # nothing found... # \u5982\u679ctry\u5757\u4ec5\u9700\u8981\u9632\u5b88dangerous_call()\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef\uff0c # \u90a3\u4e48\u4e3a\u4e86\u6e05\u6670\u660e\u786e\uff0cafter_call()\u5e94\u653e\u5728else\u5b50\u53e5\u6267\u884c try\uff1a dangerous_call() after_call() except OSError: log('OSError...') # better try: dangerous_call() except OSError: log('OSError...') else: after_call() \u4e0a\u4e0b\u6587\u7ba1\u7406\u5668 \u00b6 \u6211\u4eec\u901a\u5e38\u4f7f\u7528 with...as \u8bed\u53e5\u6765\u81ea\u52a8\u5904\u7406\u6587\u4ef6\u7684\u6253\u5f00\u548c\u5173\u95ed\uff0c\u5e76\u4e14**\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u53ef\u4ee5\u540c\u65f6\u7ba1\u7406\u591a\u4e2a\u8d44\u6e90**\u3002 with open('input.txt', 'r') as source, open('output.txt', 'w') as target: target.write(source.read()) \u5907\u6ce8\u4e00\u4e0b\u4ee5\u4e0a open() \u51fd\u6570\u5bf9\u4e8e\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u6362\u884c\u7b26\u7684\u8bc6\u522b\u95ee\u9898\uff1a Unix\u548cWindows\u4e2d\u7684\u6362\u884c\u7b26\u5206\u522b\u662f \\n \u548c \\r\\n \uff0cPython\u9ed8\u8ba4\u4f1a\u4ee5\u7edf\u4e00\u6a21\u5f0f\u5904\u7406\u6362\u884c\u7b26\u2014\u2014\u8bfb\u53d6\u6587\u672c\u7684\u65f6\u5019\uff0c\u8bc6\u522b\u6240\u6709\u7684\u666e\u901a\u6362\u884c\u7b26\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u5355\u4e2a \\n \u5b57\u7b26\uff1b\u8f93\u51fa\u6587\u672c\u65f6\uff0c\u5c06\u6362\u884c\u7b26 \\n \u8f6c\u6362\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u7684\u6362\u884c\u7b26\u3002 \u5982\u679c\u4e0d\u5e0c\u671b\u8fd9\u79cd\u9ed8\u8ba4\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u53ef\u4ee5\u7ed9 open() \u51fd\u6570\u4f20\u5165\u53c2\u6570 newline='' \u3002\u4f8b\u5982Linux\u4e0b\u6267\u884c\u5982\u4e0b\u4ee3\u7801\uff1a with open('hello.txt', 'rt') as f: print(f.read()) # 'hello world!\\n' with open('hello.txt', 'rt', newline='') as f: print(f.read()) # 'hello world!\\r\\n' \u81ea\u5b9a\u4e49\u6bd4\u8f83/\u6392\u5e8f \u00b6 max() / min() / sorted() \u7b49\u5168\u5c40\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7 key \u5173\u952e\u5b57\u6307\u5b9a\u6bd4\u8f83/\u6392\u5e8f\u7684\u6807\u51c6\u3002list\u7684\u5185\u7f6e\u51fd\u6570 sort \u4e5f\u5177\u6709\u7c7b\u4f3c\u4f7f\u7528\u65b9\u5f0f\uff1a # \u7edf\u8ba1\u5217\u8868\u4e2d\u9891\u6570\u6700\u9ad8\u7684\u5143\u7d20 num = [1,2,2,3,3,3,4,4,4,4] x = max(set(num), key=num.count) # x=4 # \u6392\u5e8f\u5217\u8868\u5e76\u83b7\u53d6\u6392\u5e8f\u540e\u5bf9\u5e94\u539f\u6765\u7684\u7d22\u5f15 data = [2,4,5,3] zip_data = list(zip(data, range(len(data)))) zip_data.sort(key=lambda x: x[0]) sorted_data, sorted_index = zip(*zip_data) # sorted_data=(2, 3, 4, 5) # sorted_index=(0, 3, 1, 2)","title":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#python3","text":"\u53d1\u5e03\u4e8e\uff1a2018-02-07 | \u5206\u7c7b\uff1a python/vba/cpp","title":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_1","text":"\u533a\u95f4\u5224\u65ad\u65f6\u53ef\u4ee5\u4f7f\u7528\u66f4\u4e3a\u76f4\u89c2\u7684\u94fe\u5f0f\u6bd4\u8f83\uff1a score = 88 if 80<score<90: print(\"come on...\") # come on...","title":"\u94fe\u5f0f\u6bd4\u8f83"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_2","text":"\u4f7f\u7528\u8d4b\u503c\u8bed\u53e5\u53ef\u4ee5\u89e3\u538b\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08\u5143\u7ec4\u3001\u5217\u8868\u3001\u5b57\u7b26\u4e32\u7b49\uff09\u5e76\u5c06\u5404\u4e2a\u5143\u7d20\u5206\u522b\u8d4b\u503c\u7ed9\u591a\u4e2a\u53d8\u91cf\u3002 x,y = 3,5 x,y = y,x # x=5, y=3 x,y = y, x+y # x=3, y=8 L = [1,2,(3,4)] a,b,c = L # a=1,b=2,c=(3,4) \u53d8\u91cf\u7684\u6570\u91cf\u5fc5\u987b\u8ddf\u5e8f\u5217\u5143\u7d20\u7684\u6570\u91cf\u4e00\u6837\uff0c\u5426\u5219\u4f1a\u4ea7\u751f ValueError \u5f02\u5e38\u3002 p = (4, 5) x, y, z = p Traceback (most recent call last): File \"<stdin>\", line 1, in <module> ValueError: need more than 2 values to unpack \u5f53\u786e\u5b9e\u9700\u8981\u4ee5\u8f83\u5c11\u6570\u91cf\u7684\u53d8\u91cf\u53bb\u89e3\u538b\u66f4\u591a\u5143\u7d20\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 \u661f\u53f7\u8868\u8fbe\u5f0f \u3002\u5176\u6548\u679c\u7c7b\u4f3c\u4e8e\u51fd\u6570\u7684\u53ef\u53d8\u4f4d\u7f6e\u53c2\u6570 *argv \u3002 x,*y,z = [3,5,7,9] # x=3, y=[5,7], z=9 # \u6ce8\u610f\u89e3\u538b\u51fa\u7684\u53d8\u91cfy\u4e3a\u5217\u8868\u7c7b\u578b\uff0c\u5373\u4fbf\u5143\u7d20\u6570\u91cf\u53ef\u80fd\u4e3a0 x,*y,z = [3,5] # x=3, y=[], z=5 # *x\u5c06x\u89e3\u538b\u4e3a(1,2,3), (4,5,6), (7,8,9) # \u7136\u540e\u4f5c\u4e3azip\u7684\u53c2\u6570 x=[[1,2,3],[4,5,6],[7,8,9]] [list(item) for item in zip(*x)] # [[1, 4, 7], [2, 5, 8], [3, 6, 9]] \u5982\u679c\u53ea\u60f3\u89e3\u538b\u4e00\u90e8\u5206\u800c\u4e22\u5f03\u5176\u4ed6\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u53d8\u91cf\u540d\u5360\u4f4d\uff1a L = [1,2,(3,4)] _, _, x = L # x=(3,4)","title":"\u89e3\u538b\u53ef\u8fed\u4ee3\u5bf9\u8c61"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_3","text":"\u76f4\u63a5\u4f7f\u7528 for...in \u8bed\u53e5\u904d\u5386\uff0c\u7ed3\u5408 reversed() \u548c sorted() \u51fd\u6570\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u987a\u5e8f\u904d\u5386\uff1a colors = ['red', 'green', 'blue', 'yellow'] # \u904d\u5386\u5217\u8868 for color in colors: print(color) # \u53cd\u5411\u904d\u5386 for color in reversed(colors): print(color) # \u6309\u5b57\u6bcd\u6392\u5e8f\u904d\u5386 for color in sorted(colors): print(color) # \u6309\u5b57\u6bcd\u9006\u5e8f\u904d\u5386 for color in sorted(colors, reverse=True): print(color) # \u81ea\u5b9a\u4e49\u6392\u5e8f\uff08\u4f8b\u5982\u5b57\u7b26\u4e32\u957f\u5ea6\uff09\u904d\u5386 for color in sorted(colors, key=len): # key\u53ef\u4ee5\u4f7f\u7528lambda\u8868\u8fbe\u5f0f print(color) \u4f7f\u7528 enumerate() \u83b7\u53d6\u904d\u5386\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f7f\u7528 zip() \u540c\u65f6\u904d\u5386\u591a\u4e2a\u5217\u8868\uff1a colors = ['red', 'green', 'blue', 'yellow'] bodies = ['sphere', 'cylinder', 'block'] for i, color in enumerate(colors, start=100): print(i, '--->', color) # 100 ---> red # 101 ---> green # 102 ---> blue # 103 ---> yellow for body, color in zip(bodies, colors): print(body, '--->', color) # sphere ---> red # cylinder ---> green # block ---> blue","title":"\u904d\u5386\u5217\u8868/\u5143\u7ec4"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_4","text":"# \u4ece\u4e24\u4e2a\u5217\u8868\u521b\u5efa\u5b57\u5178 colors = ['red', 'green', 'blue', 'yellow'] bodies = ['sphere', 'cylinder', 'block'] d = dict(zip(bodies, colors)) # d = {'sphere':'red', 'cylinder':'green', 'block':'blue'} # \u904d\u5386\u5b57\u5178 for k, v in d.items(): print(k, '--->', v)","title":"\u904d\u5386\u5b57\u5178"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_5","text":"\u96c6\u5408\u7684\u4ea4\u3001\u5dee\u3001\u5e76\u8fd0\u7b97\uff1a x=set([1,2,4]) y=set([3,4,5]) x&y # \u4ea4\u96c6 # {4} x-y # \u5dee\u96c6 # {1, 2} x|y # \u5e76\u96c6 # {1, 2, 3, 4, 5} \u5b57\u5178\u662f \u952e\u96c6\u5408 \u4e0e \u503c\u96c6\u5408 \u7684\u6620\u5c04\u5173\u7cfb\u3002\u5b57\u5178\u7684 keys() \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5c55\u73b0\u952e\u96c6\u5408\u7684\u952e\u89c6\u56fe\u5bf9\u8c61\u3002\u952e\u89c6\u56fe\u4e5f\u652f\u6301\u96c6\u5408\u64cd\u4f5c\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u952e\u89c6\u56fe\u5bf9\u8c61\u6267\u884c\u666e\u901a\u7684\u96c6\u5408\u64cd\u4f5c\u3002 a = {'x' : 1, 'y' : 2, 'z' : 3} b = {'w' : 10, 'x' : 11, 'y' : 2} # \u4e24\u4e2a\u5b57\u5178\u7684\u516c\u5171\u952e a.keys() & b.keys() # { 'x', 'y' } # \u4ec5\u5728\u5b57\u5178a\u4e2d\u5b58\u5728\u7684\u952e a.keys() - b.keys() # { 'z' } # \u4e24\u4e2a\u5b57\u5178\u7684\u516c\u5171\u5143\u7d20 a.items() & b.items() # { ('y', 2) } \u5b57\u5178\u7684 items() \u65b9\u6cd5\u540c\u7406\uff0c\u4f46\u662f\u7531\u4e8e\u4e0d\u80fd\u4fdd\u8bc1 values() \u65b9\u6cd5\u7684\u6240\u6709\u503c\u4e92\u4e0d\u76f8\u540c\uff0c\u6545\u4e0d\u80fd\u76f4\u63a5\u8fdb\u884c\u96c6\u5408\u64cd\u4f5c\u2014\u2014\u4e0d\u8fc7\u53ef\u4ee5\u5148\u5c06\u503c\u96c6\u5408\u8f6c\u6362\u6210 set \uff0c\u7136\u540e\u518d\u6267\u884c\u96c6\u5408\u8fd0\u7b97\u3002","title":"\u96c6\u5408\u8fd0\u7b97"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_6","text":"\u5217\u8868\u63a8\u5bfc\u5f0f\uff08List Comprehensions\uff09\u662fPython\u5185\u7f6e\u7684\u4e00\u79cd\u751f\u6210\u5217\u8868\u7684\u7b80\u6d01\u65b9\u5f0f\uff0c\u540c\u7406\u53ef\u4ee5\u4f7f\u7528\u5b57\u5178\u63a8\u5bfc\u5f0f\u3001\u96c6\u5408\u63a8\u5bfc\u5f0f\u3002\u6ce8\u610f\u4e0d\u5b58\u5728\u5143\u7ec4\u63a8\u5bfc\u5f0f\u3002 # \u5217\u8868\u63a8\u5bfc\u5f0f\uff1a\u751f\u62101-100\u7684\u5947\u6570 odd = [i for i in range(1, 100) if i%2] # \u5b57\u5178\u63a8\u5bfc\u5f0f\uff1a\u7edf\u8ba1\u5b57\u7b26\u6570 word = 'hello word' letter_counts = {letter: word.count(letter) for letter in word if letter.strip()} # {'d': 1, 'w': 1, 'e': 1, 'r': 1, 'o': 2, 'l': 2, 'h': 1} # \u751f\u6210\u5668\u63a8\u5bfc\u5f0f # num_generator = (number for number in range(1, 6)) type(num_generator) # <class 'generotor'> for number in num_generator: print(number) \u5217\u8868\u63a8\u5bfc\u5f0f\u7684\u4e00\u4e2a\u6f5c\u5728\u7f3a\u9677\u662f\u5f53\u8f93\u5165\u975e\u5e38\u5927\u65f6\u4f1a\u4ea7\u751f\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u7ed3\u679c\u96c6\uff0c\u5360\u7528\u5927\u91cf\u5185\u5b58\uff1b\u5bf9\u5e94\u63aa\u65bd\u4e3a\u4f7f\u7528\u751f\u6210\u5668\uff08generator\uff09\u8868\u8fbe\u5f0f\u3002 \u751f\u6210\u5668\u8868\u8fbe\u5f0f\u7684\u4e00\u4e2a\u975e\u5e38\u4f18\u96c5\u7684\u5e94\u7528\u662f\u5148\u8f6c\u6362\u6216\u8fc7\u6ee4\u6570\u636e\uff0c\u7136\u540e\u4f5c\u4e3a\u805a\u96c6\u51fd\u6570\u5982 sum() \u3001 min() \u3001 max() \u7684\u53c2\u6570\u8fdb\u884c\u8ba1\u7b97 \u751f\u6210\u5668\u4ec5\u5728\u8fd0\u884c\u4e2d\u4ea7\u751f\u503c\uff0c\u518d\u6b21\u4f7f\u7528\u65f6\u5df2\u88ab\u64e6\u9664 # \u6c42\u5e73\u65b9\u548c nums = [1, 2, 3, 4, 5] s = sum(x * x for x in nums) # \u5224\u65ad\u662f\u5426\u5b58\u5728\u67d0\u7c7b\u578b\u6587\u4ef6 import os files = os.listdir('dirname') if any(name.endswith('.py') for name in files): print('There be python!') else: print('Sorry, no python.') \u5f53\u8fc7\u6ee4\u89c4\u5219\u6bd4\u8f83\u590d\u6742\uff0c\u4e0d\u80fd\u7b80\u5355\u5730\u5728\u5217\u8868\u63a8\u5bfc\u5f0f\u6216\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u4e2d\u8868\u8fbe\u51fa\u6765\uff08\u4f8b\u5982\u8fc7\u6ee4\u89c4\u5219\u6d89\u53ca\u5f02\u5e38\uff09\u65f6\uff0c\u53ef\u4ee5\u5c06\u8fc7\u6ee4\u4ee3\u7801\u653e\u5230\u4e00\u4e2a\u51fd\u6570\u4e2d\uff0c\u7136\u540e\u4f7f\u7528\u5185\u5efa\u7684 filter() \u51fd\u6570\u3002 filter() \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002 values = ['1', '2', '-3', '-', '4', 'N/A', '5'] def is_int(val): try: x = int(val) return True except ValueError: return False ivals = list(filter(is_int, values)) # ['1', '2', '-3', '4', '5']","title":"\u5217\u8868\u63a8\u5bfc\u5f0f"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_7","text":"\u8fc7\u591a\u7684\u786c\u7f16\u7801\u7d22\u5f15\u503c\u5c06\u5bfc\u81f4\u4ee3\u7801\u53ef\u8bfb\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u964d\u4f4e\uff0c\u4f7f\u7528\u5185\u7f6e\u7684slice()\u51fd\u6570\u521b\u5efa\u5207\u7247\u5bf9\u8c61\uff0c\u53ef\u4ee5\u7528\u5728\u4efb\u4f55\u5141\u8bb8\u8fdb\u884c\u5207\u7247\u64cd\u4f5c\u7684\u5730\u65b9\u3002 items = [0, 1, 2, 3, 4, 5, 6] last_two = slice(-2, None) items[last_two] # [5, 6]","title":"\u547d\u540d\u5207\u7247"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#else","text":"for / while / try \u8bed\u53e5\u4e2d\u7684 else \u5b50\u53e5\u5c06\u5728\u5faa\u73af/\u5f02\u5e38\u68c0\u6d4b\u6b63\u5e38\u8fd0\u884c\u7ed3\u675f\uff0c\u5373\u4e0d\u662f\u901a\u8fc7 break / return \u8bed\u53e5\u6216\u662f\u5f02\u5e38\u9000\u51fa\u65f6\u6267\u884c\u3002 pools = [2,4,6] for num in pools: if num%2: break else: print(\"nothing found...\") # nothing found... # \u5982\u679ctry\u5757\u4ec5\u9700\u8981\u9632\u5b88dangerous_call()\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef\uff0c # \u90a3\u4e48\u4e3a\u4e86\u6e05\u6670\u660e\u786e\uff0cafter_call()\u5e94\u653e\u5728else\u5b50\u53e5\u6267\u884c try\uff1a dangerous_call() after_call() except OSError: log('OSError...') # better try: dangerous_call() except OSError: log('OSError...') else: after_call()","title":"else\u5b50\u53e5"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_8","text":"\u6211\u4eec\u901a\u5e38\u4f7f\u7528 with...as \u8bed\u53e5\u6765\u81ea\u52a8\u5904\u7406\u6587\u4ef6\u7684\u6253\u5f00\u548c\u5173\u95ed\uff0c\u5e76\u4e14**\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u53ef\u4ee5\u540c\u65f6\u7ba1\u7406\u591a\u4e2a\u8d44\u6e90**\u3002 with open('input.txt', 'r') as source, open('output.txt', 'w') as target: target.write(source.read()) \u5907\u6ce8\u4e00\u4e0b\u4ee5\u4e0a open() \u51fd\u6570\u5bf9\u4e8e\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u6362\u884c\u7b26\u7684\u8bc6\u522b\u95ee\u9898\uff1a Unix\u548cWindows\u4e2d\u7684\u6362\u884c\u7b26\u5206\u522b\u662f \\n \u548c \\r\\n \uff0cPython\u9ed8\u8ba4\u4f1a\u4ee5\u7edf\u4e00\u6a21\u5f0f\u5904\u7406\u6362\u884c\u7b26\u2014\u2014\u8bfb\u53d6\u6587\u672c\u7684\u65f6\u5019\uff0c\u8bc6\u522b\u6240\u6709\u7684\u666e\u901a\u6362\u884c\u7b26\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u5355\u4e2a \\n \u5b57\u7b26\uff1b\u8f93\u51fa\u6587\u672c\u65f6\uff0c\u5c06\u6362\u884c\u7b26 \\n \u8f6c\u6362\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u7684\u6362\u884c\u7b26\u3002 \u5982\u679c\u4e0d\u5e0c\u671b\u8fd9\u79cd\u9ed8\u8ba4\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u53ef\u4ee5\u7ed9 open() \u51fd\u6570\u4f20\u5165\u53c2\u6570 newline='' \u3002\u4f8b\u5982Linux\u4e0b\u6267\u884c\u5982\u4e0b\u4ee3\u7801\uff1a with open('hello.txt', 'rt') as f: print(f.read()) # 'hello world!\\n' with open('hello.txt', 'rt', newline='') as f: print(f.read()) # 'hello world!\\r\\n'","title":"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668"},{"location":"2018-02-07-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#_9","text":"max() / min() / sorted() \u7b49\u5168\u5c40\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7 key \u5173\u952e\u5b57\u6307\u5b9a\u6bd4\u8f83/\u6392\u5e8f\u7684\u6807\u51c6\u3002list\u7684\u5185\u7f6e\u51fd\u6570 sort \u4e5f\u5177\u6709\u7c7b\u4f3c\u4f7f\u7528\u65b9\u5f0f\uff1a # \u7edf\u8ba1\u5217\u8868\u4e2d\u9891\u6570\u6700\u9ad8\u7684\u5143\u7d20 num = [1,2,2,3,3,3,4,4,4,4] x = max(set(num), key=num.count) # x=4 # \u6392\u5e8f\u5217\u8868\u5e76\u83b7\u53d6\u6392\u5e8f\u540e\u5bf9\u5e94\u539f\u6765\u7684\u7d22\u5f15 data = [2,4,5,3] zip_data = list(zip(data, range(len(data)))) zip_data.sort(key=lambda x: x[0]) sorted_data, sorted_index = zip(*zip_data) # sorted_data=(2, 3, 4, 5) # sorted_index=(0, 3, 1, 2)","title":"\u81ea\u5b9a\u4e49\u6bd4\u8f83/\u6392\u5e8f"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/","text":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-02-08 | \u5206\u7c7b\uff1a python/vba/cpp \u53bb\u9664\u5b57\u7b26\u4e32\u524d\u540e\u6307\u5b9a\u5b57\u7b26 \u00b6 str.strip([chars])--\u53bb\u9664\u5b57\u7b26\u4e32\u524d\u540e\u4e24\u8fb9\u7684\u6307\u5b9a\u5b57\u7b26 str.lstrip([chars])--\u53bb\u9664\u5b57\u7b26\u4e32\u524d\u8fb9\u7684\u6307\u5b9a\u5b57\u7b26 str.rstrip([chars])--\u53bb\u9664\u5b57\u7b26\u4e32\u540e\u8fb9\u7684\u6307\u5b9a\u5b57\u7b26 # \u53c2\u6570\u4e3aNone\u5219\u9ed8\u8ba4\u53bb\u9664\u7a7a\u767d\u5b57\u7b26\uff08\u7a7a\u683c\uff0c\u6362\u884c\uff0c\u5236\u8868\u7b26\uff09 s = ' \\t hello world \\n' s.strip() # 'hello world' s.lstrip() # 'hello world \\n' s.rstrip() # ' \\t hello world' # \u6307\u5b9a\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u8868\u793a\u8981\u5220\u9664\u5b57\u7b26\u7684\u96c6\u5408 s = '-----hello world=====' s.strip('-=') # 'hello world' s.lstrip('-') # 'hello world=====' s.rstrip('=') # '-----hello world' \u5b57\u7b26\u4e32\u66ff\u6362 \u00b6 strip() \u53ea\u80fd\u53bb\u9664\u5b57\u7b26\u4e32\u4e24\u4fa7\u7684\u5185\u5bb9\uff0c\u5bf9\u4f4d\u4e8e\u4e2d\u95f4\u4f4d\u7f6e\u7684\u4efb\u4f55\u6587\u672c\u4e0d\u8d77\u4f5c\u7528\u3002\u5bf9\u4efb\u610f\u4f4d\u7f6e\u7684\u5b57\u7b26\u5220\u9664\u53ef\u4ee5\u501f\u52a9 replace() \u51fd\u6570\u5b9e\u73b0\u3002 str.replace(old, new[, max])--\u628a\u65e7\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u65b0\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u5168\u90e8\u66ff\u6362\uff1b\u82e5\u6307\u5b9a\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u5219\u66ff\u6362\u6b21\u6570\u4e0d\u8d85\u8fc7max str = \"hello world\"; new_str = str.replace(\"l\", \"\", 2) # 'heo world' \u5bf9\u4e8e\u5b57\u7b26\u4e32\u6a21\u677f\u7684\u66ff\u6362\uff0c\u53ef\u4ee5\u5728\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528 {var} \u6807\u8bb0\u9700\u8981\u66ff\u6362\u7684\u53d8\u91cf\u540d\uff0c\u7136\u540e\u4f7f\u7528 format() \u65b9\u6cd5\u66ff\u6362\u53d8\u91cf\u5185\u5bb9\u3002 # \u987a\u5e8f\u53d8\u91cf '{2}, {1}, {0}'.format(*'abc') # 'c, b, a' # \u547d\u540d\u53d8\u91cf str = '{name} has {n} messages.' str.format(name='Guido', n=37) # 'Guido has 37 messages.' \u5b57\u7b26\u4e32\u5f00\u5934/\u7ed3\u5c3e\u5185\u5bb9\u5224\u65ad \u00b6 \u5b57\u7b26\u4e32\u7684 startswith() \u548c endswith() \u51fd\u6570\u5206\u522b\u53ef\u7528\u4e8e\u5bf9\u5b57\u7b26\u4e32\u8d77\u59cb/\u7ed3\u675f\u6587\u672c\u5185\u5bb9\u7684\u5224\u65ad\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \u5f53\u4f20\u5165\u5143\u7ec4\u7c7b\u578b\u53c2\u6570\u65f6\uff0c\u8868\u793a\u5339\u914d\u5176\u4e2d\u4efb\u610f\u5143\u7d20 \u3002 s = [\"hello\",\"python\",\"world\"] res = [s0 for s0 in s if s0.startswith((\"h\",\"wo\"))] # res=['hello', 'world'] \u5b57\u7b26\u4e32\u62fc\u63a5/\u62c6\u5206 \u00b6 split() \u548c join() \u5206\u522b\u8d77\u5230\u62c6\u5206\u548c\u62fc\u63a5\u5b57\u7b26\u4e32\u7684\u4f5c\u7528: # split\u62c6\u5206\u5b57\u7b26\u4e32\u4e3a\u5217\u8868 s = 'hello python world' L = s.split(\" \") # join\u62fc\u63a5\u5217\u8868\u5143\u7d20\u4e3a\u5b57\u7b26\u4e32 res = \"-\".join(L) # 'hello-python-world' \u5982\u679c\u9700\u8981 \u6309\u884c( '\\r', '\\r\\n', \\n' )\u5206\u9694\u5b57\u7b26\u4e32\uff0c\u5219\u53ef\u4f7f\u7528 splitlines() : # string.splitlines([keepends])\u6309\u7167\u884c\u62c6\u5206\u5b57\u7b26\u4e32 # \u53c2\u6570keepends\u9ed8\u8ba4\u4e3aFalse\uff0c\u4e0d\u5305\u542b\u6362\u884c\u7b26\uff1b\u5982\u679c\u4e3aTrue\uff0c\u5219\u4fdd\u7559\u6362\u884c\u7b26 str = 'hello\\n\\npython\\rworld\\r\\n' res1 = str.splitlines() # ['hello', '', 'python', 'world'] res2 = str.splitlines(True) # ['hello\\n', '\\n', 'python\\r', 'world\\r\\n'] string \u5bf9\u8c61\u7684 split() \u65b9\u6cd5\u53ea\u9002\u5e94\u4e8e\u975e\u5e38\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u5206\u5272\u60c5\u5f62\uff0c \u65e0\u6cd5\u5904\u7406\u591a\u4e2a\u5206\u9694\u7b26\u6216\u8005\u662f\u5206\u9694\u7b26\u5468\u56f4\u4e0d\u786e\u5b9a\u7684\u7a7a\u683c\u3002\u4f7f\u7528 re.split() \u65b9\u6cd5\u5219\u53ef\u4ee5\u66f4\u52a0\u7075\u6d3b\u5730\u5207\u5272\u5b57\u7b26\u4e32\uff1a import re str = 'asdf fjdk; afed, fjek,asdf, foo' re.split(r'[;,\\s]\\s*', line) # ['asdf', 'fjdk', 'afed', 'fjek', 'asdf', 'foo'] \u5b57\u7b26\u4e32\u5bf9\u9f50 \u00b6 str.ljust(width,[fillchar])--\u8f93\u51fawidth\u4e2a\u5b57\u7b26\uff0cstr\u5de6\u5bf9\u9f50\uff0c\u4e0d\u8db3\u90e8\u5206\u7528fillchar\uff08\u9ed8\u8ba4\u4e3a\u7a7a\u683c\uff09\u586b\u5145 str.rjust(width,[fillchar])--\u53f3\u5bf9\u9f50 str.center(width, [fillchar])--\u4e2d\u95f4\u5bf9\u9f50 str.zfill(width)--\u7c7b\u4f3cstr.rjust\uff0c\u4e0d\u8db3\u90e8\u5206\u586b\u51450 s = \"hello world\" print(s.ljust(20, '*')) print(s.center(20, '*')) print(s.rjust(20, '*')) # hello world********* # ****hello world***** # *********hello world s = \"123\" print(s.zfill(6)) # 000123 \u4ee5\u4e0a\u65b9\u6cd5\u4ec5\u9488\u5bf9\u5b57\u7b26\u4e32\u7684\u5bf9\u9f50\u64cd\u4f5c\uff0c\u66f4\u4e3a\u901a\u7528\u7684\u65b9\u6cd5\u662f\u51fd\u6570 format() \uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u683c\u5f0f\u5316\u4efb\u610f\u5bf9\u8c61\u3002 \u4f7f\u7528 < \u3001 > \u6216 ^ \u540e\u7d27\u8ddf\u4e00\u4e2a\u6307\u5b9a\u7684\u5bbd\u5ea6\uff0c\u5206\u522b\u7528\u6765\u8868\u793a\u5de6\u5bf9\u9f50\u3001\u53f3\u5bf9\u9f50\u548c\u4e2d\u95f4\u5bf9\u9f50\u3002\u82e5\u8981\u6307\u5b9a\u4e00\u4e2a\u975e\u7a7a\u683c\u7684\u586b\u5145\u5b57\u7b26\uff0c\u5c06\u5176\u5199\u5230\u5bf9\u9f50\u5b57\u7b26\u4e4b\u524d\u5373\u53ef\uff1a # \u5bf9\u9f50\u5b57\u7b26\u4e32 x = 'Hello World' format(x, '<20') # 'Hello World ' format(x, '=>20s') # '=========Hello World' format(x, '*^20s') # '****Hello World*****' # \u5bf9\u9f50\u6d6e\u70b9\u6570 x = 1.2345 format(x, '>10') # ' 1.2345' \u5f53\u683c\u5f0f\u5316\u591a\u4e2a\u503c\u65f6\uff0c\u8fd9\u4e9b\u683c\u5f0f\u4ee3\u7801\u4e5f\u53ef\u4ee5\u88ab\u7528\u5728 format() \u65b9\u6cd5\u4e2d\uff1a '{:>10s} {:>10s}'.format('Hello', 'World') # ' Hello World' \u547d\u540d\u683c\u5f0f\u5316\u5b57\u7b26\u4e32 \u00b6 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cPython\u4f7f\u7528 tuple \u4f20\u9012\u5b57\u7b26\u4e32\u6a21\u677f\u9884\u7559\u4f4d\u7f6e\u7684\u503c\u3002\u5b9e\u9645\u4e0a\uff0c\u53ef\u4ee5\u4f9d\u6b21\u547d\u540d\u9884\u7559\u4f4d\u7f6e\uff0c\u7136\u540e\u4f7f\u7528 dict \u4f20\u5165\u53d8\u91cf\uff1a msg = '''%(student.name)s is %(student.age)d years old.''' item = {\"student.name\": \"XiaoMing\", \"student.age\": 16} print(msg % item) # XiaoMing is 16 years old. \u5b8c\u6574\u4f7f\u7528\u53c2\u8003\uff1a %[(name)][flags][width].[precision]typecode (name)\uff1a\u547d\u540d flags\uff1a\u53f3\u5bf9\u9f50\uff08 + \uff09\uff0c\u5de6\u5bf9\u9f50\uff08 - \uff09\uff0c\u6b63\u6570\u5de6\u4fa7\u586b\u5145\u4e00\u4e2a\u7a7a\u683c\u4f7f\u4e4b\u4e0e\u8d1f\u6570\u5bf9\u9f50\uff08 \uff09\uff0c\u4f7f\u75280\u586b\u5145\uff08 0 \uff09 width\uff1a\u663e\u793a\u5bbd\u5ea6 precision\uff1a\u5c0f\u6570\u70b9\u540e\u7cbe\u5ea6 typecode\uff1a\u683c\u5f0f\u7c7b\u578b\u7801\uff0c\u4f8b\u5982\u5b57\u7b26\u4e32\uff08 %s \uff0c %r \uff09\uff0c\u5355\u4e2a\u5b57\u7b26\uff08 %c \uff09\uff0c\u4e8c\u3001\u516b\u3001\u5341\u3001\u5341\u516d\u8fdb\u5236\u6574\u6570\uff08 %b, %o, %d, %x \uff09\uff0c\u6d6e\u70b9\u662f\uff08 %f \uff09 \u5176\u4e2d width , precision \u4e3a\u4e24\u4e2a\u6574\u6570\uff0c\u53ef\u4ee5\u5229\u7528 * \u6765\u52a8\u6001\u4ee3\u5165\uff1a s = \"%*.*f\" %(5,4,1.234) print(s) # 1.2340","title":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#python3","text":"\u53d1\u5e03\u4e8e\uff1a2018-02-08 | \u5206\u7c7b\uff1a python/vba/cpp","title":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#_1","text":"str.strip([chars])--\u53bb\u9664\u5b57\u7b26\u4e32\u524d\u540e\u4e24\u8fb9\u7684\u6307\u5b9a\u5b57\u7b26 str.lstrip([chars])--\u53bb\u9664\u5b57\u7b26\u4e32\u524d\u8fb9\u7684\u6307\u5b9a\u5b57\u7b26 str.rstrip([chars])--\u53bb\u9664\u5b57\u7b26\u4e32\u540e\u8fb9\u7684\u6307\u5b9a\u5b57\u7b26 # \u53c2\u6570\u4e3aNone\u5219\u9ed8\u8ba4\u53bb\u9664\u7a7a\u767d\u5b57\u7b26\uff08\u7a7a\u683c\uff0c\u6362\u884c\uff0c\u5236\u8868\u7b26\uff09 s = ' \\t hello world \\n' s.strip() # 'hello world' s.lstrip() # 'hello world \\n' s.rstrip() # ' \\t hello world' # \u6307\u5b9a\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u8868\u793a\u8981\u5220\u9664\u5b57\u7b26\u7684\u96c6\u5408 s = '-----hello world=====' s.strip('-=') # 'hello world' s.lstrip('-') # 'hello world=====' s.rstrip('=') # '-----hello world'","title":"\u53bb\u9664\u5b57\u7b26\u4e32\u524d\u540e\u6307\u5b9a\u5b57\u7b26"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#_2","text":"strip() \u53ea\u80fd\u53bb\u9664\u5b57\u7b26\u4e32\u4e24\u4fa7\u7684\u5185\u5bb9\uff0c\u5bf9\u4f4d\u4e8e\u4e2d\u95f4\u4f4d\u7f6e\u7684\u4efb\u4f55\u6587\u672c\u4e0d\u8d77\u4f5c\u7528\u3002\u5bf9\u4efb\u610f\u4f4d\u7f6e\u7684\u5b57\u7b26\u5220\u9664\u53ef\u4ee5\u501f\u52a9 replace() \u51fd\u6570\u5b9e\u73b0\u3002 str.replace(old, new[, max])--\u628a\u65e7\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u65b0\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u5168\u90e8\u66ff\u6362\uff1b\u82e5\u6307\u5b9a\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u5219\u66ff\u6362\u6b21\u6570\u4e0d\u8d85\u8fc7max str = \"hello world\"; new_str = str.replace(\"l\", \"\", 2) # 'heo world' \u5bf9\u4e8e\u5b57\u7b26\u4e32\u6a21\u677f\u7684\u66ff\u6362\uff0c\u53ef\u4ee5\u5728\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528 {var} \u6807\u8bb0\u9700\u8981\u66ff\u6362\u7684\u53d8\u91cf\u540d\uff0c\u7136\u540e\u4f7f\u7528 format() \u65b9\u6cd5\u66ff\u6362\u53d8\u91cf\u5185\u5bb9\u3002 # \u987a\u5e8f\u53d8\u91cf '{2}, {1}, {0}'.format(*'abc') # 'c, b, a' # \u547d\u540d\u53d8\u91cf str = '{name} has {n} messages.' str.format(name='Guido', n=37) # 'Guido has 37 messages.'","title":"\u5b57\u7b26\u4e32\u66ff\u6362"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#_3","text":"\u5b57\u7b26\u4e32\u7684 startswith() \u548c endswith() \u51fd\u6570\u5206\u522b\u53ef\u7528\u4e8e\u5bf9\u5b57\u7b26\u4e32\u8d77\u59cb/\u7ed3\u675f\u6587\u672c\u5185\u5bb9\u7684\u5224\u65ad\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \u5f53\u4f20\u5165\u5143\u7ec4\u7c7b\u578b\u53c2\u6570\u65f6\uff0c\u8868\u793a\u5339\u914d\u5176\u4e2d\u4efb\u610f\u5143\u7d20 \u3002 s = [\"hello\",\"python\",\"world\"] res = [s0 for s0 in s if s0.startswith((\"h\",\"wo\"))] # res=['hello', 'world']","title":"\u5b57\u7b26\u4e32\u5f00\u5934/\u7ed3\u5c3e\u5185\u5bb9\u5224\u65ad"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#_4","text":"split() \u548c join() \u5206\u522b\u8d77\u5230\u62c6\u5206\u548c\u62fc\u63a5\u5b57\u7b26\u4e32\u7684\u4f5c\u7528: # split\u62c6\u5206\u5b57\u7b26\u4e32\u4e3a\u5217\u8868 s = 'hello python world' L = s.split(\" \") # join\u62fc\u63a5\u5217\u8868\u5143\u7d20\u4e3a\u5b57\u7b26\u4e32 res = \"-\".join(L) # 'hello-python-world' \u5982\u679c\u9700\u8981 \u6309\u884c( '\\r', '\\r\\n', \\n' )\u5206\u9694\u5b57\u7b26\u4e32\uff0c\u5219\u53ef\u4f7f\u7528 splitlines() : # string.splitlines([keepends])\u6309\u7167\u884c\u62c6\u5206\u5b57\u7b26\u4e32 # \u53c2\u6570keepends\u9ed8\u8ba4\u4e3aFalse\uff0c\u4e0d\u5305\u542b\u6362\u884c\u7b26\uff1b\u5982\u679c\u4e3aTrue\uff0c\u5219\u4fdd\u7559\u6362\u884c\u7b26 str = 'hello\\n\\npython\\rworld\\r\\n' res1 = str.splitlines() # ['hello', '', 'python', 'world'] res2 = str.splitlines(True) # ['hello\\n', '\\n', 'python\\r', 'world\\r\\n'] string \u5bf9\u8c61\u7684 split() \u65b9\u6cd5\u53ea\u9002\u5e94\u4e8e\u975e\u5e38\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u5206\u5272\u60c5\u5f62\uff0c \u65e0\u6cd5\u5904\u7406\u591a\u4e2a\u5206\u9694\u7b26\u6216\u8005\u662f\u5206\u9694\u7b26\u5468\u56f4\u4e0d\u786e\u5b9a\u7684\u7a7a\u683c\u3002\u4f7f\u7528 re.split() \u65b9\u6cd5\u5219\u53ef\u4ee5\u66f4\u52a0\u7075\u6d3b\u5730\u5207\u5272\u5b57\u7b26\u4e32\uff1a import re str = 'asdf fjdk; afed, fjek,asdf, foo' re.split(r'[;,\\s]\\s*', line) # ['asdf', 'fjdk', 'afed', 'fjek', 'asdf', 'foo']","title":"\u5b57\u7b26\u4e32\u62fc\u63a5/\u62c6\u5206"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#_5","text":"str.ljust(width,[fillchar])--\u8f93\u51fawidth\u4e2a\u5b57\u7b26\uff0cstr\u5de6\u5bf9\u9f50\uff0c\u4e0d\u8db3\u90e8\u5206\u7528fillchar\uff08\u9ed8\u8ba4\u4e3a\u7a7a\u683c\uff09\u586b\u5145 str.rjust(width,[fillchar])--\u53f3\u5bf9\u9f50 str.center(width, [fillchar])--\u4e2d\u95f4\u5bf9\u9f50 str.zfill(width)--\u7c7b\u4f3cstr.rjust\uff0c\u4e0d\u8db3\u90e8\u5206\u586b\u51450 s = \"hello world\" print(s.ljust(20, '*')) print(s.center(20, '*')) print(s.rjust(20, '*')) # hello world********* # ****hello world***** # *********hello world s = \"123\" print(s.zfill(6)) # 000123 \u4ee5\u4e0a\u65b9\u6cd5\u4ec5\u9488\u5bf9\u5b57\u7b26\u4e32\u7684\u5bf9\u9f50\u64cd\u4f5c\uff0c\u66f4\u4e3a\u901a\u7528\u7684\u65b9\u6cd5\u662f\u51fd\u6570 format() \uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u683c\u5f0f\u5316\u4efb\u610f\u5bf9\u8c61\u3002 \u4f7f\u7528 < \u3001 > \u6216 ^ \u540e\u7d27\u8ddf\u4e00\u4e2a\u6307\u5b9a\u7684\u5bbd\u5ea6\uff0c\u5206\u522b\u7528\u6765\u8868\u793a\u5de6\u5bf9\u9f50\u3001\u53f3\u5bf9\u9f50\u548c\u4e2d\u95f4\u5bf9\u9f50\u3002\u82e5\u8981\u6307\u5b9a\u4e00\u4e2a\u975e\u7a7a\u683c\u7684\u586b\u5145\u5b57\u7b26\uff0c\u5c06\u5176\u5199\u5230\u5bf9\u9f50\u5b57\u7b26\u4e4b\u524d\u5373\u53ef\uff1a # \u5bf9\u9f50\u5b57\u7b26\u4e32 x = 'Hello World' format(x, '<20') # 'Hello World ' format(x, '=>20s') # '=========Hello World' format(x, '*^20s') # '****Hello World*****' # \u5bf9\u9f50\u6d6e\u70b9\u6570 x = 1.2345 format(x, '>10') # ' 1.2345' \u5f53\u683c\u5f0f\u5316\u591a\u4e2a\u503c\u65f6\uff0c\u8fd9\u4e9b\u683c\u5f0f\u4ee3\u7801\u4e5f\u53ef\u4ee5\u88ab\u7528\u5728 format() \u65b9\u6cd5\u4e2d\uff1a '{:>10s} {:>10s}'.format('Hello', 'World') # ' Hello World'","title":"\u5b57\u7b26\u4e32\u5bf9\u9f50"},{"location":"2018-02-08-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/#_6","text":"\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cPython\u4f7f\u7528 tuple \u4f20\u9012\u5b57\u7b26\u4e32\u6a21\u677f\u9884\u7559\u4f4d\u7f6e\u7684\u503c\u3002\u5b9e\u9645\u4e0a\uff0c\u53ef\u4ee5\u4f9d\u6b21\u547d\u540d\u9884\u7559\u4f4d\u7f6e\uff0c\u7136\u540e\u4f7f\u7528 dict \u4f20\u5165\u53d8\u91cf\uff1a msg = '''%(student.name)s is %(student.age)d years old.''' item = {\"student.name\": \"XiaoMing\", \"student.age\": 16} print(msg % item) # XiaoMing is 16 years old. \u5b8c\u6574\u4f7f\u7528\u53c2\u8003\uff1a %[(name)][flags][width].[precision]typecode (name)\uff1a\u547d\u540d flags\uff1a\u53f3\u5bf9\u9f50\uff08 + \uff09\uff0c\u5de6\u5bf9\u9f50\uff08 - \uff09\uff0c\u6b63\u6570\u5de6\u4fa7\u586b\u5145\u4e00\u4e2a\u7a7a\u683c\u4f7f\u4e4b\u4e0e\u8d1f\u6570\u5bf9\u9f50\uff08 \uff09\uff0c\u4f7f\u75280\u586b\u5145\uff08 0 \uff09 width\uff1a\u663e\u793a\u5bbd\u5ea6 precision\uff1a\u5c0f\u6570\u70b9\u540e\u7cbe\u5ea6 typecode\uff1a\u683c\u5f0f\u7c7b\u578b\u7801\uff0c\u4f8b\u5982\u5b57\u7b26\u4e32\uff08 %s \uff0c %r \uff09\uff0c\u5355\u4e2a\u5b57\u7b26\uff08 %c \uff09\uff0c\u4e8c\u3001\u516b\u3001\u5341\u3001\u5341\u516d\u8fdb\u5236\u6574\u6570\uff08 %b, %o, %d, %x \uff09\uff0c\u6d6e\u70b9\u662f\uff08 %f \uff09 \u5176\u4e2d width , precision \u4e3a\u4e24\u4e2a\u6574\u6570\uff0c\u53ef\u4ee5\u5229\u7528 * \u6765\u52a8\u6001\u4ee3\u5165\uff1a s = \"%*.*f\" %(5,4,1.234) print(s) # 1.2340","title":"\u547d\u540d\u683c\u5f0f\u5316\u5b57\u7b26\u4e32"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/","text":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-02-09 | \u5206\u7c7b\uff1a python/vba/cpp python\u7684 os \u6a21\u5757\u53ef\u4ee5\u5904\u7406\u5e38\u89c1\u7684\u6587\u4ef6/\u76ee\u5f55\u64cd\u4f5c\uff0c\u6b64\u5916\u8fd8\u53ef\u80fd\u7528\u5230 glob \u6216\u8005 fnmatch \u6a21\u5757\u5339\u914d\u6587\u4ef6\u540d\u3002 \u5e38\u7528\u65b9\u6cd5 \u00b6 os.path.isdir(name) # \u5224\u65ad\u662f\u4e0d\u662f\u4e00\u4e2a\u76ee\u5f55 os.path.isfile(name) # \u5224\u65ad\u662f\u4e0d\u662f\u4e00\u4e2a\u6587\u4ef6 os.path.exists(name) # \u5224\u65ad\u662f\u5426\u5b58\u5728\u6587\u4ef6\u6216\u76ee\u5f55 os.path.abspath(name) # \u83b7\u5f97\u7edd\u5bf9\u8def\u5f84 os.path.realpath # \u83b7\u53d6\u7edd\u5bf9\u8def\u5f84 os.path.relpath() # \u83b7\u53d6\u76f8\u5bf9\u8def\u5f84 os.path.normpath(path) # \u89c4\u8303path\u5b57\u7b26\u4e32\u8868\u793a os.path.split(name) # \u5206\u5272\u6587\u4ef6\u540d\u4e0e\u76ee\u5f55 os.path.splitext() # \u5206\u79bb\u6587\u4ef6\u540d\u4e0e\u6269\u5c55\u540d os.path.join(path,name) # \u8fde\u63a5\u76ee\u5f55\u4e0e\u6587\u4ef6\u540d\u6216\u76ee\u5f55 os.path.basename(path) # \u8fd4\u56de\u6587\u4ef6\u540d os.path.dirname(path) # \u8fd4\u56de\u6587\u4ef6\u8def\u5f84 os.path.getsize(name) # \u83b7\u5f97\u6587\u4ef6\u5927\u5c0f\uff0c\u76ee\u5f55\u8fd4\u56de0 os.listdir(dirname) # \u5217\u51fadirname\u4e0b\u7684\u76ee\u5f55\u548c\u6587\u4ef6 os.getcwd() # \u83b7\u5f97\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 os.curdir # \u8fd4\u56de\u5f53\u524d\u76ee\u5f55\uff08'.') os.chdir(dirname) # \u6539\u53d8\u5de5\u4f5c\u76ee\u5f55\u5230dirname os.remove(name) # \u5220\u9664\u6587\u4ef6 os.rename(src, dst) # \u91cd\u547d\u540d\u6587\u4ef6 os.mkdir(dirname) # \u521b\u5efa\u76ee\u5f55 os.rmdir(dirname) # \u5220\u9664\u76ee\u5f55 os.path.isdir(name) \u4e2d name \u53c2\u6570\u5e94\u4e3a\u7edd\u5bf9\u8def\u5f84\uff08 e:\\java \uff09\uff1b\u5982\u679c\u53ea\u662f\u4f20\u5165\u6587\u4ef6\u540d\uff08 java \uff09\uff0c\u5219\u5728\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u67e5\u627e\u6709\u6ca1\u6709\u540c\u540d\u6587\u4ef6\u5939 os.listdir(dirname) \u53ea\u8fd4\u56de\u6587\u4ef6\u540d\uff0c\u9700\u8981\u7ed3\u5408 os.path.join(path,name) \u62fc\u63a5\u51fa\u7edd\u5bf9\u8def\u5f84 os.path.realpath(name) \u83b7\u53d6\u7edd\u5bf9\u8def\u5f84\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5c06\u4f20\u5165\u7684\u6587\u4ef6\u540d\u4e0e\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u62fc\u63a5\u51fa\u7edd\u5bf9\u8def\u5f84\u3002\u5982\u679c\u8981\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5fc5\u987b\u5148\u7528 os.chdir(dirname) \u6539\u53d8\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002\u5efa\u8bae\u4f18\u5148\u4f7f\u7528 os.path.join(path,name) os.path.relpath(name) \u83b7\u53d6\u76f8\u5bf9\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u4f20\u5165\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 start \uff0c\u5219\u6839\u636e\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u8ba1\u7b97\u76f8\u5bf9\u8def\u5f84\uff0c\u76ee\u5f55\u4e0d\u540c\u5219\u62a5\u9519 \u5de5\u4f5c\u76ee\u5f55 \u00b6 os.getcwd() \u83b7\u53d6\u7684\u662f\u6267\u884c\u5f53\u524d\u811a\u672c\u7684\u76ee\u5f55\uff0c\u5e76\u4e0d\u4e00\u5b9a\u7684\u662f\u811a\u672c\u672c\u8eab\u6240\u5728\u7684\u76ee\u5f55\u3002 # D:\\program\\TestSpace\\test.py import os print(os.getcwd()) \u5728\u4e0d\u540c\u76ee\u5f55\u6267\u884c\u4ee5\u4e0a\u811a\u672c\uff0c\u53ef\u77e5\u5de5\u4f5c\u76ee\u5f55\u7684\u5177\u4f53\u6240\u6307\uff1a D:\\program\\TestSpace> python test.py D:\\program\\TestSpace D:\\program> python TestSpace\\test.py D:\\program \u811a\u672c\u76ee\u5f55 \u00b6 __file__ \u8fd4\u56de\u5f53\u524d\u811a\u672c\u7684\u8def\u5f84\uff0c\u8003\u8651\u5230\u6709\u65f6\u8fd4\u56de\u7684\u662f\u76f8\u5bf9\u8def\u5f84\uff0c\u6545\u91c7\u7528\u5982\u4e0b\u65b9\u5f0f\u8f6c\u6362\u4e00\u4e0b\uff1a import os os.path.dirname(os.path.abspath(__file__)) \u6587\u4ef6/\u76ee\u5f55\u5217\u8868 \u00b6 os.listdir(dirname) \u5f97\u5230\u539f\u59cb\u7684\u76ee\u5f55\u6587\u4ef6\u5217\u8868\uff0c\u5305\u62ec\u6240\u6709\u7684\u6587\u4ef6\u3001\u5b50\u76ee\u5f55\u3001\u7b26\u53f7\u94fe\u63a5\u7b49\uff0c\u7136\u540e\u53ef\u4ee5\u7ed3\u5408\u5217\u8868\u63a8\u5bfc\u5f0f\u548c os.path \u6a21\u5757\u4e2d\u5404\u51fd\u6570\u6765\u5b8c\u6210\u6570\u636e\u7b5b\u9009\u3002 import os # \u6587\u4ef6\u5217\u8868 filenames = [name for name in os.listdir('somedir') if os.path.isfile(os.path.join('somedir', name))] # \u76ee\u5f55\u5217\u8868 filenames = [name for name in os.listdir('somedir') if os.path.isdir(os.path.join('somedir', name))] # \u6307\u5b9a\u7c7b\u578b\u6587\u4ef6 pyfiles = [name for name in os.listdir('somedir') if name.endswith('.py')] \u6587\u4ef6\u540d\u7b5b\u9009 \u00b6 \u7b80\u5355\u7684\u6587\u4ef6\u540d\u5339\u914d\u53ef\u4ee5\u4f7f\u7528\u5b57\u7b26\u4e32\u5224\u65ad\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 glob \u6216\u8005 fnmatch \u6a21\u5757\u3002 import glob for name in glob.glob('somedir/*.py'): print(name) from fnmatch import fnmatch pyfiles = [name for name in os.listdir('somedir') if fnmatch(name, '*.py')]","title":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/#python3","text":"\u53d1\u5e03\u4e8e\uff1a2018-02-09 | \u5206\u7c7b\uff1a python/vba/cpp python\u7684 os \u6a21\u5757\u53ef\u4ee5\u5904\u7406\u5e38\u89c1\u7684\u6587\u4ef6/\u76ee\u5f55\u64cd\u4f5c\uff0c\u6b64\u5916\u8fd8\u53ef\u80fd\u7528\u5230 glob \u6216\u8005 fnmatch \u6a21\u5757\u5339\u914d\u6587\u4ef6\u540d\u3002","title":"Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/#_1","text":"os.path.isdir(name) # \u5224\u65ad\u662f\u4e0d\u662f\u4e00\u4e2a\u76ee\u5f55 os.path.isfile(name) # \u5224\u65ad\u662f\u4e0d\u662f\u4e00\u4e2a\u6587\u4ef6 os.path.exists(name) # \u5224\u65ad\u662f\u5426\u5b58\u5728\u6587\u4ef6\u6216\u76ee\u5f55 os.path.abspath(name) # \u83b7\u5f97\u7edd\u5bf9\u8def\u5f84 os.path.realpath # \u83b7\u53d6\u7edd\u5bf9\u8def\u5f84 os.path.relpath() # \u83b7\u53d6\u76f8\u5bf9\u8def\u5f84 os.path.normpath(path) # \u89c4\u8303path\u5b57\u7b26\u4e32\u8868\u793a os.path.split(name) # \u5206\u5272\u6587\u4ef6\u540d\u4e0e\u76ee\u5f55 os.path.splitext() # \u5206\u79bb\u6587\u4ef6\u540d\u4e0e\u6269\u5c55\u540d os.path.join(path,name) # \u8fde\u63a5\u76ee\u5f55\u4e0e\u6587\u4ef6\u540d\u6216\u76ee\u5f55 os.path.basename(path) # \u8fd4\u56de\u6587\u4ef6\u540d os.path.dirname(path) # \u8fd4\u56de\u6587\u4ef6\u8def\u5f84 os.path.getsize(name) # \u83b7\u5f97\u6587\u4ef6\u5927\u5c0f\uff0c\u76ee\u5f55\u8fd4\u56de0 os.listdir(dirname) # \u5217\u51fadirname\u4e0b\u7684\u76ee\u5f55\u548c\u6587\u4ef6 os.getcwd() # \u83b7\u5f97\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 os.curdir # \u8fd4\u56de\u5f53\u524d\u76ee\u5f55\uff08'.') os.chdir(dirname) # \u6539\u53d8\u5de5\u4f5c\u76ee\u5f55\u5230dirname os.remove(name) # \u5220\u9664\u6587\u4ef6 os.rename(src, dst) # \u91cd\u547d\u540d\u6587\u4ef6 os.mkdir(dirname) # \u521b\u5efa\u76ee\u5f55 os.rmdir(dirname) # \u5220\u9664\u76ee\u5f55 os.path.isdir(name) \u4e2d name \u53c2\u6570\u5e94\u4e3a\u7edd\u5bf9\u8def\u5f84\uff08 e:\\java \uff09\uff1b\u5982\u679c\u53ea\u662f\u4f20\u5165\u6587\u4ef6\u540d\uff08 java \uff09\uff0c\u5219\u5728\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u67e5\u627e\u6709\u6ca1\u6709\u540c\u540d\u6587\u4ef6\u5939 os.listdir(dirname) \u53ea\u8fd4\u56de\u6587\u4ef6\u540d\uff0c\u9700\u8981\u7ed3\u5408 os.path.join(path,name) \u62fc\u63a5\u51fa\u7edd\u5bf9\u8def\u5f84 os.path.realpath(name) \u83b7\u53d6\u7edd\u5bf9\u8def\u5f84\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5c06\u4f20\u5165\u7684\u6587\u4ef6\u540d\u4e0e\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u62fc\u63a5\u51fa\u7edd\u5bf9\u8def\u5f84\u3002\u5982\u679c\u8981\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5fc5\u987b\u5148\u7528 os.chdir(dirname) \u6539\u53d8\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002\u5efa\u8bae\u4f18\u5148\u4f7f\u7528 os.path.join(path,name) os.path.relpath(name) \u83b7\u53d6\u76f8\u5bf9\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u4f20\u5165\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 start \uff0c\u5219\u6839\u636e\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u8ba1\u7b97\u76f8\u5bf9\u8def\u5f84\uff0c\u76ee\u5f55\u4e0d\u540c\u5219\u62a5\u9519","title":"\u5e38\u7528\u65b9\u6cd5"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/#_2","text":"os.getcwd() \u83b7\u53d6\u7684\u662f\u6267\u884c\u5f53\u524d\u811a\u672c\u7684\u76ee\u5f55\uff0c\u5e76\u4e0d\u4e00\u5b9a\u7684\u662f\u811a\u672c\u672c\u8eab\u6240\u5728\u7684\u76ee\u5f55\u3002 # D:\\program\\TestSpace\\test.py import os print(os.getcwd()) \u5728\u4e0d\u540c\u76ee\u5f55\u6267\u884c\u4ee5\u4e0a\u811a\u672c\uff0c\u53ef\u77e5\u5de5\u4f5c\u76ee\u5f55\u7684\u5177\u4f53\u6240\u6307\uff1a D:\\program\\TestSpace> python test.py D:\\program\\TestSpace D:\\program> python TestSpace\\test.py D:\\program","title":"\u5de5\u4f5c\u76ee\u5f55"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/#_3","text":"__file__ \u8fd4\u56de\u5f53\u524d\u811a\u672c\u7684\u8def\u5f84\uff0c\u8003\u8651\u5230\u6709\u65f6\u8fd4\u56de\u7684\u662f\u76f8\u5bf9\u8def\u5f84\uff0c\u6545\u91c7\u7528\u5982\u4e0b\u65b9\u5f0f\u8f6c\u6362\u4e00\u4e0b\uff1a import os os.path.dirname(os.path.abspath(__file__))","title":"\u811a\u672c\u76ee\u5f55"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/#_4","text":"os.listdir(dirname) \u5f97\u5230\u539f\u59cb\u7684\u76ee\u5f55\u6587\u4ef6\u5217\u8868\uff0c\u5305\u62ec\u6240\u6709\u7684\u6587\u4ef6\u3001\u5b50\u76ee\u5f55\u3001\u7b26\u53f7\u94fe\u63a5\u7b49\uff0c\u7136\u540e\u53ef\u4ee5\u7ed3\u5408\u5217\u8868\u63a8\u5bfc\u5f0f\u548c os.path \u6a21\u5757\u4e2d\u5404\u51fd\u6570\u6765\u5b8c\u6210\u6570\u636e\u7b5b\u9009\u3002 import os # \u6587\u4ef6\u5217\u8868 filenames = [name for name in os.listdir('somedir') if os.path.isfile(os.path.join('somedir', name))] # \u76ee\u5f55\u5217\u8868 filenames = [name for name in os.listdir('somedir') if os.path.isdir(os.path.join('somedir', name))] # \u6307\u5b9a\u7c7b\u578b\u6587\u4ef6 pyfiles = [name for name in os.listdir('somedir') if name.endswith('.py')]","title":"\u6587\u4ef6/\u76ee\u5f55\u5217\u8868"},{"location":"2018-02-09-Python3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/#_5","text":"\u7b80\u5355\u7684\u6587\u4ef6\u540d\u5339\u914d\u53ef\u4ee5\u4f7f\u7528\u5b57\u7b26\u4e32\u5224\u65ad\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 glob \u6216\u8005 fnmatch \u6a21\u5757\u3002 import glob for name in glob.glob('somedir/*.py'): print(name) from fnmatch import fnmatch pyfiles = [name for name in os.listdir('somedir') if fnmatch(name, '*.py')]","title":"\u6587\u4ef6\u540d\u7b5b\u9009"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/","text":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-04-05 | \u5206\u7c7b\uff1a CAD/CAE integration \u672c\u6587\u4eceNX Open\u4e8c\u6b21\u5f00\u53d1\u7684\u89d2\u5ea6\uff0c\u4ecb\u7ecdNX\u6709\u9650\u5143\u5206\u6790\u6d89\u53ca\u7684\u6587\u4ef6\u7ed3\u6784\uff08Part\u7c7b\u578b\uff09\u53ca\u4e0d\u540c\u90e8\u4ef6\u95f4\u76f8\u5173\u51e0\u4f55\u5bf9\u8c61\u7684\u5f15\u7528\u5173\u7cfb\u3002 \u6587\u4ef6/\u90e8\u4ef6\u7c7b\u578b \u00b6 NX\u4e2d\u6839\u636eCAD\u6a21\u578b\u521b\u5efa\u6709\u9650\u5143\u5206\u6790\u6a21\u578b\u8fc7\u7a0b\u4e2d\u5c06\u6d89\u53ca\u56db\u79cd\u7c7b\u578b\u7684\u6587\u4ef6\uff1aCAD\u4e3b\u6a21\u578b(master part)\u3001\u7406\u60f3\u5316\u51e0\u4f55\u6a21\u578b(idealized part)\u3001\u6709\u9650\u5143\u6a21\u578b(FEM part)\u53ca\u4eff\u771f\u6a21\u578b(simulation part)\u3002\u5b83\u4eec\u76f8\u4e92\u5173\u8054\u5e76\u5404\u53f8\u5176\u804c\uff1a CAD\u4e3b\u6a21\u578b \u9700\u8981\u5206\u6790\u7684\u51e0\u4f55\u5bf9\u8c61\uff0c\u5e76\u4e0d\u8981\u6c42\u5177\u6709\u53ef\u7f16\u8f91\u6743\u9650 \u7406\u60f3\u5316\u51e0\u4f55\u6a21\u578b \u6709\u9650\u5143\u5206\u6790\u524d\u7684\u51e0\u4f55\u6e05\u7406\uff0c\u4f8b\u5982\u62bd\u4e2d\u9762\u3001\u5206\u5272\u90e8\u4ef6\u3001\u7b80\u5316\u7279\u5f81\u7b49\u3002\u7406\u60f3\u5316\u51e0\u4f55\u6a21\u578b\u5173\u8054\u81ea\u4e3b\u6a21\u578b\uff0c\u53ef\u4ee5\u54cd\u5e94\u4e3b\u6a21\u578b\u7684\u66f4\u65b0\u5374\u4e0d\u4f1a\u53cd\u5411\u6c61\u67d3\u4e3b\u6a21\u578b\u3002 \u6709\u9650\u5143\u6a21\u578b \u7f51\u683c\u5212\u5206\u3001\u5355\u5143\u8bbe\u7f6e\u3001\u6750\u6599\u5c5e\u6027 \u4eff\u771f\u6a21\u578b \u8fb9\u754c\u6761\u4ef6\u8bbe\u7f6e\u3001\u6c42\u89e3\u53c2\u6570\u63a7\u5236\u53ca\u540e\u5904\u7406\u663e\u793a \u6587\u6863\u7ed3\u6784\u4e0e\u88c5\u914d\u7ed3\u6784 \u00b6 \u4eff\u771f\u5bfc\u822a\u5668\uff08Simulaton Navigator\uff09\u548c\u4eff\u771f\u6587\u4ef6\u89c6\u56fe\uff08SImulation File View\uff09\u5c55\u793a\u4e86\u5982\u4e0b\u7684\u6587\u4ef6\u7ed3\u6784\uff1a +---------------------------------------+ | SIM Part | | + | | +---+ FEM Part | | + | | +---+ Idealized Part | | + | | +---+ CAD Part | +---------------------------------------+ \u8bbe\u7f6e\u4e0d\u540c\u90e8\u4ef6\u4e3a\u5de5\u4f5c\u90e8\u4ef6\u65f6\uff0c\u88c5\u914d\u6811\uff08Assembly Navigator\uff09\u7ed3\u6784\u5982\u4e0b\u6240\u793a\u3002\u4ece\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u56db\u7c7b\u6587\u4ef6\u4e2d\uff0c\u6709\u9650\u5143\u6a21\u578b\u662f\u4eff\u771f\u6a21\u578b\u7684\u88c5\u914d\u7ec4\u4ef6\uff0cCAD\u6a21\u578b\u662f\u7406\u60f3\u5316\u51e0\u4f55\u4f53\u7684\u88c5\u914d\u7ec4\u4ef6\u3002 +---------------------+ +--------------------+ |CAD Part | |Idealized Part | | + | | + | | +--+ Component_1 | | +--+ CAD Part | | +--+ Component_2 | | | | +--+ ... | | | +---------------------+ +--------------------+ +---------------------+ +--------------------+ |FEM Part | |SIM Part | | | | + | | | | +--+ FEM Part | | | | | +---------------------+ +--------------------+ \u603b\u7ed3 \u7efc\u5408\u8d77\u6765\u770b\uff0c\u8fd9\u662f\u4e24\u4e2a\u4e0d\u540c\u7ef4\u5ea6\u7684\u7ed3\u6784\uff0c\u4eff\u771f\u6587\u6863\u89c6\u56fe\u7ec4\u7ec7\u4e86\u56db\u7c7b\u90e8\u4ef6\uff0c\u800c\u9488\u5bf9\u5176\u4e2d\u4efb\u4e00\u7c7b\u90e8\u4ef6\uff0c\u90fd\u6709\u4e0e\u4e4b\u5bf9\u5e94\u7684\u88c5\u914d\u6811\u7ed3\u6784\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u5c06\u540c\u65f6\u6d89\u53ca\u90e8\u4ef6\u548c\u540c\u540d\u88c5\u914d\u7ec4\u4ef6\u4e24\u4e2a\u6982\u5ff5\u3002 \u4ee5\u5f53\u524d\u5de5\u4f5c\u90e8\u4ef6\u4e3aSIM Part\u4e3a\u4f8b\uff0c\u6211\u4eec\u65e2\u53ef\u4ee5\u4ece\u4eff\u771f\u5bfc\u822a\u5668\u83b7\u53d6\u4e0e\u4e4b\u5173\u8054\u7684FEM Part\uff0c\u53c8\u53ef\u4ee5\u4ece\u88c5\u914d\u5bfc\u822a\u5668\u83b7\u53d6\u4e0e\u4e4b\u5173\u8054\u7684FEM Component\u3002FEM Part\u548cFEM Component\u5305\u542b\u4eceNX\u64cd\u4f5c\u4e0a\u6765\u770b\u5e76\u65e0\u533a\u522b\u7684\u51e0\u4f55\u5bf9\u8c61\uff0c\u7136\u800c\u5b9e\u9645\u4e0a\u4ed6\u4eec\u5728\u5185\u5b58\u4e2d\u5374\u662f\u4e0d\u540c\u7684\u5bf9\u8c61\u3002 \u90e8\u4ef6\u5207\u6362\u4e0e\u88c5\u914d\u7ec4\u4ef6\u5207\u6362 \u00b6 \u6587\u6863\u7ed3\u6784\u6811\u6240\u793a\u5173\u8054\u5173\u7cfb\u7528NXOpen API\u4e2d\u76f8\u5173\u7c7b\u7684\u6210\u5458\u51fd\u6570\u8868\u793a\u4e3a\uff1a IdealizedPart() +--------+ FemPart() +---------->+CAD Part| +--------+ +--------+ | +--------+ |SIM Part+------------>+FEM Part+---+ +--------+ +--------+ | +--------------+ +---------->+Idealized Part| +--------------+ MasterCadPart() \u6ce8\u610f \u4f7f\u7528\u6210\u5458\u51fd\u6570\u8fdb\u884c\u4ee5\u4e0a\u5207\u6362\u7684\u524d\u63d0\u662f\u76f8\u5173\u90e8\u4ef6\u90fd\u5df2\u7ecf\u52a0\u8f7d\u5230Session\u4e2d\u3002 \u5207\u6362\u5230\u76f8\u5e94\u90e8\u4ef6\u5e76\u8bbe\u4e3a\u5de5\u4f5c\u90e8\u4ef6\u540e\uff0c\u5219\u53ef\u6839\u636e\u4e0a\u8ff0\u88c5\u914d\u7ed3\u6784\u56fe\u83b7\u53d6\u76f8\u5e94\u88c5\u914d\u4f53\uff1a ComponentAssembly() RootComponent() GetChildren() +-----------+ +---------------+ +----------------+ +------------+ | Work Part +-----> Assembly tree +-----> Root Component +-----> Components | +-----------+ +---------------+ +----------------+ +------------+ \u51e0\u4f55\u5bf9\u8c61\u5207\u6362 \u00b6 \u4e0d\u540c\u90e8\u4ef6\u95f4\u7684\u51e0\u4f55\u5bf9\u8c61\u5177\u6709\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\uff0c\u4f8b\u5982Idealized Part\u4e2d\u7684\u67d0\u4e2aEdge\u5bf9\u5e94\u4e86FEM Part\u4e2d\u7684Polygon Edge\uff0c\u8fdb\u800c\u53c8\u5bf9\u5e94SIM Part\u4e2d\u7684Polygon Edge\u3002\u4ee5\u4e0a\u5bf9\u5e94\u5173\u7cfb\u7531NX\u81ea\u52a8\u7ef4\u62a4\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 Open C \u51fd\u6570\uff0c\u6839\u636e\u5f53\u524d\u90e8\u4ef6\u4e2d\u7684\u5bf9\u8c61\u83b7\u53d6\u5904\u4e8e\u5173\u7cfb\u5bf9\u4e0a\u7684\u76f8\u5173\u5bf9\u8c61\uff1a #include <uf_sf.h> tag_t UF_SF_map_object_to_current_part(tag_t object_tag /*Tag of a object to be mapped*/); \u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528 NXOpen C++ \u51fd\u6570\u5b9e\u73b0\u90e8\u4ef6\u4e0e\u88c5\u914d\u7ec4\u4ef6\u4e2d\u51e0\u4f55\u5bf9\u8c61\u7684\u5207\u6362\u3002\u67d0\u90e8\u4ef6\u4e2d\u7684\u51e0\u4f55\u5bf9\u8c61 G \u5c06\u4ee5 Occurrence \u7684\u5f62\u5f0f G' \u51fa\u73b0\u5728\u5f53\u524d\u5de5\u4f5c\u90e8\u4ef6\u7684\u88c5\u914d\u7ec4\u4ef6\u4e2d\uff0c\u800c\u8fd9\u4e2a G' \u4e5f\u6b63\u662f G \u5bf9\u5e94\u4e8e\u5f53\u524d\u90e8\u4ef6\u7684\u51e0\u4f55\u5bf9\u8c61\u3002\u4f8b\u5982\uff0c\u51e0\u4f55\u5bf9\u8c61 MeshPoint \u4ec5\u80fd\u5728FEM Part\u4e2d\u521b\u5efa\u548c\u5220\u9664\uff0c\u5373\u771f\u8eab\uff08Prototype\uff09\u5b58\u5728\u4e8eFEM Part\u4e2d\uff0c\u540c\u65f6\u5b83\u4e5f\u53ef\u4ee5\u51fa\u73b0\u5728SIM Part\u4e2d\uff08\u6b64\u65f6\u53ef\u4ee5\u88ab\u9009\u62e9\u5374\u4e0d\u80fd\u88ab\u4fee\u6539\uff09\u3002\u5b83\u5728SIM Part\u4e2d\u7684\u5c55\u73b0\u5f62\u5f0f\u6b63\u662fFEM Part\u4e2d MeshPoint \u5728FEM\u88c5\u914d\u7ec4\u4ef6\u4e2d\u7684 Occurrence \u3002 \u4e0b\u9762\u7ed9\u51fa\u4e24\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff1a \u65b0\u5efa\u5e76\u5b58\u50a8MeshPoint\u4e8eSIM Part\u7684Group \u00b6 \u57fa\u672c\u601d\u8def\uff1a\u9996\u5148\u5207\u6362\u5230FEM Part\u521b\u5efa MeshPoint \u5bf9\u8c61\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2aPrototype\u83b7\u53d6\u76f8\u5e94\u7684Occurrence\uff0c\u6700\u540e\u5b58\u5165SIM Part\u7684group\u4e2d\u3002 \u5f97\u5230FEM Part\u4e2d\u521b\u5efa\u7684 MeshPoint \u5e76\u5207\u6362\u56deSIM Part\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e0a\u8ff0 Open C \u51fd\u6570\uff0c\u6b64\u5904\u5219\u6f14\u793a NXOpen C++ \u65b9\u6cd5\uff1a\u4ece\u88c5\u914d\u6811\u83b7\u53d6FEM\u7ec4\u4ef6\uff0c\u7136\u540e\u4f7f\u7528\u5176 FindOccurrence() \u6210\u5458\u51fd\u6570\u83b7\u53d6\u5728SIM Part\u4e2d\u7684\u5bf9\u8c61\u3002 ComponentAssembly() RootComponent() +----------+ +---------------+ +----------------+ | SIM Part +------> Assembly tree +-----> Root Component | +----------+ +---------------+ +-------+--------+ | | GetChildren() +-----------------------+ +-------v--------+ | MeshPoint in SIM Part <---------------+ FEM Component | +-----------------------+ +----------------+ FindOccurrence() SIM Part\u4e2d\u83b7\u53d6MeshPoint\u7684\u5173\u8054Node \u00b6 \u57fa\u672c\u601d\u8def\uff1aFEM Part\u7684 SmartSelectionManager \u53ef\u4ee5\u6839\u636e MeshPoint \u83b7\u53d6 Node \uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u6b64\u5904\u7684 MeshPoint \u5fc5\u987b\u662fFEM Part\u4e2d\u7684 Prototype \u3002\u7531\u4e8eGroup\u4e2d\u5b58\u50a8\u7684 Occurrence \uff0c\u76f4\u63a5\u4f7f\u7528 Prototype() \u83b7\u53d6\u5373\u53ef\u3002 \u521b\u5efaMeshPoint\u540e\u5e94\u66f4\u65b0FEModel\uff0c\u6b64\u540e\u624d\u5efa\u7acbMeshPoint\u4e0eNode\u7684\u5bf9\u5e94\u5173\u7cfb\uff0cCreateRelatedNodeMethod()\u65b9\u6cd5\u4e5f\u624d\u751f\u6548\u3002\u4f46\u662f\uff0c\u5f53\u6a21\u578b\u5341\u5206\u590d\u6742\u65f6\uff0c\u4e3a\u907f\u514d\u66f4\u65b0FEModel\u9020\u6210\u7684\u7b49\u5f85\u65f6\u95f4\uff0c\u4ea6\u53ef\u904d\u5386\u8282\u70b9\u5750\u6807\u6765\u83b7\u53d6\u91cd\u5408\u8282\u70b9\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#nxopen caeadvanced simulation","text":"\u53d1\u5e03\u4e8e\uff1a2018-04-05 | \u5206\u7c7b\uff1a CAD/CAE integration \u672c\u6587\u4eceNX Open\u4e8c\u6b21\u5f00\u53d1\u7684\u89d2\u5ea6\uff0c\u4ecb\u7ecdNX\u6709\u9650\u5143\u5206\u6790\u6d89\u53ca\u7684\u6587\u4ef6\u7ed3\u6784\uff08Part\u7c7b\u578b\uff09\u53ca\u4e0d\u540c\u90e8\u4ef6\u95f4\u76f8\u5173\u51e0\u4f55\u5bf9\u8c61\u7684\u5f15\u7528\u5173\u7cfb\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#_1","text":"NX\u4e2d\u6839\u636eCAD\u6a21\u578b\u521b\u5efa\u6709\u9650\u5143\u5206\u6790\u6a21\u578b\u8fc7\u7a0b\u4e2d\u5c06\u6d89\u53ca\u56db\u79cd\u7c7b\u578b\u7684\u6587\u4ef6\uff1aCAD\u4e3b\u6a21\u578b(master part)\u3001\u7406\u60f3\u5316\u51e0\u4f55\u6a21\u578b(idealized part)\u3001\u6709\u9650\u5143\u6a21\u578b(FEM part)\u53ca\u4eff\u771f\u6a21\u578b(simulation part)\u3002\u5b83\u4eec\u76f8\u4e92\u5173\u8054\u5e76\u5404\u53f8\u5176\u804c\uff1a CAD\u4e3b\u6a21\u578b \u9700\u8981\u5206\u6790\u7684\u51e0\u4f55\u5bf9\u8c61\uff0c\u5e76\u4e0d\u8981\u6c42\u5177\u6709\u53ef\u7f16\u8f91\u6743\u9650 \u7406\u60f3\u5316\u51e0\u4f55\u6a21\u578b \u6709\u9650\u5143\u5206\u6790\u524d\u7684\u51e0\u4f55\u6e05\u7406\uff0c\u4f8b\u5982\u62bd\u4e2d\u9762\u3001\u5206\u5272\u90e8\u4ef6\u3001\u7b80\u5316\u7279\u5f81\u7b49\u3002\u7406\u60f3\u5316\u51e0\u4f55\u6a21\u578b\u5173\u8054\u81ea\u4e3b\u6a21\u578b\uff0c\u53ef\u4ee5\u54cd\u5e94\u4e3b\u6a21\u578b\u7684\u66f4\u65b0\u5374\u4e0d\u4f1a\u53cd\u5411\u6c61\u67d3\u4e3b\u6a21\u578b\u3002 \u6709\u9650\u5143\u6a21\u578b \u7f51\u683c\u5212\u5206\u3001\u5355\u5143\u8bbe\u7f6e\u3001\u6750\u6599\u5c5e\u6027 \u4eff\u771f\u6a21\u578b \u8fb9\u754c\u6761\u4ef6\u8bbe\u7f6e\u3001\u6c42\u89e3\u53c2\u6570\u63a7\u5236\u53ca\u540e\u5904\u7406\u663e\u793a","title":"\u6587\u4ef6/\u90e8\u4ef6\u7c7b\u578b"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#_2","text":"\u4eff\u771f\u5bfc\u822a\u5668\uff08Simulaton Navigator\uff09\u548c\u4eff\u771f\u6587\u4ef6\u89c6\u56fe\uff08SImulation File View\uff09\u5c55\u793a\u4e86\u5982\u4e0b\u7684\u6587\u4ef6\u7ed3\u6784\uff1a +---------------------------------------+ | SIM Part | | + | | +---+ FEM Part | | + | | +---+ Idealized Part | | + | | +---+ CAD Part | +---------------------------------------+ \u8bbe\u7f6e\u4e0d\u540c\u90e8\u4ef6\u4e3a\u5de5\u4f5c\u90e8\u4ef6\u65f6\uff0c\u88c5\u914d\u6811\uff08Assembly Navigator\uff09\u7ed3\u6784\u5982\u4e0b\u6240\u793a\u3002\u4ece\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u56db\u7c7b\u6587\u4ef6\u4e2d\uff0c\u6709\u9650\u5143\u6a21\u578b\u662f\u4eff\u771f\u6a21\u578b\u7684\u88c5\u914d\u7ec4\u4ef6\uff0cCAD\u6a21\u578b\u662f\u7406\u60f3\u5316\u51e0\u4f55\u4f53\u7684\u88c5\u914d\u7ec4\u4ef6\u3002 +---------------------+ +--------------------+ |CAD Part | |Idealized Part | | + | | + | | +--+ Component_1 | | +--+ CAD Part | | +--+ Component_2 | | | | +--+ ... | | | +---------------------+ +--------------------+ +---------------------+ +--------------------+ |FEM Part | |SIM Part | | | | + | | | | +--+ FEM Part | | | | | +---------------------+ +--------------------+ \u603b\u7ed3 \u7efc\u5408\u8d77\u6765\u770b\uff0c\u8fd9\u662f\u4e24\u4e2a\u4e0d\u540c\u7ef4\u5ea6\u7684\u7ed3\u6784\uff0c\u4eff\u771f\u6587\u6863\u89c6\u56fe\u7ec4\u7ec7\u4e86\u56db\u7c7b\u90e8\u4ef6\uff0c\u800c\u9488\u5bf9\u5176\u4e2d\u4efb\u4e00\u7c7b\u90e8\u4ef6\uff0c\u90fd\u6709\u4e0e\u4e4b\u5bf9\u5e94\u7684\u88c5\u914d\u6811\u7ed3\u6784\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u5c06\u540c\u65f6\u6d89\u53ca\u90e8\u4ef6\u548c\u540c\u540d\u88c5\u914d\u7ec4\u4ef6\u4e24\u4e2a\u6982\u5ff5\u3002 \u4ee5\u5f53\u524d\u5de5\u4f5c\u90e8\u4ef6\u4e3aSIM Part\u4e3a\u4f8b\uff0c\u6211\u4eec\u65e2\u53ef\u4ee5\u4ece\u4eff\u771f\u5bfc\u822a\u5668\u83b7\u53d6\u4e0e\u4e4b\u5173\u8054\u7684FEM Part\uff0c\u53c8\u53ef\u4ee5\u4ece\u88c5\u914d\u5bfc\u822a\u5668\u83b7\u53d6\u4e0e\u4e4b\u5173\u8054\u7684FEM Component\u3002FEM Part\u548cFEM Component\u5305\u542b\u4eceNX\u64cd\u4f5c\u4e0a\u6765\u770b\u5e76\u65e0\u533a\u522b\u7684\u51e0\u4f55\u5bf9\u8c61\uff0c\u7136\u800c\u5b9e\u9645\u4e0a\u4ed6\u4eec\u5728\u5185\u5b58\u4e2d\u5374\u662f\u4e0d\u540c\u7684\u5bf9\u8c61\u3002","title":"\u6587\u6863\u7ed3\u6784\u4e0e\u88c5\u914d\u7ed3\u6784"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#_3","text":"\u6587\u6863\u7ed3\u6784\u6811\u6240\u793a\u5173\u8054\u5173\u7cfb\u7528NXOpen API\u4e2d\u76f8\u5173\u7c7b\u7684\u6210\u5458\u51fd\u6570\u8868\u793a\u4e3a\uff1a IdealizedPart() +--------+ FemPart() +---------->+CAD Part| +--------+ +--------+ | +--------+ |SIM Part+------------>+FEM Part+---+ +--------+ +--------+ | +--------------+ +---------->+Idealized Part| +--------------+ MasterCadPart() \u6ce8\u610f \u4f7f\u7528\u6210\u5458\u51fd\u6570\u8fdb\u884c\u4ee5\u4e0a\u5207\u6362\u7684\u524d\u63d0\u662f\u76f8\u5173\u90e8\u4ef6\u90fd\u5df2\u7ecf\u52a0\u8f7d\u5230Session\u4e2d\u3002 \u5207\u6362\u5230\u76f8\u5e94\u90e8\u4ef6\u5e76\u8bbe\u4e3a\u5de5\u4f5c\u90e8\u4ef6\u540e\uff0c\u5219\u53ef\u6839\u636e\u4e0a\u8ff0\u88c5\u914d\u7ed3\u6784\u56fe\u83b7\u53d6\u76f8\u5e94\u88c5\u914d\u4f53\uff1a ComponentAssembly() RootComponent() GetChildren() +-----------+ +---------------+ +----------------+ +------------+ | Work Part +-----> Assembly tree +-----> Root Component +-----> Components | +-----------+ +---------------+ +----------------+ +------------+","title":"\u90e8\u4ef6\u5207\u6362\u4e0e\u88c5\u914d\u7ec4\u4ef6\u5207\u6362"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#_4","text":"\u4e0d\u540c\u90e8\u4ef6\u95f4\u7684\u51e0\u4f55\u5bf9\u8c61\u5177\u6709\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\uff0c\u4f8b\u5982Idealized Part\u4e2d\u7684\u67d0\u4e2aEdge\u5bf9\u5e94\u4e86FEM Part\u4e2d\u7684Polygon Edge\uff0c\u8fdb\u800c\u53c8\u5bf9\u5e94SIM Part\u4e2d\u7684Polygon Edge\u3002\u4ee5\u4e0a\u5bf9\u5e94\u5173\u7cfb\u7531NX\u81ea\u52a8\u7ef4\u62a4\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 Open C \u51fd\u6570\uff0c\u6839\u636e\u5f53\u524d\u90e8\u4ef6\u4e2d\u7684\u5bf9\u8c61\u83b7\u53d6\u5904\u4e8e\u5173\u7cfb\u5bf9\u4e0a\u7684\u76f8\u5173\u5bf9\u8c61\uff1a #include <uf_sf.h> tag_t UF_SF_map_object_to_current_part(tag_t object_tag /*Tag of a object to be mapped*/); \u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528 NXOpen C++ \u51fd\u6570\u5b9e\u73b0\u90e8\u4ef6\u4e0e\u88c5\u914d\u7ec4\u4ef6\u4e2d\u51e0\u4f55\u5bf9\u8c61\u7684\u5207\u6362\u3002\u67d0\u90e8\u4ef6\u4e2d\u7684\u51e0\u4f55\u5bf9\u8c61 G \u5c06\u4ee5 Occurrence \u7684\u5f62\u5f0f G' \u51fa\u73b0\u5728\u5f53\u524d\u5de5\u4f5c\u90e8\u4ef6\u7684\u88c5\u914d\u7ec4\u4ef6\u4e2d\uff0c\u800c\u8fd9\u4e2a G' \u4e5f\u6b63\u662f G \u5bf9\u5e94\u4e8e\u5f53\u524d\u90e8\u4ef6\u7684\u51e0\u4f55\u5bf9\u8c61\u3002\u4f8b\u5982\uff0c\u51e0\u4f55\u5bf9\u8c61 MeshPoint \u4ec5\u80fd\u5728FEM Part\u4e2d\u521b\u5efa\u548c\u5220\u9664\uff0c\u5373\u771f\u8eab\uff08Prototype\uff09\u5b58\u5728\u4e8eFEM Part\u4e2d\uff0c\u540c\u65f6\u5b83\u4e5f\u53ef\u4ee5\u51fa\u73b0\u5728SIM Part\u4e2d\uff08\u6b64\u65f6\u53ef\u4ee5\u88ab\u9009\u62e9\u5374\u4e0d\u80fd\u88ab\u4fee\u6539\uff09\u3002\u5b83\u5728SIM Part\u4e2d\u7684\u5c55\u73b0\u5f62\u5f0f\u6b63\u662fFEM Part\u4e2d MeshPoint \u5728FEM\u88c5\u914d\u7ec4\u4ef6\u4e2d\u7684 Occurrence \u3002 \u4e0b\u9762\u7ed9\u51fa\u4e24\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff1a","title":"\u51e0\u4f55\u5bf9\u8c61\u5207\u6362"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#meshpointsim partgroup","text":"\u57fa\u672c\u601d\u8def\uff1a\u9996\u5148\u5207\u6362\u5230FEM Part\u521b\u5efa MeshPoint \u5bf9\u8c61\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2aPrototype\u83b7\u53d6\u76f8\u5e94\u7684Occurrence\uff0c\u6700\u540e\u5b58\u5165SIM Part\u7684group\u4e2d\u3002 \u5f97\u5230FEM Part\u4e2d\u521b\u5efa\u7684 MeshPoint \u5e76\u5207\u6362\u56deSIM Part\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e0a\u8ff0 Open C \u51fd\u6570\uff0c\u6b64\u5904\u5219\u6f14\u793a NXOpen C++ \u65b9\u6cd5\uff1a\u4ece\u88c5\u914d\u6811\u83b7\u53d6FEM\u7ec4\u4ef6\uff0c\u7136\u540e\u4f7f\u7528\u5176 FindOccurrence() \u6210\u5458\u51fd\u6570\u83b7\u53d6\u5728SIM Part\u4e2d\u7684\u5bf9\u8c61\u3002 ComponentAssembly() RootComponent() +----------+ +---------------+ +----------------+ | SIM Part +------> Assembly tree +-----> Root Component | +----------+ +---------------+ +-------+--------+ | | GetChildren() +-----------------------+ +-------v--------+ | MeshPoint in SIM Part <---------------+ FEM Component | +-----------------------+ +----------------+ FindOccurrence()","title":"\u65b0\u5efa\u5e76\u5b58\u50a8MeshPoint\u4e8eSIM Part\u7684Group"},{"location":"2018-04-05-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AAdvanced-Simulation%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/#sim partmeshpointnode","text":"\u57fa\u672c\u601d\u8def\uff1aFEM Part\u7684 SmartSelectionManager \u53ef\u4ee5\u6839\u636e MeshPoint \u83b7\u53d6 Node \uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u6b64\u5904\u7684 MeshPoint \u5fc5\u987b\u662fFEM Part\u4e2d\u7684 Prototype \u3002\u7531\u4e8eGroup\u4e2d\u5b58\u50a8\u7684 Occurrence \uff0c\u76f4\u63a5\u4f7f\u7528 Prototype() \u83b7\u53d6\u5373\u53ef\u3002 \u521b\u5efaMeshPoint\u540e\u5e94\u66f4\u65b0FEModel\uff0c\u6b64\u540e\u624d\u5efa\u7acbMeshPoint\u4e0eNode\u7684\u5bf9\u5e94\u5173\u7cfb\uff0cCreateRelatedNodeMethod()\u65b9\u6cd5\u4e5f\u624d\u751f\u6548\u3002\u4f46\u662f\uff0c\u5f53\u6a21\u578b\u5341\u5206\u590d\u6742\u65f6\uff0c\u4e3a\u907f\u514d\u66f4\u65b0FEModel\u9020\u6210\u7684\u7b49\u5f85\u65f6\u95f4\uff0c\u4ea6\u53ef\u904d\u5386\u8282\u70b9\u5750\u6807\u6765\u83b7\u53d6\u91cd\u5408\u8282\u70b9\u3002","title":"SIM Part\u4e2d\u83b7\u53d6MeshPoint\u7684\u5173\u8054Node"},{"location":"2018-05-04-NXOpen%EF%BC%9A%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C/","text":"NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-05-04 | \u5206\u7c7b\uff1a CAD/CAE integration \u5728NXOpen\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6709\u65f6\u9700\u8981\u81ea\u5b9a\u4e49\u4e0e\u5bf9\u8c61\u76f8\u5173\u7684\u5c5e\u6027\u5e76\u5b58\u50a8\u8d77\u6765\uff0c\u4ee5\u4fbf\u8fdb\u884c\u4e00\u4e9b\u521d\u59cb\u5316\u548c\u8ba1\u7b97\u5de5\u4f5c\u3002\u672c\u7bc7\u8bb0\u5f55NXOoen C++\u5c5e\u6027\u64cd\u4f5c\u76f8\u5173\u51fd\u6570\u3002 NXObject\u7c7b\u6210\u5458\u51fd\u6570SetAttribute \u00b6 \u7ee7\u627f\u81ea NXObject \u7c7b\u7684\u5bf9\u8c61\u53ef\u4ee5\u76f4\u63a5\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff1a SetAttribute(const NXString &title, T value); \u5176\u4e2d\uff0c \u5c5e\u6027\u540d\u79f0 title \u5177\u6709\u552f\u4e00\u6027\uff0c\u4e0d\u5b58\u5728\u65f6\u65b0\u5efa\u5c5e\u6027\uff0c\u5426\u5219\u8986\u76d6\u5df2\u5b58\u5728\u7684\u5c5e\u6027\u5373\u7f16\u8f91\u5c5e\u6027 value \u53c2\u6570\u7684\u7c7b\u578b\u51b3\u5b9a\u4e86\u8be5\u5c5e\u6027\u7684\u7c7b\u578b\uff1a integer , number , string \u6839\u636e\u5c5e\u6027\u7684\u7c7b\u578b\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u51fd\u6570\u83b7\u53d6\u5c5e\u6027\u503c\uff1a GetIntegerAttribute(title) \u83b7\u53d6\u6574\u6570\u7c7b\u578b\u5c5e\u6027 GetRealAttribute(title) \u83b7\u53d6\u6d6e\u70b9\u6570\u7c7b\u578b\u5c5e\u6027 GetStringAttribute(title) \u83b7\u53d6\u5b57\u7b26\u4e32\u7c7b\u578b\u5c5e\u6027 \u6ce8\u610f SetAttribute()\u65b9\u6cd5\u81eaNX8\u8d77\u5df2\u4e0d\u88ab\u63a8\u8350\u4f7f\u7528\uff0c\u800c\u662f\u4f7f\u7528SetUserAttribute()\u66ff\u4ee3\u4e4b\u3002 NXObject\u7c7b\u6210\u5458\u51fd\u6570SetUserAttribute \u00b6 // Creates or modifies an integer attribute with the option to update or not. SetUserAttribute (const NXString &title, int index, T value, NXOpen::Update::Option option); // get attributes GetIntegerUserAttribute (const NXString &title, int index); GetRealUserAttribute (const NXString &title, int index); GetStringUserAttribute (const NXString &title, int index); \u6b64\u65b9\u6cd5\u521b\u5efa/\u4fee\u6539/\u83b7\u53d6\u5c5e\u6027\u7684\u6027\u8d28\u7c7b\u4f3c\u4e8e SetAttribute() \u65b9\u6cd5\uff0c\u5176\u66f4\u5f3a\u5927\u4e4b\u5904\u5728\u4e8e\u53ef\u4ee5\u8bbe\u7f6e\u591a\u503c\u5c5e\u6027\uff0c\u5373\u901a\u8fc7\u4ee5\u4e0a index \u53c2\u6570\u5b9e\u73b0\u3002 index=-1 \u8868\u793a\u8be5\u5c5e\u6027\u4ec5\u5bf9\u5e94\u4e00\u4e2a\u503c\uff0c\u5e76\u975e\u591a\u503c\u5c5e\u6027 index=0,1,2... \u5206\u522b\u8bbe\u7f6e\u591a\u503c\u5c5e\u6027\u7684\u5404\u4e2a\u5143\u7d20\u503c \u83b7\u53d6\u5c5e\u6027\u65f6\u7684 index \u4f5c\u7528\u540c\u7406 \u5c5e\u6027\u7ba1\u7406\u5668 \u00b6 \u4f7f\u7528 Session \u5bf9\u8c61\u7684\u5c5e\u6027\u7ba1\u7406\u5668\u4ea6\u53ef\u7ba1\u7406\u5bf9\u8c61\u5c5e\u6027\uff0c\u9664\u4e86\u53ef\u4ee5\u5982 SetUserAttribute() \u4e00\u822c\u8bbe\u7f6e\u591a\u503c\u5c5e\u6027\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6eCategory\uff0c\u4fbf\u4e8e\u5206\u7c7b\u7ba1\u7406\u76f8\u5173\u5c5e\u6027\u3002 // get Builder NXOpen::AttributePropertiesBuilder *builder = theSession->AttributeManager()->CreateAttributePropertiesBuilder( NXOpen::BasePart *part, const std::vector<NXOpen::NXObject*> &objects, NXOpen::AttributePropertiesBuilder::OperationType operationType ); // set categoty builder->SetCategory (const NXString &category); // set title builder->SetTitle(const NXString &title); // set array index if necessary builder->SetArray (bool isArray); // have more than one value if true builder->SetArrayIndex (int arrayIndex); // ----------\u4ee5\u4e0a\u786e\u5b9a\u5177\u4f53\u7684\u5c5e\u6027\uff0c\u63a5\u4e0b\u6765\u8bbe\u7f6e/\u83b7\u53d6\u503c---------- // set value builder->SetIntegerValue (int integerValue); builder->SetNumberValue (double numberValue); builder->SetStringValue (const NXString &stringValue); // get value builder->IntegerValue (); builder->NumberValue (); builder->StringValue (); title \u548c index \u552f\u4e00\u786e\u5b9a\u5c5e\u6027\uff0c\u4e0d\u5b58\u5728\u65f6\u65b0\u5efa\uff0c\u5426\u5219\u8986\u76d6\u5373\u7f16\u8f91\u5c5e\u6027 \u83b7\u53d6\u5c5e\u6027\u65f6\uff0c SetTitle \u786e\u5b9a\u5c5e\u6027\uff0c\u5982\u679c\u662f\u591a\u503c\u5c5e\u6027\uff0c\u8fd8\u9700\u8981 SetArrayIndex \u786e\u5b9a\u5143\u7d20\u4f4d\u7f6e\uff0c\u6700\u7ec8\u4f7f\u7528\u76f8\u5e94\u51fd\u6570\u83b7\u53d6\u5c5e\u6027\u503c\u3002 \u603b\u7ed3 \u00b6 SetAttribute() \u5c06\u88ab\u5f03\u7528\uff0c\u63a8\u8350 SetUserAttribute() SetUserAttribute() \u53ef\u4ee5\u521b\u5efa\u591a\u503c\u5373\u6570\u7ec4\u5f62\u5f0f\u7684\u5c5e\u6027 AttributePropertiesBuilder \u4e0d\u4ec5\u53ef\u4ee5\u521b\u5efa\u591a\u503c\u5c5e\u6027\uff0c\u8fd8\u53ef\u4ee5\u5206\u7ec4\u7ba1\u7406\u5c5e\u6027 \u4ee5\u4e0a\u65b9\u6cd5\u521b\u5efa\u7684\u5c5e\u6027\u7edf\u4e00\u4e8e\u76f8\u5e94\u5bf9\u8c61\uff0c\u5373\u5b8c\u5168\u53ef\u4ee5\u4ea4\u53c9\u83b7\u53d6\u548c\u4fee\u6539","title":"NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c"},{"location":"2018-05-04-NXOpen%EF%BC%9A%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C/#nxopen","text":"\u53d1\u5e03\u4e8e\uff1a2018-05-04 | \u5206\u7c7b\uff1a CAD/CAE integration \u5728NXOpen\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6709\u65f6\u9700\u8981\u81ea\u5b9a\u4e49\u4e0e\u5bf9\u8c61\u76f8\u5173\u7684\u5c5e\u6027\u5e76\u5b58\u50a8\u8d77\u6765\uff0c\u4ee5\u4fbf\u8fdb\u884c\u4e00\u4e9b\u521d\u59cb\u5316\u548c\u8ba1\u7b97\u5de5\u4f5c\u3002\u672c\u7bc7\u8bb0\u5f55NXOoen C++\u5c5e\u6027\u64cd\u4f5c\u76f8\u5173\u51fd\u6570\u3002","title":"NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c"},{"location":"2018-05-04-NXOpen%EF%BC%9A%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C/#nxobjectsetattribute","text":"\u7ee7\u627f\u81ea NXObject \u7c7b\u7684\u5bf9\u8c61\u53ef\u4ee5\u76f4\u63a5\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\uff1a SetAttribute(const NXString &title, T value); \u5176\u4e2d\uff0c \u5c5e\u6027\u540d\u79f0 title \u5177\u6709\u552f\u4e00\u6027\uff0c\u4e0d\u5b58\u5728\u65f6\u65b0\u5efa\u5c5e\u6027\uff0c\u5426\u5219\u8986\u76d6\u5df2\u5b58\u5728\u7684\u5c5e\u6027\u5373\u7f16\u8f91\u5c5e\u6027 value \u53c2\u6570\u7684\u7c7b\u578b\u51b3\u5b9a\u4e86\u8be5\u5c5e\u6027\u7684\u7c7b\u578b\uff1a integer , number , string \u6839\u636e\u5c5e\u6027\u7684\u7c7b\u578b\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u51fd\u6570\u83b7\u53d6\u5c5e\u6027\u503c\uff1a GetIntegerAttribute(title) \u83b7\u53d6\u6574\u6570\u7c7b\u578b\u5c5e\u6027 GetRealAttribute(title) \u83b7\u53d6\u6d6e\u70b9\u6570\u7c7b\u578b\u5c5e\u6027 GetStringAttribute(title) \u83b7\u53d6\u5b57\u7b26\u4e32\u7c7b\u578b\u5c5e\u6027 \u6ce8\u610f SetAttribute()\u65b9\u6cd5\u81eaNX8\u8d77\u5df2\u4e0d\u88ab\u63a8\u8350\u4f7f\u7528\uff0c\u800c\u662f\u4f7f\u7528SetUserAttribute()\u66ff\u4ee3\u4e4b\u3002","title":"NXObject\u7c7b\u6210\u5458\u51fd\u6570SetAttribute"},{"location":"2018-05-04-NXOpen%EF%BC%9A%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C/#nxobjectsetuserattribute","text":"// Creates or modifies an integer attribute with the option to update or not. SetUserAttribute (const NXString &title, int index, T value, NXOpen::Update::Option option); // get attributes GetIntegerUserAttribute (const NXString &title, int index); GetRealUserAttribute (const NXString &title, int index); GetStringUserAttribute (const NXString &title, int index); \u6b64\u65b9\u6cd5\u521b\u5efa/\u4fee\u6539/\u83b7\u53d6\u5c5e\u6027\u7684\u6027\u8d28\u7c7b\u4f3c\u4e8e SetAttribute() \u65b9\u6cd5\uff0c\u5176\u66f4\u5f3a\u5927\u4e4b\u5904\u5728\u4e8e\u53ef\u4ee5\u8bbe\u7f6e\u591a\u503c\u5c5e\u6027\uff0c\u5373\u901a\u8fc7\u4ee5\u4e0a index \u53c2\u6570\u5b9e\u73b0\u3002 index=-1 \u8868\u793a\u8be5\u5c5e\u6027\u4ec5\u5bf9\u5e94\u4e00\u4e2a\u503c\uff0c\u5e76\u975e\u591a\u503c\u5c5e\u6027 index=0,1,2... \u5206\u522b\u8bbe\u7f6e\u591a\u503c\u5c5e\u6027\u7684\u5404\u4e2a\u5143\u7d20\u503c \u83b7\u53d6\u5c5e\u6027\u65f6\u7684 index \u4f5c\u7528\u540c\u7406","title":"NXObject\u7c7b\u6210\u5458\u51fd\u6570SetUserAttribute"},{"location":"2018-05-04-NXOpen%EF%BC%9A%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C/#_1","text":"\u4f7f\u7528 Session \u5bf9\u8c61\u7684\u5c5e\u6027\u7ba1\u7406\u5668\u4ea6\u53ef\u7ba1\u7406\u5bf9\u8c61\u5c5e\u6027\uff0c\u9664\u4e86\u53ef\u4ee5\u5982 SetUserAttribute() \u4e00\u822c\u8bbe\u7f6e\u591a\u503c\u5c5e\u6027\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6eCategory\uff0c\u4fbf\u4e8e\u5206\u7c7b\u7ba1\u7406\u76f8\u5173\u5c5e\u6027\u3002 // get Builder NXOpen::AttributePropertiesBuilder *builder = theSession->AttributeManager()->CreateAttributePropertiesBuilder( NXOpen::BasePart *part, const std::vector<NXOpen::NXObject*> &objects, NXOpen::AttributePropertiesBuilder::OperationType operationType ); // set categoty builder->SetCategory (const NXString &category); // set title builder->SetTitle(const NXString &title); // set array index if necessary builder->SetArray (bool isArray); // have more than one value if true builder->SetArrayIndex (int arrayIndex); // ----------\u4ee5\u4e0a\u786e\u5b9a\u5177\u4f53\u7684\u5c5e\u6027\uff0c\u63a5\u4e0b\u6765\u8bbe\u7f6e/\u83b7\u53d6\u503c---------- // set value builder->SetIntegerValue (int integerValue); builder->SetNumberValue (double numberValue); builder->SetStringValue (const NXString &stringValue); // get value builder->IntegerValue (); builder->NumberValue (); builder->StringValue (); title \u548c index \u552f\u4e00\u786e\u5b9a\u5c5e\u6027\uff0c\u4e0d\u5b58\u5728\u65f6\u65b0\u5efa\uff0c\u5426\u5219\u8986\u76d6\u5373\u7f16\u8f91\u5c5e\u6027 \u83b7\u53d6\u5c5e\u6027\u65f6\uff0c SetTitle \u786e\u5b9a\u5c5e\u6027\uff0c\u5982\u679c\u662f\u591a\u503c\u5c5e\u6027\uff0c\u8fd8\u9700\u8981 SetArrayIndex \u786e\u5b9a\u5143\u7d20\u4f4d\u7f6e\uff0c\u6700\u7ec8\u4f7f\u7528\u76f8\u5e94\u51fd\u6570\u83b7\u53d6\u5c5e\u6027\u503c\u3002","title":"\u5c5e\u6027\u7ba1\u7406\u5668"},{"location":"2018-05-04-NXOpen%EF%BC%9A%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C/#_2","text":"SetAttribute() \u5c06\u88ab\u5f03\u7528\uff0c\u63a8\u8350 SetUserAttribute() SetUserAttribute() \u53ef\u4ee5\u521b\u5efa\u591a\u503c\u5373\u6570\u7ec4\u5f62\u5f0f\u7684\u5c5e\u6027 AttributePropertiesBuilder \u4e0d\u4ec5\u53ef\u4ee5\u521b\u5efa\u591a\u503c\u5c5e\u6027\uff0c\u8fd8\u53ef\u4ee5\u5206\u7ec4\u7ba1\u7406\u5c5e\u6027 \u4ee5\u4e0a\u65b9\u6cd5\u521b\u5efa\u7684\u5c5e\u6027\u7edf\u4e00\u4e8e\u76f8\u5e94\u5bf9\u8c61\uff0c\u5373\u5b8c\u5168\u53ef\u4ee5\u4ea4\u53c9\u83b7\u53d6\u548c\u4fee\u6539","title":"\u603b\u7ed3"},{"location":"2018-05-06-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%B8%BB%E8%A6%81%E7%B1%BB%E7%BB%93%E6%9E%84%E5%9B%BE/","text":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-05-06 | \u5206\u7c7b\uff1a CAD/CAE integration \u672c\u6587\u57fa\u4e8eNXOpen C++\u5f00\u53d1\u6587\u6863\u53ca\u4f5c\u8005\u5b9e\u9645\u5f00\u53d1\u4e2d\u7ecf\u5e38\u6d89\u53ca\u7684\u64cd\u4f5c\uff0c\u603b\u7ed3\u7ed8\u5236\u4e86NXOpen CAE\u76f8\u5173\u7c7b\u7ed3\u6784\u56fe\uff0c\u4fbf\u4e8e\u601d\u8def\u68b3\u7406\u548c\u5f00\u53d1\u8fc7\u7a0b\u7684\u67e5\u9605\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe"},{"location":"2018-05-06-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%B8%BB%E8%A6%81%E7%B1%BB%E7%BB%93%E6%9E%84%E5%9B%BE/#nxopen cae","text":"\u53d1\u5e03\u4e8e\uff1a2018-05-06 | \u5206\u7c7b\uff1a CAD/CAE integration \u672c\u6587\u57fa\u4e8eNXOpen C++\u5f00\u53d1\u6587\u6863\u53ca\u4f5c\u8005\u5b9e\u9645\u5f00\u53d1\u4e2d\u7ecf\u5e38\u6d89\u53ca\u7684\u64cd\u4f5c\uff0c\u603b\u7ed3\u7ed8\u5236\u4e86NXOpen CAE\u76f8\u5173\u7c7b\u7ed3\u6784\u56fe\uff0c\u4fbf\u4e8e\u601d\u8def\u68b3\u7406\u548c\u5f00\u53d1\u8fc7\u7a0b\u7684\u67e5\u9605\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe"},{"location":"2018-06-25-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AFEM-SIM%E6%A8%A1%E5%9E%8B%E4%B8%ADPolygon-Body%E7%9A%84%E5%90%8D%E7%A7%B0/","text":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-06-25 | \u5206\u7c7b\uff1a CAD/CAE integration \u6211\u4eec\u5df2\u7ecf\u77e5\u9053 Idealized Part \u3001 FEM Part \u3001 SIM Part \u4e2d\u7684\u51e0\u4f55\u5143\u7d20\u5177\u6709\u4e00\u5b9a\u7684\u5173\u8054\uff0c\u4f8b\u5982\u524d\u8005\u7684Body\u5bf9\u8c61\u5bf9\u5e94\u4e86\u540e\u4e24\u8005\u7684Polygon Body\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u540d\u79f0\u5373Name\u5c5e\u6027\u5728\u5173\u8054\u5173\u7cfb\u4e0a\u6709\u4f55\u6ce8\u610f\u4e8b\u9879\u5462\uff1f Idealized Part \u4e2dBody\u7684Name\u5c5e\u6027\u51b3\u5b9a\u4e86\u5176\u5728 FEM Part \u4e2d\u5bf9\u5e94\u7684Polygon body\u7684Name\u5c5e\u6027\u3002 Polygon body\u7684Name\u5c5e\u6027\u6709\u4e24\u79cd\u7b49\u6548\u7684\u7ef4\u62a4\u9014\u5f84\uff1a \u9009\u4e2dPolygon body->\u53f3\u952e->Attribute\u3002 \u4eff\u771f\u5bfc\u822a\u5668->FEM->Polygon Geometry->\u53f3\u952e->Rename\u3002 \u6ce8\u610f\u64cd\u4f5c\u4e0a\u7684\u4e00\u4e2a\u7ec6\u8282\uff1a \u5047\u8bbe\u65b9\u6cd51\u4e2d Name=TEST \uff0c\u5219\u6b64\u5904\u663e\u793a\u7684\u662f TEST(id) \uff0c\u5176\u4e2d id \u4e3a\u8be5\u5bf9\u8c61\u7684\u7f16\u53f7\u3002\u90a3\u4e48\uff0c\u76f4\u63a5rename\u65f6\u7684\u9ed8\u8ba4\u540d\u79f0\u662f TEST(id) \u5373\u7b49\u6548\u4e3a Name=TEST(id) \uff0c\u8fd9\u5c31\u4ea7\u751f\u4e86\u4e0e\u9884\u671f\u4e0d\u76f8\u7b26\u7684\u7ed3\u679c\u3002 \u91cd\u547d\u540d FEM Part \u4e2d\u7684Polygon body\u540e\u4ecd\u7136\u53ef\u4ee5\u6539\u56de\u539f\u6765\u7684\u94fe\u63a5\u81ea Idealized Part \u4e2dBody\u5bf9\u8c61\u7684\u540d\u79f0\uff1a\u4eff\u771f\u5bfc\u822a\u5668->FEM->Polygon Geometry->\u53f3\u952e->Synchrorize to CAD name\u3002 \u6ce8\u610f \u6b64\u65f6\u53ea\u662f\u4fee\u6539\u4e86polygon body\u7684\u663e\u793a\u540d\u79f0\uff0cAttribute\u4e2d\u7684Name\u4f9d\u65e7\u662f\u4fee\u6539\u524d\u7684\u503c\u3002\u4e3a\u4e86\u4fdd\u8bc1Name\u5c5e\u6027\u7684\u7edf\u4e00\uff0c\u5e94\u8be5\u5728Synchrorize to CAD name\u540e\u9a6c\u4e0arename\u4e3a\u8be5\u9ed8\u8ba4\u7684\u540d\u79f0\u3002 \u4f5c\u4e3aOccurrence\uff0c SIM Part \u4e2d\u5bf9\u5e94\u7684Polygon body\u9ed8\u8ba4\u7ee7\u627f\u4e86 FEM Part \u4e2d\u7684\u539f\u59cb\u540d\u79f0\uff0c\u5e76\u4e14 FEM Part \u4e2d\u7684\u91cd\u547d\u540d\u4e5f\u5c31\u540c\u6b65\u66f4\u65b0 SIM Part \u7684Polygon body\u3002 \u4f46\u662f\uff0c \u4e00\u65e6\u4e3a SIM Part \u7684Polygon body\u663e\u5f0f\u5730\u8bbe\u7f6e\u4e86\u540d\u79f0\uff08\u5e76\u4e14\u6b64\u540d\u79f0\u4e0d\u540c\u4e8e\u7ee7\u627f\u7684\u9ed8\u8ba4\u540d\u79f0\uff09\uff0c\u5219\u6253\u7834\u4e86\u81ea\u52a8\u7ee7\u627f\u5173\u7cfb\uff0c\u5176\u540d\u79f0\u4e0d\u518d\u968f\u7740 FEM Part \u4e2dpolygon body\u540d\u79f0\u7684\u6539\u53d8\u800c\u6539\u53d8 \u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0"},{"location":"2018-06-25-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9AFEM-SIM%E6%A8%A1%E5%9E%8B%E4%B8%ADPolygon-Body%E7%9A%84%E5%90%8D%E7%A7%B0/#nxopen caefem simpolygon body","text":"\u53d1\u5e03\u4e8e\uff1a2018-06-25 | \u5206\u7c7b\uff1a CAD/CAE integration \u6211\u4eec\u5df2\u7ecf\u77e5\u9053 Idealized Part \u3001 FEM Part \u3001 SIM Part \u4e2d\u7684\u51e0\u4f55\u5143\u7d20\u5177\u6709\u4e00\u5b9a\u7684\u5173\u8054\uff0c\u4f8b\u5982\u524d\u8005\u7684Body\u5bf9\u8c61\u5bf9\u5e94\u4e86\u540e\u4e24\u8005\u7684Polygon Body\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u540d\u79f0\u5373Name\u5c5e\u6027\u5728\u5173\u8054\u5173\u7cfb\u4e0a\u6709\u4f55\u6ce8\u610f\u4e8b\u9879\u5462\uff1f Idealized Part \u4e2dBody\u7684Name\u5c5e\u6027\u51b3\u5b9a\u4e86\u5176\u5728 FEM Part \u4e2d\u5bf9\u5e94\u7684Polygon body\u7684Name\u5c5e\u6027\u3002 Polygon body\u7684Name\u5c5e\u6027\u6709\u4e24\u79cd\u7b49\u6548\u7684\u7ef4\u62a4\u9014\u5f84\uff1a \u9009\u4e2dPolygon body->\u53f3\u952e->Attribute\u3002 \u4eff\u771f\u5bfc\u822a\u5668->FEM->Polygon Geometry->\u53f3\u952e->Rename\u3002 \u6ce8\u610f\u64cd\u4f5c\u4e0a\u7684\u4e00\u4e2a\u7ec6\u8282\uff1a \u5047\u8bbe\u65b9\u6cd51\u4e2d Name=TEST \uff0c\u5219\u6b64\u5904\u663e\u793a\u7684\u662f TEST(id) \uff0c\u5176\u4e2d id \u4e3a\u8be5\u5bf9\u8c61\u7684\u7f16\u53f7\u3002\u90a3\u4e48\uff0c\u76f4\u63a5rename\u65f6\u7684\u9ed8\u8ba4\u540d\u79f0\u662f TEST(id) \u5373\u7b49\u6548\u4e3a Name=TEST(id) \uff0c\u8fd9\u5c31\u4ea7\u751f\u4e86\u4e0e\u9884\u671f\u4e0d\u76f8\u7b26\u7684\u7ed3\u679c\u3002 \u91cd\u547d\u540d FEM Part \u4e2d\u7684Polygon body\u540e\u4ecd\u7136\u53ef\u4ee5\u6539\u56de\u539f\u6765\u7684\u94fe\u63a5\u81ea Idealized Part \u4e2dBody\u5bf9\u8c61\u7684\u540d\u79f0\uff1a\u4eff\u771f\u5bfc\u822a\u5668->FEM->Polygon Geometry->\u53f3\u952e->Synchrorize to CAD name\u3002 \u6ce8\u610f \u6b64\u65f6\u53ea\u662f\u4fee\u6539\u4e86polygon body\u7684\u663e\u793a\u540d\u79f0\uff0cAttribute\u4e2d\u7684Name\u4f9d\u65e7\u662f\u4fee\u6539\u524d\u7684\u503c\u3002\u4e3a\u4e86\u4fdd\u8bc1Name\u5c5e\u6027\u7684\u7edf\u4e00\uff0c\u5e94\u8be5\u5728Synchrorize to CAD name\u540e\u9a6c\u4e0arename\u4e3a\u8be5\u9ed8\u8ba4\u7684\u540d\u79f0\u3002 \u4f5c\u4e3aOccurrence\uff0c SIM Part \u4e2d\u5bf9\u5e94\u7684Polygon body\u9ed8\u8ba4\u7ee7\u627f\u4e86 FEM Part \u4e2d\u7684\u539f\u59cb\u540d\u79f0\uff0c\u5e76\u4e14 FEM Part \u4e2d\u7684\u91cd\u547d\u540d\u4e5f\u5c31\u540c\u6b65\u66f4\u65b0 SIM Part \u7684Polygon body\u3002 \u4f46\u662f\uff0c \u4e00\u65e6\u4e3a SIM Part \u7684Polygon body\u663e\u5f0f\u5730\u8bbe\u7f6e\u4e86\u540d\u79f0\uff08\u5e76\u4e14\u6b64\u540d\u79f0\u4e0d\u540c\u4e8e\u7ee7\u627f\u7684\u9ed8\u8ba4\u540d\u79f0\uff09\uff0c\u5219\u6253\u7834\u4e86\u81ea\u52a8\u7ee7\u627f\u5173\u7cfb\uff0c\u5176\u540d\u79f0\u4e0d\u518d\u968f\u7740 FEM Part \u4e2dpolygon body\u540d\u79f0\u7684\u6539\u53d8\u800c\u6539\u53d8 \u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0"},{"location":"2018-07-01-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%BB%8EANSYS-APDL%E8%A7%92%E5%BA%A6%E7%9C%8B%E5%BE%85Mesh/","text":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-07-01 | \u5206\u7c7b\uff1a CAD/CAE integration \u5728NX\u4e2d\u521b\u5efaSimulation\u65f6\u9700\u8981\u6307\u5b9a\u6c42\u89e3\u5668\u7c7b\u578b\uff0c\u672c\u6587\u5728\u6307\u5b9aANSYS\u6c42\u89e3\u5668\u7684\u524d\u63d0\u4e0b\uff0c\u5206\u6790FEM\u6a21\u5757Mesh\u76f8\u5173\u64cd\u4f5c\u4e0e\u6700\u7ec8\u5bfc\u51fa\u7684ANSYS input\u6587\u4ef6\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002 APDL\u5355\u5143\u7c7b\u578b\u53f7\u547d\u4ee4 \u00b6 APDL\u8bbe\u7f6e\u5355\u5143\u7c7b\u578b\u53f7\u547d\u4ee4\uff1a ET, N, PLANE183 ! \u8bbe\u7f6e\u7b2cN\u53f7\u5355\u5143\u7c7b\u578b\uff08Element Type\uff09\u4e3aPLANE183 \u4e3a\u6307\u5b9a\u7684Element Type\u8bbe\u7f6e\u5173\u952e\u53c2\u6570 KEYOPT \uff1a KEYOPT, N, 3, 1 ! ET=N\u7684KEYOPT(3)=1\uff0c\u5373\u8f74\u5bf9\u79f0\u7c7b\u578b NX Mesh\u76f8\u5173\u64cd\u4f5c \u00b6 \u4e0d\u540c\u51e0\u4f55\u4f53\u7684\u7f51\u683c\u5212\u5206\u7ed3\u679c\u5b58\u50a8\u5728 Mesh Collector \u4e0b\u3002 \u5728\u4eff\u771f\u5bfc\u822a\u5668\u4e2d\u9009\u62e9Mesh\u8282\u70b9\u540e\uff0c\u53ef\u4ee5\u5728\u53f3\u952e\u83dc\u5355\u4e2d\u7f16\u8f91 Mesh associated data \uff0c\u5176\u4e2d\u5305\u542b Name \u3001 Label \uff0c KEYOPT \u7b49\u5c5e\u6027\u3002 File->Export->Simulation\uff0c\u8bbe\u7f6e\u5bfc\u51fa\u7c7b\u578b\u4e3aANSYS \u5173\u7cfb\u793a\u610f\u56fe\uff1a +-------------------------+ | Mesh Collector | | +--+ 2d_mesh(1) | mesh associated | +--+ 2d_mesh(2) +------+data | Simulation | | +--------+----------------+ | | +-------v----------+ | | Name : --- | | | Label : 2 | | | KEYOPTS: +-+ | | +------------------+ +---------+-------------+ | +------v------+ |ET,2,PLANE183| |... | +------+------+ | +------------------v------------------------+ | !MAT ET R XSec Eds EL Nodes | | .......... | | .......... | | ansys.inp | +-------------------------------------------+ \u5bf9\u5e94\u5173\u7cfb \u00b6 \u6bcf\u4e2aMesh\uff08\u4f8b\u5982 2d_mesh(1) \uff09\u5bf9\u5e94\u4e00\u4e2a\u552f\u4e00\u7684\u7f16\u53f7\uff0c\u9ed8\u8ba4\u4e3a1,2,3...\uff0c\u5bf9\u5e94\u4e86\u5bfc\u51fa\u7684inp\u6587\u4ef6\u4e2d\u7684 ET \u53f7\u3002 mesh associated data \u5c5e\u6027\u7b49\u540c\u4e8eANSYS\u7684 ET \u7684\u5b9a\u4e49\uff0c\u5176\u4e2d Label \u5bf9\u5e94 ET \u53f7\u3002 \u5bfc\u51fainp\u6587\u4ef6\u65f6\uff0c\u7efc\u5408\u4ee5\u4e0a\u4e24\u70b9\u5206\u914d ET \u53f7\u3002\u51fa\u73b0\u51b2\u7a81\u65f6\uff0c\u4ee5 mesh associated data \u7684 Label \u503c\u4e3a\u51c6\uff0c\u9ed8\u8ba4\u7684\u51b2\u7a81\u503c\u987a\u5ef6\u76f4\u81f3\u6d88\u9664\u51b2\u7a81\u3002 \u6700\u540e\uff0c ET \u53f7\u5c06\u6dfb\u52a0\u5230\u5c5e\u4e8e\u8be5Mesh\u7684\u6240\u6709Element\u4e0a\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh"},{"location":"2018-07-01-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%BB%8EANSYS-APDL%E8%A7%92%E5%BA%A6%E7%9C%8B%E5%BE%85Mesh/#nxopen caeansys apdlmesh","text":"\u53d1\u5e03\u4e8e\uff1a2018-07-01 | \u5206\u7c7b\uff1a CAD/CAE integration \u5728NX\u4e2d\u521b\u5efaSimulation\u65f6\u9700\u8981\u6307\u5b9a\u6c42\u89e3\u5668\u7c7b\u578b\uff0c\u672c\u6587\u5728\u6307\u5b9aANSYS\u6c42\u89e3\u5668\u7684\u524d\u63d0\u4e0b\uff0c\u5206\u6790FEM\u6a21\u5757Mesh\u76f8\u5173\u64cd\u4f5c\u4e0e\u6700\u7ec8\u5bfc\u51fa\u7684ANSYS input\u6587\u4ef6\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002","title":"NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh"},{"location":"2018-07-01-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%BB%8EANSYS-APDL%E8%A7%92%E5%BA%A6%E7%9C%8B%E5%BE%85Mesh/#apdl","text":"APDL\u8bbe\u7f6e\u5355\u5143\u7c7b\u578b\u53f7\u547d\u4ee4\uff1a ET, N, PLANE183 ! \u8bbe\u7f6e\u7b2cN\u53f7\u5355\u5143\u7c7b\u578b\uff08Element Type\uff09\u4e3aPLANE183 \u4e3a\u6307\u5b9a\u7684Element Type\u8bbe\u7f6e\u5173\u952e\u53c2\u6570 KEYOPT \uff1a KEYOPT, N, 3, 1 ! ET=N\u7684KEYOPT(3)=1\uff0c\u5373\u8f74\u5bf9\u79f0\u7c7b\u578b","title":"APDL\u5355\u5143\u7c7b\u578b\u53f7\u547d\u4ee4"},{"location":"2018-07-01-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%BB%8EANSYS-APDL%E8%A7%92%E5%BA%A6%E7%9C%8B%E5%BE%85Mesh/#nx mesh","text":"\u4e0d\u540c\u51e0\u4f55\u4f53\u7684\u7f51\u683c\u5212\u5206\u7ed3\u679c\u5b58\u50a8\u5728 Mesh Collector \u4e0b\u3002 \u5728\u4eff\u771f\u5bfc\u822a\u5668\u4e2d\u9009\u62e9Mesh\u8282\u70b9\u540e\uff0c\u53ef\u4ee5\u5728\u53f3\u952e\u83dc\u5355\u4e2d\u7f16\u8f91 Mesh associated data \uff0c\u5176\u4e2d\u5305\u542b Name \u3001 Label \uff0c KEYOPT \u7b49\u5c5e\u6027\u3002 File->Export->Simulation\uff0c\u8bbe\u7f6e\u5bfc\u51fa\u7c7b\u578b\u4e3aANSYS \u5173\u7cfb\u793a\u610f\u56fe\uff1a +-------------------------+ | Mesh Collector | | +--+ 2d_mesh(1) | mesh associated | +--+ 2d_mesh(2) +------+data | Simulation | | +--------+----------------+ | | +-------v----------+ | | Name : --- | | | Label : 2 | | | KEYOPTS: +-+ | | +------------------+ +---------+-------------+ | +------v------+ |ET,2,PLANE183| |... | +------+------+ | +------------------v------------------------+ | !MAT ET R XSec Eds EL Nodes | | .......... | | .......... | | ansys.inp | +-------------------------------------------+","title":"NX Mesh\u76f8\u5173\u64cd\u4f5c"},{"location":"2018-07-01-NXOpen-CAE%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93%E7%B3%BB%E5%88%97%EF%BC%9A%E4%BB%8EANSYS-APDL%E8%A7%92%E5%BA%A6%E7%9C%8B%E5%BE%85Mesh/#_1","text":"\u6bcf\u4e2aMesh\uff08\u4f8b\u5982 2d_mesh(1) \uff09\u5bf9\u5e94\u4e00\u4e2a\u552f\u4e00\u7684\u7f16\u53f7\uff0c\u9ed8\u8ba4\u4e3a1,2,3...\uff0c\u5bf9\u5e94\u4e86\u5bfc\u51fa\u7684inp\u6587\u4ef6\u4e2d\u7684 ET \u53f7\u3002 mesh associated data \u5c5e\u6027\u7b49\u540c\u4e8eANSYS\u7684 ET \u7684\u5b9a\u4e49\uff0c\u5176\u4e2d Label \u5bf9\u5e94 ET \u53f7\u3002 \u5bfc\u51fainp\u6587\u4ef6\u65f6\uff0c\u7efc\u5408\u4ee5\u4e0a\u4e24\u70b9\u5206\u914d ET \u53f7\u3002\u51fa\u73b0\u51b2\u7a81\u65f6\uff0c\u4ee5 mesh associated data \u7684 Label \u503c\u4e3a\u51c6\uff0c\u9ed8\u8ba4\u7684\u51b2\u7a81\u503c\u987a\u5ef6\u76f4\u81f3\u6d88\u9664\u51b2\u7a81\u3002 \u6700\u540e\uff0c ET \u53f7\u5c06\u6dfb\u52a0\u5230\u5c5e\u4e8e\u8be5Mesh\u7684\u6240\u6709Element\u4e0a\u3002","title":"\u5bf9\u5e94\u5173\u7cfb"},{"location":"2018-09-28-NXOpen%EF%BC%9A%E7%A6%81%E7%94%A8%E8%8F%9C%E5%8D%95%E9%A1%B9/","text":"NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-09-28 | \u5206\u7c7b\uff1a CAD/CAE integration NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 \u8bf4\u660e\u4e86\u6309\u7167\u6a21\u5757\u663e\u793a\u4e0d\u540c\u83dc\u5355\u680f\u5185\u5bb9\u7684\u65b9\u6cd5\uff0c\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u5373\u4fbf\u5bf9\u4e8e\u540c\u4e00\u6a21\u5757\u4e0b\u7684\u83dc\u5355\u9879\uff0c\u4e5f\u4f1a\u56e0\u4e3a\u4e0d\u6ee1\u8db3\u67d0\u4e9b\u4f7f\u7528\u6761\u4ef6\u800c\u5448\u73b0\u7981\u7528\uff08\u7070\u8272\uff09\u72b6\u6001\u3002\u672c\u7bc7\u5373\u8bb0\u5f55\u7981\u7528/\u542f\u7528\u83dc\u5355\u9879\u7684\u65b9\u6cd5\u3002 \u9759\u6001\u8bbe\u7f6e\u65b9\u6cd5 \u00b6 \u5728\u83dc\u5355\u811a\u672c\u4e2d\u8bbe\u7f6e\u83dc\u5355\u9879 BUTTON \u7684 SENSITIVITY \u5c5e\u6027\u4e3a OFF \u5373\u53ef\u5c06\u8be5\u83dc\u5355\u9879\u521d\u59cb\u5316\u4e3a\u7981\u7528\u72b6\u6001\u3002\u4ee5 NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 \u4e2d test_modeling.men \u4e3a\u4f8b\uff0c\u5c06\u5176\u4e2d\u83dc\u5355\u9879\u5b9a\u4e49\u90e8\u5206\uff1a BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 BUTTON TEST_MENU_MODELING_2 LABEL Modeling Button 2 BUTTON TEST_MENU_MODELING_3 LABEL Modeling Button 3 \u4fee\u6539\u4e3a\uff1a BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 BUTTON TEST_MENU_MODELING_2 LABEL Modeling Button 2 SENSITIVITY OFF BUTTON TEST_MENU_MODELING_3 LABEL Modeling Button 3 SENSITIVITY OFF \u5219 Modeling Button 2 \u548c Modeling Button 3 \u9ed8\u8ba4\u4e3a\u7070\u8272\u7684\u7981\u7528\u72b6\u6001\uff0c\u5982\u5f00\u59cb\u7684\u622a\u56fe\u6240\u793a\u3002 \u52a8\u6001\u8bbe\u7f6e\u65b9\u6cd5 \u00b6 \u66f4\u8feb\u5207\u7684\u9700\u6c42\u53ef\u80fd\u662f\uff0c\u5728\u4ee3\u7801\u4e2d\u6839\u636e\u5f53\u524d\u6761\u4ef6\u6765\u5224\u65ad\u548c\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u7981\u7528/\u542f\u7528\u72b6\u6001\u3002\u5176\u65b9\u6cd5\u4e3a\uff1a \u6839\u636e\u83dc\u5355\u540d\u79f0\u83b7\u53d6\u83dc\u5355\u5bf9\u8c61\u3002\u4f8b\u5982\u4e0a\u9762\u4ee3\u7801\u4e2d BUTTON TEST_MENU_MODELING_2 \u5373\u5b9a\u4e49\u4e86\u8be5\u83dc\u5355\u9879\u552f\u4e00\u7684\u540d\u79f0\u6807\u8bc6 TEST_MENU_MODELING_2 \u3002 \u8bbe\u7f6e\u83dc\u5355\u5bf9\u8c61\u7684 sensitivity \u5c5e\u6027\u3002 \u4ee5NXOpen Python\u4e3a\u4f8b\uff1a import NXOpen import NXOpen.MenuBar status = NXOpen.MenuBar.MenuButtonSensitivityStatus.Insensitive # \u7981\u7528 button = NXOpen.UI.GetUI().MenuBarManager.GetButtonFromName('TEST_MENU_MODELING_2') button.ButtonSensitivity = status","title":"NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879"},{"location":"2018-09-28-NXOpen%EF%BC%9A%E7%A6%81%E7%94%A8%E8%8F%9C%E5%8D%95%E9%A1%B9/#nxopen","text":"\u53d1\u5e03\u4e8e\uff1a2018-09-28 | \u5206\u7c7b\uff1a CAD/CAE integration NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 \u8bf4\u660e\u4e86\u6309\u7167\u6a21\u5757\u663e\u793a\u4e0d\u540c\u83dc\u5355\u680f\u5185\u5bb9\u7684\u65b9\u6cd5\uff0c\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u5373\u4fbf\u5bf9\u4e8e\u540c\u4e00\u6a21\u5757\u4e0b\u7684\u83dc\u5355\u9879\uff0c\u4e5f\u4f1a\u56e0\u4e3a\u4e0d\u6ee1\u8db3\u67d0\u4e9b\u4f7f\u7528\u6761\u4ef6\u800c\u5448\u73b0\u7981\u7528\uff08\u7070\u8272\uff09\u72b6\u6001\u3002\u672c\u7bc7\u5373\u8bb0\u5f55\u7981\u7528/\u542f\u7528\u83dc\u5355\u9879\u7684\u65b9\u6cd5\u3002","title":"NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879"},{"location":"2018-09-28-NXOpen%EF%BC%9A%E7%A6%81%E7%94%A8%E8%8F%9C%E5%8D%95%E9%A1%B9/#_1","text":"\u5728\u83dc\u5355\u811a\u672c\u4e2d\u8bbe\u7f6e\u83dc\u5355\u9879 BUTTON \u7684 SENSITIVITY \u5c5e\u6027\u4e3a OFF \u5373\u53ef\u5c06\u8be5\u83dc\u5355\u9879\u521d\u59cb\u5316\u4e3a\u7981\u7528\u72b6\u6001\u3002\u4ee5 NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 \u4e2d test_modeling.men \u4e3a\u4f8b\uff0c\u5c06\u5176\u4e2d\u83dc\u5355\u9879\u5b9a\u4e49\u90e8\u5206\uff1a BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 BUTTON TEST_MENU_MODELING_2 LABEL Modeling Button 2 BUTTON TEST_MENU_MODELING_3 LABEL Modeling Button 3 \u4fee\u6539\u4e3a\uff1a BUTTON TEST_MENU_MODELING_1 LABEL Modeling Button 1 BUTTON TEST_MENU_MODELING_2 LABEL Modeling Button 2 SENSITIVITY OFF BUTTON TEST_MENU_MODELING_3 LABEL Modeling Button 3 SENSITIVITY OFF \u5219 Modeling Button 2 \u548c Modeling Button 3 \u9ed8\u8ba4\u4e3a\u7070\u8272\u7684\u7981\u7528\u72b6\u6001\uff0c\u5982\u5f00\u59cb\u7684\u622a\u56fe\u6240\u793a\u3002","title":"\u9759\u6001\u8bbe\u7f6e\u65b9\u6cd5"},{"location":"2018-09-28-NXOpen%EF%BC%9A%E7%A6%81%E7%94%A8%E8%8F%9C%E5%8D%95%E9%A1%B9/#_2","text":"\u66f4\u8feb\u5207\u7684\u9700\u6c42\u53ef\u80fd\u662f\uff0c\u5728\u4ee3\u7801\u4e2d\u6839\u636e\u5f53\u524d\u6761\u4ef6\u6765\u5224\u65ad\u548c\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u83dc\u5355\u7684\u7981\u7528/\u542f\u7528\u72b6\u6001\u3002\u5176\u65b9\u6cd5\u4e3a\uff1a \u6839\u636e\u83dc\u5355\u540d\u79f0\u83b7\u53d6\u83dc\u5355\u5bf9\u8c61\u3002\u4f8b\u5982\u4e0a\u9762\u4ee3\u7801\u4e2d BUTTON TEST_MENU_MODELING_2 \u5373\u5b9a\u4e49\u4e86\u8be5\u83dc\u5355\u9879\u552f\u4e00\u7684\u540d\u79f0\u6807\u8bc6 TEST_MENU_MODELING_2 \u3002 \u8bbe\u7f6e\u83dc\u5355\u5bf9\u8c61\u7684 sensitivity \u5c5e\u6027\u3002 \u4ee5NXOpen Python\u4e3a\u4f8b\uff1a import NXOpen import NXOpen.MenuBar status = NXOpen.MenuBar.MenuButtonSensitivityStatus.Insensitive # \u7981\u7528 button = NXOpen.UI.GetUI().MenuBarManager.GetButtonFromName('TEST_MENU_MODELING_2') button.ButtonSensitivity = status","title":"\u52a8\u6001\u8bbe\u7f6e\u65b9\u6cd5"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/","text":"Python Package __init__\u89e3\u6790 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-10-21 | \u5206\u7c7b\uff1a python/vba/cpp \u5355\u4e2aPython\u6587\u4ef6\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a Module \u88ab\u5bfc\u5165\u91cd\u7528\uff0c\u591a\u4e2aModule\u53ef\u4ee5\u7ec4\u7ec7\u4e3a Package \u3002Package\u4e0b\u4e00\u822c\u90fd\u6709\u4e00\u4e2a __init__.py \u6587\u4ef6\uff0c\u800c\u4e14\u5185\u5bb9\u53ef\u80fd\u5565\u4e5f\u6ca1\u6709\u3002\u672c\u7bc7\u5373\u89e3\u91ca\u6b64 __init__.py \u6587\u4ef6\u7684\u4f7f\u7528\u3002 \u6587\u4ef6\u7ed3\u6784 \u00b6 \u4ee5\u4e0b\u6587\u4ef6\u7ed3\u6784\u4f5c\u4e3a\u672c\u7bc7\u8bd5\u9a8c\u6d4b\u8bd5\u4f9d\u636e\uff1a +-----------------------------+ +---------------------------------+ | + Package | |# Package/Sub_Package/module_a.py| | | | | |x = 1 | | | + Sub_Package | +---------------------------------+ | | | | | | | | + module_a.py | +---------------------------------+ | | | + module_b.py | |# Package/Sub_Package/module_b.py| | | | + __init__.py | |from . import module_a | | | | | |x = module_a.x + 1 | | | + module_c.py | +---------------+-----------------+ | | | | | | + __init__.py | +---------------------+ | + test.py | |# Package/module_c.py| | | |x = 3 | +-----------------------------+ +---------------------+ \u5176\u4e2d\uff0c test.py \u4e3a\u6d4b\u8bd5\u6587\u4ef6\uff0c Package \u4e3a\u5f85\u6d4b\u8bd5\u7684\u5305 Package \u5305\u542b\u6a21\u5757 module_c.py \u548c\u5b50\u5305 Sub_Package \uff0c\u4ee5\u53ca\u8be5\u5305\u7684 __init__.py \u6587\u4ef6 Sub_Package \u5305\u542b\u4e24\u4e2a\u6a21\u5757 module_a.py \u548c module_b.py \uff0c\u4ee5\u53ca\u8be5\u5305\u7684 __init__.py \u6587\u4ef6 Sub_Package \u4e2dmodule_a\u6a21\u5757\u88abmodule_b\u5bfc\u5165\u4f7f\u7528 \u4ee5\u4e0b\u57fa\u4e8e\u4e09\u79cd\u4e0d\u540c\u7684\u5bfc\u5305\u65b9\u5f0f\uff0c\u793a\u4f8b __init__.py \u7684\u4f5c\u7528\u3002 from Package import module \u00b6 \u6b64\u4e3a\u7cbe\u786e\u5bfc\u5165\u7684\u5f62\u5f0f\u2014\u2014\u660e\u786e\u6307\u5b9a\u5bfc\u5165\u6a21\u5757\u7684\u540d\u79f0\u3002\u8fd9\u79cd\u60c5\u51b5\u5bf9 __init__.py \u6ca1\u6709\u7279\u6b8a\u8981\u6c42\uff0c\u53ef\u4ee5\u4e3a\u7a7a\u751a\u81f3\u4e0d\u9700\u8981\u8be5\u6587\u4ef6\u3002\u5176\u4f5c\u7528\u4ec5\u4ec5\u662f\u8868\u660e Package \u6587\u4ef6\u5939\u7ba1\u7406\u7684\u662f\u4e00\u4e2a\u5305\u3002 # test.py from Package import module_c print(module_c.x) # 3 # \u5bfc\u5165\u5b50\u5305\u4e2d\u7684\u6a21\u5757 from Package.Sub_Package import module_a print(module_a.x) # 1 from Package import * \u00b6 \u5982\u679c\u4f9d\u65e7\u4fdd\u6301 __init__.py \u4e3a\u7a7a\uff0c\u5219\u4e0b\u9762\u4ee3\u7801\u65e0\u6cd5\u6b63\u786e\u5bfc\u5165module_c\u6a21\u5757\u3002 # test.py from Package import * print(module_c.x) # name 'module_c' is not defined \u5bf9\u4e8e\u8fd9\u79cd\u6a21\u7cca\u5bfc\u5165\u7684\u65b9\u5f0f\uff0c\u9700\u8981\u5728 __init__.py \u4e2d\u5b9a\u4e49\u53d8\u91cf __all__ \u6765\u6307\u5b9a from Package import * \u65f6\u6240\u5305\u542b\u7684\u5185\u5bb9\u3002\u8865\u5145\u5982\u4e0b\u4ee3\u7801\u540e\uff0c\u5373\u53ef\u4f7f\u7528\u4e0a\u4e00\u6bb5\u4ee3\u7801\u6b63\u786e\u5f15\u5165module_c\u3002 # Package/__init__.py __all__ = ['module_c'] __init__.py \u6587\u4ef6\u4f1a\u5728\u5bfc\u5165\u5305\u7684\u65f6\u5019\u6267\u884c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u5176\u4e2d\u8fdb\u884c\u4e00\u4e9b\u521d\u59cb\u5316\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u521d\u59cb\u5316\u4e00\u4e2a\u53d8\u91cf x \uff1a # Package/__init__.py x = 4 __all__ = ['module_c', 'x'] # test.py from Package import * print(module_c.x) # 3 print(x) # 4 import Package \u00b6 \u5b9e\u9645\u4e0a\uff0c import Package \u4e0d\u4f1a\u5bfc\u5165\u4efb\u4f55\u6a21\u5757\u6216\u8005\u5b50\u5305\uff0c\u4ee5\u4e0a\u4f8b\u4e2d\u7684 Package/__init__.py \u4e3a\u5f53\u524d\u72b6\u6001\uff0c\u5219\u6709\uff1a # test.py import Package print(Package.module_c.x) # module 'Package' has no attribute 'module_c' print(Package.x) # 4 \u7531\u4e8e\u672a\u5bfc\u5165\u4efb\u4f55\u6a21\u5757\uff0c\u6545 Package.module_c \u51fa\u9519\uff1b\u7531\u4e8e\u5bfc\u5305\u7684\u65f6\u5019\u6267\u884c\u4e86 __init__.py \uff0c\u5373\u521d\u59cb\u5316\u4e86\u53d8\u91cf x \uff0c\u6545 Package.x \u6b63\u786e\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a\u5229\u7528 __init__.py \u6587\u4ef6\u5728\u5bfc\u5165\u5305\u65f6\u88ab\u6267\u884c\u7684\u7279\u70b9\uff0c\u5728 __init__.py \u4e2d\u663e\u5f0f\u5bfc\u5165\u5b50\u6a21\u5757/\u5b50\u5305 \u3002 \u66f4\u65b0\u540e\u7684\u6587\u4ef6\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5219\u4e0a\u4e00\u6bb5\u4ee3\u7801\u53ef\u4ee5\u6b63\u786e\u6267\u884c\u4e86\u3002 # Package/__init__.py from . import module_c # \u663e\u5f0f\u5bfc\u5165\u5b50\u6a21\u5757 from . import Sub_Package # \u663e\u5f0f\u5bfc\u5165\u5b50\u5305 x = 4 __all__ = ['module_c', 'x'] \u4ee5\u4e0a\u4ee3\u7801\u5757\u4e2d from . import Sub_Package \u5bfc\u5165\u5b50\u5305\uff0c\u4f7f\u5f97\u53ef\u4ee5\u8bc6\u522b Package.Sub_Package \uff1b\u4e3a\u4e86\u6210\u529f\u5bfc\u5165 Sub_Package \u4e0b\u7684\u6a21\u5757\uff0c\u540c\u7406\u9700\u8981\u5728 Sub_Package/__init__.py \u4e2d\u663e\u5f0f\u5bfc\u5165\u76f8\u5e94\u5b50\u6a21\u5757\u3002 # Package/Sub_Package/__init__.py from . import module_a from . import module_b \u4e8e\u662f\uff0c\u5bf9\u5b50\u5305\u4e2d\u7684\u6a21\u5757\u7684\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff1a # test.py import Package print(Package.Sub_Package.module_b.x) # 2 \u5b50\u5305\u4e2d\u7684\u5bfc\u5165\u95ee\u9898 \u00b6 \u5b50\u5305\u4e2d\u540c\u7ea7\u6a21\u5757\u7684\u5bfc\u5165\uff0c\u4f8b\u5982 Sub_Package \u4e0b module_b \u5bfc\u5165 module_a \uff0c\u53ef\u80fd\u6709\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\uff1a import module_a # Package/Sub_Package/module_b.py import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # 2 # test.py import Package print(Package.Sub_Package.module_b.x) # No module named 'module_a' \u5b50\u6a21\u5757\u8c03\u7528\u65f6\u5165\u53e3 module_b \u53ef\u4ee5\u6b63\u786e\u627e\u5230\u540c\u7ea7\u7684 module_a \uff0c\u800c test.py \u4e2d\u5165\u53e3\u5728 Package \uff0c\u6545\u65e0\u6cd5\u6b63\u786e\u627e\u5230 module_a \u3002 from . import module_a \u8fd9\u662f\u76f8\u5bf9\u5bfc\u5165\u65b9\u5f0f\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u7136\u800c\uff0c\u5b50\u6a21\u5757\u5185\u8fd0\u884c\u5374\u51fa\u9519\u3002\u8fd9\u662f\u56e0\u4e3a**\u76f8\u5bf9\u5bfc\u5165\u65b9\u5f0f\u4ec5\u80fd\u5e94\u7528\u4e8e\u5305**\uff0c\u800cPython\u89e3\u91ca\u5668\u8bc6\u522b\u5305\u7684\u7684\u4e24\u4e2a\u6761\u4ef6\uff1a - \u6587\u4ef6\u5939\u4e2d\u5fc5\u987b\u6709 __init__.py \u6587\u4ef6 - \u4e0d\u80fd\u4f5c\u4e3a\u9876\u5c42\u6a21\u5757\u6765\u6267\u884c\u8be5\u6587\u4ef6\u5939\u4e2d\u7684py\u6587\u4ef6\uff08\u5373\u4e0d\u80fd\u4f5c\u4e3a\u4e3b\u51fd\u6570\u7684\u5165\u53e3\uff09 \u663e\u7136\uff0c\u76f4\u63a5\u8fd0\u884c\u5b50\u6a21\u5757 module_b.py \u8fdd\u80cc\u4e86\u6761\u4ef6\u4e8c\u3002 # Package/Sub_Package/module_b.py from . import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # cannot import name 'module_a' # test.py import Package print(Package.Sub_Package.module_b.x) # 2 from Package.Sub_Package import module_a \u8fd9\u662f\u7edd\u5bf9\u5bfc\u5165\u65b9\u5f0f\u3002\u5f53\u5165\u53e3\u662f Package \u5305\u65f6\uff0c\u81ea\u7136\u53ef\u4ee5\u6b63\u786e\u8bc6\u522b Package.Sub_Package \u3002\u800c\u76f4\u63a5\u8fd0\u884c\u5b50\u6a21\u5757\u65f6\uff0c\u663e\u7136\u65e0\u6cd5\u8bc6\u522b\u4e86\u3002 # Package/Sub_Package/module_b.py from Package.Sub_Package import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # No module named 'Package' # test.py import Package print(Package.Sub_Package.module_b.x) # 2 \u5f53\u7136\u4e5f\u6709\u65b9\u6cd5\u4f7f\u5b50\u6a21\u5757\u6b63\u5e38\u8fd0\u884c\u2014\u2014\u5c06 Package \u6240\u5728\u76ee\u5f55\u52a0\u5165\u7cfb\u7edf\u641c\u7d22\u76ee\u5f55\u5373\u53ef\u3002\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u5904\u7406\u5374\u4e0d\u662f\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a module_b \u6700\u7ec8\u76ee\u7684\u662f\u4e3aPackage\u6240\u8c03\u7528\uff0c\u5e76\u4e0d\u9700\u8981\u76f4\u63a5\u8fd0\u884c\u5b83\u3002\u56e0\u6b64\u4ee5\u4e0a\u7684\u7edd\u5bf9\u6216\u8005\u76f8\u5bf9\u8c03\u7528\u65b9\u5f0f\u8db3\u4ee5\u6ee1\u8db3\u9700\u6c42\uff1b\u5e76\u4e14\uff0c\u76f8\u5bf9\u8c03\u7528\u65b9\u5f0f\u7684\u901a\u7528\u6027\u66f4\u597d\uff0c\u56e0\u4e3a\u5b83\u4e0d\u53d7Package\u7684\u540d\u79f0\u6240\u5f71\u54cd\u3002 # Package/Sub_Package/module_b.py import os import sys script_path = os.path.abspath(__file__) # \u5f53\u524dmodule\u7edd\u5bf9\u8def\u5f84 package_path = os.path.dirname(os.path.dirname(os.path.dirname(script_path))) # \u4e0a\u4e09\u7ea7\u8def\u5f84\uff0c\u5373Package\u7684\u7236\u76ee\u5f55 sys.path.append(package_path) # \u52a0\u5165\u9ed8\u8ba4\u641c\u7d22\u8def\u5f84\u5217\u8868 from Package.Sub_Package import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # 2 \u603b\u7ed3 \u00b6 __init__.py \u8868\u660e\u6240\u5728\u6587\u4ef6\u5939\u4e3aPackage\uff0c\u5e76\u4e14\u5728import\u8be5Package\u65f6\u4f1a\u88ab\u6267\u884c __init__.py \u4e2d\u5b9a\u4e49 __all__ \u6307\u660e\u6a21\u7cca\u5bfc\u5165\u7684\u6a21\u5757\u6216\u53d8\u91cf \u9488\u5bf9 import package \u7684\u5bfc\u5165\u65b9\u5f0f\uff0c\u9700\u8981\u5728 __init__.py \u6587\u4ef6\u4e2d\u5bfc\u5165\u5b50\u6a21\u5757/\u5b50\u5305 \u6ce8\u610f\u4f7f\u7528\u76f8\u5bf9/\u7edd\u5bf9\u5bfc\u5165\u65b9\u5f0f\u5bfc\u5165\u5b50\u6a21\u5757","title":"Python Package __init__\u89e3\u6790"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#python package __init__","text":"\u53d1\u5e03\u4e8e\uff1a2018-10-21 | \u5206\u7c7b\uff1a python/vba/cpp \u5355\u4e2aPython\u6587\u4ef6\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a Module \u88ab\u5bfc\u5165\u91cd\u7528\uff0c\u591a\u4e2aModule\u53ef\u4ee5\u7ec4\u7ec7\u4e3a Package \u3002Package\u4e0b\u4e00\u822c\u90fd\u6709\u4e00\u4e2a __init__.py \u6587\u4ef6\uff0c\u800c\u4e14\u5185\u5bb9\u53ef\u80fd\u5565\u4e5f\u6ca1\u6709\u3002\u672c\u7bc7\u5373\u89e3\u91ca\u6b64 __init__.py \u6587\u4ef6\u7684\u4f7f\u7528\u3002","title":"Python Package __init__\u89e3\u6790"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#_1","text":"\u4ee5\u4e0b\u6587\u4ef6\u7ed3\u6784\u4f5c\u4e3a\u672c\u7bc7\u8bd5\u9a8c\u6d4b\u8bd5\u4f9d\u636e\uff1a +-----------------------------+ +---------------------------------+ | + Package | |# Package/Sub_Package/module_a.py| | | | | |x = 1 | | | + Sub_Package | +---------------------------------+ | | | | | | | | + module_a.py | +---------------------------------+ | | | + module_b.py | |# Package/Sub_Package/module_b.py| | | | + __init__.py | |from . import module_a | | | | | |x = module_a.x + 1 | | | + module_c.py | +---------------+-----------------+ | | | | | | + __init__.py | +---------------------+ | + test.py | |# Package/module_c.py| | | |x = 3 | +-----------------------------+ +---------------------+ \u5176\u4e2d\uff0c test.py \u4e3a\u6d4b\u8bd5\u6587\u4ef6\uff0c Package \u4e3a\u5f85\u6d4b\u8bd5\u7684\u5305 Package \u5305\u542b\u6a21\u5757 module_c.py \u548c\u5b50\u5305 Sub_Package \uff0c\u4ee5\u53ca\u8be5\u5305\u7684 __init__.py \u6587\u4ef6 Sub_Package \u5305\u542b\u4e24\u4e2a\u6a21\u5757 module_a.py \u548c module_b.py \uff0c\u4ee5\u53ca\u8be5\u5305\u7684 __init__.py \u6587\u4ef6 Sub_Package \u4e2dmodule_a\u6a21\u5757\u88abmodule_b\u5bfc\u5165\u4f7f\u7528 \u4ee5\u4e0b\u57fa\u4e8e\u4e09\u79cd\u4e0d\u540c\u7684\u5bfc\u5305\u65b9\u5f0f\uff0c\u793a\u4f8b __init__.py \u7684\u4f5c\u7528\u3002","title":"\u6587\u4ef6\u7ed3\u6784"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#from package import module","text":"\u6b64\u4e3a\u7cbe\u786e\u5bfc\u5165\u7684\u5f62\u5f0f\u2014\u2014\u660e\u786e\u6307\u5b9a\u5bfc\u5165\u6a21\u5757\u7684\u540d\u79f0\u3002\u8fd9\u79cd\u60c5\u51b5\u5bf9 __init__.py \u6ca1\u6709\u7279\u6b8a\u8981\u6c42\uff0c\u53ef\u4ee5\u4e3a\u7a7a\u751a\u81f3\u4e0d\u9700\u8981\u8be5\u6587\u4ef6\u3002\u5176\u4f5c\u7528\u4ec5\u4ec5\u662f\u8868\u660e Package \u6587\u4ef6\u5939\u7ba1\u7406\u7684\u662f\u4e00\u4e2a\u5305\u3002 # test.py from Package import module_c print(module_c.x) # 3 # \u5bfc\u5165\u5b50\u5305\u4e2d\u7684\u6a21\u5757 from Package.Sub_Package import module_a print(module_a.x) # 1","title":"from Package import module"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#from package import","text":"\u5982\u679c\u4f9d\u65e7\u4fdd\u6301 __init__.py \u4e3a\u7a7a\uff0c\u5219\u4e0b\u9762\u4ee3\u7801\u65e0\u6cd5\u6b63\u786e\u5bfc\u5165module_c\u6a21\u5757\u3002 # test.py from Package import * print(module_c.x) # name 'module_c' is not defined \u5bf9\u4e8e\u8fd9\u79cd\u6a21\u7cca\u5bfc\u5165\u7684\u65b9\u5f0f\uff0c\u9700\u8981\u5728 __init__.py \u4e2d\u5b9a\u4e49\u53d8\u91cf __all__ \u6765\u6307\u5b9a from Package import * \u65f6\u6240\u5305\u542b\u7684\u5185\u5bb9\u3002\u8865\u5145\u5982\u4e0b\u4ee3\u7801\u540e\uff0c\u5373\u53ef\u4f7f\u7528\u4e0a\u4e00\u6bb5\u4ee3\u7801\u6b63\u786e\u5f15\u5165module_c\u3002 # Package/__init__.py __all__ = ['module_c'] __init__.py \u6587\u4ef6\u4f1a\u5728\u5bfc\u5165\u5305\u7684\u65f6\u5019\u6267\u884c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u5176\u4e2d\u8fdb\u884c\u4e00\u4e9b\u521d\u59cb\u5316\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u521d\u59cb\u5316\u4e00\u4e2a\u53d8\u91cf x \uff1a # Package/__init__.py x = 4 __all__ = ['module_c', 'x'] # test.py from Package import * print(module_c.x) # 3 print(x) # 4","title":"from Package import *"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#import package","text":"\u5b9e\u9645\u4e0a\uff0c import Package \u4e0d\u4f1a\u5bfc\u5165\u4efb\u4f55\u6a21\u5757\u6216\u8005\u5b50\u5305\uff0c\u4ee5\u4e0a\u4f8b\u4e2d\u7684 Package/__init__.py \u4e3a\u5f53\u524d\u72b6\u6001\uff0c\u5219\u6709\uff1a # test.py import Package print(Package.module_c.x) # module 'Package' has no attribute 'module_c' print(Package.x) # 4 \u7531\u4e8e\u672a\u5bfc\u5165\u4efb\u4f55\u6a21\u5757\uff0c\u6545 Package.module_c \u51fa\u9519\uff1b\u7531\u4e8e\u5bfc\u5305\u7684\u65f6\u5019\u6267\u884c\u4e86 __init__.py \uff0c\u5373\u521d\u59cb\u5316\u4e86\u53d8\u91cf x \uff0c\u6545 Package.x \u6b63\u786e\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a\u5229\u7528 __init__.py \u6587\u4ef6\u5728\u5bfc\u5165\u5305\u65f6\u88ab\u6267\u884c\u7684\u7279\u70b9\uff0c\u5728 __init__.py \u4e2d\u663e\u5f0f\u5bfc\u5165\u5b50\u6a21\u5757/\u5b50\u5305 \u3002 \u66f4\u65b0\u540e\u7684\u6587\u4ef6\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5219\u4e0a\u4e00\u6bb5\u4ee3\u7801\u53ef\u4ee5\u6b63\u786e\u6267\u884c\u4e86\u3002 # Package/__init__.py from . import module_c # \u663e\u5f0f\u5bfc\u5165\u5b50\u6a21\u5757 from . import Sub_Package # \u663e\u5f0f\u5bfc\u5165\u5b50\u5305 x = 4 __all__ = ['module_c', 'x'] \u4ee5\u4e0a\u4ee3\u7801\u5757\u4e2d from . import Sub_Package \u5bfc\u5165\u5b50\u5305\uff0c\u4f7f\u5f97\u53ef\u4ee5\u8bc6\u522b Package.Sub_Package \uff1b\u4e3a\u4e86\u6210\u529f\u5bfc\u5165 Sub_Package \u4e0b\u7684\u6a21\u5757\uff0c\u540c\u7406\u9700\u8981\u5728 Sub_Package/__init__.py \u4e2d\u663e\u5f0f\u5bfc\u5165\u76f8\u5e94\u5b50\u6a21\u5757\u3002 # Package/Sub_Package/__init__.py from . import module_a from . import module_b \u4e8e\u662f\uff0c\u5bf9\u5b50\u5305\u4e2d\u7684\u6a21\u5757\u7684\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff1a # test.py import Package print(Package.Sub_Package.module_b.x) # 2","title":"import Package"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#_2","text":"\u5b50\u5305\u4e2d\u540c\u7ea7\u6a21\u5757\u7684\u5bfc\u5165\uff0c\u4f8b\u5982 Sub_Package \u4e0b module_b \u5bfc\u5165 module_a \uff0c\u53ef\u80fd\u6709\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\uff1a import module_a # Package/Sub_Package/module_b.py import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # 2 # test.py import Package print(Package.Sub_Package.module_b.x) # No module named 'module_a' \u5b50\u6a21\u5757\u8c03\u7528\u65f6\u5165\u53e3 module_b \u53ef\u4ee5\u6b63\u786e\u627e\u5230\u540c\u7ea7\u7684 module_a \uff0c\u800c test.py \u4e2d\u5165\u53e3\u5728 Package \uff0c\u6545\u65e0\u6cd5\u6b63\u786e\u627e\u5230 module_a \u3002 from . import module_a \u8fd9\u662f\u76f8\u5bf9\u5bfc\u5165\u65b9\u5f0f\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u7136\u800c\uff0c\u5b50\u6a21\u5757\u5185\u8fd0\u884c\u5374\u51fa\u9519\u3002\u8fd9\u662f\u56e0\u4e3a**\u76f8\u5bf9\u5bfc\u5165\u65b9\u5f0f\u4ec5\u80fd\u5e94\u7528\u4e8e\u5305**\uff0c\u800cPython\u89e3\u91ca\u5668\u8bc6\u522b\u5305\u7684\u7684\u4e24\u4e2a\u6761\u4ef6\uff1a - \u6587\u4ef6\u5939\u4e2d\u5fc5\u987b\u6709 __init__.py \u6587\u4ef6 - \u4e0d\u80fd\u4f5c\u4e3a\u9876\u5c42\u6a21\u5757\u6765\u6267\u884c\u8be5\u6587\u4ef6\u5939\u4e2d\u7684py\u6587\u4ef6\uff08\u5373\u4e0d\u80fd\u4f5c\u4e3a\u4e3b\u51fd\u6570\u7684\u5165\u53e3\uff09 \u663e\u7136\uff0c\u76f4\u63a5\u8fd0\u884c\u5b50\u6a21\u5757 module_b.py \u8fdd\u80cc\u4e86\u6761\u4ef6\u4e8c\u3002 # Package/Sub_Package/module_b.py from . import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # cannot import name 'module_a' # test.py import Package print(Package.Sub_Package.module_b.x) # 2 from Package.Sub_Package import module_a \u8fd9\u662f\u7edd\u5bf9\u5bfc\u5165\u65b9\u5f0f\u3002\u5f53\u5165\u53e3\u662f Package \u5305\u65f6\uff0c\u81ea\u7136\u53ef\u4ee5\u6b63\u786e\u8bc6\u522b Package.Sub_Package \u3002\u800c\u76f4\u63a5\u8fd0\u884c\u5b50\u6a21\u5757\u65f6\uff0c\u663e\u7136\u65e0\u6cd5\u8bc6\u522b\u4e86\u3002 # Package/Sub_Package/module_b.py from Package.Sub_Package import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # No module named 'Package' # test.py import Package print(Package.Sub_Package.module_b.x) # 2 \u5f53\u7136\u4e5f\u6709\u65b9\u6cd5\u4f7f\u5b50\u6a21\u5757\u6b63\u5e38\u8fd0\u884c\u2014\u2014\u5c06 Package \u6240\u5728\u76ee\u5f55\u52a0\u5165\u7cfb\u7edf\u641c\u7d22\u76ee\u5f55\u5373\u53ef\u3002\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u5904\u7406\u5374\u4e0d\u662f\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a module_b \u6700\u7ec8\u76ee\u7684\u662f\u4e3aPackage\u6240\u8c03\u7528\uff0c\u5e76\u4e0d\u9700\u8981\u76f4\u63a5\u8fd0\u884c\u5b83\u3002\u56e0\u6b64\u4ee5\u4e0a\u7684\u7edd\u5bf9\u6216\u8005\u76f8\u5bf9\u8c03\u7528\u65b9\u5f0f\u8db3\u4ee5\u6ee1\u8db3\u9700\u6c42\uff1b\u5e76\u4e14\uff0c\u76f8\u5bf9\u8c03\u7528\u65b9\u5f0f\u7684\u901a\u7528\u6027\u66f4\u597d\uff0c\u56e0\u4e3a\u5b83\u4e0d\u53d7Package\u7684\u540d\u79f0\u6240\u5f71\u54cd\u3002 # Package/Sub_Package/module_b.py import os import sys script_path = os.path.abspath(__file__) # \u5f53\u524dmodule\u7edd\u5bf9\u8def\u5f84 package_path = os.path.dirname(os.path.dirname(os.path.dirname(script_path))) # \u4e0a\u4e09\u7ea7\u8def\u5f84\uff0c\u5373Package\u7684\u7236\u76ee\u5f55 sys.path.append(package_path) # \u52a0\u5165\u9ed8\u8ba4\u641c\u7d22\u8def\u5f84\u5217\u8868 from Package.Sub_Package import module_a x = module_a.x + 1 if __name__ == '__main__': print(x) # 2","title":"\u5b50\u5305\u4e2d\u7684\u5bfc\u5165\u95ee\u9898"},{"location":"2018-10-21-Python-Package-__init__%E8%A7%A3%E6%9E%90/#_3","text":"__init__.py \u8868\u660e\u6240\u5728\u6587\u4ef6\u5939\u4e3aPackage\uff0c\u5e76\u4e14\u5728import\u8be5Package\u65f6\u4f1a\u88ab\u6267\u884c __init__.py \u4e2d\u5b9a\u4e49 __all__ \u6307\u660e\u6a21\u7cca\u5bfc\u5165\u7684\u6a21\u5757\u6216\u53d8\u91cf \u9488\u5bf9 import package \u7684\u5bfc\u5165\u65b9\u5f0f\uff0c\u9700\u8981\u5728 __init__.py \u6587\u4ef6\u4e2d\u5bfc\u5165\u5b50\u6a21\u5757/\u5b50\u5305 \u6ce8\u610f\u4f7f\u7528\u76f8\u5bf9/\u7edd\u5bf9\u5bfc\u5165\u65b9\u5f0f\u5bfc\u5165\u5b50\u6a21\u5757","title":"\u603b\u7ed3"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/","text":"\u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-10-21 | \u5206\u7c7b\uff1a numeric calculation \u9057\u4f20\u7b97\u6cd5\uff08Genetic Algorithm\uff09\u662f\u7f8e\u56fdJ.Holland\u6559\u6388\u4e8e1975\u5e74\u9996\u5148\u63d0\u51fa\u7684\u501f\u9274\u751f\u7269\u8fdb\u5316\u89c4\u5f8b\uff08\u9002\u8005\u751f\u5b58\uff0c\u4f18\u80dc\u52a3\u6c70\u9057\u4f20\u673a\u5236\uff09\u6f14\u5316\u800c\u6765\u7684\u968f\u673a\u5316\u641c\u7d22\u65b9\u6cd5\uff0c\u76ee\u524d\u5df2\u88ab\u5e7f\u6cdb\u5730\u5e94\u7528\u4e8e\u7ec4\u5408\u4f18\u5316\u3001\u673a\u5668\u5b66\u4e60\u3001\u4fe1\u53f7\u5904\u7406\u3001\u81ea\u9002\u5e94\u63a7\u5236\u548c\u4eba\u5de5\u751f\u547d\u7b49\u9886\u57df\u3002\u672c\u6587\u5c06\u6839\u636e\u5176\u57fa\u672c\u539f\u7406\uff0c\u57fa\u4e8ePython\u7684 Numpy \u6a21\u5757\u5b9e\u73b0\u91c7\u7528\u6d6e\u70b9\u6570\u7f16\u7801\u7684\u9057\u4f20\u7b97\u6cd5\uff0c\u7528\u4e8e\u6c42\u89e3\u5355\u76ee\u6807\u4f18\u5316\u95ee\u9898\u3002 \u57fa\u672c\u539f\u7406 \u00b6 \u7ecf\u5178\u9057\u4f20\u7b97\u6cd5\u57fa\u672c\u8fc7\u7a0b\uff1a \u751f\u6210\u521d\u59cb\u79cd\u7fa4 \u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02\u64cd\u4f5c\u751f\u6210\u4e0b\u4e00\u4ee3\u79cd\u7fa4 \u91cd\u590d\u6d41\u7a0b \u5176\u4e2d\u4e00\u4e9b\u5173\u952e\u672f\u8bed\u5982\u4e0b\uff1a \u79cd\u7fa4\uff08Population\uff09 \u53c2\u4e0e\u6f14\u5316\u7684\u751f\u7269\u7fa4\u4f53\uff0c\u5373\u89e3\u7684\u641c\u7d22\u7a7a\u95f4 \u4e2a\u4f53\uff08Individual\uff09 \u79cd\u7fa4\u7684\u6bcf\u4e00\u4e2a\u6210\u5458\uff0c\u5bf9\u5e94\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u89e3 \u67d3\u8272\u4f53\uff08Chromosome\uff09 \u5bf9\u5e94\u95ee\u9898\u7684\u89e3\u5411\u91cf \u57fa\u56e0\uff08Gene\uff09 \u89e3\u5411\u91cf\u7684\u4e00\u4e2a\u5206\u91cf\uff0c\u6216\u8005\u7f16\u7801\u540e\u7684\u89e3\u5411\u91cf\u7684\u4e00\u4f4d \u9002\u5e94\u5ea6\uff08Fitness\uff09 \u4f53\u73b0\u4e2a\u4f53\u7684\u751f\u5b58\u80fd\u529b\uff0c\u4e0e\u76ee\u6807\u51fd\u6570\u76f8\u5173\u7684\u51fd\u6570 \u9057\u4f20\u7b97\u5b50\uff08Operator\uff09 \u4e2a\u4f53\u7684\u6f14\u5316\u64cd\u4f5c\uff0c\u5305\u62ec\u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02 \u9009\u62e9(Selection) \u57fa\u4e8e\u9002\u5e94\u5ea6\u7684\u4f18\u80dc\u52a3\u6c70\uff0c\u4ee5\u4e00\u5b9a\u7684\u6982\u7387\u4ece\u79cd\u7fa4\u4e2d\u9009\u62e9\u82e5\u5e72\u4e2a\u4f53 \u4ea4\u53c9(Crossover) \u4e24\u4e2a\u67d3\u8272\u4f53\u8fdb\u884c\u57fa\u56e0\u91cd\u7ec4 \u53d8\u5f02(Mutation) \uff1a\u5355\u4e2a\u67d3\u8272\u4f53\u7684\u57fa\u56e0\u4ee5\u8f83\u4f4e\u6982\u7387\u53d1\u751f\u968f\u673a\u53d8\u5316 \u521d\u59cb\u79cd\u7fa4\u4ea7\u751f\u4e86\u4e00\u7cfb\u5217\u968f\u673a\u89e3\uff0c\u9009\u62e9\u64cd\u4f5c\u4fdd\u8bc1\u4e86\u641c\u7d22\u7684\u65b9\u5411\u6027\uff0c\u4ea4\u53c9\u548c\u53d8\u5f02\u62d3\u5bbd\u4e86\u641c\u7d22\u7a7a\u95f4\uff0c\u5176\u4e2d\u4ea4\u53c9\u64cd\u4f5c\u5ef6\u7eed\u7236\u8f88\u4e2a\u4f53\u7684\u4f18\u826f\u57fa\u56e0\uff0c\u53d8\u5f02\u64cd\u4f5c\u5219\u53ef\u80fd\u4ea7\u751f\u6bd4\u5f53\u524d\u4f18\u52bf\u57fa\u56e0\u66f4\u4f18\u79c0\u7684\u4e2a\u4f53\u3002\u53d8\u5f02\u64cd\u4f5c\u6709\u5229\u4e8e\u8df3\u51fa\u5c40\u90e8\u6700\u4f18\u89e3\uff0c\u540c\u65f6\u589e\u52a0\u4e86\u968f\u673a\u641c\u7d22\u7684\u6982\u7387\uff0c\u5373\u5bb9\u6613\u53d1\u6563\u3002 \u9057\u4f20\u7b97\u6cd5\u9700\u8981\u5728\u8fc7\u65e9\u6536\u655b\uff08\u65e9\u719f\uff09\u548c\u53d1\u6563\u3001\u7cbe\u5ea6\u548c\u6548\u7387\u4e4b\u95f4\u5e73\u8861\u3002\u5f53\u7269\u79cd\u591a\u6837\u6027\u8fc5\u901f\u964d\u4f4e\u5373\u4e2a\u4f53\u8d8b\u4e8e\u4e00\u81f4\uff0c\u4f8b\u5982\u9009\u62e9\u64cd\u4f5c\u65f6\u8fc7\u5206\u7a81\u51fa\u4f18\u52bf\u57fa\u56e0\u7684\u5730\u4f4d\uff0c\u7ed3\u679c\u53ef\u80fd\u53ea\u662f\u6536\u655b\u4e8e\u5c40\u90e8\u6700\u4f18\u89e3\u3002\u5f53\u7269\u79cd\u6301\u7eed\u4fdd\u6301\u591a\u6837\u6027\uff0c\u4f8b\u5982\u9009\u62e9\u529b\u5ea6\u4e0d\u5927\u3001\u53d8\u5f02\u6982\u7387\u592a\u5927\uff0c\u7ed3\u679c\u53ef\u80fd\u5f88\u96be\u6536\u655b\uff0c\u5373\u7b97\u6cd5\u6548\u7387\u8f83\u4f4e\u3002 \u7a0b\u5e8f\u8bbe\u8ba1 \u00b6 \u8003\u8651\u7a0b\u5e8f\u7684\u901a\u7528\u6027\uff0c\u51cf\u5c11\u6a21\u5757\u4e4b\u95f4\u7684\u8026\u5408\uff0c \u79cd\u7fa4 \u3001 \u9057\u4f20\u7b97\u5b50 \u5c06\u88ab\u8bbe\u8ba1\u4e3a\u57fa\u672c\u7c7b\uff0c\u6700\u540e\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 \u9057\u4f20\u7b97\u6cd5\u7c7b \u3002\u53c2\u8003\u4f2a\u4ee3\u7801\uff1a # \u57fa\u4e8e\u4e2a\u4f53\u751f\u6210\u79cd\u7fa4 I = Individual() P = Population(I, 50) # \u9057\u4f20\u7b97\u5b50 S = Selection() C = Crossover() M = Mutation() # \u7efc\u5408\u79cd\u7fa4\u548c\u9057\u4f20\u7b97\u5b50\u8fdb\u5165\u9057\u4f20\u7b97\u6cd5\u6807\u51c6\u6d41\u7a0b G = GA(P, S, C, M) res = G.run() \u9057\u4f20\u7b97\u6cd5\u57fa\u672c\u6d41\u7a0b\u76f8\u5bf9\u56fa\u5b9a\uff0c\u56e0\u6b64\u4ee5\u4e0a\u7ed3\u6784\u6709\u5229\u4e8e\uff1a \u5f53\u9700\u8981\u6539\u8fdb\u9057\u4f20\u7b97\u5b50\u7b56\u7565\u65f6\uff0c\u53ef\u4ee5\u4ece\u57fa\u672c\u7b97\u5b50\u7c7b\u6d3e\u751f\u5b50\u7c7b\u800c\u4e0d\u5fc5\u6539\u52a8\u5176\u4ed6\u90e8\u5206 \u5f53\u9700\u8981\u5e94\u7528\u4e8e\u4e0d\u540c\u95ee\u9898\u65f6\uff0c\u53ef\u4ee5\u4ece\u4e2a\u4f53\u57fa\u7c7b\u6d3e\u751f\u76f8\u5e94\u7684\u5b50\u7c7b\uff08\u6ee1\u8db3\u7f16\u7801\u7684\u9700\u8981\uff09 1 \u79cd\u7fa4 \u00b6 \u76ee\u524d\u4ec5\u8003\u8651\u6d6e\u70b9\u6570\u7f16\u7801\uff0c\u56e0\u6b64\u7701\u53bb\u4e86\u7f16\u7801/\u89e3\u7801\u8fc7\u7a0b\u2014\u2014\u6574\u4e2a\u67d3\u8272\u4f53\u5c31\u662f\u89e3\u5411\u91cf\uff0c\u6bcf\u4e2a\u57fa\u56e0\u662f\u5176\u4e2d\u4e00\u4e2a\u5206\u91cf\u3002 Individual \u7c7b\u8868\u5f81\u4e2a\u4f53\uff0c\u91cd\u8981\u7684\u5c5e\u6027\u4e3a\uff1a solution \u89e3\u5411\u91cf evaluation \u76ee\u6807\u51fd\u6570\u503c fitness \u9002\u5e94\u5ea6\u503c Population \u7c7b\u8868\u5f81\u7fa4\u4f53\uff0c\u6839\u636e\u4e2a\u4f53\u5b9e\u4f8b\u751f\u6210\u6307\u5b9a\u5927\u5c0f\u7684\u79cd\u7fa4\uff0c\u5176\u4e2d\uff1a individuals \u6240\u6709\u4e2a\u4f53\u5217\u8868\uff0c Numpy \u7684 ndarray \u7c7b\u578b best \u6700\u4f18\u4e2a\u4f53 #---------------------------------------------------------- # GAComponents.py: Individual, Population #---------------------------------------------------------- import numpy as np class Individual: '''individual of population''' def __init__(self, ranges): ''' ranges: element range of solution, e.g. [(lb1, ub1), (lb2, ub2), ...] validation of ranges is skipped... ''' self.ranges = np.array(ranges) self.dimension = self.ranges.shape[0] # initialize solution within [lb, ub] seeds = np.random.random(self.dimension) lb = self.ranges[:, 0] ub = self.ranges[:, 1] self._solution = lb + (ub-lb)*seeds # evaluation and fitness self.evaluation = None self.fitness = None @property def solution(self): return self._solution @solution.setter def solution(self, solution): assert self.dimension == solution.shape[0] assert (solution>=self.ranges[:, 0]).all() and (solution<=self.ranges[:, 1]).all() self._solution = solution class Population: '''collection of individuals''' def __init__(self, individual, size=50): ''' individual : individual template size : count of individuals ''' self.individual = individual self.size = size self.individuals = None def initialize(self): '''initialization for next generation''' IndvClass = self.individual.__class__ self.individuals = np.array([IndvClass(self.individual.ranges) for i in range(self.size)], dtype=IndvClass) def best(self, fun_evaluation, fun_fitness=None): '''get best individual according to evaluation value ''' # evaluate first and collect evaluations _, evaluation = self.fitness(fun_evaluation, fun_fitness) # get the minimum position pos = np.argmin(evaluation) return self.individuals[pos] def fitness(self, fun_evaluation, fun_fitness=None): ''' calculate objectibe value and fitness for each individual. fun_evaluation : objective function fun_fitness : population fitness based on evaluation ''' # fitness is same as evaluation by default if not fun_fitness: fun_fitness = lambda x: x # get the value directly if it has been calculated before evaluation = np.array([fun_evaluation(I.solution) if I.evaluation is None else I.evaluation for I in self.individuals]) # calculate fitness fitness = fun_fitness(evaluation) fitness = fitness/np.sum(fitness) # normalize # set attributes for each individual for I, e, f in zip(self.individuals, evaluation, fitness): I.evaluation = e I.fitness = f return fitness, evaluation if __name__ == '__main__': ranges = [(-10,10)] * 3 obj = lambda x: x[0]+x[1]**2+x[2]**3 I = Individual(ranges) P = Population(I, 100) P.initialize() print(P.best(obj).solution) 2 \u9057\u4f20\u7b97\u5b50 \u00b6 2.1 \u9009\u62e9 \u91c7\u7528\u6807\u51c6\u7684 \u8f6e\u76d8\u8d4c\uff08RouletteWheel\uff09 \u65b9\u5f0f\uff0c\u4ee5\u79cd\u7fa4\u4e2d\u4e2a\u4f53\u7684\u9002\u5e94\u5ea6\u4e3a\u53c2\u8003\uff0c\u4ece\u4e2d\u9009\u62e9\u51fa\u540c\u6837\u5927\u5c0f\u7684\u65b0\u7684\u79cd\u7fa4\u4e2a\u4f53\u3002\u4ece\u4e0a\u4e00\u8282\u79cd\u7fa4\u9002\u5e94\u5ea6\u7684\u8ba1\u7b97\u53ef\u77e5\uff0c\u4e2a\u4f53\u7684\u9002\u5e94\u5ea6\u5df2\u7ecf\u88ab\u5f52\u4e00\u5316\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4f5c\u4e3a\u8f6e\u76d8\u8d4c\u7684\u6982\u7387\u53c2\u8003\u3002 #---------------------------------------------------------- # GAOperators.py: Selection, Crossover, Mmutation #---------------------------------------------------------- import numpy as np import copy from GAComponents import Individual #---------------------------------------------------------- # SELECTION #---------------------------------------------------------- class Selection: '''base class for selection''' def select(self, population, fitness): raise NotImplementedError class RouletteWheelSelection(Selection): ''' select individuals by Roulette Wheel: individuals selected with a probability of its fitness ''' def select(self, population, fitness): selected_individuals = np.random.choice(population.individuals, population.size, p=fitness) # pay attention to deep copy these objects population.individuals = np.array([copy.deepcopy(I) for I in selected_individuals]) 2.2 \u4ea4\u53c9 \u4ece\u9009\u62e9\u540e\u7684\u6837\u672c\u4e2d\u968f\u673a\u9009\u62e9\u4e24\u4e2a\u4e2a\u4f53 a \u548c b \uff0c\u4ee5\u4e00\u5b9a\u7684\u6982\u7387\u8fdb\u884c\u4ea4\u53c9\u64cd\u4f5c\uff1a\u5c06\u968f\u673a\u4f4d\u7f6e\u7684\u5bf9\u5e94\u57fa\u56e0\uff08\u4f8b\u5982 g_a g_a \uff0c g_b g_b \uff09\u6309\u7cfb\u6570 \\alpha \\alpha \u8fdb\u884c\u7ebf\u6027\u63d2\u503c\uff0c\u5176\u4f59\u4f4d\u7f6e\u4fdd\u6301\u4e0d\u53d8\uff0c\u4ece\u800c\u5f97\u5230\u4e24\u4e2a\u65b0\u7684\u4e2a\u4f53 a' \u548c b' \u3002 \u5bf9\u4e8e\u4ea4\u53c9\u4f4d\u7f6e\u7684\u57fa\u56e0\uff1a \\begin{align*} g_a' &= g_a + (g_b-g_a)(1-\\alpha)\\\\\\ g_b' &= g_b - (g_b-g_a)(1-\\alpha) \\end{align*} \u5bf9\u4e8e\u975e\u4ea4\u53c9\u4f4d\u7f6e\u7684\u57fa\u56e0\uff1a \\begin{align*} g_a' &= g_a\\\\\\ g_b' &= g_b \\end{align*} \u7efc\u5408\u8d77\u6765\uff0c\u4e2a\u4f53 a \u548c b \u6240\u6709\u4f4d\u7f6e\u7684\u57fa\u56e0\u4ea4\u53c9\u64cd\u4f5c\u53ef\u4ee5\u5199\u6210\u5411\u91cf\u5f62\u5f0f\uff1a \\begin{align*} a' &= a + (b-a)(1-\\alpha)\\beta\\\\\\ b' &= b - (b-a)(1-\\alpha)\\beta \\end{align*} \u5176\u4e2d\uff0c \\beta \\beta \u8868\u793a\u662f\u5426\u8fdb\u884c\u4ea4\u53c9\u7684 0-1 \u5411\u91cf\u3002 # ......\u63a5\u4e0a\u4e00\u6bb5\u4ee3\u7801 #---------------------------------------------------------- # CROSSOVER #---------------------------------------------------------- class Crossover: def __init__(self, rate=0.8, alpha=0.5): ''' crossover operation: rate: propability of crossover. alpha: factor for crossing two chroms, [0,1] ''' # parameters check is skipped self.rate = rate self.alpha = alpha @staticmethod def cross_individuals(individual_a, individual_b, alpha): ''' generate two child individuals based on parent individuals: new values are calculated at random positions alpha: linear ratio to cross two genes, exchange two genes if alpha is 0.0 ''' # random positions to be crossed pos = np.random.rand(individual_a.dimension) <= 0.5 # cross value temp = (individual_b.solution-individual_a.solution)*pos*(1-alpha) new_value_a = individual_a.solution + temp new_value_b = individual_b.solution - temp # return new individuals new_individual_a = Individual(individual_a.ranges) new_individual_b = Individual(individual_b.ranges) new_individual_a.solution = new_value_a new_individual_b.solution = new_value_b return new_individual_a, new_individual_b def cross(self, population): new_individuals = [] random_population = np.random.permutation(population.individuals) # random order num = int(population.size/2.0)+1 for individual_a, individual_b in zip(population.individuals[0:num+1], random_population[0:num+1]): # crossover if np.random.rand() <= self.rate: child_individuals = self.cross_individuals(individual_a, individual_b, self.alpha) new_individuals.extend(child_individuals) else: new_individuals.append(individual_a) new_individuals.append(individual_b) population.individuals = np.array(new_individuals[0:population.size+1]) 2.3 \u53d8\u5f02 \u6d6e\u70b9\u6570\u7f16\u7801\u4e2a\u4f53\u7684\u53d8\u5f02\u64cd\u4f5c\u4e3a\u5c06\u968f\u5373\u4f4d\u7f6e\u7684\u57fa\u56e0 g \u589e\u52a0\u6216\u51cf\u5c11\u4e00\u4e2a\u968f\u673a\u503c\u3002\u8fd9\u4e2a\u968f\u673a\u503c\u7531\u5141\u8bb8\u53d8\u5316\u533a\u95f4\u4e58\u4ee5\u4e00\u4e2a[0,1]\u533a\u95f4\u7684\u968f\u673a\u6570 \\alpha \\alpha \u6765\u786e\u5b9a\u3002\u4f8b\u5982\u57fa\u56e0 g \u7684\u533a\u95f4\u4e3a [L,U] \uff0c\u5219\u53d8\u5f02\u540e\u7684\u57fa\u56e0 g' \uff1a \\begin{align*} g &= g - (g-L)\\alpha\\,\\,\\,(rand() \\leq 0.5)\\\\\\ g &= g + (U-g)\\alpha\\,\\,\\,(rand() > 0.5) \\end{align*} # ......\u63a5\u4e0a\u4e00\u6bb5\u4ee3\u7801 #---------------------------------------------------------- # MUTATION #---------------------------------------------------------- class Mutation: def __init__(self, rate): ''' mutation operation: rate: propability of mutation, [0,1] ''' self.rate = rate def mutate_individual(self, individual, positions, alpha): ''' positions: mutating gene positions, list alpha: mutatation magnitude ''' for pos in positions: if np.random.rand() < 0.5: individual.solution[pos] -= (individual.solution[pos]-individual.ranges[:,0][pos])*alpha else: individual.solution[pos] += (individual.ranges[:,1][pos]-individual.solution[pos])*alpha # reset evaluation individual.evaluation = None individual.fitness = None def mutate(self, population, alpha): ''' alpha: mutating magnitude ''' for individual in population.individuals: if np.random.rand() > self.rate: continue # select random positions to mutate num = np.random.randint(individual.dimension) + 1 pos = np.random.choice(individual.dimension, num, replace=False) self.mutate_individual(individual, pos, alpha) 3 \u9057\u4f20\u7b97\u6cd5 \u00b6 \u672c\u6b21\u5b9e\u73b0\u7684\u9057\u4f20\u7b97\u6cd5\u9ed8\u8ba4\u6c42\u6700\u5c0f\u503c\uff0c\u56e0\u6b64\u9002\u5e94\u5ea6\u51fd\u6570\u5e94\u4e3a\u76ee\u6807\u51fd\u6570\u503c\u7684\u53cd\u51fd\u6570\u3002\u5e76\u4e14\u8003\u8651\u5230\u5b83\u5c06\u4f5c\u4e3a\u9009\u62e9\u6982\u7387\uff0c\u5373\u51fd\u6570\u503c\u5e94\u975e\u8d1f\u3002\u4e8e\u662f\uff0c\u6b64\u5904\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff1a f(x) = \\arctan(-x) + \\pi f(x) = \\arctan(-x) + \\pi #---------------------------------------------------------- # GA.py: Simple Genetic Algorithm #---------------------------------------------------------- import numpy as np class GA(): '''Simple Genetic Algorithm''' def __init__(self, population, selection, crossover, mutation, fun_fitness=lambda x:np.arctan(-x)+np.pi): ''' fun_fitness: fitness based on objective values. minimize the objective by default ''' self.population = population self.selection = selection self.crossover = crossover self.mutation = mutation self.fun_fitness = fun_fitness def run(self, fun_evaluation, gen=50): ''' solve the problem based on Simple GA process ''' # initialize population self.population.initialize() # solving process for n in range(1, gen+1): # select fitness, _ = self.population.fitness(fun_evaluation, self.fun_fitness) self.selection.select(self.population, fitness) # crossover self.crossover.cross(self.population) # mutation self.mutation.mutate(self.population, np.random.rand()) # return the best individual return self.population.best(fun_evaluation, self.fun_fitness) \u6d4b\u8bd5 \u00b6 \u91c7\u7528\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u8fdb\u884c\u6d4b\u8bd5\uff0c\u6700\u5c0f\u503c\u70b9 f(0,1.25313)=0.292579 f(0,1.25313)=0.292579 \u3002 f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) #---------------------------------------------------------- # test.py #---------------------------------------------------------- from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation # schaffer-N4 # sol: x=[0,1.25313], min=0.292579 schaffer_n4 = lambda x: 0.5 + (np.cos(np.sin(abs(x[0]**2-x[1]**2)))**2-0.5) / (1.0+0.001*(x[0]**2+x[1]**2))**2 I = Individual([(-10,10)]*2) P = Population(I, 50) S = RouletteWheelSelection() C = Crossover(0.9, 0.75) M = Mutation(0.2) g = GA(P, S, C, M) res = [] for i in range(10): res.append(g.run(schaffer_n4, 500).evaluation) val = schaffer_n4([0,1.25313]) val_ga = sum(res)/len(res) print('the minimum: {0}'.format(val)) print('the GA minimum: {0}'.format(val_ga)) print('error: {:<3f} %'.format((val_ga/val-1.0)*100)) #---------------------------------------------------------- # output: #---------------------------------------------------------- the minimum: 0.29257863204552975 the GA minimum: 0.30069849785520314 error: 2.7752764283927034 % \u8fd0\u884c10\u6b21\u7684\u5e73\u5747\u8bef\u5dee\u5728 3% \u5de6\u53f3\uff0c\u8fd8\u6709\u5f88\u5927\u7684\u6539\u8fdb\u7a7a\u95f4\uff0c\u8fd9\u5c06\u5728\u540e\u7eed\u7bc7\u7ae0\u4e2d\u5b8c\u6210\u3002 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565 \u53c2\u8003\u8d44\u6599 \u00b6 \u9057\u4f20\u7b97\u6cd5GA(Genetic Algorithm)\u5165\u95e8\u77e5\u8bc6\u68b3\u7406 \u9057\u4f20\u7b97\u6cd5\u8be6\u89e3\uff08GA\uff09 \u7b97\u6cd5\u7406\u89e3-\u9057\u4f20\u7b97\u6cd5\uff08Genetic Algorithm\uff09 \u9057\u4f20\u7b97\u6cd5\u4e2d\u51e0\u79cd\u4e0d\u540c\u9009\u62e9\u7b97\u5b50","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#python","text":"\u53d1\u5e03\u4e8e\uff1a2018-10-21 | \u5206\u7c7b\uff1a numeric calculation \u9057\u4f20\u7b97\u6cd5\uff08Genetic Algorithm\uff09\u662f\u7f8e\u56fdJ.Holland\u6559\u6388\u4e8e1975\u5e74\u9996\u5148\u63d0\u51fa\u7684\u501f\u9274\u751f\u7269\u8fdb\u5316\u89c4\u5f8b\uff08\u9002\u8005\u751f\u5b58\uff0c\u4f18\u80dc\u52a3\u6c70\u9057\u4f20\u673a\u5236\uff09\u6f14\u5316\u800c\u6765\u7684\u968f\u673a\u5316\u641c\u7d22\u65b9\u6cd5\uff0c\u76ee\u524d\u5df2\u88ab\u5e7f\u6cdb\u5730\u5e94\u7528\u4e8e\u7ec4\u5408\u4f18\u5316\u3001\u673a\u5668\u5b66\u4e60\u3001\u4fe1\u53f7\u5904\u7406\u3001\u81ea\u9002\u5e94\u63a7\u5236\u548c\u4eba\u5de5\u751f\u547d\u7b49\u9886\u57df\u3002\u672c\u6587\u5c06\u6839\u636e\u5176\u57fa\u672c\u539f\u7406\uff0c\u57fa\u4e8ePython\u7684 Numpy \u6a21\u5757\u5b9e\u73b0\u91c7\u7528\u6d6e\u70b9\u6570\u7f16\u7801\u7684\u9057\u4f20\u7b97\u6cd5\uff0c\u7528\u4e8e\u6c42\u89e3\u5355\u76ee\u6807\u4f18\u5316\u95ee\u9898\u3002","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#_1","text":"\u7ecf\u5178\u9057\u4f20\u7b97\u6cd5\u57fa\u672c\u8fc7\u7a0b\uff1a \u751f\u6210\u521d\u59cb\u79cd\u7fa4 \u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02\u64cd\u4f5c\u751f\u6210\u4e0b\u4e00\u4ee3\u79cd\u7fa4 \u91cd\u590d\u6d41\u7a0b \u5176\u4e2d\u4e00\u4e9b\u5173\u952e\u672f\u8bed\u5982\u4e0b\uff1a \u79cd\u7fa4\uff08Population\uff09 \u53c2\u4e0e\u6f14\u5316\u7684\u751f\u7269\u7fa4\u4f53\uff0c\u5373\u89e3\u7684\u641c\u7d22\u7a7a\u95f4 \u4e2a\u4f53\uff08Individual\uff09 \u79cd\u7fa4\u7684\u6bcf\u4e00\u4e2a\u6210\u5458\uff0c\u5bf9\u5e94\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u89e3 \u67d3\u8272\u4f53\uff08Chromosome\uff09 \u5bf9\u5e94\u95ee\u9898\u7684\u89e3\u5411\u91cf \u57fa\u56e0\uff08Gene\uff09 \u89e3\u5411\u91cf\u7684\u4e00\u4e2a\u5206\u91cf\uff0c\u6216\u8005\u7f16\u7801\u540e\u7684\u89e3\u5411\u91cf\u7684\u4e00\u4f4d \u9002\u5e94\u5ea6\uff08Fitness\uff09 \u4f53\u73b0\u4e2a\u4f53\u7684\u751f\u5b58\u80fd\u529b\uff0c\u4e0e\u76ee\u6807\u51fd\u6570\u76f8\u5173\u7684\u51fd\u6570 \u9057\u4f20\u7b97\u5b50\uff08Operator\uff09 \u4e2a\u4f53\u7684\u6f14\u5316\u64cd\u4f5c\uff0c\u5305\u62ec\u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02 \u9009\u62e9(Selection) \u57fa\u4e8e\u9002\u5e94\u5ea6\u7684\u4f18\u80dc\u52a3\u6c70\uff0c\u4ee5\u4e00\u5b9a\u7684\u6982\u7387\u4ece\u79cd\u7fa4\u4e2d\u9009\u62e9\u82e5\u5e72\u4e2a\u4f53 \u4ea4\u53c9(Crossover) \u4e24\u4e2a\u67d3\u8272\u4f53\u8fdb\u884c\u57fa\u56e0\u91cd\u7ec4 \u53d8\u5f02(Mutation) \uff1a\u5355\u4e2a\u67d3\u8272\u4f53\u7684\u57fa\u56e0\u4ee5\u8f83\u4f4e\u6982\u7387\u53d1\u751f\u968f\u673a\u53d8\u5316 \u521d\u59cb\u79cd\u7fa4\u4ea7\u751f\u4e86\u4e00\u7cfb\u5217\u968f\u673a\u89e3\uff0c\u9009\u62e9\u64cd\u4f5c\u4fdd\u8bc1\u4e86\u641c\u7d22\u7684\u65b9\u5411\u6027\uff0c\u4ea4\u53c9\u548c\u53d8\u5f02\u62d3\u5bbd\u4e86\u641c\u7d22\u7a7a\u95f4\uff0c\u5176\u4e2d\u4ea4\u53c9\u64cd\u4f5c\u5ef6\u7eed\u7236\u8f88\u4e2a\u4f53\u7684\u4f18\u826f\u57fa\u56e0\uff0c\u53d8\u5f02\u64cd\u4f5c\u5219\u53ef\u80fd\u4ea7\u751f\u6bd4\u5f53\u524d\u4f18\u52bf\u57fa\u56e0\u66f4\u4f18\u79c0\u7684\u4e2a\u4f53\u3002\u53d8\u5f02\u64cd\u4f5c\u6709\u5229\u4e8e\u8df3\u51fa\u5c40\u90e8\u6700\u4f18\u89e3\uff0c\u540c\u65f6\u589e\u52a0\u4e86\u968f\u673a\u641c\u7d22\u7684\u6982\u7387\uff0c\u5373\u5bb9\u6613\u53d1\u6563\u3002 \u9057\u4f20\u7b97\u6cd5\u9700\u8981\u5728\u8fc7\u65e9\u6536\u655b\uff08\u65e9\u719f\uff09\u548c\u53d1\u6563\u3001\u7cbe\u5ea6\u548c\u6548\u7387\u4e4b\u95f4\u5e73\u8861\u3002\u5f53\u7269\u79cd\u591a\u6837\u6027\u8fc5\u901f\u964d\u4f4e\u5373\u4e2a\u4f53\u8d8b\u4e8e\u4e00\u81f4\uff0c\u4f8b\u5982\u9009\u62e9\u64cd\u4f5c\u65f6\u8fc7\u5206\u7a81\u51fa\u4f18\u52bf\u57fa\u56e0\u7684\u5730\u4f4d\uff0c\u7ed3\u679c\u53ef\u80fd\u53ea\u662f\u6536\u655b\u4e8e\u5c40\u90e8\u6700\u4f18\u89e3\u3002\u5f53\u7269\u79cd\u6301\u7eed\u4fdd\u6301\u591a\u6837\u6027\uff0c\u4f8b\u5982\u9009\u62e9\u529b\u5ea6\u4e0d\u5927\u3001\u53d8\u5f02\u6982\u7387\u592a\u5927\uff0c\u7ed3\u679c\u53ef\u80fd\u5f88\u96be\u6536\u655b\uff0c\u5373\u7b97\u6cd5\u6548\u7387\u8f83\u4f4e\u3002","title":"\u57fa\u672c\u539f\u7406"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#_2","text":"\u8003\u8651\u7a0b\u5e8f\u7684\u901a\u7528\u6027\uff0c\u51cf\u5c11\u6a21\u5757\u4e4b\u95f4\u7684\u8026\u5408\uff0c \u79cd\u7fa4 \u3001 \u9057\u4f20\u7b97\u5b50 \u5c06\u88ab\u8bbe\u8ba1\u4e3a\u57fa\u672c\u7c7b\uff0c\u6700\u540e\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 \u9057\u4f20\u7b97\u6cd5\u7c7b \u3002\u53c2\u8003\u4f2a\u4ee3\u7801\uff1a # \u57fa\u4e8e\u4e2a\u4f53\u751f\u6210\u79cd\u7fa4 I = Individual() P = Population(I, 50) # \u9057\u4f20\u7b97\u5b50 S = Selection() C = Crossover() M = Mutation() # \u7efc\u5408\u79cd\u7fa4\u548c\u9057\u4f20\u7b97\u5b50\u8fdb\u5165\u9057\u4f20\u7b97\u6cd5\u6807\u51c6\u6d41\u7a0b G = GA(P, S, C, M) res = G.run() \u9057\u4f20\u7b97\u6cd5\u57fa\u672c\u6d41\u7a0b\u76f8\u5bf9\u56fa\u5b9a\uff0c\u56e0\u6b64\u4ee5\u4e0a\u7ed3\u6784\u6709\u5229\u4e8e\uff1a \u5f53\u9700\u8981\u6539\u8fdb\u9057\u4f20\u7b97\u5b50\u7b56\u7565\u65f6\uff0c\u53ef\u4ee5\u4ece\u57fa\u672c\u7b97\u5b50\u7c7b\u6d3e\u751f\u5b50\u7c7b\u800c\u4e0d\u5fc5\u6539\u52a8\u5176\u4ed6\u90e8\u5206 \u5f53\u9700\u8981\u5e94\u7528\u4e8e\u4e0d\u540c\u95ee\u9898\u65f6\uff0c\u53ef\u4ee5\u4ece\u4e2a\u4f53\u57fa\u7c7b\u6d3e\u751f\u76f8\u5e94\u7684\u5b50\u7c7b\uff08\u6ee1\u8db3\u7f16\u7801\u7684\u9700\u8981\uff09","title":"\u7a0b\u5e8f\u8bbe\u8ba1"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#1","text":"\u76ee\u524d\u4ec5\u8003\u8651\u6d6e\u70b9\u6570\u7f16\u7801\uff0c\u56e0\u6b64\u7701\u53bb\u4e86\u7f16\u7801/\u89e3\u7801\u8fc7\u7a0b\u2014\u2014\u6574\u4e2a\u67d3\u8272\u4f53\u5c31\u662f\u89e3\u5411\u91cf\uff0c\u6bcf\u4e2a\u57fa\u56e0\u662f\u5176\u4e2d\u4e00\u4e2a\u5206\u91cf\u3002 Individual \u7c7b\u8868\u5f81\u4e2a\u4f53\uff0c\u91cd\u8981\u7684\u5c5e\u6027\u4e3a\uff1a solution \u89e3\u5411\u91cf evaluation \u76ee\u6807\u51fd\u6570\u503c fitness \u9002\u5e94\u5ea6\u503c Population \u7c7b\u8868\u5f81\u7fa4\u4f53\uff0c\u6839\u636e\u4e2a\u4f53\u5b9e\u4f8b\u751f\u6210\u6307\u5b9a\u5927\u5c0f\u7684\u79cd\u7fa4\uff0c\u5176\u4e2d\uff1a individuals \u6240\u6709\u4e2a\u4f53\u5217\u8868\uff0c Numpy \u7684 ndarray \u7c7b\u578b best \u6700\u4f18\u4e2a\u4f53 #---------------------------------------------------------- # GAComponents.py: Individual, Population #---------------------------------------------------------- import numpy as np class Individual: '''individual of population''' def __init__(self, ranges): ''' ranges: element range of solution, e.g. [(lb1, ub1), (lb2, ub2), ...] validation of ranges is skipped... ''' self.ranges = np.array(ranges) self.dimension = self.ranges.shape[0] # initialize solution within [lb, ub] seeds = np.random.random(self.dimension) lb = self.ranges[:, 0] ub = self.ranges[:, 1] self._solution = lb + (ub-lb)*seeds # evaluation and fitness self.evaluation = None self.fitness = None @property def solution(self): return self._solution @solution.setter def solution(self, solution): assert self.dimension == solution.shape[0] assert (solution>=self.ranges[:, 0]).all() and (solution<=self.ranges[:, 1]).all() self._solution = solution class Population: '''collection of individuals''' def __init__(self, individual, size=50): ''' individual : individual template size : count of individuals ''' self.individual = individual self.size = size self.individuals = None def initialize(self): '''initialization for next generation''' IndvClass = self.individual.__class__ self.individuals = np.array([IndvClass(self.individual.ranges) for i in range(self.size)], dtype=IndvClass) def best(self, fun_evaluation, fun_fitness=None): '''get best individual according to evaluation value ''' # evaluate first and collect evaluations _, evaluation = self.fitness(fun_evaluation, fun_fitness) # get the minimum position pos = np.argmin(evaluation) return self.individuals[pos] def fitness(self, fun_evaluation, fun_fitness=None): ''' calculate objectibe value and fitness for each individual. fun_evaluation : objective function fun_fitness : population fitness based on evaluation ''' # fitness is same as evaluation by default if not fun_fitness: fun_fitness = lambda x: x # get the value directly if it has been calculated before evaluation = np.array([fun_evaluation(I.solution) if I.evaluation is None else I.evaluation for I in self.individuals]) # calculate fitness fitness = fun_fitness(evaluation) fitness = fitness/np.sum(fitness) # normalize # set attributes for each individual for I, e, f in zip(self.individuals, evaluation, fitness): I.evaluation = e I.fitness = f return fitness, evaluation if __name__ == '__main__': ranges = [(-10,10)] * 3 obj = lambda x: x[0]+x[1]**2+x[2]**3 I = Individual(ranges) P = Population(I, 100) P.initialize() print(P.best(obj).solution)","title":"1 \u79cd\u7fa4"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#2","text":"2.1 \u9009\u62e9 \u91c7\u7528\u6807\u51c6\u7684 \u8f6e\u76d8\u8d4c\uff08RouletteWheel\uff09 \u65b9\u5f0f\uff0c\u4ee5\u79cd\u7fa4\u4e2d\u4e2a\u4f53\u7684\u9002\u5e94\u5ea6\u4e3a\u53c2\u8003\uff0c\u4ece\u4e2d\u9009\u62e9\u51fa\u540c\u6837\u5927\u5c0f\u7684\u65b0\u7684\u79cd\u7fa4\u4e2a\u4f53\u3002\u4ece\u4e0a\u4e00\u8282\u79cd\u7fa4\u9002\u5e94\u5ea6\u7684\u8ba1\u7b97\u53ef\u77e5\uff0c\u4e2a\u4f53\u7684\u9002\u5e94\u5ea6\u5df2\u7ecf\u88ab\u5f52\u4e00\u5316\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4f5c\u4e3a\u8f6e\u76d8\u8d4c\u7684\u6982\u7387\u53c2\u8003\u3002 #---------------------------------------------------------- # GAOperators.py: Selection, Crossover, Mmutation #---------------------------------------------------------- import numpy as np import copy from GAComponents import Individual #---------------------------------------------------------- # SELECTION #---------------------------------------------------------- class Selection: '''base class for selection''' def select(self, population, fitness): raise NotImplementedError class RouletteWheelSelection(Selection): ''' select individuals by Roulette Wheel: individuals selected with a probability of its fitness ''' def select(self, population, fitness): selected_individuals = np.random.choice(population.individuals, population.size, p=fitness) # pay attention to deep copy these objects population.individuals = np.array([copy.deepcopy(I) for I in selected_individuals]) 2.2 \u4ea4\u53c9 \u4ece\u9009\u62e9\u540e\u7684\u6837\u672c\u4e2d\u968f\u673a\u9009\u62e9\u4e24\u4e2a\u4e2a\u4f53 a \u548c b \uff0c\u4ee5\u4e00\u5b9a\u7684\u6982\u7387\u8fdb\u884c\u4ea4\u53c9\u64cd\u4f5c\uff1a\u5c06\u968f\u673a\u4f4d\u7f6e\u7684\u5bf9\u5e94\u57fa\u56e0\uff08\u4f8b\u5982 g_a g_a \uff0c g_b g_b \uff09\u6309\u7cfb\u6570 \\alpha \\alpha \u8fdb\u884c\u7ebf\u6027\u63d2\u503c\uff0c\u5176\u4f59\u4f4d\u7f6e\u4fdd\u6301\u4e0d\u53d8\uff0c\u4ece\u800c\u5f97\u5230\u4e24\u4e2a\u65b0\u7684\u4e2a\u4f53 a' \u548c b' \u3002 \u5bf9\u4e8e\u4ea4\u53c9\u4f4d\u7f6e\u7684\u57fa\u56e0\uff1a \\begin{align*} g_a' &= g_a + (g_b-g_a)(1-\\alpha)\\\\\\ g_b' &= g_b - (g_b-g_a)(1-\\alpha) \\end{align*} \u5bf9\u4e8e\u975e\u4ea4\u53c9\u4f4d\u7f6e\u7684\u57fa\u56e0\uff1a \\begin{align*} g_a' &= g_a\\\\\\ g_b' &= g_b \\end{align*} \u7efc\u5408\u8d77\u6765\uff0c\u4e2a\u4f53 a \u548c b \u6240\u6709\u4f4d\u7f6e\u7684\u57fa\u56e0\u4ea4\u53c9\u64cd\u4f5c\u53ef\u4ee5\u5199\u6210\u5411\u91cf\u5f62\u5f0f\uff1a \\begin{align*} a' &= a + (b-a)(1-\\alpha)\\beta\\\\\\ b' &= b - (b-a)(1-\\alpha)\\beta \\end{align*} \u5176\u4e2d\uff0c \\beta \\beta \u8868\u793a\u662f\u5426\u8fdb\u884c\u4ea4\u53c9\u7684 0-1 \u5411\u91cf\u3002 # ......\u63a5\u4e0a\u4e00\u6bb5\u4ee3\u7801 #---------------------------------------------------------- # CROSSOVER #---------------------------------------------------------- class Crossover: def __init__(self, rate=0.8, alpha=0.5): ''' crossover operation: rate: propability of crossover. alpha: factor for crossing two chroms, [0,1] ''' # parameters check is skipped self.rate = rate self.alpha = alpha @staticmethod def cross_individuals(individual_a, individual_b, alpha): ''' generate two child individuals based on parent individuals: new values are calculated at random positions alpha: linear ratio to cross two genes, exchange two genes if alpha is 0.0 ''' # random positions to be crossed pos = np.random.rand(individual_a.dimension) <= 0.5 # cross value temp = (individual_b.solution-individual_a.solution)*pos*(1-alpha) new_value_a = individual_a.solution + temp new_value_b = individual_b.solution - temp # return new individuals new_individual_a = Individual(individual_a.ranges) new_individual_b = Individual(individual_b.ranges) new_individual_a.solution = new_value_a new_individual_b.solution = new_value_b return new_individual_a, new_individual_b def cross(self, population): new_individuals = [] random_population = np.random.permutation(population.individuals) # random order num = int(population.size/2.0)+1 for individual_a, individual_b in zip(population.individuals[0:num+1], random_population[0:num+1]): # crossover if np.random.rand() <= self.rate: child_individuals = self.cross_individuals(individual_a, individual_b, self.alpha) new_individuals.extend(child_individuals) else: new_individuals.append(individual_a) new_individuals.append(individual_b) population.individuals = np.array(new_individuals[0:population.size+1]) 2.3 \u53d8\u5f02 \u6d6e\u70b9\u6570\u7f16\u7801\u4e2a\u4f53\u7684\u53d8\u5f02\u64cd\u4f5c\u4e3a\u5c06\u968f\u5373\u4f4d\u7f6e\u7684\u57fa\u56e0 g \u589e\u52a0\u6216\u51cf\u5c11\u4e00\u4e2a\u968f\u673a\u503c\u3002\u8fd9\u4e2a\u968f\u673a\u503c\u7531\u5141\u8bb8\u53d8\u5316\u533a\u95f4\u4e58\u4ee5\u4e00\u4e2a[0,1]\u533a\u95f4\u7684\u968f\u673a\u6570 \\alpha \\alpha \u6765\u786e\u5b9a\u3002\u4f8b\u5982\u57fa\u56e0 g \u7684\u533a\u95f4\u4e3a [L,U] \uff0c\u5219\u53d8\u5f02\u540e\u7684\u57fa\u56e0 g' \uff1a \\begin{align*} g &= g - (g-L)\\alpha\\,\\,\\,(rand() \\leq 0.5)\\\\\\ g &= g + (U-g)\\alpha\\,\\,\\,(rand() > 0.5) \\end{align*} # ......\u63a5\u4e0a\u4e00\u6bb5\u4ee3\u7801 #---------------------------------------------------------- # MUTATION #---------------------------------------------------------- class Mutation: def __init__(self, rate): ''' mutation operation: rate: propability of mutation, [0,1] ''' self.rate = rate def mutate_individual(self, individual, positions, alpha): ''' positions: mutating gene positions, list alpha: mutatation magnitude ''' for pos in positions: if np.random.rand() < 0.5: individual.solution[pos] -= (individual.solution[pos]-individual.ranges[:,0][pos])*alpha else: individual.solution[pos] += (individual.ranges[:,1][pos]-individual.solution[pos])*alpha # reset evaluation individual.evaluation = None individual.fitness = None def mutate(self, population, alpha): ''' alpha: mutating magnitude ''' for individual in population.individuals: if np.random.rand() > self.rate: continue # select random positions to mutate num = np.random.randint(individual.dimension) + 1 pos = np.random.choice(individual.dimension, num, replace=False) self.mutate_individual(individual, pos, alpha)","title":"2 \u9057\u4f20\u7b97\u5b50"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#3","text":"\u672c\u6b21\u5b9e\u73b0\u7684\u9057\u4f20\u7b97\u6cd5\u9ed8\u8ba4\u6c42\u6700\u5c0f\u503c\uff0c\u56e0\u6b64\u9002\u5e94\u5ea6\u51fd\u6570\u5e94\u4e3a\u76ee\u6807\u51fd\u6570\u503c\u7684\u53cd\u51fd\u6570\u3002\u5e76\u4e14\u8003\u8651\u5230\u5b83\u5c06\u4f5c\u4e3a\u9009\u62e9\u6982\u7387\uff0c\u5373\u51fd\u6570\u503c\u5e94\u975e\u8d1f\u3002\u4e8e\u662f\uff0c\u6b64\u5904\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff1a f(x) = \\arctan(-x) + \\pi f(x) = \\arctan(-x) + \\pi #---------------------------------------------------------- # GA.py: Simple Genetic Algorithm #---------------------------------------------------------- import numpy as np class GA(): '''Simple Genetic Algorithm''' def __init__(self, population, selection, crossover, mutation, fun_fitness=lambda x:np.arctan(-x)+np.pi): ''' fun_fitness: fitness based on objective values. minimize the objective by default ''' self.population = population self.selection = selection self.crossover = crossover self.mutation = mutation self.fun_fitness = fun_fitness def run(self, fun_evaluation, gen=50): ''' solve the problem based on Simple GA process ''' # initialize population self.population.initialize() # solving process for n in range(1, gen+1): # select fitness, _ = self.population.fitness(fun_evaluation, self.fun_fitness) self.selection.select(self.population, fitness) # crossover self.crossover.cross(self.population) # mutation self.mutation.mutate(self.population, np.random.rand()) # return the best individual return self.population.best(fun_evaluation, self.fun_fitness)","title":"3 \u9057\u4f20\u7b97\u6cd5"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#_3","text":"\u91c7\u7528\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u8fdb\u884c\u6d4b\u8bd5\uff0c\u6700\u5c0f\u503c\u70b9 f(0,1.25313)=0.292579 f(0,1.25313)=0.292579 \u3002 f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) #---------------------------------------------------------- # test.py #---------------------------------------------------------- from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation # schaffer-N4 # sol: x=[0,1.25313], min=0.292579 schaffer_n4 = lambda x: 0.5 + (np.cos(np.sin(abs(x[0]**2-x[1]**2)))**2-0.5) / (1.0+0.001*(x[0]**2+x[1]**2))**2 I = Individual([(-10,10)]*2) P = Population(I, 50) S = RouletteWheelSelection() C = Crossover(0.9, 0.75) M = Mutation(0.2) g = GA(P, S, C, M) res = [] for i in range(10): res.append(g.run(schaffer_n4, 500).evaluation) val = schaffer_n4([0,1.25313]) val_ga = sum(res)/len(res) print('the minimum: {0}'.format(val)) print('the GA minimum: {0}'.format(val_ga)) print('error: {:<3f} %'.format((val_ga/val-1.0)*100)) #---------------------------------------------------------- # output: #---------------------------------------------------------- the minimum: 0.29257863204552975 the GA minimum: 0.30069849785520314 error: 2.7752764283927034 % \u8fd0\u884c10\u6b21\u7684\u5e73\u5747\u8bef\u5dee\u5728 3% \u5de6\u53f3\uff0c\u8fd8\u6709\u5f88\u5927\u7684\u6539\u8fdb\u7a7a\u95f4\uff0c\u8fd9\u5c06\u5728\u540e\u7eed\u7bc7\u7ae0\u4e2d\u5b8c\u6210\u3002 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565","title":"\u6d4b\u8bd5"},{"location":"2018-10-21-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%8APython%E5%AE%9E%E7%8E%B0/#_4","text":"\u9057\u4f20\u7b97\u6cd5GA(Genetic Algorithm)\u5165\u95e8\u77e5\u8bc6\u68b3\u7406 \u9057\u4f20\u7b97\u6cd5\u8be6\u89e3\uff08GA\uff09 \u7b97\u6cd5\u7406\u89e3-\u9057\u4f20\u7b97\u6cd5\uff08Genetic Algorithm\uff09 \u9057\u4f20\u7b97\u6cd5\u4e2d\u51e0\u79cd\u4e0d\u540c\u9009\u62e9\u7b97\u5b50","title":"\u53c2\u8003\u8d44\u6599"},{"location":"2018-10-25-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%AD%96%E7%95%A5/","text":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-10-25 | \u5206\u7c7b\uff1a numeric calculation \u524d\u6587 \u57fa\u4e8e\u7ecf\u5178\u9057\u4f20\u7b97\u6cd5\u7684\u57fa\u672c\u539f\u7406\uff0c\u4f7f\u7528Python\u7684 Numpy \u6a21\u5757\u5b9e\u73b0\u4e86\u6c42\u89e3\u5355\u76ee\u6807\u65e0\u7ea6\u675f\u4f18\u5316\u95ee\u9898\u7684\u7a0b\u5e8f\u3002\u4f46\u662f\uff0c\u9488\u5bf9\u4e8c\u5143\u51fd\u6570\u6700\u5c0f\u503c\u7684\u6c42\u89e3\u7ed3\u679c\u8868\u660e\u5176\u7cbe\u5ea6\u6709\u5f85\u63d0\u9ad8\uff0c\u672c\u6587\u5c06\u6839\u636e\u81ea\u9002\u5e94\u9057\u4f20\u7b97\u6cd5\uff08Adaptive Genetic Algorithm\uff0cAGA\uff09\u7684\u539f\u7406\u6539\u8fdb\u4e4b\u524d\u7684\u4ee3\u7801\u3002 \u81ea\u9002\u5e94\u9057\u4f20\u7b97\u6cd5\u7684\u6539\u8fdb\u70b9\u5728\u4e8e \u81ea\u9002\u5e94\u8c03\u6574\u9057\u4f20\u53c2\u6570 \uff0c\u4f7f\u5f97\u4fdd\u6301\u7fa4\u4f53\u591a\u6837\u6027\u7684\u540c\u65f6\uff0c\u4fdd\u8bc1\u4e86\u7b97\u6cd5\u7684\u6536\u655b\u6027\u3002\u4f8b\u5982\u5bf9\u4e8e\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\uff0c\u4ea4\u53c9\u3001\u53d8\u5f02\u7684\u6982\u7387\u662f\u56fa\u5b9a\u7684\uff0c\u81ea\u9002\u5e94\u7b56\u7565\u5219\u8981\u6c42\u5728\u8fdb\u5316\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u81ea\u9002\u5e94\u8c03\u6574\uff1a\u5f00\u59cb\u9636\u6bb5\u9009\u53d6\u8f83\u5927\u4ea4\u53c9\u3001\u53d8\u5f02\u6982\u7387\uff0c\u8fd9\u6837\u7684\u7c97\u7565\u641c\u7d22\u8fc7\u7a0b\u6709\u5229\u4e8e\u4fdd\u6301\u79cd\u7fa4\u591a\u6837\u6027\uff0c\u540e\u671f\u5219\u8c03\u6574\u4e3a\u8f83\u5c0f\u503c\u4ee5\u8fdb\u884c\u7ec6\u81f4\u641c\u7d22\uff0c\u9632\u6b62\u7834\u5316\u6700\u4f18\u89e3\uff0c\u52a0\u5feb\u6536\u655b\u901f\u5ea6\u3002 \u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387 \u00b6 \u672c\u6587\u91c7\u7528\u7684\u81ea\u9002\u5e94\u7b56\u7565\u4e3a\u6839\u636e\u53c2\u4e0e\u4ea4\u53c9\u64cd\u4f5c\u7684\u4e24\u4e2a\u4e2a\u4f53 a \u3001 b \u7684\u9002\u5e94\u5ea6 f_a, f_b f_a, f_b \u8c03\u6574\u4ea4\u53c9\u6982\u7387\uff1a\u9002\u5e94\u5ea6\u8d8a\u5927\u4ea4\u53c9\u6982\u7387\u8d8a\u5c0f\uff0c\u53cd\u4e4b\u540c\u7406\u3002\u9996\u5148\u8bbe\u5b9a\u4ea4\u53c9\u6982\u7387\u533a\u95f4 [P_{min}, P_{max}] [P_{min}, P_{max}] \uff0c\u7136\u540e\u8ba1\u7b97\u79cd\u7fa4\u4e2a\u4f53\u9002\u5e94\u5ea6 f_i f_i \uff0c\u53ca\u5e73\u5747\u9002\u5e94\u5ea6 f_{avg} f_{avg} \u3001\u6700\u5927\u9002\u5e94\u5ea6 f_{max} f_{max} \uff0c\u90a3\u4e48\u4ea4\u53c9\u6982\u7387 P P \u7531\u4e0b\u5f0f\u786e\u5b9a\uff1a \\begin{align*} P &= P_{max}\\,\\,\\,(f < f_{avg})\\\\\\ P &= P_{max} - (P_{max}-P_{min}) \\frac{f-f_{avg}}{f_{max}-f_{avg}} \\,\\,\\,(f \\geq f_{avg}) \\end{align*} \u5176\u4e2d\uff0c f=max(f_a, f_b) f=max(f_a, f_b) \u4e3a\u53c2\u4e0e\u4ea4\u53c9\u64cd\u4f5c\u7684\u4e24\u4e2a\u4e2a\u4f53\u4e2d\u9002\u5e94\u5ea6\u8f83\u5927\u8005\u3002 \u5f97\u76ca\u4e8e\u4e4b\u524d\u7a0b\u5e8f\u7684\u975e\u8026\u5408\u6027\uff0c\u53ea\u9700\u4fee\u6539 GAOperators \u6a21\u5757\u7684 Crossover \u7c7b\u5373\u53ef\u3002 #---------------------------------------------------------- # GAOperators.py: Selection, Crossover, Mmutation #---------------------------------------------------------- # ... ... class Crossover: def __init__(self, rate=0.8, alpha=0.5): ''' crossover operation: rate: propability of crossover. adaptive rate when it is a list, e.g. [0.6,0.9] if f<f_avg then rate = range_max if f>=f_avg then rate = range_max-(range_max-range_min)*(f-f_avg)/(f_max-f_avg) where f=max(individual_a, individual_b) alpha: factor for crossing two chroms, [0,1] ''' # parameters check is skipped self.rate = rate self.alpha = alpha @staticmethod def cross_individuals(individual_a, individual_b, alpha): ''' generate two child individuals based on parent individuals: new values are calculated at random positions alpha: linear ratio to cross two genes, exchange two genes if alpha is 0.0 ''' # random positions to be crossed pos = np.random.rand(individual_a.dimension) <= 0.5 # cross value temp = (individual_b.solution-individual_a.solution)*pos*(1-alpha) new_value_a = individual_a.solution + temp new_value_b = individual_b.solution - temp # return new individuals new_individual_a = Individual(individual_a.ranges) new_individual_b = Individual(individual_b.ranges) new_individual_a.solution = new_value_a new_individual_b.solution = new_value_b return new_individual_a, new_individual_b def cross(self, population): adaptive = isinstance(self.rate, list) # adaptive rate if adaptive: fitness = [I.fitness for I in population.individuals] fit_max, fit_avg = np.max(fitness), np.mean(fitness) new_individuals = [] random_population = np.random.permutation(population.individuals) # random order num = int(population.size/2.0)+1 for individual_a, individual_b in zip(population.individuals[0:num+1], random_population[0:num+1]): # adaptive rate if adaptive: fit = max(individual_a.fitness, individual_b.fitness) if fit_max-fit_avg: i_rate = self.rate[1] if fit<fit_avg else self.rate[1] - (self.rate[1]-self.rate[0])*(fit-fit_avg)/(fit_max-fit_avg) else: i_rate = (self.rate[0]+self.rate[1])/2.0 else: i_rate = self.rate # crossover if np.random.rand() <= i_rate: child_individuals = self.cross_individuals(individual_a, individual_b, self.alpha) new_individuals.extend(child_individuals) else: new_individuals.append(individual_a) new_individuals.append(individual_b) population.individuals = np.array(new_individuals[0:population.size+1]) if __name__ == '__main__': # \u666e\u901aCrossover\u5b9e\u4f8b\u521b\u5efa\u65b9\u5f0f C = Crossover(0.9, 0.75) # \u81ea\u9002\u5e94Crossover\u5b9e\u4f8b\u521b\u5efa\u65b9\u5f0f C = Crossover([0.5, 0.9], 0.75) \u81ea\u9002\u5e94\u53d8\u5f02\u7a0b\u5ea6 \u00b6 \u524d\u6587\u7684\u53d8\u5f02\u64cd\u4f5c\u7531\u53d8\u5f02\u6982\u7387\u548c\u53d8\u5f02\u7a0b\u5ea6\uff08\u4e0b\u5f0f\u4e2d\u7684 \\alpha \\alpha \uff09\u5171\u540c\u51b3\u5b9a\uff1a \\begin{align*} g &= g - (g-L)\\alpha\\,\\,\\,(rand() \\leq 0.5)\\\\\\ g &= g + (U-g)\\alpha\\,\\,\\,(rand()>0.5) \\end{align*} \u4e3a\u4e86\u4f7f\u79cd\u7fa4\u5728\u8fdb\u5316\u7684\u540e\u671f\u8d8b\u4e8e\u7a33\u5b9a\uff0c\u5e94\u51cf\u5c0f\u53d8\u5f02\u4f5c\u7528\u3002\u76f8\u5e94\u63aa\u65bd\u4e3a\u51cf\u5c0f\u53d8\u5f02\u6982\u7387\u6216\u8005\u53d8\u5f02\u7a0b\u5ea6\uff0c\u672c\u6587\u91c7\u7528\u4e0e\u8fdb\u5316\u4ee3\u6570\u8d1f\u76f8\u5173\u7684\u53d8\u5f02\u7a0b\u5ea6\u503c\uff0c\u5373\u8bbe\u7f6e \\alpha \\alpha \u4e0e\u8fdb\u5316\u4ee3\u6570 n n \uff0c\u603b\u4ee3\u6570 N N \u7684\u5173\u7cfb\u4e3a\uff1a \\alpha = 1.0 - rand()^{1.0-\\frac{n}{N}} \\alpha = 1.0 - rand()^{1.0-\\frac{n}{N}} \u76f8\u5e94\u5730\uff0c\u4ec5\u9700\u4fee\u6539 GA \u6a21\u5757\u9057\u4f20\u7b97\u6cd5\u7c7b GA \u7684 run() \u51fd\u6570\uff1a #---------------------------------------------------------- # GA.py: Simple Genetic Algorithm #---------------------------------------------------------- # ... ... # # mutation # self.mutation.mutate(self.population, np.random.rand()) # mutation rate = 1.0 - np.random.rand()**(1.0-n/gen) self.mutation.mutate(self.population, rate) \u6d4b\u8bd5 \u00b6 \u4f9d\u7136\u91c7\u7528\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u8fdb\u884c\u6d4b\u8bd5\uff0c\u6700\u5c0f\u503c\u70b9 f(0,1.25313)=0.292579 f(0,1.25313)=0.292579 \u3002 f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) #---------------------------------------------------------- # test.py #---------------------------------------------------------- from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation # schaffer-N4 # sol: x=[0,1.25313], min=0.292579 schaffer_n4 = lambda x: 0.5 + (np.cos(np.sin(abs(x[0]**2-x[1]**2)))**2-0.5) / (1.0+0.001*(x[0]**2+x[1]**2))**2 I = Individual([(-10,10)]*2) P = Population(I, 50) S = RouletteWheelSelection() C = Crossover([0.5, 0.9], 0.75) # \u8bbe\u5b9a\u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387\u533a\u95f4 M = Mutation(0.2) g = GA(P, S, C, M) res = [] for i in range(10): res.append(g.run(schaffer_n4, 500).evaluation) val = schaffer_n4([0,1.25313]) val_ga = sum(res)/len(res) print('the minimum: {0}'.format(val)) print('the GA minimum: {0}'.format(val_ga)) print('error: {:<3f} %'.format((val_ga/val-1.0)*100)) #---------------------------------------------------------- # output: #---------------------------------------------------------- the minimum: 0.29257863204552975 the GA minimum: 0.29304050741946297 error: 0.1578636726489835 % \u7ecf\u8fc7\u81ea\u9002\u5e94\u4ea4\u53c9\u548c\u53d8\u5f02\u7b56\u7565\u7684\u6539\u8fdb\uff0c\u8be5\u7b97\u6cd5\u6c42\u89e3\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u6700\u5c0f\u503c\u7684\u5e73\u5747\u8bef\u5dee\u5ea6\u7531 3% \u4e0b\u964d\u81f3 0.2% \u5de6\u53f3\u3002","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565"},{"location":"2018-10-25-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%AD%96%E7%95%A5/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2018-10-25 | \u5206\u7c7b\uff1a numeric calculation \u524d\u6587 \u57fa\u4e8e\u7ecf\u5178\u9057\u4f20\u7b97\u6cd5\u7684\u57fa\u672c\u539f\u7406\uff0c\u4f7f\u7528Python\u7684 Numpy \u6a21\u5757\u5b9e\u73b0\u4e86\u6c42\u89e3\u5355\u76ee\u6807\u65e0\u7ea6\u675f\u4f18\u5316\u95ee\u9898\u7684\u7a0b\u5e8f\u3002\u4f46\u662f\uff0c\u9488\u5bf9\u4e8c\u5143\u51fd\u6570\u6700\u5c0f\u503c\u7684\u6c42\u89e3\u7ed3\u679c\u8868\u660e\u5176\u7cbe\u5ea6\u6709\u5f85\u63d0\u9ad8\uff0c\u672c\u6587\u5c06\u6839\u636e\u81ea\u9002\u5e94\u9057\u4f20\u7b97\u6cd5\uff08Adaptive Genetic Algorithm\uff0cAGA\uff09\u7684\u539f\u7406\u6539\u8fdb\u4e4b\u524d\u7684\u4ee3\u7801\u3002 \u81ea\u9002\u5e94\u9057\u4f20\u7b97\u6cd5\u7684\u6539\u8fdb\u70b9\u5728\u4e8e \u81ea\u9002\u5e94\u8c03\u6574\u9057\u4f20\u53c2\u6570 \uff0c\u4f7f\u5f97\u4fdd\u6301\u7fa4\u4f53\u591a\u6837\u6027\u7684\u540c\u65f6\uff0c\u4fdd\u8bc1\u4e86\u7b97\u6cd5\u7684\u6536\u655b\u6027\u3002\u4f8b\u5982\u5bf9\u4e8e\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\uff0c\u4ea4\u53c9\u3001\u53d8\u5f02\u7684\u6982\u7387\u662f\u56fa\u5b9a\u7684\uff0c\u81ea\u9002\u5e94\u7b56\u7565\u5219\u8981\u6c42\u5728\u8fdb\u5316\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u81ea\u9002\u5e94\u8c03\u6574\uff1a\u5f00\u59cb\u9636\u6bb5\u9009\u53d6\u8f83\u5927\u4ea4\u53c9\u3001\u53d8\u5f02\u6982\u7387\uff0c\u8fd9\u6837\u7684\u7c97\u7565\u641c\u7d22\u8fc7\u7a0b\u6709\u5229\u4e8e\u4fdd\u6301\u79cd\u7fa4\u591a\u6837\u6027\uff0c\u540e\u671f\u5219\u8c03\u6574\u4e3a\u8f83\u5c0f\u503c\u4ee5\u8fdb\u884c\u7ec6\u81f4\u641c\u7d22\uff0c\u9632\u6b62\u7834\u5316\u6700\u4f18\u89e3\uff0c\u52a0\u5feb\u6536\u655b\u901f\u5ea6\u3002","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565"},{"location":"2018-10-25-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%AD%96%E7%95%A5/#_2","text":"\u672c\u6587\u91c7\u7528\u7684\u81ea\u9002\u5e94\u7b56\u7565\u4e3a\u6839\u636e\u53c2\u4e0e\u4ea4\u53c9\u64cd\u4f5c\u7684\u4e24\u4e2a\u4e2a\u4f53 a \u3001 b \u7684\u9002\u5e94\u5ea6 f_a, f_b f_a, f_b \u8c03\u6574\u4ea4\u53c9\u6982\u7387\uff1a\u9002\u5e94\u5ea6\u8d8a\u5927\u4ea4\u53c9\u6982\u7387\u8d8a\u5c0f\uff0c\u53cd\u4e4b\u540c\u7406\u3002\u9996\u5148\u8bbe\u5b9a\u4ea4\u53c9\u6982\u7387\u533a\u95f4 [P_{min}, P_{max}] [P_{min}, P_{max}] \uff0c\u7136\u540e\u8ba1\u7b97\u79cd\u7fa4\u4e2a\u4f53\u9002\u5e94\u5ea6 f_i f_i \uff0c\u53ca\u5e73\u5747\u9002\u5e94\u5ea6 f_{avg} f_{avg} \u3001\u6700\u5927\u9002\u5e94\u5ea6 f_{max} f_{max} \uff0c\u90a3\u4e48\u4ea4\u53c9\u6982\u7387 P P \u7531\u4e0b\u5f0f\u786e\u5b9a\uff1a \\begin{align*} P &= P_{max}\\,\\,\\,(f < f_{avg})\\\\\\ P &= P_{max} - (P_{max}-P_{min}) \\frac{f-f_{avg}}{f_{max}-f_{avg}} \\,\\,\\,(f \\geq f_{avg}) \\end{align*} \u5176\u4e2d\uff0c f=max(f_a, f_b) f=max(f_a, f_b) \u4e3a\u53c2\u4e0e\u4ea4\u53c9\u64cd\u4f5c\u7684\u4e24\u4e2a\u4e2a\u4f53\u4e2d\u9002\u5e94\u5ea6\u8f83\u5927\u8005\u3002 \u5f97\u76ca\u4e8e\u4e4b\u524d\u7a0b\u5e8f\u7684\u975e\u8026\u5408\u6027\uff0c\u53ea\u9700\u4fee\u6539 GAOperators \u6a21\u5757\u7684 Crossover \u7c7b\u5373\u53ef\u3002 #---------------------------------------------------------- # GAOperators.py: Selection, Crossover, Mmutation #---------------------------------------------------------- # ... ... class Crossover: def __init__(self, rate=0.8, alpha=0.5): ''' crossover operation: rate: propability of crossover. adaptive rate when it is a list, e.g. [0.6,0.9] if f<f_avg then rate = range_max if f>=f_avg then rate = range_max-(range_max-range_min)*(f-f_avg)/(f_max-f_avg) where f=max(individual_a, individual_b) alpha: factor for crossing two chroms, [0,1] ''' # parameters check is skipped self.rate = rate self.alpha = alpha @staticmethod def cross_individuals(individual_a, individual_b, alpha): ''' generate two child individuals based on parent individuals: new values are calculated at random positions alpha: linear ratio to cross two genes, exchange two genes if alpha is 0.0 ''' # random positions to be crossed pos = np.random.rand(individual_a.dimension) <= 0.5 # cross value temp = (individual_b.solution-individual_a.solution)*pos*(1-alpha) new_value_a = individual_a.solution + temp new_value_b = individual_b.solution - temp # return new individuals new_individual_a = Individual(individual_a.ranges) new_individual_b = Individual(individual_b.ranges) new_individual_a.solution = new_value_a new_individual_b.solution = new_value_b return new_individual_a, new_individual_b def cross(self, population): adaptive = isinstance(self.rate, list) # adaptive rate if adaptive: fitness = [I.fitness for I in population.individuals] fit_max, fit_avg = np.max(fitness), np.mean(fitness) new_individuals = [] random_population = np.random.permutation(population.individuals) # random order num = int(population.size/2.0)+1 for individual_a, individual_b in zip(population.individuals[0:num+1], random_population[0:num+1]): # adaptive rate if adaptive: fit = max(individual_a.fitness, individual_b.fitness) if fit_max-fit_avg: i_rate = self.rate[1] if fit<fit_avg else self.rate[1] - (self.rate[1]-self.rate[0])*(fit-fit_avg)/(fit_max-fit_avg) else: i_rate = (self.rate[0]+self.rate[1])/2.0 else: i_rate = self.rate # crossover if np.random.rand() <= i_rate: child_individuals = self.cross_individuals(individual_a, individual_b, self.alpha) new_individuals.extend(child_individuals) else: new_individuals.append(individual_a) new_individuals.append(individual_b) population.individuals = np.array(new_individuals[0:population.size+1]) if __name__ == '__main__': # \u666e\u901aCrossover\u5b9e\u4f8b\u521b\u5efa\u65b9\u5f0f C = Crossover(0.9, 0.75) # \u81ea\u9002\u5e94Crossover\u5b9e\u4f8b\u521b\u5efa\u65b9\u5f0f C = Crossover([0.5, 0.9], 0.75)","title":"\u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387"},{"location":"2018-10-25-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%AD%96%E7%95%A5/#_3","text":"\u524d\u6587\u7684\u53d8\u5f02\u64cd\u4f5c\u7531\u53d8\u5f02\u6982\u7387\u548c\u53d8\u5f02\u7a0b\u5ea6\uff08\u4e0b\u5f0f\u4e2d\u7684 \\alpha \\alpha \uff09\u5171\u540c\u51b3\u5b9a\uff1a \\begin{align*} g &= g - (g-L)\\alpha\\,\\,\\,(rand() \\leq 0.5)\\\\\\ g &= g + (U-g)\\alpha\\,\\,\\,(rand()>0.5) \\end{align*} \u4e3a\u4e86\u4f7f\u79cd\u7fa4\u5728\u8fdb\u5316\u7684\u540e\u671f\u8d8b\u4e8e\u7a33\u5b9a\uff0c\u5e94\u51cf\u5c0f\u53d8\u5f02\u4f5c\u7528\u3002\u76f8\u5e94\u63aa\u65bd\u4e3a\u51cf\u5c0f\u53d8\u5f02\u6982\u7387\u6216\u8005\u53d8\u5f02\u7a0b\u5ea6\uff0c\u672c\u6587\u91c7\u7528\u4e0e\u8fdb\u5316\u4ee3\u6570\u8d1f\u76f8\u5173\u7684\u53d8\u5f02\u7a0b\u5ea6\u503c\uff0c\u5373\u8bbe\u7f6e \\alpha \\alpha \u4e0e\u8fdb\u5316\u4ee3\u6570 n n \uff0c\u603b\u4ee3\u6570 N N \u7684\u5173\u7cfb\u4e3a\uff1a \\alpha = 1.0 - rand()^{1.0-\\frac{n}{N}} \\alpha = 1.0 - rand()^{1.0-\\frac{n}{N}} \u76f8\u5e94\u5730\uff0c\u4ec5\u9700\u4fee\u6539 GA \u6a21\u5757\u9057\u4f20\u7b97\u6cd5\u7c7b GA \u7684 run() \u51fd\u6570\uff1a #---------------------------------------------------------- # GA.py: Simple Genetic Algorithm #---------------------------------------------------------- # ... ... # # mutation # self.mutation.mutate(self.population, np.random.rand()) # mutation rate = 1.0 - np.random.rand()**(1.0-n/gen) self.mutation.mutate(self.population, rate)","title":"\u81ea\u9002\u5e94\u53d8\u5f02\u7a0b\u5ea6"},{"location":"2018-10-25-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%AD%96%E7%95%A5/#_4","text":"\u4f9d\u7136\u91c7\u7528\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u8fdb\u884c\u6d4b\u8bd5\uff0c\u6700\u5c0f\u503c\u70b9 f(0,1.25313)=0.292579 f(0,1.25313)=0.292579 \u3002 f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) #---------------------------------------------------------- # test.py #---------------------------------------------------------- from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation # schaffer-N4 # sol: x=[0,1.25313], min=0.292579 schaffer_n4 = lambda x: 0.5 + (np.cos(np.sin(abs(x[0]**2-x[1]**2)))**2-0.5) / (1.0+0.001*(x[0]**2+x[1]**2))**2 I = Individual([(-10,10)]*2) P = Population(I, 50) S = RouletteWheelSelection() C = Crossover([0.5, 0.9], 0.75) # \u8bbe\u5b9a\u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387\u533a\u95f4 M = Mutation(0.2) g = GA(P, S, C, M) res = [] for i in range(10): res.append(g.run(schaffer_n4, 500).evaluation) val = schaffer_n4([0,1.25313]) val_ga = sum(res)/len(res) print('the minimum: {0}'.format(val)) print('the GA minimum: {0}'.format(val_ga)) print('error: {:<3f} %'.format((val_ga/val-1.0)*100)) #---------------------------------------------------------- # output: #---------------------------------------------------------- the minimum: 0.29257863204552975 the GA minimum: 0.29304050741946297 error: 0.1578636726489835 % \u7ecf\u8fc7\u81ea\u9002\u5e94\u4ea4\u53c9\u548c\u53d8\u5f02\u7b56\u7565\u7684\u6539\u8fdb\uff0c\u8be5\u7b97\u6cd5\u6c42\u89e3\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u6700\u5c0f\u503c\u7684\u5e73\u5747\u8bef\u5dee\u5ea6\u7531 3% \u4e0b\u964d\u81f3 0.2% \u5de6\u53f3\u3002","title":"\u6d4b\u8bd5"},{"location":"2018-10-27-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E7%B2%BE%E8%8B%B1%E7%AD%96%E7%95%A5/","text":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565 \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-10-27 | \u5206\u7c7b\uff1a numeric calculation \u4e4b\u524d\u6839\u636e\u81ea\u9002\u5e94\u7b56\u7565\u6539\u8fdb\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\u7684\u539f\u7406\u8fdb\u884c\u4e86Python\u5b9e\u73b0\uff0c\u672c\u7bc7\u5c06\u91c7\u7528\u53e6\u4e00\u5e38\u89c1\u7684\u601d\u8def\u2014\u2014\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565\u7ee7\u7eed\u6539\u8fdb\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\u7a0b\u5e8f\uff0c\u4ee5\u8fdb\u4e00\u6b65\u63d0\u5347\u8ba1\u7b97\u7cbe\u5ea6\u3002 \u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 \u7cbe\u82f1\u4fdd\u7559\u7b56\u7565 \u00b6 \u4e3a\u4e86\u9632\u6b62\u5f53\u524d\u7fa4\u4f53\u7684\u6700\u4f18\u4e2a\u4f53\u5728\u4e0b\u4e00\u4ee3\u53d1\u751f\u4e22\u5931\uff0c\u5bfc\u81f4\u9057\u4f20\u7b97\u6cd5\u4e0d\u80fd\u6536\u655b\u5230\u5168\u5c40\u6700\u4f18\u89e3\uff0c De Jong \u5728\u5176\u535a\u58eb\u8bba\u6587\u4e2d\u63d0\u51fa\u4e86 \u7cbe\u82f1\u9009\u62e9(Elitism) \u7b56\u7565\uff0c\u4e5f\u79f0\u4e3a \u7cbe\u82f1\u4fdd\u7559(Elitist Preservation) \u7b56\u7565\u3002 \u628a\u7fa4\u4f53\u5728\u8fdb\u5316\u8fc7\u7a0b\u4e2d\u8fc4\u4eca\u51fa\u73b0\u7684\u6700\u597d\u4e2a\u4f53\u4e0d\u8fdb\u884c\u9057\u4f20\u64cd\u4f5c\u800c\u76f4\u63a5\u590d\u5236\u5230\u4e0b\u4e00\u4ee3\u4e2d \uff0c\u4e00\u822c\u4f1a\u5c06\u5176\u66ff\u6362\u4e0b\u4e00\u4ee3\u4e2d\u7684\u6700\u52a3\u4e2a\u4f53\u3002\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565\u6539\u8fdb\u4e86\u6807\u51c6\u9057\u4f20\u7b97\u6cd5\u7684\u5168\u5c40\u6536\u655b\u80fd\u529b\uff0c\u5e76\u4e14\u4ece\u7406\u8bba\u4e0a\u88ab\u8bc1\u660e\u4e86 \u5177\u6709\u7cbe\u82f1\u4fdd\u7559\u7684\u6807\u51c6\u9057\u4f20\u7b97\u6cd5\u662f\u5168\u5c40\u6536\u655b\u7684 \u3002 \u4ee5\u4e0b\u5373\u5728\u524d\u6587\u6807\u51c6\u9057\u4f20\u7b97\u6cd5\u7684\u57fa\u7840\u4e0a\uff0c\u91c7\u7528\u4e0a\u4e00\u4ee3\u6700\u4f18\u4e2a\u4f53\u66ff\u6362\u9057\u4f20\u64cd\u4f5c\u540e\u4ea7\u751f\u7684\u5b50\u4ee3\u4e2d\u7684\u968f\u673a\u4e2a\u4f53\uff0c\u5373\u5c06\u8be5\u7cbe\u82f1\u4e2a\u4f53\u65e0\u6761\u4ef6\u590d\u5236\u5230\u5b50\u4ee3\u3002 #---------------------------------------------------------- # GA.py: Simple Genetic Algorithm #---------------------------------------------------------- import numpy as np class GA(): '''Simple Genetic Algorithm''' def __init__(self, population, selection, crossover, mutation, fun_fitness=lambda x:np.arctan(-x)+np.pi): ''' fun_fitness: fitness based on objective values. minimize the objective by default ''' self.population = population self.selection = selection self.crossover = crossover self.mutation = mutation self.fun_fitness = fun_fitness def run(self, fun_evaluation, gen=50, elitism=True): ''' solve the problem based on Simple GA process elitism mechanism: keep the best individual to new generation ''' # initialize population self.population.initialize() # solving process for n in range(1, gen+1): # <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< # the best in previous generation if elitism: the_best = copy.deepcopy(self.population.best(fun_evaluation, self.fun_fitness)) # >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> # new generation by GA operations: # select fitness, _ = self.population.fitness(fun_evaluation, self.fun_fitness) self.selection.select(self.population, fitness) # crossover self.crossover.cross(self.population) # mutation self.mutation.mutate(self.population, np.random.rand()) # <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< # elitism mechanism: # set a random individual as the best in previous generation if elitism: pos = np.random.randint(self.population.size) self.population.individuals[pos] = the_best) # >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> # return the best individual return self.population.best(fun_evaluation, self.fun_fitness) \u6d4b\u8bd5 \u00b6 \u4f9d\u7136\u91c7\u7528\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u8fdb\u884c\u6d4b\u8bd5\uff0c\u6700\u5c0f\u503c\u70b9 f(0,1.25313)=0.292579 f(0,1.25313)=0.292579 \u3002 f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) #---------------------------------------------------------- # test.py #---------------------------------------------------------- from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation # schaffer-N4 # sol: x=[0,1.25313], min=0.292579 schaffer_n4 = lambda x: 0.5 + (np.cos(np.sin(abs(x[0]**2-x[1]**2)))**2-0.5) / (1.0+0.001*(x[0]**2+x[1]**2))**2 I = Individual([(-10,10)]*2) P = Population(I, 50) S = RouletteWheelSelection() C = Crossover(0.9, 0.75) # \u8bbe\u5b9a\u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387\u533a\u95f4 M = Mutation(0.2) g = GA(P, S, C, M) res = [] for i in range(10): res.append(g.run(schaffer_n4, 500).evaluation) val = schaffer_n4([0,1.25313]) val_ga = sum(res)/len(res) print('the minimum: {0}'.format(val)) print('the GA minimum: {0}'.format(val_ga)) print('error: {:<3f} %'.format((val_ga/val-1.0)*100)) #---------------------------------------------------------- # output: #---------------------------------------------------------- the minimum: 0.29257863204552975 the GA minimum: 0.29259259704630364 error: 0.004773076104780394 % \u7ecf\u8fc7\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565\u7684\u6539\u8fdb\uff0c\u8be5\u7b97\u6cd5\u6c42\u89e3\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u6700\u5c0f\u503c\u7684\u5e73\u5747\u8bef\u5dee\u7531 3% \u4e0b\u964d\u81f3 0.005% \u5de6\u53f3\u3002\u6700\u540e\uff0c\u7efc\u5408\u6574\u7406\u6b64\u524d\u6240\u6709\u4ee3\u7801\uff1a https://github.com/dothinking/basicGA","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565"},{"location":"2018-10-27-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E7%B2%BE%E8%8B%B1%E7%AD%96%E7%95%A5/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2018-10-27 | \u5206\u7c7b\uff1a numeric calculation \u4e4b\u524d\u6839\u636e\u81ea\u9002\u5e94\u7b56\u7565\u6539\u8fdb\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\u7684\u539f\u7406\u8fdb\u884c\u4e86Python\u5b9e\u73b0\uff0c\u672c\u7bc7\u5c06\u91c7\u7528\u53e6\u4e00\u5e38\u89c1\u7684\u601d\u8def\u2014\u2014\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565\u7ee7\u7eed\u6539\u8fdb\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\u7a0b\u5e8f\uff0c\u4ee5\u8fdb\u4e00\u6b65\u63d0\u5347\u8ba1\u7b97\u7cbe\u5ea6\u3002 \u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565"},{"location":"2018-10-27-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E7%B2%BE%E8%8B%B1%E7%AD%96%E7%95%A5/#_2","text":"\u4e3a\u4e86\u9632\u6b62\u5f53\u524d\u7fa4\u4f53\u7684\u6700\u4f18\u4e2a\u4f53\u5728\u4e0b\u4e00\u4ee3\u53d1\u751f\u4e22\u5931\uff0c\u5bfc\u81f4\u9057\u4f20\u7b97\u6cd5\u4e0d\u80fd\u6536\u655b\u5230\u5168\u5c40\u6700\u4f18\u89e3\uff0c De Jong \u5728\u5176\u535a\u58eb\u8bba\u6587\u4e2d\u63d0\u51fa\u4e86 \u7cbe\u82f1\u9009\u62e9(Elitism) \u7b56\u7565\uff0c\u4e5f\u79f0\u4e3a \u7cbe\u82f1\u4fdd\u7559(Elitist Preservation) \u7b56\u7565\u3002 \u628a\u7fa4\u4f53\u5728\u8fdb\u5316\u8fc7\u7a0b\u4e2d\u8fc4\u4eca\u51fa\u73b0\u7684\u6700\u597d\u4e2a\u4f53\u4e0d\u8fdb\u884c\u9057\u4f20\u64cd\u4f5c\u800c\u76f4\u63a5\u590d\u5236\u5230\u4e0b\u4e00\u4ee3\u4e2d \uff0c\u4e00\u822c\u4f1a\u5c06\u5176\u66ff\u6362\u4e0b\u4e00\u4ee3\u4e2d\u7684\u6700\u52a3\u4e2a\u4f53\u3002\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565\u6539\u8fdb\u4e86\u6807\u51c6\u9057\u4f20\u7b97\u6cd5\u7684\u5168\u5c40\u6536\u655b\u80fd\u529b\uff0c\u5e76\u4e14\u4ece\u7406\u8bba\u4e0a\u88ab\u8bc1\u660e\u4e86 \u5177\u6709\u7cbe\u82f1\u4fdd\u7559\u7684\u6807\u51c6\u9057\u4f20\u7b97\u6cd5\u662f\u5168\u5c40\u6536\u655b\u7684 \u3002 \u4ee5\u4e0b\u5373\u5728\u524d\u6587\u6807\u51c6\u9057\u4f20\u7b97\u6cd5\u7684\u57fa\u7840\u4e0a\uff0c\u91c7\u7528\u4e0a\u4e00\u4ee3\u6700\u4f18\u4e2a\u4f53\u66ff\u6362\u9057\u4f20\u64cd\u4f5c\u540e\u4ea7\u751f\u7684\u5b50\u4ee3\u4e2d\u7684\u968f\u673a\u4e2a\u4f53\uff0c\u5373\u5c06\u8be5\u7cbe\u82f1\u4e2a\u4f53\u65e0\u6761\u4ef6\u590d\u5236\u5230\u5b50\u4ee3\u3002 #---------------------------------------------------------- # GA.py: Simple Genetic Algorithm #---------------------------------------------------------- import numpy as np class GA(): '''Simple Genetic Algorithm''' def __init__(self, population, selection, crossover, mutation, fun_fitness=lambda x:np.arctan(-x)+np.pi): ''' fun_fitness: fitness based on objective values. minimize the objective by default ''' self.population = population self.selection = selection self.crossover = crossover self.mutation = mutation self.fun_fitness = fun_fitness def run(self, fun_evaluation, gen=50, elitism=True): ''' solve the problem based on Simple GA process elitism mechanism: keep the best individual to new generation ''' # initialize population self.population.initialize() # solving process for n in range(1, gen+1): # <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< # the best in previous generation if elitism: the_best = copy.deepcopy(self.population.best(fun_evaluation, self.fun_fitness)) # >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> # new generation by GA operations: # select fitness, _ = self.population.fitness(fun_evaluation, self.fun_fitness) self.selection.select(self.population, fitness) # crossover self.crossover.cross(self.population) # mutation self.mutation.mutate(self.population, np.random.rand()) # <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< # elitism mechanism: # set a random individual as the best in previous generation if elitism: pos = np.random.randint(self.population.size) self.population.individuals[pos] = the_best) # >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> # return the best individual return self.population.best(fun_evaluation, self.fun_fitness)","title":"\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565"},{"location":"2018-10-27-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%94%B9%E8%BF%9B%E6%96%B9%E5%90%91%E4%B9%8B%E7%B2%BE%E8%8B%B1%E7%AD%96%E7%95%A5/#_3","text":"\u4f9d\u7136\u91c7\u7528\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u8fdb\u884c\u6d4b\u8bd5\uff0c\u6700\u5c0f\u503c\u70b9 f(0,1.25313)=0.292579 f(0,1.25313)=0.292579 \u3002 f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) f(x,y) = 0.5 + \\frac{\\cos^2 \\left[\\sin\\left(|x^2-y^2| \\right) \\right] -0.5}{\\left[1+0.001\\left(x^2+y^2\\right)\\right]^2} \\,\\,\\,\\, \\left(-10 \\leq (x,y) \\leq 10\\right) #---------------------------------------------------------- # test.py #---------------------------------------------------------- from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation # schaffer-N4 # sol: x=[0,1.25313], min=0.292579 schaffer_n4 = lambda x: 0.5 + (np.cos(np.sin(abs(x[0]**2-x[1]**2)))**2-0.5) / (1.0+0.001*(x[0]**2+x[1]**2))**2 I = Individual([(-10,10)]*2) P = Population(I, 50) S = RouletteWheelSelection() C = Crossover(0.9, 0.75) # \u8bbe\u5b9a\u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387\u533a\u95f4 M = Mutation(0.2) g = GA(P, S, C, M) res = [] for i in range(10): res.append(g.run(schaffer_n4, 500).evaluation) val = schaffer_n4([0,1.25313]) val_ga = sum(res)/len(res) print('the minimum: {0}'.format(val)) print('the GA minimum: {0}'.format(val_ga)) print('error: {:<3f} %'.format((val_ga/val-1.0)*100)) #---------------------------------------------------------- # output: #---------------------------------------------------------- the minimum: 0.29257863204552975 the GA minimum: 0.29259259704630364 error: 0.004773076104780394 % \u7ecf\u8fc7\u7cbe\u82f1\u4fdd\u7559\u7b56\u7565\u7684\u6539\u8fdb\uff0c\u8be5\u7b97\u6cd5\u6c42\u89e3\u4e8c\u5143\u51fd\u6570 Schaffer_N4 \u6700\u5c0f\u503c\u7684\u5e73\u5747\u8bef\u5dee\u7531 3% \u4e0b\u964d\u81f3 0.005% \u5de6\u53f3\u3002\u6700\u540e\uff0c\u7efc\u5408\u6574\u7406\u6b64\u524d\u6240\u6709\u4ee3\u7801\uff1a https://github.com/dothinking/basicGA","title":"\u6d4b\u8bd5"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/","text":"GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-10-31 | \u5206\u7c7b\uff1a devops \u6301\u7eed\u96c6\u6210\uff08Continuous Integration\uff09\u662f\u4e3a\u4e86\u914d\u5408\u654f\u6377\u5f00\u53d1\u7684\u901f\u5ea6\u548c\u6548\u7387\u800c\u4ea7\u751f\u7684\u4e00\u4e2a\u7528\u4e8e\u7f16\u8bd1\u3001\u6d4b\u8bd5\u3001\u53d1\u5e03\u3001\u90e8\u7f72\u7684\u5de5\u5177\u3002\u5f00\u53d1\u4eba\u5458\u7684\u6bcf\u4e00\u6b21\u4ee3\u7801\u63d0\u4ea4\uff0c\u90fd\u5c06\u89e6\u53d1\u9884\u5148\u5b9a\u4e49\u7684\u4efb\u52a1\uff0c\u81ea\u52a8\u8fdb\u884c\u7f16\u8bd1\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u7b49\u3002\u5982\u679c\u6210\u529f\u5219\u63a5\u53d7\u8fd9\u6b21\u63d0\u4ea4\uff0c\u5426\u5219\u63d0\u793a\u96c6\u6210\u5931\u8d25\u3002\u672c\u7bc7\u4ecb\u7ecdGitLab\u63d0\u4f9b\u7684\u6301\u7eed\u96c6\u6210\uff08CI/CD\uff09\u529f\u80fd\u3002 \u57fa\u672c\u6d41\u7a0b \u00b6 \u81eaGitLab 8.0\u7248\u672c\u8d77\uff0c Continuous Integration \u529f\u80fd\u88ab\u96c6\u6210\u5230GitLab\u57fa\u672c\u914d\u7f6e\u4e2d\uff0c\u5e76\u4e14\u9ed8\u8ba4\u5bf9\u6240\u6709\u9879\u76ee\u751f\u6548\u3002\u4e24\u6b65\u5b9e\u73b0GitLab\u7684CI/CD\u670d\u52a1 1 \uff1a \u5728\u4ee3\u7801\u4ed3\u5e93\u6839\u76ee\u5f55\u521b\u5efa .gitlab-ci.yml \u6587\u4ef6 \u914d\u7f6e\u6267\u884c\u4efb\u52a1\u7684 Runner .gitlab-ci.yml \u6587\u4ef6\u6309\u7167 YAML \u6587\u4ef6\u683c\u5f0f\u5b9a\u4e49\u4e86\u9700\u8981\u81ea\u52a8\u5316\u6267\u884c\u7684\u4efb\u52a1\u5217\u8868\uff0c\u6bcf\u4e2a\u4efb\u52a1\u7531\u4e00\u7cfb\u5217\u547d\u4ee4\u884c\u4ee3\u7801\u5b8c\u6210\uff1b Runner \u662fGitLab\u9ed8\u8ba4\u914d\u7f6e\u597d\u7684\u670d\u52a1\u5668\uff08\u4e00\u822c\u662fLinux\u73af\u5883\uff09\uff0c\u6216\u8005\u81ea\u884c\u624b\u52a8\u6dfb\u52a0\u7684\u670d\u52a1\u5668\uff08\u4f8b\u5982\u81ea\u5df1\u7684\u4e3b\u673a\uff09\u3002 \u901a\u8fc7\u63d0\u4ea4\u4ee3\u7801\u7b49\u89e6\u53d1CI/CD\u670d\u52a1\u540e\uff0cGitLab\u6309\u4e00\u5b9a\u539f\u5219\u5206\u914d Runner \u3002\u6ce8\u610f\u6bcf\u4e2a\u4efb\u52a1\u90fd\u5c06\u88ab\u5206\u914d\u7ed9\u4e00\u4e2a\u5177\u5907\u76f8\u5bf9\u72ec\u7acb\u73af\u5883\u7684 Runner \uff0c\u5373\u4fbf\u4e24\u4e2a\u4efb\u52a1\u88ab\u5148\u540e\u5206\u914d\u5230\u4e86\u540c\u4e00\u4e2a Runner \u3002 Runner \u63a5\u5230\u4efb\u52a1\u540e\uff0c\u5c06\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u8f7d\u5230 Runner \u672c\u5730\uff0c\u7136\u540e\u6267\u884c\u8be5\u4efb\u52a1\u5b9a\u4e49\u7684\u6307\u4ee4\u3002 \u6d4b\u8bd5\u6848\u4f8b\u4e00 \u00b6 \u4e3a\u4e86\u81ea\u52a8\u5316\u6301\u7eed\u96c6\u6210\uff0c\u9700\u8981\u786e\u4fdd\u53ef\u4ee5\u6309\u811a\u672c/\u547d\u4ee4\u6267\u884c\u76ee\u6807\u4efb\u52a1\u3002\u4f8b\u5982\uff1a \u5728\u9879\u76ee\u4e2d\u51c6\u5907\u597d makefile \uff0c\u4f7f\u7528 make \u6216 nmake \u7f16\u8bd1C++\u4ee3\u7801 \u51c6\u5907\u597d\u5355\u5143\u6d4b\u8bd5\u7684Python\u811a\u672c\uff0c\u4f7f\u7528 python -m unittest test_file_name \u6267\u884c\u5355\u5143\u6d4b\u8bd5 \u4ee5\u4e0b\u662fGitLab\u4ed3\u5e93\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u5176\u4e2d cpp \u6587\u4ef6\u5939\u7528\u4e8e\u6d4b\u8bd5\u7f16\u8bd1C++\u9879\u76ee\uff0c python \u6587\u4ef6\u5939\u7528\u4e8e\u6d4b\u8bd5Python\u5355\u5143\u6d4b\u8bd5\uff0c .gitlab-ci.yml \u5373\u4e3a\u5b9a\u4e49\u76f8\u5e94\u4efb\u52a1\u7684\u6587\u4ef6\u3002 Test Project +-+cpp | + main.cpp | + makefile | +-+python | + abs_fun.py | + test.py | +-+.gitlab-ci.yml \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a // cpp/main.cpp #include <iostream> using namespace std; int main() { std::cout << \"Hello World\" << std::endl; } # cpp/makefile main:main.o g++ -o main main.o # python/abs_fun.py # module to be tested def ABS(x): '''to get absolute value of input''' if type(x) in [int, float]: return x if x>=0 else -x else: raise ValueError('Input value should be int or float') # python/test.py # example for python unit test import unittest from abs_fun import ABS class Test(unittest.TestCase): def test_positive(self): for x in [1, 1.5]: self.assertEqual(ABS(x), x) def test_negtive(self): for x in [-1, -1.5]: self.assertEqual(ABS(x), -x) def test_zero(self): for x in [0, 0.0]: self.assertEqual(ABS(x), x) def test_valueerror(self): for x in ['123', [123], {'k':123}]: with self.assertRaises(ValueError): res = ABS(x) \u5982\u679c\u5728\u672c\u5730\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5206\u522b\u5728\u547d\u4ee4\u884c\u4f7f\u7528 make \u548c python -m unittest test \u5373\u53ef\u3002\u5982\u679c\u8981\u5728 Runner \u6267\u884c\uff0c\u6838\u5fc3\u6307\u4ee4\u4e5f\u662f\u4e00\u6837\u7684\u3002\u53c2\u8003\u4f8b\u5b50\uff1a # \u5b9a\u4e49\u4efb\u52a1\u6267\u884c\u9636\u6bb5 # \u9ed8\u8ba4\u5206\u4e3abuild, test, deploy\u4e09\u4e2a\u9636\u6bb5\uff0c\u4ea6\u53ef\u81ea\u5b9a\u4e49\u5176\u4ed6\u9636\u6bb5\uff0c\u6309\u987a\u5e8f\u6267\u884c # \u5b9a\u4e49\u5728\u76f8\u540cstage\u7684jobs\u4f1a\u88ab\u5e76\u884c\u6267\u884c stages: - build - test - deploy # \u4efb\u52a1\u5217\u8868 # script\uff1a\u5fc5\u987b\u5173\u952e\u5b57\uff0c\u5373\u9700\u8981\u6267\u884c\u7684\u6307\u4ee4 # stage\uff1a\u53ef\u9009\uff0c\u4efb\u52a1\u6240\u5c5e\u9636\u6bb5 # tags\uff1a\u53ef\u9009\uff0c\u7528\u4ee5\u7b5b\u9009Runner\uff0c\u4ec5\u8003\u8651\u5c06\u6b64\u4efb\u52a1\u5206\u914d\u7ed9\u5e26\u6709\u76f8\u5e94tag\u7684Runner job1: stage: test tags: - DOCKER script: - echo \"Python Project Unit Test...\" - cd ./python - python -m unittest test # \u867d\u7136job2\u5b9a\u4e49\u5728job1\u4e4b\u540e\uff0c\u4f46job2\u6240\u5c5e\u7684build\u9636\u6bb5\u5728job1\u7684test\u9636\u6bb5\u4e4b\u524d\uff0c # \u6545job2\u6267\u884c\u901a\u8fc7\u540e\u624d\u4f1a\u6267\u884cjob1\uff0c\u5426\u5219\u4efb\u52a1\u5931\u8d25 job2: stage: build tags: - DOCKER script: - echo \"Building CPP Project from makefile...\" - cd ./cpp - make - ./main \u63d0\u4ea4\u4ee3\u7801\u89e6\u53d1 CI/CD \u529f\u80fd\u540e\u5373\u53ef\u5728 CI/CD->jobs \u9875\u9762\u89c2\u5bdf\u6267\u884c\u8fdb\u5ea6\uff0c\u70b9\u51fb\u76f8\u5e94\u4efb\u52a1\u7684 Status \u6309\u94ae\u5373\u53ef\u89c2\u5bdf\u5177\u4f53\u7684\u6267\u884c\u65e5\u5fd7\uff1a Running with gitlab-runner 11.3.1 (v11.3.1) on xxxxx e18fb335 Using Docker executor with image xxxxx ... Pulling docker image xxxxx ... Using docker image sha256:1806e9341a6601f388c0666996de0c96b98244d684e6fb52c90c75670a6ec63f for xxxxx ... Running on runner-e18fb335-project-44214-concurrent-0 via xxxxx... Cloning repository... Cloning into '/builds/test_project'... Checking out 432e5cb0 as master... Skipping Git submodules setup $ echo \"Building CPP Project from makefile...\" Building CPP Project from makefile... $ cd ./cpp $ make g++ -c -o main.o main.cpp g++ -o main main.o $ ./main Hello World Job succeeded Running with gitlab-runner 11.3.1 (v11.3.1) on xxxxx e18fb335 Using Docker executor with image xxxxx ... Pulling docker image xxxxx ... Using docker image sha256:1806e9341a6601f388c0666996de0c96b98244d684e6fb52c90c75670a6ec63f for xxxxx ... Running on runner-e18fb335-project-44214-concurrent-0 via xxxxx... Cloning repository... Cloning into '/builds/test_project'... Checking out 432e5cb0 as master... Skipping Git submodules setup $ echo \"Python Project Unit Test...\" Python Project Unit Test... $ cd ./python $ python -m unittest test .... ---------------------------------------------------------------------- Ran 4 tests in 0.000s OK Job succeeded \u6d4b\u8bd5\u6848\u4f8b\u4e8c \u00b6 \u6848\u4f8b\u4e00\u4ec5\u4ec5\u4f5c\u4e3a\u793a\u610f\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u66f4\u591a\u7684\u662f\u9488\u5bf9\u540c\u4e00\u4e2a\u5de5\u7a0b\u5b9a\u4e49 build \u548c test \u9636\u6bb5\u7684 job \u3002\u6ce8\u610f\u5230\u6bcf\u4e2a job \u90fd\u662f\u72ec\u7acb\u7684\uff1a \u540c\u4e00\u5de5\u7a0b\u7684\u4e24\u4e2a job \u53ef\u80fd\u88ab\u5206\u914d\u5230\u4e0d\u540c\u7684 Runner \u4e0a\u6267\u884c \u5373\u4fbf\u5b9a\u4e49\u4e86\u76f8\u540c\u7684 Runner \uff0c\u6267\u884c\u4efb\u52a1\u4e4b\u524d \u9ed8\u8ba4 \u90fd\u6267\u884c\u4e86 git clean \uff0c\u4e5f\u5c31\u662f\u9ed8\u8ba4\u4ece\u76f8\u540c\u7684\u72b6\u6001\u5f00\u59cb\u6267\u884c build \u548c test \u9636\u6bb5\u7684\u4efb\u52a1 \u4f46\u662f\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u6211\u5e0c\u671b build \u9636\u6bb5\u7684\u4efb\u52a1\u7f16\u8bd1\u5b8c\u6210\u7684\u5de5\u7a0b\uff0c\u4f8b\u5982\u52a8\u6001\u94fe\u63a5\u5e93\u6587\u4ef6\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528\u4e8e test \u9636\u6bb5\u7684\u4efb\u52a1\uff1b\u800c\u975e\u5728 test \u9636\u6bb5\u7684\u4efb\u52a1\u4e2d\u53c8\u91cd\u65b0\u7f16\u8bd1\u4e00\u904d\u3002 \u8fd9\u5c31\u9700\u8981\u7528\u5230 artifacts \u548c dependencies \uff0c\u793a\u4f8b\u4e8c\uff1a variables: PROJECT: $CI_PROJECT_NAME BRANCH: $CI_COMMIT_REF_NAME TAG: $CI_COMMIT_TAG REF: $CI_COMMIT_SHA # stages stages: - build - test # jobs build: stage: build script: - make build artifacts: paths: - dist/ expire_in: 1 hour tags: - xxxx test: stage: test dependencies: - build script: - make test tags: - xxxx \u6ce8\u610f\u4e24\u5904\u7ec6\u8282\uff1a build \u9636\u6bb5\u7684\u4efb\u52a1\u5c06 dist \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u4f5c\u4e3a artifacts test \u9636\u6bb5\u7684\u4efb\u52a1\u5c06 build \u4efb\u52a1\u4f5c\u4e3a dependencies \u5176\u6548\u679c\u662f build \u7684 artifacts \u4e5f\u5c31\u662f dist \uff0c\u5c06\u5728 test \u9636\u6bb5\u4ed3\u5e93\u521d\u59cb\u5316\u5b8c\u6210\u540e\u4e0b\u8f7d\u5230\u5de5\u4f5c\u76ee\u5f55\u4e0b\u3002\u56e0\u6b64\uff0c test \u4efb\u52a1\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 build \u5b8c\u6210\u7684\u6587\u4ef6\u3002 \u4e0b\u9762\u5217\u51fa\u4e86\u6267\u884c test \u4efb\u52a1\u8fc7\u7a0b\u4e2d\u76f8\u5e94\u7684\u65e5\u5fd7\u4fe1\u606f\uff1a Downloading artifacts for build (20220274)... Runtime platform arch=amd64 os=windows pid=24332 revision=577f813d version=12.5.0 WARNING: Failed to load system CertPool: crypto/x509: system root pool is not available on Windows Downloading artifacts from coordinator... ok id=20220274 responseStatus=200 OK token=xxxxx \u81ea\u5b9a\u4e49Runner \u00b6 \u4ee5\u4e0a\u4efb\u52a1\u4f7f\u7528\u901a\u7528\u73af\u5883\u5373\u53ef\u5b8c\u6210\uff0c\u4f8b\u5982 g++ \u7f16\u8bd1\u548c python \u73af\u5883\uff0c\u4f46\u6709\u65f6\u53ef\u80fd\u9700\u8981\u7279\u5b9a\u7684\u73af\u5883\uff0c\u4f8b\u5982 Visual Studio \u6216\u8005\u7b2c\u4e09\u65b9\u5e93\u5982 NXOpen C++ \uff0c\u6b64\u65f6\u9700\u8981\u914d\u7f6e\u4e13\u7528\u7684\u670d\u52a1\u5668\u3002GitLab\u63d0\u4f9b\u4e86Linux/MacOS/Windows\u7b49\u4e00\u7cfb\u5217\u5e73\u53f0\u7684\u914d\u7f6e\u65b9\u6cd5 3 \u3002 \u6d41\u7a0b\u5f88\u7b80\u660e\uff1a\u4e0b\u8f7d gitlab-runner \u6587\u4ef6\uff0c\u6ce8\u518c Runner \uff0c\u5b89\u88c5\u548c\u542f\u52a8\u670d\u52a1\u3002\u914d\u7f6e\u6210\u529f\u540e\u5373\u53ef\u5728\u4ed3\u5e93\u7684 Settings->CI/CD->Runners->Specific Runners \u4e0b\u53d1\u73b0\u81ea\u5df1\u7684 Runner \uff0c\u6ce8\u610f\u8bbe\u7f6e tag \u4ee5\u4fbf\u53ef\u4ee5\u5728 .gitlab-ci.yml \u4e2d\u6307\u5b9a\u5728\u6b64 Runner \u6267\u884c\u4efb\u52a1\u3002 \u8bbe\u7f6e git bash \u4e3a\u9ed8\u8ba4\u7684 shell \u00b6 Windows\u7cfb\u7edf\u7684 GitLab Runner \u9ed8\u8ba4\u4ee5 Powershell \u4f5c\u4e3a\u8fd0\u884c\u7684 shell \uff0c\u4f46\u6211\u4eec\u6709\u65f6\u66f4\u503e\u5411\u4e8e\u4f7f\u7528 git bash \u3002\u5177\u4f53\u505a\u6cd5\u4e3a\u4fee\u6539 gitlab-runner.exe \u540c\u76ee\u5f55\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6 config.toml \uff1a concurrent = 1 check_interval = 0 [session_server] session_timeout = 1800 [[runners]] name = \"Example Server\" url = \"https://xxx.yyy.com/\" token = \"xxxx\" executor = \"shell\" shell = \"bash\" builds_dir=\"/path/to/runner/builds/\" [runners.custom_build_dir] [runners.cache] [runners.cache.s3] [runners.cache.gcs] \u6682\u505cgitlab-runner\u670d\u52a1\uff0c\u5907\u4efd\u539f\u59cbconfig.toml \u5c06\u539f\u59cb\u6587\u4ef6\u7684 shell = \"powershell\" \u884c\u4fee\u6539\u4e3a\uff1a shell \u5207\u6362\u4e3a bash \uff0c\u6ce8\u610f\u786e\u4fdd git bash \u5df2\u7ecf\u6dfb\u52a0\u5230 PATH \u73af\u5883\u53d8\u91cf\u4e2d builds_dir \u5207\u6362\u4e3a gitlab-runner.exe \u6240\u5728\u76ee\u5f55\u4e0b\u7684 builds \uff0c\u6ce8\u610f\u91c7\u7528Linux\u7684\u8def\u5f84\u5206\u9694\u7b26 4 \u542f\u52a8gitlab-runner\u670d\u52a1 \u603b\u7ed3 \u00b6 \u5728\u4ed3\u5e93\u6839\u76ee\u5f55 .gitlab-ci.yml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4efb\u52a1\uff0c\u63d0\u4ea4\u4ee3\u7801\u89e6\u53d1 CI/CD \u670d\u52a1\uff0c\u81ea\u52a8\u5728\u5171\u4eab\u6216\u8005\u81ea\u5b9a\u4e49\u7684 Runner \u4e0a\u4f9d\u6b21\u6267\u884c\u4efb\u52a1 Runner \u514b\u9686\u8fdc\u7a0b\u4ed3\u5e93\u5230\u672c\u5730->\u6e05\u9664\u672a\u8ffd\u8e2a\u7684\u6587\u4ef6->\u6267\u884c\u81ea\u5b9a\u4e49\u811a\u672c job \u5b9a\u4e49\u4e2d\u7684 tags \u5173\u952e\u5b57\u53ef\u4ee5\u7b5b\u9009 Runner \uff0c\u4ec5\u5206\u914d\u8be5\u4efb\u52a1\u5230\u5177\u5907\u6307\u5b9a tag \u7684 Runner \u670d\u52a1\u5668 artifacts \u548c dependencies \u5b9e\u73b0\u8de8\u4efb\u52a1\u7ea7\u522b\u5171\u4eab\u6587\u4ef6 \u5982\u679c\u901a\u7528 Runner \u4e0d\u80fd\u6ee1\u8db3\u5f00\u53d1\u73af\u5883\u9700\u6c42\uff0c\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49 Runner Getting started with GitLab CI/CD \u21a9 GitLab CI/CD Pipeline Configuration Reference \u21a9 Install GitLab Runner \u21a9 Windows GitLab CI Runner using Bash \u21a9","title":"GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#gitlab ci cd","text":"\u53d1\u5e03\u4e8e\uff1a2018-10-31 | \u5206\u7c7b\uff1a devops \u6301\u7eed\u96c6\u6210\uff08Continuous Integration\uff09\u662f\u4e3a\u4e86\u914d\u5408\u654f\u6377\u5f00\u53d1\u7684\u901f\u5ea6\u548c\u6548\u7387\u800c\u4ea7\u751f\u7684\u4e00\u4e2a\u7528\u4e8e\u7f16\u8bd1\u3001\u6d4b\u8bd5\u3001\u53d1\u5e03\u3001\u90e8\u7f72\u7684\u5de5\u5177\u3002\u5f00\u53d1\u4eba\u5458\u7684\u6bcf\u4e00\u6b21\u4ee3\u7801\u63d0\u4ea4\uff0c\u90fd\u5c06\u89e6\u53d1\u9884\u5148\u5b9a\u4e49\u7684\u4efb\u52a1\uff0c\u81ea\u52a8\u8fdb\u884c\u7f16\u8bd1\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u7b49\u3002\u5982\u679c\u6210\u529f\u5219\u63a5\u53d7\u8fd9\u6b21\u63d0\u4ea4\uff0c\u5426\u5219\u63d0\u793a\u96c6\u6210\u5931\u8d25\u3002\u672c\u7bc7\u4ecb\u7ecdGitLab\u63d0\u4f9b\u7684\u6301\u7eed\u96c6\u6210\uff08CI/CD\uff09\u529f\u80fd\u3002","title":"GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_1","text":"\u81eaGitLab 8.0\u7248\u672c\u8d77\uff0c Continuous Integration \u529f\u80fd\u88ab\u96c6\u6210\u5230GitLab\u57fa\u672c\u914d\u7f6e\u4e2d\uff0c\u5e76\u4e14\u9ed8\u8ba4\u5bf9\u6240\u6709\u9879\u76ee\u751f\u6548\u3002\u4e24\u6b65\u5b9e\u73b0GitLab\u7684CI/CD\u670d\u52a1 1 \uff1a \u5728\u4ee3\u7801\u4ed3\u5e93\u6839\u76ee\u5f55\u521b\u5efa .gitlab-ci.yml \u6587\u4ef6 \u914d\u7f6e\u6267\u884c\u4efb\u52a1\u7684 Runner .gitlab-ci.yml \u6587\u4ef6\u6309\u7167 YAML \u6587\u4ef6\u683c\u5f0f\u5b9a\u4e49\u4e86\u9700\u8981\u81ea\u52a8\u5316\u6267\u884c\u7684\u4efb\u52a1\u5217\u8868\uff0c\u6bcf\u4e2a\u4efb\u52a1\u7531\u4e00\u7cfb\u5217\u547d\u4ee4\u884c\u4ee3\u7801\u5b8c\u6210\uff1b Runner \u662fGitLab\u9ed8\u8ba4\u914d\u7f6e\u597d\u7684\u670d\u52a1\u5668\uff08\u4e00\u822c\u662fLinux\u73af\u5883\uff09\uff0c\u6216\u8005\u81ea\u884c\u624b\u52a8\u6dfb\u52a0\u7684\u670d\u52a1\u5668\uff08\u4f8b\u5982\u81ea\u5df1\u7684\u4e3b\u673a\uff09\u3002 \u901a\u8fc7\u63d0\u4ea4\u4ee3\u7801\u7b49\u89e6\u53d1CI/CD\u670d\u52a1\u540e\uff0cGitLab\u6309\u4e00\u5b9a\u539f\u5219\u5206\u914d Runner \u3002\u6ce8\u610f\u6bcf\u4e2a\u4efb\u52a1\u90fd\u5c06\u88ab\u5206\u914d\u7ed9\u4e00\u4e2a\u5177\u5907\u76f8\u5bf9\u72ec\u7acb\u73af\u5883\u7684 Runner \uff0c\u5373\u4fbf\u4e24\u4e2a\u4efb\u52a1\u88ab\u5148\u540e\u5206\u914d\u5230\u4e86\u540c\u4e00\u4e2a Runner \u3002 Runner \u63a5\u5230\u4efb\u52a1\u540e\uff0c\u5c06\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u8f7d\u5230 Runner \u672c\u5730\uff0c\u7136\u540e\u6267\u884c\u8be5\u4efb\u52a1\u5b9a\u4e49\u7684\u6307\u4ee4\u3002","title":"\u57fa\u672c\u6d41\u7a0b"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_2","text":"\u4e3a\u4e86\u81ea\u52a8\u5316\u6301\u7eed\u96c6\u6210\uff0c\u9700\u8981\u786e\u4fdd\u53ef\u4ee5\u6309\u811a\u672c/\u547d\u4ee4\u6267\u884c\u76ee\u6807\u4efb\u52a1\u3002\u4f8b\u5982\uff1a \u5728\u9879\u76ee\u4e2d\u51c6\u5907\u597d makefile \uff0c\u4f7f\u7528 make \u6216 nmake \u7f16\u8bd1C++\u4ee3\u7801 \u51c6\u5907\u597d\u5355\u5143\u6d4b\u8bd5\u7684Python\u811a\u672c\uff0c\u4f7f\u7528 python -m unittest test_file_name \u6267\u884c\u5355\u5143\u6d4b\u8bd5 \u4ee5\u4e0b\u662fGitLab\u4ed3\u5e93\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u5176\u4e2d cpp \u6587\u4ef6\u5939\u7528\u4e8e\u6d4b\u8bd5\u7f16\u8bd1C++\u9879\u76ee\uff0c python \u6587\u4ef6\u5939\u7528\u4e8e\u6d4b\u8bd5Python\u5355\u5143\u6d4b\u8bd5\uff0c .gitlab-ci.yml \u5373\u4e3a\u5b9a\u4e49\u76f8\u5e94\u4efb\u52a1\u7684\u6587\u4ef6\u3002 Test Project +-+cpp | + main.cpp | + makefile | +-+python | + abs_fun.py | + test.py | +-+.gitlab-ci.yml \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a // cpp/main.cpp #include <iostream> using namespace std; int main() { std::cout << \"Hello World\" << std::endl; } # cpp/makefile main:main.o g++ -o main main.o # python/abs_fun.py # module to be tested def ABS(x): '''to get absolute value of input''' if type(x) in [int, float]: return x if x>=0 else -x else: raise ValueError('Input value should be int or float') # python/test.py # example for python unit test import unittest from abs_fun import ABS class Test(unittest.TestCase): def test_positive(self): for x in [1, 1.5]: self.assertEqual(ABS(x), x) def test_negtive(self): for x in [-1, -1.5]: self.assertEqual(ABS(x), -x) def test_zero(self): for x in [0, 0.0]: self.assertEqual(ABS(x), x) def test_valueerror(self): for x in ['123', [123], {'k':123}]: with self.assertRaises(ValueError): res = ABS(x) \u5982\u679c\u5728\u672c\u5730\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5206\u522b\u5728\u547d\u4ee4\u884c\u4f7f\u7528 make \u548c python -m unittest test \u5373\u53ef\u3002\u5982\u679c\u8981\u5728 Runner \u6267\u884c\uff0c\u6838\u5fc3\u6307\u4ee4\u4e5f\u662f\u4e00\u6837\u7684\u3002\u53c2\u8003\u4f8b\u5b50\uff1a # \u5b9a\u4e49\u4efb\u52a1\u6267\u884c\u9636\u6bb5 # \u9ed8\u8ba4\u5206\u4e3abuild, test, deploy\u4e09\u4e2a\u9636\u6bb5\uff0c\u4ea6\u53ef\u81ea\u5b9a\u4e49\u5176\u4ed6\u9636\u6bb5\uff0c\u6309\u987a\u5e8f\u6267\u884c # \u5b9a\u4e49\u5728\u76f8\u540cstage\u7684jobs\u4f1a\u88ab\u5e76\u884c\u6267\u884c stages: - build - test - deploy # \u4efb\u52a1\u5217\u8868 # script\uff1a\u5fc5\u987b\u5173\u952e\u5b57\uff0c\u5373\u9700\u8981\u6267\u884c\u7684\u6307\u4ee4 # stage\uff1a\u53ef\u9009\uff0c\u4efb\u52a1\u6240\u5c5e\u9636\u6bb5 # tags\uff1a\u53ef\u9009\uff0c\u7528\u4ee5\u7b5b\u9009Runner\uff0c\u4ec5\u8003\u8651\u5c06\u6b64\u4efb\u52a1\u5206\u914d\u7ed9\u5e26\u6709\u76f8\u5e94tag\u7684Runner job1: stage: test tags: - DOCKER script: - echo \"Python Project Unit Test...\" - cd ./python - python -m unittest test # \u867d\u7136job2\u5b9a\u4e49\u5728job1\u4e4b\u540e\uff0c\u4f46job2\u6240\u5c5e\u7684build\u9636\u6bb5\u5728job1\u7684test\u9636\u6bb5\u4e4b\u524d\uff0c # \u6545job2\u6267\u884c\u901a\u8fc7\u540e\u624d\u4f1a\u6267\u884cjob1\uff0c\u5426\u5219\u4efb\u52a1\u5931\u8d25 job2: stage: build tags: - DOCKER script: - echo \"Building CPP Project from makefile...\" - cd ./cpp - make - ./main \u63d0\u4ea4\u4ee3\u7801\u89e6\u53d1 CI/CD \u529f\u80fd\u540e\u5373\u53ef\u5728 CI/CD->jobs \u9875\u9762\u89c2\u5bdf\u6267\u884c\u8fdb\u5ea6\uff0c\u70b9\u51fb\u76f8\u5e94\u4efb\u52a1\u7684 Status \u6309\u94ae\u5373\u53ef\u89c2\u5bdf\u5177\u4f53\u7684\u6267\u884c\u65e5\u5fd7\uff1a Running with gitlab-runner 11.3.1 (v11.3.1) on xxxxx e18fb335 Using Docker executor with image xxxxx ... Pulling docker image xxxxx ... Using docker image sha256:1806e9341a6601f388c0666996de0c96b98244d684e6fb52c90c75670a6ec63f for xxxxx ... Running on runner-e18fb335-project-44214-concurrent-0 via xxxxx... Cloning repository... Cloning into '/builds/test_project'... Checking out 432e5cb0 as master... Skipping Git submodules setup $ echo \"Building CPP Project from makefile...\" Building CPP Project from makefile... $ cd ./cpp $ make g++ -c -o main.o main.cpp g++ -o main main.o $ ./main Hello World Job succeeded Running with gitlab-runner 11.3.1 (v11.3.1) on xxxxx e18fb335 Using Docker executor with image xxxxx ... Pulling docker image xxxxx ... Using docker image sha256:1806e9341a6601f388c0666996de0c96b98244d684e6fb52c90c75670a6ec63f for xxxxx ... Running on runner-e18fb335-project-44214-concurrent-0 via xxxxx... Cloning repository... Cloning into '/builds/test_project'... Checking out 432e5cb0 as master... Skipping Git submodules setup $ echo \"Python Project Unit Test...\" Python Project Unit Test... $ cd ./python $ python -m unittest test .... ---------------------------------------------------------------------- Ran 4 tests in 0.000s OK Job succeeded","title":"\u6d4b\u8bd5\u6848\u4f8b\u4e00"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_3","text":"\u6848\u4f8b\u4e00\u4ec5\u4ec5\u4f5c\u4e3a\u793a\u610f\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u66f4\u591a\u7684\u662f\u9488\u5bf9\u540c\u4e00\u4e2a\u5de5\u7a0b\u5b9a\u4e49 build \u548c test \u9636\u6bb5\u7684 job \u3002\u6ce8\u610f\u5230\u6bcf\u4e2a job \u90fd\u662f\u72ec\u7acb\u7684\uff1a \u540c\u4e00\u5de5\u7a0b\u7684\u4e24\u4e2a job \u53ef\u80fd\u88ab\u5206\u914d\u5230\u4e0d\u540c\u7684 Runner \u4e0a\u6267\u884c \u5373\u4fbf\u5b9a\u4e49\u4e86\u76f8\u540c\u7684 Runner \uff0c\u6267\u884c\u4efb\u52a1\u4e4b\u524d \u9ed8\u8ba4 \u90fd\u6267\u884c\u4e86 git clean \uff0c\u4e5f\u5c31\u662f\u9ed8\u8ba4\u4ece\u76f8\u540c\u7684\u72b6\u6001\u5f00\u59cb\u6267\u884c build \u548c test \u9636\u6bb5\u7684\u4efb\u52a1 \u4f46\u662f\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u6211\u5e0c\u671b build \u9636\u6bb5\u7684\u4efb\u52a1\u7f16\u8bd1\u5b8c\u6210\u7684\u5de5\u7a0b\uff0c\u4f8b\u5982\u52a8\u6001\u94fe\u63a5\u5e93\u6587\u4ef6\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528\u4e8e test \u9636\u6bb5\u7684\u4efb\u52a1\uff1b\u800c\u975e\u5728 test \u9636\u6bb5\u7684\u4efb\u52a1\u4e2d\u53c8\u91cd\u65b0\u7f16\u8bd1\u4e00\u904d\u3002 \u8fd9\u5c31\u9700\u8981\u7528\u5230 artifacts \u548c dependencies \uff0c\u793a\u4f8b\u4e8c\uff1a variables: PROJECT: $CI_PROJECT_NAME BRANCH: $CI_COMMIT_REF_NAME TAG: $CI_COMMIT_TAG REF: $CI_COMMIT_SHA # stages stages: - build - test # jobs build: stage: build script: - make build artifacts: paths: - dist/ expire_in: 1 hour tags: - xxxx test: stage: test dependencies: - build script: - make test tags: - xxxx \u6ce8\u610f\u4e24\u5904\u7ec6\u8282\uff1a build \u9636\u6bb5\u7684\u4efb\u52a1\u5c06 dist \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u4f5c\u4e3a artifacts test \u9636\u6bb5\u7684\u4efb\u52a1\u5c06 build \u4efb\u52a1\u4f5c\u4e3a dependencies \u5176\u6548\u679c\u662f build \u7684 artifacts \u4e5f\u5c31\u662f dist \uff0c\u5c06\u5728 test \u9636\u6bb5\u4ed3\u5e93\u521d\u59cb\u5316\u5b8c\u6210\u540e\u4e0b\u8f7d\u5230\u5de5\u4f5c\u76ee\u5f55\u4e0b\u3002\u56e0\u6b64\uff0c test \u4efb\u52a1\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 build \u5b8c\u6210\u7684\u6587\u4ef6\u3002 \u4e0b\u9762\u5217\u51fa\u4e86\u6267\u884c test \u4efb\u52a1\u8fc7\u7a0b\u4e2d\u76f8\u5e94\u7684\u65e5\u5fd7\u4fe1\u606f\uff1a Downloading artifacts for build (20220274)... Runtime platform arch=amd64 os=windows pid=24332 revision=577f813d version=12.5.0 WARNING: Failed to load system CertPool: crypto/x509: system root pool is not available on Windows Downloading artifacts from coordinator... ok id=20220274 responseStatus=200 OK token=xxxxx","title":"\u6d4b\u8bd5\u6848\u4f8b\u4e8c"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#runner","text":"\u4ee5\u4e0a\u4efb\u52a1\u4f7f\u7528\u901a\u7528\u73af\u5883\u5373\u53ef\u5b8c\u6210\uff0c\u4f8b\u5982 g++ \u7f16\u8bd1\u548c python \u73af\u5883\uff0c\u4f46\u6709\u65f6\u53ef\u80fd\u9700\u8981\u7279\u5b9a\u7684\u73af\u5883\uff0c\u4f8b\u5982 Visual Studio \u6216\u8005\u7b2c\u4e09\u65b9\u5e93\u5982 NXOpen C++ \uff0c\u6b64\u65f6\u9700\u8981\u914d\u7f6e\u4e13\u7528\u7684\u670d\u52a1\u5668\u3002GitLab\u63d0\u4f9b\u4e86Linux/MacOS/Windows\u7b49\u4e00\u7cfb\u5217\u5e73\u53f0\u7684\u914d\u7f6e\u65b9\u6cd5 3 \u3002 \u6d41\u7a0b\u5f88\u7b80\u660e\uff1a\u4e0b\u8f7d gitlab-runner \u6587\u4ef6\uff0c\u6ce8\u518c Runner \uff0c\u5b89\u88c5\u548c\u542f\u52a8\u670d\u52a1\u3002\u914d\u7f6e\u6210\u529f\u540e\u5373\u53ef\u5728\u4ed3\u5e93\u7684 Settings->CI/CD->Runners->Specific Runners \u4e0b\u53d1\u73b0\u81ea\u5df1\u7684 Runner \uff0c\u6ce8\u610f\u8bbe\u7f6e tag \u4ee5\u4fbf\u53ef\u4ee5\u5728 .gitlab-ci.yml \u4e2d\u6307\u5b9a\u5728\u6b64 Runner \u6267\u884c\u4efb\u52a1\u3002","title":"\u81ea\u5b9a\u4e49Runner"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#git bashshell","text":"Windows\u7cfb\u7edf\u7684 GitLab Runner \u9ed8\u8ba4\u4ee5 Powershell \u4f5c\u4e3a\u8fd0\u884c\u7684 shell \uff0c\u4f46\u6211\u4eec\u6709\u65f6\u66f4\u503e\u5411\u4e8e\u4f7f\u7528 git bash \u3002\u5177\u4f53\u505a\u6cd5\u4e3a\u4fee\u6539 gitlab-runner.exe \u540c\u76ee\u5f55\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6 config.toml \uff1a concurrent = 1 check_interval = 0 [session_server] session_timeout = 1800 [[runners]] name = \"Example Server\" url = \"https://xxx.yyy.com/\" token = \"xxxx\" executor = \"shell\" shell = \"bash\" builds_dir=\"/path/to/runner/builds/\" [runners.custom_build_dir] [runners.cache] [runners.cache.s3] [runners.cache.gcs] \u6682\u505cgitlab-runner\u670d\u52a1\uff0c\u5907\u4efd\u539f\u59cbconfig.toml \u5c06\u539f\u59cb\u6587\u4ef6\u7684 shell = \"powershell\" \u884c\u4fee\u6539\u4e3a\uff1a shell \u5207\u6362\u4e3a bash \uff0c\u6ce8\u610f\u786e\u4fdd git bash \u5df2\u7ecf\u6dfb\u52a0\u5230 PATH \u73af\u5883\u53d8\u91cf\u4e2d builds_dir \u5207\u6362\u4e3a gitlab-runner.exe \u6240\u5728\u76ee\u5f55\u4e0b\u7684 builds \uff0c\u6ce8\u610f\u91c7\u7528Linux\u7684\u8def\u5f84\u5206\u9694\u7b26 4 \u542f\u52a8gitlab-runner\u670d\u52a1","title":"\u8bbe\u7f6egit bash\u4e3a\u9ed8\u8ba4\u7684shell"},{"location":"2018-10-31-GitLab-CI-CD%EF%BC%9A%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_4","text":"\u5728\u4ed3\u5e93\u6839\u76ee\u5f55 .gitlab-ci.yml \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4efb\u52a1\uff0c\u63d0\u4ea4\u4ee3\u7801\u89e6\u53d1 CI/CD \u670d\u52a1\uff0c\u81ea\u52a8\u5728\u5171\u4eab\u6216\u8005\u81ea\u5b9a\u4e49\u7684 Runner \u4e0a\u4f9d\u6b21\u6267\u884c\u4efb\u52a1 Runner \u514b\u9686\u8fdc\u7a0b\u4ed3\u5e93\u5230\u672c\u5730->\u6e05\u9664\u672a\u8ffd\u8e2a\u7684\u6587\u4ef6->\u6267\u884c\u81ea\u5b9a\u4e49\u811a\u672c job \u5b9a\u4e49\u4e2d\u7684 tags \u5173\u952e\u5b57\u53ef\u4ee5\u7b5b\u9009 Runner \uff0c\u4ec5\u5206\u914d\u8be5\u4efb\u52a1\u5230\u5177\u5907\u6307\u5b9a tag \u7684 Runner \u670d\u52a1\u5668 artifacts \u548c dependencies \u5b9e\u73b0\u8de8\u4efb\u52a1\u7ea7\u522b\u5171\u4eab\u6587\u4ef6 \u5982\u679c\u901a\u7528 Runner \u4e0d\u80fd\u6ee1\u8db3\u5f00\u53d1\u73af\u5883\u9700\u6c42\uff0c\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49 Runner Getting started with GitLab CI/CD \u21a9 GitLab CI/CD Pipeline Configuration Reference \u21a9 Install GitLab Runner \u21a9 Windows GitLab CI Runner using Bash \u21a9","title":"\u603b\u7ed3"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/","text":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c \u00b6 \u53d1\u5e03\u4e8e\uff1a2018-11-05 | \u5206\u7c7b\uff1a numeric calculation \u672c\u7bc7\u5c06\u901a\u8fc7\u6c42\u89e3\u4e8c\u5143\u51fd\u6570\u6700\u5c0f\u503c\uff0c\u6d4b\u8bd5\u6b64\u524d\u5b8c\u6210\u7684\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\u53ca\u5176\u6539\u8fdb\u4ee3\u7801\u3002\u91c7\u7528\u57fa\u672c\u53c2\u6570\u5bf916\u4e2a\u5e38\u7528\u6d4b\u8bd5\u51fd\u6570\u7684\u8ba1\u7b97\u8868\u660e\uff0c\u9664 Rosenbrock \u3001 Bukin \u3001 Eggholder \u5916\uff0c\u5176\u4f59\u7ed3\u679c\u90fd\u8868\u73b0\u51fa\u4e86\u5f88\u9ad8\u7684\u7cbe\u5ea6\u3002\u800c\u901a\u8fc7\u8c03\u6574\u53c2\u6570\uff0c\u4e5f\u53ef\u4f7f\u4ee5\u4e0a\u4e09\u4e2a\u51fd\u6570\u8fbe\u5230\u6ee1\u610f\u7684\u7cbe\u5ea6\u3002 \u6d4b\u8bd5\u51fd\u6570 \u00b6 \u4ee5\u4e0b\u94fe\u63a5\u5f52\u7eb3\u4e86\u6d4b\u8bd5\u4f18\u5316\u7b97\u6cd5\u7684\u7ecf\u5178\u51fd\u6570\uff0c\u6db5\u76d6\u4e86\u591a\u5c40\u90e8\u6781\u503c\u70b9\uff08MultiModal\uff09\u3001\u53ef\u5206/\u4e0d\u53ef\u5206\uff08Separable/Inseparable\uff09\u3001\u7897\u72b6/\u8c37\u72b6\u7b49\u7269\u7406/\u51e0\u4f55\u7279\u5f81\u3002 Virtual Library of Simulation Experiments: Test Functions and Datasets \u672c\u6b21\u6d4b\u8bd5\u9009\u53d6\u4e86\u5176\u4e2d16\u4e2a\u51fd\u6570\uff0c\u5176Python\u5b9e\u73b0\u53c2\u8003 Test Function \u3002\u91c7\u7528\u7edf\u4e00\u914d\u7f6e\u7684\u9057\u4f20\u7b97\u6cd5\u5bf9\u6240\u6709\u51fd\u6570\u8fdb\u884c\u4e86\u6d4b\u8bd5\uff0c\u4e3b\u8981\u53c2\u6570\u53ca\u6d4b\u8bd5\u4ee3\u7801\u5982\u4e0b\uff1a \u79cd\u7fa4\u5927\u5c0f 50 \uff0c\u8fdb\u5316\u4ee3\u6570 200 \u9009\u62e9\u7b56\u7565\uff1a\u8f6e\u76d8\u8d4c \u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387\u533a\u95f4 [0.5,0.9] \uff0c\u6bd4\u4f8b\u7cfb\u6570 0.75 \u53d8\u5f02\u6982\u7387 0.1 from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation from GA import GA from TestFun import * import time def test(FUN): s = time.time() # objective function f = FUN() # GA process I = Individual(f.ranges) P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.5,0.9], 0.75) M = Mutation(0.1) g = GA(P, R, C, M) # solve res = g.run(f.objective, 200) # theoretical result print('---TEST FUNCTION: {0}---'.format(FUN.__name__)) print('Global solution input: {0}'.format(f.solution)) print('Global solution output: {0}'.format(f.value)) # GA result print('GA solution input: {0}'.format(res.solution)) print('GA solution output: {0}'.format(res.evaluation)) print('spent time: {0}\\n'.format(time.time()-s)) if __name__ == '__main__': FUNS = [Ackley,Beale,Booth,Bukin,Easom,Eggholder,GoldsteinPrice,\\ Himmelblau,HolderTable,Matyas,McCormick,Rastrigin,Rosenbrock,\\ Schaffer,Schaffer_N4,StyblinskiTang] for fun in FUNS: test(fun) \u6d4b\u8bd5\u7ed3\u679c \u00b6 \u9664 Rosenbrock \u3001 Bukin \u3001 Eggholder \u4e09\u4e2a\u6d4b\u8bd5\u51fd\u6570\u5916\uff0c\u5176\u4f59\u90fd\u8fbe\u5230\u4e86\u8f83\u9ad8\u7684\u7cbe\u5ea6\u3002\u8fd9\u91cc\u4ec5\u5217\u51fa\u6b64\u4e09\u4e2a\u51fd\u6570\u7684\u5bf9\u6bd4\u7ed3\u679c\uff1a ---TEST FUNCTION: Bukin--- Global solution input: [(-10.0, 1.0)] Global solution output: 0.0 GA solution input: [-6.57295214 0.43203714] GA solution output: 0.07146225964404529 spent time: 0.513136625289917 ---TEST FUNCTION: Eggholder--- Global solution input: [(512, 404.2319)] Global solution output: -959.6406627106155 GA solution input: [472.34150119 422.84647295] GA solution output: -938.0481845022081 spent time: 0.5012533664703369 ---TEST FUNCTION: Rosenbrock--- Global solution input: [(1.0, 1.0)] Global solution output: 0.0 GA solution input: [0.98294443 0.96660976] GA solution output: 0.00030938355446668127 spent time: 0.4364597797393799 \u53c2\u6570\u8c03\u6574 \u00b6 Rosenbrock \u00b6 Rosenbrock \u7684\u8ba1\u7b97\u7ed3\u679c\u5df2\u6709\u4e00\u5b9a\u7cbe\u5ea6\uff0c\u56e0\u6b64\u8003\u8651\u4ece\u589e\u52a0\u8fdb\u5316\u4ee3\u6570\u7684\u89d2\u5ea6\u6765\u8fdb\u4e00\u6b65\u63d0\u9ad8\u7cbe\u5ea6\u3002\u4fdd\u6301\u539f\u5148\u53c2\u6570\u7684\u57fa\u7840\u4e0a\u53d6 gen=500 \uff0c\u95ee\u9898\u5f97\u5230\u89e3\u51b3\u3002 P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.5,0.9], 0.75) M = Mutation(0.1) g = GA(P, R, C, M) res = g.run(f.objective, 500) # 200->500 # ---TEST FUNCTION: Rosenbrock--- # Global solution input: [(1.0, 1.0)] # Global solution output: 0.0 # GA solution input: [0.99980462 0.99961286] # GA solution output: 3.946596566064947e-08 # spent time: 1.0529274940490723 Eggholder \u00b6 \u5982\u4e0a\u601d\u8def\u5374\u4e0d\u80fd\u5f88\u597d\u5730\u63d0\u5347 Eggholder \u51fd\u6570\u7684\u8ba1\u7b97\u7cbe\u5ea6\uff0c\u89c2\u5bdf\u53ef\u77e5\u5176\u81ea\u53d8\u91cf\u533a\u95f4 [-512,512] \u8de8\u5ea6\u6bd4\u8f83\u5927\uff0c\u5e76\u4e14\u5b58\u5728\u975e\u5e38\u591a\u7684\u5c40\u90e8\u6781\u503c\u70b9\u3002\u56e0\u6b64\u8003\u8651\uff1a \u4e3a\u4e86\u907f\u514d\u4ea4\u53c9\u65f6\u4e22\u5931\u4f18\u826f\u57fa\u56e0\uff0c\u8bbe\u7f6e\u8f83\u5c0f\u7684\u4ea4\u53c9\u6982\u7387\u4e0b\u9650 \u4e3a\u4e86\u8df3\u51fa\u5c40\u90e8\u6781\u503c\u533a\u57df\uff0c\u8bbe\u7f6e\u8f83\u5927\u7684\u53d8\u5f02\u7387 P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.005,0.9], 0.75) # [0.5,0.9]->[0.005,0.9] M = Mutation(0.75) # 0.1->0.75 g = GA(P, R, C, M) res = g.run(f.objective, 400) # 200->400 # ---TEST FUNCTION: Eggholder--- # Global solution input: [(512, 404.2319)] # Global solution output: -959.6406627106155 # GA solution input: [511.98790315 404.22091999] # GA solution output: -959.5996840391349 # spent time: 1.1881132125854492 \u4ee5\u4e0a\u8c03\u6574\u601d\u8def\u89e3\u51b3\u4e86\u95ee\u9898\u3002\u867d\u7136\u4e00\u822c\u5efa\u8bae\u53d8\u5f02\u7387\u4e0d\u8d85\u8fc7 0.1 \uff0c\u4f46\u5b9e\u9645\u4e0a\u672c\u6b21\u91c7\u7528\u7684\u9057\u4f20\u7b97\u6cd5\u7684\u53d8\u5f02\u64cd\u4f5c\u662f\u7531\u53d8\u5f02\u6982\u7387\u548c\u53d8\u5f02\u7a0b\u5ea6\u5171\u540c\u51b3\u5b9a\u7684\uff0c\u800c\u81ea\u9002\u5e94\u7b56\u7565\u8bbe\u7f6e\u4e86\u53d8\u5f02\u7a0b\u5ea6\u968f\u7740\u8fdb\u5316\u4ee3\u6570\u7684\u589e\u52a0\u800c\u51cf\u5c0f\u81f3\u96f6\u3002\u4e8e\u662f\u5b9e\u9645\u7684\u53d8\u5f02\u91cf\u5e76\u4e0d\u4f1a\u5f88\u9ad8\uff0c\u4e5f\u5c31\u907f\u514d\u4e86\u968f\u673a\u641c\u7d22\u7684\u9707\u8361\u3002 Bukin \u00b6 Bukin \u51fd\u6570\u5177\u6709\u7c7b\u4f3c\u7684\u7279\u70b9\uff0c\u4e0d\u8fc7\u5176\u81ea\u53d8\u91cf\u533a\u95f4\u8de8\u5ea6\u5e76\u4e0d\u5927\uff0c\u4e8e\u662f\u91cd\u70b9\u8c03\u6574\u65b9\u5411\u4e3a\u589e\u5927\u53d8\u5f02\u6982\u7387\u548c\u9057\u4f20\u4ee3\u6570\uff0c\u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.5,0.9], 0.75) M = Mutation(0.75) # 0.1->0.75 g = GA(P, R, C, M) res = g.run(f.objective, 500) # 200->500 # ---TEST FUNCTION: Bukin--- # Global solution input: [(-10.0, 1.0)] # Global solution output: 0.0 # GA solution input: [-10.31586646 1.06417098] # GA solution output: 0.019204141350609386 # spent time: 1.7314023971557617","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2018-11-05 | \u5206\u7c7b\uff1a numeric calculation \u672c\u7bc7\u5c06\u901a\u8fc7\u6c42\u89e3\u4e8c\u5143\u51fd\u6570\u6700\u5c0f\u503c\uff0c\u6d4b\u8bd5\u6b64\u524d\u5b8c\u6210\u7684\u57fa\u672c\u9057\u4f20\u7b97\u6cd5\u53ca\u5176\u6539\u8fdb\u4ee3\u7801\u3002\u91c7\u7528\u57fa\u672c\u53c2\u6570\u5bf916\u4e2a\u5e38\u7528\u6d4b\u8bd5\u51fd\u6570\u7684\u8ba1\u7b97\u8868\u660e\uff0c\u9664 Rosenbrock \u3001 Bukin \u3001 Eggholder \u5916\uff0c\u5176\u4f59\u7ed3\u679c\u90fd\u8868\u73b0\u51fa\u4e86\u5f88\u9ad8\u7684\u7cbe\u5ea6\u3002\u800c\u901a\u8fc7\u8c03\u6574\u53c2\u6570\uff0c\u4e5f\u53ef\u4f7f\u4ee5\u4e0a\u4e09\u4e2a\u51fd\u6570\u8fbe\u5230\u6ee1\u610f\u7684\u7cbe\u5ea6\u3002","title":"\u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#_2","text":"\u4ee5\u4e0b\u94fe\u63a5\u5f52\u7eb3\u4e86\u6d4b\u8bd5\u4f18\u5316\u7b97\u6cd5\u7684\u7ecf\u5178\u51fd\u6570\uff0c\u6db5\u76d6\u4e86\u591a\u5c40\u90e8\u6781\u503c\u70b9\uff08MultiModal\uff09\u3001\u53ef\u5206/\u4e0d\u53ef\u5206\uff08Separable/Inseparable\uff09\u3001\u7897\u72b6/\u8c37\u72b6\u7b49\u7269\u7406/\u51e0\u4f55\u7279\u5f81\u3002 Virtual Library of Simulation Experiments: Test Functions and Datasets \u672c\u6b21\u6d4b\u8bd5\u9009\u53d6\u4e86\u5176\u4e2d16\u4e2a\u51fd\u6570\uff0c\u5176Python\u5b9e\u73b0\u53c2\u8003 Test Function \u3002\u91c7\u7528\u7edf\u4e00\u914d\u7f6e\u7684\u9057\u4f20\u7b97\u6cd5\u5bf9\u6240\u6709\u51fd\u6570\u8fdb\u884c\u4e86\u6d4b\u8bd5\uff0c\u4e3b\u8981\u53c2\u6570\u53ca\u6d4b\u8bd5\u4ee3\u7801\u5982\u4e0b\uff1a \u79cd\u7fa4\u5927\u5c0f 50 \uff0c\u8fdb\u5316\u4ee3\u6570 200 \u9009\u62e9\u7b56\u7565\uff1a\u8f6e\u76d8\u8d4c \u81ea\u9002\u5e94\u4ea4\u53c9\u6982\u7387\u533a\u95f4 [0.5,0.9] \uff0c\u6bd4\u4f8b\u7cfb\u6570 0.75 \u53d8\u5f02\u6982\u7387 0.1 from GAComponents import Individual, Population from GAOperators import RouletteWheelSelection, Crossover, Mutation from GA import GA from TestFun import * import time def test(FUN): s = time.time() # objective function f = FUN() # GA process I = Individual(f.ranges) P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.5,0.9], 0.75) M = Mutation(0.1) g = GA(P, R, C, M) # solve res = g.run(f.objective, 200) # theoretical result print('---TEST FUNCTION: {0}---'.format(FUN.__name__)) print('Global solution input: {0}'.format(f.solution)) print('Global solution output: {0}'.format(f.value)) # GA result print('GA solution input: {0}'.format(res.solution)) print('GA solution output: {0}'.format(res.evaluation)) print('spent time: {0}\\n'.format(time.time()-s)) if __name__ == '__main__': FUNS = [Ackley,Beale,Booth,Bukin,Easom,Eggholder,GoldsteinPrice,\\ Himmelblau,HolderTable,Matyas,McCormick,Rastrigin,Rosenbrock,\\ Schaffer,Schaffer_N4,StyblinskiTang] for fun in FUNS: test(fun)","title":"\u6d4b\u8bd5\u51fd\u6570"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#_3","text":"\u9664 Rosenbrock \u3001 Bukin \u3001 Eggholder \u4e09\u4e2a\u6d4b\u8bd5\u51fd\u6570\u5916\uff0c\u5176\u4f59\u90fd\u8fbe\u5230\u4e86\u8f83\u9ad8\u7684\u7cbe\u5ea6\u3002\u8fd9\u91cc\u4ec5\u5217\u51fa\u6b64\u4e09\u4e2a\u51fd\u6570\u7684\u5bf9\u6bd4\u7ed3\u679c\uff1a ---TEST FUNCTION: Bukin--- Global solution input: [(-10.0, 1.0)] Global solution output: 0.0 GA solution input: [-6.57295214 0.43203714] GA solution output: 0.07146225964404529 spent time: 0.513136625289917 ---TEST FUNCTION: Eggholder--- Global solution input: [(512, 404.2319)] Global solution output: -959.6406627106155 GA solution input: [472.34150119 422.84647295] GA solution output: -938.0481845022081 spent time: 0.5012533664703369 ---TEST FUNCTION: Rosenbrock--- Global solution input: [(1.0, 1.0)] Global solution output: 0.0 GA solution input: [0.98294443 0.96660976] GA solution output: 0.00030938355446668127 spent time: 0.4364597797393799","title":"\u6d4b\u8bd5\u7ed3\u679c"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#_4","text":"","title":"\u53c2\u6570\u8c03\u6574"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#rosenbrock","text":"Rosenbrock \u7684\u8ba1\u7b97\u7ed3\u679c\u5df2\u6709\u4e00\u5b9a\u7cbe\u5ea6\uff0c\u56e0\u6b64\u8003\u8651\u4ece\u589e\u52a0\u8fdb\u5316\u4ee3\u6570\u7684\u89d2\u5ea6\u6765\u8fdb\u4e00\u6b65\u63d0\u9ad8\u7cbe\u5ea6\u3002\u4fdd\u6301\u539f\u5148\u53c2\u6570\u7684\u57fa\u7840\u4e0a\u53d6 gen=500 \uff0c\u95ee\u9898\u5f97\u5230\u89e3\u51b3\u3002 P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.5,0.9], 0.75) M = Mutation(0.1) g = GA(P, R, C, M) res = g.run(f.objective, 500) # 200->500 # ---TEST FUNCTION: Rosenbrock--- # Global solution input: [(1.0, 1.0)] # Global solution output: 0.0 # GA solution input: [0.99980462 0.99961286] # GA solution output: 3.946596566064947e-08 # spent time: 1.0529274940490723","title":"Rosenbrock"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#eggholder","text":"\u5982\u4e0a\u601d\u8def\u5374\u4e0d\u80fd\u5f88\u597d\u5730\u63d0\u5347 Eggholder \u51fd\u6570\u7684\u8ba1\u7b97\u7cbe\u5ea6\uff0c\u89c2\u5bdf\u53ef\u77e5\u5176\u81ea\u53d8\u91cf\u533a\u95f4 [-512,512] \u8de8\u5ea6\u6bd4\u8f83\u5927\uff0c\u5e76\u4e14\u5b58\u5728\u975e\u5e38\u591a\u7684\u5c40\u90e8\u6781\u503c\u70b9\u3002\u56e0\u6b64\u8003\u8651\uff1a \u4e3a\u4e86\u907f\u514d\u4ea4\u53c9\u65f6\u4e22\u5931\u4f18\u826f\u57fa\u56e0\uff0c\u8bbe\u7f6e\u8f83\u5c0f\u7684\u4ea4\u53c9\u6982\u7387\u4e0b\u9650 \u4e3a\u4e86\u8df3\u51fa\u5c40\u90e8\u6781\u503c\u533a\u57df\uff0c\u8bbe\u7f6e\u8f83\u5927\u7684\u53d8\u5f02\u7387 P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.005,0.9], 0.75) # [0.5,0.9]->[0.005,0.9] M = Mutation(0.75) # 0.1->0.75 g = GA(P, R, C, M) res = g.run(f.objective, 400) # 200->400 # ---TEST FUNCTION: Eggholder--- # Global solution input: [(512, 404.2319)] # Global solution output: -959.6406627106155 # GA solution input: [511.98790315 404.22091999] # GA solution output: -959.5996840391349 # spent time: 1.1881132125854492 \u4ee5\u4e0a\u8c03\u6574\u601d\u8def\u89e3\u51b3\u4e86\u95ee\u9898\u3002\u867d\u7136\u4e00\u822c\u5efa\u8bae\u53d8\u5f02\u7387\u4e0d\u8d85\u8fc7 0.1 \uff0c\u4f46\u5b9e\u9645\u4e0a\u672c\u6b21\u91c7\u7528\u7684\u9057\u4f20\u7b97\u6cd5\u7684\u53d8\u5f02\u64cd\u4f5c\u662f\u7531\u53d8\u5f02\u6982\u7387\u548c\u53d8\u5f02\u7a0b\u5ea6\u5171\u540c\u51b3\u5b9a\u7684\uff0c\u800c\u81ea\u9002\u5e94\u7b56\u7565\u8bbe\u7f6e\u4e86\u53d8\u5f02\u7a0b\u5ea6\u968f\u7740\u8fdb\u5316\u4ee3\u6570\u7684\u589e\u52a0\u800c\u51cf\u5c0f\u81f3\u96f6\u3002\u4e8e\u662f\u5b9e\u9645\u7684\u53d8\u5f02\u91cf\u5e76\u4e0d\u4f1a\u5f88\u9ad8\uff0c\u4e5f\u5c31\u907f\u514d\u4e86\u968f\u673a\u641c\u7d22\u7684\u9707\u8361\u3002","title":"Eggholder"},{"location":"2018-11-05-%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B%E4%B9%8B%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC/#bukin","text":"Bukin \u51fd\u6570\u5177\u6709\u7c7b\u4f3c\u7684\u7279\u70b9\uff0c\u4e0d\u8fc7\u5176\u81ea\u53d8\u91cf\u533a\u95f4\u8de8\u5ea6\u5e76\u4e0d\u5927\uff0c\u4e8e\u662f\u91cd\u70b9\u8c03\u6574\u65b9\u5411\u4e3a\u589e\u5927\u53d8\u5f02\u6982\u7387\u548c\u9057\u4f20\u4ee3\u6570\uff0c\u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a P = Population(I, 50) R = RouletteWheelSelection() C = Crossover([0.5,0.9], 0.75) M = Mutation(0.75) # 0.1->0.75 g = GA(P, R, C, M) res = g.run(f.objective, 500) # 200->500 # ---TEST FUNCTION: Bukin--- # Global solution input: [(-10.0, 1.0)] # Global solution output: 0.0 # GA solution input: [-10.31586646 1.06417098] # GA solution output: 0.019204141350609386 # spent time: 1.7314023971557617","title":"Bukin"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/","text":"\u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-01-28 | \u5206\u7c7b\uff1a process automation , python/vba/cpp \u867d\u7136VBA\u662fExcel\u7684\u5b98\u914d\u4e8c\u6b21\u5f00\u53d1\u8bed\u8a00\uff0c\u4f46\u9274\u4e8epython\u7684\u7b80\u6d01\u6613\u7528\u9ad8\u53ef\u7ef4\u62a4\u6027\uff0c\u76f8\u4fe1\u4e0d\u5c11\u4eba\u66f4\u503e\u5411\u4e8e\u4f7f\u7528python\u6765\u5904\u7406Excel\u76f8\u5173\u7684\u4e8c\u6b21\u5f00\u53d1\u5de5\u4f5c\u3002\u76ee\u524d\u5df2\u6709\u4e00\u4e9b\u4f18\u79c0\u7684python\u7b2c\u4e09\u65b9\u5e93\uff0c\u4f8b\u5982 xlrd \uff0c xlwt \u548c xlutils \uff0c\u53ef\u4ee5\u5206\u522b\u5b9e\u73b0Excel\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u548c\u8bfb\u5199\u8f6c\u6362\u5de5\u4f5c\uff1b\u5c24\u5176\u63a8\u8350 xlwings \uff0c\u53ef\u4ee5\u5982\u540cVBA\u4e00\u6837\u64cd\u4f5cExcel\u5de5\u4f5c\u7c3f\u3001\u5de5\u4f5c\u8868\u3001\u5355\u5143\u683c\u533a\u57df\u7b49\u3002\u8fd9\u4e9b\u5e93\u7684\u4e00\u4e2a\u5171\u540c\u7279\u5f81\u662f\u5b8c\u5168\u4e0d\u4f9d\u8d56\u4e8eExcel\u672c\u8eab\uff0c\u4ec5\u4ec5\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u5bf9\u8c61\u8fdb\u884c\u5904\u7406\u3002\u4f46\u6709\u65f6\u5019\uff0c\u6211\u4eec\u8fd8\u662f\u9650\u5b9a\u5728Excel\u73af\u5883\u4e0b\uff0c\u53ea\u662f\u5e0c\u671b\u501f\u52a9python\u800c\u4e0d\u662fVBA\u6765\u5904\u7406\u6570\u636e\u3002 \u672c\u6587\u4ecb\u7ecd\u4e00\u4e2a\u4f5c\u8005\u4ece\u5b9e\u9645\u9700\u6c42\u4e2d\u603b\u7ed3\u8bbe\u8ba1\u7684Excel\u63d2\u4ef6\u6a21\u677f\u8bbe\u8ba1\u5de5\u5177 pyAddin \uff0c\u5b9e\u73b0VBA\u63a7\u5236\u663e\u793a\u3001python\u9a71\u52a8\u8ba1\u7b97\u7684\u6548\u679c\u3002 https://github.com/dothinking/PyAddin \u4e3b\u8981\u529f\u80fd \u00b6 \u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u5229\u7528\u5f00\u7bc7\u63d0\u53ca\u7684python\u7b2c\u4e09\u65b9\u5e93\u8db3\u4ee5\u5c06\u4efb\u4f55\u7e41\u6742\u7684Excel\u6570\u636e\u5904\u7406\u5de5\u4f5c\u8f6c\u5316\u4e3apython\u7f16\u7a0b\u6765\u89e3\u51b3\u3002\u4f46\u5bf9\u4e8e\u67d0\u4e9b\u7528\u6237\uff0c\u4ed6\u4eec\u5df2\u7ecf\u4e60\u60ef\u4e8e\u5728Excel\u73af\u5883\u4e0b\u5f00\u5c55\u6570\u636e\u5904\u7406\u5de5\u4f5c\uff0c\u5e76\u4e14\u7cfb\u7edf\u901a\u5e38\u6ca1\u6709\u914d\u7f6e\u800c\u4ed6\u4eec\u5f80\u5f80\u4e5f\u4e0d\u60c5\u613f\u5b89\u88c5python\u5f00\u53d1\u73af\u5883\u3002\u6b64\u65f6\u5982\u4f55\u4f7f\u53cc\u65b9\u90fd\u8fbe\u5230\u8212\u9002\u7684\u72b6\u6001\u2014\u2014\u7528\u6237\u6109\u5feb\u5730\u5728Excel\u4e2d\u4f7f\u7528\u5f00\u53d1\u8005\u6109\u5feb\u5730\u7528python\u5b9e\u73b0\u7684\u529f\u80fd\uff1f \u8f85\u52a9\u5f00\u53d1\u8005\u8bbe\u8ba1Excel\u63d2\u4ef6 \u3002 \u6839\u636e\u5f00\u53d1\u8005\u63d0\u4f9b\u7684\u63d2\u4ef6Ribbon\u533a\u57df\u754c\u9762\u4fe1\u606f\uff0c\u4f8b\u5982\u5206\u7ec4\u3001\u6309\u94ae\u540d\u79f0\u3001\u56de\u8c03\u51fd\u6570\u540d\u79f0\u7b49\uff0c pyAddin \u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u63d2\u4ef6\u6846\u67b6\uff0c\u5305\u542b\u4e86\u9884\u5b9a\u4e49\u7684\u83dc\u5355\u6309\u94ae\u53ca\u56de\u8c03\u51fd\u6570\u3002\u5f00\u53d1\u8005\u53ea\u9700\u5728\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\u4e2d\u586b\u5199\u5177\u4f53\u4e1a\u52a1\u4ee3\u7801\u5373\u53ef\u3002 \u8fde\u63a5VBA\u4e0ePython \u3002 pyAddin \u9884\u5b9a\u4e49\u4e86VBA\u4e0ePython\u4ea4\u4e92\u7684\u63a5\u53e3\u51fd\u6570\uff0cVBA\u8c03\u7528python\u811a\u672c\u6267\u884c\u4e3b\u8981\u4efb\u52a1\uff0c\u7136\u540e\u83b7\u53d6\u5176\u7ed3\u679c\u663e\u793a\u56deExcel\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u8bbe\u5b9aPython\u89e3\u91ca\u5668\u8def\u5f84\uff0c\u56e0\u6b64\u53ef\u4ee5\u5185\u7f6e\u4fbf\u643a\u5f0fPython\u4e0e\u63d2\u4ef6\u4e00\u8d77\u53d1\u5e03\u7ed9\u7528\u6237\uff0c\u8fd9\u6837\u4fbf\u4e0d\u4f9d\u8d56\u4e8e\u7528\u6237\u7cfb\u7edf\u914d\u7f6ePython\u5f00\u53d1\u73af\u5883\u4e0e\u5426\u3002 \u5b89\u88c5\u4e0e\u5378\u8f7d \u00b6 \u4ece pyAddin \u514b\u9686\u6216\u8005\u4e0b\u8f7d\u4ed3\u5e93\uff0c\u5728\u4ed3\u5e93\u6839\u76ee\u5f55\u4e0b\u6267\u884c\u5b89\u88c5\u547d\u4ee4\uff1a python setup.py install \u6216\u8005\u4ee5\u5f00\u53d1\u8005\u65b9\u5f0f\u5b89\u88c5\uff0c\u4fbf\u4e8e\u57fa\u4e8e\u5f53\u524d\u7248\u672c\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u5f00\u53d1\u548c\u4fee\u6539: python setup.py develop \u5b89\u88c5\u5b8c\u6210\u540e\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u6267\u884c pyAddin \u547d\u4ee4\u67e5\u770b\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\uff1a usage: pyaddin [-h] [-n NAME] [-v] {init,create,update} positional arguments: {init,create,update} init, create, update optional arguments: -h, --help show this help message and exit -n NAME, --name NAME addin file name to be created/updated: [name].xlam -v, --vba create VBA addin only, otherwise VBA-Python addin by default \u6700\u540e\u91c7\u7528 pip \u547d\u4ee4\u5378\u8f7d\u5373\u53ef\uff1a pip uninstall pyaddin \u4f7f\u7528\u65b9\u6cd5 \u00b6 \u5f00\u59cb\u4f7f\u7528\u4e4b\u524d\uff0c\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6main.cfg\u4e2d\u6307\u5b9aPython\u89e3\u91ca\u5668\u4f4d\u7f6e\u3002 # common line starts with # # set path for python interpreter # relative path is allowable [python] \\python\\python.exe # default folder name for outputs [output] outputs # standard output/error files name under [output] [stdout] output.log [stderr] errors.log \u5b9e\u9645\u53d1\u5e03\u65f6\u63a8\u8350\u4f7f\u7528\u4fbf\u643a\u5f0fPython\uff0c\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u6587\u4ef6\u4f53\u79ef\u3002 \u6ce8\u610f \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4fbf\u643a\u5f0fPython\u5e76\u672a\u9884\u7f6e pip \u3002\u5982\u679c\u9700\u8981\u5b89\u88c5\u7b2c\u4e09\u65b9\u5e93\uff0c\u53ef\u4ee5\u5148\u5b89\u88c5 pip \uff0c\u7136\u540e python -m pip install xxx \u5b89\u88c5\u9700\u8981\u7684\u5e93\u3002\u6700\u540e\u53d1\u5e03\u7ed9\u7528\u6237\u4f7f\u7528\u65f6\uff0c\u5220\u9664 pip \u4ee5\u51cf\u5c0f\u4f53\u79ef\uff0c\u4e14\u4e0d\u5f71\u54cd\u5df2\u7ecf\u5b89\u88c5\u7684\u5e93\u3002 \u5d4c\u5165\u5f0fPython : \u5982\u4f55\u5728U\u76d8\u5b89\u88c5\u7eff\u8272\u7248 Python 1. \u65b0\u5efa\u7a7a\u76ee\u5f55\uff0c\u521d\u59cb\u5316\u9879\u76ee \u00b6 D:\\GitHub\\PyAddin>mkdir examples D:\\GitHub\\PyAddin>cd examples D:\\GitHub\\PyAddin\\examples>pyaddin init \u5f53\u524d examples \u76ee\u5f55\u4e0b\u5c06\u4ea7\u751f\u4e00\u4e2aRibbon\u533a\u57df\u754c\u9762\u8bbe\u8ba1\u6587\u4ef6 CustomUI.xml \u3002 2. \u7f16\u8f91 CustomUI.xml \u00b6 Ribbon\u533a\u57df\u7531 CustomUI.xml \u5b9a\u4e49\uff0c\u672c\u6587\u793a\u4f8b\u5982\u4e0b\uff1a <!-- Add custom UI definition between <tabs> and </tabs>, e.g. <tab id=\"userRibbon\" label=\"PyAddin\"> <group id=\"group_about\" label=\"About\"> <button id=\"about\" imageMso=\"About\" size=\"large\" label=\"About\" onAction=\"callback_about\"/> </group> </tab> Please refer to the link below for detail: https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/aa338202(v%3doffice.12) --> <customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"> <ribbon startFromScratch=\"false\"> <tabs> <tab id=\"userRibbon\" label=\"PyAddin Test\"> <group id=\"g1\" label=\"GROUP_1\"> <button id=\"g1_b1\" imageMso=\"Calculator\" size=\"large\" label=\"Cal_division\" onAction=\"callback_cal\"/> <button id=\"g1_b2\" size=\"large\" label=\"Cal_multiply\" onAction=\"callback_mtp\"/> </group> <group id=\"g2\" label=\"HELP\"> <button id=\"g2_b1\" imageMso=\"About\" size=\"large\" label=\"About\" onAction=\"callback_about\"/> </group> </tab> </tabs> </ribbon> </customUI> \u8868\u793a\u521b\u5efa\u540d\u79f0\u4e3a PyAddin Test \u7684Ribbon\u5de5\u5177\u5361\uff0c\u5176\u4e2d\u5305\u542b\u4e24\u4e2a\u5206\u7ec4 GROUP_1 \u548c HELP \u3002\u7b2c\u4e00\u4e2a\u5206\u7ec4\u5b9a\u4e49\u4e86\u4e24\u4e2a\u6309\u94ae\uff0c\u5e76\u5206\u522b\u8bbe\u5b9a\u76f8\u5e94\u51fd\u6570\u4e3a callback_cal() \u548c callback_mtp() \u3002 3. \u521b\u5efa/\u66f4\u65b0\u63d2\u4ef6 \u00b6 D:\\GitHub\\PyAddin\\examples>pyaddin create --name my_first_addin \u5f53\u524d\u76ee\u5f55\u4e0b\u5c06\u521b\u5efaExcel\u63d2\u4ef6 my_first_addin.xlam \u53ca\u76f8\u5e94\u7684\u8f85\u52a9\u6587\u4ef6: main.py \u662fVBA\u4e0ePython\u4ea4\u4e92\u7684\u4e3b\u51fd\u6570\uff0c main.py \u5c06VBA\u8bf7\u6c42\u53d1\u9001\u5230\u5177\u4f53\u7684Python\u811a\u672c main.cfg \u4e3a\u63d2\u4ef6\u6a21\u677f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u81ea\u5b9a\u4e49Python\u89e3\u91ca\u5668\u7684\u8def\u5f84 scripts \u6587\u4ef6\u5939\u4f5c\u4e3a\u9ed8\u8ba4\u7684Python\u811a\u672c\u7684\u4fdd\u5b58\u4f4d\u7f6e \u63a5\u4e0b\u6765\u8f6c\u5165\u4e0b\u4e00\u6b65\u7684\u5177\u4f53\u4e1a\u52a1\u903b\u8f91\u7684\u5f00\u53d1\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u9700\u8981\u589e\u5220\u65b0\u7684\u529f\u80fd\u83dc\u5355\uff0c\u53ef\u4ee5\u56de\u5230\u7b2c\u4e8c\u6b65\u66f4\u65b0 CustomUI.xml \uff0c\u7136\u540e\u6267\u884c update \u547d\u4ee4\uff1a D:\\GitHub\\PyAddin\\examples>pyaddin update --name my_first_addin \u8fd9\u6837\u53ef\u4ee5\u5728\u4e0d\u5f71\u54cd\u539f\u6709\u4ee3\u7801\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u65b0\u6dfb\u52a0\u7684\u83dc\u5355\u56de\u8c03\u51fd\u6570\u6a21\u677f\u3002 4. \u5177\u4f53\u4e1a\u52a1\u903b\u8f91\u5f00\u53d1 \u00b6 \u4ee5\u8fdb\u884c\u9664\u6cd5\u8ba1\u7b97\u4e3a\u4f8b\uff1a\u5728\u5f53\u524d\u5de5\u4f5c\u8868 A1 \u3001 A2 \u5355\u5143\u683c\u8f93\u5165\u5185\u5bb9\uff0c\u6d4b\u8bd5 A1/A2 \u7684\u7ed3\u679c \u5728VBA\u6a21\u5757\u4e2d\u5b9a\u4e49\u56de\u8c03\u51fd\u6570 \u5728\u83dc\u5355\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528VBA\u5904\u7406\u6570\u636e\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u8c03\u7528Python\u811a\u672c\u5b8c\u6210\u5177\u4f53\u7684\u4e1a\u52a1\u3002 Sub callback_cal(control As IRibbonControl) ''' ' get value in cell A1, A2, then calculate A1/A2 in python ' ''' Dim a1$, a2$, args, res$ a1 = ActiveSheet.Range(\"A1\").Value a2 = ActiveSheet.Range(\"A2\").Value args = Array(a1, a2) If RunPython(\"scripts.test.division\", args, res) Then ActiveSheet.Range(\"A3\").Value = res Else MsgBox res End If End Sub \u5176\u4e2d RunPython() \u51fd\u6570\u8c03\u7528Python\u811a\u672c\u5904\u7406\u5177\u4f53\u4e8b\u52a1\uff0c\u51fd\u6570\u8bf4\u660e\u53c2\u8003\u63d2\u4ef6\u7684 general \u6a21\u5757\uff1a Function RunPython(method_name As String, args, ByRef res As String) As Boolean ''' ' :param method_name: a string refer to the called python method -> package.module.method ' :param args: array for python arguments ' :param res: python return string ' :returns: True if everything is OK else False ' ''' pass End Function \u5728 scripts \u6587\u4ef6\u5939\u4e0b\u521b\u5efapython\u811a\u672c \u4ece\u4e0a\u4e00\u6b65\u53ef\u4ee5\u770b\u51fa RunPython() \u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570 \"scripts.test.division\" \u6307\u660e\u4e86\u88ab\u8c03\u7528\u7684Python\u65b9\u6cd5\u2014\u2014 scripts \u5305\u4e0b\u7684 test.py \u6a21\u5757\u7684 dicision() \u65b9\u6cd5\uff0c\u56e0\u6b64\u5b9a\u4e49\u8be5\u65b9\u6cd5\u5982\u4e0b\uff1a # scripts/test.py def division(a, b): assert a!='', 'cell A1 is empty' assert b!='', 'cell A2 is empty' return float(a)/float(b)","title":"\u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#pythonexcelpyaddin","text":"\u53d1\u5e03\u4e8e\uff1a2019-01-28 | \u5206\u7c7b\uff1a process automation , python/vba/cpp \u867d\u7136VBA\u662fExcel\u7684\u5b98\u914d\u4e8c\u6b21\u5f00\u53d1\u8bed\u8a00\uff0c\u4f46\u9274\u4e8epython\u7684\u7b80\u6d01\u6613\u7528\u9ad8\u53ef\u7ef4\u62a4\u6027\uff0c\u76f8\u4fe1\u4e0d\u5c11\u4eba\u66f4\u503e\u5411\u4e8e\u4f7f\u7528python\u6765\u5904\u7406Excel\u76f8\u5173\u7684\u4e8c\u6b21\u5f00\u53d1\u5de5\u4f5c\u3002\u76ee\u524d\u5df2\u6709\u4e00\u4e9b\u4f18\u79c0\u7684python\u7b2c\u4e09\u65b9\u5e93\uff0c\u4f8b\u5982 xlrd \uff0c xlwt \u548c xlutils \uff0c\u53ef\u4ee5\u5206\u522b\u5b9e\u73b0Excel\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u548c\u8bfb\u5199\u8f6c\u6362\u5de5\u4f5c\uff1b\u5c24\u5176\u63a8\u8350 xlwings \uff0c\u53ef\u4ee5\u5982\u540cVBA\u4e00\u6837\u64cd\u4f5cExcel\u5de5\u4f5c\u7c3f\u3001\u5de5\u4f5c\u8868\u3001\u5355\u5143\u683c\u533a\u57df\u7b49\u3002\u8fd9\u4e9b\u5e93\u7684\u4e00\u4e2a\u5171\u540c\u7279\u5f81\u662f\u5b8c\u5168\u4e0d\u4f9d\u8d56\u4e8eExcel\u672c\u8eab\uff0c\u4ec5\u4ec5\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u5bf9\u8c61\u8fdb\u884c\u5904\u7406\u3002\u4f46\u6709\u65f6\u5019\uff0c\u6211\u4eec\u8fd8\u662f\u9650\u5b9a\u5728Excel\u73af\u5883\u4e0b\uff0c\u53ea\u662f\u5e0c\u671b\u501f\u52a9python\u800c\u4e0d\u662fVBA\u6765\u5904\u7406\u6570\u636e\u3002 \u672c\u6587\u4ecb\u7ecd\u4e00\u4e2a\u4f5c\u8005\u4ece\u5b9e\u9645\u9700\u6c42\u4e2d\u603b\u7ed3\u8bbe\u8ba1\u7684Excel\u63d2\u4ef6\u6a21\u677f\u8bbe\u8ba1\u5de5\u5177 pyAddin \uff0c\u5b9e\u73b0VBA\u63a7\u5236\u663e\u793a\u3001python\u9a71\u52a8\u8ba1\u7b97\u7684\u6548\u679c\u3002 https://github.com/dothinking/PyAddin","title":"\u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#_1","text":"\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u5229\u7528\u5f00\u7bc7\u63d0\u53ca\u7684python\u7b2c\u4e09\u65b9\u5e93\u8db3\u4ee5\u5c06\u4efb\u4f55\u7e41\u6742\u7684Excel\u6570\u636e\u5904\u7406\u5de5\u4f5c\u8f6c\u5316\u4e3apython\u7f16\u7a0b\u6765\u89e3\u51b3\u3002\u4f46\u5bf9\u4e8e\u67d0\u4e9b\u7528\u6237\uff0c\u4ed6\u4eec\u5df2\u7ecf\u4e60\u60ef\u4e8e\u5728Excel\u73af\u5883\u4e0b\u5f00\u5c55\u6570\u636e\u5904\u7406\u5de5\u4f5c\uff0c\u5e76\u4e14\u7cfb\u7edf\u901a\u5e38\u6ca1\u6709\u914d\u7f6e\u800c\u4ed6\u4eec\u5f80\u5f80\u4e5f\u4e0d\u60c5\u613f\u5b89\u88c5python\u5f00\u53d1\u73af\u5883\u3002\u6b64\u65f6\u5982\u4f55\u4f7f\u53cc\u65b9\u90fd\u8fbe\u5230\u8212\u9002\u7684\u72b6\u6001\u2014\u2014\u7528\u6237\u6109\u5feb\u5730\u5728Excel\u4e2d\u4f7f\u7528\u5f00\u53d1\u8005\u6109\u5feb\u5730\u7528python\u5b9e\u73b0\u7684\u529f\u80fd\uff1f \u8f85\u52a9\u5f00\u53d1\u8005\u8bbe\u8ba1Excel\u63d2\u4ef6 \u3002 \u6839\u636e\u5f00\u53d1\u8005\u63d0\u4f9b\u7684\u63d2\u4ef6Ribbon\u533a\u57df\u754c\u9762\u4fe1\u606f\uff0c\u4f8b\u5982\u5206\u7ec4\u3001\u6309\u94ae\u540d\u79f0\u3001\u56de\u8c03\u51fd\u6570\u540d\u79f0\u7b49\uff0c pyAddin \u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u63d2\u4ef6\u6846\u67b6\uff0c\u5305\u542b\u4e86\u9884\u5b9a\u4e49\u7684\u83dc\u5355\u6309\u94ae\u53ca\u56de\u8c03\u51fd\u6570\u3002\u5f00\u53d1\u8005\u53ea\u9700\u5728\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\u4e2d\u586b\u5199\u5177\u4f53\u4e1a\u52a1\u4ee3\u7801\u5373\u53ef\u3002 \u8fde\u63a5VBA\u4e0ePython \u3002 pyAddin \u9884\u5b9a\u4e49\u4e86VBA\u4e0ePython\u4ea4\u4e92\u7684\u63a5\u53e3\u51fd\u6570\uff0cVBA\u8c03\u7528python\u811a\u672c\u6267\u884c\u4e3b\u8981\u4efb\u52a1\uff0c\u7136\u540e\u83b7\u53d6\u5176\u7ed3\u679c\u663e\u793a\u56deExcel\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u8bbe\u5b9aPython\u89e3\u91ca\u5668\u8def\u5f84\uff0c\u56e0\u6b64\u53ef\u4ee5\u5185\u7f6e\u4fbf\u643a\u5f0fPython\u4e0e\u63d2\u4ef6\u4e00\u8d77\u53d1\u5e03\u7ed9\u7528\u6237\uff0c\u8fd9\u6837\u4fbf\u4e0d\u4f9d\u8d56\u4e8e\u7528\u6237\u7cfb\u7edf\u914d\u7f6ePython\u5f00\u53d1\u73af\u5883\u4e0e\u5426\u3002","title":"\u4e3b\u8981\u529f\u80fd"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#_2","text":"\u4ece pyAddin \u514b\u9686\u6216\u8005\u4e0b\u8f7d\u4ed3\u5e93\uff0c\u5728\u4ed3\u5e93\u6839\u76ee\u5f55\u4e0b\u6267\u884c\u5b89\u88c5\u547d\u4ee4\uff1a python setup.py install \u6216\u8005\u4ee5\u5f00\u53d1\u8005\u65b9\u5f0f\u5b89\u88c5\uff0c\u4fbf\u4e8e\u57fa\u4e8e\u5f53\u524d\u7248\u672c\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u5f00\u53d1\u548c\u4fee\u6539: python setup.py develop \u5b89\u88c5\u5b8c\u6210\u540e\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u6267\u884c pyAddin \u547d\u4ee4\u67e5\u770b\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\uff1a usage: pyaddin [-h] [-n NAME] [-v] {init,create,update} positional arguments: {init,create,update} init, create, update optional arguments: -h, --help show this help message and exit -n NAME, --name NAME addin file name to be created/updated: [name].xlam -v, --vba create VBA addin only, otherwise VBA-Python addin by default \u6700\u540e\u91c7\u7528 pip \u547d\u4ee4\u5378\u8f7d\u5373\u53ef\uff1a pip uninstall pyaddin","title":"\u5b89\u88c5\u4e0e\u5378\u8f7d"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#_3","text":"\u5f00\u59cb\u4f7f\u7528\u4e4b\u524d\uff0c\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6main.cfg\u4e2d\u6307\u5b9aPython\u89e3\u91ca\u5668\u4f4d\u7f6e\u3002 # common line starts with # # set path for python interpreter # relative path is allowable [python] \\python\\python.exe # default folder name for outputs [output] outputs # standard output/error files name under [output] [stdout] output.log [stderr] errors.log \u5b9e\u9645\u53d1\u5e03\u65f6\u63a8\u8350\u4f7f\u7528\u4fbf\u643a\u5f0fPython\uff0c\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u6587\u4ef6\u4f53\u79ef\u3002 \u6ce8\u610f \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4fbf\u643a\u5f0fPython\u5e76\u672a\u9884\u7f6e pip \u3002\u5982\u679c\u9700\u8981\u5b89\u88c5\u7b2c\u4e09\u65b9\u5e93\uff0c\u53ef\u4ee5\u5148\u5b89\u88c5 pip \uff0c\u7136\u540e python -m pip install xxx \u5b89\u88c5\u9700\u8981\u7684\u5e93\u3002\u6700\u540e\u53d1\u5e03\u7ed9\u7528\u6237\u4f7f\u7528\u65f6\uff0c\u5220\u9664 pip \u4ee5\u51cf\u5c0f\u4f53\u79ef\uff0c\u4e14\u4e0d\u5f71\u54cd\u5df2\u7ecf\u5b89\u88c5\u7684\u5e93\u3002 \u5d4c\u5165\u5f0fPython : \u5982\u4f55\u5728U\u76d8\u5b89\u88c5\u7eff\u8272\u7248 Python","title":"\u4f7f\u7528\u65b9\u6cd5"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#1","text":"D:\\GitHub\\PyAddin>mkdir examples D:\\GitHub\\PyAddin>cd examples D:\\GitHub\\PyAddin\\examples>pyaddin init \u5f53\u524d examples \u76ee\u5f55\u4e0b\u5c06\u4ea7\u751f\u4e00\u4e2aRibbon\u533a\u57df\u754c\u9762\u8bbe\u8ba1\u6587\u4ef6 CustomUI.xml \u3002","title":"1. \u65b0\u5efa\u7a7a\u76ee\u5f55\uff0c\u521d\u59cb\u5316\u9879\u76ee"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#2 customuixml","text":"Ribbon\u533a\u57df\u7531 CustomUI.xml \u5b9a\u4e49\uff0c\u672c\u6587\u793a\u4f8b\u5982\u4e0b\uff1a <!-- Add custom UI definition between <tabs> and </tabs>, e.g. <tab id=\"userRibbon\" label=\"PyAddin\"> <group id=\"group_about\" label=\"About\"> <button id=\"about\" imageMso=\"About\" size=\"large\" label=\"About\" onAction=\"callback_about\"/> </group> </tab> Please refer to the link below for detail: https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/aa338202(v%3doffice.12) --> <customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"> <ribbon startFromScratch=\"false\"> <tabs> <tab id=\"userRibbon\" label=\"PyAddin Test\"> <group id=\"g1\" label=\"GROUP_1\"> <button id=\"g1_b1\" imageMso=\"Calculator\" size=\"large\" label=\"Cal_division\" onAction=\"callback_cal\"/> <button id=\"g1_b2\" size=\"large\" label=\"Cal_multiply\" onAction=\"callback_mtp\"/> </group> <group id=\"g2\" label=\"HELP\"> <button id=\"g2_b1\" imageMso=\"About\" size=\"large\" label=\"About\" onAction=\"callback_about\"/> </group> </tab> </tabs> </ribbon> </customUI> \u8868\u793a\u521b\u5efa\u540d\u79f0\u4e3a PyAddin Test \u7684Ribbon\u5de5\u5177\u5361\uff0c\u5176\u4e2d\u5305\u542b\u4e24\u4e2a\u5206\u7ec4 GROUP_1 \u548c HELP \u3002\u7b2c\u4e00\u4e2a\u5206\u7ec4\u5b9a\u4e49\u4e86\u4e24\u4e2a\u6309\u94ae\uff0c\u5e76\u5206\u522b\u8bbe\u5b9a\u76f8\u5e94\u51fd\u6570\u4e3a callback_cal() \u548c callback_mtp() \u3002","title":"2. \u7f16\u8f91CustomUI.xml"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#3","text":"D:\\GitHub\\PyAddin\\examples>pyaddin create --name my_first_addin \u5f53\u524d\u76ee\u5f55\u4e0b\u5c06\u521b\u5efaExcel\u63d2\u4ef6 my_first_addin.xlam \u53ca\u76f8\u5e94\u7684\u8f85\u52a9\u6587\u4ef6: main.py \u662fVBA\u4e0ePython\u4ea4\u4e92\u7684\u4e3b\u51fd\u6570\uff0c main.py \u5c06VBA\u8bf7\u6c42\u53d1\u9001\u5230\u5177\u4f53\u7684Python\u811a\u672c main.cfg \u4e3a\u63d2\u4ef6\u6a21\u677f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u81ea\u5b9a\u4e49Python\u89e3\u91ca\u5668\u7684\u8def\u5f84 scripts \u6587\u4ef6\u5939\u4f5c\u4e3a\u9ed8\u8ba4\u7684Python\u811a\u672c\u7684\u4fdd\u5b58\u4f4d\u7f6e \u63a5\u4e0b\u6765\u8f6c\u5165\u4e0b\u4e00\u6b65\u7684\u5177\u4f53\u4e1a\u52a1\u903b\u8f91\u7684\u5f00\u53d1\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u9700\u8981\u589e\u5220\u65b0\u7684\u529f\u80fd\u83dc\u5355\uff0c\u53ef\u4ee5\u56de\u5230\u7b2c\u4e8c\u6b65\u66f4\u65b0 CustomUI.xml \uff0c\u7136\u540e\u6267\u884c update \u547d\u4ee4\uff1a D:\\GitHub\\PyAddin\\examples>pyaddin update --name my_first_addin \u8fd9\u6837\u53ef\u4ee5\u5728\u4e0d\u5f71\u54cd\u539f\u6709\u4ee3\u7801\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u65b0\u6dfb\u52a0\u7684\u83dc\u5355\u56de\u8c03\u51fd\u6570\u6a21\u677f\u3002","title":"3. \u521b\u5efa/\u66f4\u65b0\u63d2\u4ef6"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#4","text":"\u4ee5\u8fdb\u884c\u9664\u6cd5\u8ba1\u7b97\u4e3a\u4f8b\uff1a\u5728\u5f53\u524d\u5de5\u4f5c\u8868 A1 \u3001 A2 \u5355\u5143\u683c\u8f93\u5165\u5185\u5bb9\uff0c\u6d4b\u8bd5 A1/A2 \u7684\u7ed3\u679c \u5728VBA\u6a21\u5757\u4e2d\u5b9a\u4e49\u56de\u8c03\u51fd\u6570 \u5728\u83dc\u5355\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528VBA\u5904\u7406\u6570\u636e\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u8c03\u7528Python\u811a\u672c\u5b8c\u6210\u5177\u4f53\u7684\u4e1a\u52a1\u3002 Sub callback_cal(control As IRibbonControl) ''' ' get value in cell A1, A2, then calculate A1/A2 in python ' ''' Dim a1$, a2$, args, res$ a1 = ActiveSheet.Range(\"A1\").Value a2 = ActiveSheet.Range(\"A2\").Value args = Array(a1, a2) If RunPython(\"scripts.test.division\", args, res) Then ActiveSheet.Range(\"A3\").Value = res Else MsgBox res End If End Sub \u5176\u4e2d RunPython() \u51fd\u6570\u8c03\u7528Python\u811a\u672c\u5904\u7406\u5177\u4f53\u4e8b\u52a1\uff0c\u51fd\u6570\u8bf4\u660e\u53c2\u8003\u63d2\u4ef6\u7684 general \u6a21\u5757\uff1a Function RunPython(method_name As String, args, ByRef res As String) As Boolean ''' ' :param method_name: a string refer to the called python method -> package.module.method ' :param args: array for python arguments ' :param res: python return string ' :returns: True if everything is OK else False ' ''' pass End Function \u5728 scripts \u6587\u4ef6\u5939\u4e0b\u521b\u5efapython\u811a\u672c \u4ece\u4e0a\u4e00\u6b65\u53ef\u4ee5\u770b\u51fa RunPython() \u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570 \"scripts.test.division\" \u6307\u660e\u4e86\u88ab\u8c03\u7528\u7684Python\u65b9\u6cd5\u2014\u2014 scripts \u5305\u4e0b\u7684 test.py \u6a21\u5757\u7684 dicision() \u65b9\u6cd5\uff0c\u56e0\u6b64\u5b9a\u4e49\u8be5\u65b9\u6cd5\u5982\u4e0b\uff1a # scripts/test.py def division(a, b): assert a!='', 'cell A1 is empty' assert b!='', 'cell A2 is empty' return float(a)/float(b)","title":"4. \u5177\u4f53\u4e1a\u52a1\u903b\u8f91\u5f00\u53d1"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/","text":"\u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-01-28 | \u5206\u7c7b\uff1a process automation , python/vba/cpp PyAddin \u662f\u4e00\u4e2aExcel\u63d2\u4ef6\u6a21\u677f\uff0c\u65b9\u4fbf\u5728VBA\u4e2d\u8c03\u7528Python\u811a\u672c\u5904\u7406\u4e3b\u8981\u4e1a\u52a1\u3002 \u524d\u6587 \u4ecb\u7ecd\u4e86 PyAddin \u7684\u57fa\u672c\u7528\u6cd5\uff0c\u672c\u6587\u7b80\u8981\u8bf4\u660e\u8bbe\u8ba1\u601d\u8def\u53ca\u5176\u5b9e\u73b0\u3002 \u57fa\u672c\u539f\u7406 \u00b6 1. \u81ea\u5b9a\u4e49\u63d2\u4ef6Ribbon\u754c\u9762 \u00b6 Excel2007\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u5404\u7c7bExcel\u6587\u4ef6\uff0c\u5305\u62ec\u63d2\u4ef6 *.xlam \u5b9e\u9645\u4e0a\u90fd\u662f XML \u683c\u5f0f\u7ec4\u7ec7\u7684\u538b\u7f29\u6587\u4ef6\uff0c\u5176\u4e2d CustomUI.xml \u5b9a\u4e49\u4e86\u63d2\u4ef6Ribbon\u533a\u57df\u7684\u754c\u9762\u5f62\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u7a0b\u5e8f\u5316\u751f\u6210\u6b64\u6587\u4ef6\u6765\u5b9e\u73b0\u63d2\u4ef6UI\u7684\u81ea\u52a8\u5316\u521b\u5efa\u548c\u66f4\u65b0\u3002 CustomUI.xml \u6587\u4ef6\u7ed3\u6784\u53ca\u5229\u7528\u8be5\u7ed3\u6784\u521b\u5efa\u63d2\u4ef6\u7684\u65b9\u6cd5\u53ef\u4ee5\u53c2\u8003\uff1a Customizing the 2007 Office Fluent Ribbon for Developers Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML 2. Python\u81ea\u5b9a\u4e49VBA\u6a21\u5757 \u00b6 \u521b\u5efaExcel\u63d2\u4ef6\u9700\u8981\u7684\u53e6\u4e00\u4e2a\u81ea\u52a8\u5316\u64cd\u4f5c\u662f\u751f\u6210\u9ed8\u8ba4\u7684\u83dc\u5355\u6309\u94ae\u56de\u8c03\u51fd\u6570\uff0c\u4e5f\u5c31\u662fPython\u64cd\u4f5cExcel VBA\u7684\u95ee\u9898\u3002\u8fd9\u91cc\u91c7\u7528Python\u7b2c\u4e09\u65b9\u5e93 pywin32 \u6765\u5b9e\u73b0\uff0c\u5177\u4f53\u7684\u64cd\u4f5c\u51fd\u6570\u4e0eVBA\u7c7b\u4f3c\u3002\u53c2\u8003\u94fe\u63a5\uff1a VBProject\uff1a\u4ee3\u7801\u64cd\u4f5c\u4ee3\u7801\u4e4b\u5e38\u7528\u8bed\u53e5 3. VBA\u4e0ePython\u4ea4\u4e92 \u00b6 VBA\u901a\u8fc7\u547d\u4ee4\u884c\u6267\u884cpython\u811a\u672c\u5904\u7406\u4e3b\u8981\u4efb\u52a1\uff0c\u7136\u540e\u83b7\u53d6python\u8fd4\u56de\u503c\u7528\u4e8e\u663e\u793a\u3002 +-------+ python main.py arg1 arg2 ... +----------+ | VBA +-------------------------------->+ python | +---^---+ +-----+----+ | +----------------+ | | | output.log | | +-----------+ errors.log <--------------+ +----------------+ RunPython() \u00b6 RunPython() \u662f\u81ea\u5b9a\u4e49\u7684VBA\u51fd\u6570\uff0c\u4f7f\u7528 CreateObject(\"WScript.Shell\").run() \u8c03\u7528\u6307\u5b9a\u7684python\u811a\u672c\u3002\u76f8\u6bd4 exec() \u7684\u4f18\u52bf\u662f\u4e0d\u663e\u793a\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u4e0d\u8db3\u4e4b\u5904\u662f\u65e0\u6cd5\u76f4\u63a5\u83b7\u53d6python\u811a\u672c\u7684\u6267\u884c\u7ed3\u679c\uff0c\u6240\u4ee5\u8003\u8651\u95f4\u63a5\u5730\u4ece\u4e2d\u95f4\u6587\u4ef6\u8bfb\u53d6\u3002 Function RunPython(method_name As String, args, ByRef res As String) As Boolean ''' ' run python script ' :param method_name: a string refer to the called python method -> package.module.method ' :param args: array for python arguments ' :param res: python return string ' :returns: True if everything is OK else False ' ''' Dim oShell As Object, cmd As String, str_args As String Dim log_output As String, log_errors As String, errs As String ' TEMP_PATH = addin_path/temp/ log_output = TEMP_PATH & \"output.log\" log_errors = TEMP_PATH & \"errors.log\" ' join command python = \"\"\"\" & ThisWorkbook.Path & \"\\python\\python\"\" \" main = \"\"\"\" & ThisWorkbook.Path & \"\\main.py\"\" \" For i = LBound(args) To UBound(args) str_args = str_args & \" \"\"\" & args(i) & \"\"\"\" Next cmd = python & main & method_name & str_args ' execute command Set oShell = CreateObject(\"WScript.Shell\") oShell.Run cmd, 0, 1 ' results errs = ReadTextFile(log_errors) ' user defined function If errs = \"\" Then RunPython = True res = ReadTextFile(log_output) Else: RunPython = False res = errs End If Set oShell = Nothing ' clean object ' remove log file If Dir(log_errors, 16) <> Empty Then Kill log_output Kill log_errors End If End Function method_name \u6307\u5b9a\u4e86\u9700\u8981\u8c03\u7528\u7684python\u811a\u672c\uff0c\u57fa\u672c\u89c4\u5219\u4e3a package.module.method \uff0c\u4f8b\u5982 scripts.test.test_fun \u6307\u7684\u662f\u63d2\u4ef6\u4e3b\u76ee\u5f55\u4e0b scripts/test.py \u4e2d\u5b9a\u4e49\u7684 test_fun() \u65b9\u6cd5 args \u662fVBA\u6570\u7ec4\uff0c\u5c06\u5176\u6bcf\u4e2a\u5143\u7d20\u6700\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u88ab\u8c03\u7528\u7684python\u811a\u672c res \u662fpython\u811a\u672c\u7684\u8fd4\u56de\u4fe1\u606f\uff0c\u5982\u679c RunPython \u4e3aTrue\uff0c\u5219\u4e3a\u8fd4\u56de\u503c\uff1b\u5426\u5219\u4e3a\u9519\u8bef\u4fe1\u606f main.py \u00b6 main.py \u662f RunPython \u76f4\u63a5\u8c03\u7528\u7684\u51fd\u6570\uff0c\u5b83\u6839\u636e\u4f20\u5165\u7684\u65b9\u6cd5\u540d\u79f0\u53c2\u6570 method_name \u8c03\u7528\u76f8\u5e94\u7684\u7528\u6237\u81ea\u5b9a\u4e49python\u811a\u672c\u3002\u4e3a\u4e86\u4f7fVBA\u4e3b\u8c03\u51fd\u6570\u80fd\u591f\u83b7\u53d6\u5230python\u811a\u672c\u7684\u8fd4\u56de\u503c\uff0c\u9700\u8981\u5c06\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002 main.py \u7684\u4e3b\u51fd\u6570\u5982\u4e0b\uff1a \u9996\u5148\u91cd\u5b9a\u5411\u6807\u51c6\u8f93\u51fa/\u9519\u8bef\uff1a\u6b63\u5e38\u8fd4\u56de\u91cd\u5b9a\u5411\u5230 output.log \uff0c\u9519\u8bef\u4fe1\u606f\u91cd\u5b9a\u5411\u5230 errors.log \u7136\u540e\u52a8\u6001\u8c03\u7528\u6307\u5b9a\u7684python\u811a\u672c\uff0c\u5e76\u4f20\u5165\u53c2\u6570 if __name__ == '__main__': # redirect output/error to output.log/errors.log sys.stdout = Logger(os.path.join(main_path, 'temp', \"output.log\"), sys.stdout) sys.stderr = Logger(os.path.join(main_path, 'temp', \"errors.log\"), sys.stderr) # python main.py package.module.method *args run_python_method(sys.argv[1], *sys.argv[2:]) \u91cd\u5b9a\u5411\u6807\u51c6\u8f93\u51fa/\u9519\u8bef \u00b6 class Logger(object): '''redirect standard output/error to files, which are bridges for communication between python and VBA ''' def __init__(self, log_file=\"out.log\", terminal=sys.stdout): self.terminal = terminal self.log = open(log_file, \"w\") def write(self, message): self.terminal.write(message) self.log.write(message) def flush(self): pass \u5c06\u6b64\u7c7b\u5b9e\u4f8b\u8d4b\u503c\u7ed9 sys.stdout \u548c sys.stderr \uff0c\u5373\u53ef\u5728\u6807\u51c6\u8f93\u51fa/\u9519\u8bef\u7684\u57fa\u7840\u4e0a\uff0c\u540c\u65f6\u91cd\u5b9a\u5411\u7ed3\u679c\u5230\u6307\u5b9a\u6587\u4ef6\u3002\u524d\u8005\u65b9\u4fbf\u8c03\u8bd5\u65f6\u67e5\u770b\u4fe1\u606f\uff0c\u540e\u8005\u4fbf\u4e8eVBA\u4e3b\u8c03\u51fd\u6570\u83b7\u53d6\u8fd4\u56de\u503c\u3002 \u91cd\u5b9a\u5411\u51fd\u6570\u8fd4\u56de\u503c \u00b6 \u5b9a\u4e49\u4e00\u4e2a\u88c5\u9970\u5668\u51fd\u6570 redirect() \u5bf9\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff08\u6b63\u5e38\u8fd4\u56de/\u5f02\u5e38\u6355\u83b7\uff09\u8fdb\u884c\u91cd\u5b9a\u5411\u8f93\u51fa\u3002 def redirect(fun): '''decorator for user defined function called by VBA''' def wrapper(*args, **kwargs): res = None try: res = fun(*args, **kwargs) except Exception as e: sys.stderr.write(str(e)) else: if res: sys.stdout.write(str(res)) return res return wrapper \u52a8\u6001\u8c03\u7528\u6307\u5b9a\u51fd\u6570 \u00b6 @redirect def run_python_method(key, *args): '''call method specified by key with arguments: args ''' *modules_name, method_name = key.split('.') module_file = os.path.join(main_path, '{0}.py'.format('/'.join(modules_name))) # import module dynamically if exists module_path = '.'.join(modules_name) assert os.path.exists(module_file), 'Error Python module \"{0}\"'.format(module_path) module = __import__(module_path, fromlist=True) # import method if exists assert hasattr(module, method_name), 'Error Python method \"{0}\"'.format(method_name) fun = getattr(module, method_name) return fun(*args) __import__() \u6839\u636e\u5b57\u7b26\u4e32\u8def\u5f84\u5bfc\u5165\u6a21\u5757\uff0c\u6ce8\u610f\u8bbe\u7f6e fromlist=True \u4ee5\u5bfc\u5165\u591a\u5c42\u6b21\u7684\u6a21\u5757\uff0c\u4f8b\u5982 package.module hasattr() \u548c getattr() \u5224\u65ad\u6a21\u5757\u4e2d\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7684\u65b9\u6cd5\uff0c\u5b58\u5728\u5219\u8c03\u7528\u8be5\u65b9\u6cd5","title":"\u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#pythonexcelpyaddin","text":"\u53d1\u5e03\u4e8e\uff1a2019-01-28 | \u5206\u7c7b\uff1a process automation , python/vba/cpp PyAddin \u662f\u4e00\u4e2aExcel\u63d2\u4ef6\u6a21\u677f\uff0c\u65b9\u4fbf\u5728VBA\u4e2d\u8c03\u7528Python\u811a\u672c\u5904\u7406\u4e3b\u8981\u4e1a\u52a1\u3002 \u524d\u6587 \u4ecb\u7ecd\u4e86 PyAddin \u7684\u57fa\u672c\u7528\u6cd5\uff0c\u672c\u6587\u7b80\u8981\u8bf4\u660e\u8bbe\u8ba1\u601d\u8def\u53ca\u5176\u5b9e\u73b0\u3002","title":"\u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#_1","text":"","title":"\u57fa\u672c\u539f\u7406"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#1 ribbon","text":"Excel2007\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u5404\u7c7bExcel\u6587\u4ef6\uff0c\u5305\u62ec\u63d2\u4ef6 *.xlam \u5b9e\u9645\u4e0a\u90fd\u662f XML \u683c\u5f0f\u7ec4\u7ec7\u7684\u538b\u7f29\u6587\u4ef6\uff0c\u5176\u4e2d CustomUI.xml \u5b9a\u4e49\u4e86\u63d2\u4ef6Ribbon\u533a\u57df\u7684\u754c\u9762\u5f62\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u7a0b\u5e8f\u5316\u751f\u6210\u6b64\u6587\u4ef6\u6765\u5b9e\u73b0\u63d2\u4ef6UI\u7684\u81ea\u52a8\u5316\u521b\u5efa\u548c\u66f4\u65b0\u3002 CustomUI.xml \u6587\u4ef6\u7ed3\u6784\u53ca\u5229\u7528\u8be5\u7ed3\u6784\u521b\u5efa\u63d2\u4ef6\u7684\u65b9\u6cd5\u53ef\u4ee5\u53c2\u8003\uff1a Customizing the 2007 Office Fluent Ribbon for Developers Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML","title":"1. \u81ea\u5b9a\u4e49\u63d2\u4ef6Ribbon\u754c\u9762"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#2 pythonvba","text":"\u521b\u5efaExcel\u63d2\u4ef6\u9700\u8981\u7684\u53e6\u4e00\u4e2a\u81ea\u52a8\u5316\u64cd\u4f5c\u662f\u751f\u6210\u9ed8\u8ba4\u7684\u83dc\u5355\u6309\u94ae\u56de\u8c03\u51fd\u6570\uff0c\u4e5f\u5c31\u662fPython\u64cd\u4f5cExcel VBA\u7684\u95ee\u9898\u3002\u8fd9\u91cc\u91c7\u7528Python\u7b2c\u4e09\u65b9\u5e93 pywin32 \u6765\u5b9e\u73b0\uff0c\u5177\u4f53\u7684\u64cd\u4f5c\u51fd\u6570\u4e0eVBA\u7c7b\u4f3c\u3002\u53c2\u8003\u94fe\u63a5\uff1a VBProject\uff1a\u4ee3\u7801\u64cd\u4f5c\u4ee3\u7801\u4e4b\u5e38\u7528\u8bed\u53e5","title":"2. Python\u81ea\u5b9a\u4e49VBA\u6a21\u5757"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#3 vbapython","text":"VBA\u901a\u8fc7\u547d\u4ee4\u884c\u6267\u884cpython\u811a\u672c\u5904\u7406\u4e3b\u8981\u4efb\u52a1\uff0c\u7136\u540e\u83b7\u53d6python\u8fd4\u56de\u503c\u7528\u4e8e\u663e\u793a\u3002 +-------+ python main.py arg1 arg2 ... +----------+ | VBA +-------------------------------->+ python | +---^---+ +-----+----+ | +----------------+ | | | output.log | | +-----------+ errors.log <--------------+ +----------------+","title":"3. VBA\u4e0ePython\u4ea4\u4e92"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#runpython","text":"RunPython() \u662f\u81ea\u5b9a\u4e49\u7684VBA\u51fd\u6570\uff0c\u4f7f\u7528 CreateObject(\"WScript.Shell\").run() \u8c03\u7528\u6307\u5b9a\u7684python\u811a\u672c\u3002\u76f8\u6bd4 exec() \u7684\u4f18\u52bf\u662f\u4e0d\u663e\u793a\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u4e0d\u8db3\u4e4b\u5904\u662f\u65e0\u6cd5\u76f4\u63a5\u83b7\u53d6python\u811a\u672c\u7684\u6267\u884c\u7ed3\u679c\uff0c\u6240\u4ee5\u8003\u8651\u95f4\u63a5\u5730\u4ece\u4e2d\u95f4\u6587\u4ef6\u8bfb\u53d6\u3002 Function RunPython(method_name As String, args, ByRef res As String) As Boolean ''' ' run python script ' :param method_name: a string refer to the called python method -> package.module.method ' :param args: array for python arguments ' :param res: python return string ' :returns: True if everything is OK else False ' ''' Dim oShell As Object, cmd As String, str_args As String Dim log_output As String, log_errors As String, errs As String ' TEMP_PATH = addin_path/temp/ log_output = TEMP_PATH & \"output.log\" log_errors = TEMP_PATH & \"errors.log\" ' join command python = \"\"\"\" & ThisWorkbook.Path & \"\\python\\python\"\" \" main = \"\"\"\" & ThisWorkbook.Path & \"\\main.py\"\" \" For i = LBound(args) To UBound(args) str_args = str_args & \" \"\"\" & args(i) & \"\"\"\" Next cmd = python & main & method_name & str_args ' execute command Set oShell = CreateObject(\"WScript.Shell\") oShell.Run cmd, 0, 1 ' results errs = ReadTextFile(log_errors) ' user defined function If errs = \"\" Then RunPython = True res = ReadTextFile(log_output) Else: RunPython = False res = errs End If Set oShell = Nothing ' clean object ' remove log file If Dir(log_errors, 16) <> Empty Then Kill log_output Kill log_errors End If End Function method_name \u6307\u5b9a\u4e86\u9700\u8981\u8c03\u7528\u7684python\u811a\u672c\uff0c\u57fa\u672c\u89c4\u5219\u4e3a package.module.method \uff0c\u4f8b\u5982 scripts.test.test_fun \u6307\u7684\u662f\u63d2\u4ef6\u4e3b\u76ee\u5f55\u4e0b scripts/test.py \u4e2d\u5b9a\u4e49\u7684 test_fun() \u65b9\u6cd5 args \u662fVBA\u6570\u7ec4\uff0c\u5c06\u5176\u6bcf\u4e2a\u5143\u7d20\u6700\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u88ab\u8c03\u7528\u7684python\u811a\u672c res \u662fpython\u811a\u672c\u7684\u8fd4\u56de\u4fe1\u606f\uff0c\u5982\u679c RunPython \u4e3aTrue\uff0c\u5219\u4e3a\u8fd4\u56de\u503c\uff1b\u5426\u5219\u4e3a\u9519\u8bef\u4fe1\u606f","title":"RunPython()"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#mainpy","text":"main.py \u662f RunPython \u76f4\u63a5\u8c03\u7528\u7684\u51fd\u6570\uff0c\u5b83\u6839\u636e\u4f20\u5165\u7684\u65b9\u6cd5\u540d\u79f0\u53c2\u6570 method_name \u8c03\u7528\u76f8\u5e94\u7684\u7528\u6237\u81ea\u5b9a\u4e49python\u811a\u672c\u3002\u4e3a\u4e86\u4f7fVBA\u4e3b\u8c03\u51fd\u6570\u80fd\u591f\u83b7\u53d6\u5230python\u811a\u672c\u7684\u8fd4\u56de\u503c\uff0c\u9700\u8981\u5c06\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002 main.py \u7684\u4e3b\u51fd\u6570\u5982\u4e0b\uff1a \u9996\u5148\u91cd\u5b9a\u5411\u6807\u51c6\u8f93\u51fa/\u9519\u8bef\uff1a\u6b63\u5e38\u8fd4\u56de\u91cd\u5b9a\u5411\u5230 output.log \uff0c\u9519\u8bef\u4fe1\u606f\u91cd\u5b9a\u5411\u5230 errors.log \u7136\u540e\u52a8\u6001\u8c03\u7528\u6307\u5b9a\u7684python\u811a\u672c\uff0c\u5e76\u4f20\u5165\u53c2\u6570 if __name__ == '__main__': # redirect output/error to output.log/errors.log sys.stdout = Logger(os.path.join(main_path, 'temp', \"output.log\"), sys.stdout) sys.stderr = Logger(os.path.join(main_path, 'temp', \"errors.log\"), sys.stderr) # python main.py package.module.method *args run_python_method(sys.argv[1], *sys.argv[2:])","title":"main.py"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#_2","text":"class Logger(object): '''redirect standard output/error to files, which are bridges for communication between python and VBA ''' def __init__(self, log_file=\"out.log\", terminal=sys.stdout): self.terminal = terminal self.log = open(log_file, \"w\") def write(self, message): self.terminal.write(message) self.log.write(message) def flush(self): pass \u5c06\u6b64\u7c7b\u5b9e\u4f8b\u8d4b\u503c\u7ed9 sys.stdout \u548c sys.stderr \uff0c\u5373\u53ef\u5728\u6807\u51c6\u8f93\u51fa/\u9519\u8bef\u7684\u57fa\u7840\u4e0a\uff0c\u540c\u65f6\u91cd\u5b9a\u5411\u7ed3\u679c\u5230\u6307\u5b9a\u6587\u4ef6\u3002\u524d\u8005\u65b9\u4fbf\u8c03\u8bd5\u65f6\u67e5\u770b\u4fe1\u606f\uff0c\u540e\u8005\u4fbf\u4e8eVBA\u4e3b\u8c03\u51fd\u6570\u83b7\u53d6\u8fd4\u56de\u503c\u3002","title":"\u91cd\u5b9a\u5411\u6807\u51c6\u8f93\u51fa/\u9519\u8bef"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#_3","text":"\u5b9a\u4e49\u4e00\u4e2a\u88c5\u9970\u5668\u51fd\u6570 redirect() \u5bf9\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff08\u6b63\u5e38\u8fd4\u56de/\u5f02\u5e38\u6355\u83b7\uff09\u8fdb\u884c\u91cd\u5b9a\u5411\u8f93\u51fa\u3002 def redirect(fun): '''decorator for user defined function called by VBA''' def wrapper(*args, **kwargs): res = None try: res = fun(*args, **kwargs) except Exception as e: sys.stderr.write(str(e)) else: if res: sys.stdout.write(str(res)) return res return wrapper","title":"\u91cd\u5b9a\u5411\u51fd\u6570\u8fd4\u56de\u503c"},{"location":"2019-01-28-%E9%9B%86%E6%88%90python%E7%9A%84Excel%E6%8F%92%E4%BB%B6%E6%A8%A1%E6%9D%BFPyAddin%EF%BC%9A%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D/#_4","text":"@redirect def run_python_method(key, *args): '''call method specified by key with arguments: args ''' *modules_name, method_name = key.split('.') module_file = os.path.join(main_path, '{0}.py'.format('/'.join(modules_name))) # import module dynamically if exists module_path = '.'.join(modules_name) assert os.path.exists(module_file), 'Error Python module \"{0}\"'.format(module_path) module = __import__(module_path, fromlist=True) # import method if exists assert hasattr(module, method_name), 'Error Python method \"{0}\"'.format(method_name) fun = getattr(module, method_name) return fun(*args) __import__() \u6839\u636e\u5b57\u7b26\u4e32\u8def\u5f84\u5bfc\u5165\u6a21\u5757\uff0c\u6ce8\u610f\u8bbe\u7f6e fromlist=True \u4ee5\u5bfc\u5165\u591a\u5c42\u6b21\u7684\u6a21\u5757\uff0c\u4f8b\u5982 package.module hasattr() \u548c getattr() \u5224\u65ad\u6a21\u5757\u4e2d\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7684\u65b9\u6cd5\uff0c\u5b58\u5728\u5219\u8c03\u7528\u8be5\u65b9\u6cd5","title":"\u52a8\u6001\u8c03\u7528\u6307\u5b9a\u51fd\u6570"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/","text":"PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-03-24 | \u5206\u7c7b\uff1a python/vba/cpp \u6211\u4eec\u901a\u5e38\u4f7f\u7528\u6587\u4ef6\u5939\u7ed3\u6784\u6765\u5206\u7c7b\u7ba1\u7406\u6587\u6863/\u4e2a\u4eba\u77e5\u8bc6\uff0c\u4f46\u5355\u4e00\u7684\u76ee\u5f55\u7ed3\u6784\u96be\u4ee5\u6709\u6548\u7ec4\u7ec7\u5177\u6709\u4ea4\u53c9\u5173\u7cfb\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u4ee5\u7535\u5f71\u7c7b\u578b\u4f8b\u5982\u79d1\u5e7b\u7247\u3001\u6218\u4e89\u7247\u3001\u5267\u60c5\u7247\u6765\u547d\u540d\u5206\u7c7b\u6587\u4ef6\u5939\u662f\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\uff0c\u4f46\u540c\u65f6\u6211\u4eec\u5f88\u53ef\u80fd\u5e0c\u671b\u5c06\u540c\u4e00\u5bfc\u6f14/\u6f14\u5458\u7684\u4f5c\u54c1\u7ec4\u7ec7\u5728\u4e00\u8d77\uff0c\u4e8e\u662f\u4e0d\u5f97\u4e0d\u6309\u7167\u8fd9\u4e2a\u6807\u51c6\u91cd\u65b0\u5efa\u7acb\u5206\u7c7b\u6587\u4ef6\u5939\uff0c\u5e76\u4e14\u9700\u8981\u91cd\u590d\u590d\u5236\u6587\u6863\u3002 \u9488\u5bf9\u6b64\u7c7b\u95ee\u9898\uff0c\u8003\u8651 \u4ee5\u865a\u62df\u7684\u76ee\u5f55\u7ed3\u6784\u548c\u6807\u7b7e\u6765\u7ba1\u7406\u786c\u76d8\u4e0a\u5b9e\u9645\u5b58\u50a8\u7684\u6587\u6863 \uff08\u6587\u672c/\u591a\u5a92\u4f53\uff09\u3002\u4f5c\u8005\u8fd1\u671f\u6b63\u5728\u5b66\u4e60 Qt \u76f8\u5173\u77e5\u8bc6\uff0c\u4e8e\u662f\u6b63\u597d\u4f5c\u4e3a PyQt5 \u7684\u4e00\u4e2a\u5e94\u7528\u5b9e\u8df5\u2014\u2014\u8fd9\u4fbf\u662f\u672c\u6587\u4ecb\u7ecd\u7684\u5bf9\u8c61 Tagit \u3002\u533a\u522b\u4e8e\u7b14\u8bb0\u7c7b\u5e94\u7528\uff0c Tagit \u5e76\u4e0d\u521b\u5efa\u548c\u7f16\u8f91\u6587\u6863\u5b9e\u4f53\uff0c\u800c\u662f\u4fa7\u91cd\u4ee5\u903b\u8f91\u5206\u7c7b\u548c\u6807\u7b7e\u6765\u7ba1\u7406\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u6863\uff1b\u5b83\u66f4\u503e\u5411\u4e8e\u6587\u732e\u7ba1\u7406\u7c7b\u8f6f\u4ef6\uff0c\u4f46\u4e0d\u6d89\u53ca\u6587\u732e\u683c\u5f0f\u65b9\u9762\u7684\u529f\u80fd\uff0c\u800c\u662f\u7740\u91cd\u4e8e\u5206\u7c7b\u7ec4\u7ec7\u7684\u80fd\u529b\u3002 \u672c\u6587\u7b80\u8981\u4ecb\u7ecd Tagit \u7684\u4e3b\u8981\u529f\u80fd\u53ca\u5176\u5b9e\u73b0\u6240\u5bf9\u5e94\u7684 Qt \u57fa\u7840\u77e5\u8bc6\u3002 https://github.com/dothinking/Tagit \u4e3b\u8981\u7279\u5f81 \u00b6 \u5206\u7c7b \u3001 \u6807\u7b7e \u548c \u6761\u76ee \u662f Tagit \u7684\u4e3b\u8981\u5bf9\u8c61\u3002\u6761\u76ee\u662f Tagit \u4e2d\u865a\u62df\u7684\u6587\u6863\u8bb0\u5f55\uff0c\u4e0e\u771f\u5b9e\u7684\u6e90\u6587\u6863\u4e00\u4e00\u5bf9\u5e94\uff1b\u5206\u7c7b\u662f\u865a\u62df\u7684\u76ee\u5f55\u5c42\u6b21\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u8fdb\u884c\u81ea\u5b9a\u4e49\uff0c\u7c7b\u6bd4\u4e3a\u6587\u4ef6\u5939/\u76ee\u5f55\uff1b\u6807\u7b7e\u662f\u5bf9\u6761\u76ee\uff08\u6620\u5c04\u771f\u5b9e\u6587\u6863\uff09\u5185\u5bb9\u7684\u6807\u8bb0\uff0c\u4e00\u4e2a\u6761\u76ee\u53ef\u4ee5\u6253\u4e0a\u4efb\u610f\u7684\u6807\u7b7e\u3002 \u5206\u7c7b\u7ba1\u7406\uff08Group\uff09 \u652f\u6301\u65e0\u9650\u7ea7\u5206\u7c7b \u521b\u5efa/\u4fee\u6539/\u5220\u9664 \u5206\u7c7b\u4e0b\u6761\u76ee\u6570\u91cf\u7edf\u8ba1 \u6807\u7b7e\u7ba1\u7406\uff08Tag\uff09 \u81ea\u5b9a\u4e49\u6807\u7b7e\u989c\u8272 \u521b\u5efa/\u4fee\u6539/\u5220\u9664 \u6807\u7b7e\u4e0b\u6761\u76ee\u6570\u91cf\u7edf\u8ba1 \u6761\u76ee\u7ba1\u7406\uff08Item\uff09 \u5efa\u7acb\u4e0e\u6e90\u6587\u6863\u7684\u6620\u5c04 \u6dfb\u52a0/\u4fee\u6539\u5206\u7c7b\uff08\u4e00\u4e2a\u6761\u76ee\u5c5e\u4e8e\u552f\u4e00\u5206\u7c7b\uff09 \u6dfb\u52a0/\u4fee\u6539\u6807\u7b7e\uff08\u4e00\u4e2a\u6761\u76ee\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u6807\u7b7e\uff09 \u62d6\u62fd\u6761\u76ee\u6dfb\u52a0\u5206\u7c7b/\u6807\u7b7e \u6309\u5206\u7c7b/\u6807\u7b7e\u7b5b\u9009\u6761\u76ee \u5173\u952e\u5b57\u7b5b\u9009\u6761\u76ee \u6570\u636e\u5b58\u50a8\uff08\u76ee\u524d\u91c7\u7528 pickle \u76f4\u63a5\u5b58\u50a8\u6570\u636e\uff09 \u7528\u6237\u754c\u9762 \u81ea\u5b9a\u4e49UI\u6837\u5f0f\uff08\u76ee\u524d\u652f\u6301 default \u548c dark \u98ce\u683c\uff09 Qt \u5e03\u5c40\u3001\u57fa\u672c\u63a7\u4ef6\u3001\u4fe1\u53f7/\u69fd\u673a\u5236\u7b49\u57fa\u7840\u77e5\u8bc6\u6682\u4e14\u7565\u8fc7\uff0c\u4e0b\u9762\u5c06\u5217\u51fa Qt \u6a21\u578b/\u89c6\u56fe\u65b9\u9762\u7684\u76f8\u5173\u77e5\u8bc6\u2014\u2014\u56e0\u4e3a Tagit \u7684\u6838\u5fc3\u5bf9\u8c61\u5206\u7c7b/\u6807\u7b7e/\u6761\u76ee\u91c7\u7528\u7684\u662f QTreeView \u548c QTableView \u6765\u5448\u73b0\u7684\u3002 \u6a21\u578b/\u89c6\u56fe\u6846\u67b6\uff08Model/View Framework\uff09 \u00b6 Qt \u6a21\u578b/\u89c6\u56fe\u6a21\u5f0f\u6846\u67b6 1 \u5305\u542b\u4e86\u6a21\u578b\uff08Model\uff09\u3001\u89c6\u56fe\uff08View\uff09\u3001\u59d4\u6258\uff08Delegate\uff09\u548c\u4ee3\u7406\uff08Proxy\uff09\uff0c\u6709\u52a9\u4e8e\u5e95\u5c42\u6570\u636e\u4e0e\u6e32\u67d3\u663e\u793a\u89e3\u8026\u3002 \u6a21\u578b\u6301\u6709\u6570\u636e\uff08\u4e25\u683c\u6765\u8bf4\uff0c\u901a\u8fc7\u6a21\u578b\u4e2d\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u6765\u5b58\u50a8\u6570\u636e\uff09 \u89c6\u56fe\u4ece\u6a21\u578b\u8bfb\u53d6\u548c\u6e32\u67d3\u539f\u59cb\u6570\u636e \u59d4\u6258\u5b9a\u4e49\u6a21\u578b\u5728\u7f16\u8f91\u72b6\u6001\u7684\u6837\u5f0f\uff0c\u5e76\u4e14\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6837\u5f0f\u6e32\u67d3\u89c6\u56fe \u4ee3\u7406\u4ecb\u4e8e\u89c6\u56fe\u548c\u6e90\u6a21\u578b\u4e4b\u95f4\uff0c\u65b9\u4fbf\u5bf9\u6e90\u6a21\u578b\u6570\u636e\u8fdb\u884c\u6392\u5e8f\u3001\u8fc7\u6ee4\u7b49\u64cd\u4f5c \u91c7\u7528\u6b64\u6a21\u5f0f\u7684\u5178\u578b\u63a7\u4ef6\u6709\u5217\u8868\u7ed3\u6784\u3001\u8868\u683c\u7ed3\u6784\u548c\u5c42\u6b21\u7ed3\u6784\uff08\u6811\uff09\u7b49\u3002\u5728 Tagit \u5e94\u7528\u5982\u4e0b\uff1a \u5206\u7c7b\u6570\u636e\u91c7\u7528 QTreeview \u5448\u73b0\uff0c\u5177\u4f53\u6570\u636e\u7531\u5b50\u7c7b\u5316 QAbstractItemModel \u7684\u6a21\u578b\u7ba1\u7406 \u6807\u7b7e\u548c\u6761\u76ee\u6570\u636e\u91c7\u7528 QTableView \u663e\u793a\uff0c\u5177\u4f53\u6570\u636e\u7531\u5b50\u7c7b\u5316 QAbstractTableModel \u7684\u6a21\u578b\u7ba1\u7406 \u6761\u76ee\u6807\u7b7e\u7684\u6e32\u67d3\u59d4\u6258 QStyledItemDelegate \u5b9e\u73b0 \u6761\u76ee\u6570\u636e\u7684\u5206\u7c7b\u7b5b\u9009\u901a\u8fc7\u5b50\u7c7b\u5316 QSortFilterProxyModel \u4ee3\u7406\u5b9e\u73b0 \u6a21\u578b/\u89c6\u56fe\u6846\u67b6\u7684\u5404\u4e2a\u7ec4\u4ef6\u901a\u8fc7\u9884\u5b9a\u4e49\u597d\u7684\u63a5\u53e3\u8fdb\u884c\u534f\u4f5c\uff0c\u4f8b\u5982\u89c6\u56fe\u901a\u8fc7 data() \u65b9\u6cd5\u5411\u6a21\u578b\u8bf7\u6c42\u6570\u636e\u4ee5\u4fbf\u663e\u793a\uff0c\u6240\u4ee5\u7528\u6237\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u53ea\u9700\u8981\u5b50\u7c7b\u5316\u76f8\u5e94\u7684\u57fa\u7c7b\uff0c\u7136\u540e\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u5b9e\u73b0\u76f8\u5e94\u7684\u63a5\u53e3\u3002\u4ee5 QAbstractItemModel \u4e3a\u4f8b 2 \uff0c\u5f53\u7ee7\u627f\u8be5\u7c7b\u6765\u5b9e\u73b0\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\u7684\u6a21\u578b\u65f6\uff0c\u81f3\u5c11\u9700\u8981\u5b9e\u73b05\u4e2a\u63a5\u53e3\uff1a index() \u3001 parent() \u3001 rowCount() \u3001 columnCount() \u53ca data() \uff0c\u5b83\u4eec\u4fdd\u8bc1\u4e86\u89c6\u56fe\u53ef\u4ee5\u4ece\u6a21\u578b\u4e2d\u6b63\u786e\u83b7\u53d6\u6307\u5b9a\u7684\u6570\u636e\u3002\u5f53\u7136\uff0c\u8fd9\u4ec5\u4ec5\u5b9e\u73b0\u4e86\u53ea\u8bfb\u5c5e\u6027\uff0c\u5982\u679c\u9700\u8981\u4fee\u6539\u529f\u80fd\u7684\u8bdd\uff0c\u5219\u8fd8\u9700\u5b9e\u73b0 flags() \u548c setData() \u63a5\u53e3\uff0c\u524d\u8005\u6307\u5b9a\u67d0\u4e00\u9879\u662f\u5426\u5141\u8bb8\u4fee\u6539\uff0c\u540e\u8005\u5b9e\u73b0\u5177\u4f53\u7684\u4fee\u6539\u65b9\u6cd5\u3002 \u5982\u679c\u5b50\u7c7b\u5316\u8868\u683c\u7ed3\u6784\u7684\u6a21\u578b QAbstractTableModel 3 \uff0c\u540c\u7406\u9700\u8981\u5b9e\u73b0\u4e0a\u8ff0\u63a5\u53e3\uff0c\u53ea\u4e0d\u8fc7 QAbstractTableModel \u5df2\u9488\u5bf9\u8868\u683c\u7ed3\u6784\u8fdb\u884c\u4e86\u90e8\u5206\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u53ea\u8bfb\u7684\u8868\u683c\uff0c\u7528\u6237\u53ea\u9700\u5b9e\u73b0\u9664\u4e86 index() \u548c parent() \u4e4b\u5916\u76843\u4e2a\u63a5\u53e3\u5373\u53ef\u3002 \u4e0b\u9762\u4ece\u5b8f\u89c2\u89d2\u5ea6\u5f52\u7eb3\u603b\u7ed3\u4e86\u5b50\u7c7b\u5316\u6811\u3001\u8868\u683c\u3001\u5217\u8868\u7ed3\u6784\u6a21\u578b\u65f6\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3 4 \uff1a \u6570\u636e\u5904\u7406\u63a5\u53e3 \u00b6 \u8fd9\u662f\u6240\u6709\u6a21\u578b\u7684\u57fa\u7840\uff0c\u4ee5\u4fbf\u4fdd\u8bc1\u89c6\u56fe/\u59d4\u6258\u80fd\u591f\u4ece\u6a21\u578b\u4e2d\u6b63\u786e\u83b7\u53d6\u6570\u636e\u3002\u5177\u4f53\u5730\u53c8\u53ef\u4ee5\u5206\u4e3a\u8bfb\u53d6\u6570\u636e\u3001\u4fee\u6539\u5185\u5bb9\u3001\u589e\u5220\u6570\u636e\u7b49\u51e0\u7c7b\u3002 \u8bfb\u53d6\u6570\u636e flags() \u8868\u660e\u6570\u636e\u9879\u72b6\u6001\uff0c\u4f8b\u5982\u662f\u5426\u6709\u6548\u3001\u662f\u5426\u53ef\u4ee5\u9009\u4e2d data() \u83b7\u53d6\u6570\u636e\u9879\u5b58\u50a8\u7684\u67d0\u4e00\u7c7b\u578b/\u89d2\u8272\u7684\u6570\u636e\uff0c\u4f8b\u5982\u8868\u683c\u5355\u5143\u683c\u4e2d\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u83b7\u53d6\u5176\u6587\u672c\u5185\u5bb9\u3001\u5b57\u4f53\u5c5e\u6027\u7b49 headerData() \u83b7\u53d6\u8868\u5934\u5185\u5bb9 rowCount() \u83b7\u53d6\u884c\u6570 columnCount() \u83b7\u53d6\u5217\u6570\uff0c\u5bf9\u4e8e\u5217\u8868\u6a21\u578b QAbstractListModel \u800c\u8a00\uff0c\u5176\u5217\u6570\u59cb\u7ec8\u4e3a1\uff0c\u6545\u65e0\u9700\u5b9e\u73b0 \u4fee\u6539\u5185\u5bb9 flags() \u8bbe\u7f6e Qt::ItemIsEditable \u72b6\u6001\u624d\u5141\u8bb8\u4fee\u6539\u6570\u636e\u9879 setData() \u8bbe\u7f6e\u6570\u636e\u5305\u62ec\u5185\u5bb9\u3001\u989c\u8272\u3001\u56fe\u6807\u7b49\uff0c\u9700\u8981\u663e\u5f0f\u91ca\u653e dataChanged \u4fe1\u53f7\uff0c\u4ee5\u901a\u77e5\u89c6\u56fe\u8fdb\u884c\u663e\u793a\u5237\u65b0 setHeaderData() \u4fee\u6539\u8868\u5934\u5185\u5bb9\uff0c\u540c\u7406\u91ca\u653e headerDataChanged \u4fe1\u53f7\u901a\u77e5\u89c6\u56fe\u66f4\u65b0 \u589e\u5220\u6570\u636e\u9879 insertRows() \u548c removeRows() \u6dfb\u52a0\u548c\u5220\u9664\u884c insertColumns() \u548c removeColumns() \u6dfb\u52a0\u548c\u5220\u9664\u5217 \u6570\u636e\u7d22\u5f15\u63a5\u53e3 \u00b6 \u89c6\u56fe\u4e2d\u7684\u6bcf\u4e00\u9879\uff0c\u4f8b\u5982\u6811\u7ed3\u6784\u7684\u7ed3\u70b9\u3001\u8868\u683c\u7ed3\u6784\u7684\u5355\u5143\u683c\u3001\u5217\u8868\u7ed3\u6784\u7684\u884c\uff0c\u90fd\u5bf9\u5e94\u4e00\u4e2a\u7d22\u5f15 QModelIndex \u3002\u8868\u683c\u548c\u5217\u8868\u76f8\u5bf9\u6811\u7ed3\u6784\u6765\u8bf4\uff0c\u5176\u5c42\u6b21\u7ed3\u6784\u90fd\u8f83\u4e3a\u7b80\u5355\uff0c\u56e0\u6b64\u672c\u7c7b\u7684\u4e24\u4e2a\u51fd\u6570\u5728\u6811\u578b\u7ed3\u6784\u4e2d\u5e94\u7528\u8f83\u591a\u3002 index() \u6839\u636e\u7236\u8282\u70b9\u53ca\u4f4d\u7f6e\u83b7\u53d6\u5b50\u9879\u76ee\u7684\u7d22\u5f15\uff0c\u4fbf\u4e8e\u904d\u5386\u5b50\u9879\u76ee parent() \u83b7\u53d6\u7236\u8282\u70b9\u7d22\u5f15 \u62d6\u62fd\u529f\u80fd\u63a5\u53e3 \u00b6 mimeTypes() \u9ed8\u8ba4MIME\u7c7b\u578b\u4e3a application/x-qabstractitemmodeldatalist \uff0c\u652f\u6301\u81ea\u5b9a\u4e49\u4ee5\u4fbf\u5728\u5e94\u7528\u65f6\u8fdb\u884c\u8fc7\u6ee4 mimeData() \u8bbe\u7f6e\u5b58\u50a8\u5728\u76f8\u5e94MIME\u7c7b\u578b\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u4fbf\u8fdb\u884c\u62d6\u62fd\u8fc7\u7a0b\u7684\u6570\u636e\u4f20\u9012 supportedDropActions() \u6307\u5b9a\u652f\u6301\u7684\u62d6\u62fd\u7c7b\u578b\uff0c\u662f\u5426\u5141\u8bb8\u62d6\u52a8\u548c\u91ca\u653e dropMimeData() \u91ca\u653e\u62d6\u62fd\u540e\u7684\u54cd\u5e94\u65b9\u6cd5 \u6ce8\u610f\uff0c\u62d6\u62fd\u529f\u80fd\u7684\u5b9e\u73b0\u9700\u8981\u6570\u636e\u5904\u7406\u76f8\u5173\u63a5\u53e3\u7684\u652f\u6301\uff0c\u4f8b\u5982\u4fee\u6539\u6570\u636e\u5185\u5bb9\u3001\u65b0\u589e\u3001\u5220\u9664\u884c/\u5217\u7b49\u3002 \u62d6\u62fd\uff08Drag and Drop\uff09 \u00b6 Tagit \u7684\u62d6\u62fd\u5206\u7c7b\u529f\u80fd\u5e0c\u671b\u4ece QTableView \u62d6\u62fd\u6761\u76ee\u5230\u5206\u7c7b QTreeView \u4e0a\uff0c\u4ece\u800c\u5b8c\u6210\u6dfb\u52a0\u5206\u7c7b\u64cd\u4f5c\u3002\u6a21\u578b/\u89c6\u56fe\u6846\u67b6\u63d0\u4f9b\u4e86\u62d6\u62fd\u76f8\u5173\u7684\u63a5\u53e3\uff0c\u53ea\u9700\u5728\u6a21\u578b\u7c7b\u4e2d\u91cd\u65b0\u5b9e\u73b0\u76f8\u5e94\u7684\u51fd\u6570\u5373\u53ef\uff0c\u800c\u62d6\u62fd\u7684\u663e\u793a\u6548\u679c\u5219\u7531\u89c6\u56fe\u81ea\u52a8\u7ef4\u62a4\u3002\u4f8b\u5982 5 \uff0c flags() \u65b9\u6cd5\u4e2d Qt.ItemIsDragEnabled \u548c Qt.ItemIsDropEnabled \u6307\u660e\u662f\u5426\u5141\u8bb8\u62d6\u62fd\u548c\u91ca\u653e canDropMimeData() \u786e\u5b9a\u5141\u8bb8\u91ca\u653e\u62d6\u62fd\u5bf9\u8c61\u7684\u6761\u4ef6 dropMimeData() \u5b9e\u73b0\u91ca\u653e\u62d6\u62fd\u5bf9\u8c61\u540e\u6267\u884c\u7684\u52a8\u4f5c \u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5728\u89c6\u56fe\u4e2d\u91cd\u8f7d\u62d6\u62fd\u4e8b\u4ef6\u51fd\u6570\u6765\u624b\u52a8\u5b9e\u73b0\u76f8\u5e94\u6548\u679c\uff0c\u4f8b\u5982 6 \uff1a dragEnterEvent \u548c dragLeaveEvent \u51b3\u5b9a\u8fdb\u5165\u548c\u79bb\u5f00\u62d6\u62fd\u5bf9\u8c61\u533a\u57df\u8fc7\u7a0b\u4e2d\u662f\u5426\u63a5\u53d7\u62d6\u62fd\u5bf9\u8c61 dragMoveEvent \u51b3\u5b9a\u5728\u62d6\u62fd\u8fc7\u7a0b\u4e2d\u9f20\u6807\u4f4d\u7f6e\u662f\u5426\u662f\u5426\u63a5\u53d7\u91ca\u653e\u5bf9\u8c61\uff08drop\uff09 dropEvent \u5b9a\u4e49\u91ca\u653e\u62d6\u62fd\u540e\u9700\u8981\u8fdb\u884c\u7684\u52a8\u4f5c \u8fd9\u6837\u529f\u80fd\u4e0a\u4e5f\u80fd\u5b9e\u73b0 Tagit \u7684\u62d6\u62fd\u5206\u7c7b\uff0c\u7136\u800c\u79bb\u9884\u671f\u8fd8\u5dee\u4e00\u6b65\u2014\u2014\u53ea\u80fd\u901a\u8fc7\u5f53\u524d\u5149\u6807\u7684\u4f4d\u7f6e\u89c2\u5bdf\u6761\u76ee\u5c06\u8981\u88ab\u62d6\u653e\u5230\u54ea\u4e2a\u5206\u7c7b\u4e0a\uff0c\u800c\u6ca1\u6709\u7a81\u51fa\u663e\u793a\u8be5\u5206\u7c7b\u3002\u4e8e\u662f\u9700\u8981\u5728\u5904\u7406\u62d6\u62fd\u4e8b\u4ef6\u7684\u8fc7\u7a0b\u4e2d\u901a\u77e5\u5237\u65b0\u89c6\u56fe\uff0c\u5e76\u4e14\u5728\u89c6\u56fe\u4e2d\u501f\u52a9 paintEvent \u4e8b\u4ef6\u624b\u5de5\u5b9a\u4e49\u597d\u76ee\u6807\u5bf9\u8c61\u7684\u663e\u793a\u4f8b\u5982\u9ad8\u4eae\u6837\u5f0f\u3002 \u7ed8\u56fe\uff08Painter\uff09 \u00b6 \u5f00\u7bc7 Tagit \u9884\u89c8\u754c\u9762\u6761\u76ee\u8868\u683c\u4e2d Item Title \u6240\u793a\u7684\u6807\u7b7e\u662f\u5728\u59d4\u6258 QStyledItemDelegate \u4e2d\u501f\u52a9 QPainter \u81ea\u5b9a\u4e49\u7ed8\u5236\u7684\u3002 QPainter \u63d0\u4f9b\u4e86\u5e95\u5c42\u7684\u7ed8\u56fe\u80fd\u529b\uff0c\u53ef\u4ee5\u7ed8\u5236\u56fe\u5f62\u6216\u63a7\u4ef6 7 \u3002 \u9ed8\u8ba4\u5750\u6807\u539f\u70b9\u5728\u5de6\u4e0a\u89d2\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5168\u5c40\u5750\u6807\u540e\u753b\u56fe\uff1b\u4e5f\u53ef\u4ee5\u79fb\u52a8\u5750\u6807\u7cfb\uff08 translate() / rotate() \uff09\u540e\u91c7\u7528\u5c40\u90e8\u5750\u6807\u753b\u56fe \u8bbe\u7f6e\u753b\u7b14\uff08 setPen() \uff09\u81ea\u5b9a\u4e49\u7ed8\u5236\u5bf9\u8c61\u7684\u8fb9\u6846\u6837\u5f0f \u8bbe\u7f6e\u753b\u5237\uff08 setBrush() \uff09\u81ea\u5b9a\u4e49\u7ed8\u5236\u5bf9\u8c61\u7684\u586b\u5145\u6837\u5f0f Model/View Programming \u21a9 QAbstractItemModel Class \u21a9 QAbstractTableModel Class \u21a9 Model Subclassing Reference \u21a9 Using Drag and Drop with Item Views \u21a9 Drag and Drop \u21a9 QPainter Class \u21a9","title":"PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#pyqt5tagit","text":"\u53d1\u5e03\u4e8e\uff1a2019-03-24 | \u5206\u7c7b\uff1a python/vba/cpp \u6211\u4eec\u901a\u5e38\u4f7f\u7528\u6587\u4ef6\u5939\u7ed3\u6784\u6765\u5206\u7c7b\u7ba1\u7406\u6587\u6863/\u4e2a\u4eba\u77e5\u8bc6\uff0c\u4f46\u5355\u4e00\u7684\u76ee\u5f55\u7ed3\u6784\u96be\u4ee5\u6709\u6548\u7ec4\u7ec7\u5177\u6709\u4ea4\u53c9\u5173\u7cfb\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u4ee5\u7535\u5f71\u7c7b\u578b\u4f8b\u5982\u79d1\u5e7b\u7247\u3001\u6218\u4e89\u7247\u3001\u5267\u60c5\u7247\u6765\u547d\u540d\u5206\u7c7b\u6587\u4ef6\u5939\u662f\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\uff0c\u4f46\u540c\u65f6\u6211\u4eec\u5f88\u53ef\u80fd\u5e0c\u671b\u5c06\u540c\u4e00\u5bfc\u6f14/\u6f14\u5458\u7684\u4f5c\u54c1\u7ec4\u7ec7\u5728\u4e00\u8d77\uff0c\u4e8e\u662f\u4e0d\u5f97\u4e0d\u6309\u7167\u8fd9\u4e2a\u6807\u51c6\u91cd\u65b0\u5efa\u7acb\u5206\u7c7b\u6587\u4ef6\u5939\uff0c\u5e76\u4e14\u9700\u8981\u91cd\u590d\u590d\u5236\u6587\u6863\u3002 \u9488\u5bf9\u6b64\u7c7b\u95ee\u9898\uff0c\u8003\u8651 \u4ee5\u865a\u62df\u7684\u76ee\u5f55\u7ed3\u6784\u548c\u6807\u7b7e\u6765\u7ba1\u7406\u786c\u76d8\u4e0a\u5b9e\u9645\u5b58\u50a8\u7684\u6587\u6863 \uff08\u6587\u672c/\u591a\u5a92\u4f53\uff09\u3002\u4f5c\u8005\u8fd1\u671f\u6b63\u5728\u5b66\u4e60 Qt \u76f8\u5173\u77e5\u8bc6\uff0c\u4e8e\u662f\u6b63\u597d\u4f5c\u4e3a PyQt5 \u7684\u4e00\u4e2a\u5e94\u7528\u5b9e\u8df5\u2014\u2014\u8fd9\u4fbf\u662f\u672c\u6587\u4ecb\u7ecd\u7684\u5bf9\u8c61 Tagit \u3002\u533a\u522b\u4e8e\u7b14\u8bb0\u7c7b\u5e94\u7528\uff0c Tagit \u5e76\u4e0d\u521b\u5efa\u548c\u7f16\u8f91\u6587\u6863\u5b9e\u4f53\uff0c\u800c\u662f\u4fa7\u91cd\u4ee5\u903b\u8f91\u5206\u7c7b\u548c\u6807\u7b7e\u6765\u7ba1\u7406\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u6863\uff1b\u5b83\u66f4\u503e\u5411\u4e8e\u6587\u732e\u7ba1\u7406\u7c7b\u8f6f\u4ef6\uff0c\u4f46\u4e0d\u6d89\u53ca\u6587\u732e\u683c\u5f0f\u65b9\u9762\u7684\u529f\u80fd\uff0c\u800c\u662f\u7740\u91cd\u4e8e\u5206\u7c7b\u7ec4\u7ec7\u7684\u80fd\u529b\u3002 \u672c\u6587\u7b80\u8981\u4ecb\u7ecd Tagit \u7684\u4e3b\u8981\u529f\u80fd\u53ca\u5176\u5b9e\u73b0\u6240\u5bf9\u5e94\u7684 Qt \u57fa\u7840\u77e5\u8bc6\u3002 https://github.com/dothinking/Tagit","title":"PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#_1","text":"\u5206\u7c7b \u3001 \u6807\u7b7e \u548c \u6761\u76ee \u662f Tagit \u7684\u4e3b\u8981\u5bf9\u8c61\u3002\u6761\u76ee\u662f Tagit \u4e2d\u865a\u62df\u7684\u6587\u6863\u8bb0\u5f55\uff0c\u4e0e\u771f\u5b9e\u7684\u6e90\u6587\u6863\u4e00\u4e00\u5bf9\u5e94\uff1b\u5206\u7c7b\u662f\u865a\u62df\u7684\u76ee\u5f55\u5c42\u6b21\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u8fdb\u884c\u81ea\u5b9a\u4e49\uff0c\u7c7b\u6bd4\u4e3a\u6587\u4ef6\u5939/\u76ee\u5f55\uff1b\u6807\u7b7e\u662f\u5bf9\u6761\u76ee\uff08\u6620\u5c04\u771f\u5b9e\u6587\u6863\uff09\u5185\u5bb9\u7684\u6807\u8bb0\uff0c\u4e00\u4e2a\u6761\u76ee\u53ef\u4ee5\u6253\u4e0a\u4efb\u610f\u7684\u6807\u7b7e\u3002 \u5206\u7c7b\u7ba1\u7406\uff08Group\uff09 \u652f\u6301\u65e0\u9650\u7ea7\u5206\u7c7b \u521b\u5efa/\u4fee\u6539/\u5220\u9664 \u5206\u7c7b\u4e0b\u6761\u76ee\u6570\u91cf\u7edf\u8ba1 \u6807\u7b7e\u7ba1\u7406\uff08Tag\uff09 \u81ea\u5b9a\u4e49\u6807\u7b7e\u989c\u8272 \u521b\u5efa/\u4fee\u6539/\u5220\u9664 \u6807\u7b7e\u4e0b\u6761\u76ee\u6570\u91cf\u7edf\u8ba1 \u6761\u76ee\u7ba1\u7406\uff08Item\uff09 \u5efa\u7acb\u4e0e\u6e90\u6587\u6863\u7684\u6620\u5c04 \u6dfb\u52a0/\u4fee\u6539\u5206\u7c7b\uff08\u4e00\u4e2a\u6761\u76ee\u5c5e\u4e8e\u552f\u4e00\u5206\u7c7b\uff09 \u6dfb\u52a0/\u4fee\u6539\u6807\u7b7e\uff08\u4e00\u4e2a\u6761\u76ee\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u6807\u7b7e\uff09 \u62d6\u62fd\u6761\u76ee\u6dfb\u52a0\u5206\u7c7b/\u6807\u7b7e \u6309\u5206\u7c7b/\u6807\u7b7e\u7b5b\u9009\u6761\u76ee \u5173\u952e\u5b57\u7b5b\u9009\u6761\u76ee \u6570\u636e\u5b58\u50a8\uff08\u76ee\u524d\u91c7\u7528 pickle \u76f4\u63a5\u5b58\u50a8\u6570\u636e\uff09 \u7528\u6237\u754c\u9762 \u81ea\u5b9a\u4e49UI\u6837\u5f0f\uff08\u76ee\u524d\u652f\u6301 default \u548c dark \u98ce\u683c\uff09 Qt \u5e03\u5c40\u3001\u57fa\u672c\u63a7\u4ef6\u3001\u4fe1\u53f7/\u69fd\u673a\u5236\u7b49\u57fa\u7840\u77e5\u8bc6\u6682\u4e14\u7565\u8fc7\uff0c\u4e0b\u9762\u5c06\u5217\u51fa Qt \u6a21\u578b/\u89c6\u56fe\u65b9\u9762\u7684\u76f8\u5173\u77e5\u8bc6\u2014\u2014\u56e0\u4e3a Tagit \u7684\u6838\u5fc3\u5bf9\u8c61\u5206\u7c7b/\u6807\u7b7e/\u6761\u76ee\u91c7\u7528\u7684\u662f QTreeView \u548c QTableView \u6765\u5448\u73b0\u7684\u3002","title":"\u4e3b\u8981\u7279\u5f81"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#modelview framework","text":"Qt \u6a21\u578b/\u89c6\u56fe\u6a21\u5f0f\u6846\u67b6 1 \u5305\u542b\u4e86\u6a21\u578b\uff08Model\uff09\u3001\u89c6\u56fe\uff08View\uff09\u3001\u59d4\u6258\uff08Delegate\uff09\u548c\u4ee3\u7406\uff08Proxy\uff09\uff0c\u6709\u52a9\u4e8e\u5e95\u5c42\u6570\u636e\u4e0e\u6e32\u67d3\u663e\u793a\u89e3\u8026\u3002 \u6a21\u578b\u6301\u6709\u6570\u636e\uff08\u4e25\u683c\u6765\u8bf4\uff0c\u901a\u8fc7\u6a21\u578b\u4e2d\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u6765\u5b58\u50a8\u6570\u636e\uff09 \u89c6\u56fe\u4ece\u6a21\u578b\u8bfb\u53d6\u548c\u6e32\u67d3\u539f\u59cb\u6570\u636e \u59d4\u6258\u5b9a\u4e49\u6a21\u578b\u5728\u7f16\u8f91\u72b6\u6001\u7684\u6837\u5f0f\uff0c\u5e76\u4e14\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6837\u5f0f\u6e32\u67d3\u89c6\u56fe \u4ee3\u7406\u4ecb\u4e8e\u89c6\u56fe\u548c\u6e90\u6a21\u578b\u4e4b\u95f4\uff0c\u65b9\u4fbf\u5bf9\u6e90\u6a21\u578b\u6570\u636e\u8fdb\u884c\u6392\u5e8f\u3001\u8fc7\u6ee4\u7b49\u64cd\u4f5c \u91c7\u7528\u6b64\u6a21\u5f0f\u7684\u5178\u578b\u63a7\u4ef6\u6709\u5217\u8868\u7ed3\u6784\u3001\u8868\u683c\u7ed3\u6784\u548c\u5c42\u6b21\u7ed3\u6784\uff08\u6811\uff09\u7b49\u3002\u5728 Tagit \u5e94\u7528\u5982\u4e0b\uff1a \u5206\u7c7b\u6570\u636e\u91c7\u7528 QTreeview \u5448\u73b0\uff0c\u5177\u4f53\u6570\u636e\u7531\u5b50\u7c7b\u5316 QAbstractItemModel \u7684\u6a21\u578b\u7ba1\u7406 \u6807\u7b7e\u548c\u6761\u76ee\u6570\u636e\u91c7\u7528 QTableView \u663e\u793a\uff0c\u5177\u4f53\u6570\u636e\u7531\u5b50\u7c7b\u5316 QAbstractTableModel \u7684\u6a21\u578b\u7ba1\u7406 \u6761\u76ee\u6807\u7b7e\u7684\u6e32\u67d3\u59d4\u6258 QStyledItemDelegate \u5b9e\u73b0 \u6761\u76ee\u6570\u636e\u7684\u5206\u7c7b\u7b5b\u9009\u901a\u8fc7\u5b50\u7c7b\u5316 QSortFilterProxyModel \u4ee3\u7406\u5b9e\u73b0 \u6a21\u578b/\u89c6\u56fe\u6846\u67b6\u7684\u5404\u4e2a\u7ec4\u4ef6\u901a\u8fc7\u9884\u5b9a\u4e49\u597d\u7684\u63a5\u53e3\u8fdb\u884c\u534f\u4f5c\uff0c\u4f8b\u5982\u89c6\u56fe\u901a\u8fc7 data() \u65b9\u6cd5\u5411\u6a21\u578b\u8bf7\u6c42\u6570\u636e\u4ee5\u4fbf\u663e\u793a\uff0c\u6240\u4ee5\u7528\u6237\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u53ea\u9700\u8981\u5b50\u7c7b\u5316\u76f8\u5e94\u7684\u57fa\u7c7b\uff0c\u7136\u540e\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u5b9e\u73b0\u76f8\u5e94\u7684\u63a5\u53e3\u3002\u4ee5 QAbstractItemModel \u4e3a\u4f8b 2 \uff0c\u5f53\u7ee7\u627f\u8be5\u7c7b\u6765\u5b9e\u73b0\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\u7684\u6a21\u578b\u65f6\uff0c\u81f3\u5c11\u9700\u8981\u5b9e\u73b05\u4e2a\u63a5\u53e3\uff1a index() \u3001 parent() \u3001 rowCount() \u3001 columnCount() \u53ca data() \uff0c\u5b83\u4eec\u4fdd\u8bc1\u4e86\u89c6\u56fe\u53ef\u4ee5\u4ece\u6a21\u578b\u4e2d\u6b63\u786e\u83b7\u53d6\u6307\u5b9a\u7684\u6570\u636e\u3002\u5f53\u7136\uff0c\u8fd9\u4ec5\u4ec5\u5b9e\u73b0\u4e86\u53ea\u8bfb\u5c5e\u6027\uff0c\u5982\u679c\u9700\u8981\u4fee\u6539\u529f\u80fd\u7684\u8bdd\uff0c\u5219\u8fd8\u9700\u5b9e\u73b0 flags() \u548c setData() \u63a5\u53e3\uff0c\u524d\u8005\u6307\u5b9a\u67d0\u4e00\u9879\u662f\u5426\u5141\u8bb8\u4fee\u6539\uff0c\u540e\u8005\u5b9e\u73b0\u5177\u4f53\u7684\u4fee\u6539\u65b9\u6cd5\u3002 \u5982\u679c\u5b50\u7c7b\u5316\u8868\u683c\u7ed3\u6784\u7684\u6a21\u578b QAbstractTableModel 3 \uff0c\u540c\u7406\u9700\u8981\u5b9e\u73b0\u4e0a\u8ff0\u63a5\u53e3\uff0c\u53ea\u4e0d\u8fc7 QAbstractTableModel \u5df2\u9488\u5bf9\u8868\u683c\u7ed3\u6784\u8fdb\u884c\u4e86\u90e8\u5206\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u53ea\u8bfb\u7684\u8868\u683c\uff0c\u7528\u6237\u53ea\u9700\u5b9e\u73b0\u9664\u4e86 index() \u548c parent() \u4e4b\u5916\u76843\u4e2a\u63a5\u53e3\u5373\u53ef\u3002 \u4e0b\u9762\u4ece\u5b8f\u89c2\u89d2\u5ea6\u5f52\u7eb3\u603b\u7ed3\u4e86\u5b50\u7c7b\u5316\u6811\u3001\u8868\u683c\u3001\u5217\u8868\u7ed3\u6784\u6a21\u578b\u65f6\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3 4 \uff1a","title":"\u6a21\u578b/\u89c6\u56fe\u6846\u67b6\uff08Model/View Framework\uff09"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#_2","text":"\u8fd9\u662f\u6240\u6709\u6a21\u578b\u7684\u57fa\u7840\uff0c\u4ee5\u4fbf\u4fdd\u8bc1\u89c6\u56fe/\u59d4\u6258\u80fd\u591f\u4ece\u6a21\u578b\u4e2d\u6b63\u786e\u83b7\u53d6\u6570\u636e\u3002\u5177\u4f53\u5730\u53c8\u53ef\u4ee5\u5206\u4e3a\u8bfb\u53d6\u6570\u636e\u3001\u4fee\u6539\u5185\u5bb9\u3001\u589e\u5220\u6570\u636e\u7b49\u51e0\u7c7b\u3002 \u8bfb\u53d6\u6570\u636e flags() \u8868\u660e\u6570\u636e\u9879\u72b6\u6001\uff0c\u4f8b\u5982\u662f\u5426\u6709\u6548\u3001\u662f\u5426\u53ef\u4ee5\u9009\u4e2d data() \u83b7\u53d6\u6570\u636e\u9879\u5b58\u50a8\u7684\u67d0\u4e00\u7c7b\u578b/\u89d2\u8272\u7684\u6570\u636e\uff0c\u4f8b\u5982\u8868\u683c\u5355\u5143\u683c\u4e2d\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u83b7\u53d6\u5176\u6587\u672c\u5185\u5bb9\u3001\u5b57\u4f53\u5c5e\u6027\u7b49 headerData() \u83b7\u53d6\u8868\u5934\u5185\u5bb9 rowCount() \u83b7\u53d6\u884c\u6570 columnCount() \u83b7\u53d6\u5217\u6570\uff0c\u5bf9\u4e8e\u5217\u8868\u6a21\u578b QAbstractListModel \u800c\u8a00\uff0c\u5176\u5217\u6570\u59cb\u7ec8\u4e3a1\uff0c\u6545\u65e0\u9700\u5b9e\u73b0 \u4fee\u6539\u5185\u5bb9 flags() \u8bbe\u7f6e Qt::ItemIsEditable \u72b6\u6001\u624d\u5141\u8bb8\u4fee\u6539\u6570\u636e\u9879 setData() \u8bbe\u7f6e\u6570\u636e\u5305\u62ec\u5185\u5bb9\u3001\u989c\u8272\u3001\u56fe\u6807\u7b49\uff0c\u9700\u8981\u663e\u5f0f\u91ca\u653e dataChanged \u4fe1\u53f7\uff0c\u4ee5\u901a\u77e5\u89c6\u56fe\u8fdb\u884c\u663e\u793a\u5237\u65b0 setHeaderData() \u4fee\u6539\u8868\u5934\u5185\u5bb9\uff0c\u540c\u7406\u91ca\u653e headerDataChanged \u4fe1\u53f7\u901a\u77e5\u89c6\u56fe\u66f4\u65b0 \u589e\u5220\u6570\u636e\u9879 insertRows() \u548c removeRows() \u6dfb\u52a0\u548c\u5220\u9664\u884c insertColumns() \u548c removeColumns() \u6dfb\u52a0\u548c\u5220\u9664\u5217","title":"\u6570\u636e\u5904\u7406\u63a5\u53e3"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#_3","text":"\u89c6\u56fe\u4e2d\u7684\u6bcf\u4e00\u9879\uff0c\u4f8b\u5982\u6811\u7ed3\u6784\u7684\u7ed3\u70b9\u3001\u8868\u683c\u7ed3\u6784\u7684\u5355\u5143\u683c\u3001\u5217\u8868\u7ed3\u6784\u7684\u884c\uff0c\u90fd\u5bf9\u5e94\u4e00\u4e2a\u7d22\u5f15 QModelIndex \u3002\u8868\u683c\u548c\u5217\u8868\u76f8\u5bf9\u6811\u7ed3\u6784\u6765\u8bf4\uff0c\u5176\u5c42\u6b21\u7ed3\u6784\u90fd\u8f83\u4e3a\u7b80\u5355\uff0c\u56e0\u6b64\u672c\u7c7b\u7684\u4e24\u4e2a\u51fd\u6570\u5728\u6811\u578b\u7ed3\u6784\u4e2d\u5e94\u7528\u8f83\u591a\u3002 index() \u6839\u636e\u7236\u8282\u70b9\u53ca\u4f4d\u7f6e\u83b7\u53d6\u5b50\u9879\u76ee\u7684\u7d22\u5f15\uff0c\u4fbf\u4e8e\u904d\u5386\u5b50\u9879\u76ee parent() \u83b7\u53d6\u7236\u8282\u70b9\u7d22\u5f15","title":"\u6570\u636e\u7d22\u5f15\u63a5\u53e3"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#_4","text":"mimeTypes() \u9ed8\u8ba4MIME\u7c7b\u578b\u4e3a application/x-qabstractitemmodeldatalist \uff0c\u652f\u6301\u81ea\u5b9a\u4e49\u4ee5\u4fbf\u5728\u5e94\u7528\u65f6\u8fdb\u884c\u8fc7\u6ee4 mimeData() \u8bbe\u7f6e\u5b58\u50a8\u5728\u76f8\u5e94MIME\u7c7b\u578b\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u4fbf\u8fdb\u884c\u62d6\u62fd\u8fc7\u7a0b\u7684\u6570\u636e\u4f20\u9012 supportedDropActions() \u6307\u5b9a\u652f\u6301\u7684\u62d6\u62fd\u7c7b\u578b\uff0c\u662f\u5426\u5141\u8bb8\u62d6\u52a8\u548c\u91ca\u653e dropMimeData() \u91ca\u653e\u62d6\u62fd\u540e\u7684\u54cd\u5e94\u65b9\u6cd5 \u6ce8\u610f\uff0c\u62d6\u62fd\u529f\u80fd\u7684\u5b9e\u73b0\u9700\u8981\u6570\u636e\u5904\u7406\u76f8\u5173\u63a5\u53e3\u7684\u652f\u6301\uff0c\u4f8b\u5982\u4fee\u6539\u6570\u636e\u5185\u5bb9\u3001\u65b0\u589e\u3001\u5220\u9664\u884c/\u5217\u7b49\u3002","title":"\u62d6\u62fd\u529f\u80fd\u63a5\u53e3"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#drag and drop","text":"Tagit \u7684\u62d6\u62fd\u5206\u7c7b\u529f\u80fd\u5e0c\u671b\u4ece QTableView \u62d6\u62fd\u6761\u76ee\u5230\u5206\u7c7b QTreeView \u4e0a\uff0c\u4ece\u800c\u5b8c\u6210\u6dfb\u52a0\u5206\u7c7b\u64cd\u4f5c\u3002\u6a21\u578b/\u89c6\u56fe\u6846\u67b6\u63d0\u4f9b\u4e86\u62d6\u62fd\u76f8\u5173\u7684\u63a5\u53e3\uff0c\u53ea\u9700\u5728\u6a21\u578b\u7c7b\u4e2d\u91cd\u65b0\u5b9e\u73b0\u76f8\u5e94\u7684\u51fd\u6570\u5373\u53ef\uff0c\u800c\u62d6\u62fd\u7684\u663e\u793a\u6548\u679c\u5219\u7531\u89c6\u56fe\u81ea\u52a8\u7ef4\u62a4\u3002\u4f8b\u5982 5 \uff0c flags() \u65b9\u6cd5\u4e2d Qt.ItemIsDragEnabled \u548c Qt.ItemIsDropEnabled \u6307\u660e\u662f\u5426\u5141\u8bb8\u62d6\u62fd\u548c\u91ca\u653e canDropMimeData() \u786e\u5b9a\u5141\u8bb8\u91ca\u653e\u62d6\u62fd\u5bf9\u8c61\u7684\u6761\u4ef6 dropMimeData() \u5b9e\u73b0\u91ca\u653e\u62d6\u62fd\u5bf9\u8c61\u540e\u6267\u884c\u7684\u52a8\u4f5c \u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5728\u89c6\u56fe\u4e2d\u91cd\u8f7d\u62d6\u62fd\u4e8b\u4ef6\u51fd\u6570\u6765\u624b\u52a8\u5b9e\u73b0\u76f8\u5e94\u6548\u679c\uff0c\u4f8b\u5982 6 \uff1a dragEnterEvent \u548c dragLeaveEvent \u51b3\u5b9a\u8fdb\u5165\u548c\u79bb\u5f00\u62d6\u62fd\u5bf9\u8c61\u533a\u57df\u8fc7\u7a0b\u4e2d\u662f\u5426\u63a5\u53d7\u62d6\u62fd\u5bf9\u8c61 dragMoveEvent \u51b3\u5b9a\u5728\u62d6\u62fd\u8fc7\u7a0b\u4e2d\u9f20\u6807\u4f4d\u7f6e\u662f\u5426\u662f\u5426\u63a5\u53d7\u91ca\u653e\u5bf9\u8c61\uff08drop\uff09 dropEvent \u5b9a\u4e49\u91ca\u653e\u62d6\u62fd\u540e\u9700\u8981\u8fdb\u884c\u7684\u52a8\u4f5c \u8fd9\u6837\u529f\u80fd\u4e0a\u4e5f\u80fd\u5b9e\u73b0 Tagit \u7684\u62d6\u62fd\u5206\u7c7b\uff0c\u7136\u800c\u79bb\u9884\u671f\u8fd8\u5dee\u4e00\u6b65\u2014\u2014\u53ea\u80fd\u901a\u8fc7\u5f53\u524d\u5149\u6807\u7684\u4f4d\u7f6e\u89c2\u5bdf\u6761\u76ee\u5c06\u8981\u88ab\u62d6\u653e\u5230\u54ea\u4e2a\u5206\u7c7b\u4e0a\uff0c\u800c\u6ca1\u6709\u7a81\u51fa\u663e\u793a\u8be5\u5206\u7c7b\u3002\u4e8e\u662f\u9700\u8981\u5728\u5904\u7406\u62d6\u62fd\u4e8b\u4ef6\u7684\u8fc7\u7a0b\u4e2d\u901a\u77e5\u5237\u65b0\u89c6\u56fe\uff0c\u5e76\u4e14\u5728\u89c6\u56fe\u4e2d\u501f\u52a9 paintEvent \u4e8b\u4ef6\u624b\u5de5\u5b9a\u4e49\u597d\u76ee\u6807\u5bf9\u8c61\u7684\u663e\u793a\u4f8b\u5982\u9ad8\u4eae\u6837\u5f0f\u3002","title":"\u62d6\u62fd\uff08Drag and Drop\uff09"},{"location":"2019-03-24-PyQt5%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Tagit/#painter","text":"\u5f00\u7bc7 Tagit \u9884\u89c8\u754c\u9762\u6761\u76ee\u8868\u683c\u4e2d Item Title \u6240\u793a\u7684\u6807\u7b7e\u662f\u5728\u59d4\u6258 QStyledItemDelegate \u4e2d\u501f\u52a9 QPainter \u81ea\u5b9a\u4e49\u7ed8\u5236\u7684\u3002 QPainter \u63d0\u4f9b\u4e86\u5e95\u5c42\u7684\u7ed8\u56fe\u80fd\u529b\uff0c\u53ef\u4ee5\u7ed8\u5236\u56fe\u5f62\u6216\u63a7\u4ef6 7 \u3002 \u9ed8\u8ba4\u5750\u6807\u539f\u70b9\u5728\u5de6\u4e0a\u89d2\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5168\u5c40\u5750\u6807\u540e\u753b\u56fe\uff1b\u4e5f\u53ef\u4ee5\u79fb\u52a8\u5750\u6807\u7cfb\uff08 translate() / rotate() \uff09\u540e\u91c7\u7528\u5c40\u90e8\u5750\u6807\u753b\u56fe \u8bbe\u7f6e\u753b\u7b14\uff08 setPen() \uff09\u81ea\u5b9a\u4e49\u7ed8\u5236\u5bf9\u8c61\u7684\u8fb9\u6846\u6837\u5f0f \u8bbe\u7f6e\u753b\u5237\uff08 setBrush() \uff09\u81ea\u5b9a\u4e49\u7ed8\u5236\u5bf9\u8c61\u7684\u586b\u5145\u6837\u5f0f Model/View Programming \u21a9 QAbstractItemModel Class \u21a9 QAbstractTableModel Class \u21a9 Model Subclassing Reference \u21a9 Using Drag and Drop with Item Views \u21a9 Drag and Drop \u21a9 QPainter Class \u21a9","title":"\u7ed8\u56fe\uff08Painter\uff09"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/","text":"VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-04-20 | \u5206\u7c7b\uff1a python/vba/cpp \u4e3a\u4fbf\u4e8e\u4ee3\u7801\u7684\u91cd\u590d\u5229\u7528\u548c\u5408\u7406\u7ec4\u7ec7\uff0cVBA\u652f\u6301\u4ece\u5f53\u524d\u5de5\u4f5c\u7c3f\u8c03\u7528\u5176\u4ed6\u6587\u4ef6\u4e2d\u7684\u51fd\u6570\uff0c\u4f8b\u5982Excel\u63d2\u4ef6 *.xlam \u3001\u5b8f\u6587\u4ef6 *.xlsm \u3001 .NET \u7f16\u8bd1\u548c\u6ce8\u518c\u7684 COM \u94fe\u63a5\u5e93 *.dll \uff0c\u4ee5\u53caC\u8bed\u8a00\u98ce\u683c\u7684\u52a8\u6001\u94fe\u63a5\u5e93 *.dll \u3002\u672c\u6587\u4ee5\u8ba1\u7b97\u4e24\u4e2a\u5355\u5143\u683c\u6570\u503c\u548c\u4e3a\u4f8b\uff0c\u7b80\u8ff0\u8de8\u5de5\u4f5c\u7c3f\u51fd\u6570\u8c03\u7528\u65b9\u6cd5\u3002 Excel\u63d2\u4ef6/\u5b8f\u6587\u4ef6 \u00b6 \u53ef\u4ee5\u901a\u8fc7**\u52a0\u8f7d\u5f15\u7528**\u6216\u8005**\u76f4\u63a5\u8c03\u7528**\u4e24\u79cd\u65b9\u5f0f\u4f7f\u7528Excel\u63d2\u4ef6/\u5b8f\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\u3002\u65b0\u5efa add.xlsm \uff0c\u91cd\u547d\u540dVBA\u5de5\u7a0b\u540d\u79f0\u4e3a Test_add \uff0c\u7136\u540e\u6dfb\u52a0\u4e00\u4e2a\u6a21\u5757 test_add_module \uff0c\u6700\u540e\u521b\u5efa\u5982\u4e0b\u7684 add() \u51fd\u6570\uff1a ' add.xlsm -> test_add_module -> add() Function add(ByVal A As Object, ByVal B As Object) add = A.Value + B.Value End Function \u52a0\u8f7d\u5f15\u7528 \u00b6 Developer -> Visual Basic -> Tools -> References... -> Browse... \uff0c\u9009\u62e9 add.xlsm \u6587\u4ef6\u6240\u5728\u4f4d\u7f6e\uff0c\u5373\u53ef\u5c06\u5176\u52a0\u8f7d\u5230 test.xlsm \u5de5\u7a0b\u4e2d\u3002 test.xlsm \u5de5\u7a0b\u4e2d\u51fa\u73b0 References \u8282\u70b9\uff0c\u5305\u542b Reference to add.xlsm \u5b50\u8282\u70b9\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u901a\u8fc7 View -> Object Browser \u67e5\u770b\u662f\u5426\u6210\u529f\u52a0\u8f7d add() \u51fd\u6570\u3002 \u63a5\u4e0b\u6765\u5373\u53ef\u5728VBA\u4ee3\u7801\u6216\u8005\u516c\u5f0f\u7f16\u8f91\u5668\u4e2d\u4f7f\u7528\uff0c\u5e76\u4e14\u5177\u5907\u667a\u80fd\u63d0\u793a\u529f\u80fd\u3002 Debug.Print Add(Range(\"A1\"), Range(\"B1\")) \u76f4\u63a5\u52a0\u8f7d \u00b6 Application.Run() \u53ef\u4ee5\u8de8\u5de5\u4f5c\u7c3f\u4f7f\u7528\u51fd\u6570 1 \uff1a ' :param Macro: \u88ab\u8c03\u7528\u51fd\u6570\u7684\u7edd\u5bf9\u5730\u5740\uff0c\u683c\u5f0f\uff1aworkbook.xlsm!module.function ' :Arg1,...Arg30: \u6700\u591a\u652f\u630130\u4e2a\u4f4d\u7f6e\u53c2\u6570\u7684\u8f93\u5165 ' :return: \u8fd4\u56deVariant\u7c7b\u578b\uff0c\u53ef\u4ee5\u8f6c\u6362\u4e3a\u76ee\u6807\u7c7b\u578b Application.Run (Macro, Arg1, Arg2, ..., Arg30) As Variant \u4ece\u4e4b\u524d\u7684\u5f15\u7528\u4e2d\u5220\u9664 add.xlsm \uff0c\u7136\u540e\u6d4b\u8bd5\u5982\u4e0b\u7684\u8c03\u7528\u4ee3\u7801\uff1a Sub test() Dim res As Single res = Application.Run(\"'full\\path\\to\\add.xlsm'!test_add_module.add\", Range(\"A1\"), Range(\"B1\")) Debug.Print res End Sub \u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u516c\u5f0f\u7f16\u8f91\u5668\u4e2d\u4f7f\u7528\uff1a =add.xlsm!test_add_module.add(A1,B1) .NET \u7f16\u8bd1\u548c\u6ce8\u518c\u7684\u94fe\u63a5\u5e93 \u00b6 \u7c7b\u4f3c\u4e8e\u8c03\u7528\u5de5\u4f5c\u7c3f\u4e2d\u7684\u51fd\u6570\uff0cVBA\u4e5f\u53ef\u4ee5\u91c7\u7528 \u52a0\u8f7d\u5f15\u7528 \u548c \u76f4\u63a5\u8c03\u7528 \u4e24\u79cd\u65b9\u5f0f\u5f15\u7528 VB.NET \u521b\u5efa\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7c7b\u578b\u7684 COM \u7ec4\u4ef6\u3002\u9996\u5148\uff0c\u53c2\u8003 VB.NET \u5c01\u88c5COM\u7ec4\u4ef6 2 \u7684\u65b9\u6cd5\u521b\u5efa\u3001\u7f16\u8bd1\u548c\u6ce8\u518c\u5982\u4e0b\u7c7b\uff1a ' TestDLL.dll -> Test_add <ComClass(Test_add.ClassId, Test_add.InterfaceId, Test_add.EventsId)> _ Public Class Test_add #Region \"COM GUIDs\" ... #End Region ' A creatable COM class must have a Public Sub New() ' with no parameters, otherwise, the class will not be ' registered in the COM registry and cannot be created ' via CreateObject. Public Sub New() MyBase.New() End Sub Function add(ByVal A As Object, ByVal B As Object) Return A.Value + B.Value End Function End Class \u52a0\u8f7d\u5f15\u7528 \u00b6 \u540c\u4e0a\u5728 Tools -> References \u52a0\u8f7d\u6ce8\u518c\u540e\u7684\u6587\u4ef6 TestDLL.tlb \uff0c\u7136\u540e\u6d4b\u8bd5\u5982\u4e0b\u8c03\u7528\u4ee3\u7801\uff0c\u540c\u7406\u5177\u5907\u667a\u80fd\u63d0\u793a\u529f\u80fd\u3002 Sub test() Dim OBJ As Test_add Set OBJ = New Test_add Debug.Print OBJ.Add([A1], [B1]) End Sub \u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7a0b\u5e8f\u7684\u65b9\u5f0f\u81ea\u52a8\u52a0\u8f7d\u5f15\u7528\uff0c ThisWorkbook.VBProject.References \uff0c\u5177\u4f53\u53c2\u8003VBA\u81ea\u52a8\u6dfb\u52a0\u524d\u671f\u5f15\u7528\u7684\u6587\u7ae0 3 \u3002 \u76f4\u63a5\u8c03\u7528 \u00b6 \u5982\u679c\u4e0d\u60f3\u524d\u671f\u663e\u5f0f\u5730\u5f15\u7528\u5e93\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 CreateObject(\"COM_DLL_name.class_name\") \u521b\u5efa\u5df2\u6ce8\u518c\u7684\u7c7b\uff0c\u7136\u540e\u4f7f\u7528\u5176\u4e2d\u7684\u51fd\u6570\u3002\u53c2\u8003\u4ee3\u7801\uff1a Sub test() Dim OBJ As Object Set OBJ = CreateObject(\"TestDLL.Test_add\") Debug.Print OBJ.Add([A1], [B1]) End Sub C\u98ce\u683c\u52a8\u6001\u94fe\u63a5\u5e93 \u00b6 VBA\u53ef\u4ee5\u91c7\u7528\u5982\u4e0b\u65b9\u5f0f\u5f15\u7528C\u8bed\u8a00\u98ce\u683c\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u51fd\u6570\uff1a ' 64 bit dll Private Declare PtrSafe Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] ' 32 bit dll Private Declare Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] \u5177\u4f53\u7ec6\u8282\u548c\u6ce8\u610f\u4e8b\u9879\u53c2\u8003\u6b64\u524d\u7684\u6587\u7ae0 VBA\u8c03\u7528c++\u52a8\u6001\u94fe\u63a5\u5e93 \u3002 Application.Run method (Excel) \u21a9 \u7528VB.NET(Visual Basic 2010)\u5c01\u88c5EXCEL VBA\u4e3aDLL_COM\u7ec4\u4ef6(\u4e00) \u21a9 \u5982\u4f55\u7528vba\u81ea\u52a8\u6dfb\u52a0\u524d\u671f\u5f15\u7528\uff1f \u21a9","title":"VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#vba com c","text":"\u53d1\u5e03\u4e8e\uff1a2019-04-20 | \u5206\u7c7b\uff1a python/vba/cpp \u4e3a\u4fbf\u4e8e\u4ee3\u7801\u7684\u91cd\u590d\u5229\u7528\u548c\u5408\u7406\u7ec4\u7ec7\uff0cVBA\u652f\u6301\u4ece\u5f53\u524d\u5de5\u4f5c\u7c3f\u8c03\u7528\u5176\u4ed6\u6587\u4ef6\u4e2d\u7684\u51fd\u6570\uff0c\u4f8b\u5982Excel\u63d2\u4ef6 *.xlam \u3001\u5b8f\u6587\u4ef6 *.xlsm \u3001 .NET \u7f16\u8bd1\u548c\u6ce8\u518c\u7684 COM \u94fe\u63a5\u5e93 *.dll \uff0c\u4ee5\u53caC\u8bed\u8a00\u98ce\u683c\u7684\u52a8\u6001\u94fe\u63a5\u5e93 *.dll \u3002\u672c\u6587\u4ee5\u8ba1\u7b97\u4e24\u4e2a\u5355\u5143\u683c\u6570\u503c\u548c\u4e3a\u4f8b\uff0c\u7b80\u8ff0\u8de8\u5de5\u4f5c\u7c3f\u51fd\u6570\u8c03\u7528\u65b9\u6cd5\u3002","title":"VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#excel","text":"\u53ef\u4ee5\u901a\u8fc7**\u52a0\u8f7d\u5f15\u7528**\u6216\u8005**\u76f4\u63a5\u8c03\u7528**\u4e24\u79cd\u65b9\u5f0f\u4f7f\u7528Excel\u63d2\u4ef6/\u5b8f\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\u3002\u65b0\u5efa add.xlsm \uff0c\u91cd\u547d\u540dVBA\u5de5\u7a0b\u540d\u79f0\u4e3a Test_add \uff0c\u7136\u540e\u6dfb\u52a0\u4e00\u4e2a\u6a21\u5757 test_add_module \uff0c\u6700\u540e\u521b\u5efa\u5982\u4e0b\u7684 add() \u51fd\u6570\uff1a ' add.xlsm -> test_add_module -> add() Function add(ByVal A As Object, ByVal B As Object) add = A.Value + B.Value End Function","title":"Excel\u63d2\u4ef6/\u5b8f\u6587\u4ef6"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#_1","text":"Developer -> Visual Basic -> Tools -> References... -> Browse... \uff0c\u9009\u62e9 add.xlsm \u6587\u4ef6\u6240\u5728\u4f4d\u7f6e\uff0c\u5373\u53ef\u5c06\u5176\u52a0\u8f7d\u5230 test.xlsm \u5de5\u7a0b\u4e2d\u3002 test.xlsm \u5de5\u7a0b\u4e2d\u51fa\u73b0 References \u8282\u70b9\uff0c\u5305\u542b Reference to add.xlsm \u5b50\u8282\u70b9\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u901a\u8fc7 View -> Object Browser \u67e5\u770b\u662f\u5426\u6210\u529f\u52a0\u8f7d add() \u51fd\u6570\u3002 \u63a5\u4e0b\u6765\u5373\u53ef\u5728VBA\u4ee3\u7801\u6216\u8005\u516c\u5f0f\u7f16\u8f91\u5668\u4e2d\u4f7f\u7528\uff0c\u5e76\u4e14\u5177\u5907\u667a\u80fd\u63d0\u793a\u529f\u80fd\u3002 Debug.Print Add(Range(\"A1\"), Range(\"B1\"))","title":"\u52a0\u8f7d\u5f15\u7528"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#_2","text":"Application.Run() \u53ef\u4ee5\u8de8\u5de5\u4f5c\u7c3f\u4f7f\u7528\u51fd\u6570 1 \uff1a ' :param Macro: \u88ab\u8c03\u7528\u51fd\u6570\u7684\u7edd\u5bf9\u5730\u5740\uff0c\u683c\u5f0f\uff1aworkbook.xlsm!module.function ' :Arg1,...Arg30: \u6700\u591a\u652f\u630130\u4e2a\u4f4d\u7f6e\u53c2\u6570\u7684\u8f93\u5165 ' :return: \u8fd4\u56deVariant\u7c7b\u578b\uff0c\u53ef\u4ee5\u8f6c\u6362\u4e3a\u76ee\u6807\u7c7b\u578b Application.Run (Macro, Arg1, Arg2, ..., Arg30) As Variant \u4ece\u4e4b\u524d\u7684\u5f15\u7528\u4e2d\u5220\u9664 add.xlsm \uff0c\u7136\u540e\u6d4b\u8bd5\u5982\u4e0b\u7684\u8c03\u7528\u4ee3\u7801\uff1a Sub test() Dim res As Single res = Application.Run(\"'full\\path\\to\\add.xlsm'!test_add_module.add\", Range(\"A1\"), Range(\"B1\")) Debug.Print res End Sub \u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u516c\u5f0f\u7f16\u8f91\u5668\u4e2d\u4f7f\u7528\uff1a =add.xlsm!test_add_module.add(A1,B1)","title":"\u76f4\u63a5\u52a0\u8f7d"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#net","text":"\u7c7b\u4f3c\u4e8e\u8c03\u7528\u5de5\u4f5c\u7c3f\u4e2d\u7684\u51fd\u6570\uff0cVBA\u4e5f\u53ef\u4ee5\u91c7\u7528 \u52a0\u8f7d\u5f15\u7528 \u548c \u76f4\u63a5\u8c03\u7528 \u4e24\u79cd\u65b9\u5f0f\u5f15\u7528 VB.NET \u521b\u5efa\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7c7b\u578b\u7684 COM \u7ec4\u4ef6\u3002\u9996\u5148\uff0c\u53c2\u8003 VB.NET \u5c01\u88c5COM\u7ec4\u4ef6 2 \u7684\u65b9\u6cd5\u521b\u5efa\u3001\u7f16\u8bd1\u548c\u6ce8\u518c\u5982\u4e0b\u7c7b\uff1a ' TestDLL.dll -> Test_add <ComClass(Test_add.ClassId, Test_add.InterfaceId, Test_add.EventsId)> _ Public Class Test_add #Region \"COM GUIDs\" ... #End Region ' A creatable COM class must have a Public Sub New() ' with no parameters, otherwise, the class will not be ' registered in the COM registry and cannot be created ' via CreateObject. Public Sub New() MyBase.New() End Sub Function add(ByVal A As Object, ByVal B As Object) Return A.Value + B.Value End Function End Class","title":".NET\u7f16\u8bd1\u548c\u6ce8\u518c\u7684\u94fe\u63a5\u5e93"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#_3","text":"\u540c\u4e0a\u5728 Tools -> References \u52a0\u8f7d\u6ce8\u518c\u540e\u7684\u6587\u4ef6 TestDLL.tlb \uff0c\u7136\u540e\u6d4b\u8bd5\u5982\u4e0b\u8c03\u7528\u4ee3\u7801\uff0c\u540c\u7406\u5177\u5907\u667a\u80fd\u63d0\u793a\u529f\u80fd\u3002 Sub test() Dim OBJ As Test_add Set OBJ = New Test_add Debug.Print OBJ.Add([A1], [B1]) End Sub \u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7a0b\u5e8f\u7684\u65b9\u5f0f\u81ea\u52a8\u52a0\u8f7d\u5f15\u7528\uff0c ThisWorkbook.VBProject.References \uff0c\u5177\u4f53\u53c2\u8003VBA\u81ea\u52a8\u6dfb\u52a0\u524d\u671f\u5f15\u7528\u7684\u6587\u7ae0 3 \u3002","title":"\u52a0\u8f7d\u5f15\u7528"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#_4","text":"\u5982\u679c\u4e0d\u60f3\u524d\u671f\u663e\u5f0f\u5730\u5f15\u7528\u5e93\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 CreateObject(\"COM_DLL_name.class_name\") \u521b\u5efa\u5df2\u6ce8\u518c\u7684\u7c7b\uff0c\u7136\u540e\u4f7f\u7528\u5176\u4e2d\u7684\u51fd\u6570\u3002\u53c2\u8003\u4ee3\u7801\uff1a Sub test() Dim OBJ As Object Set OBJ = CreateObject(\"TestDLL.Test_add\") Debug.Print OBJ.Add([A1], [B1]) End Sub","title":"\u76f4\u63a5\u8c03\u7528"},{"location":"2019-04-20-VBA%E8%B0%83%E7%94%A8%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%EF%BC%88%E5%B7%A5%E4%BD%9C%E7%B0%BF-COM%E9%93%BE%E6%8E%A5%E5%BA%93-C%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%89%E6%96%B9%E6%B3%95/#c","text":"VBA\u53ef\u4ee5\u91c7\u7528\u5982\u4e0b\u65b9\u5f0f\u5f15\u7528C\u8bed\u8a00\u98ce\u683c\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u51fd\u6570\uff1a ' 64 bit dll Private Declare PtrSafe Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] ' 32 bit dll Private Declare Function [function_name] Lib [\"path_to_dll\"] ([parameters_list]) As [type] \u5177\u4f53\u7ec6\u8282\u548c\u6ce8\u610f\u4e8b\u9879\u53c2\u8003\u6b64\u524d\u7684\u6587\u7ae0 VBA\u8c03\u7528c++\u52a8\u6001\u94fe\u63a5\u5e93 \u3002 Application.Run method (Excel) \u21a9 \u7528VB.NET(Visual Basic 2010)\u5c01\u88c5EXCEL VBA\u4e3aDLL_COM\u7ec4\u4ef6(\u4e00) \u21a9 \u5982\u4f55\u7528vba\u81ea\u52a8\u6dfb\u52a0\u524d\u671f\u5f15\u7528\uff1f \u21a9","title":"C\u98ce\u683c\u52a8\u6001\u94fe\u63a5\u5e93"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/","text":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-04-21 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Python\u6709\u5f88\u591a\u5f3a\u5927\u7684\u7b2c\u4e09\u65b9\u5e93\u53ef\u4ee5\u8bfb\u5199Excel\uff0c\u4f8b\u5982 xlrd \u3001 xlwt \u3001 xlutils \u3001 openpyxl \u3001 xlwings \u7b49\uff0c\u5b83\u4eec\u4e3b\u8981\u5728\u8bfb\u5199\u65b9\u9762\u5177\u5907\u4f18\u52bf\uff0c\u4f46\u8bba\u8d77\u5bf9Excel\u64cd\u4f5c\u7684\u5168\u9762\u6027\u548c\u57fa\u7840\u6027\uff0c\u5219\u9996\u63a8 win32com \uff0c\u5b83\u662f pywin32 \u5e93 1 \u7684\u4e00\u90e8\u5206\u3002\u672c\u6587\u8bb0\u5f55\u4f7f\u7528 win32com \u64cd\u4f5cExcel\u7684\u51e0\u4e2a\u6848\u4f8b\uff0c\u4f8b\u5982\u4e00\u822c\u7684\u8bfb\u5199\u3001\u5de5\u4f5c\u8868\u4fdd\u62a4\u3001\u81ea\u52a8\u8ba1\u7b97\u3001\u5f15\u7528\u7ba1\u7406\u7b49\u3002 \u5173\u4e8eVBA\u5b8f\u7684\u8bfb\u5199\u8fd0\u884c\u64cd\u4f5c\uff0c\u5355\u72ec\u5217\u4e3a\u4e00\u7bc7\uff1a 2019-09-13-Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 \u5b89\u88c5 \u00b6 pip install pywin32 # \u5982\u679c\u9700\u8981\u7528\u5230\u7cfb\u7edf\u529f\u80fd\u4f8b\u5982\u6ce8\u518cCOM\u5bf9\u8c61\u3001Windows\u670d\u52a1\uff0c\u5219\u9700\u8981\u7ee7\u7eed\u6267\u884c\u5982\u4e0b\u5b89\u88c5 python Scripts/pywin32_postinstall.py -install \u57fa\u672c\u64cd\u4f5c \u00b6 \u7531\u4e8e win32com \u662f\u5bf9\u57fa\u672cCOM API\u7684\u5c01\u88c5\uff0c\u6240\u4ee5\u57fa\u672c\u529f\u80fd\u7684\u4f7f\u7528\u548cVBA\u6781\u4e3a\u7c7b\u4f3c\uff0c\u56e0\u6b64\u672c\u6587\u4e0d\u4f1a\u5728\u6b64\u65b9\u9762\u82b1\u8d39\u7bc7\u5e45\uff0c\u4ec5\u4ee5\u5982\u4e0b\u4f8b\u5b50\u4f5c\u53c2\u8003\uff1a import win32com.client # \u83b7\u53d6Excel Application # app = win32com.client.gencache.EnsureDispatch(\"Excel.Application\") app = win32com.client.Dispatch(\"Excel.Application\") app.Visible = False app.DisplayAlerts = False app.ScreenUpdating = False # \u6253\u5f00\u5de5\u4f5c\u7c3f # UpdateLinks=False \u907f\u514d\u6253\u5f00\u5de5\u4f5c\u7c3f\u65f6\u63d0\u793a\u66f4\u65b0\u94fe\u63a5 wb = app.Workbooks.Open(\"path/to/workbook\", UpdateLinks=False) # \u83b7\u53d6\u5de5\u4f5c\u7c3f\u540e\u5219\u53ef\u7c7b\u4f3cVBA\u64cd\u4f5c\uff0c\u4f8b\u5982\u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u8868\uff0c\u8fdb\u800c\u83b7\u53d6Range\u7b49 # Range\u5177\u6709Value, Address, Formula\u5c5e\u6027 wb.ActiveSheet.Range(\"A1\").Value = \"Hello World\" \u5176\u4e2d\u4f7f\u7528 Dispatch() \u548c EnsureDispatch() \u83b7\u53d6 COM \u5bf9\u8c61\u7684\u5dee\u522b\u53c2\u8003 2 \u3002 \u6211\u4eec\u66f4\u5173\u5fc3\u7684\u662f\u5982\u4f55\u83b7\u53d6API\uff0c\u5bf9\u4e8e\u7b80\u5355\u7684\u5e94\u7528\uff0c\u53ef\u4ee5\u53c2\u8003VBA\u4ee3\u7801\u63d0\u793a\u6216\u5f55\u5236\u7684\u5b8f\u8fdb\u884c\u8f6c\u6362\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u5176\u6b63\u786e\u6027\u3002\u8003\u8651\u5230 win32com \u662f\u5bf9Windows COM\u7ec4\u4ef6API\u7684\u5c01\u88c5\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u53c2\u8003\u539f\u59cbAPI\u6587\u6863\u3002\u5982\u679c\u5b89\u88c5\u4e86Visual Studio\uff0c\u53ef\u4ee5\u4ece\u5982\u4e0b\u76ee\u5f55\u627e\u5230 oleview.exe 3 \uff1a C:\\Program Files (x86)\\Windows Kits\\8.1\\bin\\x64\\oleview.exe \u6ce8\u610f \u4ee5\u7ba1\u7406\u5458\u65b9\u5f0f\u8fd0\u884c\u8be5\u7a0b\u5e8f \uff0c\u5426\u5219\u65e0\u6cd5\u6253\u5f00\u540e\u7eed\u7684\u6587\u6863\u3002\u7136\u540e\u4ece\u5de6\u4fa7\u9762\u677f\u7684 Type Libraries \u8282\u70b9\u67e5\u627e\u9700\u8981\u7684\u5185\u5bb9\uff0c\u4f8b\u5982\u5bf9\u4e8eExcel 2010\uff0c\u6211\u4eec\u6d4f\u89c8\u627e\u5230 Microsoft Excel 14.0 Object Library (Ver 1.7) \u3002\u53cc\u51fb\u6253\u5f00\u540e\u5373\u53ef\u770b\u5230\u8be6\u7ec6\u7684API\u6587\u6863\uff0c\u5305\u62ec\u7c7b\u53ca\u5176\u5c5e\u6027\u548c\u65b9\u6cd5\u3001\u5e38\u91cf\u7b49\u3002 \u5f00\u542f/\u5173\u95ed\u5de5\u4f5c\u8868\u4fdd\u62a4 \u00b6 Protect() \u548c Unprotect() \u5f00\u542f/\u5173\u95ed\u5de5\u4f5c\u8868\u4fdd\u62a4\uff0c\u9002\u7528\u4e8e\u5bf9\u6709\u4fdd\u62a4\u7684\u5de5\u4f5c\u8868\u7684\u81ea\u52a8\u5316\u5904\u7406\u3002\u4e0b\u9762\u793a\u4f8b\u4ee3\u7801\u68c0\u6d4b\u5de5\u4f5c\u8868\u4fdd\u62a4\u72b6\u6001\uff0c\u5982\u679c\u88ab\u4fdd\u62a4\u5219\u53d6\u6d88\u4fdd\u62a4\u4ee5\u4fbf\u4fee\u6539\u64cd\u4f5c\uff0c\u6700\u540e\u8fd8\u539f\u4e4b\u524d\u7684\u4fdd\u62a4\u72b6\u6001\uff1a # check protection status status = sheet.ProtectContents if status: sheet.Unprotect() # DO SOMETHING # reset protection status if status: sheet.Protect() \u5f00\u542f/\u5173\u95ed\u81ea\u52a8\u8ba1\u7b97 4 5 \u00b6 Excel\u9ed8\u8ba4\u5f00\u542f\u81ea\u52a8\u8ba1\u7b97\uff0c\u90a3\u4e48\u5f53\u5de5\u4f5c\u8868\u5185\u5355\u5143\u683c\u516c\u5f0f\u975e\u5e38\u591a\u65f6\uff0c\u6bcf\u5f55\u5165\u4e00\u4e2a\u6570\u636e\u90fd\u5c06\u89e6\u53d1\u76f8\u5173\u5355\u5143\u683c\u7684\u66f4\u65b0\u8ba1\u7b97\uff0c\u5f71\u54cd\u64cd\u4f5c\u6548\u7387\u3002\u56e0\u6b64\u6b64\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e00\u822c\u5148\u8bbe\u7f6e\u4e3a\u624b\u52a8\u66f4\u65b0\uff0c\u5f85\u8f93\u5165\u5b8c\u6210\u540e\u8bbe\u7f6e\u81ea\u52a8\u66f4\u65b0\u3002\u4ee5\u4e0b\u4e3a\u793a\u4f8b\u4ee3\u7801\uff1a # sample Excel and workbook app = win32com.client.Dispatch(\"Excel.Application\") wb = app.Workbooks.open(\"path/to/workbook\") # turn off automatic calculation to improve performance # otherwise, the entire worksheet will re-calculate every time a new input is entered app.Calculation = -4135 # xlCalculationManual # DO SOMETHING, e.g. ENTER DATA # turn on automatic calculation: xlCalculationAutomatic # but sometimes it's not able to re-calculate, so we should trigger it explicitly: # https://docs.microsoft.com/en-us/office/client-developer/excel/excel-recalculation # from the link, a simple way is adding an empty row, e.g. Row No.1000000, # then the active worksheet is re-calculated # # here we force to re-calculate the entire workbook # app.Calculation = -4105 wb.Application.CalculateFullRebuild() \u5f15\u7528\u7ba1\u7406 \u00b6 VBA\u4ee3\u7801\u53ef\u80fd\u8de8\u5de5\u4f5c\u7c3f\u5f15\u7528\u51fd\u6570\uff0c\u4f8b\u5982COM\u7ec4\u4ef6\u4e2d\u7684\u7c7b\u548c\u65b9\u6cd5\uff0c\u4f46\u524d\u671f\u53ef\u80fd\u6ca1\u6709\u6b63\u786e\u52a0\u8f7d\u8be5\u5f15\u7528\u3002\u624b\u5de5\u52a0\u8f7d\u5f15\u7528\u7684\u6d41\u7a0b\u4e3a\uff1a Developer -> Visual basic -> Tools -> References... \uff0c\u800c workbook.VBProject.References \u5219\u4ece\u7a0b\u5e8f\u8bbe\u7f6e\u7684\u89d2\u5ea6\u7ba1\u7406\u5f53\u524dVBA\u5de5\u7a0b\u5df2\u7ecf\u6dfb\u52a0\u7684\u5f15\u7528\u3002 \u4e00\u4e2a\u5f15\u7528\u901a\u5e38\u5305\u542b\u540d\u79f0\u3001\u8def\u5f84\u3001\u7248\u672c\u53f7\u7b49\u4fe1\u606f\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u904d\u5386\u663e\u793a\u6240\u6709\u5df2\u52a0\u8f7d\u5f15\u7528\u7684\u4fe1\u606f\uff1a for ref in wb.VBProject.References: print(ref.Name, ref.FullPath, ref.GUID, ref.Major, ref.Minor, ref.Description) AddFromFile() \u548c AddFromGuid() \u65b9\u6cd5\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u8def\u5f84\u548c GUID \u7684\u65b9\u5f0f\u6dfb\u52a0\u5f15\u7528\uff0c\u5176\u4e2d GUID \u7531\u521b\u5efaCOM\u7ec4\u4ef6\u65f6\u751f\u6210\u5e76\u5df2\u6ce8\u518c\u5230\u7cfb\u7edf\u3002\u6ce8\u610f\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0\uff0c\u5373\u5982\u679c\u4e22\u5931\u5219\u81ea\u52a8\u6dfb\u52a0\uff0c\u5426\u5219\u4e0d\u5904\u7406\u3002 guid, major_version, minor_version = \"{662901FC-6951-4854-9EB2-D9A2570F2B2E}\", 1, 0 loaded = False for ref in wb.VBProject.References: if ref.GUID == guid: if ref.IsBroken: # loaded but broken wb.VBProject.References.Remove(ref) else: loaded = True if not loaded: wb.VBProject.References.AddFromGuid(guid, major_version, minor_version) \u663e\u7136\uff0c\u8fd9\u90e8\u5206\u4ee3\u7801\u4e5f\u9700\u8981\u8bbe\u7f6e \u5141\u8bb8\u8bbf\u95eeVBA\u5de5\u7a0b\u5bf9\u8c61\u6a21\u578b \uff0c\u56e0\u4e3a\u7528\u5230\u4e86 wb.VBProject \u3002 Python for Windows (pywin32) Extensions \u21a9 win32.Dispatch vs win32.gencache in Python. What are the pros and cons? \u21a9 OLE-COM Object Viewer \u21a9 Excel Recalculation \u21a9 Getting Excel to refresh data on sheet from within VBA \u21a9","title":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/#python win32comexcel","text":"\u53d1\u5e03\u4e8e\uff1a2019-04-21 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Python\u6709\u5f88\u591a\u5f3a\u5927\u7684\u7b2c\u4e09\u65b9\u5e93\u53ef\u4ee5\u8bfb\u5199Excel\uff0c\u4f8b\u5982 xlrd \u3001 xlwt \u3001 xlutils \u3001 openpyxl \u3001 xlwings \u7b49\uff0c\u5b83\u4eec\u4e3b\u8981\u5728\u8bfb\u5199\u65b9\u9762\u5177\u5907\u4f18\u52bf\uff0c\u4f46\u8bba\u8d77\u5bf9Excel\u64cd\u4f5c\u7684\u5168\u9762\u6027\u548c\u57fa\u7840\u6027\uff0c\u5219\u9996\u63a8 win32com \uff0c\u5b83\u662f pywin32 \u5e93 1 \u7684\u4e00\u90e8\u5206\u3002\u672c\u6587\u8bb0\u5f55\u4f7f\u7528 win32com \u64cd\u4f5cExcel\u7684\u51e0\u4e2a\u6848\u4f8b\uff0c\u4f8b\u5982\u4e00\u822c\u7684\u8bfb\u5199\u3001\u5de5\u4f5c\u8868\u4fdd\u62a4\u3001\u81ea\u52a8\u8ba1\u7b97\u3001\u5f15\u7528\u7ba1\u7406\u7b49\u3002 \u5173\u4e8eVBA\u5b8f\u7684\u8bfb\u5199\u8fd0\u884c\u64cd\u4f5c\uff0c\u5355\u72ec\u5217\u4e3a\u4e00\u7bc7\uff1a 2019-09-13-Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199","title":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/#_1","text":"pip install pywin32 # \u5982\u679c\u9700\u8981\u7528\u5230\u7cfb\u7edf\u529f\u80fd\u4f8b\u5982\u6ce8\u518cCOM\u5bf9\u8c61\u3001Windows\u670d\u52a1\uff0c\u5219\u9700\u8981\u7ee7\u7eed\u6267\u884c\u5982\u4e0b\u5b89\u88c5 python Scripts/pywin32_postinstall.py -install","title":"\u5b89\u88c5"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/#_2","text":"\u7531\u4e8e win32com \u662f\u5bf9\u57fa\u672cCOM API\u7684\u5c01\u88c5\uff0c\u6240\u4ee5\u57fa\u672c\u529f\u80fd\u7684\u4f7f\u7528\u548cVBA\u6781\u4e3a\u7c7b\u4f3c\uff0c\u56e0\u6b64\u672c\u6587\u4e0d\u4f1a\u5728\u6b64\u65b9\u9762\u82b1\u8d39\u7bc7\u5e45\uff0c\u4ec5\u4ee5\u5982\u4e0b\u4f8b\u5b50\u4f5c\u53c2\u8003\uff1a import win32com.client # \u83b7\u53d6Excel Application # app = win32com.client.gencache.EnsureDispatch(\"Excel.Application\") app = win32com.client.Dispatch(\"Excel.Application\") app.Visible = False app.DisplayAlerts = False app.ScreenUpdating = False # \u6253\u5f00\u5de5\u4f5c\u7c3f # UpdateLinks=False \u907f\u514d\u6253\u5f00\u5de5\u4f5c\u7c3f\u65f6\u63d0\u793a\u66f4\u65b0\u94fe\u63a5 wb = app.Workbooks.Open(\"path/to/workbook\", UpdateLinks=False) # \u83b7\u53d6\u5de5\u4f5c\u7c3f\u540e\u5219\u53ef\u7c7b\u4f3cVBA\u64cd\u4f5c\uff0c\u4f8b\u5982\u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u8868\uff0c\u8fdb\u800c\u83b7\u53d6Range\u7b49 # Range\u5177\u6709Value, Address, Formula\u5c5e\u6027 wb.ActiveSheet.Range(\"A1\").Value = \"Hello World\" \u5176\u4e2d\u4f7f\u7528 Dispatch() \u548c EnsureDispatch() \u83b7\u53d6 COM \u5bf9\u8c61\u7684\u5dee\u522b\u53c2\u8003 2 \u3002 \u6211\u4eec\u66f4\u5173\u5fc3\u7684\u662f\u5982\u4f55\u83b7\u53d6API\uff0c\u5bf9\u4e8e\u7b80\u5355\u7684\u5e94\u7528\uff0c\u53ef\u4ee5\u53c2\u8003VBA\u4ee3\u7801\u63d0\u793a\u6216\u5f55\u5236\u7684\u5b8f\u8fdb\u884c\u8f6c\u6362\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u5176\u6b63\u786e\u6027\u3002\u8003\u8651\u5230 win32com \u662f\u5bf9Windows COM\u7ec4\u4ef6API\u7684\u5c01\u88c5\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u53c2\u8003\u539f\u59cbAPI\u6587\u6863\u3002\u5982\u679c\u5b89\u88c5\u4e86Visual Studio\uff0c\u53ef\u4ee5\u4ece\u5982\u4e0b\u76ee\u5f55\u627e\u5230 oleview.exe 3 \uff1a C:\\Program Files (x86)\\Windows Kits\\8.1\\bin\\x64\\oleview.exe \u6ce8\u610f \u4ee5\u7ba1\u7406\u5458\u65b9\u5f0f\u8fd0\u884c\u8be5\u7a0b\u5e8f \uff0c\u5426\u5219\u65e0\u6cd5\u6253\u5f00\u540e\u7eed\u7684\u6587\u6863\u3002\u7136\u540e\u4ece\u5de6\u4fa7\u9762\u677f\u7684 Type Libraries \u8282\u70b9\u67e5\u627e\u9700\u8981\u7684\u5185\u5bb9\uff0c\u4f8b\u5982\u5bf9\u4e8eExcel 2010\uff0c\u6211\u4eec\u6d4f\u89c8\u627e\u5230 Microsoft Excel 14.0 Object Library (Ver 1.7) \u3002\u53cc\u51fb\u6253\u5f00\u540e\u5373\u53ef\u770b\u5230\u8be6\u7ec6\u7684API\u6587\u6863\uff0c\u5305\u62ec\u7c7b\u53ca\u5176\u5c5e\u6027\u548c\u65b9\u6cd5\u3001\u5e38\u91cf\u7b49\u3002","title":"\u57fa\u672c\u64cd\u4f5c"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/#_3","text":"Protect() \u548c Unprotect() \u5f00\u542f/\u5173\u95ed\u5de5\u4f5c\u8868\u4fdd\u62a4\uff0c\u9002\u7528\u4e8e\u5bf9\u6709\u4fdd\u62a4\u7684\u5de5\u4f5c\u8868\u7684\u81ea\u52a8\u5316\u5904\u7406\u3002\u4e0b\u9762\u793a\u4f8b\u4ee3\u7801\u68c0\u6d4b\u5de5\u4f5c\u8868\u4fdd\u62a4\u72b6\u6001\uff0c\u5982\u679c\u88ab\u4fdd\u62a4\u5219\u53d6\u6d88\u4fdd\u62a4\u4ee5\u4fbf\u4fee\u6539\u64cd\u4f5c\uff0c\u6700\u540e\u8fd8\u539f\u4e4b\u524d\u7684\u4fdd\u62a4\u72b6\u6001\uff1a # check protection status status = sheet.ProtectContents if status: sheet.Unprotect() # DO SOMETHING # reset protection status if status: sheet.Protect()","title":"\u5f00\u542f/\u5173\u95ed\u5de5\u4f5c\u8868\u4fdd\u62a4"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/#4 5","text":"Excel\u9ed8\u8ba4\u5f00\u542f\u81ea\u52a8\u8ba1\u7b97\uff0c\u90a3\u4e48\u5f53\u5de5\u4f5c\u8868\u5185\u5355\u5143\u683c\u516c\u5f0f\u975e\u5e38\u591a\u65f6\uff0c\u6bcf\u5f55\u5165\u4e00\u4e2a\u6570\u636e\u90fd\u5c06\u89e6\u53d1\u76f8\u5173\u5355\u5143\u683c\u7684\u66f4\u65b0\u8ba1\u7b97\uff0c\u5f71\u54cd\u64cd\u4f5c\u6548\u7387\u3002\u56e0\u6b64\u6b64\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e00\u822c\u5148\u8bbe\u7f6e\u4e3a\u624b\u52a8\u66f4\u65b0\uff0c\u5f85\u8f93\u5165\u5b8c\u6210\u540e\u8bbe\u7f6e\u81ea\u52a8\u66f4\u65b0\u3002\u4ee5\u4e0b\u4e3a\u793a\u4f8b\u4ee3\u7801\uff1a # sample Excel and workbook app = win32com.client.Dispatch(\"Excel.Application\") wb = app.Workbooks.open(\"path/to/workbook\") # turn off automatic calculation to improve performance # otherwise, the entire worksheet will re-calculate every time a new input is entered app.Calculation = -4135 # xlCalculationManual # DO SOMETHING, e.g. ENTER DATA # turn on automatic calculation: xlCalculationAutomatic # but sometimes it's not able to re-calculate, so we should trigger it explicitly: # https://docs.microsoft.com/en-us/office/client-developer/excel/excel-recalculation # from the link, a simple way is adding an empty row, e.g. Row No.1000000, # then the active worksheet is re-calculated # # here we force to re-calculate the entire workbook # app.Calculation = -4105 wb.Application.CalculateFullRebuild()","title":"\u5f00\u542f/\u5173\u95ed\u81ea\u52a8\u8ba1\u7b97 4 5"},{"location":"2019-04-21-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E5%9F%BA%E6%9C%AC%E8%AF%BB%E5%86%99/#_4","text":"VBA\u4ee3\u7801\u53ef\u80fd\u8de8\u5de5\u4f5c\u7c3f\u5f15\u7528\u51fd\u6570\uff0c\u4f8b\u5982COM\u7ec4\u4ef6\u4e2d\u7684\u7c7b\u548c\u65b9\u6cd5\uff0c\u4f46\u524d\u671f\u53ef\u80fd\u6ca1\u6709\u6b63\u786e\u52a0\u8f7d\u8be5\u5f15\u7528\u3002\u624b\u5de5\u52a0\u8f7d\u5f15\u7528\u7684\u6d41\u7a0b\u4e3a\uff1a Developer -> Visual basic -> Tools -> References... \uff0c\u800c workbook.VBProject.References \u5219\u4ece\u7a0b\u5e8f\u8bbe\u7f6e\u7684\u89d2\u5ea6\u7ba1\u7406\u5f53\u524dVBA\u5de5\u7a0b\u5df2\u7ecf\u6dfb\u52a0\u7684\u5f15\u7528\u3002 \u4e00\u4e2a\u5f15\u7528\u901a\u5e38\u5305\u542b\u540d\u79f0\u3001\u8def\u5f84\u3001\u7248\u672c\u53f7\u7b49\u4fe1\u606f\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u904d\u5386\u663e\u793a\u6240\u6709\u5df2\u52a0\u8f7d\u5f15\u7528\u7684\u4fe1\u606f\uff1a for ref in wb.VBProject.References: print(ref.Name, ref.FullPath, ref.GUID, ref.Major, ref.Minor, ref.Description) AddFromFile() \u548c AddFromGuid() \u65b9\u6cd5\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u8def\u5f84\u548c GUID \u7684\u65b9\u5f0f\u6dfb\u52a0\u5f15\u7528\uff0c\u5176\u4e2d GUID \u7531\u521b\u5efaCOM\u7ec4\u4ef6\u65f6\u751f\u6210\u5e76\u5df2\u6ce8\u518c\u5230\u7cfb\u7edf\u3002\u6ce8\u610f\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0\uff0c\u5373\u5982\u679c\u4e22\u5931\u5219\u81ea\u52a8\u6dfb\u52a0\uff0c\u5426\u5219\u4e0d\u5904\u7406\u3002 guid, major_version, minor_version = \"{662901FC-6951-4854-9EB2-D9A2570F2B2E}\", 1, 0 loaded = False for ref in wb.VBProject.References: if ref.GUID == guid: if ref.IsBroken: # loaded but broken wb.VBProject.References.Remove(ref) else: loaded = True if not loaded: wb.VBProject.References.AddFromGuid(guid, major_version, minor_version) \u663e\u7136\uff0c\u8fd9\u90e8\u5206\u4ee3\u7801\u4e5f\u9700\u8981\u8bbe\u7f6e \u5141\u8bb8\u8bbf\u95eeVBA\u5de5\u7a0b\u5bf9\u8c61\u6a21\u578b \uff0c\u56e0\u4e3a\u7528\u5230\u4e86 wb.VBProject \u3002 Python for Windows (pywin32) Extensions \u21a9 win32.Dispatch vs win32.gencache in Python. What are the pros and cons? \u21a9 OLE-COM Object Viewer \u21a9 Excel Recalculation \u21a9 Getting Excel to refresh data on sheet from within VBA \u21a9","title":"\u5f15\u7528\u7ba1\u7406"},{"location":"2019-05-02-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%AC%E5%BC%8F%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/","text":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-05-02 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Excel\u4e2d\u67d0\u4e2a\u5355\u5143\u683c\u7684\u8ba1\u7b97\u7ed3\u679c\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u5355\u5143\u683c\u8ba1\u7b97\u516c\u5f0f\u7684\u4e00\u90e8\u5206\uff0c\u5373\u4e8c\u8005\u5b58\u5728\u4f9d\u8d56/\u5f15\u7528\u7684\u5173\u7cfb\u3002\u5c24\u5176\u662f\u5bf9\u4e8e\u590d\u6742\u7684\u8868\u683c\uff0c\u8fd9\u79cd\u4f9d\u8d56\u5173\u7cfb\u53ef\u4ee5\u65b9\u4fbf\u6211\u4eec\u8ffd\u8e2a\u6570\u636e\u7684\u76f8\u4e92\u4f5c\u7528\u3002Excel\u5df2\u7ecf\u5728 Formula -> Formula Auditing \u7ec4\u63d0\u4f9b\u4e86\u53ef\u89c6\u5316\u516c\u5f0f\u5f15\u7528\u5173\u7cfb\u7684\u529f\u80fd\uff1a Trace Precedents \u548c Trace Dependents \uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u76f8\u5e94\u7684API\u6765\u7f16\u7a0b\u83b7\u53d6\u5f15\u7528\u5173\u7cfb\u3002\u672c\u6587\u5373\u8bb0\u5f55\u4f7f\u7528Python\u7684 win32com \u6a21\u5757\u6765\u5b9e\u73b0\u4e4b\u3002 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5047\u8bbe\u51e0\u4e2a\u5355\u5143\u683c\u7684\u516c\u5f0f\u5982\u4e0b\uff1a ## sheet1: A1=1 B1=A1+1 B2=A1+2 ## sheet2 B1=Sheet1!A1+1 B1=Sheet1!A1+2 \u663e\u7136 B1 \u7684\u503c\u4f9d\u8d56\u4e8e A1 \uff0cExcel\u4e2d\u5c06 B1 \u79f0\u4e3a A1 \u7684dependents\uff0c A1 \u79f0\u4e3a B1 \u7684Precedents\u3002\u540c\u7406 B2 \uff0c\u4ee5\u53casheet2\u4e2d\u7684 B1 \u3001 B2 \u90fd\u662f A1 \u7684Dependents\uff1b\u5e76\u4e14\uff0c B1 \u548c B2 \u4e5f\u53ef\u4ee5\u6709\u81ea\u5df1\u7684Dependents\u3002\u8fd9\u6837\u7684\u8bdd\uff0c sheet1!B1 \u3001 sheet1!B2 \u3001 sheet2!B1 \u548c sheet2!B2 \u662f A1 \u7684\u76f4\u63a5Dependents\uff0c\u800c sheet1!B1 \u3001 sheet1!B2 \u3001 sheet2!B1 \u548c sheet2!B2 \u7684Dependents\u90fd\u662f A1 \u7684\u95f4\u63a5Dependents\u3002 \u5728Excel\u4e2d\u5c06\u5149\u6807\u5b9a\u4f4d\u5230 A1 \uff0c\u7136\u540e\u70b9\u51fb Formula -> Formula Auditing -> Trace Dependents \uff0c\u4f1a\u51fa\u73b0\u4e09\u4e2a\u8868\u793a\u5f15\u7528\u5173\u7cfb\u7684\u7bad\u5934\u3002\u5176\u4e2d\u4e24\u4e2a\u5b9e\u7ebf\u7bad\u5934\u6307\u5411\u5f53\u524d\u5de5\u4f5c\u8868\u5185\u7684\u4e24\u4e2a\u5f15\u7528 sheet1!B1 \u548c sheet1!B2 \uff0c\u865a\u7ebf\u7bad\u5934\u6307\u5411\u5176\u4ed6\u5de5\u4f5c\u8868\u7684\u5f15\u7528\u5373 sheet2!B1 \u548c sheet2!B2 \u3002\u53cc\u51fb\u865a\u7ebf\u7bad\u5934\u4f1a\u51fa\u73b0 Go To \u5bf9\u8bdd\u6846\uff0c\u5176\u4e2d\u5217\u51fa\u4e86 sheet2!B1 \u548c sheet2!B2 \uff0c\u9009\u62e9\u76f8\u5e94\u8bb0\u5f55\u5373\u53ef\u8df3\u8f6c\u5230\u76ee\u6807\u4f4d\u7f6e\u3002 Trace Dependents \u64cd\u4f5c\u53ca\u5176\u610f\u4e49\u540c\u7406\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7684\u95ee\u9898\u662f\u5982\u4f55\u4f7f\u7528Python\u7684 win32com \u6a21\u5757\u627e\u51fa A1 \u7684\u6240\u6709Dependents\u3002 \u51c6\u5907\u5de5\u4f5c \u00b6 win32com \u6a21\u5757\u662f pywin32 \u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u5728\u547d\u4ee4\u884c\u8fd0\u884c\u4e0b\u9762\u6307\u4ee4\u8fdb\u884c\u5b89\u88c5 pip install pywin32 \u5173\u4e8e win32com \u64cd\u4f5cExcel\u7684\u57fa\u672c\u4ee3\u7801\u53ef\u4ee5\u53c2\u8003 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 \u5f53\u524d\u5de5\u4f5c\u8868\u5185\u7684\u5f15\u7528 \u00b6 Excel Range \u5bf9\u8c61\u7684\u4e24\u4e2a\u5c5e\u6027 precedents \u548c dependents \u8bb0\u5f55\u4e86\u5f53\u524d\u5de5\u4f5c\u8868\u8303\u56f4\u5185\u7684\u4f9d\u8d56/\u5f15\u7528\u5173\u7cfb\uff0c\u672c\u4f8b\u4e2d Range('A1').dependents = Range('B1'), Range('B2') \u8003\u8651\u5230\u8be5\u5c5e\u6027\u4e0d\u80fd\u5728\u67d0\u4e2a\u5355\u5143\u683c\u4e0d\u5b58\u5728\u516c\u5f0f\u4e0a\u7684\u5f15\u7528\u5173\u7cfb\u65f6\u4f7f\u7528\uff0c\u5219\u53ef\u4ee5\u7ec4\u7ec7Python\u4ee3\u7801\u5982\u4e0b\uff1a def get_direct_precedents(rng): '''get all precedents of current range from current sheet''' try: res = [x.address for x in rng.precedents] except Exception as e: res = [] return res def get_direct_dependents(rng): '''get all dependents of current range from current sheet''' try: res = [x.address for x in rng.dependents] except Exception as e: res = [] return res \u5de5\u4f5c\u7c3f\u5185\u7684\u5f15\u7528 \u00b6 \u672c\u4f8b\u4e2d\uff0c\u5982\u4f55\u624d\u80fd\u83b7\u53d6\u5230sheet2\u5de5\u4f5c\u8868\u4e2d B1 \u5bf9sheet1\u4e2d A1 \u7684\u5f15\u7528\u5173\u7cfb\u5462\uff1f\u6211\u4eec\u9700\u8981\u4f7f\u7528\u66f4\u4e00\u822c\u7684\u83b7\u53d6\u5f15\u7528\u5173\u7cfb\u7684\u51fd\u6570 NavigateArrow 1 \uff1a Range.NavigateArrow (TowardPrecedent, ArrowNumber, LinkNumber) \u8fd9\u4e2a\u51fd\u6570\u540d\u79f0\u5f88\u5f62\u8c61\uff0c\u5bf9\u5e94Excel\u4e2d\u663e\u793a\u4f9d\u8d56/\u5f15\u7528\u7bad\u5934\u7684\u64cd\u4f5c\uff0c\u5176\u4e2d\uff0c TowardPrecedent \u8868\u793a\u67e5\u627e\u7bad\u5934\u7684\u65b9\u5411\uff0c True \u8868\u793a\u67e5\u627eprecedents\uff0c False \u8868\u793a\u67e5\u627edependents ArrowNumber \u8868\u793a\u7bad\u5934\u7684\u5e8f\u53f7\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u6709\u4e09\u4e2a\u7bad\u5934\uff0c\u5219\u4f9d\u6b21\u53d6\u4e3a1\uff0c2\uff0c3 LinkNumber \u4ec5\u5bf9\u5de5\u4f5c\u8868\u5916\u5f15\u7528\u6709\u6548\uff0c\u8868\u793a\u5de5\u4f5c\u8868\u5916\u5f15\u7528\u7684\u5e8f\u53f7\u3002\u4f8b\u5982\u672c\u4f8b\u4e2d\u7684 sheet2!B1 \u548c sheet2!B2 \uff0c\u5bf9\u5e94\u4e86\u5e8f\u53f71\uff0c2 \u8fd9\u6837\u7684\u8bdd\uff0c Range('A1').NavigateArrow(False, 3, 2) \u5373\u8868\u793a Sheet2!B2 \u3002 NavigateArrow \u4ec5\u4ec5\u83b7\u53d6\u4e86\u76f4\u63a5\u5f15\u7528\uff0c\u7ee7\u7eed\u9012\u5f52\u76f4\u63a5\u5f15\u7528\u5373\u53ef\u83b7\u53d6\u6240\u6709\u7684\u95f4\u63a5\u5f15\u7528\u4e86\u3002\u7ed3\u5408\u6b64\u601d\u8def\uff0c\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a def get_all_dependents(xlApp, rng): '''get all dependents of current range from all worksheets''' # show dependents arrows first rng.ShowDependents() i, j = 0, 0 res = set() while True: i += 1 # navigate to next dependent: # - True -> precedents direction # - False -> dependent direction returnRange = rng.NavigateArrow(False, i) # if it's an external reference -> parent sheets are different if rng.Parent.Name != returnRange.Parent.Name: while returnRange: j += 1 try: returnRange = rng.NavigateArrow(False, i, j) res.add((returnRange.Parent.Name, returnRange.address)) res |= get_all_dependents(xlApp, returnRange) except Exception as e: # out of range: NavigateArrow method of Range class failed returnRange = None # if it's an internal reference else: # the last reference would be itself -> then stop the loop # for merged ranges, the last reference is the first cell if xlApp.Intersect(returnRange, rng): break res.add((returnRange.Parent.Name, returnRange.address)) res |= get_all_dependents(xlApp, returnRange) return res \u81f3\u6b64\uff0c\u4e3b\u8981\u5185\u5bb9\u5df2\u7ed3\u675f\u3002\u5bf9\u4e8e\u5f15\u7528\u5173\u7cfb\u590d\u6742\u7684\u5de5\u4f5c\u7c3f\uff0c\u4e0a\u8ff0\u8fd4\u56de\u96c6\u5408\u53ef\u80fd\u975e\u5e38\u5927\uff0c\u56e0\u6b64\u8003\u8651\u751f\u6210\u5668\u7684\u7248\u672c\uff1a def get_all_dependents(xlApp, rng): '''get all dependents of current range from all worksheets''' # show dependents arrows first rng.ShowDependents() i, j = 0, 0 while True: i += 1 # navigate to next dependent: # - True -> precedents direction # - False -> dependent direction returnRange = rng.NavigateArrow(False, i) # if it's an external reference -> parent sheets are different if rng.Parent.Name != returnRange.Parent.Name: while returnRange: j += 1 try: returnRange = rng.NavigateArrow(False, i, j) yield (returnRange.Parent.Name, returnRange.address) # it does not work if just call this generator, # instead it should be iterated explicitly # get_all_dependents(xlApp, returnRange) for x in get_all_dependents(xlApp, returnRange): yield x except Exception as e: # out of range: NavigateArrow method of Range class failed returnRange = None # if it's an internal reference else: # the last reference would be itself -> then stop the loop # for merged ranges, the last reference is the first cell if xlApp.Intersect(returnRange, rng): break yield (returnRange.Parent.Name, returnRange.address) for x in get_all_dependents(xlApp, returnRange): yield x yield \u5173\u952e\u5b57\u53ef\u4ee5\u65b9\u4fbf\u5730\u5c06\u666e\u901a\u51fd\u6570\u8f6c\u4e3a\u751f\u6210\u5668\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u8f6c\u6362\u9012\u5f52\u51fd\u6570\u65f6\uff0c\u9700\u8981\u663e\u5f0f\u5730\u8fed\u4ee3\u751f\u6210\u5668\uff0c\u5426\u5219\u5b83\u4e0d\u4f1a\u81ea\u52a8\u8ba1\u7b97\u4e0b\u4e00\u4e2a\u503c\u3002 Range.NavigateArrow method (Excel) \u21a9","title":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb"},{"location":"2019-05-02-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%AC%E5%BC%8F%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/#python win32comexcel","text":"\u53d1\u5e03\u4e8e\uff1a2019-05-02 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Excel\u4e2d\u67d0\u4e2a\u5355\u5143\u683c\u7684\u8ba1\u7b97\u7ed3\u679c\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u5355\u5143\u683c\u8ba1\u7b97\u516c\u5f0f\u7684\u4e00\u90e8\u5206\uff0c\u5373\u4e8c\u8005\u5b58\u5728\u4f9d\u8d56/\u5f15\u7528\u7684\u5173\u7cfb\u3002\u5c24\u5176\u662f\u5bf9\u4e8e\u590d\u6742\u7684\u8868\u683c\uff0c\u8fd9\u79cd\u4f9d\u8d56\u5173\u7cfb\u53ef\u4ee5\u65b9\u4fbf\u6211\u4eec\u8ffd\u8e2a\u6570\u636e\u7684\u76f8\u4e92\u4f5c\u7528\u3002Excel\u5df2\u7ecf\u5728 Formula -> Formula Auditing \u7ec4\u63d0\u4f9b\u4e86\u53ef\u89c6\u5316\u516c\u5f0f\u5f15\u7528\u5173\u7cfb\u7684\u529f\u80fd\uff1a Trace Precedents \u548c Trace Dependents \uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u76f8\u5e94\u7684API\u6765\u7f16\u7a0b\u83b7\u53d6\u5f15\u7528\u5173\u7cfb\u3002\u672c\u6587\u5373\u8bb0\u5f55\u4f7f\u7528Python\u7684 win32com \u6a21\u5757\u6765\u5b9e\u73b0\u4e4b\u3002","title":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb"},{"location":"2019-05-02-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%AC%E5%BC%8F%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/#_1","text":"\u5047\u8bbe\u51e0\u4e2a\u5355\u5143\u683c\u7684\u516c\u5f0f\u5982\u4e0b\uff1a ## sheet1: A1=1 B1=A1+1 B2=A1+2 ## sheet2 B1=Sheet1!A1+1 B1=Sheet1!A1+2 \u663e\u7136 B1 \u7684\u503c\u4f9d\u8d56\u4e8e A1 \uff0cExcel\u4e2d\u5c06 B1 \u79f0\u4e3a A1 \u7684dependents\uff0c A1 \u79f0\u4e3a B1 \u7684Precedents\u3002\u540c\u7406 B2 \uff0c\u4ee5\u53casheet2\u4e2d\u7684 B1 \u3001 B2 \u90fd\u662f A1 \u7684Dependents\uff1b\u5e76\u4e14\uff0c B1 \u548c B2 \u4e5f\u53ef\u4ee5\u6709\u81ea\u5df1\u7684Dependents\u3002\u8fd9\u6837\u7684\u8bdd\uff0c sheet1!B1 \u3001 sheet1!B2 \u3001 sheet2!B1 \u548c sheet2!B2 \u662f A1 \u7684\u76f4\u63a5Dependents\uff0c\u800c sheet1!B1 \u3001 sheet1!B2 \u3001 sheet2!B1 \u548c sheet2!B2 \u7684Dependents\u90fd\u662f A1 \u7684\u95f4\u63a5Dependents\u3002 \u5728Excel\u4e2d\u5c06\u5149\u6807\u5b9a\u4f4d\u5230 A1 \uff0c\u7136\u540e\u70b9\u51fb Formula -> Formula Auditing -> Trace Dependents \uff0c\u4f1a\u51fa\u73b0\u4e09\u4e2a\u8868\u793a\u5f15\u7528\u5173\u7cfb\u7684\u7bad\u5934\u3002\u5176\u4e2d\u4e24\u4e2a\u5b9e\u7ebf\u7bad\u5934\u6307\u5411\u5f53\u524d\u5de5\u4f5c\u8868\u5185\u7684\u4e24\u4e2a\u5f15\u7528 sheet1!B1 \u548c sheet1!B2 \uff0c\u865a\u7ebf\u7bad\u5934\u6307\u5411\u5176\u4ed6\u5de5\u4f5c\u8868\u7684\u5f15\u7528\u5373 sheet2!B1 \u548c sheet2!B2 \u3002\u53cc\u51fb\u865a\u7ebf\u7bad\u5934\u4f1a\u51fa\u73b0 Go To \u5bf9\u8bdd\u6846\uff0c\u5176\u4e2d\u5217\u51fa\u4e86 sheet2!B1 \u548c sheet2!B2 \uff0c\u9009\u62e9\u76f8\u5e94\u8bb0\u5f55\u5373\u53ef\u8df3\u8f6c\u5230\u76ee\u6807\u4f4d\u7f6e\u3002 Trace Dependents \u64cd\u4f5c\u53ca\u5176\u610f\u4e49\u540c\u7406\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7684\u95ee\u9898\u662f\u5982\u4f55\u4f7f\u7528Python\u7684 win32com \u6a21\u5757\u627e\u51fa A1 \u7684\u6240\u6709Dependents\u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"2019-05-02-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%AC%E5%BC%8F%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/#_2","text":"win32com \u6a21\u5757\u662f pywin32 \u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u5728\u547d\u4ee4\u884c\u8fd0\u884c\u4e0b\u9762\u6307\u4ee4\u8fdb\u884c\u5b89\u88c5 pip install pywin32 \u5173\u4e8e win32com \u64cd\u4f5cExcel\u7684\u57fa\u672c\u4ee3\u7801\u53ef\u4ee5\u53c2\u8003 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"2019-05-02-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%AC%E5%BC%8F%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/#_3","text":"Excel Range \u5bf9\u8c61\u7684\u4e24\u4e2a\u5c5e\u6027 precedents \u548c dependents \u8bb0\u5f55\u4e86\u5f53\u524d\u5de5\u4f5c\u8868\u8303\u56f4\u5185\u7684\u4f9d\u8d56/\u5f15\u7528\u5173\u7cfb\uff0c\u672c\u4f8b\u4e2d Range('A1').dependents = Range('B1'), Range('B2') \u8003\u8651\u5230\u8be5\u5c5e\u6027\u4e0d\u80fd\u5728\u67d0\u4e2a\u5355\u5143\u683c\u4e0d\u5b58\u5728\u516c\u5f0f\u4e0a\u7684\u5f15\u7528\u5173\u7cfb\u65f6\u4f7f\u7528\uff0c\u5219\u53ef\u4ee5\u7ec4\u7ec7Python\u4ee3\u7801\u5982\u4e0b\uff1a def get_direct_precedents(rng): '''get all precedents of current range from current sheet''' try: res = [x.address for x in rng.precedents] except Exception as e: res = [] return res def get_direct_dependents(rng): '''get all dependents of current range from current sheet''' try: res = [x.address for x in rng.dependents] except Exception as e: res = [] return res","title":"\u5f53\u524d\u5de5\u4f5c\u8868\u5185\u7684\u5f15\u7528"},{"location":"2019-05-02-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%AC%E5%BC%8F%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/#_4","text":"\u672c\u4f8b\u4e2d\uff0c\u5982\u4f55\u624d\u80fd\u83b7\u53d6\u5230sheet2\u5de5\u4f5c\u8868\u4e2d B1 \u5bf9sheet1\u4e2d A1 \u7684\u5f15\u7528\u5173\u7cfb\u5462\uff1f\u6211\u4eec\u9700\u8981\u4f7f\u7528\u66f4\u4e00\u822c\u7684\u83b7\u53d6\u5f15\u7528\u5173\u7cfb\u7684\u51fd\u6570 NavigateArrow 1 \uff1a Range.NavigateArrow (TowardPrecedent, ArrowNumber, LinkNumber) \u8fd9\u4e2a\u51fd\u6570\u540d\u79f0\u5f88\u5f62\u8c61\uff0c\u5bf9\u5e94Excel\u4e2d\u663e\u793a\u4f9d\u8d56/\u5f15\u7528\u7bad\u5934\u7684\u64cd\u4f5c\uff0c\u5176\u4e2d\uff0c TowardPrecedent \u8868\u793a\u67e5\u627e\u7bad\u5934\u7684\u65b9\u5411\uff0c True \u8868\u793a\u67e5\u627eprecedents\uff0c False \u8868\u793a\u67e5\u627edependents ArrowNumber \u8868\u793a\u7bad\u5934\u7684\u5e8f\u53f7\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u6709\u4e09\u4e2a\u7bad\u5934\uff0c\u5219\u4f9d\u6b21\u53d6\u4e3a1\uff0c2\uff0c3 LinkNumber \u4ec5\u5bf9\u5de5\u4f5c\u8868\u5916\u5f15\u7528\u6709\u6548\uff0c\u8868\u793a\u5de5\u4f5c\u8868\u5916\u5f15\u7528\u7684\u5e8f\u53f7\u3002\u4f8b\u5982\u672c\u4f8b\u4e2d\u7684 sheet2!B1 \u548c sheet2!B2 \uff0c\u5bf9\u5e94\u4e86\u5e8f\u53f71\uff0c2 \u8fd9\u6837\u7684\u8bdd\uff0c Range('A1').NavigateArrow(False, 3, 2) \u5373\u8868\u793a Sheet2!B2 \u3002 NavigateArrow \u4ec5\u4ec5\u83b7\u53d6\u4e86\u76f4\u63a5\u5f15\u7528\uff0c\u7ee7\u7eed\u9012\u5f52\u76f4\u63a5\u5f15\u7528\u5373\u53ef\u83b7\u53d6\u6240\u6709\u7684\u95f4\u63a5\u5f15\u7528\u4e86\u3002\u7ed3\u5408\u6b64\u601d\u8def\uff0c\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a def get_all_dependents(xlApp, rng): '''get all dependents of current range from all worksheets''' # show dependents arrows first rng.ShowDependents() i, j = 0, 0 res = set() while True: i += 1 # navigate to next dependent: # - True -> precedents direction # - False -> dependent direction returnRange = rng.NavigateArrow(False, i) # if it's an external reference -> parent sheets are different if rng.Parent.Name != returnRange.Parent.Name: while returnRange: j += 1 try: returnRange = rng.NavigateArrow(False, i, j) res.add((returnRange.Parent.Name, returnRange.address)) res |= get_all_dependents(xlApp, returnRange) except Exception as e: # out of range: NavigateArrow method of Range class failed returnRange = None # if it's an internal reference else: # the last reference would be itself -> then stop the loop # for merged ranges, the last reference is the first cell if xlApp.Intersect(returnRange, rng): break res.add((returnRange.Parent.Name, returnRange.address)) res |= get_all_dependents(xlApp, returnRange) return res \u81f3\u6b64\uff0c\u4e3b\u8981\u5185\u5bb9\u5df2\u7ed3\u675f\u3002\u5bf9\u4e8e\u5f15\u7528\u5173\u7cfb\u590d\u6742\u7684\u5de5\u4f5c\u7c3f\uff0c\u4e0a\u8ff0\u8fd4\u56de\u96c6\u5408\u53ef\u80fd\u975e\u5e38\u5927\uff0c\u56e0\u6b64\u8003\u8651\u751f\u6210\u5668\u7684\u7248\u672c\uff1a def get_all_dependents(xlApp, rng): '''get all dependents of current range from all worksheets''' # show dependents arrows first rng.ShowDependents() i, j = 0, 0 while True: i += 1 # navigate to next dependent: # - True -> precedents direction # - False -> dependent direction returnRange = rng.NavigateArrow(False, i) # if it's an external reference -> parent sheets are different if rng.Parent.Name != returnRange.Parent.Name: while returnRange: j += 1 try: returnRange = rng.NavigateArrow(False, i, j) yield (returnRange.Parent.Name, returnRange.address) # it does not work if just call this generator, # instead it should be iterated explicitly # get_all_dependents(xlApp, returnRange) for x in get_all_dependents(xlApp, returnRange): yield x except Exception as e: # out of range: NavigateArrow method of Range class failed returnRange = None # if it's an internal reference else: # the last reference would be itself -> then stop the loop # for merged ranges, the last reference is the first cell if xlApp.Intersect(returnRange, rng): break yield (returnRange.Parent.Name, returnRange.address) for x in get_all_dependents(xlApp, returnRange): yield x yield \u5173\u952e\u5b57\u53ef\u4ee5\u65b9\u4fbf\u5730\u5c06\u666e\u901a\u51fd\u6570\u8f6c\u4e3a\u751f\u6210\u5668\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u8f6c\u6362\u9012\u5f52\u51fd\u6570\u65f6\uff0c\u9700\u8981\u663e\u5f0f\u5730\u8fed\u4ee3\u751f\u6210\u5668\uff0c\u5426\u5219\u5b83\u4e0d\u4f1a\u81ea\u52a8\u8ba1\u7b97\u4e0b\u4e00\u4e2a\u503c\u3002 Range.NavigateArrow method (Excel) \u21a9","title":"\u5de5\u4f5c\u7c3f\u5185\u7684\u5f15\u7528"},{"location":"2019-05-22-Matplotlib%E5%A4%9A%E7%BA%B5%E8%BD%B4%EF%BC%88%E5%AF%84%E7%94%9F%E8%BD%B4%EF%BC%89%E6%95%A3%E7%82%B9%E5%9B%BE/","text":"Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-05-22 | \u5206\u7c7b\uff1a python/vba/cpp \u6211\u4eec\u77e5\u9053 Matplotlib \u6563\u70b9\u56fe\u7684\u4e00\u4e2a\u7eb5\u8f74\u4e0a\u53ef\u4ee5\u753b\u591a\u6761\u66f2\u7ebf\uff0c\u5f53\u7eb5\u8f74\u6570\u636e\u5c5e\u4e8e\u4e0d\u540c\u7c7b\u578b\uff08\u4f8b\u5982\u6e29\u5ea6\u548c\u538b\u529b\uff09\u6216\u8005\u4e0d\u540c\u5c3a\u5ea6\uff0c\u90a3\u5c31\u9700\u8981\u66f4\u591a\u7684\u7eb5\u8f74\u6765\u5206\u522b\u5bb9\u7eb3\u3002\u8fd9\u7c7b\u4f3c\u4e8eExcel\u56fe\u8868\u4e2d\u7684\u6b21\u5750\u6807\u8f74\uff0c\u53ea\u4e0d\u8fc7 Matplotlib \u53ef\u4ee5\u5448\u73b0\u66f4\u591a\u7684\u7eb5\u8f74\u3002\u672c\u6587\u57fa\u4e8e Matplotlib \u5b98\u7f51\u7ed9\u51fa\u7684\u5b9e\u4f8b\u5c01\u88c5\u4e86\u4e00\u4e2a\u5b9e\u73b0\u5bc4\u751f\u8f74\u6563\u70b9\u56fe\u7684\u51fd\u6570\u3002 \u6982\u8ff0 \u00b6 \u8fd9\u4e9b\u7eb5\u8f74 y axes \u5171\u4eab\u540c\u4e00\u6a2a\u8f74 x axes \u6570\u636e\uff0c\u56e0\u6b64\u6709\u4e24\u79cd\u601d\u8def\u53ef\u4ee5\u5b9e\u73b0\uff1a \u5b6a\u751f\u8f74 matplotlib.axes.Axes.twinx \uff0c\u57fa\u4e8e\u540c\u4e00\u4e2ax\u8f74\u4f46\u5404\u81ea\u72ec\u7acb\u7684\u4e00\u7cfb\u5217\u8f74 \u5bc4\u751f\u8f74\uff0c\u5305\u62ec\u4e00\u4e2a\u4e3b\u8f74 parasite_axes.HostAxes \u548c\u4ece\u4e3b\u8f74\u6784\u9020\u7684\u591a\u4e2a\u5bc4\u751f\u8f74 parasite_axes.ParasiteAxes Matplotlib \u5b98\u7f51\u7ed9\u51fa\u4e86\u4e09\u4e2a\u5b9e\u4f8b\uff0c\u5206\u522b\u91c7\u7528\u4e86\u666e\u901a\u5b6a\u751f\u8f74\uff0c\u57fa\u4e8e parasite_axes \u4e0b host_subplot \u7684\u5b6a\u751f\u8f74\uff0c\u4ee5\u53ca parasite_axes \u4e0b\u5bc4\u751f\u8f74\u7684\u65b9\u6cd5\uff1a Multiple Yaxis With Spines Demo Parasite Axes2 Parasite Axes demo \u4ee3\u7801 \u00b6 \u672c\u6587\u57fa\u4e8e parasite_axes \u5bc4\u751f\u8f74\u7684\u65b9\u5f0f\u5c01\u88c5\u4e86\u5982\u4e0b\u51fd\u6570\uff1a ''' Create a parasite axes, which would share the x scale with a host axes, but show a different scale in y direction. This approach uses the parasite_axes' HostAxes and ParasiteAxes referenced from: https://matplotlib.org/3.1.1/gallery/axisartist/demo_parasite_axes.html params: xdata: 1d numpy array ydata: a list of structured array, each array represents one or more curves in associated y-axis. the field name of structured array become curve label. A reference to structed array: https://docs.scipy.org/doc/numpy/user/basics.rec.html xlabel: x label, `X` by default ylabels: list of label for each parasite axes, Y-0, Y-1 by default title: figure title colors: a list of colors for each curve, jet colormap by default markers: a list of markers for each curve, none by default linestyles: a list of line styles for each curve, solid line ('-') by default savefile: save figure if true else plot only colors, markers, linestyles are ignored if the length less than the count of all curves. ''' import matplotlib.pyplot as plt from mpl_toolkits.axisartist.parasite_axes import HostAxes, ParasiteAxes from matplotlib import cm import numpy as np def parasite_axes(xdata, ydata, xlabel=None, ylabels=None, title=None, colors=None, markers=None, linestyles=None, savefile=None): fig = plt.figure(figsize=(10,7)) # host axis # - span for plotting multi-y axes # - hide axes span = 0.05*len(ydata) + 0.01 host = HostAxes(fig, [span, 0.1, 0.88-span, 0.8]) # left, bottom, width, height host.axis['left','right'].set_visible(False) host.axis['top'].toggle(all=False) host.set_xlabel(xlabel if xlabel else 'X') host.set_xlim(int(min(xdata)), int(max(xdata))) # create parasite axes para_axes = [ParasiteAxes(host, sharex=host) for _ in ydata] # count of curves in all axes num = sum(len(data.dtype.names) for data in ydata) if not ylabels: ylabels = ['Y-{0}'.format(i) for i in range(len(ydata))] if not colors or len(colors)<num: colors = [cm.jet(x) for x in np.linspace(0.0, 1.0, num)] if not linestyles or len(linestyles)<num: linestyles = ['-'] * num if not markers or len(markers)<num: markers = [''] * num curve_index = 0 for i, (par, ylabel, data) in enumerate(zip(para_axes, ylabels, ydata)): host.parasites.append(par) par.axis['new_left'] = par._grid_helper.new_fixed_axis( loc='left', axes=par, offset=(-35*i, 0)) # add curve for curve_name in data.dtype.names: par.plot(xdata, data[curve_name], label=curve_name, color=colors[curve_index], linestyle=linestyles[curve_index], marker=markers[curve_index], linewidth=0.5) curve_index += 1 # label par.set_ylabel(ylabel) par.axis['left'].label.set_pad(0) # limits and ticks # numpy_array = data.view((data.dtype[0], len(data.dtype.names))) numpy_array = np.array(data.tolist()) y_min, y_max = np.min(numpy_array), np.max(numpy_array) ylim_min = round(y_min-0.1*(y_max-y_min), 1) ylim_max = round(y_max+0.2*(y_max-y_min), 1) par.set_ylim(ylim_min, ylim_max) par.set_yticks(np.linspace(ylim_min, ylim_max, 5)) par.axis['new_left'].major_ticklabels.set_axis_direction('top') # grid on para_axes[0].grid(True, linestyle='--') para_axes[0].axis['right'].set_visible(True) host.set_title(title if title else 'No Title') host.legend(loc='upper left', bbox_to_anchor=(1.01, 1)) fig.add_axes(host) if not savefile: plt.show() else: plt.savefig(savefile, dpi=120) if __name__ == '__main__': xdata = np.linspace(1, 10, 20) ydata = [None] * 3 ylabels = [] colors, linestyles, markers = [], [], [] # y axis 1 ydata[0] = np.core.records.fromarrays([np.exp(xdata/10)], names='np.exp(x/10)') ylabels.append('exponential function') colors.append('r') linestyles.append('-') markers.append('') # y axis 2 ydata[1] = np.core.records.fromarrays([np.sin(xdata), np.cos(xdata)], names='y=sin(x), y=cos(x)') ylabels.append('trigonometric functions') colors.extend(['g']*2) linestyles.extend(['-', '--']) markers.extend(['', 'o']) # y axis 3 ydata[2] = np.core.records.fromarrays([xdata**1.5, xdata, xdata**0.5], names='y=x^1.5, y=x, y=x^0.5') ylabels.append('power functions') colors.extend(['b']*3) linestyles.extend(['-', '--', '-.']) markers.extend(['', 'o', '^']) parasite_axes(xdata, ydata, title='Sample Parasite Axes', xlabel='sample x', ylabels=ylabels, colors=colors, linestyles=linestyles, markers=markers) \u6d4b\u8bd5\u5b9e\u4f8b\u663e\u793a\u7ed3\u679c\u5982\u4e0b\uff1a","title":"Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe"},{"location":"2019-05-22-Matplotlib%E5%A4%9A%E7%BA%B5%E8%BD%B4%EF%BC%88%E5%AF%84%E7%94%9F%E8%BD%B4%EF%BC%89%E6%95%A3%E7%82%B9%E5%9B%BE/#matplotlib","text":"\u53d1\u5e03\u4e8e\uff1a2019-05-22 | \u5206\u7c7b\uff1a python/vba/cpp \u6211\u4eec\u77e5\u9053 Matplotlib \u6563\u70b9\u56fe\u7684\u4e00\u4e2a\u7eb5\u8f74\u4e0a\u53ef\u4ee5\u753b\u591a\u6761\u66f2\u7ebf\uff0c\u5f53\u7eb5\u8f74\u6570\u636e\u5c5e\u4e8e\u4e0d\u540c\u7c7b\u578b\uff08\u4f8b\u5982\u6e29\u5ea6\u548c\u538b\u529b\uff09\u6216\u8005\u4e0d\u540c\u5c3a\u5ea6\uff0c\u90a3\u5c31\u9700\u8981\u66f4\u591a\u7684\u7eb5\u8f74\u6765\u5206\u522b\u5bb9\u7eb3\u3002\u8fd9\u7c7b\u4f3c\u4e8eExcel\u56fe\u8868\u4e2d\u7684\u6b21\u5750\u6807\u8f74\uff0c\u53ea\u4e0d\u8fc7 Matplotlib \u53ef\u4ee5\u5448\u73b0\u66f4\u591a\u7684\u7eb5\u8f74\u3002\u672c\u6587\u57fa\u4e8e Matplotlib \u5b98\u7f51\u7ed9\u51fa\u7684\u5b9e\u4f8b\u5c01\u88c5\u4e86\u4e00\u4e2a\u5b9e\u73b0\u5bc4\u751f\u8f74\u6563\u70b9\u56fe\u7684\u51fd\u6570\u3002","title":"Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe"},{"location":"2019-05-22-Matplotlib%E5%A4%9A%E7%BA%B5%E8%BD%B4%EF%BC%88%E5%AF%84%E7%94%9F%E8%BD%B4%EF%BC%89%E6%95%A3%E7%82%B9%E5%9B%BE/#_1","text":"\u8fd9\u4e9b\u7eb5\u8f74 y axes \u5171\u4eab\u540c\u4e00\u6a2a\u8f74 x axes \u6570\u636e\uff0c\u56e0\u6b64\u6709\u4e24\u79cd\u601d\u8def\u53ef\u4ee5\u5b9e\u73b0\uff1a \u5b6a\u751f\u8f74 matplotlib.axes.Axes.twinx \uff0c\u57fa\u4e8e\u540c\u4e00\u4e2ax\u8f74\u4f46\u5404\u81ea\u72ec\u7acb\u7684\u4e00\u7cfb\u5217\u8f74 \u5bc4\u751f\u8f74\uff0c\u5305\u62ec\u4e00\u4e2a\u4e3b\u8f74 parasite_axes.HostAxes \u548c\u4ece\u4e3b\u8f74\u6784\u9020\u7684\u591a\u4e2a\u5bc4\u751f\u8f74 parasite_axes.ParasiteAxes Matplotlib \u5b98\u7f51\u7ed9\u51fa\u4e86\u4e09\u4e2a\u5b9e\u4f8b\uff0c\u5206\u522b\u91c7\u7528\u4e86\u666e\u901a\u5b6a\u751f\u8f74\uff0c\u57fa\u4e8e parasite_axes \u4e0b host_subplot \u7684\u5b6a\u751f\u8f74\uff0c\u4ee5\u53ca parasite_axes \u4e0b\u5bc4\u751f\u8f74\u7684\u65b9\u6cd5\uff1a Multiple Yaxis With Spines Demo Parasite Axes2 Parasite Axes demo","title":"\u6982\u8ff0"},{"location":"2019-05-22-Matplotlib%E5%A4%9A%E7%BA%B5%E8%BD%B4%EF%BC%88%E5%AF%84%E7%94%9F%E8%BD%B4%EF%BC%89%E6%95%A3%E7%82%B9%E5%9B%BE/#_2","text":"\u672c\u6587\u57fa\u4e8e parasite_axes \u5bc4\u751f\u8f74\u7684\u65b9\u5f0f\u5c01\u88c5\u4e86\u5982\u4e0b\u51fd\u6570\uff1a ''' Create a parasite axes, which would share the x scale with a host axes, but show a different scale in y direction. This approach uses the parasite_axes' HostAxes and ParasiteAxes referenced from: https://matplotlib.org/3.1.1/gallery/axisartist/demo_parasite_axes.html params: xdata: 1d numpy array ydata: a list of structured array, each array represents one or more curves in associated y-axis. the field name of structured array become curve label. A reference to structed array: https://docs.scipy.org/doc/numpy/user/basics.rec.html xlabel: x label, `X` by default ylabels: list of label for each parasite axes, Y-0, Y-1 by default title: figure title colors: a list of colors for each curve, jet colormap by default markers: a list of markers for each curve, none by default linestyles: a list of line styles for each curve, solid line ('-') by default savefile: save figure if true else plot only colors, markers, linestyles are ignored if the length less than the count of all curves. ''' import matplotlib.pyplot as plt from mpl_toolkits.axisartist.parasite_axes import HostAxes, ParasiteAxes from matplotlib import cm import numpy as np def parasite_axes(xdata, ydata, xlabel=None, ylabels=None, title=None, colors=None, markers=None, linestyles=None, savefile=None): fig = plt.figure(figsize=(10,7)) # host axis # - span for plotting multi-y axes # - hide axes span = 0.05*len(ydata) + 0.01 host = HostAxes(fig, [span, 0.1, 0.88-span, 0.8]) # left, bottom, width, height host.axis['left','right'].set_visible(False) host.axis['top'].toggle(all=False) host.set_xlabel(xlabel if xlabel else 'X') host.set_xlim(int(min(xdata)), int(max(xdata))) # create parasite axes para_axes = [ParasiteAxes(host, sharex=host) for _ in ydata] # count of curves in all axes num = sum(len(data.dtype.names) for data in ydata) if not ylabels: ylabels = ['Y-{0}'.format(i) for i in range(len(ydata))] if not colors or len(colors)<num: colors = [cm.jet(x) for x in np.linspace(0.0, 1.0, num)] if not linestyles or len(linestyles)<num: linestyles = ['-'] * num if not markers or len(markers)<num: markers = [''] * num curve_index = 0 for i, (par, ylabel, data) in enumerate(zip(para_axes, ylabels, ydata)): host.parasites.append(par) par.axis['new_left'] = par._grid_helper.new_fixed_axis( loc='left', axes=par, offset=(-35*i, 0)) # add curve for curve_name in data.dtype.names: par.plot(xdata, data[curve_name], label=curve_name, color=colors[curve_index], linestyle=linestyles[curve_index], marker=markers[curve_index], linewidth=0.5) curve_index += 1 # label par.set_ylabel(ylabel) par.axis['left'].label.set_pad(0) # limits and ticks # numpy_array = data.view((data.dtype[0], len(data.dtype.names))) numpy_array = np.array(data.tolist()) y_min, y_max = np.min(numpy_array), np.max(numpy_array) ylim_min = round(y_min-0.1*(y_max-y_min), 1) ylim_max = round(y_max+0.2*(y_max-y_min), 1) par.set_ylim(ylim_min, ylim_max) par.set_yticks(np.linspace(ylim_min, ylim_max, 5)) par.axis['new_left'].major_ticklabels.set_axis_direction('top') # grid on para_axes[0].grid(True, linestyle='--') para_axes[0].axis['right'].set_visible(True) host.set_title(title if title else 'No Title') host.legend(loc='upper left', bbox_to_anchor=(1.01, 1)) fig.add_axes(host) if not savefile: plt.show() else: plt.savefig(savefile, dpi=120) if __name__ == '__main__': xdata = np.linspace(1, 10, 20) ydata = [None] * 3 ylabels = [] colors, linestyles, markers = [], [], [] # y axis 1 ydata[0] = np.core.records.fromarrays([np.exp(xdata/10)], names='np.exp(x/10)') ylabels.append('exponential function') colors.append('r') linestyles.append('-') markers.append('') # y axis 2 ydata[1] = np.core.records.fromarrays([np.sin(xdata), np.cos(xdata)], names='y=sin(x), y=cos(x)') ylabels.append('trigonometric functions') colors.extend(['g']*2) linestyles.extend(['-', '--']) markers.extend(['', 'o']) # y axis 3 ydata[2] = np.core.records.fromarrays([xdata**1.5, xdata, xdata**0.5], names='y=x^1.5, y=x, y=x^0.5') ylabels.append('power functions') colors.extend(['b']*3) linestyles.extend(['-', '--', '-.']) markers.extend(['', 'o', '^']) parasite_axes(xdata, ydata, title='Sample Parasite Axes', xlabel='sample x', ylabels=ylabels, colors=colors, linestyles=linestyles, markers=markers) \u6d4b\u8bd5\u5b9e\u4f8b\u663e\u793a\u7ed3\u679c\u5982\u4e0b\uff1a","title":"\u4ee3\u7801"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/","text":"C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-08-18 | \u5206\u7c7b\uff1a python/vba/cpp VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 \u4ecb\u7ecd\u4e86VBA\u8c03\u7528C++ DLL\u7684\u57fa\u7840\uff0c\u4f8b\u5982\u57fa\u672c\u53c2\u6570\u7c7b\u578b\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u8fd9\u6d89\u53ca\u5230\u4f20\u53c2\u548c\u8fd4\u56de\u503c\u7684\u6b63\u786e\u83b7\u53d6\u3002\u5176\u4e2d\u903b\u8f91\u3001\u6570\u503c\u7c7b\u578b\u7684\u4f20\u9012\u76f8\u5bf9\u7b80\u5355\uff0c\u4f46\u5b57\u7b26\u4e32\u7c7b\u578b\u4e0d\u540c\u7684\u5b58\u50a8\u5f62\u5f0f\u5e26\u6765\u4e86\u4e00\u5b9a\u7684\u969c\u788d\uff0c\u5c24\u5176\u662f\u4eceC++\u8fd4\u56de\u5b57\u7b26\u7c7b\u578b\u7ed9VBA\u3002\u672c\u6587\u4ece\u5b9e\u4f8b\u51fa\u53d1\uff0c\u63a2\u7d22C++ DLL\u548cVBA\u4e4b\u95f4\u5b57\u7b26\u4e32\u7c7b\u578b\u53c2\u6570\u4f20\u9012\u7684\u57fa\u672c\u59ff\u52bf\u3002 \u57fa\u672c\u7c7b\u578b \u00b6 \u6211\u4eec\u4f1a\u6beb\u4e0d\u72b9\u8c6b\u5730\u60f3\u5230 char* \u4e0eVBA String \u5bf9\u5e94\u7684\u53ef\u80fd\u6027\uff1b \u53e6\u5916\u5b57\u7b26\u4e32\u7c7b\u578b\u5728VBA\u5185\u90e8\u662f\u7531 COM BSTR \uff08Basic string\uff09\u7ed3\u6784\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u5229\u7528 BSTR \u4e0e string \u4ea4\u4e92\u5177\u5907\u5929\u751f\u4f18\u52bf\uff1b \u6700\u540e\uff0cC++\u548cVBA\u90fd\u652f\u6301 Variant \u7c7b\u578b\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5b57\u7b26\u4e32\u4f20\u9012\u7684\u8fc7\u6e21\u7c7b\u578b \u4ee5 char* \u8fd4\u56de\u5b57\u7b26\u4e32 \u00b6 \u7531\u4e8e\u91cd\u70b9\u5728\u4e8e \u63a2\u7a76VBA\u63a5\u53d7DLL\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u7c7b\u578b \uff0c\u63a5\u4e0b\u6765\u7684\u5b9e\u9a8c\u4e2d\u7edf\u4e00\u7528 char* \u7c7b\u578b\u63a5\u53d7VBA\u4f20\u9012\u7684\u5b57\u7b26\u4e32\uff0cDLL\u4e2d\u5c06\u5176\u8f6c\u6362\u4e3a\u5927\u5199\u5b57\u7b26\u5f62\u5f0f\u540e\u5206\u522b\u4ee5 char* \u3001 BSTR \u548c Variant \u7c7b\u578b\u8fd4\u56de\u7ed9VBA\u3002 \u9996\u5148\u5b9e\u73b0\u57fa\u672c\u7684\u5927\u5199\u8f6c\u6362\u8fc7\u7a0b\u3002\u4e3a\u4e86\u6210\u529f\u8fd4\u56de\u8f6c\u6362\u540e\u7684\u5b57\u7b26\u4e32\uff0c\u9700\u8981\u5728\u5806\u4e0a\u5f00\u8f9f\u6c38\u4e45\u7a7a\u95f4\uff1b\u5426\u5219\u8be5\u51fd\u6570\u8c03\u7528\u7ed3\u675f\u540e\u5373\u9500\u6bc1\u4e86\u6808\u4e0a\u7684\u53d8\u91cf\uff0c\u4ece\u800c\u65e0\u6cd5\u83b7\u53d6\u8fd4\u56de\u503c\u3002\u4f46\u8fd9\u6837\u505a\u7684\u8bdd\uff0c\u6ce8\u610f\u5728\u4f7f\u7528\u7ed3\u675f\u540e\u663e\u5f0f\u9500\u6bc1\u5f00\u8f9f\u7684\u7a7a\u95f4\u3002\u56e0\u6b64\u8fd9\u4e2a\u51fd\u6570\u5e76\u4e0d\u9002\u5408\u4f5c\u4e3aVBA\u7684\u63a5\u53e3\uff0c\u56e0\u4e3a\u4e00\u65e6\u88ab\u8c03\u7528\u540e\u5f88\u96be\u518d\u4eceVBA\u4e2d\u9500\u6bc1 res \u3002 char* __stdcall upper_heap(const char* str) { char* res = new char[strlen(str)+1]; size_t i = 0; for (; str[i]; i++) { res[i] = toupper(str[i]); } res[i] = '\\0'; // res should be released out of this function return res; } \u5982\u679c\u5f3a\u884c\u8fd9\u4e48\u505a\u7684\u8bdd\uff0c\u76f4\u63a5\u5bfc\u81f4\u4e86Excel\u7684\u5d29\u6e83 Declare Function upper_heap Lib \"Sample.dll\" (ByVal str$) As String Sub test() Debug.Print upper_heap(\"abC123e\") End Sub \u5728C\u8bed\u8a00\u4e2d\u4e00\u4e2a\u5e38\u7528\u7684\u505a\u6cd5\u662f\u901a\u8fc7\u4f20\u5740\u53c2\u6570\u6765\u8fd4\u56de\u503c\uff0c\u4e8e\u662f\u5f97\u5230\u53e6\u4e00\u4e2a\u7248\u672c\uff1a int __stdcall upper_char(const char* str, char* out, int n_size) { char* res = upper_heap(str); // for safe, the max buffer n_size is used size_t n = strlen(res) < n_size ? strlen(res) : n_size; strncpy(out, res, n); delete[] res; return n; } \u53c2\u6570 out \u5373\u7528\u6765\u5b58\u653e\u76ee\u6807\u5b57\u7b26\u4e32\uff0c n_size \u662f out \u7684\u6700\u5927\u957f\u5ea6\uff08\u7f13\u51b2\u533a\u5927\u5c0f\uff09\u3002\u867d\u7136\u672c\u4f8b\u8fd4\u56de\u503c\u7684\u957f\u5ea6\u5c31\u7b49\u4e8e\u8f93\u5165\u503c\uff0c\u4f46\u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u6cd5\u9884\u77e5\u8fd4\u56de\u503c\u6240\u5360\u7a7a\u95f4\uff0c\u6240\u4ee5\u9700\u8981\u4e8b\u5148\u5f00\u8f9f\u4e00\u5b9a\u957f\u5ea6\u7684\u7f13\u51b2\u533a\u95f4\uff0c\u5bf9\u8d85\u51fa\u90e8\u5206\u5219\u8fdb\u884c\u622a\u65ad\u3002\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f out \u7684\u771f\u5b9e\u5927\u5c0f\u3002 \u5728VBA\u4e2d\u91cd\u65b0\u5c01\u88c5\u6210\u4e00\u4e2a Function \uff0c\u4e8e\u662f\u53ef\u4ee5\u7528\u4e8eVBA\u4ee3\u7801\u6216\u8005\u5355\u5143\u683c\u51fd\u6570\u4e2d\uff1a Declare Function upper_char Lib \"Sample.dll\" (ByVal str$, ByVal out$, ByVal n As Long) As Long Function upper_vba_arg(str) Dim n&, out$ n = Len(str) out = Space(n) Call upper_char(str, out, n) upper_vba_arg = out End Function \u4ee5 BSTR \u8fd4\u56de\u5b57\u7b26\u4e32 \u00b6 \u8fd8\u662f\u4f7f\u7528\u524d\u9762 upper_heap() \u7684\u57fa\u672c\u5b9e\u73b0\uff0c\u7136\u540e\u4ee5 BSTR \u7c7b\u578b\u8fd4\u56de\u5373\u53ef\u3002\u8fd9\u91cc\u8c8c\u4f3c\u6709\u4e9b\u95ee\u9898\uff0c\u56e0\u4e3a BSTR \u7c7b\u578b\u7684\u53c2\u6570\u4e5f\u9700\u8981\u663e\u5f0f\u91ca\u653e\u5185\u5b58\u5374\u6ca1\u6709\u5728C++\u4ee3\u7801\u4e2d\u5904\u7406\u3002\u4e0d\u8fc7\u65e0\u9700\u62c5\u5fc3\uff0c BSTR \u7c7b\u578b\u7684\u5185\u5b58\u91ca\u653e\u53ef\u4ee5\u7531VBA\u81ea\u52a8\u5b8c\u6210\u3002 The important point is the use of the OLE SysAllocStringByteLen() function to allocate new space for the string. This enables VBA to free the string whenit is done with it. #include <OAIdl.h> // for VARIANT, BSTR etc BSTR __stdcall upper_bstr(const char* str) { char* res = upper_heap(str); // This function takes an ANSI string as input, and returns an allocated string. // This function does not perform ANSI to Unicode translation. It is valid only for 32-bit systems. BSTR bstr = SysAllocStringByteLen(res, strlen(res)); delete[] res; return bstr; } \u4ee5\u4e0a\u63a5\u53e3\u51fd\u6570 upper_bstr() \u5728VBA\u5b8f\u4ee3\u7801\u548c\u5355\u5143\u683c\u516c\u5f0f\u4e2d\u90fd\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u4e0b\u9762\u7528VBA\u770b\u4f3c\u201c\u591a\u6b64\u4e00\u4e3e\u201d\u5730\u5305\u88c5\u4e00\u4e0b\uff08\u540e\u6587\u9610\u8ff0\u5176\u7528\u610f\uff09\uff1a Declare Function upper_bstr Lib \"Sample.dll\" (ByVal str$) As String Function upper_vba_bstr(str) As String upper_vba_bstr = upper_bstr(str) End Function \u4ee5 VARIANT \u8fd4\u56de\u5b57\u7b26\u4e32 \u00b6 \u540c\u7406\u5728C++\u4e2d\u4ee5 VARIANT \u7c7b\u578b\u8fd4\u56de\u5373\u53ef\uff1a #include <OAIdl.h> // for VARIANT, BSTR etc VARIANT __stdcall upper_var(const char* str) { BSTR bstr = upper_bstr(str); VARIANT var; var.vt = VT_BSTR; var.bstrVal = bstr; return var; VariantClear(&var); } \u76f8\u5e94\u5730\uff0cVBA\u4e2d\u9700\u8981\u5c06\u51fd\u6570\u8fd4\u56de\u503c\u58f0\u660e\u4e3a Variant \u7c7b\u578b\uff0c\u5e76\u4e14\u5728\u91cd\u65b0\u5305\u88c5VBA\u51fd\u6570\u65f6\u9700\u8981\u8f6c\u6362\u7f16\u7801\u4e3aUnicode\uff1a Declare Function upper_var Lib \"Sample.dll\" (ByVal str$) As Variant Function upper_vba_var(str) upper_vba_var = StrConv(upper_var(str), vbUnicode) ' unicode encoding End Function \u5bf9\u6bd4\u603b\u7ed3 \u00b6 char* \u3001 BSTR \u3001 VARIANT \u4e09\u79cd\u7c7b\u578b\u90fd\u53ef\u4ee5\u5b9e\u73b0\u4f20\u9012\u5b57\u7b26\u4e32\u7c7b\u578b\u56deVBA\uff1a char* \u65b9\u5f0f\u4e0d\u80fd\u76f4\u63a5\u8fd4\u56de\u5b57\u7b26\u4e32\uff0c\u800c\u662f\u66ff\u4ee3\u4ee5\u5b58\u50a8\u76ee\u6807\u5b57\u7b26\u4e32\u5230\u9884\u5148\u4f20\u5165\u7684\u53c2\u6570\u4e2d\u3002\u56e0\u6b64\u8fd9\u79cd\u65b9\u5f0f\u7684C++\u63a5\u53e3\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\uff0c\u800c\u662f\u9700\u8981\u5305\u88c5\u4e3aVBA\u51fd\u6570\u3002 BSTR \u65b9\u5f0f\u6ce8\u610f\u6700\u540e\u8f6c\u6362\u4e3a BSTR \u7c7b\u578b\u7684\u65b9\u6cd5\uff0c\u53c2\u8003\u51fd\u6570 SysAllocStringByteLen() \u3001 SysAllocString() \u3001 _bstr_t() \u7b49\u3002 VARIANT \u65b9\u5f0f\u6ce8\u610f\u5c06\u8fd4\u56de\u503c\u8f6c\u6362\u4e3aUnicode\u7f16\u7801\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u60f3\u76f4\u63a5\u4f7f\u7528DLL\u4e2d\u7684\u51fd\u6570\uff0c\u4f18\u5148 BSTR \u548c VARIANT \u65b9\u5f0f\uff1b\u5982\u679c\u8003\u8651VBA\u518d\u6b21\u5305\u88c5\u7684\u8bdd\uff0c char* \u7684\u65b9\u5f0f\u66f4\u4e3a\u8f7b\u4fbf\u3002 VBA\u5c01\u88c5\u7248\u672c\u624d\u80fd\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f \u4e0a\u8ff0\u5b9e\u4f8b\u4e2d\uff0c\u4e09\u4e2aC++\u63a5\u53e3\u51fd\u6570\u90fd\u6709VBA\u5305\u88c5\u7248\u672c\uff0c\u4f8b\u5982 upper_vba_bstr() \u662f\u5bf9\u4ee5 BSTR \u7c7b\u578b\u8fd4\u56de\u5b57\u7b26\u4e32\u7684 upper_bstr() \u63a5\u53e3\u7684\u5305\u88c5\u3002\u9664\u4e86 upper_char() \u4e0d\u662f\u76f4\u63a5\u8fd4\u56de\u5b57\u7b26\u4e32\u800c\u65e0\u6cd5\u76f4\u63a5\u5e94\u7528\u4e8e\u516c\u5f0f\u51fd\u6570\u5916\uff0c\u5176\u4f59\u4e24\u79cd\u65b9\u5f0f\u7684\u4e24\u4e2a\u7248\u672c\uff08C++\u3001VBA\uff09\u51fd\u6570\u90fd\u53ef\u4ee5\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\u3002 \u7136\u800c\uff0c\u5728\u5355\u5143\u683c\u516c\u5f0f\u4e2d\u7684\u6d4b\u8bd5\u5374\u51fa\u73b0\u4e86\u4e0b\u56fe\u95ee\u9898\uff1aVBA\u51fd\u6570\u5de5\u4f5c\u6b63\u5e38\uff0c\u76f8\u5e94DLL\u63a5\u53e3\u90fd\u53ea\u8f6c\u6362\u4e86\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff01 \u6839\u672c\u539f\u56e0\u662fVBA\u5b8f\u4ee3\u7801\u548cExcel\u516c\u5f0f\u4e2d\u4f20\u9012\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u7f16\u7801\u65b9\u5f0f\u7565\u6709\u4e0d\u540c\uff0c\u5177\u4f53\u53c2\u8003\uff1a DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 \u6700\u540e\uff0c\u672c\u6587\u5b8c\u6574\u4ee3\u7801\uff1a https://github.com/dothinking/blog/tree/master/samples/vba_cpp_dll/Sample_Return_String \u53c2\u8003 \u00b6 VBA Internals: String Variables and Pointers in Depth Interfacing Visual Basic And C++ Financial Applications using Excel Add-in Development in C / C++","title":"C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#c dllvba","text":"\u53d1\u5e03\u4e8e\uff1a2019-08-18 | \u5206\u7c7b\uff1a python/vba/cpp VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 \u4ecb\u7ecd\u4e86VBA\u8c03\u7528C++ DLL\u7684\u57fa\u7840\uff0c\u4f8b\u5982\u57fa\u672c\u53c2\u6570\u7c7b\u578b\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u8fd9\u6d89\u53ca\u5230\u4f20\u53c2\u548c\u8fd4\u56de\u503c\u7684\u6b63\u786e\u83b7\u53d6\u3002\u5176\u4e2d\u903b\u8f91\u3001\u6570\u503c\u7c7b\u578b\u7684\u4f20\u9012\u76f8\u5bf9\u7b80\u5355\uff0c\u4f46\u5b57\u7b26\u4e32\u7c7b\u578b\u4e0d\u540c\u7684\u5b58\u50a8\u5f62\u5f0f\u5e26\u6765\u4e86\u4e00\u5b9a\u7684\u969c\u788d\uff0c\u5c24\u5176\u662f\u4eceC++\u8fd4\u56de\u5b57\u7b26\u7c7b\u578b\u7ed9VBA\u3002\u672c\u6587\u4ece\u5b9e\u4f8b\u51fa\u53d1\uff0c\u63a2\u7d22C++ DLL\u548cVBA\u4e4b\u95f4\u5b57\u7b26\u4e32\u7c7b\u578b\u53c2\u6570\u4f20\u9012\u7684\u57fa\u672c\u59ff\u52bf\u3002","title":"C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#_1","text":"\u6211\u4eec\u4f1a\u6beb\u4e0d\u72b9\u8c6b\u5730\u60f3\u5230 char* \u4e0eVBA String \u5bf9\u5e94\u7684\u53ef\u80fd\u6027\uff1b \u53e6\u5916\u5b57\u7b26\u4e32\u7c7b\u578b\u5728VBA\u5185\u90e8\u662f\u7531 COM BSTR \uff08Basic string\uff09\u7ed3\u6784\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u5229\u7528 BSTR \u4e0e string \u4ea4\u4e92\u5177\u5907\u5929\u751f\u4f18\u52bf\uff1b \u6700\u540e\uff0cC++\u548cVBA\u90fd\u652f\u6301 Variant \u7c7b\u578b\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5b57\u7b26\u4e32\u4f20\u9012\u7684\u8fc7\u6e21\u7c7b\u578b","title":"\u57fa\u672c\u7c7b\u578b"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#char","text":"\u7531\u4e8e\u91cd\u70b9\u5728\u4e8e \u63a2\u7a76VBA\u63a5\u53d7DLL\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u7c7b\u578b \uff0c\u63a5\u4e0b\u6765\u7684\u5b9e\u9a8c\u4e2d\u7edf\u4e00\u7528 char* \u7c7b\u578b\u63a5\u53d7VBA\u4f20\u9012\u7684\u5b57\u7b26\u4e32\uff0cDLL\u4e2d\u5c06\u5176\u8f6c\u6362\u4e3a\u5927\u5199\u5b57\u7b26\u5f62\u5f0f\u540e\u5206\u522b\u4ee5 char* \u3001 BSTR \u548c Variant \u7c7b\u578b\u8fd4\u56de\u7ed9VBA\u3002 \u9996\u5148\u5b9e\u73b0\u57fa\u672c\u7684\u5927\u5199\u8f6c\u6362\u8fc7\u7a0b\u3002\u4e3a\u4e86\u6210\u529f\u8fd4\u56de\u8f6c\u6362\u540e\u7684\u5b57\u7b26\u4e32\uff0c\u9700\u8981\u5728\u5806\u4e0a\u5f00\u8f9f\u6c38\u4e45\u7a7a\u95f4\uff1b\u5426\u5219\u8be5\u51fd\u6570\u8c03\u7528\u7ed3\u675f\u540e\u5373\u9500\u6bc1\u4e86\u6808\u4e0a\u7684\u53d8\u91cf\uff0c\u4ece\u800c\u65e0\u6cd5\u83b7\u53d6\u8fd4\u56de\u503c\u3002\u4f46\u8fd9\u6837\u505a\u7684\u8bdd\uff0c\u6ce8\u610f\u5728\u4f7f\u7528\u7ed3\u675f\u540e\u663e\u5f0f\u9500\u6bc1\u5f00\u8f9f\u7684\u7a7a\u95f4\u3002\u56e0\u6b64\u8fd9\u4e2a\u51fd\u6570\u5e76\u4e0d\u9002\u5408\u4f5c\u4e3aVBA\u7684\u63a5\u53e3\uff0c\u56e0\u4e3a\u4e00\u65e6\u88ab\u8c03\u7528\u540e\u5f88\u96be\u518d\u4eceVBA\u4e2d\u9500\u6bc1 res \u3002 char* __stdcall upper_heap(const char* str) { char* res = new char[strlen(str)+1]; size_t i = 0; for (; str[i]; i++) { res[i] = toupper(str[i]); } res[i] = '\\0'; // res should be released out of this function return res; } \u5982\u679c\u5f3a\u884c\u8fd9\u4e48\u505a\u7684\u8bdd\uff0c\u76f4\u63a5\u5bfc\u81f4\u4e86Excel\u7684\u5d29\u6e83 Declare Function upper_heap Lib \"Sample.dll\" (ByVal str$) As String Sub test() Debug.Print upper_heap(\"abC123e\") End Sub \u5728C\u8bed\u8a00\u4e2d\u4e00\u4e2a\u5e38\u7528\u7684\u505a\u6cd5\u662f\u901a\u8fc7\u4f20\u5740\u53c2\u6570\u6765\u8fd4\u56de\u503c\uff0c\u4e8e\u662f\u5f97\u5230\u53e6\u4e00\u4e2a\u7248\u672c\uff1a int __stdcall upper_char(const char* str, char* out, int n_size) { char* res = upper_heap(str); // for safe, the max buffer n_size is used size_t n = strlen(res) < n_size ? strlen(res) : n_size; strncpy(out, res, n); delete[] res; return n; } \u53c2\u6570 out \u5373\u7528\u6765\u5b58\u653e\u76ee\u6807\u5b57\u7b26\u4e32\uff0c n_size \u662f out \u7684\u6700\u5927\u957f\u5ea6\uff08\u7f13\u51b2\u533a\u5927\u5c0f\uff09\u3002\u867d\u7136\u672c\u4f8b\u8fd4\u56de\u503c\u7684\u957f\u5ea6\u5c31\u7b49\u4e8e\u8f93\u5165\u503c\uff0c\u4f46\u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u6cd5\u9884\u77e5\u8fd4\u56de\u503c\u6240\u5360\u7a7a\u95f4\uff0c\u6240\u4ee5\u9700\u8981\u4e8b\u5148\u5f00\u8f9f\u4e00\u5b9a\u957f\u5ea6\u7684\u7f13\u51b2\u533a\u95f4\uff0c\u5bf9\u8d85\u51fa\u90e8\u5206\u5219\u8fdb\u884c\u622a\u65ad\u3002\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f out \u7684\u771f\u5b9e\u5927\u5c0f\u3002 \u5728VBA\u4e2d\u91cd\u65b0\u5c01\u88c5\u6210\u4e00\u4e2a Function \uff0c\u4e8e\u662f\u53ef\u4ee5\u7528\u4e8eVBA\u4ee3\u7801\u6216\u8005\u5355\u5143\u683c\u51fd\u6570\u4e2d\uff1a Declare Function upper_char Lib \"Sample.dll\" (ByVal str$, ByVal out$, ByVal n As Long) As Long Function upper_vba_arg(str) Dim n&, out$ n = Len(str) out = Space(n) Call upper_char(str, out, n) upper_vba_arg = out End Function","title":"\u4ee5char*\u8fd4\u56de\u5b57\u7b26\u4e32"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#bstr","text":"\u8fd8\u662f\u4f7f\u7528\u524d\u9762 upper_heap() \u7684\u57fa\u672c\u5b9e\u73b0\uff0c\u7136\u540e\u4ee5 BSTR \u7c7b\u578b\u8fd4\u56de\u5373\u53ef\u3002\u8fd9\u91cc\u8c8c\u4f3c\u6709\u4e9b\u95ee\u9898\uff0c\u56e0\u4e3a BSTR \u7c7b\u578b\u7684\u53c2\u6570\u4e5f\u9700\u8981\u663e\u5f0f\u91ca\u653e\u5185\u5b58\u5374\u6ca1\u6709\u5728C++\u4ee3\u7801\u4e2d\u5904\u7406\u3002\u4e0d\u8fc7\u65e0\u9700\u62c5\u5fc3\uff0c BSTR \u7c7b\u578b\u7684\u5185\u5b58\u91ca\u653e\u53ef\u4ee5\u7531VBA\u81ea\u52a8\u5b8c\u6210\u3002 The important point is the use of the OLE SysAllocStringByteLen() function to allocate new space for the string. This enables VBA to free the string whenit is done with it. #include <OAIdl.h> // for VARIANT, BSTR etc BSTR __stdcall upper_bstr(const char* str) { char* res = upper_heap(str); // This function takes an ANSI string as input, and returns an allocated string. // This function does not perform ANSI to Unicode translation. It is valid only for 32-bit systems. BSTR bstr = SysAllocStringByteLen(res, strlen(res)); delete[] res; return bstr; } \u4ee5\u4e0a\u63a5\u53e3\u51fd\u6570 upper_bstr() \u5728VBA\u5b8f\u4ee3\u7801\u548c\u5355\u5143\u683c\u516c\u5f0f\u4e2d\u90fd\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u4e0b\u9762\u7528VBA\u770b\u4f3c\u201c\u591a\u6b64\u4e00\u4e3e\u201d\u5730\u5305\u88c5\u4e00\u4e0b\uff08\u540e\u6587\u9610\u8ff0\u5176\u7528\u610f\uff09\uff1a Declare Function upper_bstr Lib \"Sample.dll\" (ByVal str$) As String Function upper_vba_bstr(str) As String upper_vba_bstr = upper_bstr(str) End Function","title":"\u4ee5BSTR\u8fd4\u56de\u5b57\u7b26\u4e32"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#variant","text":"\u540c\u7406\u5728C++\u4e2d\u4ee5 VARIANT \u7c7b\u578b\u8fd4\u56de\u5373\u53ef\uff1a #include <OAIdl.h> // for VARIANT, BSTR etc VARIANT __stdcall upper_var(const char* str) { BSTR bstr = upper_bstr(str); VARIANT var; var.vt = VT_BSTR; var.bstrVal = bstr; return var; VariantClear(&var); } \u76f8\u5e94\u5730\uff0cVBA\u4e2d\u9700\u8981\u5c06\u51fd\u6570\u8fd4\u56de\u503c\u58f0\u660e\u4e3a Variant \u7c7b\u578b\uff0c\u5e76\u4e14\u5728\u91cd\u65b0\u5305\u88c5VBA\u51fd\u6570\u65f6\u9700\u8981\u8f6c\u6362\u7f16\u7801\u4e3aUnicode\uff1a Declare Function upper_var Lib \"Sample.dll\" (ByVal str$) As Variant Function upper_vba_var(str) upper_vba_var = StrConv(upper_var(str), vbUnicode) ' unicode encoding End Function","title":"\u4ee5VARIANT\u8fd4\u56de\u5b57\u7b26\u4e32"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#_2","text":"char* \u3001 BSTR \u3001 VARIANT \u4e09\u79cd\u7c7b\u578b\u90fd\u53ef\u4ee5\u5b9e\u73b0\u4f20\u9012\u5b57\u7b26\u4e32\u7c7b\u578b\u56deVBA\uff1a char* \u65b9\u5f0f\u4e0d\u80fd\u76f4\u63a5\u8fd4\u56de\u5b57\u7b26\u4e32\uff0c\u800c\u662f\u66ff\u4ee3\u4ee5\u5b58\u50a8\u76ee\u6807\u5b57\u7b26\u4e32\u5230\u9884\u5148\u4f20\u5165\u7684\u53c2\u6570\u4e2d\u3002\u56e0\u6b64\u8fd9\u79cd\u65b9\u5f0f\u7684C++\u63a5\u53e3\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\uff0c\u800c\u662f\u9700\u8981\u5305\u88c5\u4e3aVBA\u51fd\u6570\u3002 BSTR \u65b9\u5f0f\u6ce8\u610f\u6700\u540e\u8f6c\u6362\u4e3a BSTR \u7c7b\u578b\u7684\u65b9\u6cd5\uff0c\u53c2\u8003\u51fd\u6570 SysAllocStringByteLen() \u3001 SysAllocString() \u3001 _bstr_t() \u7b49\u3002 VARIANT \u65b9\u5f0f\u6ce8\u610f\u5c06\u8fd4\u56de\u503c\u8f6c\u6362\u4e3aUnicode\u7f16\u7801\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u60f3\u76f4\u63a5\u4f7f\u7528DLL\u4e2d\u7684\u51fd\u6570\uff0c\u4f18\u5148 BSTR \u548c VARIANT \u65b9\u5f0f\uff1b\u5982\u679c\u8003\u8651VBA\u518d\u6b21\u5305\u88c5\u7684\u8bdd\uff0c char* \u7684\u65b9\u5f0f\u66f4\u4e3a\u8f7b\u4fbf\u3002 VBA\u5c01\u88c5\u7248\u672c\u624d\u80fd\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f \u4e0a\u8ff0\u5b9e\u4f8b\u4e2d\uff0c\u4e09\u4e2aC++\u63a5\u53e3\u51fd\u6570\u90fd\u6709VBA\u5305\u88c5\u7248\u672c\uff0c\u4f8b\u5982 upper_vba_bstr() \u662f\u5bf9\u4ee5 BSTR \u7c7b\u578b\u8fd4\u56de\u5b57\u7b26\u4e32\u7684 upper_bstr() \u63a5\u53e3\u7684\u5305\u88c5\u3002\u9664\u4e86 upper_char() \u4e0d\u662f\u76f4\u63a5\u8fd4\u56de\u5b57\u7b26\u4e32\u800c\u65e0\u6cd5\u76f4\u63a5\u5e94\u7528\u4e8e\u516c\u5f0f\u51fd\u6570\u5916\uff0c\u5176\u4f59\u4e24\u79cd\u65b9\u5f0f\u7684\u4e24\u4e2a\u7248\u672c\uff08C++\u3001VBA\uff09\u51fd\u6570\u90fd\u53ef\u4ee5\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\u3002 \u7136\u800c\uff0c\u5728\u5355\u5143\u683c\u516c\u5f0f\u4e2d\u7684\u6d4b\u8bd5\u5374\u51fa\u73b0\u4e86\u4e0b\u56fe\u95ee\u9898\uff1aVBA\u51fd\u6570\u5de5\u4f5c\u6b63\u5e38\uff0c\u76f8\u5e94DLL\u63a5\u53e3\u90fd\u53ea\u8f6c\u6362\u4e86\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff01 \u6839\u672c\u539f\u56e0\u662fVBA\u5b8f\u4ee3\u7801\u548cExcel\u516c\u5f0f\u4e2d\u4f20\u9012\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u7f16\u7801\u65b9\u5f0f\u7565\u6709\u4e0d\u540c\uff0c\u5177\u4f53\u53c2\u8003\uff1a DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 \u6700\u540e\uff0c\u672c\u6587\u5b8c\u6574\u4ee3\u7801\uff1a https://github.com/dothinking/blog/tree/master/samples/vba_cpp_dll/Sample_Return_String","title":"\u5bf9\u6bd4\u603b\u7ed3"},{"location":"2019-08-18-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2/#_3","text":"VBA Internals: String Variables and Pointers in Depth Interfacing Visual Basic And C++ Financial Applications using Excel Add-in Development in C / C++","title":"\u53c2\u8003"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/","text":"C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-08-31 | \u5206\u7c7b\uff1a python/vba/cpp \u524d\u6587\u4ee5 char* \u7c7b\u578b\u63a5\u6536Excel\u4e2d\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u5176\u7ed3\u679c\u662fC++\u63a5\u53e3\u5728VBA\u5b8f\u4ee3\u7801\u4e2d\u5de5\u4f5c\u6b63\u5e38\uff0c\u5374\u4e0d\u80fd\u6b63\u786e\u89e3\u6790\u5355\u5143\u683c\u516c\u5f0f\u8c03\u7528\u65f6\u4f20\u5165\u7684\u53c2\u6570\uff1b\u800c\u4e00\u65e6\u7ecf\u8fc7VBA\u51fd\u6570\u7684\u7b80\u5355\u5305\u88c5\uff0c\u5219\u53ef\u4ee5\u6b63\u5e38\u5e94\u7528\u4e8eVBA\u548c\u5355\u5143\u683c\u516c\u5f0f\u3002\u672c\u6587\u5b9e\u4f8b\u6f14\u793aC++ DLL\u4e2d\u4ee5\u4e0d\u540c\u7c7b\u578b\u63a5\u6536\u5206\u522b\u4eceExcel\u516c\u5f0f\u548cVBA\u4f20\u9012\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\u3002 \u539f\u56e0\u5206\u6790 \u00b6 \u5bfc\u81f4\u5f00\u5934\u63d0\u53ca\u95ee\u9898\u7684\u539f\u56e0\u662f\uff0c VBA\u5b8f\u4ee3\u7801\u548cExcel\u516c\u5f0f\u4f20\u9012\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u7f16\u7801\u65b9\u5f0f\u7565\u6709\u4e0d\u540c \uff1a Excel\u516c\u5f0f\u4ee5 Unicode\u6570\u7ec4 \u683c\u5f0f\u4f20\u9012\u5b57\u7b26\u4e32\uff0cVBA\u5219\u4ee5 ANSI\u6570\u7ec4 \u65b9\u5f0f\u4f20\u9012\u548c\u663e\u793a\u5b57\u7b26\u4e32\u3002 char* \u5bf9\u5e94\u4e86 ANSI \u5b57\u7b26\u4e32\uff0c\u56e0\u6b64C++\u63a5\u53e3\u5bf9VBA\u4f20\u53c2\u6210\u529f\u800c\u516c\u5f0f\u4f20\u53c2\u5931\u8d25\u3002 \u5355\u5143\u683c Unicode \u5b57\u7b26\u4e32\u4f20\u5165VBA\u51fd\u6570\u4e2d\u4f1a\u81ea\u52a8\u8fdb\u884c ANSI \u7f16\u7801\u8f6c\u6362\uff0c\u6240\u4ee5VBA\u5305\u88c5\u540e\u7684\u7248\u672c\u5bf9VBA\u548c\u5355\u5143\u683c\u516c\u5f0f\u90fd\u662f\u6709\u6548\u7684\u3002 C++\u4e2d\u4e0e Unicode \u5b57\u7b26\u4e32\u5bf9\u5e94\u7684\u662f\u5bbd\u5b57\u7b26\u4e32\u7c7b\u578b wchar_t* \u3002 \u56e0\u6b64\uff0c\u4ee5 char* \u7c7b\u578b\u63a5\u6536\u5b57\u7b26\u4e32\u7684\u63a5\u53e3\u51fd\u6570\u4ec5\u5bf9VBA\u6709\u6548\uff0c\u7ecf\u8fc7VBA\u5305\u88c5\u540e\u53ef\u4ee5\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\u3002\u82e5\u60f3\u5c06C++\u63a5\u53e3\u76f4\u63a5\u6b63\u786e\u5730\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\uff0cDLL\u4e2d\u9700\u8981\u4ee5 wchar_t* \u7c7b\u578b\u63a5\u6536\u53c2\u6570\u3002\u76f8\u5e94\u5730\uff0cVBA\u4e2d\u5219\u9700\u8981\u5148\u4f7f\u7528 StrConv() \u8f6c\u6362\u4e3a Unicode \u5b57\u7b26\u4e32\uff1b\u5982\u679c\u8fd4\u56de\u503c\u4e5f\u662f wchar_t* \u7c7b\u578b\uff0c\u540c\u7406\u9700\u8981 StrConv() \u8f6c\u6362\u56de ANSI \u5b57\u7b26\u4e32\u3002 \u4f20\u53c2\u793a\u4f8b \u00b6 \u4ee5 char* \u4e3a\u57fa\u672c\u7c7b\u578b\u7684\u4f20\u53c2\u793a\u4f8b\u53c2\u8003 \u524d\u6587\u4ee3\u7801 \uff0c\u7ed3\u5408VBA\u51fd\u6570\u7684\u5c01\u88c5\uff0c\u5df2\u7ecf\u53ef\u4ee5\u6ee1\u8db3\u6240\u6709\u5b57\u7b26\u4e32\u4f20\u53c2\u548c\u8fd4\u56de\u7684\u5e94\u7528\u573a\u666f\u3002 \u672c\u6587\u4ee5 wchar_t* \u4e3a\u63a5\u6536\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u57fa\u672c\u7c7b\u578b\uff0c\u540c\u65f6\u8003\u8651 BSTR \u548c VARIANT \u7c7b\u578b\uff08\u57fa\u672c\u7c7b\u578b\u4ecd\u4e3a wchar_t* \uff09\uff0c\u6f14\u793a\u5927\u5199\u8f6c\u6362\u51fd\u6570\u3002 0. char* \u4e0e wchar_t* \u7684\u8f6c\u6362 \u00b6 \u5bf9\u4e8e\u793a\u4f8b\u95ee\u9898\uff0c\u6211\u4eec\u590d\u7528\u524d\u6587\u57fa\u4e8e char* \u7248\u672c\u7684\u57fa\u672c\u8f6c\u6362\u51fd\u6570 upper_heap() \u3002\u56e0\u6b64\u57fa\u672c\u6d41\u7a0b\uff1a\u63a5\u6536 wchar_t* ->\u8f6c\u4e3a char* ->\u4ee3\u5165 upper_heap() ->\u8f6c\u6362\u56de wchar_t* \u3002\u5f00\u59cb\u4e4b\u524d\uff0c\u7ed9\u51fa char* \u4e0e wchar_t* \u7684\u8f6c\u6362\u51fd\u6570\uff1a char* Common::Wchar2char(const wchar_t* wchar) { size_t len = wcslen(wchar) + 1; size_t converted = 0; char* str; str = (char*)malloc(len* sizeof(char)); wcstombs_s(&converted, str, len, wchar, _TRUNCATE); return str; } wchar_t* Common::Char2wchar(const char* str) { size_t len = strlen(str) + 1; size_t converted = 0; wchar_t* wchar; wchar = (wchar_t*)malloc(len* sizeof(wchar_t)); mbstowcs_s(&converted, wchar, len, str, _TRUNCATE); return wchar; } 1. \u4ee5 wchar_t* \u63a5\u6536\u5b57\u7b26\u4e32 \u00b6 BSTR __stdcall upper_bstr_wchar(const wchar_t* wchar) { char* str = Common::Wchar2char(wchar); char* res = upper_heap(str); wchar_t* wchar_res = Common::Char2wchar(res); BSTR bstr = SysAllocString(wchar_res); free(str); free(wchar_res); delete[] res; return bstr; } \u4ece\u4e4b\u524d\u7684\u5206\u6790\u53ef\u77e5 upper_bstr_wchar() \u53ef\u4ee5\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\uff0c\u4f46\u9700\u8981\u7ecf\u8fc7\u7f16\u7801\u8f6c\u6362\u624d\u80fd\u5e94\u7528\u4e8eVBA\u3002\u76f8\u5e94\u5730\uff0cVBA\u51fd\u6570\u7684\u7b80\u5355\u5c01\u88c5\u5982\u4e0b\uff1a Declare Function upper_bstr_wchar Lib \"Sample_Passing_String.dll\" (ByVal str$) As String Function upper_vba_bstr_wchar(str As String) As String upper_vba_bstr_wchar = StrConv(upper_bstr_wchar(StrConv(str, vbUnicode)), vbFromUnicode) End Function \u5176\u4e2d\u4f20\u53c2\u65f6\u7528 StrConv(str, vbUnicode) \u8f6c\u6362\u4e3a Unicode \u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u65f6\u7528 StrConv(str, vbFromUnicode) \u8f6c\u6362\u56de ANSI \u5b57\u7b26\u4e32\u3002 2. \u4ee5 BSTR \u63a5\u6536\u5b57\u7b26\u4e32 \u00b6 \u5982\u679c\u4ee5 BSTR \u7c7b\u578b\u4f20\u5165\uff0c\u76f4\u63a5\u8f6c\u4e3a wchar_t* \u5373\u53ef\uff1a BSTR __stdcall upper_bstr_bstr(BSTR str) { return upper_bstr_wchar(str); } \u540c\u7406VBA\u7aef\u7684\u7b80\u5355\u5305\u88c5\uff1a Declare Function upper_bstr_bstr Lib \"Sample_Passing_String.dll\" (ByVal str As String) As String Function upper_vba_bstr_bstr(str As String) As String upper_vba_bstr_bstr = StrConv(upper_bstr_bstr(StrConv(str, vbUnicode)), vbFromUnicode) End Function 3. \u4ee5 VARIANT \u63a5\u6536\u5b57\u7b26\u4e32 \u00b6 \u5f53\u4ee5 VARIANT \u7c7b\u578b\u63a5\u6536\u5355\u5143\u683c\u516c\u5f0f\u4e2d\u4f20\u5165\u7684\u5355\u5143\u683c\u5bf9\u8c61\u65f6\uff0c\u9700\u8981\u5c06 Range \u8f6c\u6362\u4e3a\u5176\u4e2d\u5b58\u50a8\u7684\u6570\u636e\uff0c\u5177\u4f53\u65b9\u6cd5\u53c2\u8003 A C++ DLL for Excel that uses Arrays and Ranges BSTR __stdcall upper_bstr_var(VARIANT cell) { // convert from CELL // https://www.codeproject.com/Articles/17733/A-C-DLL-for-Excel-that-uses-Arrays-and-Ranges cell = Common::CheckExcelArray(cell); BSTR bstr = cell.vt == VT_BSTR ? cell.bstrVal : SysAllocString(L\"\"); return upper_bstr_bstr(bstr); } \u6ce8\u610f\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u8be5\u76f4\u63a5\u4f20\u5165VBA\u7684 ANSI \u5b57\u7b26\u4e32\u800c\u65e0\u9700 Unicode \u8f6c\u6362\uff1a Declare Function upper_bstr_var Lib \"Sample_Passing_String.dll\" (ByVal str As Variant) As String Function upper_vba_bstr_var(str As String) As String upper_vba_bstr_var = StrConv(upper_bstr_var(str), vbFromUnicode) End Function \u603b\u7ed3 \u00b6 char* \u548c wchar_t* \u662fC++\u4e2d\u63a5\u6536Excel\u4f20\u5165\u5b57\u7b26\u4e32\u7684\u57fa\u672c\u7c7b\u578b\u3002 BSTR \u548c VARIANT \u4e5f\u53ef\u4ee5\u63a5\u6536\u5b57\u7b26\u4e32\uff0c\u5bf9\u5e94 wchar_t* \u7c7b\u578b\u3002 \u7ed3\u5408C++\u63a5\u53e3\u548cVBA\u51fd\u6570\u5c01\u88c5\uff0c char* \u548c wchar_t* \u4efb\u4e00\u65b9\u5f0f\u90fd\u53ef\u4ee5\u6ee1\u8db3\u6240\u6709\u5b57\u7b26\u4e32\u4f20\u53c2\u548c\u8fd4\u56de\u503c\u9700\u6c42\u3002 char* \u9762\u5411\u76f4\u63a5VBA\u4ee3\u7801\u8c03\u7528\uff0cVBA\u51fd\u6570\u5c01\u88c5\u540e\u53ef\u4ee5\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f whar_t* \u76f4\u63a5\u9762\u5411\u5355\u5143\u683c\u516c\u5f0f\uff0cVBA\u51fd\u6570\u5c01\u88c5\u540e\u53ef\u4ee5\u5e94\u7528\u4e8eVBA\u4ee3\u7801 \u6700\u540e\uff0c\u672c\u6587\u5b8c\u6574\u4ee3\u7801\uff1a https://github.com/dothinking/blog/tree/master/samples/vba_cpp_dll/Sample_Pass_String","title":"C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#c dllvba","text":"\u53d1\u5e03\u4e8e\uff1a2019-08-31 | \u5206\u7c7b\uff1a python/vba/cpp \u524d\u6587\u4ee5 char* \u7c7b\u578b\u63a5\u6536Excel\u4e2d\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u5176\u7ed3\u679c\u662fC++\u63a5\u53e3\u5728VBA\u5b8f\u4ee3\u7801\u4e2d\u5de5\u4f5c\u6b63\u5e38\uff0c\u5374\u4e0d\u80fd\u6b63\u786e\u89e3\u6790\u5355\u5143\u683c\u516c\u5f0f\u8c03\u7528\u65f6\u4f20\u5165\u7684\u53c2\u6570\uff1b\u800c\u4e00\u65e6\u7ecf\u8fc7VBA\u51fd\u6570\u7684\u7b80\u5355\u5305\u88c5\uff0c\u5219\u53ef\u4ee5\u6b63\u5e38\u5e94\u7528\u4e8eVBA\u548c\u5355\u5143\u683c\u516c\u5f0f\u3002\u672c\u6587\u5b9e\u4f8b\u6f14\u793aC++ DLL\u4e2d\u4ee5\u4e0d\u540c\u7c7b\u578b\u63a5\u6536\u5206\u522b\u4eceExcel\u516c\u5f0f\u548cVBA\u4f20\u9012\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\u3002","title":"C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#_1","text":"\u5bfc\u81f4\u5f00\u5934\u63d0\u53ca\u95ee\u9898\u7684\u539f\u56e0\u662f\uff0c VBA\u5b8f\u4ee3\u7801\u548cExcel\u516c\u5f0f\u4f20\u9012\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u7f16\u7801\u65b9\u5f0f\u7565\u6709\u4e0d\u540c \uff1a Excel\u516c\u5f0f\u4ee5 Unicode\u6570\u7ec4 \u683c\u5f0f\u4f20\u9012\u5b57\u7b26\u4e32\uff0cVBA\u5219\u4ee5 ANSI\u6570\u7ec4 \u65b9\u5f0f\u4f20\u9012\u548c\u663e\u793a\u5b57\u7b26\u4e32\u3002 char* \u5bf9\u5e94\u4e86 ANSI \u5b57\u7b26\u4e32\uff0c\u56e0\u6b64C++\u63a5\u53e3\u5bf9VBA\u4f20\u53c2\u6210\u529f\u800c\u516c\u5f0f\u4f20\u53c2\u5931\u8d25\u3002 \u5355\u5143\u683c Unicode \u5b57\u7b26\u4e32\u4f20\u5165VBA\u51fd\u6570\u4e2d\u4f1a\u81ea\u52a8\u8fdb\u884c ANSI \u7f16\u7801\u8f6c\u6362\uff0c\u6240\u4ee5VBA\u5305\u88c5\u540e\u7684\u7248\u672c\u5bf9VBA\u548c\u5355\u5143\u683c\u516c\u5f0f\u90fd\u662f\u6709\u6548\u7684\u3002 C++\u4e2d\u4e0e Unicode \u5b57\u7b26\u4e32\u5bf9\u5e94\u7684\u662f\u5bbd\u5b57\u7b26\u4e32\u7c7b\u578b wchar_t* \u3002 \u56e0\u6b64\uff0c\u4ee5 char* \u7c7b\u578b\u63a5\u6536\u5b57\u7b26\u4e32\u7684\u63a5\u53e3\u51fd\u6570\u4ec5\u5bf9VBA\u6709\u6548\uff0c\u7ecf\u8fc7VBA\u5305\u88c5\u540e\u53ef\u4ee5\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\u3002\u82e5\u60f3\u5c06C++\u63a5\u53e3\u76f4\u63a5\u6b63\u786e\u5730\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\uff0cDLL\u4e2d\u9700\u8981\u4ee5 wchar_t* \u7c7b\u578b\u63a5\u6536\u53c2\u6570\u3002\u76f8\u5e94\u5730\uff0cVBA\u4e2d\u5219\u9700\u8981\u5148\u4f7f\u7528 StrConv() \u8f6c\u6362\u4e3a Unicode \u5b57\u7b26\u4e32\uff1b\u5982\u679c\u8fd4\u56de\u503c\u4e5f\u662f wchar_t* \u7c7b\u578b\uff0c\u540c\u7406\u9700\u8981 StrConv() \u8f6c\u6362\u56de ANSI \u5b57\u7b26\u4e32\u3002","title":"\u539f\u56e0\u5206\u6790"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#_2","text":"\u4ee5 char* \u4e3a\u57fa\u672c\u7c7b\u578b\u7684\u4f20\u53c2\u793a\u4f8b\u53c2\u8003 \u524d\u6587\u4ee3\u7801 \uff0c\u7ed3\u5408VBA\u51fd\u6570\u7684\u5c01\u88c5\uff0c\u5df2\u7ecf\u53ef\u4ee5\u6ee1\u8db3\u6240\u6709\u5b57\u7b26\u4e32\u4f20\u53c2\u548c\u8fd4\u56de\u7684\u5e94\u7528\u573a\u666f\u3002 \u672c\u6587\u4ee5 wchar_t* \u4e3a\u63a5\u6536\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u57fa\u672c\u7c7b\u578b\uff0c\u540c\u65f6\u8003\u8651 BSTR \u548c VARIANT \u7c7b\u578b\uff08\u57fa\u672c\u7c7b\u578b\u4ecd\u4e3a wchar_t* \uff09\uff0c\u6f14\u793a\u5927\u5199\u8f6c\u6362\u51fd\u6570\u3002","title":"\u4f20\u53c2\u793a\u4f8b"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#0 charwchar_t","text":"\u5bf9\u4e8e\u793a\u4f8b\u95ee\u9898\uff0c\u6211\u4eec\u590d\u7528\u524d\u6587\u57fa\u4e8e char* \u7248\u672c\u7684\u57fa\u672c\u8f6c\u6362\u51fd\u6570 upper_heap() \u3002\u56e0\u6b64\u57fa\u672c\u6d41\u7a0b\uff1a\u63a5\u6536 wchar_t* ->\u8f6c\u4e3a char* ->\u4ee3\u5165 upper_heap() ->\u8f6c\u6362\u56de wchar_t* \u3002\u5f00\u59cb\u4e4b\u524d\uff0c\u7ed9\u51fa char* \u4e0e wchar_t* \u7684\u8f6c\u6362\u51fd\u6570\uff1a char* Common::Wchar2char(const wchar_t* wchar) { size_t len = wcslen(wchar) + 1; size_t converted = 0; char* str; str = (char*)malloc(len* sizeof(char)); wcstombs_s(&converted, str, len, wchar, _TRUNCATE); return str; } wchar_t* Common::Char2wchar(const char* str) { size_t len = strlen(str) + 1; size_t converted = 0; wchar_t* wchar; wchar = (wchar_t*)malloc(len* sizeof(wchar_t)); mbstowcs_s(&converted, wchar, len, str, _TRUNCATE); return wchar; }","title":"0. char*\u4e0ewchar_t*\u7684\u8f6c\u6362"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#1 wchar_t","text":"BSTR __stdcall upper_bstr_wchar(const wchar_t* wchar) { char* str = Common::Wchar2char(wchar); char* res = upper_heap(str); wchar_t* wchar_res = Common::Char2wchar(res); BSTR bstr = SysAllocString(wchar_res); free(str); free(wchar_res); delete[] res; return bstr; } \u4ece\u4e4b\u524d\u7684\u5206\u6790\u53ef\u77e5 upper_bstr_wchar() \u53ef\u4ee5\u6b63\u786e\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f\uff0c\u4f46\u9700\u8981\u7ecf\u8fc7\u7f16\u7801\u8f6c\u6362\u624d\u80fd\u5e94\u7528\u4e8eVBA\u3002\u76f8\u5e94\u5730\uff0cVBA\u51fd\u6570\u7684\u7b80\u5355\u5c01\u88c5\u5982\u4e0b\uff1a Declare Function upper_bstr_wchar Lib \"Sample_Passing_String.dll\" (ByVal str$) As String Function upper_vba_bstr_wchar(str As String) As String upper_vba_bstr_wchar = StrConv(upper_bstr_wchar(StrConv(str, vbUnicode)), vbFromUnicode) End Function \u5176\u4e2d\u4f20\u53c2\u65f6\u7528 StrConv(str, vbUnicode) \u8f6c\u6362\u4e3a Unicode \u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u65f6\u7528 StrConv(str, vbFromUnicode) \u8f6c\u6362\u56de ANSI \u5b57\u7b26\u4e32\u3002","title":"1. \u4ee5wchar_t*\u63a5\u6536\u5b57\u7b26\u4e32"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#2 bstr","text":"\u5982\u679c\u4ee5 BSTR \u7c7b\u578b\u4f20\u5165\uff0c\u76f4\u63a5\u8f6c\u4e3a wchar_t* \u5373\u53ef\uff1a BSTR __stdcall upper_bstr_bstr(BSTR str) { return upper_bstr_wchar(str); } \u540c\u7406VBA\u7aef\u7684\u7b80\u5355\u5305\u88c5\uff1a Declare Function upper_bstr_bstr Lib \"Sample_Passing_String.dll\" (ByVal str As String) As String Function upper_vba_bstr_bstr(str As String) As String upper_vba_bstr_bstr = StrConv(upper_bstr_bstr(StrConv(str, vbUnicode)), vbFromUnicode) End Function","title":"2. \u4ee5BSTR\u63a5\u6536\u5b57\u7b26\u4e32"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#3 variant","text":"\u5f53\u4ee5 VARIANT \u7c7b\u578b\u63a5\u6536\u5355\u5143\u683c\u516c\u5f0f\u4e2d\u4f20\u5165\u7684\u5355\u5143\u683c\u5bf9\u8c61\u65f6\uff0c\u9700\u8981\u5c06 Range \u8f6c\u6362\u4e3a\u5176\u4e2d\u5b58\u50a8\u7684\u6570\u636e\uff0c\u5177\u4f53\u65b9\u6cd5\u53c2\u8003 A C++ DLL for Excel that uses Arrays and Ranges BSTR __stdcall upper_bstr_var(VARIANT cell) { // convert from CELL // https://www.codeproject.com/Articles/17733/A-C-DLL-for-Excel-that-uses-Arrays-and-Ranges cell = Common::CheckExcelArray(cell); BSTR bstr = cell.vt == VT_BSTR ? cell.bstrVal : SysAllocString(L\"\"); return upper_bstr_bstr(bstr); } \u6ce8\u610f\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u8be5\u76f4\u63a5\u4f20\u5165VBA\u7684 ANSI \u5b57\u7b26\u4e32\u800c\u65e0\u9700 Unicode \u8f6c\u6362\uff1a Declare Function upper_bstr_var Lib \"Sample_Passing_String.dll\" (ByVal str As Variant) As String Function upper_vba_bstr_var(str As String) As String upper_vba_bstr_var = StrConv(upper_bstr_var(str), vbFromUnicode) End Function","title":"3. \u4ee5VARIANT\u63a5\u6536\u5b57\u7b26\u4e32"},{"location":"2019-08-31-C%2B%2B-DLL%E4%B8%8EVBA%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BC%A0%E9%80%92%EF%BC%9A%E4%BC%A0%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2/#_3","text":"char* \u548c wchar_t* \u662fC++\u4e2d\u63a5\u6536Excel\u4f20\u5165\u5b57\u7b26\u4e32\u7684\u57fa\u672c\u7c7b\u578b\u3002 BSTR \u548c VARIANT \u4e5f\u53ef\u4ee5\u63a5\u6536\u5b57\u7b26\u4e32\uff0c\u5bf9\u5e94 wchar_t* \u7c7b\u578b\u3002 \u7ed3\u5408C++\u63a5\u53e3\u548cVBA\u51fd\u6570\u5c01\u88c5\uff0c char* \u548c wchar_t* \u4efb\u4e00\u65b9\u5f0f\u90fd\u53ef\u4ee5\u6ee1\u8db3\u6240\u6709\u5b57\u7b26\u4e32\u4f20\u53c2\u548c\u8fd4\u56de\u503c\u9700\u6c42\u3002 char* \u9762\u5411\u76f4\u63a5VBA\u4ee3\u7801\u8c03\u7528\uff0cVBA\u51fd\u6570\u5c01\u88c5\u540e\u53ef\u4ee5\u5e94\u7528\u4e8e\u5355\u5143\u683c\u516c\u5f0f whar_t* \u76f4\u63a5\u9762\u5411\u5355\u5143\u683c\u516c\u5f0f\uff0cVBA\u51fd\u6570\u5c01\u88c5\u540e\u53ef\u4ee5\u5e94\u7528\u4e8eVBA\u4ee3\u7801 \u6700\u540e\uff0c\u672c\u6587\u5b8c\u6574\u4ee3\u7801\uff1a https://github.com/dothinking/blog/tree/master/samples/vba_cpp_dll/Sample_Pass_String","title":"\u603b\u7ed3"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/","text":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-09-13 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Python\u6709\u5f88\u591a\u5f3a\u5927\u7684\u7b2c\u4e09\u65b9\u5e93\u53ef\u4ee5\u8bfb\u5199Excel\uff0c\u4f8b\u5982 xlrd \u3001 xlwt \u3001 xlutils \u3001 openpyxl \u3001 xlwings \u7b49\uff0c\u5b83\u4eec\u4e3b\u8981\u5728\u8bfb\u5199\u65b9\u9762\u5177\u5907\u4f18\u52bf\uff0c\u4f46\u8bba\u8d77\u5bf9Excel\u64cd\u4f5c\u7684\u5168\u9762\u6027\u548c\u57fa\u7840\u6027\uff0c\u5219\u9996\u63a8 win32com \uff0c\u5b83\u662f pywin32 \u5e93 1 \u7684\u4e00\u90e8\u5206\u3002\u672c\u6587\u4ee5\u4ee3\u7801\u7247\u6bb5\u65b9\u5f0f\u8bb0\u5f55\u4f7f\u7528 win32com \u8bfb\u5199\u3001\u8fd0\u884cVBA\u5b8f\u4ee3\u7801\u3002 \u6b63\u5982\u76f4\u63a5\u5728Excel VBA\u5de5\u7a0b\u4e2d\u64cd\u4f5c\u4e00\u6837\uff0c win32com \u53ef\u4ee5\u521b\u5efa\u3001\u5bfc\u5165\u3001\u6216\u8005\u5bfc\u51fa\u5de5\u4f5c\u7c3f\u4e2d\u7684VBA\u6a21\u5757\uff0c\u4e5f\u53ef\u4ee5\u8fd0\u884c\u5176\u4e2d\u7684\u5b8f\u3002\u540c\u7406\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u4e5f\u53d7\u5230Excel\u5b8f\u5b89\u5168\u6027\u8bbe\u7f6e\u7684\u5f71\u54cd\uff0c\u9700\u8981\u8003\u8651\u76f8\u5e94\u7684\u5b8f\u8bbe\u7f6e\u3002 \u5bfc\u51fa\u6a21\u5757 \u00b6 workbook.VBProject.VBComponents \u83b7\u53d6\u6240\u6709VBA\u6a21\u5757\uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u884c\u5bfc\u51fa/\u8bfb\u53d6\u5185\u5bb9\u64cd\u4f5c\uff1a def export_module(wb, module_name, saved_file): '''export vba module to file''' for comp in wb.VBProject.VBComponents: if comp.Name == module_name: comp.Export(saved_file) return True else: return False \u5bfc\u5165\u6a21\u5757 \u00b6 \u4e0a\u9762 Export() \u65b9\u6cd5\u5bfc\u51fa\u7684\u5b8f\u6587\u4ef6\u662f\u4ee5 Attribute VB_Name = \"xxxx\" \u5f00\u5934\u7684\uff0c\u7136\u540e\u624d\u662f\u4ee3\u7801\u6b63\u6587\u3002\u76f8\u5e94\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5224\u65ad\u7b2c\u4e00\u884c\u5f97\u5230\u5b8f\u7684\u540d\u79f0\uff0c\u7136\u540e\u7528 Import() \u65b9\u6cd5\u8fdb\u884c\u5bfc\u5165\uff0c\u5e76\u4e14\u6ce8\u610f\u4e0d\u53ef\u91cd\u590d\u5bfc\u5165\u5df2\u5b58\u5728\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u8981\u9009\u62e9\u4fdd\u7559\u6216\u8005\u66ff\u6362\u539f\u6a21\u5757\u3002 def import_module(wb, module_file): ''' import vba module from *.bas. module name is declared in the first line of module_file: Attribute VB_Name = \"xxxx\" ''' # check module name with open(module_file, 'r') as f: for line in f: if line.startswith('Attribute VB_Name'): module_name = line.split('\"')[-2] break else: raise Exception('Error: Invalid module file.') # check modules and remove original one for comp in wb.VBProject.VBComponents: if comp.Name == module_name: print(f'[info] module {module_name} already exists, remove it now.') wb.VBProject.VBComponents.Remove(comp) break # import wb.VBProject.VBComponents.Import(module_file) return module_name \u521b\u5efa\u6a21\u5757 \u00b6 \u4e0a\u9762\u662f\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u5bfc\u5165/\u5bfc\u51fa\u6a21\u5757\u4ee3\u7801\uff0c\u5f53\u7136\u8fd8\u53ef\u4ee5\u4ee5\u6587\u672c\u5f62\u5f0f\u521b\u5efa\u3001\u66f4\u65b0\u6a21\u5757\u4ee3\u7801\u3002 def create_module(wb, name): '''Add normal module.''' module = wb.VBProject.VBComponents.Add(1) module.Name = name \u8bfb\u53d6\u6a21\u5757\u4ee3\u7801 \u00b6 def get_module(wb, name): ''' Get the module content from the workbook. ''' cm = wb.VBProject.VBComponents(name).CodeModule num = cm.CountOfLines return cm.Lines(1, num) if num else '' def get_modules(wb): ''' Get all modules contents from the workbook and return a dictionary. ''' for module in wb.VBProject.VBComponents: yield module.Name, module.Type, get_module(module.Name) \u66f4\u65b0\u6a21\u5757\u4ee3\u7801 \u00b6 def set_module(wb, name, code): ''' update code of specified module ''' comp = wb.VBProject.VBComponents(name) assert comp, f'Module {name} does not exist in the workbook.' cm = comp.CodeModule num = cm.CountOfLines if num > 0: cm.DeleteLines(1, num) cm.AddFromString(code) # save wb.Save() \u8fd0\u884c\u5b8f \u00b6 VBA\u4e2d Application.Run() \u53ef\u4ee5\u8fd0\u884c\u5b8f\uff0c\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u5728 win32com \u6a21\u5757\u4f7f\u7528\u76f8\u5e94\u7684\u51fd\u6570\u3002 def run_macro(wb, macro_name): '''run macro embedded in current toll :param macro_name: macro name, e.g. workbook_name!mudule_name.sub_name if errors exist in the macro, this function will be blocked. so ensure the macro works well and insert the following macro at the beginning for safe: On Error Resume Next ''' try: wb.Application.Run(macro_name) except Exception as e: print(e, flush=True) return False else: return True \u6ce8\u610f\u4e8b\u9879 \u00b6 \u64cd\u4f5c\u5b8f\u7684Excel\u8bbe\u7f6e \u00b6 \u6210\u529f\u4f7f\u7528 win32com \u64cd\u4f5c\u5b8f\u7684\u524d\u63d0\u662f \u5141\u8bb8\u8bbf\u95eeVBA\u5de5\u7a0b\u5bf9\u8c61\u6a21\u578b \uff1a File -> Option -> Trust Center Setting... -> Macro Settings \u3002\u5426\u5219\uff0c\u63d0\u793a\u65e0\u6743\u83b7\u53d6VBA\u5de5\u7a0b\u7684\u6a21\u5757\u3002 Programmatic access to Visual Basic Project is not trusted. \u9664\u4e86\u624b\u52a8\u8bbe\u7f6e\u4e0a\u8ff0\u9009\u9879\u5916\uff0c\u8fd8\u53ef\u4ee5\u7a0b\u5e8f\u7684\u65b9\u5f0f\u52a8\u6001\u4fee\u6539\uff1a\u8fd9\u4e2a\u9009\u9879\u7684\u5f00\u5173\u662f\u6ce8\u518c\u8868\u9879\u76ee\u4e0b AccessVBOM \u5b57\u6bb5\u63a7\u5236\u7684\uff0c0\u8868\u793a\u7981\u7528\uff0c1\u8868\u793a\u542f\u7528\u3002\u56e0\u6b64\u5b89\u5168\u7684\u505a\u6cd5\u662f\u5728\u8bbf\u95eeVBA\u6a21\u5757\u524d\u4fee\u6539\u8be5\u8bbe\u7f6e\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7Python\u64cd\u4f5c\u6ce8\u518c\u8868\u6765\u5b9e\u73b0\u3002\u4ee5Excel 2010\u4e3a\u4f8b\uff1a import win32api import win32con def access_VBA_object_model(value): '''programmatically enable access to the VBA object module :param value: 0->disabled, 1->enabled ''' # open registry on Excel2010 key = win32api.RegOpenKeyEx(win32con.HKEY_CURRENT_USER, 'Software\\\\Microsoft\\\\Office\\\\14.0\\\\Excel\\\\Security', 0, win32con.KEY_ALL_ACCESS) # store original value val, _ = win32api.RegQueryValueEx(key,'AccessVBOM') # (value, type) # set value: # the property name \"AccessVBOM\" could be check from Registry win32api.RegSetValueEx(key, \"AccessVBOM\", 0, win32con.REG_DWORD, value) # close win32api.RegCloseKey(key) return val \u4e0a\u8ff0\u4ee3\u7801\u8bb0\u5f55\u4e86\u4fee\u6539\u524d\u7684\u503c\uff0c\u4ee5\u4fbf\u5904\u7406\u5b8c\u540e\u6062\u590d\u539f\u6765\u7684\u8bbe\u7f6e\u3002 \u8fd0\u884c\u5b8f\u7684Excel\u8bbe\u7f6e \u00b6 \u8fd0\u884c\u5b8f\u540c\u6837\u5b58\u5728\u5b89\u5168\u7b56\u7565\u7684\u8bbe\u7f6e\u95ee\u9898\u3002\u6839\u636e\u7cfb\u7edf\u8bbe\u7f6e\u7b56\u7565\uff0c\u4e0d\u5728\u4fe1\u4efb\u533a\u57df\u7684\u5b8f\u4ee3\u7801\u53ef\u80fd\u662f\u9ed8\u8ba4\u88ab\u7981\u7528\u7684\uff0c\u90a3\u4e48\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\u5c06\u63d0\u793a\u4e0d\u5b58\u5728\u8be5\u5b8f\u3002Excel\u8f6f\u4ef6\u4e2d\u5bf9\u5e94\u8fd9\u4e2a\u8bbe\u7f6e\u7684\u64cd\u4f5c\u662f\uff1a File -> Option -> Trust Center Setting... -> ActiveX Settings \uff0c\u5176\u4e2d\u6709\u4e0d\u540c\u7684\u9009\u9879\u4f8b\u5982\u9ed8\u8ba4\u7981\u7528\u3001\u9ed8\u8ba4\u7981\u7528\u4f46\u6253\u5f00\u5de5\u4f5c\u7c3f\u65f6\u7ed9\u4e88\u63d0\u9192\u3001\u5168\u90e8\u542f\u7528\u7b49\u3002 \u7a0b\u5e8f\u4e2d\u5219\u7531 Application \u7684 AutomationSecurity \u5c5e\u6027\u63a7\u5236\uff1a2\u8868\u793a\u7981\u7528\u6240\u6709\u5b8f, 1\u8868\u793a\u542f\u7528\u6240\u6709\u5b8f\u3002\u5982\u679c\u6765\u6e90\u786e\u5b9e\u53ef\u9760\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6267\u884c\u5b8f\u524d\u542f\u7528\u6240\u6709\u5b8f\uff0c\u6700\u540e\u4fee\u6539\u56de\u4e4b\u524d\u7684\u8bbe\u7f6e\u5373\u53ef\u3002 app = win32com.client.Dispatch(\"Excel.Application\") # save original value origin_val = app.Application.AutomationSecurity # enable all app.Application.AutomationSecurity = 1 # run macro here # ... # reset app.Application.AutomationSecurity = origin_val \u66f4\u65b0\u5b8f\u7684\u95ee\u9898 \u00b6 \u4e0a\u9762\u66f4\u65b0\u6a21\u5757\u4ee3\u7801\u7684\u51fd\u6570 set_module(wb, name, code) \uff0c\u6709\u65f6\u4f1a\u51fa\u73b0\u83ab\u540d\u5176\u5999\u7684\u95ee\u9898\uff1a\u5728 name \u6a21\u5757\u7684\u672b\u5c3e\u591a\u51fa\u4e86\u4e00\u5bf9\u62ec\u53f7 () \u3002\u4e5f\u5c31\u662f\u8bf4\u51c6\u5907\u8bbe\u7f6e code \uff0c\u7ed3\u679c\u5374\u662f code + () \u3002 \u6839\u636e stackoverflow \u4e0a\u7684\u4e00\u4e2a\u63d0\u95ee 2 \uff0c\u539f\u56e0\u5728\u4e8e\uff1a win32com \u5904\u7406VBA\u65f6\u65e0\u6cd5\u5b8c\u5168\u6b63\u786e\u5730\u8bc6\u522bVBA\u7684\u7eed\u884c\u7b26 _ \u3002 \u4f8b\u5982\uff0c\u5f53 code \u4e2d\u5305\u542b\u4e0b\u9762\u7247\u6bb5\u65f6\uff1a Private Declare PtrSafe Function foo Lib \"bar.dll\" _ Alias \"foo_bar\" ( _ ByVal x As Long, _ ByVal y As Long) As Long \u62ec\u53f7\u4e2d\u7684\u4e24\u4e2a\u7eed\u884c\u7b26 _ \u53ef\u4ee5\u88ab\u6b63\u786e\u8bc6\u522b\uff0c\u4f46\u7b2c\u4e00\u884c\u5b64\u7acb\u7684 _ \u5219\u51fa\u73b0\u4e86\u95ee\u9898\uff0c\u4e8e\u662fVBA\u7684\u81ea\u52a8\u5b8c\u6210\u673a\u5236\u5bfc\u81f4\u4e86\u6700\u540e\u7684\u4e00\u5bf9 () \u3002 \u6240\u4ee5\u5c3d\u91cf\u907f\u514d\u51fa\u73b0\u4e0a\u8ff0\u5199\u6cd5\uff0c\u6216\u8005\u5f3a\u5236\u5c06\u672b\u5c3e\u7684 _ \u5220\u9664\u5e76\u5408\u5e76\u76f8\u5e94\u7684\u4e24\u884c\u3002 Python for Windows (pywin32) Extensions \u21a9 Problem with AddFromString function of CodeModule in VBA \u21a9","title":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#python win32comexcelvba","text":"\u53d1\u5e03\u4e8e\uff1a2019-09-13 | \u5206\u7c7b\uff1a process automation , python/vba/cpp Python\u6709\u5f88\u591a\u5f3a\u5927\u7684\u7b2c\u4e09\u65b9\u5e93\u53ef\u4ee5\u8bfb\u5199Excel\uff0c\u4f8b\u5982 xlrd \u3001 xlwt \u3001 xlutils \u3001 openpyxl \u3001 xlwings \u7b49\uff0c\u5b83\u4eec\u4e3b\u8981\u5728\u8bfb\u5199\u65b9\u9762\u5177\u5907\u4f18\u52bf\uff0c\u4f46\u8bba\u8d77\u5bf9Excel\u64cd\u4f5c\u7684\u5168\u9762\u6027\u548c\u57fa\u7840\u6027\uff0c\u5219\u9996\u63a8 win32com \uff0c\u5b83\u662f pywin32 \u5e93 1 \u7684\u4e00\u90e8\u5206\u3002\u672c\u6587\u4ee5\u4ee3\u7801\u7247\u6bb5\u65b9\u5f0f\u8bb0\u5f55\u4f7f\u7528 win32com \u8bfb\u5199\u3001\u8fd0\u884cVBA\u5b8f\u4ee3\u7801\u3002 \u6b63\u5982\u76f4\u63a5\u5728Excel VBA\u5de5\u7a0b\u4e2d\u64cd\u4f5c\u4e00\u6837\uff0c win32com \u53ef\u4ee5\u521b\u5efa\u3001\u5bfc\u5165\u3001\u6216\u8005\u5bfc\u51fa\u5de5\u4f5c\u7c3f\u4e2d\u7684VBA\u6a21\u5757\uff0c\u4e5f\u53ef\u4ee5\u8fd0\u884c\u5176\u4e2d\u7684\u5b8f\u3002\u540c\u7406\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u4e5f\u53d7\u5230Excel\u5b8f\u5b89\u5168\u6027\u8bbe\u7f6e\u7684\u5f71\u54cd\uff0c\u9700\u8981\u8003\u8651\u76f8\u5e94\u7684\u5b8f\u8bbe\u7f6e\u3002","title":"Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_1","text":"workbook.VBProject.VBComponents \u83b7\u53d6\u6240\u6709VBA\u6a21\u5757\uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u884c\u5bfc\u51fa/\u8bfb\u53d6\u5185\u5bb9\u64cd\u4f5c\uff1a def export_module(wb, module_name, saved_file): '''export vba module to file''' for comp in wb.VBProject.VBComponents: if comp.Name == module_name: comp.Export(saved_file) return True else: return False","title":"\u5bfc\u51fa\u6a21\u5757"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_2","text":"\u4e0a\u9762 Export() \u65b9\u6cd5\u5bfc\u51fa\u7684\u5b8f\u6587\u4ef6\u662f\u4ee5 Attribute VB_Name = \"xxxx\" \u5f00\u5934\u7684\uff0c\u7136\u540e\u624d\u662f\u4ee3\u7801\u6b63\u6587\u3002\u76f8\u5e94\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5224\u65ad\u7b2c\u4e00\u884c\u5f97\u5230\u5b8f\u7684\u540d\u79f0\uff0c\u7136\u540e\u7528 Import() \u65b9\u6cd5\u8fdb\u884c\u5bfc\u5165\uff0c\u5e76\u4e14\u6ce8\u610f\u4e0d\u53ef\u91cd\u590d\u5bfc\u5165\u5df2\u5b58\u5728\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u8981\u9009\u62e9\u4fdd\u7559\u6216\u8005\u66ff\u6362\u539f\u6a21\u5757\u3002 def import_module(wb, module_file): ''' import vba module from *.bas. module name is declared in the first line of module_file: Attribute VB_Name = \"xxxx\" ''' # check module name with open(module_file, 'r') as f: for line in f: if line.startswith('Attribute VB_Name'): module_name = line.split('\"')[-2] break else: raise Exception('Error: Invalid module file.') # check modules and remove original one for comp in wb.VBProject.VBComponents: if comp.Name == module_name: print(f'[info] module {module_name} already exists, remove it now.') wb.VBProject.VBComponents.Remove(comp) break # import wb.VBProject.VBComponents.Import(module_file) return module_name","title":"\u5bfc\u5165\u6a21\u5757"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_3","text":"\u4e0a\u9762\u662f\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u5bfc\u5165/\u5bfc\u51fa\u6a21\u5757\u4ee3\u7801\uff0c\u5f53\u7136\u8fd8\u53ef\u4ee5\u4ee5\u6587\u672c\u5f62\u5f0f\u521b\u5efa\u3001\u66f4\u65b0\u6a21\u5757\u4ee3\u7801\u3002 def create_module(wb, name): '''Add normal module.''' module = wb.VBProject.VBComponents.Add(1) module.Name = name","title":"\u521b\u5efa\u6a21\u5757"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_4","text":"def get_module(wb, name): ''' Get the module content from the workbook. ''' cm = wb.VBProject.VBComponents(name).CodeModule num = cm.CountOfLines return cm.Lines(1, num) if num else '' def get_modules(wb): ''' Get all modules contents from the workbook and return a dictionary. ''' for module in wb.VBProject.VBComponents: yield module.Name, module.Type, get_module(module.Name)","title":"\u8bfb\u53d6\u6a21\u5757\u4ee3\u7801"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_5","text":"def set_module(wb, name, code): ''' update code of specified module ''' comp = wb.VBProject.VBComponents(name) assert comp, f'Module {name} does not exist in the workbook.' cm = comp.CodeModule num = cm.CountOfLines if num > 0: cm.DeleteLines(1, num) cm.AddFromString(code) # save wb.Save()","title":"\u66f4\u65b0\u6a21\u5757\u4ee3\u7801"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_6","text":"VBA\u4e2d Application.Run() \u53ef\u4ee5\u8fd0\u884c\u5b8f\uff0c\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u5728 win32com \u6a21\u5757\u4f7f\u7528\u76f8\u5e94\u7684\u51fd\u6570\u3002 def run_macro(wb, macro_name): '''run macro embedded in current toll :param macro_name: macro name, e.g. workbook_name!mudule_name.sub_name if errors exist in the macro, this function will be blocked. so ensure the macro works well and insert the following macro at the beginning for safe: On Error Resume Next ''' try: wb.Application.Run(macro_name) except Exception as e: print(e, flush=True) return False else: return True","title":"\u8fd0\u884c\u5b8f"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_7","text":"","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#excel","text":"\u6210\u529f\u4f7f\u7528 win32com \u64cd\u4f5c\u5b8f\u7684\u524d\u63d0\u662f \u5141\u8bb8\u8bbf\u95eeVBA\u5de5\u7a0b\u5bf9\u8c61\u6a21\u578b \uff1a File -> Option -> Trust Center Setting... -> Macro Settings \u3002\u5426\u5219\uff0c\u63d0\u793a\u65e0\u6743\u83b7\u53d6VBA\u5de5\u7a0b\u7684\u6a21\u5757\u3002 Programmatic access to Visual Basic Project is not trusted. \u9664\u4e86\u624b\u52a8\u8bbe\u7f6e\u4e0a\u8ff0\u9009\u9879\u5916\uff0c\u8fd8\u53ef\u4ee5\u7a0b\u5e8f\u7684\u65b9\u5f0f\u52a8\u6001\u4fee\u6539\uff1a\u8fd9\u4e2a\u9009\u9879\u7684\u5f00\u5173\u662f\u6ce8\u518c\u8868\u9879\u76ee\u4e0b AccessVBOM \u5b57\u6bb5\u63a7\u5236\u7684\uff0c0\u8868\u793a\u7981\u7528\uff0c1\u8868\u793a\u542f\u7528\u3002\u56e0\u6b64\u5b89\u5168\u7684\u505a\u6cd5\u662f\u5728\u8bbf\u95eeVBA\u6a21\u5757\u524d\u4fee\u6539\u8be5\u8bbe\u7f6e\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7Python\u64cd\u4f5c\u6ce8\u518c\u8868\u6765\u5b9e\u73b0\u3002\u4ee5Excel 2010\u4e3a\u4f8b\uff1a import win32api import win32con def access_VBA_object_model(value): '''programmatically enable access to the VBA object module :param value: 0->disabled, 1->enabled ''' # open registry on Excel2010 key = win32api.RegOpenKeyEx(win32con.HKEY_CURRENT_USER, 'Software\\\\Microsoft\\\\Office\\\\14.0\\\\Excel\\\\Security', 0, win32con.KEY_ALL_ACCESS) # store original value val, _ = win32api.RegQueryValueEx(key,'AccessVBOM') # (value, type) # set value: # the property name \"AccessVBOM\" could be check from Registry win32api.RegSetValueEx(key, \"AccessVBOM\", 0, win32con.REG_DWORD, value) # close win32api.RegCloseKey(key) return val \u4e0a\u8ff0\u4ee3\u7801\u8bb0\u5f55\u4e86\u4fee\u6539\u524d\u7684\u503c\uff0c\u4ee5\u4fbf\u5904\u7406\u5b8c\u540e\u6062\u590d\u539f\u6765\u7684\u8bbe\u7f6e\u3002","title":"\u64cd\u4f5c\u5b8f\u7684Excel\u8bbe\u7f6e"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#excel_1","text":"\u8fd0\u884c\u5b8f\u540c\u6837\u5b58\u5728\u5b89\u5168\u7b56\u7565\u7684\u8bbe\u7f6e\u95ee\u9898\u3002\u6839\u636e\u7cfb\u7edf\u8bbe\u7f6e\u7b56\u7565\uff0c\u4e0d\u5728\u4fe1\u4efb\u533a\u57df\u7684\u5b8f\u4ee3\u7801\u53ef\u80fd\u662f\u9ed8\u8ba4\u88ab\u7981\u7528\u7684\uff0c\u90a3\u4e48\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\u5c06\u63d0\u793a\u4e0d\u5b58\u5728\u8be5\u5b8f\u3002Excel\u8f6f\u4ef6\u4e2d\u5bf9\u5e94\u8fd9\u4e2a\u8bbe\u7f6e\u7684\u64cd\u4f5c\u662f\uff1a File -> Option -> Trust Center Setting... -> ActiveX Settings \uff0c\u5176\u4e2d\u6709\u4e0d\u540c\u7684\u9009\u9879\u4f8b\u5982\u9ed8\u8ba4\u7981\u7528\u3001\u9ed8\u8ba4\u7981\u7528\u4f46\u6253\u5f00\u5de5\u4f5c\u7c3f\u65f6\u7ed9\u4e88\u63d0\u9192\u3001\u5168\u90e8\u542f\u7528\u7b49\u3002 \u7a0b\u5e8f\u4e2d\u5219\u7531 Application \u7684 AutomationSecurity \u5c5e\u6027\u63a7\u5236\uff1a2\u8868\u793a\u7981\u7528\u6240\u6709\u5b8f, 1\u8868\u793a\u542f\u7528\u6240\u6709\u5b8f\u3002\u5982\u679c\u6765\u6e90\u786e\u5b9e\u53ef\u9760\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6267\u884c\u5b8f\u524d\u542f\u7528\u6240\u6709\u5b8f\uff0c\u6700\u540e\u4fee\u6539\u56de\u4e4b\u524d\u7684\u8bbe\u7f6e\u5373\u53ef\u3002 app = win32com.client.Dispatch(\"Excel.Application\") # save original value origin_val = app.Application.AutomationSecurity # enable all app.Application.AutomationSecurity = 1 # run macro here # ... # reset app.Application.AutomationSecurity = origin_val","title":"\u8fd0\u884c\u5b8f\u7684Excel\u8bbe\u7f6e"},{"location":"2019-09-13-Python-win32com%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9CExcel%EF%BC%9AVBA%E6%A8%A1%E5%9D%97%E8%AF%BB%E5%86%99/#_8","text":"\u4e0a\u9762\u66f4\u65b0\u6a21\u5757\u4ee3\u7801\u7684\u51fd\u6570 set_module(wb, name, code) \uff0c\u6709\u65f6\u4f1a\u51fa\u73b0\u83ab\u540d\u5176\u5999\u7684\u95ee\u9898\uff1a\u5728 name \u6a21\u5757\u7684\u672b\u5c3e\u591a\u51fa\u4e86\u4e00\u5bf9\u62ec\u53f7 () \u3002\u4e5f\u5c31\u662f\u8bf4\u51c6\u5907\u8bbe\u7f6e code \uff0c\u7ed3\u679c\u5374\u662f code + () \u3002 \u6839\u636e stackoverflow \u4e0a\u7684\u4e00\u4e2a\u63d0\u95ee 2 \uff0c\u539f\u56e0\u5728\u4e8e\uff1a win32com \u5904\u7406VBA\u65f6\u65e0\u6cd5\u5b8c\u5168\u6b63\u786e\u5730\u8bc6\u522bVBA\u7684\u7eed\u884c\u7b26 _ \u3002 \u4f8b\u5982\uff0c\u5f53 code \u4e2d\u5305\u542b\u4e0b\u9762\u7247\u6bb5\u65f6\uff1a Private Declare PtrSafe Function foo Lib \"bar.dll\" _ Alias \"foo_bar\" ( _ ByVal x As Long, _ ByVal y As Long) As Long \u62ec\u53f7\u4e2d\u7684\u4e24\u4e2a\u7eed\u884c\u7b26 _ \u53ef\u4ee5\u88ab\u6b63\u786e\u8bc6\u522b\uff0c\u4f46\u7b2c\u4e00\u884c\u5b64\u7acb\u7684 _ \u5219\u51fa\u73b0\u4e86\u95ee\u9898\uff0c\u4e8e\u662fVBA\u7684\u81ea\u52a8\u5b8c\u6210\u673a\u5236\u5bfc\u81f4\u4e86\u6700\u540e\u7684\u4e00\u5bf9 () \u3002 \u6240\u4ee5\u5c3d\u91cf\u907f\u514d\u51fa\u73b0\u4e0a\u8ff0\u5199\u6cd5\uff0c\u6216\u8005\u5f3a\u5236\u5c06\u672b\u5c3e\u7684 _ \u5220\u9664\u5e76\u5408\u5e76\u76f8\u5e94\u7684\u4e24\u884c\u3002 Python for Windows (pywin32) Extensions \u21a9 Problem with AddFromString function of CodeModule in VBA \u21a9","title":"\u66f4\u65b0\u5b8f\u7684\u95ee\u9898"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","text":"\u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-09-14 | \u5206\u7c7b\uff1a process automation \u53c2\u8003\u524d\u6587\u5173\u4e8e win32com \u6a21\u5757\u7684\u793a\u4f8b\u4ee3\u7801\u53ef\u4ee5\u8fdb\u884cExcel\u7684\u81ea\u52a8\u5316\u64cd\u4f5c\uff0c\u4f8b\u5982Excel VBA\u7684\u81ea\u52a8\u5316\u6d4b\u8bd5\uff1b\u5c06\u5176\u4f5c\u4e3aWindows\u670d\u52a1\u8fd0\u884c\uff0c\u5219\u53ef\u4ee5\u65b9\u4fbf\u4e3a\u7f51\u7edc\u4e2d\u7684\u5176\u4ed6\u673a\u5668\u8c03\u7528\u3002\u672c\u6587\u6b63\u662f\u8bb0\u5f55\u914d\u7f6eExcel\u81ea\u52a8\u5316\u670d\u52a1\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u4e0e\u76f8\u5e94\u89e3\u51b3\u63aa\u65bd\u3002 \u6982\u8ff0 \u00b6 \u6700\u8fd1\u6709\u4e2a\u9700\u6c42\u662f\u5bf9\u542f\u7528\u5b8f\u7684Excel 2010\u6587\u4ef6\u7684\u81ea\u52a8\u5316\u6d4b\u8bd5\uff0c\u9700\u8981\u914d\u7f6e\u5728\u670d\u52a1\u5668\u4e0a\u4ee5\u4f9b GitLab-Runner \u8c03\u7528\u3002\u4e8e\u662f\uff0c\u6309\u7167\u8bfb\u5165\u6d4b\u8bd5\u6570\u636e\u3001\u6267\u884c\u6d4b\u8bd5VBA\u3001\u9a8c\u8bc1\u8ba1\u7b97\u7ed3\u679c\u7684\u903b\u8f91\u5199\u597dPython\u811a\u672c\uff0c\u8c03\u8bd5\u901a\u8fc7\u540e\u5728\u672c\u5730\u8fd0\u884c\u4e00\u5207\u6b63\u5e38\u3002\u7136\u800c\uff0c\u901a\u8fc7Commit\u63d0\u4ea4\u89e6\u53d1CI/CD\u6d41\u7a0b\uff0c\u5373 GitLab-Runner \u4ee5Windows\u670d\u52a1\u7684\u65b9\u5f0f\u6267\u884c\u76f8\u540c\u7684\u811a\u672c\u65f6\uff0c\u5374\u51fa\u73b0\u4e86\u5404\u79cd\u5404\u6837\u7684\u95ee\u9898\u3002 \u6839\u672c\u539f\u56e0\u663e\u7136\u662f \u672c\u5730\u8d26\u6237 \u548c \u7cfb\u7edf\u670d\u52a1 \u6267\u884cExcel\u81ea\u52a8\u5316\u64cd\u4f5c\u4e0a\u7684\u5dee\u5f02\uff0c\u4ee5\u4e0b\u9010\u4e00\u8bb0\u5f55\u9047\u5230\u7684\u95ee\u9898\u3002\u9664\u4e86\u90e8\u5206\u4e0ePython\u76f8\u5173\u7684\u95ee\u9898\u5916\uff0c\u5176\u4f59\u5e94\u8be5\u5177\u5907\u901a\u7528\u6027\uff0c\u53ef\u4f5c\u4e3aWindows\u670d\u52a1\u65b9\u5f0f\u6267\u884cExcel\u3001Word\u3001Outlook\u7b49\u81ea\u52a8\u5316\u7a0b\u5e8f\u51fa\u73b0\u95ee\u9898\u65f6\u7684\u53c2\u8003\u3002 \u6ce8\u610f \u5f53\u524d\u767b\u9646\u8d26\u6237\u5e94\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u3002 Open method of Workbooks class failed \u00b6 (-2147352567, 'Exception occurred.', (0, 'Microsoft Excel', 'Open method of Workbooks class failed', 'xlmain11.chm', 0, -2146827284), None) \u5728Stackoverflow\u641c\u7d22\u5230\u4e86\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5 1 \uff0c\u6839\u636eWindows\u4f4d\u6570\u5728\u76ee\u6807\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a Desktop \u6587\u4ef6\u5939\uff1a 64\u4f4d\u7cfb\u7edf\uff1a C:\\Windows\\SysWOW64\\config\\systemprofile\\ 32\u4f4d\u7cfb\u7edf\uff1a C:\\Windows\\System32\\config\\systemprofile\\ \u867d\u7136\u6682\u65f6\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u5374\u4e5f\u4e0d\u77e5\u662f\u4f55\u7f18\u7531\u3002\u7ecf\u5386\u540e\u7eed\u95ee\u9898\u624d\u660e\u767d\uff1aExcel\u9700\u8981\u6709 Interactive User \u767b\u9646\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u4e0a\u9762\u7684\u6b65\u9aa4\u6b63\u662f\u4e3a\u5176\u63d0\u4f9b\u4e86\u7528\u6237\u201c\u684c\u9762\u201d\uff1b\u7136\u800c\u4e00\u65e6\u9700\u8981\u66f4\u591a\u7528\u6237\u8d26\u6237\u76f8\u5173\u7684\u8bbe\u7f6e\u65f6\uff0c\u5c31\u4f1a\u6709\u65b0\u7684\u95ee\u9898\u51fa\u73b0\u4e86\u3002 Programmatic access to Visual Basic Project is not trusted \u00b6 (-2147352567, 'Exception occurred.', (0, 'Microsoft Excel', 'Programmatic access to Visual Basic Project is not trusted\\n', 'xlmain11.chm', 0, -2146827284), None) \u8fd9\u4e2a\u95ee\u9898\u5f88\u660e\u663e\uff0c\u4e00\u65e6\u4ee3\u7801\u9700\u8981\u8bbf\u95eeVBA\u5de5\u7a0b\u5bf9\u8c61\uff0c\u4f8b\u5982\u8bbf\u95ee module \u5bf9\u8c61\u3001Python\u52a8\u6001\u6267\u884cVBA\u4ee3\u7801\uff0c\u5219\u9700\u8981\u76f8\u5e94\u7684\u8bb8\u53ef\uff08Excel\u8f6f\u4ef6\u4fe1\u4efb\u533a\u8bbe\u7f6e\u4e2d\u6709\u8be5\u9009\u9879\uff09\u3002 \u89e3\u51b3\u65b9\u6cd5\u53ef\u4ee5\u662f\u5229\u7528Python\u52a8\u6001\u4fee\u6539\u76f8\u5e94\u6ce8\u518c\u8868\u9879\u548c\u503c\u6765\u5141\u8bb8\u8bbf\u95eeVB\u5de5\u7a0b\uff0c\u6216\u8005\u53c2\u8003 2 \u624b\u5de5\u6c38\u4e45\u8bbe\u7f6e\u3002 \u6267\u884cVBA\u4ee3\u7801\u8d85\u65f6 \u00b6 \u8fd9\u4e00\u822c\u662f\u56e0\u4e3aVBA\u4ee3\u7801\u4e2d\u5b58\u5728\u9519\u8bef\u3002\u56e0\u4e3a\u672c\u6587\u7684\u81ea\u52a8\u5316\u8fc7\u7a0b\u662f\u7531Python\u9a71\u52a8\u7684\uff0c\u4e00\u65e6VBA\u4ee3\u7801\u51fa\u9519\u800c\u88ab\u6302\u8d77\uff0cPython\u5c31\u65e0\u6cd5\u5f97\u5230\u54cd\u5e94\u4e86\u3002 \u9488\u5bf9\u672c\u6587\u5e94\u7528\u573a\u666f\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5728VBA\u6d4b\u8bd5\u4ee3\u7801\u7684\u5f00\u5934\u52a0\u4e0a\u4e00\u53e5 On Error Resume Nest \uff0c\u5373\u5ffd\u7565VBA\u4ee3\u7801\u4e2d\u7684\u9519\u8bef\uff0c\u4ee5\u4fbfPython\u53ef\u4ee5\u6b63\u5e38\u6267\u884c\u540e\u7eed\u6d41\u7a0b\u3002\u5e76\u4e14\u65e0\u9700\u62c5\u5fc3\u6b64\u4e3e\u9020\u6210\u7684\u9519\u8bef\uff0cVBA\u4ee3\u7801\u5b58\u5728\u9519\u8bef\u5fc5\u5c06\u5bfc\u81f4\u540e\u7eed\u9a8c\u8bc1\u8f93\u51fa\u7684\u5931\u8d25\uff0c\u4e5f\u5c31\u8868\u660e\u4e86\u8fd9\u4e2a\u6d4b\u8bd5\u6848\u4f8b\u5fc5\u5c06\u5931\u8d25\u3002 \u65e0\u6cd5\u6b63\u786e\u52a0\u8f7dVBA\u4e2d\u8c03\u7528\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93 \u00b6 VBA\u4ee3\u7801\u4e2d\u76f4\u63a5\u901a\u8fc7\u6587\u4ef6\u540d\u5f15\u7528DLL\uff0c\u800cDLL\u6240\u5728\u8def\u5f84\u5df2\u7ecf\u6dfb\u52a0\u5230\u4e86 PATH \u73af\u5883\u53d8\u91cf\u4e2d\u3002\u7531\u6b64\u770b\u6765\uff0c\u4ee5\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u542f\u52a8\u7684Excel\u5e76\u4e0d\u80fd\u6b63\u786e\u83b7\u53d6\u5230\u73af\u5883\u53d8\u91cf\u3002 Declare Function xxx Lib \"sample_dll_name.dll\" ( arguments_list_xxx ) As xxx \u89e3\u51b3\u65b9\u6cd5\u4e3a\u901a\u8fc7 DCOMConfig \u8bbe\u7f6e\u542f\u52a8Excel\u7684\u7528\u6237 3 4 \uff1a Windows+R -> dcomcnfg \uff0c\u6253\u5f00 Component Service Console Root -> Component Services -> My Computer -> DCOM Config \u4ece DCOM Config \u4e2d\u627e\u5230 Microsoft Excel Application \uff0c\u53f3\u952e\u9009\u62e9 Properties \u9009\u62e9 Identity \u9009\u9879\u5361\uff0c\u9009\u62e9 the launching user \uff0c\u8868\u793a\u4ee5\u767b\u9646\u7528\u6237\u6765\u542f\u52a8Excel\uff08\u8fd9\u91cc\u53ef\u80fd\u4f1a\u51fa\u73b0\u65b0\u7684\u95ee\u9898\uff0c\u53c2\u89c1\u95ee\u98985\uff09 \u9009\u62e9 Security \u9009\u9879\u5361\uff0c\u4e3a\u6307\u5b9a\u7684\u8d26\u6237\u81ea\u5b9a\u4e49 Launch and Activation Permissions \u548c Access Permissions \u5982\u679c\u4e0a\u8ff0 DCOM Config \u5217\u8868\u4e2d\u5e76\u4e0d\u5b58\u5728 Microsoft Excel Application \uff0c\u5219\u53c2\u8003\u4e0b\u9762\u6b65\u9aa4 4 \u3002 \u4ee564\u4f4dWindows\u7cfb\u7edf\u4e0a\u768432\u4f4dExcel\u4e3a\u4f8b\uff0c Windows+R -> mmc -32 \u6253\u5f00 Microsoft Managemant Console File -> Add Remove Snap-in -> Component Services -> Add -> OK \u6dfb\u52a0 Component Services \u6309 DCOMConfig \u6b65\u9aa42\uff0c3\u8fdb\u884c\u8bbe\u7f6e The configured identity is incorrect \u00b6 (-2147467238, 'The server process could not be started because the configured identity is incorrect. Check the username and password.', None, None) \u5230\u76ee\u524d\u4e3a\u6b62\u4e00\u5207\u6b63\u5e38\uff0c\u53ef\u4e00\u65e6\u670d\u52a1\u5668\u8fdb\u5165\u5f85\u673a\u72b6\u6001\uff0c\u5c31\u51fa\u73b0\u4e86\u4e0a\u8ff0\u9519\u8bef\u3002\u539f\u56e0\u4e5f\u5f88\u660e\u786e\uff0c\u56e0\u4e3a\u4e4b\u524d\u95ee\u9898\u65f6\u8bbe\u7f6e\u4e86\u4ee5\u5f53\u524d\u8d26\u6237\u6765\u8fd0\u884cExcel\uff0c\u4e8e\u662f\u5f53\u524d\u7528\u6237\u9000\u51fa\u65f6\u7cfb\u7edf\u5c1d\u8bd5\u518d\u6b21\u767b\u9646\uff0c\u4f46\u6211\u4eec\u5e76\u6ca1\u6709\u8bbe\u7f6e\u4efb\u4f55\u767b\u9646\u53e3\u4ee4\u3002 \u89e3\u51b3\u65b9\u6cd5\u4e3a DCOMConfig \u8bbe\u7f6e Identity \u4e3a The launching user \u6216\u8005 This User \uff0c\u7136\u540e\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\uff08\u6ce8\u610f\u57df\u5185\u7528\u6237\u9700\u8981\u5e26\u4e0a\u57df\u540d\u79f0\uff0c\u4f8b\u5982 domain\\user \uff09 5 \u3002 Module has no attribute 'CLSIDToClassMap' \u00b6 module 'win32com.gen_py.00020813-0000-0000-C000-000000000046x0x1x7' has no attribute 'CLSIDToClassMap' \u8fd9\u662f win32com \u4ee5 EnsureDispatch() \u65b9\u5f0f\u542f\u52a8Excel\u4f1a\u4ea7\u751f\u4e34\u65f6\u6587\u4ef6\u5939\uff0c\u51fa\u73b0\u6b64\u95ee\u9898\u540e\u53ea\u8981\u5220\u9664\u76f8\u5e94\u6587\u4ef6\u5939\u5373\u53ef\uff0c\u5373\u672c\u4f8b\u4e2d\u7684 00020813-0000-0000-C000-000000000046x0x1x7 \u3002 import win32com.client app = win32com.client.gencache.EnsureDispatch('Excel.Application') \u90a3\u4e48\u5982\u4f55\u627e\u5230\u8be5\u76ee\u5f55\u5462\uff1f\u5982\u4e0b\u4ee3\u7801\u5c06\u6253\u5370\u76ee\u6807\u4f4d\u7f6e 6 \uff1a import win32com print(win32com.__gen_path__) \u5bf9\u4e8e\u672c\u5730\u8d26\u6237\u6267\u884c\u7684\u4ee3\u7801\uff1a C:\\Users\\<my username>\\AppData\\Local\\Temp\\gen_py \u5bf9\u4e8e\u7cfb\u7edf\u670d\u52a1\u6267\u884c\u7684\u4ee3\u7801\uff1a C:\\Windows\\Temp\\gen_py \u6ce8\u610f \u5982\u679c GitLab-runner \u662f\u7cfb\u7edf\u670d\u52a1\u4ee5\u672c\u5730\u8d26\u6237\u5f62\u5f0f\u8fd0\u884c\u7684\uff0c\u5219\u540c\u6837\u5bf9\u5e94\u672c\u5730\u8d26\u6237\u76ee\u5f55\u800c\u975e\u7cfb\u7edf\u76ee\u5f55\u3002 This COM object can not automate the makepy process - please run makepy manually for this object \u00b6 \u4e0e\u4e0a\u4e00\u4e2a\u95ee\u9898\u5220\u9664\u7f13\u5b58\u7684\u505a\u6cd5\u76f8\u53cd\uff0c\u8fd9\u4e2a\u9519\u8bef\u8868\u660e\u65e0\u6cd5\u81ea\u52a8\u4ea7\u751f gen_py \u6587\u4ef6\u5939\uff0c\u800c\u8fd9\u6b63\u662f win32com \u4ee5 EnsureDispatch() \u65b9\u5f0f\u542f\u52a8Excel\u6240\u5fc5\u987b\u7684\u3002\u6240\u4ee5\u6309\u7167\u63d0\u793a\uff0c\u624b\u52a8\u8fd0\u884c makepy.py \u5373\u53ef\u3002 \u5728 Lib\\site-packages\\win32com\\client \u76ee\u5f55\u4e0b\u6267\u884c python makepy.py -d \u5728\u5f39\u51fa\u7684 select library \u5bf9\u8bdd\u6846\u4e2d\u9009\u62e9Excel\u76f8\u5173\u7684\u9879\u76ee\u5373\u53ef\uff0c\u4f8b\u5982 Microsoft Excel 16.0 Object Library (1.9) \u7528\u6237 Temp \u6587\u4ef6\u5939\u4e0b\u5373\u53ef\u4ea7\u751f gen_py \u6587\u4ef6\u5939 Cannot use object linking and embedding \u00b6 \u5728\u6b63\u5e38\u5de5\u4f5c\u4e86\u51e0\u5929\u540e\uff0c\u7a81\u7136\u51fa\u73b0\u4e86\u6b64\u95ee\u9898\uff0c\u5177\u4f53\u539f\u56e0\u5c1a\u4e0d\u660e\u786e\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u662f\u672c\u5730\u8d26\u6237\u6253\u5f00Excel\u65f6\u7684\u9519\u8bef\u63d0\u793a\uff0c\u5728 GitLab-Runner \u4e0a\u6267\u884cExcel\u81ea\u52a8\u5316\u811a\u672c\u65f6\u8868\u73b0\u4e3a\u5931\u53bb\u54cd\u5e94\u76f4\u81f3\u8d85\u65f6\uff0c\u5373\u5361\u5728\u6253\u5f00Excel\u5de5\u4f5c\u7c3f\u4e0a\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a \u901a\u8fc7 DCOMConfig \u8bbe\u7f6e\u7cfb\u7edf\u767b\u9646 Identity \u4e3a The launching user 7 \u540c\u65f6\u4e3a GitLab-Runner \u8bbe\u7f6e\u767b\u9646\u8d26\u6237\uff1a\u5c06\u5176\u4ece\u9ed8\u8ba4\u7684 Local System \u5207\u6362\u5230 This account \uff0c\u7136\u540e\u8bbe\u7f6e domain\\user \u53ca\u5176\u767b\u9646\u5bc6\u7801\u3002 Windows+R -> services.msc -> gitlab-runner -> properties Log On -> This account -> \u586b\u5199 Password \u548c Confirm Password \u53e6\u5916\uff0cMSDN\u4e0a\u4e5f\u6709\u4eba\u7ed9\u51fa\u4e86\u4fdd\u6301 DCOMConfig \u4e2d This account \u4e0d\u53d8\u800c\u4fee\u6539\u672c\u5730Excel\u6587\u4ef6 Security \u5c5e\u6027\u7684\u89e3\u51b3\u65b9\u6cd5 8 \uff0c\u672c\u6587\u5c1a\u672a\u662f\u6d4b\u8bd5\u3002 excel access denied with win32 python pywin32 \u21a9 Microsoft Project \u2013 how to control Macro Settings using registry keys \u21a9 How to configure Office applications for automation from a COM+/MTS package \u21a9 Running excel from a windows service \u21a9 \u21a9 Excel COM automation via interactive user stops working when user logs off \u21a9 python-win32com excel com model started generating errors \u21a9 Cannot use object linking and embedding - EXCEL 2007 - DCOM \u21a9 Cannot use object linking and embedding Excel 2007 \u21a9","title":"\u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#windowsexcel","text":"\u53d1\u5e03\u4e8e\uff1a2019-09-14 | \u5206\u7c7b\uff1a process automation \u53c2\u8003\u524d\u6587\u5173\u4e8e win32com \u6a21\u5757\u7684\u793a\u4f8b\u4ee3\u7801\u53ef\u4ee5\u8fdb\u884cExcel\u7684\u81ea\u52a8\u5316\u64cd\u4f5c\uff0c\u4f8b\u5982Excel VBA\u7684\u81ea\u52a8\u5316\u6d4b\u8bd5\uff1b\u5c06\u5176\u4f5c\u4e3aWindows\u670d\u52a1\u8fd0\u884c\uff0c\u5219\u53ef\u4ee5\u65b9\u4fbf\u4e3a\u7f51\u7edc\u4e2d\u7684\u5176\u4ed6\u673a\u5668\u8c03\u7528\u3002\u672c\u6587\u6b63\u662f\u8bb0\u5f55\u914d\u7f6eExcel\u81ea\u52a8\u5316\u670d\u52a1\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u4e0e\u76f8\u5e94\u89e3\u51b3\u63aa\u65bd\u3002","title":"\u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#_1","text":"\u6700\u8fd1\u6709\u4e2a\u9700\u6c42\u662f\u5bf9\u542f\u7528\u5b8f\u7684Excel 2010\u6587\u4ef6\u7684\u81ea\u52a8\u5316\u6d4b\u8bd5\uff0c\u9700\u8981\u914d\u7f6e\u5728\u670d\u52a1\u5668\u4e0a\u4ee5\u4f9b GitLab-Runner \u8c03\u7528\u3002\u4e8e\u662f\uff0c\u6309\u7167\u8bfb\u5165\u6d4b\u8bd5\u6570\u636e\u3001\u6267\u884c\u6d4b\u8bd5VBA\u3001\u9a8c\u8bc1\u8ba1\u7b97\u7ed3\u679c\u7684\u903b\u8f91\u5199\u597dPython\u811a\u672c\uff0c\u8c03\u8bd5\u901a\u8fc7\u540e\u5728\u672c\u5730\u8fd0\u884c\u4e00\u5207\u6b63\u5e38\u3002\u7136\u800c\uff0c\u901a\u8fc7Commit\u63d0\u4ea4\u89e6\u53d1CI/CD\u6d41\u7a0b\uff0c\u5373 GitLab-Runner \u4ee5Windows\u670d\u52a1\u7684\u65b9\u5f0f\u6267\u884c\u76f8\u540c\u7684\u811a\u672c\u65f6\uff0c\u5374\u51fa\u73b0\u4e86\u5404\u79cd\u5404\u6837\u7684\u95ee\u9898\u3002 \u6839\u672c\u539f\u56e0\u663e\u7136\u662f \u672c\u5730\u8d26\u6237 \u548c \u7cfb\u7edf\u670d\u52a1 \u6267\u884cExcel\u81ea\u52a8\u5316\u64cd\u4f5c\u4e0a\u7684\u5dee\u5f02\uff0c\u4ee5\u4e0b\u9010\u4e00\u8bb0\u5f55\u9047\u5230\u7684\u95ee\u9898\u3002\u9664\u4e86\u90e8\u5206\u4e0ePython\u76f8\u5173\u7684\u95ee\u9898\u5916\uff0c\u5176\u4f59\u5e94\u8be5\u5177\u5907\u901a\u7528\u6027\uff0c\u53ef\u4f5c\u4e3aWindows\u670d\u52a1\u65b9\u5f0f\u6267\u884cExcel\u3001Word\u3001Outlook\u7b49\u81ea\u52a8\u5316\u7a0b\u5e8f\u51fa\u73b0\u95ee\u9898\u65f6\u7684\u53c2\u8003\u3002 \u6ce8\u610f \u5f53\u524d\u767b\u9646\u8d26\u6237\u5e94\u5177\u5907\u7ba1\u7406\u5458\u6743\u9650\u3002","title":"\u6982\u8ff0"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#open method of workbooks class failed","text":"(-2147352567, 'Exception occurred.', (0, 'Microsoft Excel', 'Open method of Workbooks class failed', 'xlmain11.chm', 0, -2146827284), None) \u5728Stackoverflow\u641c\u7d22\u5230\u4e86\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5 1 \uff0c\u6839\u636eWindows\u4f4d\u6570\u5728\u76ee\u6807\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a Desktop \u6587\u4ef6\u5939\uff1a 64\u4f4d\u7cfb\u7edf\uff1a C:\\Windows\\SysWOW64\\config\\systemprofile\\ 32\u4f4d\u7cfb\u7edf\uff1a C:\\Windows\\System32\\config\\systemprofile\\ \u867d\u7136\u6682\u65f6\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u5374\u4e5f\u4e0d\u77e5\u662f\u4f55\u7f18\u7531\u3002\u7ecf\u5386\u540e\u7eed\u95ee\u9898\u624d\u660e\u767d\uff1aExcel\u9700\u8981\u6709 Interactive User \u767b\u9646\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u4e0a\u9762\u7684\u6b65\u9aa4\u6b63\u662f\u4e3a\u5176\u63d0\u4f9b\u4e86\u7528\u6237\u201c\u684c\u9762\u201d\uff1b\u7136\u800c\u4e00\u65e6\u9700\u8981\u66f4\u591a\u7528\u6237\u8d26\u6237\u76f8\u5173\u7684\u8bbe\u7f6e\u65f6\uff0c\u5c31\u4f1a\u6709\u65b0\u7684\u95ee\u9898\u51fa\u73b0\u4e86\u3002","title":"Open method of Workbooks class failed"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#programmatic access to visual basic project is not trusted","text":"(-2147352567, 'Exception occurred.', (0, 'Microsoft Excel', 'Programmatic access to Visual Basic Project is not trusted\\n', 'xlmain11.chm', 0, -2146827284), None) \u8fd9\u4e2a\u95ee\u9898\u5f88\u660e\u663e\uff0c\u4e00\u65e6\u4ee3\u7801\u9700\u8981\u8bbf\u95eeVBA\u5de5\u7a0b\u5bf9\u8c61\uff0c\u4f8b\u5982\u8bbf\u95ee module \u5bf9\u8c61\u3001Python\u52a8\u6001\u6267\u884cVBA\u4ee3\u7801\uff0c\u5219\u9700\u8981\u76f8\u5e94\u7684\u8bb8\u53ef\uff08Excel\u8f6f\u4ef6\u4fe1\u4efb\u533a\u8bbe\u7f6e\u4e2d\u6709\u8be5\u9009\u9879\uff09\u3002 \u89e3\u51b3\u65b9\u6cd5\u53ef\u4ee5\u662f\u5229\u7528Python\u52a8\u6001\u4fee\u6539\u76f8\u5e94\u6ce8\u518c\u8868\u9879\u548c\u503c\u6765\u5141\u8bb8\u8bbf\u95eeVB\u5de5\u7a0b\uff0c\u6216\u8005\u53c2\u8003 2 \u624b\u5de5\u6c38\u4e45\u8bbe\u7f6e\u3002","title":"Programmatic access to Visual Basic Project is not trusted"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#vba","text":"\u8fd9\u4e00\u822c\u662f\u56e0\u4e3aVBA\u4ee3\u7801\u4e2d\u5b58\u5728\u9519\u8bef\u3002\u56e0\u4e3a\u672c\u6587\u7684\u81ea\u52a8\u5316\u8fc7\u7a0b\u662f\u7531Python\u9a71\u52a8\u7684\uff0c\u4e00\u65e6VBA\u4ee3\u7801\u51fa\u9519\u800c\u88ab\u6302\u8d77\uff0cPython\u5c31\u65e0\u6cd5\u5f97\u5230\u54cd\u5e94\u4e86\u3002 \u9488\u5bf9\u672c\u6587\u5e94\u7528\u573a\u666f\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5728VBA\u6d4b\u8bd5\u4ee3\u7801\u7684\u5f00\u5934\u52a0\u4e0a\u4e00\u53e5 On Error Resume Nest \uff0c\u5373\u5ffd\u7565VBA\u4ee3\u7801\u4e2d\u7684\u9519\u8bef\uff0c\u4ee5\u4fbfPython\u53ef\u4ee5\u6b63\u5e38\u6267\u884c\u540e\u7eed\u6d41\u7a0b\u3002\u5e76\u4e14\u65e0\u9700\u62c5\u5fc3\u6b64\u4e3e\u9020\u6210\u7684\u9519\u8bef\uff0cVBA\u4ee3\u7801\u5b58\u5728\u9519\u8bef\u5fc5\u5c06\u5bfc\u81f4\u540e\u7eed\u9a8c\u8bc1\u8f93\u51fa\u7684\u5931\u8d25\uff0c\u4e5f\u5c31\u8868\u660e\u4e86\u8fd9\u4e2a\u6d4b\u8bd5\u6848\u4f8b\u5fc5\u5c06\u5931\u8d25\u3002","title":"\u6267\u884cVBA\u4ee3\u7801\u8d85\u65f6"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#vbac","text":"VBA\u4ee3\u7801\u4e2d\u76f4\u63a5\u901a\u8fc7\u6587\u4ef6\u540d\u5f15\u7528DLL\uff0c\u800cDLL\u6240\u5728\u8def\u5f84\u5df2\u7ecf\u6dfb\u52a0\u5230\u4e86 PATH \u73af\u5883\u53d8\u91cf\u4e2d\u3002\u7531\u6b64\u770b\u6765\uff0c\u4ee5\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u542f\u52a8\u7684Excel\u5e76\u4e0d\u80fd\u6b63\u786e\u83b7\u53d6\u5230\u73af\u5883\u53d8\u91cf\u3002 Declare Function xxx Lib \"sample_dll_name.dll\" ( arguments_list_xxx ) As xxx \u89e3\u51b3\u65b9\u6cd5\u4e3a\u901a\u8fc7 DCOMConfig \u8bbe\u7f6e\u542f\u52a8Excel\u7684\u7528\u6237 3 4 \uff1a Windows+R -> dcomcnfg \uff0c\u6253\u5f00 Component Service Console Root -> Component Services -> My Computer -> DCOM Config \u4ece DCOM Config \u4e2d\u627e\u5230 Microsoft Excel Application \uff0c\u53f3\u952e\u9009\u62e9 Properties \u9009\u62e9 Identity \u9009\u9879\u5361\uff0c\u9009\u62e9 the launching user \uff0c\u8868\u793a\u4ee5\u767b\u9646\u7528\u6237\u6765\u542f\u52a8Excel\uff08\u8fd9\u91cc\u53ef\u80fd\u4f1a\u51fa\u73b0\u65b0\u7684\u95ee\u9898\uff0c\u53c2\u89c1\u95ee\u98985\uff09 \u9009\u62e9 Security \u9009\u9879\u5361\uff0c\u4e3a\u6307\u5b9a\u7684\u8d26\u6237\u81ea\u5b9a\u4e49 Launch and Activation Permissions \u548c Access Permissions \u5982\u679c\u4e0a\u8ff0 DCOM Config \u5217\u8868\u4e2d\u5e76\u4e0d\u5b58\u5728 Microsoft Excel Application \uff0c\u5219\u53c2\u8003\u4e0b\u9762\u6b65\u9aa4 4 \u3002 \u4ee564\u4f4dWindows\u7cfb\u7edf\u4e0a\u768432\u4f4dExcel\u4e3a\u4f8b\uff0c Windows+R -> mmc -32 \u6253\u5f00 Microsoft Managemant Console File -> Add Remove Snap-in -> Component Services -> Add -> OK \u6dfb\u52a0 Component Services \u6309 DCOMConfig \u6b65\u9aa42\uff0c3\u8fdb\u884c\u8bbe\u7f6e","title":"\u65e0\u6cd5\u6b63\u786e\u52a0\u8f7dVBA\u4e2d\u8c03\u7528\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#the configured identity is incorrect","text":"(-2147467238, 'The server process could not be started because the configured identity is incorrect. Check the username and password.', None, None) \u5230\u76ee\u524d\u4e3a\u6b62\u4e00\u5207\u6b63\u5e38\uff0c\u53ef\u4e00\u65e6\u670d\u52a1\u5668\u8fdb\u5165\u5f85\u673a\u72b6\u6001\uff0c\u5c31\u51fa\u73b0\u4e86\u4e0a\u8ff0\u9519\u8bef\u3002\u539f\u56e0\u4e5f\u5f88\u660e\u786e\uff0c\u56e0\u4e3a\u4e4b\u524d\u95ee\u9898\u65f6\u8bbe\u7f6e\u4e86\u4ee5\u5f53\u524d\u8d26\u6237\u6765\u8fd0\u884cExcel\uff0c\u4e8e\u662f\u5f53\u524d\u7528\u6237\u9000\u51fa\u65f6\u7cfb\u7edf\u5c1d\u8bd5\u518d\u6b21\u767b\u9646\uff0c\u4f46\u6211\u4eec\u5e76\u6ca1\u6709\u8bbe\u7f6e\u4efb\u4f55\u767b\u9646\u53e3\u4ee4\u3002 \u89e3\u51b3\u65b9\u6cd5\u4e3a DCOMConfig \u8bbe\u7f6e Identity \u4e3a The launching user \u6216\u8005 This User \uff0c\u7136\u540e\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\uff08\u6ce8\u610f\u57df\u5185\u7528\u6237\u9700\u8981\u5e26\u4e0a\u57df\u540d\u79f0\uff0c\u4f8b\u5982 domain\\user \uff09 5 \u3002","title":"The configured identity is incorrect"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#module has no attribute clsidtoclassmap","text":"module 'win32com.gen_py.00020813-0000-0000-C000-000000000046x0x1x7' has no attribute 'CLSIDToClassMap' \u8fd9\u662f win32com \u4ee5 EnsureDispatch() \u65b9\u5f0f\u542f\u52a8Excel\u4f1a\u4ea7\u751f\u4e34\u65f6\u6587\u4ef6\u5939\uff0c\u51fa\u73b0\u6b64\u95ee\u9898\u540e\u53ea\u8981\u5220\u9664\u76f8\u5e94\u6587\u4ef6\u5939\u5373\u53ef\uff0c\u5373\u672c\u4f8b\u4e2d\u7684 00020813-0000-0000-C000-000000000046x0x1x7 \u3002 import win32com.client app = win32com.client.gencache.EnsureDispatch('Excel.Application') \u90a3\u4e48\u5982\u4f55\u627e\u5230\u8be5\u76ee\u5f55\u5462\uff1f\u5982\u4e0b\u4ee3\u7801\u5c06\u6253\u5370\u76ee\u6807\u4f4d\u7f6e 6 \uff1a import win32com print(win32com.__gen_path__) \u5bf9\u4e8e\u672c\u5730\u8d26\u6237\u6267\u884c\u7684\u4ee3\u7801\uff1a C:\\Users\\<my username>\\AppData\\Local\\Temp\\gen_py \u5bf9\u4e8e\u7cfb\u7edf\u670d\u52a1\u6267\u884c\u7684\u4ee3\u7801\uff1a C:\\Windows\\Temp\\gen_py \u6ce8\u610f \u5982\u679c GitLab-runner \u662f\u7cfb\u7edf\u670d\u52a1\u4ee5\u672c\u5730\u8d26\u6237\u5f62\u5f0f\u8fd0\u884c\u7684\uff0c\u5219\u540c\u6837\u5bf9\u5e94\u672c\u5730\u8d26\u6237\u76ee\u5f55\u800c\u975e\u7cfb\u7edf\u76ee\u5f55\u3002","title":"Module has no attribute 'CLSIDToClassMap'"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#this com object can not automate the makepy process - please run makepy manually for this object","text":"\u4e0e\u4e0a\u4e00\u4e2a\u95ee\u9898\u5220\u9664\u7f13\u5b58\u7684\u505a\u6cd5\u76f8\u53cd\uff0c\u8fd9\u4e2a\u9519\u8bef\u8868\u660e\u65e0\u6cd5\u81ea\u52a8\u4ea7\u751f gen_py \u6587\u4ef6\u5939\uff0c\u800c\u8fd9\u6b63\u662f win32com \u4ee5 EnsureDispatch() \u65b9\u5f0f\u542f\u52a8Excel\u6240\u5fc5\u987b\u7684\u3002\u6240\u4ee5\u6309\u7167\u63d0\u793a\uff0c\u624b\u52a8\u8fd0\u884c makepy.py \u5373\u53ef\u3002 \u5728 Lib\\site-packages\\win32com\\client \u76ee\u5f55\u4e0b\u6267\u884c python makepy.py -d \u5728\u5f39\u51fa\u7684 select library \u5bf9\u8bdd\u6846\u4e2d\u9009\u62e9Excel\u76f8\u5173\u7684\u9879\u76ee\u5373\u53ef\uff0c\u4f8b\u5982 Microsoft Excel 16.0 Object Library (1.9) \u7528\u6237 Temp \u6587\u4ef6\u5939\u4e0b\u5373\u53ef\u4ea7\u751f gen_py \u6587\u4ef6\u5939","title":"This COM object can not automate the makepy process - please run makepy manually for this object"},{"location":"2019-09-14-%E4%BB%A5Windows%E6%9C%8D%E5%8A%A1%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8CExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E7%A8%8B%E5%BA%8F%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#cannot use object linking and embedding","text":"\u5728\u6b63\u5e38\u5de5\u4f5c\u4e86\u51e0\u5929\u540e\uff0c\u7a81\u7136\u51fa\u73b0\u4e86\u6b64\u95ee\u9898\uff0c\u5177\u4f53\u539f\u56e0\u5c1a\u4e0d\u660e\u786e\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u662f\u672c\u5730\u8d26\u6237\u6253\u5f00Excel\u65f6\u7684\u9519\u8bef\u63d0\u793a\uff0c\u5728 GitLab-Runner \u4e0a\u6267\u884cExcel\u81ea\u52a8\u5316\u811a\u672c\u65f6\u8868\u73b0\u4e3a\u5931\u53bb\u54cd\u5e94\u76f4\u81f3\u8d85\u65f6\uff0c\u5373\u5361\u5728\u6253\u5f00Excel\u5de5\u4f5c\u7c3f\u4e0a\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a \u901a\u8fc7 DCOMConfig \u8bbe\u7f6e\u7cfb\u7edf\u767b\u9646 Identity \u4e3a The launching user 7 \u540c\u65f6\u4e3a GitLab-Runner \u8bbe\u7f6e\u767b\u9646\u8d26\u6237\uff1a\u5c06\u5176\u4ece\u9ed8\u8ba4\u7684 Local System \u5207\u6362\u5230 This account \uff0c\u7136\u540e\u8bbe\u7f6e domain\\user \u53ca\u5176\u767b\u9646\u5bc6\u7801\u3002 Windows+R -> services.msc -> gitlab-runner -> properties Log On -> This account -> \u586b\u5199 Password \u548c Confirm Password \u53e6\u5916\uff0cMSDN\u4e0a\u4e5f\u6709\u4eba\u7ed9\u51fa\u4e86\u4fdd\u6301 DCOMConfig \u4e2d This account \u4e0d\u53d8\u800c\u4fee\u6539\u672c\u5730Excel\u6587\u4ef6 Security \u5c5e\u6027\u7684\u89e3\u51b3\u65b9\u6cd5 8 \uff0c\u672c\u6587\u5c1a\u672a\u662f\u6d4b\u8bd5\u3002 excel access denied with win32 python pywin32 \u21a9 Microsoft Project \u2013 how to control Macro Settings using registry keys \u21a9 How to configure Office applications for automation from a COM+/MTS package \u21a9 Running excel from a windows service \u21a9 \u21a9 Excel COM automation via interactive user stops working when user logs off \u21a9 python-win32com excel com model started generating errors \u21a9 Cannot use object linking and embedding - EXCEL 2007 - DCOM \u21a9 Cannot use object linking and embedding Excel 2007 \u21a9","title":"Cannot use object linking and embedding"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/","text":"Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898 \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-10-01 | \u5206\u7c7b\uff1a numeric calculation \u6570\u6708\u524d\u5076\u9047\u4e00\u9053\u81ea\u884c\u8f66\u76f8\u5173\u7684\u8da3\u5473\u6570\u5b66\u9898\uff1a\u6839\u636e\u4e0b\u56fe 1 \u6240\u793a\u81ea\u884c\u8f66\u524d\u3001\u540e\u8f6e\u8f68\u8ff9\uff0c\u5224\u65ad\u81ea\u884c\u8f66\u7684\u524d\u8fdb\u65b9\u5411\uff0c\u662f\u4ece\u5de6\u5f80\u53f3\u8fd8\u662f\u4ece\u53f3\u5f80\u5de6\uff1f \u4e0d\u66fe\u60f3\u8fc7\uff0c\u5e73\u5e38\u65e0\u5947\u7684\u81ea\u884c\u8f66\u7684\u4e24\u8f6e\u4e4b\u95f4\u8fd8\u8574\u85cf\u7740\u6052\u5b9a\u7684\u89c4\u5f8b\u3002 \u5728\u8d5e\u53f9\u7b54\u6848\u601d\u8def\u6e05\u5947\u4e4b\u4f59\uff0c\u4e5f\u840c\u751f\u4e86\u57fa\u4e8e\u524d\u8f6e\u8f68\u8ff9\u6c42\u89e3\u540e\u8f6e\u8f68\u8ff9\u7684\u60f3\u6cd5\u3002\u672c\u6587\u9996\u5148\u5efa\u7acb\u81ea\u884c\u8f66\u8f68\u8ff9\u95ee\u9898\u7684\u6570\u5b66\u6a21\u578b\uff08\u5e38\u5fae\u5206\u65b9\u7a0b\uff09\uff0c\u7136\u540e\u5229\u7528Python\u7684 scipy.odeint \u8fdb\u884c\u6c42\u89e3\uff0c\u6700\u540e\u5bf9\u95ee\u9898\u7684\u89e3\u8fdb\u884c\u53ef\u89c6\u5316\u3002 \u6570\u5b66\u6a21\u578b \u00b6 \u6587\u7ae0\u5f00\u5934\u7684\u95ee\u9898\u6700\u65e9\u51fa\u81ea\u300aWhich Way did the Bicycle Go? \u2026 and Other Intriguing Mathematical Mysteries\u300b\u4e00\u4e66\uff0c\u5c01\u9762\u7528\u7684\u5373\u662f\u8fd9\u9053\u770b\u4f3c\u65e0\u6cd5\u6c42\u89e3\u7684\u95ee\u9898\u3002\u798f\u5c14\u6469\u65af\u63a2\u6848\u96c6\u7cfb\u5217\u4e2d\u4e5f\u8bbe\u8ba1\u4e86\u7c7b\u4f3c\u7684\u6848\u4ef6\uff0c\u53ef\u60dc\u7ed9\u51fa\u7684\u5374\u4e0d\u662f\u6b63\u786e\u7684\u89e3\u91ca\u3002 \u8fd9\u5176\u5b9e\u662f\u4e00\u9053\u7cbe\u5f69\u7684\u51e0\u4f55\u95ee\u9898\u3002\u8003\u8651\u4e00\u4e0b\u81ea\u884c\u8f66\u7684\u7ed3\u6784\u548c\u8fd0\u52a8\u7279\u70b9\uff1a\u524d\u8f6e\u53ef\u4ee5\u81ea\u7531\u63a7\u5236\u884c\u8fdb\u65b9\u5411\uff0c\u800c\u540e\u8f6e\u56e0\u4e3a\u710a\u6b7b\u5728\u8f66\u67b6\u4e0a\u800c\u53ea\u80fd\u6cbf\u7740\u8f66\u8eab\u65b9\u5411\u884c\u8fdb\u3002\u56e0\u6b64\uff0c\u540e\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u4e0a\u4efb\u4e00\u70b9\u7684\u5207\u7ebf\u65b9\u5411\u5373\u4e3a\u8f66\u8eab\u65b9\u5411\uff0c\u5e76\u4e14\u8be5\u65b9\u5411\u4e0e\u524d\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u7684\u4ea4\u70b9\u5373\u4e3a\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f6e\u6bc2\u4e2d\u5fc3\u7684\u8ddd\u79bb\uff0c\u800c\u8fd9\u4fdd\u6301\u4e00\u4e2a\u5b9a\u957f\uff08\u8f66\u8eab\u957f\u5ea6\uff09\u3002\u7528\u6570\u5b66\u8bed\u8a00\u63cf\u8ff0\u4e3a\uff1a \u4f5c\u540e\u8f6e\u66f2\u7ebf\u4e0a\u4efb\u4e00\u70b9 P \u7684\u5207\u7ebf\uff0c\u5f97\u5230\u4e0e\u524d\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u7684\u4ea4\u70b9 Q \uff0c\u5219\u7ebf\u6bb5 PQ \u4fdd\u6301\u5b9a\u957f \u3002 \u6240\u4ee5\u89e3\u9898\u65b9\u6cd5\u4e3a\uff0c\u5206\u522b\u5047\u8bbe\u524d\u540e\u8f6e\u8f68\u8ff9\uff0c\u7136\u540e\u6309\u7167\u4e0a\u8ff0\u7ed3\u8bba\u8fdb\u884c\u9a8c\u8bc1\u3002\u672c\u9898\u7b54\u6848\u4e3a\u81ea\u884c\u8f66\u4ece\u5de6\u5411\u53f3\u884c\u9a76\uff0c\u5177\u4f53\u53c2\u8003\u4e0b\u56fe\uff1a \u5f00\u7bc7\u7684\u95ee\u9898\u89e3\u51b3\u4e86\uff0c\u63a5\u4e0b\u6765\u8fdb\u5165\u6b63\u9898\uff1a\u5df2\u77e5\u4efb\u610f\u7ed9\u5b9a\u7684\u524d\u8f6e\u8f68\u8ff9\uff0c\u5982\u4f55\u6c42\u89e3\u76f8\u5e94\u7684\u540e\u8f6e\u8f68\u8ff9\uff1f\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u7528\u53c2\u6570\u65b9\u7a0b\u6765\u63cf\u8ff0\u66f2\u7ebf\u4e0a\u4efb\u4e00\u70b9\u7684\u5750\u6807 (x,y) (x,y) \uff0c\u4f8b\u5982\u5df2\u77e5\u524d\u8f6e\u8f68\u8ff9 x=\\alpha(t), y=\\beta(t) x=\\alpha(t), y=\\beta(t) \uff0c\u6c42\u89e3\u540e\u8f6e\u8f68\u8ff9 x=x(t), y=y(t) x=x(t), y=y(t) \u3002 \u7531\u5b9a\u957f\u6761\u4ef6 \\|\\overrightarrow{PQ}\\|=L \\|\\overrightarrow{PQ}\\|=L \u5f97\u5230\uff1a \\begin{equation*} (x-\\alpha)^2 + (y-\\beta)^2 = L^2 \\end{equation*} \u4e0a\u5f0f\u5bf9\u53c2\u6570 t t \u6c42\u5bfc\uff1a \\begin{equation*} (x-\\alpha)*(x'-\\alpha')+(y-\\beta)(y'-\\beta')=0 \\end{equation*} \u53e6\u4e00\u65b9\u9762\uff0c\u7531 \\overrightarrow{PQ}//\\overrightarrow{\\tau} \\overrightarrow{PQ}//\\overrightarrow{\\tau} \u5f97\u5230\uff1a \\begin{equation*} \\frac{y'}{x'}=\\frac{y-\\beta}{x-\\alpha} \\end{equation*} \u8054\u7acb\u4ee5\u4e0a\u4e24\u4e2a\u5f0f\u5b50\u5373\u53ef\u5f97\u5230\uff1a \\begin{align*} x' &= \\frac{x-\\alpha}{L^2} \\left[\\alpha'(x-\\alpha)+\\beta'(y-\\beta)\\right] \\\\ y' &= \\frac{y-\\beta}{L^2} \\left[\\alpha'(x-\\alpha)+\\beta'(y-\\beta)\\right] \\\\ \\end{align*} \u5e38\u5fae\u5206\u65b9\u7a0b\u6570\u503c\u89e3 \u00b6 \u4e0a\u5f0f\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u5e38\u5fae\u5206\u65b9\u7a0b\u7ec4\u6c42\u89e3\u95ee\u9898\u3002\u53ea\u6709\u5f53\u524d\u8f6e\u8f68\u8ff9\u662f\u67d0\u4e9b\u975e\u5e38\u7b80\u5355\u7684\u66f2\u7ebf\u65f6\uff0c\u540e\u8f6e\u8f68\u8ff9\u624d\u6709\u53ef\u80fd\u88ab\u89e3\u6790\u6c42\u89e3\uff0c\u6240\u4ee5\u672c\u6587\u91c7\u7528\u7684\u662f\u6570\u503c\u6c42\u89e3\u7684\u65b9\u6cd5\u3002 \u6b27\u62c9\u5728\u6c42\u89e3\u5f62\u5982 y'(x)=f(x, y) y'(x)=f(x, y) \u7684\u5fae\u5206\u65b9\u7a0b\u7684\u6570\u503c\u89e3\u95ee\u9898\u4e0a\u7ed9\u51fa\u4e86\u4e00\u4e9b\u6807\u51c6\u89e3\u6cd5\u3002\u672c\u6587\u5f85\u6c42\u89e3\u7684\u65b9\u7a0b\u7ec4\u4e2d \\alpha, \\beta \\alpha, \\beta \u90fd\u662f\u53c2\u6570 t t \u7684\u51fd\u6570\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f52\u7ed3\u4e3a\uff1a \\begin{align*} x'(t) &= f(t, x, y) \\\\ y'(t) &= g(t, x, y) \\\\ \\end{align*} \u4e3a\u4e86\u5957\u7528 y'(x)=f(x, y) y'(x)=f(x, y) \u7684\u6807\u51c6\u5f62\u5f0f\uff0c\u6211\u4eec\u5c06\u4e0a\u8ff0\u65b9\u7a0b\u7ec4\u6539\u5199\u4e3a\u5411\u91cf\u5f62\u5f0f Y'=F(t, Y) Y'=F(t, Y) \u3002\u5176\u4e2d\uff0c Y=(x,y) Y=(x,y) \u8868\u793a\u5f85\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\u7684\u5404\u4e2a\u5206\u91cf\u7ec4\u6210\u7684\u5411\u91cf\uff0c\u4e5f\u5c31\u662f\u540e\u8f6e\u66f2\u7ebf\u4e0a\u7684 x x \u548c y y \u5750\u6807\uff1b F=(f,g) F=(f,g) \u8868\u793a\u5f85\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\u7684\u5404\u4e2a\u63a7\u5236\u65b9\u7a0b\u3002 \u4f5c\u4e3a\u7ec3\u4e60\uff0c\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0\u6b27\u62c9\u65b9\u6cd5\u53ca\u5176\u6539\u8fdb\u7b97\u6cd5\uff08\u4f8b\u5982 Runge-Kutta \u65b9\u6cd5\uff09\u6765\u6c42\u89e3\u4e0a\u8ff0\u95ee\u9898\uff0c\u4f46\u8fd9\u4e0d\u662f\u672c\u6587\u7684\u91cd\u70b9\u3002\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u91c7\u7528Python\u79d1\u5b66\u8ba1\u7b97\u5e93 scipy \u4e2d\u7684 odeint() \u65b9\u6cd5\u6765\u6c42\u89e3\u5e38\u5fae\u5206\u65b9\u7a0b\u3002 odeint() \u51fd\u6570\u58f0\u660e\u5982\u4e0b\uff08\u9664\u4e86\u6700\u57fa\u672c\u7684\u524d\u4e09\u4e2a\u53c2\u6570\u5916\uff0c\u8fd9\u91cc\u5c06\u5176\u4f59\u53c2\u6570\u7edf\u4e00\u7528 **kw \u8868\u793a\uff09\uff0c\u5177\u4f53\u53c2\u8003\u5b98\u65b9\u6587\u6863 2 \u3002 scipy.integrate.odeint(func, y0, t, **kw) func \u8868\u793a\u5f85\u6c42\u89e3\u7684\u51fd\u6570\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u53c2\u6570\u5217\u8868 callable(Y, t, \u2026) \uff0c\u5373\u5f85\u6c42\u89e3\u53d8\u91cf Y \u51fa\u73b0\u5728\u81ea\u53d8\u91cf t \u4e4b\u524d\u3002 \u5982\u679c\u8bbe\u7f6e tfirst=True \uff0c\u5219\u6539\u53d8\u4e3a callable(t, Y, \u2026) \u7684\u5f62\u5f0f\u3002 \u5982\u679c\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\uff0c\u5219\u51fd\u6570\u8fd4\u56de\u503c\u4e3a\u5404\u4e2a\u5fae\u5206\u65b9\u7a0b\u8fd4\u56de\u503c\u7ec4\u6210\u7684\u5411\u91cf\u3002 y0 \u8868\u793a\u7ed9\u5b9a\u7684\u521d\u59cb\u6761\u4ef6\uff0c\u663e\u7136\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\u65f6 y0 \u662f\u4e00\u4e2a\u5411\u91cf\u3002 t \u8868\u793a\u81ea\u53d8\u91cf\u7684\u6c42\u89e3\u533a\u95f4\u6216\u8005\u7ed9\u5b9a\u5e8f\u5217\uff0c\u5e76\u4e14 t[0] \u5fc5\u987b\u6b63\u597d\u5bf9\u5e94\u521d\u59cb\u6761\u4ef6 y0 \u3002 \u51fd\u6570\u8fd4\u56de\u503c\u4e3a\u4e8c\u7ef4 numpy \u6570\u7ec4\uff0c\u6bcf\u4e00\u884c\u5bf9\u5e94\u7ed9\u5b9a\u7684\u81ea\u53d8\u91cf\u5e8f\u5217 t \u7684\u4e00\u4e2a\u503c\uff0c\u6bcf\u4e00\u5217\u5bf9\u5e94\u5f85\u6c42\u89e3\u53d8\u91cf y \u7684\u4e00\u4e2a\u5206\u91cf \u3002 Python\u6c42\u89e3\u65b9\u6848 \u00b6 \u524d\u4e24\u8282\u5206\u522b\u5efa\u7acb\u4e86\u6570\u5b66\u6a21\u578b\u548c\u7ed9\u51fa\u4e86\u6c42\u89e3\u65b9\u6cd5\uff0c\u63a5\u4e0b\u6765\u501f\u52a9Python\u5b9e\u73b0\u5373\u53ef\u89e3\u51b3\u81ea\u884c\u8f66\u8f68\u8ff9\u95ee\u9898\u4e86\u3002\u8003\u8651\u5230\u5fae\u5206\u65b9\u7a0b\u7684\u89e3\u4f9d\u8d56\u4e8e\u521d\u59cb\u6761\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\u5373\u4fbf\u524d\u8f6e\u8d70\u540c\u6837\u7684\u8f68\u8ff9\uff0c\u540e\u8f6e\u8f68\u8ff9\u4e5f\u4f1a\u56e0\u4e3a\u521a\u542f\u52a8\u81ea\u884c\u8f66\u65f6\u8f66\u8eab\u59ff\u6001\uff08\u540e\u8f6e\u4f4d\u7f6e\uff09\u7684\u4e0d\u540c\u800c\u4e0d\u540c\u3002\u5f53\u521d\u60f3\u5230\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e5f\u6b63\u662f\u60f3\u63a2\u7a76\u4ee5\u4e0d\u540c\u59ff\u6001\u542f\u52a8\u81ea\u884c\u8f66\u65f6\uff0c\u540e\u8f6e\u662f\u5982\u4f55\u8ffd\u968f\u524d\u8f6e\u8f68\u8ff9\u7684\u3002\u6240\u4ee5\uff0c\u4e0b\u9762\u4ee5\u524d\u8f6e\u8f68\u8ff9\u53c2\u6570\u65b9\u7a0b\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570\u5f00\u59cb\u81ea\u884c\u8f66\u8f68\u8ff9\u95ee\u9898\u7684\u9762\u5411\u5bf9\u8c61\u6c42\u89e3\u3002 import autograd.numpy as np from autograd import grad from scipy.integrate import odeint class BicycleTrack: ''' Solving and plot back wheel track according to front wheel track and initial position of the bicycle. The track of front wheel is given by: x = fx(t) y = fy(t) Arguments: fx : function object of front wheel track x component fy : function object of front wheel track y component ''' def __init__(self, fx, fy): # front wheel track self.front_track_x = fx self.front_track_y = fy # first derivative of front wheel track on parameter t self.dfx = grad(fx) self.dfy = grad(fy) # solved back track represented with t, x, y self.t, self.X, self.Y = None, None, None # back track self.FX, self.FY = None, None # front track \u4ece\u8fd9\u4e2a\u95ee\u9898\u7684\u63a7\u5236\u65b9\u7a0b\u53ef\u77e5\uff0c\u6211\u4eec\u9700\u8981\u6c42\u89e3\u524d\u8f6e\u8f68\u8ff9\u7684\u4e00\u9636\u5bfc\u6570\uff0c\u8fd9\u91cc\u501f\u52a9\u7b2c\u4e09\u65b9\u5e93 autograd \u6765\u5b9e\u73b0[ 3 ]\u3002\u4f8b\u5982\u4e0a\u8ff0\u4ee3\u7801\u4e2d self.dfx = grad(fx) \u5373\u5f97\u5230\u524d\u8f6e\u6a2a\u5750\u6807\u53c2\u6570\u65b9\u7a0b fx \u7684\u4e00\u9636\u5bfc\u51fd\u6570 dfx \u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u907f\u514d\u4f7f\u7528\u8be5\u5e93\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u7684\u95ee\u9898\uff0c\u5e73\u65f6\u5bfc\u5165 numpy \u5e93\u7684\u4ee3\u7801\u5e94\u6539\u4e3a import autograd.numpy as np \u3002 \u63a5\u4e0b\u6765\u5b9a\u4e49\u5f85\u6c42\u89e3\u7684\u5fae\u5206\u65b9\u7a0b\u7ec4\uff1a def governing_equation(self, t, Y): ''' ODEs of Bicycle Track Problem ''' x, y = Y k1 = np.array([self.dfx(t), self.dfy(t)]) k2 = np.array([x-self.front_track_x(t), y-self.front_track_y(t)]) return np.sum(k1*k2) * k2 / self.L**2 \u672c\u6587\u91c7\u7528\u4e86 callable(t, Y, \u2026) \u5f62\u5f0f\u7684\u53c2\u6570\u5217\u8868\uff08\u4ec5\u4ec5\u56e0\u4e3a\u4e2a\u4eba\u4e60\u60ef\uff09\uff0c\u56e0\u6b64\u540e\u9762\u88ab odeint \u8c03\u7528\u65f6\u9700\u8981\u6307\u660e tfirst=True \uff1b self.L \u4e3a\u81ea\u884c\u8f66\u8f66\u8eab\u957f\u5ea6\uff08\u524d\u540e\u8f6e\u6bc2\u4e2d\u5fc3\u8ddd\u79bb\uff09\uff0c\u5b83\u5728\u7ed9\u5b9a\u6c42\u89e3\u533a\u95f4\u548c\u521d\u59cb\u6761\u4ef6\u65f6\u88ab\u786e\u5b9a\u3002 \u6700\u540e\uff0c\u8c03\u7528 odeint \u6c42\u89e3\u6570\u503c\u89e3\uff1a def solve(self, span, P0, num=100): ''' span: solving range of parameter t P0 : initial position of back wheel (x, y) ''' # initial point of back wheel P0 = np.array(P0) # initial point of front wheel is defined by parametric equations t0, t1 = span Q0 = np.array([self.front_track_x(t0), self.front_track_y(t0)]) # frame length is defined by P0 and Q0 self.L = np.sum((P0-Q0)**2)**0.5 # solving self.t = np.linspace(t0, t1, num) res = odeint(self.governing_equation, P0, self.t, tfirst=True) # solved back track self.X, self.Y = res[:, 0], res[:, 1] # front wheel track self.FX, self.FY = self.front_track_x(self.t), self.front_track_y(self.t) self.FX \u3001 self.FY \u3001 self.X \u548c self.Y \u5206\u522b\u4fdd\u5b58\u6c42\u89e3\u540e\u7684\u524d\u540e\u8f6e\u6a2a\u7eb5\u5750\u6807\u503c\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528\u4e8e\u540e\u7eed\u7684\u53ef\u89c6\u5316\u3002 \u9a8c\u8bc1 \u00b6 \u4e0a\u6587\u63d0\u5230\u4ec5\u6709\u5c11\u6570\u7b80\u5355\u7684\u60c5\u5f62\u624d\u80fd\u5f97\u5230\u540e\u8f6e\u8f68\u8ff9\u7684\u89e3\u6790\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u4ee5\u7279\u6b8a\u60c5\u5f62\u4e4b\u4e00\u2014\u2014 \u66f3\u7269\u7ebf 4 5 \u4e3a\u4f8b\u8fdb\u884c\u9a8c\u8bc1\u3002\u66f3\u7269\u7ebf\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u81ea\u884c\u8f66\u521d\u59cb\u6cbf\u7740 y \u8f74\u505c\u653e\u4e14\u4fdd\u6301\u524d\u8f6e\u6b63\u597d\u5728\u539f\u70b9\uff0c\u7136\u540e\u524d\u8f6e\u6cbf\u7740 x \u8f74\u6b63\u65b9\u5411\u884c\u8fdb\uff0c\u6b64\u65f6\u540e\u8f6e\u7684\u8f68\u8ff9\u5373\u4e3a\u66f3\u7269\u7ebf\u3002 \u524d\u8f6e\u8f68\u8ff9\u975e\u5e38\u7b80\u5355\uff1a x=t, y=0 x=t, y=0 \u6839\u636e\u66f3\u7269\u7ebf\u7684\u89e3\u6790\u8868\u8fbe\u5f0f\u5f97\u5230\u540e\u8f6e\u8f68\u8ff9\u7684\u89e3\u6790\u89e3\uff1a x=L*(t-tanht), y=L*secht x=L*(t-tanht), y=L*secht \uff08 L \u4e3a\u8f66\u8eab\u957f\u5ea6\uff09\u3002 import numpy as np import matplotlib.pyplot as plt from bicycle_track import BicycleTrack L = 1 # length # numeric solution BT = BicycleTrack(lambda t: t, lambda t: 0*t) BT.solve([0, 5], np.array([0, L]), 50) # analytical solution t = BT.t x = L*(t-np.sinh(t)/np.cosh(t)) y = L/np.cosh(t) # plot plt.plot(BT.X, BT.Y, 'ro', label='numeric solution') plt.plot(x, y, 'deepskyblue', label='analytical solution') plt.legend() plt.show() \u7ed3\u679c\u5c55\u793a \u00b6 \u4e0b\u9762\u4ee3\u7801\u753b\u51fa\u540c\u4e00\u81ea\u884c\u8f66\u4ece\u4e0d\u540c\u521d\u59cb\u72b6\u6001\u6cbf\u7740\u76f8\u540c\u524d\u8f6e\u8f68\u8ff9\u884c\u8fdb\u65f6\u540e\u8f6e\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002 \u524d\u8f6e\u4ece\u539f\u70b9\u51fa\u53d1\u6cbf\u7740\u66f2\u7ebf (x-5)^2+y^2=25 (x-5)^2+y^2=25 \u9006\u65f6\u9488\u8fd0\u52a8 \u8f66\u8eab\u957f\u5ea6 L=3 L=3 \uff0c\u540e\u8f6e\u7684\u521d\u59cb\u4f4d\u7f6e\u5fc5\u5b9a\u5728\u5706 x^2+y^2=9 x^2+y^2=9 \u4e0a\u3002\u8fd9\u91cc\u9009\u53d6\u4e0e x x \u8f74\u6b63\u5411\u5939\u89d2 \\theta \\theta \u5206\u522b\u4e3a \\pi/2, \\pi, 3\\pi/2 \\pi/2, \\pi, 3\\pi/2 \u7684\u4e09\u4e2a\u521d\u59cb\u4f4d\u7f6e\u3002 import autograd.numpy as np from bicycle_track import BicycleTrack import matplotlib.pyplot as plt def fx(t): return 5+5*np.cos(t) def fy(t): return 5*np.sin(t) L = 3 span = [-np.pi, np.pi] fig = plt.figure(tight_layout=True) colors = ['lightcoral', 'indianred', 'tomato'] BT = BicycleTrack(fx, fy) for i,c in enumerate(colors): theta = (i+1)*np.pi/2.0 P0 = L*np.array([np.cos(theta), np.sin(theta)]) BT.solve(span, P0) plt.plot(BT.X, BT.Y, color=c, label=r'back track with $\\theta={0}\\pi$'.format(theta/np.pi)) # front track plt.plot(BT.FX, BT.FY, color='deepskyblue', label='front track') # initial position u = np.linspace(0, 2*np.pi, 50) plt.plot(L*np.cos(u), L*np.sin(u), '--', color='silver', label='initial position') plt.legend() plt.axis('equal') plt.show() \u56fe\u4e2d\u4e09\u6761\u540e\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u9a8c\u8bc1\u4e86\u6211\u6700\u521d\u7684\u4e00\u4e2a\u60f3\u6cd5\uff1a\u65e0\u8bba\u521d\u59cb\u4f4d\u7f6e\u5982\u4f55\uff0c\u6700\u7ec8\u540e\u8f6e\u7684\u8f68\u8ff9\u5c06\u8d8b\u4e8e\u4e00\u81f4\u3002\u8fd9\u4e5f\u662f\u4e00\u4e2a\u5f88\u76f4\u89c2\u7684\u8ba4\u8bc6\uff0c\u867d\u7136\u542f\u52a8\u81ea\u884c\u8f66\u65f6\u8f66\u8eab\u59ff\u6001\uff08\u8f66\u8eab\u65b9\u5411\u4e0e\u76ee\u6807\u65b9\u5411\u7684\u5939\u89d2\uff09\u7565\u6709\u4e0d\u540c\uff0c\u540e\u8f6e\u8f68\u8ff9\u5728\u884c\u8fdb\u4e00\u6bb5\u8ddd\u79bb\u540e\u5c06\u7a33\u5b9a\u5730\u8ddf\u968f\u524d\u8f6e\u8f68\u8ff9\u3002 \u6b64\u5916\uff0c\u56fe\u4e2d\u8fd8\u53cd\u6620\u4e86\u4e00\u4e2a\u6709\u610f\u601d\u7684\u73b0\u8c61\uff1a \\theta=3\\pi/2 \\theta=3\\pi/2 \u65f6\u7684\u540e\u8f6e\u8f68\u8ff9\u5e76\u4e0d\u201c\u5149\u6ed1\u201d\u2014\u2014\u521d\u59cb\u9636\u6bb5\u51fa\u73b0\u4e86\u5012\u8f66\uff0c\u800c\u540e\u6b63\u5e38\u524d\u8fdb\u3002\u4f46\u5b9e\u9645\u4e0a\uff0c\u666e\u901a\u81ea\u884c\u8f66\u5e76\u4e0d\u80fd\u4e3b\u52a8\u5012\u8f66\uff01\u8fd9\u8868\u660e\uff0c\u867d\u7136\u6570\u5b66\u4e0a\u8fd9\u662f\u4e00\u7ec4\u89e3\uff0c\u4f46\u5b9e\u9645\u4e0a\u5e76\u4e0d\u771f\u5b9e\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u76f8\u5bf9\u771f\u5b9e\u7684\u7269\u7406\u6a21\u578b\uff0c\u6211\u4eec\u8fd8\u6f0f\u6389\u4e86\u67d0\u4e9b\u6761\u4ef6\u3002 \u5c06\u81ea\u884c\u8f66\u77ac\u65f6\u901f\u5ea6\u5206\u522b\u6cbf\u7740\u8f66\u8eab\u548c\u5782\u76f4\u7684\u8f66\u8eab\u65b9\u5411\u8fdb\u884c\u5206\u89e3\uff0c\u666e\u901a\u81ea\u884c\u8f66\u7684\u7ed3\u6784\u51b3\u5b9a\u4e86\u4e0d\u80fd\u4e3b\u52a8\u5012\u8f66\uff0c\u8868\u660e\u6cbf\u7740\u8f66\u8eab\u65b9\u5411\u7684\u901f\u5ea6\u5206\u91cf\u5fc5\u987b\u7531\u540e\u8f6e\u6307\u5411\u524d\u8f6e\u3002\u8fd9\u6837\u5c31\u51b3\u5b9a\u4e86\u8f66\u8eab\u65b9\u5411\uff08\u540e\u8f6e\u6307\u5411\u524d\u8f6e\uff09\u4e0e\u884c\u8fdb\u65b9\u5411\u5939\u89d2\u7684\u7edd\u5bf9\u503c \\|\\delta\\|\\le\\pi/2 \\|\\delta\\|\\le\\pi/2 \u3002 \u4e0a\u56fe\u4e2d\uff0c\u81ea\u884c\u8f66\u542f\u52a8\u77ac\u65f6\u524d\u8f6e\u6cbf\u7740 y y \u8f74\u8d1f\u65b9\u5411\uff0c \\theta=3\\pi/2 \\theta=3\\pi/2 \u7684\u66f2\u7ebf\u521d\u59cb\u4f4d\u7f6e\u65f6\u8f66\u8eab\u6cbf\u7740 y y \u8f74\u6b63\u65b9\u5411\uff0c\u5373\u8f66\u8eab\u4e0e\u884c\u8fdb\u65b9\u5411\u5939\u89d2 \\delta=\\pi \\delta=\\pi \u8fdd\u53cd\u4e86\u4e0a\u8ff0\u9650\u5b9a\u6761\u4ef6\uff0c\u56e0\u6b64\u8fd9\u662f\u4e00\u7ec4\u5b9e\u9645\u9a91\u884c\u4e2d\u5e76\u4e0d\u53ef\u80fd\u7684\u89e3\u3002 \u6700\u540e\uff0c\u4ee5 matplotlib \u52a8\u753b\u5f62\u5f0f\uff08\u52a8\u753b\u8fc7\u7a0b\u5177\u4f53\u53c2\u8003\u6587\u672b\u6c47\u603b\u4ee3\u7801\uff09\u76f4\u89c2\u611f\u53d7\u4e00\u4e0b\u4e0a\u8ff0\u8fd0\u52a8\u8fc7\u7a0b\uff1a BicycleTrack \u7c7b\u53ca\u4e3b\u8981\u6d4b\u8bd5\u4ee3\u7801\u6c47\u603b\u5982\u4e0b\uff1a https://github.com/dothinking/blog/blob/master/samples/bicycle_track/bicycle_track.py 1.9 Which Way Did the Bicycle Go? \u2013 and other bicycle ponderings \u21a9 scipy.integrate.odeint \u21a9 HIPS/autograd \u21a9 \u66f3\u7269\u7ebf \u21a9 \u66f3\u7269\u7ebf \u21a9","title":"Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/#python","text":"\u53d1\u5e03\u4e8e\uff1a2019-10-01 | \u5206\u7c7b\uff1a numeric calculation \u6570\u6708\u524d\u5076\u9047\u4e00\u9053\u81ea\u884c\u8f66\u76f8\u5173\u7684\u8da3\u5473\u6570\u5b66\u9898\uff1a\u6839\u636e\u4e0b\u56fe 1 \u6240\u793a\u81ea\u884c\u8f66\u524d\u3001\u540e\u8f6e\u8f68\u8ff9\uff0c\u5224\u65ad\u81ea\u884c\u8f66\u7684\u524d\u8fdb\u65b9\u5411\uff0c\u662f\u4ece\u5de6\u5f80\u53f3\u8fd8\u662f\u4ece\u53f3\u5f80\u5de6\uff1f \u4e0d\u66fe\u60f3\u8fc7\uff0c\u5e73\u5e38\u65e0\u5947\u7684\u81ea\u884c\u8f66\u7684\u4e24\u8f6e\u4e4b\u95f4\u8fd8\u8574\u85cf\u7740\u6052\u5b9a\u7684\u89c4\u5f8b\u3002 \u5728\u8d5e\u53f9\u7b54\u6848\u601d\u8def\u6e05\u5947\u4e4b\u4f59\uff0c\u4e5f\u840c\u751f\u4e86\u57fa\u4e8e\u524d\u8f6e\u8f68\u8ff9\u6c42\u89e3\u540e\u8f6e\u8f68\u8ff9\u7684\u60f3\u6cd5\u3002\u672c\u6587\u9996\u5148\u5efa\u7acb\u81ea\u884c\u8f66\u8f68\u8ff9\u95ee\u9898\u7684\u6570\u5b66\u6a21\u578b\uff08\u5e38\u5fae\u5206\u65b9\u7a0b\uff09\uff0c\u7136\u540e\u5229\u7528Python\u7684 scipy.odeint \u8fdb\u884c\u6c42\u89e3\uff0c\u6700\u540e\u5bf9\u95ee\u9898\u7684\u89e3\u8fdb\u884c\u53ef\u89c6\u5316\u3002","title":"Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/#_1","text":"\u6587\u7ae0\u5f00\u5934\u7684\u95ee\u9898\u6700\u65e9\u51fa\u81ea\u300aWhich Way did the Bicycle Go? \u2026 and Other Intriguing Mathematical Mysteries\u300b\u4e00\u4e66\uff0c\u5c01\u9762\u7528\u7684\u5373\u662f\u8fd9\u9053\u770b\u4f3c\u65e0\u6cd5\u6c42\u89e3\u7684\u95ee\u9898\u3002\u798f\u5c14\u6469\u65af\u63a2\u6848\u96c6\u7cfb\u5217\u4e2d\u4e5f\u8bbe\u8ba1\u4e86\u7c7b\u4f3c\u7684\u6848\u4ef6\uff0c\u53ef\u60dc\u7ed9\u51fa\u7684\u5374\u4e0d\u662f\u6b63\u786e\u7684\u89e3\u91ca\u3002 \u8fd9\u5176\u5b9e\u662f\u4e00\u9053\u7cbe\u5f69\u7684\u51e0\u4f55\u95ee\u9898\u3002\u8003\u8651\u4e00\u4e0b\u81ea\u884c\u8f66\u7684\u7ed3\u6784\u548c\u8fd0\u52a8\u7279\u70b9\uff1a\u524d\u8f6e\u53ef\u4ee5\u81ea\u7531\u63a7\u5236\u884c\u8fdb\u65b9\u5411\uff0c\u800c\u540e\u8f6e\u56e0\u4e3a\u710a\u6b7b\u5728\u8f66\u67b6\u4e0a\u800c\u53ea\u80fd\u6cbf\u7740\u8f66\u8eab\u65b9\u5411\u884c\u8fdb\u3002\u56e0\u6b64\uff0c\u540e\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u4e0a\u4efb\u4e00\u70b9\u7684\u5207\u7ebf\u65b9\u5411\u5373\u4e3a\u8f66\u8eab\u65b9\u5411\uff0c\u5e76\u4e14\u8be5\u65b9\u5411\u4e0e\u524d\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u7684\u4ea4\u70b9\u5373\u4e3a\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f6e\u6bc2\u4e2d\u5fc3\u7684\u8ddd\u79bb\uff0c\u800c\u8fd9\u4fdd\u6301\u4e00\u4e2a\u5b9a\u957f\uff08\u8f66\u8eab\u957f\u5ea6\uff09\u3002\u7528\u6570\u5b66\u8bed\u8a00\u63cf\u8ff0\u4e3a\uff1a \u4f5c\u540e\u8f6e\u66f2\u7ebf\u4e0a\u4efb\u4e00\u70b9 P \u7684\u5207\u7ebf\uff0c\u5f97\u5230\u4e0e\u524d\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u7684\u4ea4\u70b9 Q \uff0c\u5219\u7ebf\u6bb5 PQ \u4fdd\u6301\u5b9a\u957f \u3002 \u6240\u4ee5\u89e3\u9898\u65b9\u6cd5\u4e3a\uff0c\u5206\u522b\u5047\u8bbe\u524d\u540e\u8f6e\u8f68\u8ff9\uff0c\u7136\u540e\u6309\u7167\u4e0a\u8ff0\u7ed3\u8bba\u8fdb\u884c\u9a8c\u8bc1\u3002\u672c\u9898\u7b54\u6848\u4e3a\u81ea\u884c\u8f66\u4ece\u5de6\u5411\u53f3\u884c\u9a76\uff0c\u5177\u4f53\u53c2\u8003\u4e0b\u56fe\uff1a \u5f00\u7bc7\u7684\u95ee\u9898\u89e3\u51b3\u4e86\uff0c\u63a5\u4e0b\u6765\u8fdb\u5165\u6b63\u9898\uff1a\u5df2\u77e5\u4efb\u610f\u7ed9\u5b9a\u7684\u524d\u8f6e\u8f68\u8ff9\uff0c\u5982\u4f55\u6c42\u89e3\u76f8\u5e94\u7684\u540e\u8f6e\u8f68\u8ff9\uff1f\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u7528\u53c2\u6570\u65b9\u7a0b\u6765\u63cf\u8ff0\u66f2\u7ebf\u4e0a\u4efb\u4e00\u70b9\u7684\u5750\u6807 (x,y) (x,y) \uff0c\u4f8b\u5982\u5df2\u77e5\u524d\u8f6e\u8f68\u8ff9 x=\\alpha(t), y=\\beta(t) x=\\alpha(t), y=\\beta(t) \uff0c\u6c42\u89e3\u540e\u8f6e\u8f68\u8ff9 x=x(t), y=y(t) x=x(t), y=y(t) \u3002 \u7531\u5b9a\u957f\u6761\u4ef6 \\|\\overrightarrow{PQ}\\|=L \\|\\overrightarrow{PQ}\\|=L \u5f97\u5230\uff1a \\begin{equation*} (x-\\alpha)^2 + (y-\\beta)^2 = L^2 \\end{equation*} \u4e0a\u5f0f\u5bf9\u53c2\u6570 t t \u6c42\u5bfc\uff1a \\begin{equation*} (x-\\alpha)*(x'-\\alpha')+(y-\\beta)(y'-\\beta')=0 \\end{equation*} \u53e6\u4e00\u65b9\u9762\uff0c\u7531 \\overrightarrow{PQ}//\\overrightarrow{\\tau} \\overrightarrow{PQ}//\\overrightarrow{\\tau} \u5f97\u5230\uff1a \\begin{equation*} \\frac{y'}{x'}=\\frac{y-\\beta}{x-\\alpha} \\end{equation*} \u8054\u7acb\u4ee5\u4e0a\u4e24\u4e2a\u5f0f\u5b50\u5373\u53ef\u5f97\u5230\uff1a \\begin{align*} x' &= \\frac{x-\\alpha}{L^2} \\left[\\alpha'(x-\\alpha)+\\beta'(y-\\beta)\\right] \\\\ y' &= \\frac{y-\\beta}{L^2} \\left[\\alpha'(x-\\alpha)+\\beta'(y-\\beta)\\right] \\\\ \\end{align*}","title":"\u6570\u5b66\u6a21\u578b"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/#_2","text":"\u4e0a\u5f0f\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u5e38\u5fae\u5206\u65b9\u7a0b\u7ec4\u6c42\u89e3\u95ee\u9898\u3002\u53ea\u6709\u5f53\u524d\u8f6e\u8f68\u8ff9\u662f\u67d0\u4e9b\u975e\u5e38\u7b80\u5355\u7684\u66f2\u7ebf\u65f6\uff0c\u540e\u8f6e\u8f68\u8ff9\u624d\u6709\u53ef\u80fd\u88ab\u89e3\u6790\u6c42\u89e3\uff0c\u6240\u4ee5\u672c\u6587\u91c7\u7528\u7684\u662f\u6570\u503c\u6c42\u89e3\u7684\u65b9\u6cd5\u3002 \u6b27\u62c9\u5728\u6c42\u89e3\u5f62\u5982 y'(x)=f(x, y) y'(x)=f(x, y) \u7684\u5fae\u5206\u65b9\u7a0b\u7684\u6570\u503c\u89e3\u95ee\u9898\u4e0a\u7ed9\u51fa\u4e86\u4e00\u4e9b\u6807\u51c6\u89e3\u6cd5\u3002\u672c\u6587\u5f85\u6c42\u89e3\u7684\u65b9\u7a0b\u7ec4\u4e2d \\alpha, \\beta \\alpha, \\beta \u90fd\u662f\u53c2\u6570 t t \u7684\u51fd\u6570\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f52\u7ed3\u4e3a\uff1a \\begin{align*} x'(t) &= f(t, x, y) \\\\ y'(t) &= g(t, x, y) \\\\ \\end{align*} \u4e3a\u4e86\u5957\u7528 y'(x)=f(x, y) y'(x)=f(x, y) \u7684\u6807\u51c6\u5f62\u5f0f\uff0c\u6211\u4eec\u5c06\u4e0a\u8ff0\u65b9\u7a0b\u7ec4\u6539\u5199\u4e3a\u5411\u91cf\u5f62\u5f0f Y'=F(t, Y) Y'=F(t, Y) \u3002\u5176\u4e2d\uff0c Y=(x,y) Y=(x,y) \u8868\u793a\u5f85\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\u7684\u5404\u4e2a\u5206\u91cf\u7ec4\u6210\u7684\u5411\u91cf\uff0c\u4e5f\u5c31\u662f\u540e\u8f6e\u66f2\u7ebf\u4e0a\u7684 x x \u548c y y \u5750\u6807\uff1b F=(f,g) F=(f,g) \u8868\u793a\u5f85\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\u7684\u5404\u4e2a\u63a7\u5236\u65b9\u7a0b\u3002 \u4f5c\u4e3a\u7ec3\u4e60\uff0c\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0\u6b27\u62c9\u65b9\u6cd5\u53ca\u5176\u6539\u8fdb\u7b97\u6cd5\uff08\u4f8b\u5982 Runge-Kutta \u65b9\u6cd5\uff09\u6765\u6c42\u89e3\u4e0a\u8ff0\u95ee\u9898\uff0c\u4f46\u8fd9\u4e0d\u662f\u672c\u6587\u7684\u91cd\u70b9\u3002\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u91c7\u7528Python\u79d1\u5b66\u8ba1\u7b97\u5e93 scipy \u4e2d\u7684 odeint() \u65b9\u6cd5\u6765\u6c42\u89e3\u5e38\u5fae\u5206\u65b9\u7a0b\u3002 odeint() \u51fd\u6570\u58f0\u660e\u5982\u4e0b\uff08\u9664\u4e86\u6700\u57fa\u672c\u7684\u524d\u4e09\u4e2a\u53c2\u6570\u5916\uff0c\u8fd9\u91cc\u5c06\u5176\u4f59\u53c2\u6570\u7edf\u4e00\u7528 **kw \u8868\u793a\uff09\uff0c\u5177\u4f53\u53c2\u8003\u5b98\u65b9\u6587\u6863 2 \u3002 scipy.integrate.odeint(func, y0, t, **kw) func \u8868\u793a\u5f85\u6c42\u89e3\u7684\u51fd\u6570\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u53c2\u6570\u5217\u8868 callable(Y, t, \u2026) \uff0c\u5373\u5f85\u6c42\u89e3\u53d8\u91cf Y \u51fa\u73b0\u5728\u81ea\u53d8\u91cf t \u4e4b\u524d\u3002 \u5982\u679c\u8bbe\u7f6e tfirst=True \uff0c\u5219\u6539\u53d8\u4e3a callable(t, Y, \u2026) \u7684\u5f62\u5f0f\u3002 \u5982\u679c\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\uff0c\u5219\u51fd\u6570\u8fd4\u56de\u503c\u4e3a\u5404\u4e2a\u5fae\u5206\u65b9\u7a0b\u8fd4\u56de\u503c\u7ec4\u6210\u7684\u5411\u91cf\u3002 y0 \u8868\u793a\u7ed9\u5b9a\u7684\u521d\u59cb\u6761\u4ef6\uff0c\u663e\u7136\u6c42\u89e3\u5fae\u5206\u65b9\u7a0b\u7ec4\u65f6 y0 \u662f\u4e00\u4e2a\u5411\u91cf\u3002 t \u8868\u793a\u81ea\u53d8\u91cf\u7684\u6c42\u89e3\u533a\u95f4\u6216\u8005\u7ed9\u5b9a\u5e8f\u5217\uff0c\u5e76\u4e14 t[0] \u5fc5\u987b\u6b63\u597d\u5bf9\u5e94\u521d\u59cb\u6761\u4ef6 y0 \u3002 \u51fd\u6570\u8fd4\u56de\u503c\u4e3a\u4e8c\u7ef4 numpy \u6570\u7ec4\uff0c\u6bcf\u4e00\u884c\u5bf9\u5e94\u7ed9\u5b9a\u7684\u81ea\u53d8\u91cf\u5e8f\u5217 t \u7684\u4e00\u4e2a\u503c\uff0c\u6bcf\u4e00\u5217\u5bf9\u5e94\u5f85\u6c42\u89e3\u53d8\u91cf y \u7684\u4e00\u4e2a\u5206\u91cf \u3002","title":"\u5e38\u5fae\u5206\u65b9\u7a0b\u6570\u503c\u89e3"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/#python_1","text":"\u524d\u4e24\u8282\u5206\u522b\u5efa\u7acb\u4e86\u6570\u5b66\u6a21\u578b\u548c\u7ed9\u51fa\u4e86\u6c42\u89e3\u65b9\u6cd5\uff0c\u63a5\u4e0b\u6765\u501f\u52a9Python\u5b9e\u73b0\u5373\u53ef\u89e3\u51b3\u81ea\u884c\u8f66\u8f68\u8ff9\u95ee\u9898\u4e86\u3002\u8003\u8651\u5230\u5fae\u5206\u65b9\u7a0b\u7684\u89e3\u4f9d\u8d56\u4e8e\u521d\u59cb\u6761\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\u5373\u4fbf\u524d\u8f6e\u8d70\u540c\u6837\u7684\u8f68\u8ff9\uff0c\u540e\u8f6e\u8f68\u8ff9\u4e5f\u4f1a\u56e0\u4e3a\u521a\u542f\u52a8\u81ea\u884c\u8f66\u65f6\u8f66\u8eab\u59ff\u6001\uff08\u540e\u8f6e\u4f4d\u7f6e\uff09\u7684\u4e0d\u540c\u800c\u4e0d\u540c\u3002\u5f53\u521d\u60f3\u5230\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e5f\u6b63\u662f\u60f3\u63a2\u7a76\u4ee5\u4e0d\u540c\u59ff\u6001\u542f\u52a8\u81ea\u884c\u8f66\u65f6\uff0c\u540e\u8f6e\u662f\u5982\u4f55\u8ffd\u968f\u524d\u8f6e\u8f68\u8ff9\u7684\u3002\u6240\u4ee5\uff0c\u4e0b\u9762\u4ee5\u524d\u8f6e\u8f68\u8ff9\u53c2\u6570\u65b9\u7a0b\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570\u5f00\u59cb\u81ea\u884c\u8f66\u8f68\u8ff9\u95ee\u9898\u7684\u9762\u5411\u5bf9\u8c61\u6c42\u89e3\u3002 import autograd.numpy as np from autograd import grad from scipy.integrate import odeint class BicycleTrack: ''' Solving and plot back wheel track according to front wheel track and initial position of the bicycle. The track of front wheel is given by: x = fx(t) y = fy(t) Arguments: fx : function object of front wheel track x component fy : function object of front wheel track y component ''' def __init__(self, fx, fy): # front wheel track self.front_track_x = fx self.front_track_y = fy # first derivative of front wheel track on parameter t self.dfx = grad(fx) self.dfy = grad(fy) # solved back track represented with t, x, y self.t, self.X, self.Y = None, None, None # back track self.FX, self.FY = None, None # front track \u4ece\u8fd9\u4e2a\u95ee\u9898\u7684\u63a7\u5236\u65b9\u7a0b\u53ef\u77e5\uff0c\u6211\u4eec\u9700\u8981\u6c42\u89e3\u524d\u8f6e\u8f68\u8ff9\u7684\u4e00\u9636\u5bfc\u6570\uff0c\u8fd9\u91cc\u501f\u52a9\u7b2c\u4e09\u65b9\u5e93 autograd \u6765\u5b9e\u73b0[ 3 ]\u3002\u4f8b\u5982\u4e0a\u8ff0\u4ee3\u7801\u4e2d self.dfx = grad(fx) \u5373\u5f97\u5230\u524d\u8f6e\u6a2a\u5750\u6807\u53c2\u6570\u65b9\u7a0b fx \u7684\u4e00\u9636\u5bfc\u51fd\u6570 dfx \u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u907f\u514d\u4f7f\u7528\u8be5\u5e93\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u7684\u95ee\u9898\uff0c\u5e73\u65f6\u5bfc\u5165 numpy \u5e93\u7684\u4ee3\u7801\u5e94\u6539\u4e3a import autograd.numpy as np \u3002 \u63a5\u4e0b\u6765\u5b9a\u4e49\u5f85\u6c42\u89e3\u7684\u5fae\u5206\u65b9\u7a0b\u7ec4\uff1a def governing_equation(self, t, Y): ''' ODEs of Bicycle Track Problem ''' x, y = Y k1 = np.array([self.dfx(t), self.dfy(t)]) k2 = np.array([x-self.front_track_x(t), y-self.front_track_y(t)]) return np.sum(k1*k2) * k2 / self.L**2 \u672c\u6587\u91c7\u7528\u4e86 callable(t, Y, \u2026) \u5f62\u5f0f\u7684\u53c2\u6570\u5217\u8868\uff08\u4ec5\u4ec5\u56e0\u4e3a\u4e2a\u4eba\u4e60\u60ef\uff09\uff0c\u56e0\u6b64\u540e\u9762\u88ab odeint \u8c03\u7528\u65f6\u9700\u8981\u6307\u660e tfirst=True \uff1b self.L \u4e3a\u81ea\u884c\u8f66\u8f66\u8eab\u957f\u5ea6\uff08\u524d\u540e\u8f6e\u6bc2\u4e2d\u5fc3\u8ddd\u79bb\uff09\uff0c\u5b83\u5728\u7ed9\u5b9a\u6c42\u89e3\u533a\u95f4\u548c\u521d\u59cb\u6761\u4ef6\u65f6\u88ab\u786e\u5b9a\u3002 \u6700\u540e\uff0c\u8c03\u7528 odeint \u6c42\u89e3\u6570\u503c\u89e3\uff1a def solve(self, span, P0, num=100): ''' span: solving range of parameter t P0 : initial position of back wheel (x, y) ''' # initial point of back wheel P0 = np.array(P0) # initial point of front wheel is defined by parametric equations t0, t1 = span Q0 = np.array([self.front_track_x(t0), self.front_track_y(t0)]) # frame length is defined by P0 and Q0 self.L = np.sum((P0-Q0)**2)**0.5 # solving self.t = np.linspace(t0, t1, num) res = odeint(self.governing_equation, P0, self.t, tfirst=True) # solved back track self.X, self.Y = res[:, 0], res[:, 1] # front wheel track self.FX, self.FY = self.front_track_x(self.t), self.front_track_y(self.t) self.FX \u3001 self.FY \u3001 self.X \u548c self.Y \u5206\u522b\u4fdd\u5b58\u6c42\u89e3\u540e\u7684\u524d\u540e\u8f6e\u6a2a\u7eb5\u5750\u6807\u503c\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528\u4e8e\u540e\u7eed\u7684\u53ef\u89c6\u5316\u3002","title":"Python\u6c42\u89e3\u65b9\u6848"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/#_3","text":"\u4e0a\u6587\u63d0\u5230\u4ec5\u6709\u5c11\u6570\u7b80\u5355\u7684\u60c5\u5f62\u624d\u80fd\u5f97\u5230\u540e\u8f6e\u8f68\u8ff9\u7684\u89e3\u6790\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u4ee5\u7279\u6b8a\u60c5\u5f62\u4e4b\u4e00\u2014\u2014 \u66f3\u7269\u7ebf 4 5 \u4e3a\u4f8b\u8fdb\u884c\u9a8c\u8bc1\u3002\u66f3\u7269\u7ebf\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u81ea\u884c\u8f66\u521d\u59cb\u6cbf\u7740 y \u8f74\u505c\u653e\u4e14\u4fdd\u6301\u524d\u8f6e\u6b63\u597d\u5728\u539f\u70b9\uff0c\u7136\u540e\u524d\u8f6e\u6cbf\u7740 x \u8f74\u6b63\u65b9\u5411\u884c\u8fdb\uff0c\u6b64\u65f6\u540e\u8f6e\u7684\u8f68\u8ff9\u5373\u4e3a\u66f3\u7269\u7ebf\u3002 \u524d\u8f6e\u8f68\u8ff9\u975e\u5e38\u7b80\u5355\uff1a x=t, y=0 x=t, y=0 \u6839\u636e\u66f3\u7269\u7ebf\u7684\u89e3\u6790\u8868\u8fbe\u5f0f\u5f97\u5230\u540e\u8f6e\u8f68\u8ff9\u7684\u89e3\u6790\u89e3\uff1a x=L*(t-tanht), y=L*secht x=L*(t-tanht), y=L*secht \uff08 L \u4e3a\u8f66\u8eab\u957f\u5ea6\uff09\u3002 import numpy as np import matplotlib.pyplot as plt from bicycle_track import BicycleTrack L = 1 # length # numeric solution BT = BicycleTrack(lambda t: t, lambda t: 0*t) BT.solve([0, 5], np.array([0, L]), 50) # analytical solution t = BT.t x = L*(t-np.sinh(t)/np.cosh(t)) y = L/np.cosh(t) # plot plt.plot(BT.X, BT.Y, 'ro', label='numeric solution') plt.plot(x, y, 'deepskyblue', label='analytical solution') plt.legend() plt.show()","title":"\u9a8c\u8bc1"},{"location":"2019-10-01-Python%E6%B1%82%E8%A7%A3%E8%87%AA%E8%A1%8C%E8%BD%A6%E5%89%8D%E5%90%8E%E8%BD%AE%E8%BD%A8%E8%BF%B9%E9%97%AE%E9%A2%98/#_4","text":"\u4e0b\u9762\u4ee3\u7801\u753b\u51fa\u540c\u4e00\u81ea\u884c\u8f66\u4ece\u4e0d\u540c\u521d\u59cb\u72b6\u6001\u6cbf\u7740\u76f8\u540c\u524d\u8f6e\u8f68\u8ff9\u884c\u8fdb\u65f6\u540e\u8f6e\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002 \u524d\u8f6e\u4ece\u539f\u70b9\u51fa\u53d1\u6cbf\u7740\u66f2\u7ebf (x-5)^2+y^2=25 (x-5)^2+y^2=25 \u9006\u65f6\u9488\u8fd0\u52a8 \u8f66\u8eab\u957f\u5ea6 L=3 L=3 \uff0c\u540e\u8f6e\u7684\u521d\u59cb\u4f4d\u7f6e\u5fc5\u5b9a\u5728\u5706 x^2+y^2=9 x^2+y^2=9 \u4e0a\u3002\u8fd9\u91cc\u9009\u53d6\u4e0e x x \u8f74\u6b63\u5411\u5939\u89d2 \\theta \\theta \u5206\u522b\u4e3a \\pi/2, \\pi, 3\\pi/2 \\pi/2, \\pi, 3\\pi/2 \u7684\u4e09\u4e2a\u521d\u59cb\u4f4d\u7f6e\u3002 import autograd.numpy as np from bicycle_track import BicycleTrack import matplotlib.pyplot as plt def fx(t): return 5+5*np.cos(t) def fy(t): return 5*np.sin(t) L = 3 span = [-np.pi, np.pi] fig = plt.figure(tight_layout=True) colors = ['lightcoral', 'indianred', 'tomato'] BT = BicycleTrack(fx, fy) for i,c in enumerate(colors): theta = (i+1)*np.pi/2.0 P0 = L*np.array([np.cos(theta), np.sin(theta)]) BT.solve(span, P0) plt.plot(BT.X, BT.Y, color=c, label=r'back track with $\\theta={0}\\pi$'.format(theta/np.pi)) # front track plt.plot(BT.FX, BT.FY, color='deepskyblue', label='front track') # initial position u = np.linspace(0, 2*np.pi, 50) plt.plot(L*np.cos(u), L*np.sin(u), '--', color='silver', label='initial position') plt.legend() plt.axis('equal') plt.show() \u56fe\u4e2d\u4e09\u6761\u540e\u8f6e\u8f68\u8ff9\u66f2\u7ebf\u9a8c\u8bc1\u4e86\u6211\u6700\u521d\u7684\u4e00\u4e2a\u60f3\u6cd5\uff1a\u65e0\u8bba\u521d\u59cb\u4f4d\u7f6e\u5982\u4f55\uff0c\u6700\u7ec8\u540e\u8f6e\u7684\u8f68\u8ff9\u5c06\u8d8b\u4e8e\u4e00\u81f4\u3002\u8fd9\u4e5f\u662f\u4e00\u4e2a\u5f88\u76f4\u89c2\u7684\u8ba4\u8bc6\uff0c\u867d\u7136\u542f\u52a8\u81ea\u884c\u8f66\u65f6\u8f66\u8eab\u59ff\u6001\uff08\u8f66\u8eab\u65b9\u5411\u4e0e\u76ee\u6807\u65b9\u5411\u7684\u5939\u89d2\uff09\u7565\u6709\u4e0d\u540c\uff0c\u540e\u8f6e\u8f68\u8ff9\u5728\u884c\u8fdb\u4e00\u6bb5\u8ddd\u79bb\u540e\u5c06\u7a33\u5b9a\u5730\u8ddf\u968f\u524d\u8f6e\u8f68\u8ff9\u3002 \u6b64\u5916\uff0c\u56fe\u4e2d\u8fd8\u53cd\u6620\u4e86\u4e00\u4e2a\u6709\u610f\u601d\u7684\u73b0\u8c61\uff1a \\theta=3\\pi/2 \\theta=3\\pi/2 \u65f6\u7684\u540e\u8f6e\u8f68\u8ff9\u5e76\u4e0d\u201c\u5149\u6ed1\u201d\u2014\u2014\u521d\u59cb\u9636\u6bb5\u51fa\u73b0\u4e86\u5012\u8f66\uff0c\u800c\u540e\u6b63\u5e38\u524d\u8fdb\u3002\u4f46\u5b9e\u9645\u4e0a\uff0c\u666e\u901a\u81ea\u884c\u8f66\u5e76\u4e0d\u80fd\u4e3b\u52a8\u5012\u8f66\uff01\u8fd9\u8868\u660e\uff0c\u867d\u7136\u6570\u5b66\u4e0a\u8fd9\u662f\u4e00\u7ec4\u89e3\uff0c\u4f46\u5b9e\u9645\u4e0a\u5e76\u4e0d\u771f\u5b9e\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u76f8\u5bf9\u771f\u5b9e\u7684\u7269\u7406\u6a21\u578b\uff0c\u6211\u4eec\u8fd8\u6f0f\u6389\u4e86\u67d0\u4e9b\u6761\u4ef6\u3002 \u5c06\u81ea\u884c\u8f66\u77ac\u65f6\u901f\u5ea6\u5206\u522b\u6cbf\u7740\u8f66\u8eab\u548c\u5782\u76f4\u7684\u8f66\u8eab\u65b9\u5411\u8fdb\u884c\u5206\u89e3\uff0c\u666e\u901a\u81ea\u884c\u8f66\u7684\u7ed3\u6784\u51b3\u5b9a\u4e86\u4e0d\u80fd\u4e3b\u52a8\u5012\u8f66\uff0c\u8868\u660e\u6cbf\u7740\u8f66\u8eab\u65b9\u5411\u7684\u901f\u5ea6\u5206\u91cf\u5fc5\u987b\u7531\u540e\u8f6e\u6307\u5411\u524d\u8f6e\u3002\u8fd9\u6837\u5c31\u51b3\u5b9a\u4e86\u8f66\u8eab\u65b9\u5411\uff08\u540e\u8f6e\u6307\u5411\u524d\u8f6e\uff09\u4e0e\u884c\u8fdb\u65b9\u5411\u5939\u89d2\u7684\u7edd\u5bf9\u503c \\|\\delta\\|\\le\\pi/2 \\|\\delta\\|\\le\\pi/2 \u3002 \u4e0a\u56fe\u4e2d\uff0c\u81ea\u884c\u8f66\u542f\u52a8\u77ac\u65f6\u524d\u8f6e\u6cbf\u7740 y y \u8f74\u8d1f\u65b9\u5411\uff0c \\theta=3\\pi/2 \\theta=3\\pi/2 \u7684\u66f2\u7ebf\u521d\u59cb\u4f4d\u7f6e\u65f6\u8f66\u8eab\u6cbf\u7740 y y \u8f74\u6b63\u65b9\u5411\uff0c\u5373\u8f66\u8eab\u4e0e\u884c\u8fdb\u65b9\u5411\u5939\u89d2 \\delta=\\pi \\delta=\\pi \u8fdd\u53cd\u4e86\u4e0a\u8ff0\u9650\u5b9a\u6761\u4ef6\uff0c\u56e0\u6b64\u8fd9\u662f\u4e00\u7ec4\u5b9e\u9645\u9a91\u884c\u4e2d\u5e76\u4e0d\u53ef\u80fd\u7684\u89e3\u3002 \u6700\u540e\uff0c\u4ee5 matplotlib \u52a8\u753b\u5f62\u5f0f\uff08\u52a8\u753b\u8fc7\u7a0b\u5177\u4f53\u53c2\u8003\u6587\u672b\u6c47\u603b\u4ee3\u7801\uff09\u76f4\u89c2\u611f\u53d7\u4e00\u4e0b\u4e0a\u8ff0\u8fd0\u52a8\u8fc7\u7a0b\uff1a BicycleTrack \u7c7b\u53ca\u4e3b\u8981\u6d4b\u8bd5\u4ee3\u7801\u6c47\u603b\u5982\u4e0b\uff1a https://github.com/dothinking/blog/blob/master/samples/bicycle_track/bicycle_track.py 1.9 Which Way Did the Bicycle Go? \u2013 and other bicycle ponderings \u21a9 scipy.integrate.odeint \u21a9 HIPS/autograd \u21a9 \u66f3\u7269\u7ebf \u21a9 \u66f3\u7269\u7ebf \u21a9","title":"\u7ed3\u679c\u5c55\u793a"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/","text":"GitLab CI CD\uff1abefore_script\u548cafter_script \u00b6 \u53d1\u5e03\u4e8e\uff1a2019-12-29 | \u5206\u7c7b\uff1a devops \u672c\u6587\u8bb0\u5f55\u4f7f\u7528 before_script \u548c after_script \u89e3\u51b3 GitLab CI/CD \u6d41\u7a0b\u4e2d\u9047\u5230\u7684\u4e00\u4e2a\u95ee\u9898\u3002 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u5728\u67d0\u4e2a\u9879\u76ee\u7684 CI/CD \u6d41\u7a0b\u4e2d\u6709\u4e00\u4e2a job \u662f\u5229\u7528 Python \u5904\u7406 Excel \u548c VBA \uff0c\u4e00\u65e6\u539f\u59cb VBA \u4ee3\u7801\u51fa\u73b0\u6a21\u6001\u5bf9\u8bdd\u6846\u4f8b\u5982 MsgBox \u6216\u8005\u5176\u4ed6\u7528\u6237\u7a97\u4f53\u751a\u81f3\u8bed\u6cd5\u9519\u8bef\uff0c\u90a3\u4e48\u6574\u4e2a\u6d41\u7a0b\u5c31\u88ab\u5835\u585e\u4e86\uff1b\u63a5\u4e0b\u6765\u8981\u4e48\u53ca\u65f6\u53d1\u73b0\u540e\u624b\u52a8\u53d6\u6d88\u4efb\u52a1\uff0c\u8981\u4e48\u76f4\u81f3\u4efb\u52a1\u8d85\u65f6\u800c\u88ab\u81ea\u52a8\u7ec8\u6b62\u3002 \u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\u7ec8\u6b62\u4efb\u52a1\uff0c\u5176\u540e\u679c\u90fd\u662f\u8be5 Excel \u8fdb\u7a0b\u6ca1\u6709\u88ab\u7ec8\u6b62\u3002\u4e8e\u662f\u5728\u4e0b\u4e00\u6b21\u63d0\u4ea4\u4efb\u52a1\u65f6\uff0c\u7531\u4e8e\u8fdb\u7a0b\u5360\u7528\u800c\u65e0\u6cd5\u6e05\u7406\u51fa\u73b0\u9519\u8bef\u7684\u4e34\u65f6\u6587\u4ef6\uff08\u4f8b\u5982\u4e0b\u9762\u7684 ~$example.xlsm \uff09\u3002 Checking out 56485a5a as alpha... warning: failed to remove dist/example.xlsm: Invalid argument warning: failed to remove dist/~$example.xlsm: Invalid argument ERROR: Job failed: exit status 1 \u6b64\u65f6\u53ea\u80fd\u767b\u9646 GitLab Runner \u670d\u52a1\u5668\uff0c\u624b\u52a8\u7ec8\u6b62 Excel \u8fdb\u7a0b\u3002\u8fd9\u663e\u7136\u4e0d\u662f\u4e00\u4e2a\u53ef\u4ee5\u63a5\u53d7\u7684\u65b9\u6848\uff0c\u5c24\u5176\u5728\u591a\u4eba\u534f\u4f5c\u7684\u60c5\u51b5\u4e0b\u3002 \u89e3\u51b3\u8fc7\u7a0b \u00b6 \u5f53\u7136\uff0c\u91dc\u5e95\u62bd\u85aa\u7684\u65b9\u6cd5\u662f VBA \u4e2d\u907f\u514d\u51fa\u73b0\u963b\u585e\u6d41\u7a0b\u7684\u6a21\u6001\u5bf9\u8bdd\u6846\uff0c\u6216\u8005 Python \u811a\u672c\u4e2d\u68c0\u6d4b\u662f\u5426\u53d1\u751f\u963b\u585e\u3002\u4f46\u524d\u8005\u96be\u4ee5\u767e\u5206\u767e\u4fdd\u8bc1\uff08\u4f8b\u5982 VBA \u8bed\u6cd5\u9519\u8bef\uff09\uff0c\u540e\u8005\u6709\u5f85\u8fdb\u4e00\u6b65\u7814\u7a76\uff0c\u6240\u4ee5\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u4e8b\u540e\u7684\u89e3\u51b3\u601d\u8def\uff1a \u5728\u5df2\u7ecf\u53d1\u751f\u56e0\u963b\u585e\u800c\u5f02\u5e38\u7ec8\u6b62pipeline\u7684\u60c5\u51b5\u4e0b\uff0c\u5c1d\u8bd5\u53bb\u7ed3\u675f Excel \u8fdb\u7a0b\uff1b\u5e76\u4e14\u5e0c\u671b\u5c3d\u91cf\u5c11\u7684\u6539\u52a8\uff0c\u4f8b\u5982\u4ec5\u5728 .gitlab-ci.yml \u4e2d\u589e\u5220\u51e0\u884c\u3002 \u65e2\u7136\u662f\u4e8b\u540e\u65b9\u6848\uff0c\u6211\u4eec\u5c06\u8054\u60f3\u5230 before_script \u548c after_script \uff1a \u672c\u6b21\u5f02\u5e38\u7ec8\u6b62\u540e\u7acb\u9a6c\u4f7f\u7528 after_script \u6740\u6389\u8fdb\u7a0b \u4e0b\u4e00\u6b21\u6b63\u5e38\u63d0\u4ea4\u540e\u4f7f\u7528 before_script \u6740\u6389\u8fdb\u7a0b \u7ed3\u675f Excel \u8fdb\u7a0b \u00b6 \u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u5148\u628a\u7ec8\u6b62 Excel \u8fdb\u7a0b\u7684\u811a\u672c\u5199\u4e0a\u3002\u53c2\u8003\u6587\u7ae0 1 \uff0c\u5728\u4e3b makefile \u7684 cclean \u547d\u4ee4\u4e2d\u589e\u52a0\u4e00\u4e2a kill_excel \u3002 .PHONY: cclean cclean: kill_excel @ echo \"do clean work here ...\" ... .PHONY: kill_excel kill_excel: @if [ -n \"`TASKLIST | FINDSTR EXCEL.EXE`\" ]; then \\ TASKKILL -F -T -IM EXCEL.EXE ; \\ fi after_script \u00b6 \u9996\u5148\u60f3\u5230\u7684\u81ea\u7136\u662f after_script \u2014\u2014\u5728\u4e3b\u8981\u811a\u672c\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e\u6740\u6389 Excel \u8fdb\u7a0b\u3002 ... build: stage: build script: - make build after_script: - make cclean tags: - xxxx ... \u867d\u7136\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5373\u4fbf\u4efb\u52a1\u5931\u8d25\u4e5f\u4f1a\u7ee7\u7eed\u6267\u884c after_script \u3002\u4f46\u662f\uff0c \u5f02\u5e38\u7ed3\u675f\uff08\u624b\u52a8\u53d6\u6d88\u3001\u8d85\u65f6\u81ea\u52a8\u7ec8\u6b62\uff09\u7684Pipeline\u5e76\u4e0d\u4f1a\u7ee7\u7eed\u6267\u884c after_script \u5b9a\u4e49\u7684\u811a\u672c \uff01 before_script \u00b6 \u90a3\u5c31\u53ea\u80fd\u8003\u8651 before_script \u2014\u2014\u5728\u4e0b\u6b21\u6b63\u5e38\u63d0\u4ea4\u540e\u3001\u5f00\u59cb\u6267\u884c\u4e3b\u811a\u672c\u524d\u8fdb\u884c\u6740\u6389 Excel \u8fdb\u7a0b\u3002 ... build: stage: build before_script: - make cclean script: - make build tags: - xxxx ... \u4f46\u76ee\u6d4b\u8fd8\u662f\u89e3\u51b3\u4e0d\u4e86\u95ee\u9898\uff0c\u56e0\u4e3a\u672c\u6587\u63cf\u8ff0\u7684\u95ee\u9898\u51fa\u73b0\u5728\u51c6\u5907\u9636\u6bb5\uff0c\u5c1a\u672a\u6765\u5f97\u53ca\u6267\u884c script \uff01 \u901a\u8fc7\u8f93\u51fa\u65e5\u5fd7\u76f4\u89c2\u4e86\u89e3\u4e00\u4e0b job \u7684\u6267\u884c\u6d41\u7a0b\uff1a Fetching changes ... Checking out ... Downloading artifacts ... Run before_script ... Run script ... Run after_script ... Git strategy \u00b6 \u56e0\u6b64\u6709\u5fc5\u8981\u5b66\u4e60\u548c\u53c2\u8003\u4e00\u4e0b\u5e2e\u52a9\u6587\u6863 2 \u4e2d\u5173\u4e8e Runner \u66f4\u65b0\u5de5\u4f5c\u76ee\u5f55\u4ee3\u7801\u7684\u7b56\u7565\u2014\u2014 GIT_STRATEGY \u53d8\u91cf\uff1a clone \u6bcf\u4e2a job \u90fd\u514b\u9686\u4e00\u904d\u4ed3\u5e93\uff0c\u786e\u4fdd\u9879\u76ee\u5de5\u4f5c\u7a7a\u95f4\u603b\u662f\u548c\u4ed3\u5e93\u4ee3\u7801\u540c\u6b65\u7684\uff0c\u56e0\u6b64\u901f\u5ea6\u4e5f\u662f\u6700\u6162\u7684 fetch \u91cd\u7528\u9879\u76ee\u5de5\u4f5c\u7a7a\u95f4\u7684\u4ee3\u7801, \u56e0\u6b64\u901f\u5ea6\u66f4\u5feb\uff1b\u5206\u4e3a\u4e24\u6b65\uff1a git fetch \u91cd\u65b0\u83b7\u53d6\u4e0a\u4e00\u4e2a job \u5230\u5f53\u524d job \u4e4b\u95f4\u7684\u6240\u6709\u63d0\u4ea4 git clean \u64a4\u9500\u4e0a\u4e00\u4e2a job \u7684\u4efb\u4f55\u64cd\u4f5c none \u540c\u6837\u91cd\u7528\u5de5\u4f5c\u7a7a\u95f4\uff0c\u5e76\u4e14\u8df3\u8fc7\u6240\u6709 git \u64cd\u4f5c\uff0c\u56e0\u6b64\u4ee3\u7801\u4e0d\u4e00\u5b9a\u662f\u6700\u65b0\u7684\u3002\u5b83\u7684\u4f5c\u7528\u5728\u4e8e\u64cd\u4f5c artifacts \uff0c\u4f8b\u5982\u90e8\u7f72\u524d\u7f6e job \u4ea7\u751f\u7684\u7ed3\u679c\u3002 \u4ece\u4e0a\u9762\u7684\u65e5\u5fd7\u53ef\u4ee5\u770b\u51fa\u6211\u7684 Runner \u9ed8\u8ba4\u7684\u662f GIT_STRATEGY=\"fetch\" \uff0c\u5e76\u4e14\u95ee\u9898\u51fa\u5728 git clean \u8fd9\u4e00\u6b65\u3002 \u6240\u4ee5\uff0c\u89e3\u51b3\u601d\u8def\u4e3a\u6682\u65f6\u4e0d\u8981 git clean \uff0c\u6539\u4e3a\u5728 before_script \u4e2d\u6267\u884c make cclean \u6765\u8fbe\u5230\u64a4\u9500\u6b64\u524d job \u64cd\u4f5c\u7684\u76ee\u7684\uff0c\u540c\u65f6\u4e5f\u987a\u4fbf\u6740\u6389 Excel \u8fdb\u7a0b\u3002 \u7d22\u6027 GitLab \u679c\u7136\u63d0\u4f9b\u4e86 git clean \u7684\u5f00\u5173\u53c2\u6570 GIT_CLEAN_FLAGS 3 \uff0c\u5c06\u5176\u8bbe\u7f6e\u4e3a none \u5373\u53ef\u8df3\u8fc7\u8fd9\u4e00\u6b65\u3002\u4e8e\u662f\uff0c\u6700\u7ec8\u7684 .gitlab-ci.yml \uff08\u5c40\u90e8\uff09\u4e3a\uff1a ... variables: GIT_CLEAN_FLAGS: none ... build: stage: build before_script: - make cclean script: - make build tags: - xxxx ... \u603b\u7ed3 \u00b6 Pipeline\u5f02\u5e38\u7ed3\u675f\u540e\u5e76\u4e0d\u4f1a\u6267\u884c after_script \u7ed3\u5408 GIT_CLEAN_FLAGS \u548c before_script \u53ef\u4ee5\u89e3\u51b3\u672c\u95ee\u9898 How to check if a process is running via a batch script \u21a9 Git strategy \u21a9 Git clean flags \u21a9","title":"GitLab CI CD\uff1abefore_script\u548cafter_script"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#gitlab ci cdbefore_scriptafter_script","text":"\u53d1\u5e03\u4e8e\uff1a2019-12-29 | \u5206\u7c7b\uff1a devops \u672c\u6587\u8bb0\u5f55\u4f7f\u7528 before_script \u548c after_script \u89e3\u51b3 GitLab CI/CD \u6d41\u7a0b\u4e2d\u9047\u5230\u7684\u4e00\u4e2a\u95ee\u9898\u3002","title":"GitLab CI CD\uff1abefore_script\u548cafter_script"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#_1","text":"\u5728\u67d0\u4e2a\u9879\u76ee\u7684 CI/CD \u6d41\u7a0b\u4e2d\u6709\u4e00\u4e2a job \u662f\u5229\u7528 Python \u5904\u7406 Excel \u548c VBA \uff0c\u4e00\u65e6\u539f\u59cb VBA \u4ee3\u7801\u51fa\u73b0\u6a21\u6001\u5bf9\u8bdd\u6846\u4f8b\u5982 MsgBox \u6216\u8005\u5176\u4ed6\u7528\u6237\u7a97\u4f53\u751a\u81f3\u8bed\u6cd5\u9519\u8bef\uff0c\u90a3\u4e48\u6574\u4e2a\u6d41\u7a0b\u5c31\u88ab\u5835\u585e\u4e86\uff1b\u63a5\u4e0b\u6765\u8981\u4e48\u53ca\u65f6\u53d1\u73b0\u540e\u624b\u52a8\u53d6\u6d88\u4efb\u52a1\uff0c\u8981\u4e48\u76f4\u81f3\u4efb\u52a1\u8d85\u65f6\u800c\u88ab\u81ea\u52a8\u7ec8\u6b62\u3002 \u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\u7ec8\u6b62\u4efb\u52a1\uff0c\u5176\u540e\u679c\u90fd\u662f\u8be5 Excel \u8fdb\u7a0b\u6ca1\u6709\u88ab\u7ec8\u6b62\u3002\u4e8e\u662f\u5728\u4e0b\u4e00\u6b21\u63d0\u4ea4\u4efb\u52a1\u65f6\uff0c\u7531\u4e8e\u8fdb\u7a0b\u5360\u7528\u800c\u65e0\u6cd5\u6e05\u7406\u51fa\u73b0\u9519\u8bef\u7684\u4e34\u65f6\u6587\u4ef6\uff08\u4f8b\u5982\u4e0b\u9762\u7684 ~$example.xlsm \uff09\u3002 Checking out 56485a5a as alpha... warning: failed to remove dist/example.xlsm: Invalid argument warning: failed to remove dist/~$example.xlsm: Invalid argument ERROR: Job failed: exit status 1 \u6b64\u65f6\u53ea\u80fd\u767b\u9646 GitLab Runner \u670d\u52a1\u5668\uff0c\u624b\u52a8\u7ec8\u6b62 Excel \u8fdb\u7a0b\u3002\u8fd9\u663e\u7136\u4e0d\u662f\u4e00\u4e2a\u53ef\u4ee5\u63a5\u53d7\u7684\u65b9\u6848\uff0c\u5c24\u5176\u5728\u591a\u4eba\u534f\u4f5c\u7684\u60c5\u51b5\u4e0b\u3002","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#_2","text":"\u5f53\u7136\uff0c\u91dc\u5e95\u62bd\u85aa\u7684\u65b9\u6cd5\u662f VBA \u4e2d\u907f\u514d\u51fa\u73b0\u963b\u585e\u6d41\u7a0b\u7684\u6a21\u6001\u5bf9\u8bdd\u6846\uff0c\u6216\u8005 Python \u811a\u672c\u4e2d\u68c0\u6d4b\u662f\u5426\u53d1\u751f\u963b\u585e\u3002\u4f46\u524d\u8005\u96be\u4ee5\u767e\u5206\u767e\u4fdd\u8bc1\uff08\u4f8b\u5982 VBA \u8bed\u6cd5\u9519\u8bef\uff09\uff0c\u540e\u8005\u6709\u5f85\u8fdb\u4e00\u6b65\u7814\u7a76\uff0c\u6240\u4ee5\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u4e8b\u540e\u7684\u89e3\u51b3\u601d\u8def\uff1a \u5728\u5df2\u7ecf\u53d1\u751f\u56e0\u963b\u585e\u800c\u5f02\u5e38\u7ec8\u6b62pipeline\u7684\u60c5\u51b5\u4e0b\uff0c\u5c1d\u8bd5\u53bb\u7ed3\u675f Excel \u8fdb\u7a0b\uff1b\u5e76\u4e14\u5e0c\u671b\u5c3d\u91cf\u5c11\u7684\u6539\u52a8\uff0c\u4f8b\u5982\u4ec5\u5728 .gitlab-ci.yml \u4e2d\u589e\u5220\u51e0\u884c\u3002 \u65e2\u7136\u662f\u4e8b\u540e\u65b9\u6848\uff0c\u6211\u4eec\u5c06\u8054\u60f3\u5230 before_script \u548c after_script \uff1a \u672c\u6b21\u5f02\u5e38\u7ec8\u6b62\u540e\u7acb\u9a6c\u4f7f\u7528 after_script \u6740\u6389\u8fdb\u7a0b \u4e0b\u4e00\u6b21\u6b63\u5e38\u63d0\u4ea4\u540e\u4f7f\u7528 before_script \u6740\u6389\u8fdb\u7a0b","title":"\u89e3\u51b3\u8fc7\u7a0b"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#excel","text":"\u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u5148\u628a\u7ec8\u6b62 Excel \u8fdb\u7a0b\u7684\u811a\u672c\u5199\u4e0a\u3002\u53c2\u8003\u6587\u7ae0 1 \uff0c\u5728\u4e3b makefile \u7684 cclean \u547d\u4ee4\u4e2d\u589e\u52a0\u4e00\u4e2a kill_excel \u3002 .PHONY: cclean cclean: kill_excel @ echo \"do clean work here ...\" ... .PHONY: kill_excel kill_excel: @if [ -n \"`TASKLIST | FINDSTR EXCEL.EXE`\" ]; then \\ TASKKILL -F -T -IM EXCEL.EXE ; \\ fi","title":"\u7ed3\u675fExcel\u8fdb\u7a0b"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#after_script","text":"\u9996\u5148\u60f3\u5230\u7684\u81ea\u7136\u662f after_script \u2014\u2014\u5728\u4e3b\u8981\u811a\u672c\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e\u6740\u6389 Excel \u8fdb\u7a0b\u3002 ... build: stage: build script: - make build after_script: - make cclean tags: - xxxx ... \u867d\u7136\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5373\u4fbf\u4efb\u52a1\u5931\u8d25\u4e5f\u4f1a\u7ee7\u7eed\u6267\u884c after_script \u3002\u4f46\u662f\uff0c \u5f02\u5e38\u7ed3\u675f\uff08\u624b\u52a8\u53d6\u6d88\u3001\u8d85\u65f6\u81ea\u52a8\u7ec8\u6b62\uff09\u7684Pipeline\u5e76\u4e0d\u4f1a\u7ee7\u7eed\u6267\u884c after_script \u5b9a\u4e49\u7684\u811a\u672c \uff01","title":"after_script"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#before_script","text":"\u90a3\u5c31\u53ea\u80fd\u8003\u8651 before_script \u2014\u2014\u5728\u4e0b\u6b21\u6b63\u5e38\u63d0\u4ea4\u540e\u3001\u5f00\u59cb\u6267\u884c\u4e3b\u811a\u672c\u524d\u8fdb\u884c\u6740\u6389 Excel \u8fdb\u7a0b\u3002 ... build: stage: build before_script: - make cclean script: - make build tags: - xxxx ... \u4f46\u76ee\u6d4b\u8fd8\u662f\u89e3\u51b3\u4e0d\u4e86\u95ee\u9898\uff0c\u56e0\u4e3a\u672c\u6587\u63cf\u8ff0\u7684\u95ee\u9898\u51fa\u73b0\u5728\u51c6\u5907\u9636\u6bb5\uff0c\u5c1a\u672a\u6765\u5f97\u53ca\u6267\u884c script \uff01 \u901a\u8fc7\u8f93\u51fa\u65e5\u5fd7\u76f4\u89c2\u4e86\u89e3\u4e00\u4e0b job \u7684\u6267\u884c\u6d41\u7a0b\uff1a Fetching changes ... Checking out ... Downloading artifacts ... Run before_script ... Run script ... Run after_script ...","title":"before_script"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#git strategy","text":"\u56e0\u6b64\u6709\u5fc5\u8981\u5b66\u4e60\u548c\u53c2\u8003\u4e00\u4e0b\u5e2e\u52a9\u6587\u6863 2 \u4e2d\u5173\u4e8e Runner \u66f4\u65b0\u5de5\u4f5c\u76ee\u5f55\u4ee3\u7801\u7684\u7b56\u7565\u2014\u2014 GIT_STRATEGY \u53d8\u91cf\uff1a clone \u6bcf\u4e2a job \u90fd\u514b\u9686\u4e00\u904d\u4ed3\u5e93\uff0c\u786e\u4fdd\u9879\u76ee\u5de5\u4f5c\u7a7a\u95f4\u603b\u662f\u548c\u4ed3\u5e93\u4ee3\u7801\u540c\u6b65\u7684\uff0c\u56e0\u6b64\u901f\u5ea6\u4e5f\u662f\u6700\u6162\u7684 fetch \u91cd\u7528\u9879\u76ee\u5de5\u4f5c\u7a7a\u95f4\u7684\u4ee3\u7801, \u56e0\u6b64\u901f\u5ea6\u66f4\u5feb\uff1b\u5206\u4e3a\u4e24\u6b65\uff1a git fetch \u91cd\u65b0\u83b7\u53d6\u4e0a\u4e00\u4e2a job \u5230\u5f53\u524d job \u4e4b\u95f4\u7684\u6240\u6709\u63d0\u4ea4 git clean \u64a4\u9500\u4e0a\u4e00\u4e2a job \u7684\u4efb\u4f55\u64cd\u4f5c none \u540c\u6837\u91cd\u7528\u5de5\u4f5c\u7a7a\u95f4\uff0c\u5e76\u4e14\u8df3\u8fc7\u6240\u6709 git \u64cd\u4f5c\uff0c\u56e0\u6b64\u4ee3\u7801\u4e0d\u4e00\u5b9a\u662f\u6700\u65b0\u7684\u3002\u5b83\u7684\u4f5c\u7528\u5728\u4e8e\u64cd\u4f5c artifacts \uff0c\u4f8b\u5982\u90e8\u7f72\u524d\u7f6e job \u4ea7\u751f\u7684\u7ed3\u679c\u3002 \u4ece\u4e0a\u9762\u7684\u65e5\u5fd7\u53ef\u4ee5\u770b\u51fa\u6211\u7684 Runner \u9ed8\u8ba4\u7684\u662f GIT_STRATEGY=\"fetch\" \uff0c\u5e76\u4e14\u95ee\u9898\u51fa\u5728 git clean \u8fd9\u4e00\u6b65\u3002 \u6240\u4ee5\uff0c\u89e3\u51b3\u601d\u8def\u4e3a\u6682\u65f6\u4e0d\u8981 git clean \uff0c\u6539\u4e3a\u5728 before_script \u4e2d\u6267\u884c make cclean \u6765\u8fbe\u5230\u64a4\u9500\u6b64\u524d job \u64cd\u4f5c\u7684\u76ee\u7684\uff0c\u540c\u65f6\u4e5f\u987a\u4fbf\u6740\u6389 Excel \u8fdb\u7a0b\u3002 \u7d22\u6027 GitLab \u679c\u7136\u63d0\u4f9b\u4e86 git clean \u7684\u5f00\u5173\u53c2\u6570 GIT_CLEAN_FLAGS 3 \uff0c\u5c06\u5176\u8bbe\u7f6e\u4e3a none \u5373\u53ef\u8df3\u8fc7\u8fd9\u4e00\u6b65\u3002\u4e8e\u662f\uff0c\u6700\u7ec8\u7684 .gitlab-ci.yml \uff08\u5c40\u90e8\uff09\u4e3a\uff1a ... variables: GIT_CLEAN_FLAGS: none ... build: stage: build before_script: - make cclean script: - make build tags: - xxxx ...","title":"Git strategy"},{"location":"2019-12-29-GitLab-CI-CD%EF%BC%9Abefore_script%E5%92%8Cafter_script/#_3","text":"Pipeline\u5f02\u5e38\u7ed3\u675f\u540e\u5e76\u4e0d\u4f1a\u6267\u884c after_script \u7ed3\u5408 GIT_CLEAN_FLAGS \u548c before_script \u53ef\u4ee5\u89e3\u51b3\u672c\u95ee\u9898 How to check if a process is running via a batch script \u21a9 Git strategy \u21a9 Git clean flags \u21a9","title":"\u603b\u7ed3"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/","text":"TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-02-27 | \u5206\u7c7b\uff1a machine learning \u5f53\u6837\u672c\u6570\u636e\u5927\u5230\u4e0d\u80fd\u4e00\u6b21\u6027\u8f7d\u5165\u5185\u5b58\u65f6\uff0cTensorFlow\u63a8\u8350\u4f7f\u7528 tf.data.Dataset \u521b\u5efa\u6837\u672c\u7684\u8f93\u5165\u6570\u636e\u6d41\uff0c\u8fdb\u800c\u6295\u5582\u7ed9\u6a21\u578b\u8fdb\u884c\u8bad\u7ec3 model.fit(dataset) \u3002\u672c\u6587\u4ee5\u5e26\u6807\u7b7e\uff08\u5373\u6587\u4ef6\u540d\uff09\u7684\u9a8c\u8bc1\u7801\u56fe\u7247\u6570\u636e\u96c6\u4e3a\u4f8b\uff0c\u8bb0\u5f55\u57fa\u672c\u6d41\u7a0b\u53ca\u4e00\u4e9b\u5907\u5fd8\u70b9\u3002 \u57fa\u672c\u6d41\u7a0b \u00b6 tf.data.Dataset \u7684\u4f7f\u7528\u9075\u5faa\u57fa\u672c\u7684\u6d41\u7a0b 1 \uff1a \u4ece\u8f93\u5165\u6570\u636e\u521b\u5efa Dataset \uff0c\u4f8b\u5982 from_tensor_slices \uff0c list_files \u5e94\u7528 Dataset \u53d8\u6362\u9884\u5904\u7406\u6570\u636e\uff0c\u4f8b\u5982 map \u3001 filter \u3001 shuffle \u3001 batch \u3001 repeat \u3001 cache \u7b49\u7b49 \u904d\u5386 Dataset \u5e76\u751f\u6210\u6570\u636e \u9488\u5bf9\u672c\u4f8b\u4e2d\u4ece\u6587\u4ef6\u5939\u8bfb\u53d6\u56fe\u7247\u7684\u95ee\u9898\uff0c\u6211\u4eec\u76f4\u63a5\u53ef\u4ee5\u4ece tf.data.Dataset.list_files \u5f00\u59cb\u3002\u4ee5\u4e0b\u53c2\u8003\u4e86TensorFlow\u624b\u518c 2 \u4e2d\u76f8\u5173\u5185\u5bb9\u3002 \u521b\u5efa\u6e90\u6570\u636e\u96c6\uff1a tf.data.Dataset.list_files \u00b6 \u8be5\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a Dataset \uff0c\u5176\u5143\u7d20\u4e3a\u6ee1\u8db3\u7ed9\u5b9a\u6a21\u5f0f\u7684\u6240\u6709\u6587\u4ef6\u8def\u5f84\uff0c\u5e76\u4e14\u5143\u7d20\u9ed8\u8ba4 \u968f\u673a \u3001 \u4e0d\u786e\u5b9a \u6392\u5217\u3002 \u4e0d\u786e\u5b9a \u6307\u7684\u662f\u6bcf\u6b21\u904d\u5386\u65f6\u5f97\u5230\u7684\u987a\u5e8f\u90fd\u4e0d\u4e00\u6837\u3002 \u5982\u679c\u9700\u8981\u5f97\u5230\u56fa\u5b9a\u7684\u987a\u5e8f\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u786e\u5b9a\u7684 seed \u6216\u8005\u5173\u95ed\u6253\u4e71\u9009\u9879 shuffle=False \u3002 list_files( file_pattern, shuffle=None, seed=None ) file_pattern \u9700\u8981\u8f7d\u5165\u6587\u4ef6\u7684\u8def\u5f84\u6a21\u5f0f\uff0c\u4f8b\u5982 samples/*.jpg shuffle \u662f\u5426\u6253\u4e71\u6570\u636e\u96c6\uff0c\u9ed8\u8ba4**\u662f** seed \u7528\u4ee5\u6253\u4e71\u6570\u636e\u96c6\u7684\u968f\u673a\u6570\u79cd\u5b50 \u6570\u636e\u96c6\u53d8\u6362\u9884\u5904\u7406\u6570\u636e \u00b6 \u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u6587\u4ef6\u540d\uff0c\u4f46\u771f\u6b63\u9700\u8981\u5582\u7ed9\u6a21\u578b\u7684\u662f\u56fe\u7247\u672c\u8eab\u53ca\u5176\u6807\u7b7e\uff0c\u6240\u4ee5\u9700\u8981\u5728\u8fd9\u4e2a\u6e90\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\u53d8\u6362\u64cd\u4f5c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c Dataset \u7684\u5143\u7d20\u5e94\u6ee1\u8db3 (X, Y) \u7684\u5f62\u5f0f\uff0c\u5f53\u5305\u542b\u591a\u7279\u5f81\u7684\u8f93\u5165\u6216\u8f93\u51fa\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u8f93\u51fa\u56db\u4f4d\u7684\u9a8c\u8bc1\u7801\uff0c\u53ef\u4ee5\u4ee5\u5b57\u5178\u7684\u5f62\u5f0f\u6784\u9020 (X, Y) \u5143\u7ec4\u4e2d\u7684 X \u6216 Y \uff1a (image_raw_data, { 'label_1': 'A', 'label_2': 'b', 'label_3': 'c', 'label_4': 'D' }) \u6ce8\u610f \u5f53\u5b9a\u4e49\u591a\u8f93\u5165\u591a\u8f93\u51fa\u7684\u6a21\u578b\u7ed3\u6784\u65f6\uff0c\u8f93\u5165\u8f93\u51fa\u7684\u540d\u79f0\u5e94\u4e0e\u6b64\u5904\u7684\u5b9a\u4e49\u524d\u540e\u4e00\u81f4 3 \u3002 tf.data.Dataset.map \u00b6 TensorFlow\u63d0\u4f9b\u4e86 map \u51fd\u6570\u5c06\u9884\u5b9a\u4e49\u7684\u53d8\u6362\u64cd\u4f5c map_func \u4f5c\u7528\u5728 Dataset \u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4e0a\uff0c\u7136\u540e\u8fd4\u56de\u8fd9\u4e2a\u65b0\u7684 Dataset \u3002 map( map_func, num_parallel_calls=None ) map_func \u4ee5\u539f\u6765 Dataset \u4e2d\u7684\u5143\u7d20\u4e3a\u53c2\u6570\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u8fd4\u56de\u65b0 Dataset \u4e2d\u76f8\u5e94\u7684\u5143\u7d20 num_parallel_calls \u5e76\u884c\u5904\u7406\u5143\u7d20\u7684\u4e2a\u6570\uff0c\u9ed8\u8ba4\u987a\u5e8f\u6267\u884c \u9700\u8981\u6ce8\u610f\u7684\u662f map \u51fd\u6570\u4ee5 Graph \u7684\u5f62\u5f0f\u6267\u884c\u81ea\u5b9a\u4e49\u7684 map_func \uff0c\u56e0\u6b64 EagerTensor \u7684\u6027\u8d28\u4f8b\u5982 numpy() \u5c06\u4e0d\u53ef\u7528\u3002\u5982\u679c\u975e\u7528\u4e0d\u53ef\uff0cAPI\u6587\u6863 1 \u4e2d\u63d0\u53ca\u4e86\u4f7f\u7528 tf.py_function \u8f6c\u6362\u7684\u5f62\u5f0f\uff0c\u4f46\u662f\u4ee5\u6027\u80fd\u635f\u5931\u4e3a\u4ee3\u4ef7\u3002 \u5177\u4f53\u5230\u672c\u4f8b\u4e2d\uff0c path_pattern = 'samples/*.jpg' dataset = tf.data.Dataset.list_files(path_pattern).map( lambda image_path: ( _decode_image(image_path), # load images, perform transformation as X _decode_labels(image_path) # parse labels as Y )) tf.data.Dataset.shuffle \u00b6 shuffle \u6253\u4e71\u5f53\u524d Dataset \u5e76\u8fd4\u56de\u4e71\u5e8f\u540e\u7684 Dataset \uff0c\u65b9\u4fbf\u94fe\u5f0f\u64cd\u4f5c\u3002 shuffle( buffer_size, seed=None, reshuffle_each_iteration=None ) buffer_size \u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5143\u7d20\u88ab\u4f9d\u6b21\u586b\u5165\u7f13\u51b2\u533a\uff0c\u7136\u540e\u4ece\u4e2d\u968f\u673a\u53d6\u51fa\u4ee5\u8fbe\u5230\u6253\u4e71\u6548\u679c\u3002\u56e0\u6b64\uff0c buffer_size \u8d8a\u5927\uff0c\u4e71\u5e8f\u6548\u679c\u8d8a\u597d\uff0c\u4f46\u6027\u80fd\u968f\u4e4b\u4e0b\u964d\u3002 seed \u6253\u4e71\u7528\u7684\u968f\u673a\u6570\u79cd\u5b50 reshuffle_each_iteration \u662f\u5426\u6bcf\u6b21\u904d\u5386\u65f6\u90fd\u81ea\u52a8\u6253\u4e71\uff0c\u9ed8\u8ba4 \u662f \u3002\u907f\u514d\u4e0d\u540c epoch \u7684\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c Dataset \u4fdd\u6301\u4e00\u81f4\u7684\u987a\u5e8f\u3002 tf.data.Dataset.batch \u00b6 \u5c06\u4e00\u5b9a\u6570\u91cf\u7684\u5143\u7d20\u7ec4\u7ec7\u4e3a\u4e00\u4e2a batch \uff0c\u5f97\u5230\u65b0\u7684 Dataset \u3002\u540c\u4e3a\u94fe\u5f0f\u64cd\u4f5c\u3002 batch( batch_size, drop_remainder=False ) batch_size \u6279\u6b21\u7684\u5927\u5c0f drop_remainder \u5f53\u539f\u6765\u6837\u672c\u6570\u91cf\u4e0d\u80fd\u88ab batch_size \u6574\u9664\u65f6\uff0c\u662f\u5426\u4e22\u5f03\u6700\u540e\u5269\u4e0b\u7684\u4e0d\u8db3\u4e00\u4e2a\u6279\u6b21\u7684\u6837\u672c\u3002\u9ed8\u8ba4 \u4fdd\u7559 \u3002 \u6b64\u5916\uff0c Dataset \u8fd8\u6709\u4e00\u4e9b\u5217\u5b9e\u7528\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982 filter \u7b5b\u9009\u5143\u7d20\u3001 cache \u63d0\u5347\u6027\u80fd\uff0c\u5177\u4f53\u64cd\u4f5cAPI\u6587\u6863 1 \u3002 \u4ee3\u7801\u6c47\u603b \u00b6 import tensorflow as tf # -------------------------------------------- # create dataset from path pattern # -------------------------------------------- def create_dataset_from_path(path_pattern, batch_size=32, image_size=(60, 120), label_prefix='labels', grayscale=False): # load image and convert to grayscale # create path dataset # by default, `tf.data.Dataset.list_files` gets filenames # in a non-deterministic random shuffled order return tf.data.Dataset.list_files(path_pattern).map( lambda image_path: _parse_path_function(image_path, image_size, label_prefix, grayscale) ).batch(batch_size) def _parse_path_function(path, image_size, label_prefix, grayscale): '''parse image data and labels from path''' raw_image = open(path, 'rb').read() labels = tf.strings.substr(path, -8, 4) # path example: b'xxx\\abcd.jpg' # decode image array and labels image_data = _decode_image(raw_image, image_size, grayscale) dict_labels = _decode_labels(labels, label_prefix) return image_data, dict_labels def _decode_image(image, resize, grayscale): '''preprocess image with given raw data - image: image raw data ''' image = tf.image.decode_jpeg(image, channels=3) # convert to floats in the [0,1] range. image = tf.image.convert_image_dtype(image, tf.float32) image = tf.image.resize(image, resize) # RGB to grayscale -> channels=1 if grayscale: image = tf.image.rgb_to_grayscale(image) # shape=(h, w, 1) return image # (h, w, c) def _decode_labels(labels, prefix): ''' this function is used within dataset.map(), where eager execution is disables by default: check tf.executing_eagerly() returns False. So any Tensor.numpy() is not allowed in this function. ''' dict_labels = {} for i in range(4): c = tf.strings.substr(labels, i, 1) # labels example: b'abcd' label = tf.strings.unicode_decode(c, input_encoding='utf-8') - ord('a') dict_labels[f'{prefix}{i}'] = label return dict_labels \u81f3\u6b64\u53ef\u4ee5\u5c06\u6574\u4e2a\u6587\u4ef6\u5939\u7684\u56fe\u7247\u5582\u7ed9\u6a21\u578b\u8bad\u7ec3\u4e86\uff0c\u4f46\u662f\u6570\u5341\u4e07\u5f20\u56fe\u7247\u65e2\u4e0d\u65b9\u4fbf\u4f20\u8f93\u3001\u9891\u7e41\u8bfb\u6587\u4ef6\u64cd\u4f5c\u4e5f\u5f71\u54cd\u6027\u80fd\uff0c\u56e0\u6b64\u4e0b\u7bc7\u5c06\u6240\u6709\u6570\u636e\u5199\u5165 TFRecord \u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528 tf.data.TFRecordDataset \u5bfc\u5165\u3002 tf.data.Dataset \u21a9 \u21a9 \u21a9 Load Images using tf.data \u21a9 Models with multiple inputs and outputs \u21a9","title":"TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#tensorflowtfdatadataset","text":"\u53d1\u5e03\u4e8e\uff1a2020-02-27 | \u5206\u7c7b\uff1a machine learning \u5f53\u6837\u672c\u6570\u636e\u5927\u5230\u4e0d\u80fd\u4e00\u6b21\u6027\u8f7d\u5165\u5185\u5b58\u65f6\uff0cTensorFlow\u63a8\u8350\u4f7f\u7528 tf.data.Dataset \u521b\u5efa\u6837\u672c\u7684\u8f93\u5165\u6570\u636e\u6d41\uff0c\u8fdb\u800c\u6295\u5582\u7ed9\u6a21\u578b\u8fdb\u884c\u8bad\u7ec3 model.fit(dataset) \u3002\u672c\u6587\u4ee5\u5e26\u6807\u7b7e\uff08\u5373\u6587\u4ef6\u540d\uff09\u7684\u9a8c\u8bc1\u7801\u56fe\u7247\u6570\u636e\u96c6\u4e3a\u4f8b\uff0c\u8bb0\u5f55\u57fa\u672c\u6d41\u7a0b\u53ca\u4e00\u4e9b\u5907\u5fd8\u70b9\u3002","title":"TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#_1","text":"tf.data.Dataset \u7684\u4f7f\u7528\u9075\u5faa\u57fa\u672c\u7684\u6d41\u7a0b 1 \uff1a \u4ece\u8f93\u5165\u6570\u636e\u521b\u5efa Dataset \uff0c\u4f8b\u5982 from_tensor_slices \uff0c list_files \u5e94\u7528 Dataset \u53d8\u6362\u9884\u5904\u7406\u6570\u636e\uff0c\u4f8b\u5982 map \u3001 filter \u3001 shuffle \u3001 batch \u3001 repeat \u3001 cache \u7b49\u7b49 \u904d\u5386 Dataset \u5e76\u751f\u6210\u6570\u636e \u9488\u5bf9\u672c\u4f8b\u4e2d\u4ece\u6587\u4ef6\u5939\u8bfb\u53d6\u56fe\u7247\u7684\u95ee\u9898\uff0c\u6211\u4eec\u76f4\u63a5\u53ef\u4ee5\u4ece tf.data.Dataset.list_files \u5f00\u59cb\u3002\u4ee5\u4e0b\u53c2\u8003\u4e86TensorFlow\u624b\u518c 2 \u4e2d\u76f8\u5173\u5185\u5bb9\u3002","title":"\u57fa\u672c\u6d41\u7a0b"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#tfdatadatasetlist_files","text":"\u8be5\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a Dataset \uff0c\u5176\u5143\u7d20\u4e3a\u6ee1\u8db3\u7ed9\u5b9a\u6a21\u5f0f\u7684\u6240\u6709\u6587\u4ef6\u8def\u5f84\uff0c\u5e76\u4e14\u5143\u7d20\u9ed8\u8ba4 \u968f\u673a \u3001 \u4e0d\u786e\u5b9a \u6392\u5217\u3002 \u4e0d\u786e\u5b9a \u6307\u7684\u662f\u6bcf\u6b21\u904d\u5386\u65f6\u5f97\u5230\u7684\u987a\u5e8f\u90fd\u4e0d\u4e00\u6837\u3002 \u5982\u679c\u9700\u8981\u5f97\u5230\u56fa\u5b9a\u7684\u987a\u5e8f\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u786e\u5b9a\u7684 seed \u6216\u8005\u5173\u95ed\u6253\u4e71\u9009\u9879 shuffle=False \u3002 list_files( file_pattern, shuffle=None, seed=None ) file_pattern \u9700\u8981\u8f7d\u5165\u6587\u4ef6\u7684\u8def\u5f84\u6a21\u5f0f\uff0c\u4f8b\u5982 samples/*.jpg shuffle \u662f\u5426\u6253\u4e71\u6570\u636e\u96c6\uff0c\u9ed8\u8ba4**\u662f** seed \u7528\u4ee5\u6253\u4e71\u6570\u636e\u96c6\u7684\u968f\u673a\u6570\u79cd\u5b50","title":"\u521b\u5efa\u6e90\u6570\u636e\u96c6\uff1atf.data.Dataset.list_files"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#_2","text":"\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u6587\u4ef6\u540d\uff0c\u4f46\u771f\u6b63\u9700\u8981\u5582\u7ed9\u6a21\u578b\u7684\u662f\u56fe\u7247\u672c\u8eab\u53ca\u5176\u6807\u7b7e\uff0c\u6240\u4ee5\u9700\u8981\u5728\u8fd9\u4e2a\u6e90\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\u53d8\u6362\u64cd\u4f5c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c Dataset \u7684\u5143\u7d20\u5e94\u6ee1\u8db3 (X, Y) \u7684\u5f62\u5f0f\uff0c\u5f53\u5305\u542b\u591a\u7279\u5f81\u7684\u8f93\u5165\u6216\u8f93\u51fa\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u8f93\u51fa\u56db\u4f4d\u7684\u9a8c\u8bc1\u7801\uff0c\u53ef\u4ee5\u4ee5\u5b57\u5178\u7684\u5f62\u5f0f\u6784\u9020 (X, Y) \u5143\u7ec4\u4e2d\u7684 X \u6216 Y \uff1a (image_raw_data, { 'label_1': 'A', 'label_2': 'b', 'label_3': 'c', 'label_4': 'D' }) \u6ce8\u610f \u5f53\u5b9a\u4e49\u591a\u8f93\u5165\u591a\u8f93\u51fa\u7684\u6a21\u578b\u7ed3\u6784\u65f6\uff0c\u8f93\u5165\u8f93\u51fa\u7684\u540d\u79f0\u5e94\u4e0e\u6b64\u5904\u7684\u5b9a\u4e49\u524d\u540e\u4e00\u81f4 3 \u3002","title":"\u6570\u636e\u96c6\u53d8\u6362\u9884\u5904\u7406\u6570\u636e"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#tfdatadatasetmap","text":"TensorFlow\u63d0\u4f9b\u4e86 map \u51fd\u6570\u5c06\u9884\u5b9a\u4e49\u7684\u53d8\u6362\u64cd\u4f5c map_func \u4f5c\u7528\u5728 Dataset \u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4e0a\uff0c\u7136\u540e\u8fd4\u56de\u8fd9\u4e2a\u65b0\u7684 Dataset \u3002 map( map_func, num_parallel_calls=None ) map_func \u4ee5\u539f\u6765 Dataset \u4e2d\u7684\u5143\u7d20\u4e3a\u53c2\u6570\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u8fd4\u56de\u65b0 Dataset \u4e2d\u76f8\u5e94\u7684\u5143\u7d20 num_parallel_calls \u5e76\u884c\u5904\u7406\u5143\u7d20\u7684\u4e2a\u6570\uff0c\u9ed8\u8ba4\u987a\u5e8f\u6267\u884c \u9700\u8981\u6ce8\u610f\u7684\u662f map \u51fd\u6570\u4ee5 Graph \u7684\u5f62\u5f0f\u6267\u884c\u81ea\u5b9a\u4e49\u7684 map_func \uff0c\u56e0\u6b64 EagerTensor \u7684\u6027\u8d28\u4f8b\u5982 numpy() \u5c06\u4e0d\u53ef\u7528\u3002\u5982\u679c\u975e\u7528\u4e0d\u53ef\uff0cAPI\u6587\u6863 1 \u4e2d\u63d0\u53ca\u4e86\u4f7f\u7528 tf.py_function \u8f6c\u6362\u7684\u5f62\u5f0f\uff0c\u4f46\u662f\u4ee5\u6027\u80fd\u635f\u5931\u4e3a\u4ee3\u4ef7\u3002 \u5177\u4f53\u5230\u672c\u4f8b\u4e2d\uff0c path_pattern = 'samples/*.jpg' dataset = tf.data.Dataset.list_files(path_pattern).map( lambda image_path: ( _decode_image(image_path), # load images, perform transformation as X _decode_labels(image_path) # parse labels as Y ))","title":"tf.data.Dataset.map"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#tfdatadatasetshuffle","text":"shuffle \u6253\u4e71\u5f53\u524d Dataset \u5e76\u8fd4\u56de\u4e71\u5e8f\u540e\u7684 Dataset \uff0c\u65b9\u4fbf\u94fe\u5f0f\u64cd\u4f5c\u3002 shuffle( buffer_size, seed=None, reshuffle_each_iteration=None ) buffer_size \u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5143\u7d20\u88ab\u4f9d\u6b21\u586b\u5165\u7f13\u51b2\u533a\uff0c\u7136\u540e\u4ece\u4e2d\u968f\u673a\u53d6\u51fa\u4ee5\u8fbe\u5230\u6253\u4e71\u6548\u679c\u3002\u56e0\u6b64\uff0c buffer_size \u8d8a\u5927\uff0c\u4e71\u5e8f\u6548\u679c\u8d8a\u597d\uff0c\u4f46\u6027\u80fd\u968f\u4e4b\u4e0b\u964d\u3002 seed \u6253\u4e71\u7528\u7684\u968f\u673a\u6570\u79cd\u5b50 reshuffle_each_iteration \u662f\u5426\u6bcf\u6b21\u904d\u5386\u65f6\u90fd\u81ea\u52a8\u6253\u4e71\uff0c\u9ed8\u8ba4 \u662f \u3002\u907f\u514d\u4e0d\u540c epoch \u7684\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c Dataset \u4fdd\u6301\u4e00\u81f4\u7684\u987a\u5e8f\u3002","title":"tf.data.Dataset.shuffle"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#tfdatadatasetbatch","text":"\u5c06\u4e00\u5b9a\u6570\u91cf\u7684\u5143\u7d20\u7ec4\u7ec7\u4e3a\u4e00\u4e2a batch \uff0c\u5f97\u5230\u65b0\u7684 Dataset \u3002\u540c\u4e3a\u94fe\u5f0f\u64cd\u4f5c\u3002 batch( batch_size, drop_remainder=False ) batch_size \u6279\u6b21\u7684\u5927\u5c0f drop_remainder \u5f53\u539f\u6765\u6837\u672c\u6570\u91cf\u4e0d\u80fd\u88ab batch_size \u6574\u9664\u65f6\uff0c\u662f\u5426\u4e22\u5f03\u6700\u540e\u5269\u4e0b\u7684\u4e0d\u8db3\u4e00\u4e2a\u6279\u6b21\u7684\u6837\u672c\u3002\u9ed8\u8ba4 \u4fdd\u7559 \u3002 \u6b64\u5916\uff0c Dataset \u8fd8\u6709\u4e00\u4e9b\u5217\u5b9e\u7528\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982 filter \u7b5b\u9009\u5143\u7d20\u3001 cache \u63d0\u5347\u6027\u80fd\uff0c\u5177\u4f53\u64cd\u4f5cAPI\u6587\u6863 1 \u3002","title":"tf.data.Dataset.batch"},{"location":"2020-02-27-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.Dataset/#_3","text":"import tensorflow as tf # -------------------------------------------- # create dataset from path pattern # -------------------------------------------- def create_dataset_from_path(path_pattern, batch_size=32, image_size=(60, 120), label_prefix='labels', grayscale=False): # load image and convert to grayscale # create path dataset # by default, `tf.data.Dataset.list_files` gets filenames # in a non-deterministic random shuffled order return tf.data.Dataset.list_files(path_pattern).map( lambda image_path: _parse_path_function(image_path, image_size, label_prefix, grayscale) ).batch(batch_size) def _parse_path_function(path, image_size, label_prefix, grayscale): '''parse image data and labels from path''' raw_image = open(path, 'rb').read() labels = tf.strings.substr(path, -8, 4) # path example: b'xxx\\abcd.jpg' # decode image array and labels image_data = _decode_image(raw_image, image_size, grayscale) dict_labels = _decode_labels(labels, label_prefix) return image_data, dict_labels def _decode_image(image, resize, grayscale): '''preprocess image with given raw data - image: image raw data ''' image = tf.image.decode_jpeg(image, channels=3) # convert to floats in the [0,1] range. image = tf.image.convert_image_dtype(image, tf.float32) image = tf.image.resize(image, resize) # RGB to grayscale -> channels=1 if grayscale: image = tf.image.rgb_to_grayscale(image) # shape=(h, w, 1) return image # (h, w, c) def _decode_labels(labels, prefix): ''' this function is used within dataset.map(), where eager execution is disables by default: check tf.executing_eagerly() returns False. So any Tensor.numpy() is not allowed in this function. ''' dict_labels = {} for i in range(4): c = tf.strings.substr(labels, i, 1) # labels example: b'abcd' label = tf.strings.unicode_decode(c, input_encoding='utf-8') - ord('a') dict_labels[f'{prefix}{i}'] = label return dict_labels \u81f3\u6b64\u53ef\u4ee5\u5c06\u6574\u4e2a\u6587\u4ef6\u5939\u7684\u56fe\u7247\u5582\u7ed9\u6a21\u578b\u8bad\u7ec3\u4e86\uff0c\u4f46\u662f\u6570\u5341\u4e07\u5f20\u56fe\u7247\u65e2\u4e0d\u65b9\u4fbf\u4f20\u8f93\u3001\u9891\u7e41\u8bfb\u6587\u4ef6\u64cd\u4f5c\u4e5f\u5f71\u54cd\u6027\u80fd\uff0c\u56e0\u6b64\u4e0b\u7bc7\u5c06\u6240\u6709\u6570\u636e\u5199\u5165 TFRecord \u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528 tf.data.TFRecordDataset \u5bfc\u5165\u3002 tf.data.Dataset \u21a9 \u21a9 \u21a9 Load Images using tf.data \u21a9 Models with multiple inputs and outputs \u21a9","title":"\u4ee3\u7801\u6c47\u603b"},{"location":"2020-02-28-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.TFRecordDataset/","text":"TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-02-28 | \u5206\u7c7b\uff1a machine learning \u524d\u6587\u4f7f\u7528 tf.data.Dataset.list_files \u521b\u5efa\u6587\u4ef6\u8def\u5f84 Dataset \u5e76\u9010\u6b65\u8f7d\u5165\u56fe\u7247\u6570\u636e\u7684\u65b9\u5f0f\u89e3\u51b3\u65e0\u6cd5\u4e00\u6b21\u6027\u52a0\u8f7d\u6240\u6709\u56fe\u7247\u6570\u636e\u5230\u5185\u5b58\u7684\u95ee\u9898\uff0c\u4f46\u4f9d\u7136\u5b58\u5728\u9891\u7e41\u8bfb\u6587\u4ef6\u7684\u95ee\u9898\u3002\u672c\u6587\u53c2\u8003TensorFlow\u5b98\u65b9\u6587\u6863\u8bfb\u5199\u56fe\u7247\u4f8b\u5b50 1 \uff0c\u5c06\u539f\u6765\u7684\u56fe\u7247\u6570\u636e\u4ee5 TFRecord \u6587\u4ef6\u5f62\u5f0f\u8fdb\u884c\u5b58\u50a8\uff0c\u5e76\u91cd\u65b0\u8f7d\u5165 Dataset \u548c\u89e3\u6790\u6570\u636e\u3002 \u57fa\u672c\u6d41\u7a0b \u00b6 TFRecord \u662f\u4e00\u79cd\u5b58\u50a8\u4e8c\u8fdb\u5236\u8bb0\u5f55\u5e8f\u5217\u7684\u7b80\u5355\u683c\u5f0f\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u8fdb\u884c \u7ebf\u6027\u8bfb\u53d6 \u6570\u636e\u3002\u4ece\u521b\u5efa\u5230\u4f7f\u7528 TFRecord \u6587\u4ef6\u7684\u5168\u6d41\u7a0b\uff1a \u83b7\u53d6\u6e90\u6570\u636e \u5199\u5165 TFRecord \u6587\u4ef6 \u8bfb\u53d6\u548c\u89e3\u6790 TFRecord \u6587\u4ef6 \u672c\u6587\u4fa7\u91cd\u70b9\u5728\u83b7\u53d6\u6e90\u6570\u636e\u548c\u62c6\u5206\u8bad\u7ec3/\u6d4b\u8bd5\u6570\u636e\u96c6\uff0c\u8bfb\u5199 TFRecord \u5219\u76f4\u63a5\u53c2\u8003\u5b98\u65b9\u793a\u4f8b 1 \u7684\u6807\u51c6\u6d41\u7a0b\u3002 \u62c6\u5206\u6570\u636e\u96c6 \u00b6 \u4e60\u60ef\u4f1a\u6309\u7167\u4e00\u5b9a\u6bd4\u4f8b\uff0c\u4f8b\u59829:1\u62c6\u5206\u4e3a\u8bad\u7ec3\u548c\u6d4b\u8bd5\u96c6\u3002 Dataset \u7684 take \u3001 skip \u3001 shard \u65b9\u6cd5\u53ef\u4ee5\u7528\u4e8e\u8fd9\u4e2a\u4efb\u52a1\uff0c\u4f46\u662f\u6216\u591a\u6216\u5c11\u5b58\u5728\u4e00\u4e9b\u4e0d\u8db3\uff1a take \u548c skip \u7ec4\u5408\u6700\u4e3a\u76f4\u63a5\uff0c\u4f46\u662f\u9700\u8981\u77e5\u9053\u6570\u636e\u96c6\u5927\u5c0f shard \u53ef\u4ee5\u6309\u95f4\u9694\u6311\u51fa\u4e00\u4e2a\u5b50\u96c6\uff0c\u4f46\u662f\u65e0\u6cd5\u5f97\u5230\u5269\u4e0b\u7684\u90e8\u5206 \u63d0\u793a take \u548c skip \u9700\u8981\u5728 shuffle \u4e4b\u524d\u6216\u8005\u8bbe\u7f6e shuffle \u7684 reshuffle_each_iteration=False \u3002\u5426\u5219\u4e0d\u540c\u7684\u5faa\u73af\u4e2d\uff0c\u539f\u6765\u7684 Dataset \u5df2\u7ecf\u6539\u53d8\u987a\u5e8f\u4e86\uff0c\u90a3\u4e48\u7531\u6b64\u5f97\u5230\u7684 take \u548c skip \u4f1a\u51fa\u73b0\u91cd\u53e0\u5143\u7d20\u3002 \u4ee5\u4e0b\u53c2\u8003\u601d\u8def 2 \uff1a enumerate \u5f97\u5230\u5143\u7d20\u7684\u5e8f\u53f7\u7ec4\u5408 (index, element) filter \u7b5b\u9009\u5e8f\u53f7\uff0c\u5229\u7528\u4e24\u4e2a\u76f8\u53cd\u7684\u5224\u65ad\u62c6\u5206\u4e3a\u8bad\u7ec3/\u6d4b\u8bd5\u4e24\u7ec4\uff08\u6b64\u65f6\u5143\u7d20\u4e3a (index, element) \uff09 map \u5206\u522b\u4ece\u62c6\u5206\u7684\u4e24\u7ec4\u4e2d\u53bb\u6389\u8f85\u52a9\u4f5c\u7528\u7684\u5e8f\u53f7 def _split_train_test(file_pattern, test_rate, buffer_size): # by default, tf.data.Dataset.list_files always shuffles order during iteration # so set it false explicitly dataset = tf.data.Dataset.list_files(file_pattern, shuffle=False) # shuffle first and stop shuffling during each iteration # buffer_size is reccommanded to be larger than dataset size dataset = dataset.shuffle(buffer_size, reshuffle_each_iteration=False) # split train / test sets if test_rate: # define split interval sep = int(1.0/test_rate) is_test = lambda x, y: x % sep == 0 is_train = lambda x, y: not is_test(x, y) recover = lambda x,y: y # split train/test set, and reset buffle mode: # keep shuffle order different during iteration test_dataset = dataset.enumerate(start=1).filter(is_test).map(recover) train_dataset = dataset.enumerate(start=1).filter(is_train).map(recover) else: test_dataset, test_dataset = dataset, None return train_dataset, test_dataset \u5199\u5165 TFRecord \u6587\u4ef6 \u00b6 \u57fa\u672c\u5957\u8def\uff1a \u51c6\u5907 tf.train.Example \u683c\u5f0f\u6570\u636e 3 \uff0c\u7c7b\u4f3c\u4e8e\u5b57\u5178 {\"string\": tf.train.Feature} \u3002 \u5176\u4e2d tf.train.Feature \u5b58\u50a8\u5177\u4f53\u6570\u636e\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u7684\u56fe\u7247\u4e8c\u8fdb\u5236\u5b57\u8282\u548c\u9a8c\u8bc1\u7801\u5b57\u7b26\u4e32\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u662f\u6570\u5b57\u683c\u5f0f\u7684\u56fe\u7247\u5bbd\u5ea6\u3001\u56fe\u7247\u9ad8\u5ea6\u7b49\u3002 def _image_example(path): \"\"\"Create a dictionary with features: image raw data, label path: image path, e.g. b'test\\\\lcrh.jpg '\"\"\" # get image raw data and labels image_string = open(path, 'rb').read() image_labels = tf.strings.substr(path, -8, 4) # preparation for tf.train.Example feature = { 'labels' : tf.train.Feature(bytes_list=tf.train.BytesList(value=[image_labels.numpy()])), 'image_raw': tf.train.Feature(bytes_list=tf.train.BytesList(value=[image_string])) } return tf.train.Example(features=tf.train.Features(feature=feature)) tf.io.TFRecordWriter \u5c06 tf.train.Example \u5e8f\u5217\u5316\u7684\u503c\u5199\u5165\u6587\u4ef6 # -------------------------------------------- # Write raw image data to `images.tfrecords` # -------------------------------------------- def write_images_to_tfrecord(image_file_pattern, # e.g. 'samples/*.jpg' dir_record, # folder for storing TFRecord files prefix_record='sample', split_test=0.1, # split train/test rate buffer_size=10000): ''' load images and save to TFRecord file - get image raw data and labels (filename) - split into train / test sets - write to TFRecord file ''' # split path dataset train_dataset, test_dataset = _split_train_test(image_file_pattern, split_test, buffer_size) # read image in train set and save to TFRecord file train_record = os.path.join(dir_record, f'{prefix_record}_train.tfrecords') with tf.io.TFRecordWriter(train_record) as writer: for path in train_dataset.as_numpy_iterator(): tf_example = _image_example(path) writer.write(tf_example.SerializeToString()) # read image in test set and save to TFRecord file if test_dataset: test_record = os.path.join(dir_record, f'{prefix_record}_test.tfrecords') with tf.io.TFRecordWriter(test_record) as writer: for path in test_dataset.as_numpy_iterator(): tf_example = _image_example(path) writer.write(tf_example.SerializeToString()) else: test_record = None return train_record, test_record \u8bfb\u53d6 TFRecord \u6587\u4ef6 \u00b6 \u8bfb\u5165 TFRecord \u6587\u4ef6\u5f97\u5230 tf.data.TFRecordDataset \u5bf9\u8c61\uff0c\u7ee7\u627f\u81ea tf.data.Dataset \u3002 \u8fdb\u800c\u53ef\u4ee5\u8fdb\u884c map \u3001 shuffle \u3001 batch \u7b49\u94fe\u5f0f\u64cd\u4f5c\u3002 # -------------------------------------------- # create dataset from TFRecord file # -------------------------------------------- def create_dataset_from_tfrecord(record_file, batch_size=32, image_size=(60, 120), label_prefix='labels', buffer_size=10000, grayscale=False): # load image and convert to grayscale '''create image/labels dataset from TFRecord file''' return tf.data.TFRecordDataset(record_file).map( lambda example_proto: _parse_image_function(example_proto, image_size, label_prefix, grayscale), num_parallel_calls=tf.data.experimental.AUTOTUNE # -1 any available CPUs ).shuffle(buffer_size).batch(batch_size) TFRecordDataset \u4e2d\u7684\u5143\u7d20\u662f\u5e8f\u5217\u5316\u540e\u7684 tf.train.Example \uff0c\u914d\u5408 tf.io.parse_single_example \u8fdb\u884c\u89e3\u6790\u3002 \u4e0a\u9762\u4ee3\u7801\u5757\u4e2d\u7684 _parse_image_function \u5373\u5bf9\u5176\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u5b58\u50a8\u5176\u4e2d\u7684\u56fe\u7247\u4e8c\u8fdb\u5236\u6587\u4ef6\u6d41\u53ca\u9a8c\u8bc1\u7801\u5b57\u7b26\u4e32 Tensor \u3002 def _parse_image_function(example_proto, image_size, label_prefix, grayscale): '''Parse the input tf.Example protocal using the dictionary describing the features''' image_feature_description = { 'labels' : tf.io.FixedLenFeature([], tf.string), 'image_raw': tf.io.FixedLenFeature([], tf.string) } image_features = tf.io.parse_single_example(example_proto, image_feature_description) # decode image array and labels image_data = _decode_image(image_features['image_raw'], image_size, grayscale) dict_labels = _decode_labels(image_features['labels'], label_prefix) return image_data, dict_labels \u6700\u540e\u8f6c\u6362\u56fe\u7247\u4e8c\u8fdb\u5236\u7801\u4e3a RGB \u6570\u636e\u3001\u8f6c\u6362\u9a8c\u8bc1\u7801\u5404\u4e2a\u5b57\u7b26\u4e3a\u76f8\u5e94\u6570\u5b57\u7f16\u7801\uff0c\u4f5c\u4e3a\u6a21\u578b\u8bad\u7ec3\u7684\u6570\u636e\u3002 def _decode_image(image, resize, grayscale): '''preprocess image with given raw data - image: image raw data ''' image = tf.image.decode_jpeg(image, channels=3) # convert to floats in the [0,1] range. image = tf.image.convert_image_dtype(image, tf.float32) image = tf.image.resize(image, resize) # RGB to grayscale -> channels=1 if grayscale: image = tf.image.rgb_to_grayscale(image) # shape=(h, w, 1) return image # (h, w, c) def _decode_labels(labels, prefix): ''' this function is used within dataset.map(), where eager execution is disables by default: check tf.executing_eagerly() returns False. So any Tensor.numpy() is not allowed in this function. ''' dict_labels = {} for i in range(4): c = tf.strings.substr(labels, i, 1) # labels example: b'abcd' label = tf.strings.unicode_decode(c, input_encoding='utf-8') - ord('a') dict_labels[f'{prefix}{i}'] = label return dict_labels Walkthrough: Reading and writing image data \u21a9 \u21a9 How do I split Tensorflow datasets? \u21a9 Data types for tf.Example \u21a9","title":"TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset"},{"location":"2020-02-28-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.TFRecordDataset/#tensorflowtfdatatfrecorddataset","text":"\u53d1\u5e03\u4e8e\uff1a2020-02-28 | \u5206\u7c7b\uff1a machine learning \u524d\u6587\u4f7f\u7528 tf.data.Dataset.list_files \u521b\u5efa\u6587\u4ef6\u8def\u5f84 Dataset \u5e76\u9010\u6b65\u8f7d\u5165\u56fe\u7247\u6570\u636e\u7684\u65b9\u5f0f\u89e3\u51b3\u65e0\u6cd5\u4e00\u6b21\u6027\u52a0\u8f7d\u6240\u6709\u56fe\u7247\u6570\u636e\u5230\u5185\u5b58\u7684\u95ee\u9898\uff0c\u4f46\u4f9d\u7136\u5b58\u5728\u9891\u7e41\u8bfb\u6587\u4ef6\u7684\u95ee\u9898\u3002\u672c\u6587\u53c2\u8003TensorFlow\u5b98\u65b9\u6587\u6863\u8bfb\u5199\u56fe\u7247\u4f8b\u5b50 1 \uff0c\u5c06\u539f\u6765\u7684\u56fe\u7247\u6570\u636e\u4ee5 TFRecord \u6587\u4ef6\u5f62\u5f0f\u8fdb\u884c\u5b58\u50a8\uff0c\u5e76\u91cd\u65b0\u8f7d\u5165 Dataset \u548c\u89e3\u6790\u6570\u636e\u3002","title":"TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset"},{"location":"2020-02-28-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.TFRecordDataset/#_1","text":"TFRecord \u662f\u4e00\u79cd\u5b58\u50a8\u4e8c\u8fdb\u5236\u8bb0\u5f55\u5e8f\u5217\u7684\u7b80\u5355\u683c\u5f0f\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u8fdb\u884c \u7ebf\u6027\u8bfb\u53d6 \u6570\u636e\u3002\u4ece\u521b\u5efa\u5230\u4f7f\u7528 TFRecord \u6587\u4ef6\u7684\u5168\u6d41\u7a0b\uff1a \u83b7\u53d6\u6e90\u6570\u636e \u5199\u5165 TFRecord \u6587\u4ef6 \u8bfb\u53d6\u548c\u89e3\u6790 TFRecord \u6587\u4ef6 \u672c\u6587\u4fa7\u91cd\u70b9\u5728\u83b7\u53d6\u6e90\u6570\u636e\u548c\u62c6\u5206\u8bad\u7ec3/\u6d4b\u8bd5\u6570\u636e\u96c6\uff0c\u8bfb\u5199 TFRecord \u5219\u76f4\u63a5\u53c2\u8003\u5b98\u65b9\u793a\u4f8b 1 \u7684\u6807\u51c6\u6d41\u7a0b\u3002","title":"\u57fa\u672c\u6d41\u7a0b"},{"location":"2020-02-28-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.TFRecordDataset/#_2","text":"\u4e60\u60ef\u4f1a\u6309\u7167\u4e00\u5b9a\u6bd4\u4f8b\uff0c\u4f8b\u59829:1\u62c6\u5206\u4e3a\u8bad\u7ec3\u548c\u6d4b\u8bd5\u96c6\u3002 Dataset \u7684 take \u3001 skip \u3001 shard \u65b9\u6cd5\u53ef\u4ee5\u7528\u4e8e\u8fd9\u4e2a\u4efb\u52a1\uff0c\u4f46\u662f\u6216\u591a\u6216\u5c11\u5b58\u5728\u4e00\u4e9b\u4e0d\u8db3\uff1a take \u548c skip \u7ec4\u5408\u6700\u4e3a\u76f4\u63a5\uff0c\u4f46\u662f\u9700\u8981\u77e5\u9053\u6570\u636e\u96c6\u5927\u5c0f shard \u53ef\u4ee5\u6309\u95f4\u9694\u6311\u51fa\u4e00\u4e2a\u5b50\u96c6\uff0c\u4f46\u662f\u65e0\u6cd5\u5f97\u5230\u5269\u4e0b\u7684\u90e8\u5206 \u63d0\u793a take \u548c skip \u9700\u8981\u5728 shuffle \u4e4b\u524d\u6216\u8005\u8bbe\u7f6e shuffle \u7684 reshuffle_each_iteration=False \u3002\u5426\u5219\u4e0d\u540c\u7684\u5faa\u73af\u4e2d\uff0c\u539f\u6765\u7684 Dataset \u5df2\u7ecf\u6539\u53d8\u987a\u5e8f\u4e86\uff0c\u90a3\u4e48\u7531\u6b64\u5f97\u5230\u7684 take \u548c skip \u4f1a\u51fa\u73b0\u91cd\u53e0\u5143\u7d20\u3002 \u4ee5\u4e0b\u53c2\u8003\u601d\u8def 2 \uff1a enumerate \u5f97\u5230\u5143\u7d20\u7684\u5e8f\u53f7\u7ec4\u5408 (index, element) filter \u7b5b\u9009\u5e8f\u53f7\uff0c\u5229\u7528\u4e24\u4e2a\u76f8\u53cd\u7684\u5224\u65ad\u62c6\u5206\u4e3a\u8bad\u7ec3/\u6d4b\u8bd5\u4e24\u7ec4\uff08\u6b64\u65f6\u5143\u7d20\u4e3a (index, element) \uff09 map \u5206\u522b\u4ece\u62c6\u5206\u7684\u4e24\u7ec4\u4e2d\u53bb\u6389\u8f85\u52a9\u4f5c\u7528\u7684\u5e8f\u53f7 def _split_train_test(file_pattern, test_rate, buffer_size): # by default, tf.data.Dataset.list_files always shuffles order during iteration # so set it false explicitly dataset = tf.data.Dataset.list_files(file_pattern, shuffle=False) # shuffle first and stop shuffling during each iteration # buffer_size is reccommanded to be larger than dataset size dataset = dataset.shuffle(buffer_size, reshuffle_each_iteration=False) # split train / test sets if test_rate: # define split interval sep = int(1.0/test_rate) is_test = lambda x, y: x % sep == 0 is_train = lambda x, y: not is_test(x, y) recover = lambda x,y: y # split train/test set, and reset buffle mode: # keep shuffle order different during iteration test_dataset = dataset.enumerate(start=1).filter(is_test).map(recover) train_dataset = dataset.enumerate(start=1).filter(is_train).map(recover) else: test_dataset, test_dataset = dataset, None return train_dataset, test_dataset","title":"\u62c6\u5206\u6570\u636e\u96c6"},{"location":"2020-02-28-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.TFRecordDataset/#tfrecord","text":"\u57fa\u672c\u5957\u8def\uff1a \u51c6\u5907 tf.train.Example \u683c\u5f0f\u6570\u636e 3 \uff0c\u7c7b\u4f3c\u4e8e\u5b57\u5178 {\"string\": tf.train.Feature} \u3002 \u5176\u4e2d tf.train.Feature \u5b58\u50a8\u5177\u4f53\u6570\u636e\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u7684\u56fe\u7247\u4e8c\u8fdb\u5236\u5b57\u8282\u548c\u9a8c\u8bc1\u7801\u5b57\u7b26\u4e32\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u662f\u6570\u5b57\u683c\u5f0f\u7684\u56fe\u7247\u5bbd\u5ea6\u3001\u56fe\u7247\u9ad8\u5ea6\u7b49\u3002 def _image_example(path): \"\"\"Create a dictionary with features: image raw data, label path: image path, e.g. b'test\\\\lcrh.jpg '\"\"\" # get image raw data and labels image_string = open(path, 'rb').read() image_labels = tf.strings.substr(path, -8, 4) # preparation for tf.train.Example feature = { 'labels' : tf.train.Feature(bytes_list=tf.train.BytesList(value=[image_labels.numpy()])), 'image_raw': tf.train.Feature(bytes_list=tf.train.BytesList(value=[image_string])) } return tf.train.Example(features=tf.train.Features(feature=feature)) tf.io.TFRecordWriter \u5c06 tf.train.Example \u5e8f\u5217\u5316\u7684\u503c\u5199\u5165\u6587\u4ef6 # -------------------------------------------- # Write raw image data to `images.tfrecords` # -------------------------------------------- def write_images_to_tfrecord(image_file_pattern, # e.g. 'samples/*.jpg' dir_record, # folder for storing TFRecord files prefix_record='sample', split_test=0.1, # split train/test rate buffer_size=10000): ''' load images and save to TFRecord file - get image raw data and labels (filename) - split into train / test sets - write to TFRecord file ''' # split path dataset train_dataset, test_dataset = _split_train_test(image_file_pattern, split_test, buffer_size) # read image in train set and save to TFRecord file train_record = os.path.join(dir_record, f'{prefix_record}_train.tfrecords') with tf.io.TFRecordWriter(train_record) as writer: for path in train_dataset.as_numpy_iterator(): tf_example = _image_example(path) writer.write(tf_example.SerializeToString()) # read image in test set and save to TFRecord file if test_dataset: test_record = os.path.join(dir_record, f'{prefix_record}_test.tfrecords') with tf.io.TFRecordWriter(test_record) as writer: for path in test_dataset.as_numpy_iterator(): tf_example = _image_example(path) writer.write(tf_example.SerializeToString()) else: test_record = None return train_record, test_record","title":"\u5199\u5165TFRecord \u6587\u4ef6"},{"location":"2020-02-28-TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Atf.data.TFRecordDataset/#tfrecord_1","text":"\u8bfb\u5165 TFRecord \u6587\u4ef6\u5f97\u5230 tf.data.TFRecordDataset \u5bf9\u8c61\uff0c\u7ee7\u627f\u81ea tf.data.Dataset \u3002 \u8fdb\u800c\u53ef\u4ee5\u8fdb\u884c map \u3001 shuffle \u3001 batch \u7b49\u94fe\u5f0f\u64cd\u4f5c\u3002 # -------------------------------------------- # create dataset from TFRecord file # -------------------------------------------- def create_dataset_from_tfrecord(record_file, batch_size=32, image_size=(60, 120), label_prefix='labels', buffer_size=10000, grayscale=False): # load image and convert to grayscale '''create image/labels dataset from TFRecord file''' return tf.data.TFRecordDataset(record_file).map( lambda example_proto: _parse_image_function(example_proto, image_size, label_prefix, grayscale), num_parallel_calls=tf.data.experimental.AUTOTUNE # -1 any available CPUs ).shuffle(buffer_size).batch(batch_size) TFRecordDataset \u4e2d\u7684\u5143\u7d20\u662f\u5e8f\u5217\u5316\u540e\u7684 tf.train.Example \uff0c\u914d\u5408 tf.io.parse_single_example \u8fdb\u884c\u89e3\u6790\u3002 \u4e0a\u9762\u4ee3\u7801\u5757\u4e2d\u7684 _parse_image_function \u5373\u5bf9\u5176\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u5b58\u50a8\u5176\u4e2d\u7684\u56fe\u7247\u4e8c\u8fdb\u5236\u6587\u4ef6\u6d41\u53ca\u9a8c\u8bc1\u7801\u5b57\u7b26\u4e32 Tensor \u3002 def _parse_image_function(example_proto, image_size, label_prefix, grayscale): '''Parse the input tf.Example protocal using the dictionary describing the features''' image_feature_description = { 'labels' : tf.io.FixedLenFeature([], tf.string), 'image_raw': tf.io.FixedLenFeature([], tf.string) } image_features = tf.io.parse_single_example(example_proto, image_feature_description) # decode image array and labels image_data = _decode_image(image_features['image_raw'], image_size, grayscale) dict_labels = _decode_labels(image_features['labels'], label_prefix) return image_data, dict_labels \u6700\u540e\u8f6c\u6362\u56fe\u7247\u4e8c\u8fdb\u5236\u7801\u4e3a RGB \u6570\u636e\u3001\u8f6c\u6362\u9a8c\u8bc1\u7801\u5404\u4e2a\u5b57\u7b26\u4e3a\u76f8\u5e94\u6570\u5b57\u7f16\u7801\uff0c\u4f5c\u4e3a\u6a21\u578b\u8bad\u7ec3\u7684\u6570\u636e\u3002 def _decode_image(image, resize, grayscale): '''preprocess image with given raw data - image: image raw data ''' image = tf.image.decode_jpeg(image, channels=3) # convert to floats in the [0,1] range. image = tf.image.convert_image_dtype(image, tf.float32) image = tf.image.resize(image, resize) # RGB to grayscale -> channels=1 if grayscale: image = tf.image.rgb_to_grayscale(image) # shape=(h, w, 1) return image # (h, w, c) def _decode_labels(labels, prefix): ''' this function is used within dataset.map(), where eager execution is disables by default: check tf.executing_eagerly() returns False. So any Tensor.numpy() is not allowed in this function. ''' dict_labels = {} for i in range(4): c = tf.strings.substr(labels, i, 1) # labels example: b'abcd' label = tf.strings.unicode_decode(c, input_encoding='utf-8') - ord('a') dict_labels[f'{prefix}{i}'] = label return dict_labels Walkthrough: Reading and writing image data \u21a9 \u21a9 How do I split Tensorflow datasets? \u21a9 Data types for tf.Example \u21a9","title":"\u8bfb\u53d6TFRecord\u6587\u4ef6"},{"location":"2020-03-01-%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92%EF%BC%9ATensorFlow%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98/","text":"\u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-03-01 | \u5206\u7c7b\uff1a machine learning , feeling \u6625\u8282\u5047\u671f\u51c6\u5907\u6d88\u5316\u4e00\u4e0b\u51e0\u5e74\u524d\u5c6f\u7684\u4e66\uff0c\u4e8e\u662f\u968f\u624b\u6311\u4e86\u4e00\u672c\u300aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218\u300b\u3002\u6309\u7167\u60ef\u4f8b\uff0c\u5e94\u8be5\u662f\u5b8c\u4e0d\u6210\u7684\uff1b\u672a\u6599\u51a0\u72b6\u75c5\u6bd2\u75ab\u60c5\u610f\u5916\u5ef6\u957f\u4e86\u5047\u671f\uff0c\u7adf\u5f97\u4ee5\u56eb\u56f5\u770b\u5b8c\u4e86\u3002\u5c0f\u5c0f\u6fc0\u52b1\u4e4b\u4e0b\uff0c\u9ed8\u9ed8\u542f\u52a82020\u5e74\u8bfb\u4e66\u8ba1\u5212\u2014\u2014\u5b8c\u621010\u672c\u6280\u672f\u4e66\u7c4d\u7684\u9605\u8bfb\u548c\u5b66\u4e60\u3002\u6b64\u4e3a\u7b2c\u4e00\u7bc7\u3002 \u6211\u5e76\u4e0d\u6253\u7b97\u4ee5\u7ae0\u8282\u7b14\u8bb0\u7684\u5f62\u5f0f\u6765\u603b\u7ed3\u6bcf\u672c\u4e66\u7684\u9605\u8bfb\uff0c\u4e00\u65b9\u9762\u61d2\u4e8e\u6458\u6284\u3001\u7167\u642c\u4e66\u4e0a\u77e5\u8bc6\u70b9\uff0c\u53e6\u4e00\u65b9\u9762\u66f4\u4e60\u60ef\u76f4\u63a5\u5c06\u6ce8\u89e3\u3001\u601d\u8003\u8bb0\u5f55\u5728\u4e66\u7c4d\u76f8\u5e94\u9875\u9762\u4e0a\u3002\u6240\u4ee5\uff0c\u8fd9\u4e2a\u7cfb\u5217\u66f4\u591a\u7684\u662f\u8bfb\u540e\u611f\uff0c\u5305\u542b\u4ee5\u4e0b\u4e24\u90e8\u5206\uff1a \u8bfb\u540e\u611f \u5168\u4e66\u5b8f\u89c2\u8bc4\u4ef7 \u6545\u4e8b\u6897\u6982 \u5408\u4e0a\u4e66\u540e\u634b\u4e00\u904d\u4ee5\u53ca\u6b64\u8fc7\u7a0b\u4e2d\u5370\u8c61\u6df1\u523b\u7684\u70b9 \u8bfb\u540e\u611f \u00b6 \u4e00\u8a00\u4ee5\u853d\u4e4b\uff1a\u5185\u5bb9\u4e30\u5bcc\u4f46\u6d41\u4e8e\u8868\u9762\uff0c\u4e0d\u9002\u5408\u65b0\u624b\u5165\u95e8\uff0c\u4e0d\u9002\u5408\u8001\u624b\u6df1\u5165\u3002\u5f53\u65f6\u770b\u5f97\u4e00\u5934\u96fe\u6c34\u4f53\u9a8c\u53ca\u5176\u4e0d\u4f73\uff0c\u597d\u5728\u5185\u5bb9\u5c1a\u4e14\u5168\u9762\uff0c\u5e76\u8f85\u4ee5\u5176\u4ed6\u5728\u7ebf\u8d44\u6e90\u7684\u89e3\u60d1\uff0c\u7adf\u4e5f\u5e26\u6211\u5165\u4e86\u95e8\u3002 \u5168\u4e66\u5206\u4e3a\u57fa\u7840\uff08TF\u57fa\u7840\uff0cCNN/RNN\u57fa\u7840\uff09\u3001\u5b9e\u6218\uff08\u4eba\u8138\u8bc6\u522b\u3001\u81ea\u7136\u8bed\u8a00\u5904\u7406\u3001\u8bed\u97f3\u8bc6\u522b\u3001\u5bf9\u6297\u7f51\u7edc\uff09\u3001\u63d0\u9ad8\uff08\u5206\u5e03\u5f0f\u3001\u5927\u6570\u636e\u3001\u79fb\u52a8\u7aef\uff09\u4e09\u7bc7\uff0c\u6d89\u53ca\u5185\u5bb9\u751a\u5e7f\u5374\u4ec5\u4ec5300\u4f59\u9875\u3002\u5185\u5bb9\u4e30\u5bcc\u4f46\u6d41\u4e8e\u8868\u9762\uff0c\u7531\u6b64\u53ef\u89c1\u4e00\u6591\u3002\u8bfb\u5b8c\u4e4b\u540e\u5370\u8c61\u6bd4\u8f83\u6df1\u7684\u51e0\u70b9\uff1a \u7ed3\u6784\u62fc\u51d1\uff0c\u6ca1\u6709\u4f5c\u8005\u7684\u4f53\u609f\u548c\u89e3\u8bfb\u3002\u5f88\u591a\u57fa\u7840\u77e5\u8bc6\u70b9\u4f8b\u5982\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u3001\u5377\u79ef\u7f51\u7edc\u9700\u8981\u8bfb\u8005\u81ea\u884c\u67e5\u8be2\u8be6\u7ec6\u8d44\u6599\u3002 \u4ee3\u7801\u5806\u780c\uff0c\u5927\u91cf\u4ee3\u7801\u6269\u5145\u7bc7\u5e45\u5374\u6ca1\u6709\u76f8\u5e94\u7684\u89e3\u8bfb\u3002 \u6821\u8ba2\u4e0d\u4e25\u8c28\uff0c\u5b58\u5728\u8f83\u591a\u9519\u522b\u5b57\u3001\u9519\u8bef\u4ee3\u7801\u3001\u9519\u8bef\u56fe\u6ce8\u3002 \u5ba2\u89c2\u6765\u8bf4\uff0c\u5e76\u4e0d\u63a8\u8350\u6b64\u4e66\u4f5c\u4e3aTensorFlow\u6216\u8005\u6df1\u5ea6\u5b66\u4e60\u7684\u5165\u95e8\u4e66\u7c4d\u3002\u5948\u4f55\u6211\u5df2\u7ecf\u4e0a\u4e86\u8fd9\u6761\u8239\uff0c\u53ea\u80fd\u7ed3\u5408\u5b83\u5c1a\u7b97\u4e30\u5bcc\u7684\u76ee\u5f55\u4ee5\u53ca\u81ea\u5df1\u67e5\u9605\u76f8\u5173\u8d44\u6599\u540e\u7684\u6ce8\u89e3\uff0c\u5e0c\u671b\u65e5\u540e\u6709\u7528\u4e4b\u5904\u53ef\u4ee5\u968f\u624b\u4e00\u7ffb\u3002 \u6545\u4e8b\u6897\u6982 \u00b6 TensorFlow\u57fa\u7840 TensorFlow\u7f16\u7a0b\u67b6\u6784 Graph \u548c Session MNIST\u6570\u636e\u96c6\u5b9e\u6218 softmax \u5206\u7c7b CNN RNN \u81ea\u7f16\u7801\u5668 \u5206\u5e03\u5f0f\u8bad\u7ec3 \u8be5\u4e66\u57fa\u4e8eTensorFlow 1.x\uff0c\u6709\u6b64\u57fa\u7840\u53ef\u4ee5\u5f88\u5feb\u8f6c\u5411TensorFlow 2.x \u795e\u7ecf\u7f51\u7edc\u57fa\u7840 \u6fc0\u6d3b\u51fd\u6570\uff1a sigmoid \u3001 tanh \u3001 relu \u7b49 \u5377\u79ef/\u6c60\u5316\u51fd\u6570\uff1a padding \u3001 strikes \u4e0e\u5377\u79ef/\u6c60\u5316\u540e\u5f20\u91cf\u5927\u5c0f\u7684\u8ba1\u7b97 \u5206\u7c7b\u76f8\u5173\u635f\u5931\u51fd\u6570\uff1a\u71b5\uff08\u4fe1\u606f\u91cf\u7684\u671f\u671b\uff09->\u6563\u5ea6\u71b5\uff08\u4e24\u4e2a\u5206\u5e03\u7684\u5dee\u5f02\uff09->\u4ea4\u53c9\u71b5 softmax \u4ea4\u53c9\u71b5 \u591a\u5206\u7c7b\u4e92\u65a5\u95ee\u9898\uff08 one-hot \u7f16\u7801\uff09 binary \u4ea4\u53c9\u71b5 \u4e8c\u5206\u7c7b\u4e92\u65a5\uff0c softmax \u4ea4\u53c9\u71b5\u7684\u7279\u4f8b sigmoid \u4ea4\u53c9\u71b5 \u591a\u5206\u7c7b\u4e0d\u4e92\u65a5\u95ee\u9898\uff0c\u6bcf\u4e2a\u7279\u5f81\u770b\u4f5c\u4e00\u4e2a sigmoid \u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u5404\u4e2a\u7279\u5f81\u4e0d\u4e92\u65a5\u6240\u4ee5\u6700\u7ec8\u591a\u5206\u7c7b \u4f18\u5316\u7b97\u6cd5\uff1a\u68af\u5ea6\u4e0b\u964d\u7b97\u6cd5 BGD \u3001 SGD Momentum adadelta RMSprop adam \u6279\u6807\u51c6\u5316 L1\u3001L2\u6b63\u5219\u5316 \u795e\u7ecf\u7f51\u7edc\u6a21\u578b\u53d1\u5c55 \u5377\u79ef\u795e\u7ecf\u7f51\u7edc CNN LeNet\uff1a\u5377\u79ef\u548c\u6c60\u5316 AlexNet\uff1a relu \u5f15\u5165\u3001\u6570\u636e\u589e\u5f3a\u3001\u5927\u6570\u636eGPU VggNet\uff1a\u6807\u51c6\u5316/\u6a21\u5757\u5316\u5377\u79ef/\u6c60\u5316\u7ec4 Inception\uff1a\u81ea\u884c\u5b66\u4e60\u9009\u62e9\u5377\u79ef\u6838\uff0c\u5e76\u80543x3\uff0c5x5 ResNet\uff1a\u8de8\u5c42\u83b7\u53d6\u8f93\u5165\u4ee5\u907f\u514d\u68af\u5ea6\u6d88\u5931 \u5faa\u73af\u795e\u7ecf\u7f51\u7edc RNN RNN LSTM \u6df1\u5ea6\u5b66\u4e60\u5e94\u7528 \u4eba\u8138\u8bc6\u522b \u81ea\u7136\u8bed\u8a00\u5904\u7406 \u8bed\u97f3\u8bc6\u522b \u751f\u6210\u5bf9\u6297\u7f51\u7edc \u5206\u5e03\u5f0f \u5927\u6570\u636e \u79fb\u52a8\u5e94\u7528","title":"\u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218"},{"location":"2020-03-01-%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92%EF%BC%9ATensorFlow%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98/#tensorflow","text":"\u53d1\u5e03\u4e8e\uff1a2020-03-01 | \u5206\u7c7b\uff1a machine learning , feeling \u6625\u8282\u5047\u671f\u51c6\u5907\u6d88\u5316\u4e00\u4e0b\u51e0\u5e74\u524d\u5c6f\u7684\u4e66\uff0c\u4e8e\u662f\u968f\u624b\u6311\u4e86\u4e00\u672c\u300aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218\u300b\u3002\u6309\u7167\u60ef\u4f8b\uff0c\u5e94\u8be5\u662f\u5b8c\u4e0d\u6210\u7684\uff1b\u672a\u6599\u51a0\u72b6\u75c5\u6bd2\u75ab\u60c5\u610f\u5916\u5ef6\u957f\u4e86\u5047\u671f\uff0c\u7adf\u5f97\u4ee5\u56eb\u56f5\u770b\u5b8c\u4e86\u3002\u5c0f\u5c0f\u6fc0\u52b1\u4e4b\u4e0b\uff0c\u9ed8\u9ed8\u542f\u52a82020\u5e74\u8bfb\u4e66\u8ba1\u5212\u2014\u2014\u5b8c\u621010\u672c\u6280\u672f\u4e66\u7c4d\u7684\u9605\u8bfb\u548c\u5b66\u4e60\u3002\u6b64\u4e3a\u7b2c\u4e00\u7bc7\u3002 \u6211\u5e76\u4e0d\u6253\u7b97\u4ee5\u7ae0\u8282\u7b14\u8bb0\u7684\u5f62\u5f0f\u6765\u603b\u7ed3\u6bcf\u672c\u4e66\u7684\u9605\u8bfb\uff0c\u4e00\u65b9\u9762\u61d2\u4e8e\u6458\u6284\u3001\u7167\u642c\u4e66\u4e0a\u77e5\u8bc6\u70b9\uff0c\u53e6\u4e00\u65b9\u9762\u66f4\u4e60\u60ef\u76f4\u63a5\u5c06\u6ce8\u89e3\u3001\u601d\u8003\u8bb0\u5f55\u5728\u4e66\u7c4d\u76f8\u5e94\u9875\u9762\u4e0a\u3002\u6240\u4ee5\uff0c\u8fd9\u4e2a\u7cfb\u5217\u66f4\u591a\u7684\u662f\u8bfb\u540e\u611f\uff0c\u5305\u542b\u4ee5\u4e0b\u4e24\u90e8\u5206\uff1a \u8bfb\u540e\u611f \u5168\u4e66\u5b8f\u89c2\u8bc4\u4ef7 \u6545\u4e8b\u6897\u6982 \u5408\u4e0a\u4e66\u540e\u634b\u4e00\u904d\u4ee5\u53ca\u6b64\u8fc7\u7a0b\u4e2d\u5370\u8c61\u6df1\u523b\u7684\u70b9","title":"\u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218"},{"location":"2020-03-01-%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92%EF%BC%9ATensorFlow%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98/#_1","text":"\u4e00\u8a00\u4ee5\u853d\u4e4b\uff1a\u5185\u5bb9\u4e30\u5bcc\u4f46\u6d41\u4e8e\u8868\u9762\uff0c\u4e0d\u9002\u5408\u65b0\u624b\u5165\u95e8\uff0c\u4e0d\u9002\u5408\u8001\u624b\u6df1\u5165\u3002\u5f53\u65f6\u770b\u5f97\u4e00\u5934\u96fe\u6c34\u4f53\u9a8c\u53ca\u5176\u4e0d\u4f73\uff0c\u597d\u5728\u5185\u5bb9\u5c1a\u4e14\u5168\u9762\uff0c\u5e76\u8f85\u4ee5\u5176\u4ed6\u5728\u7ebf\u8d44\u6e90\u7684\u89e3\u60d1\uff0c\u7adf\u4e5f\u5e26\u6211\u5165\u4e86\u95e8\u3002 \u5168\u4e66\u5206\u4e3a\u57fa\u7840\uff08TF\u57fa\u7840\uff0cCNN/RNN\u57fa\u7840\uff09\u3001\u5b9e\u6218\uff08\u4eba\u8138\u8bc6\u522b\u3001\u81ea\u7136\u8bed\u8a00\u5904\u7406\u3001\u8bed\u97f3\u8bc6\u522b\u3001\u5bf9\u6297\u7f51\u7edc\uff09\u3001\u63d0\u9ad8\uff08\u5206\u5e03\u5f0f\u3001\u5927\u6570\u636e\u3001\u79fb\u52a8\u7aef\uff09\u4e09\u7bc7\uff0c\u6d89\u53ca\u5185\u5bb9\u751a\u5e7f\u5374\u4ec5\u4ec5300\u4f59\u9875\u3002\u5185\u5bb9\u4e30\u5bcc\u4f46\u6d41\u4e8e\u8868\u9762\uff0c\u7531\u6b64\u53ef\u89c1\u4e00\u6591\u3002\u8bfb\u5b8c\u4e4b\u540e\u5370\u8c61\u6bd4\u8f83\u6df1\u7684\u51e0\u70b9\uff1a \u7ed3\u6784\u62fc\u51d1\uff0c\u6ca1\u6709\u4f5c\u8005\u7684\u4f53\u609f\u548c\u89e3\u8bfb\u3002\u5f88\u591a\u57fa\u7840\u77e5\u8bc6\u70b9\u4f8b\u5982\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u3001\u5377\u79ef\u7f51\u7edc\u9700\u8981\u8bfb\u8005\u81ea\u884c\u67e5\u8be2\u8be6\u7ec6\u8d44\u6599\u3002 \u4ee3\u7801\u5806\u780c\uff0c\u5927\u91cf\u4ee3\u7801\u6269\u5145\u7bc7\u5e45\u5374\u6ca1\u6709\u76f8\u5e94\u7684\u89e3\u8bfb\u3002 \u6821\u8ba2\u4e0d\u4e25\u8c28\uff0c\u5b58\u5728\u8f83\u591a\u9519\u522b\u5b57\u3001\u9519\u8bef\u4ee3\u7801\u3001\u9519\u8bef\u56fe\u6ce8\u3002 \u5ba2\u89c2\u6765\u8bf4\uff0c\u5e76\u4e0d\u63a8\u8350\u6b64\u4e66\u4f5c\u4e3aTensorFlow\u6216\u8005\u6df1\u5ea6\u5b66\u4e60\u7684\u5165\u95e8\u4e66\u7c4d\u3002\u5948\u4f55\u6211\u5df2\u7ecf\u4e0a\u4e86\u8fd9\u6761\u8239\uff0c\u53ea\u80fd\u7ed3\u5408\u5b83\u5c1a\u7b97\u4e30\u5bcc\u7684\u76ee\u5f55\u4ee5\u53ca\u81ea\u5df1\u67e5\u9605\u76f8\u5173\u8d44\u6599\u540e\u7684\u6ce8\u89e3\uff0c\u5e0c\u671b\u65e5\u540e\u6709\u7528\u4e4b\u5904\u53ef\u4ee5\u968f\u624b\u4e00\u7ffb\u3002","title":"\u8bfb\u540e\u611f"},{"location":"2020-03-01-%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92%EF%BC%9ATensorFlow%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98/#_2","text":"TensorFlow\u57fa\u7840 TensorFlow\u7f16\u7a0b\u67b6\u6784 Graph \u548c Session MNIST\u6570\u636e\u96c6\u5b9e\u6218 softmax \u5206\u7c7b CNN RNN \u81ea\u7f16\u7801\u5668 \u5206\u5e03\u5f0f\u8bad\u7ec3 \u8be5\u4e66\u57fa\u4e8eTensorFlow 1.x\uff0c\u6709\u6b64\u57fa\u7840\u53ef\u4ee5\u5f88\u5feb\u8f6c\u5411TensorFlow 2.x \u795e\u7ecf\u7f51\u7edc\u57fa\u7840 \u6fc0\u6d3b\u51fd\u6570\uff1a sigmoid \u3001 tanh \u3001 relu \u7b49 \u5377\u79ef/\u6c60\u5316\u51fd\u6570\uff1a padding \u3001 strikes \u4e0e\u5377\u79ef/\u6c60\u5316\u540e\u5f20\u91cf\u5927\u5c0f\u7684\u8ba1\u7b97 \u5206\u7c7b\u76f8\u5173\u635f\u5931\u51fd\u6570\uff1a\u71b5\uff08\u4fe1\u606f\u91cf\u7684\u671f\u671b\uff09->\u6563\u5ea6\u71b5\uff08\u4e24\u4e2a\u5206\u5e03\u7684\u5dee\u5f02\uff09->\u4ea4\u53c9\u71b5 softmax \u4ea4\u53c9\u71b5 \u591a\u5206\u7c7b\u4e92\u65a5\u95ee\u9898\uff08 one-hot \u7f16\u7801\uff09 binary \u4ea4\u53c9\u71b5 \u4e8c\u5206\u7c7b\u4e92\u65a5\uff0c softmax \u4ea4\u53c9\u71b5\u7684\u7279\u4f8b sigmoid \u4ea4\u53c9\u71b5 \u591a\u5206\u7c7b\u4e0d\u4e92\u65a5\u95ee\u9898\uff0c\u6bcf\u4e2a\u7279\u5f81\u770b\u4f5c\u4e00\u4e2a sigmoid \u4e8c\u5206\u7c7b\u95ee\u9898\uff0c\u5404\u4e2a\u7279\u5f81\u4e0d\u4e92\u65a5\u6240\u4ee5\u6700\u7ec8\u591a\u5206\u7c7b \u4f18\u5316\u7b97\u6cd5\uff1a\u68af\u5ea6\u4e0b\u964d\u7b97\u6cd5 BGD \u3001 SGD Momentum adadelta RMSprop adam \u6279\u6807\u51c6\u5316 L1\u3001L2\u6b63\u5219\u5316 \u795e\u7ecf\u7f51\u7edc\u6a21\u578b\u53d1\u5c55 \u5377\u79ef\u795e\u7ecf\u7f51\u7edc CNN LeNet\uff1a\u5377\u79ef\u548c\u6c60\u5316 AlexNet\uff1a relu \u5f15\u5165\u3001\u6570\u636e\u589e\u5f3a\u3001\u5927\u6570\u636eGPU VggNet\uff1a\u6807\u51c6\u5316/\u6a21\u5757\u5316\u5377\u79ef/\u6c60\u5316\u7ec4 Inception\uff1a\u81ea\u884c\u5b66\u4e60\u9009\u62e9\u5377\u79ef\u6838\uff0c\u5e76\u80543x3\uff0c5x5 ResNet\uff1a\u8de8\u5c42\u83b7\u53d6\u8f93\u5165\u4ee5\u907f\u514d\u68af\u5ea6\u6d88\u5931 \u5faa\u73af\u795e\u7ecf\u7f51\u7edc RNN RNN LSTM \u6df1\u5ea6\u5b66\u4e60\u5e94\u7528 \u4eba\u8138\u8bc6\u522b \u81ea\u7136\u8bed\u8a00\u5904\u7406 \u8bed\u97f3\u8bc6\u522b \u751f\u6210\u5bf9\u6297\u7f51\u7edc \u5206\u5e03\u5f0f \u5927\u6570\u636e \u79fb\u52a8\u5e94\u7528","title":"\u6545\u4e8b\u6897\u6982"},{"location":"2020-07-13-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81/","text":"pdf2docx\u5f00\u53d1\u6982\u8981 \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-07-13 | \u5206\u7c7b\uff1a process automation PDF\u8f6cWord \u662f\u4e00\u4e2a\u53e4\u8001\u7684\u8bdd\u9898\uff0c\u5176\u96be\u70b9\u5728\u4e8e\u5efa\u7acbPDF\u57fa\u4e8e\u5143\u7d20\u4f4d\u7f6e\u7684\u683c\u5f0f\u4e0eWord\u57fa\u4e8e\u5185\u5bb9\u7684\u683c\u5f0f\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u3002 Solid Documents \u662f\u8fd9\u65b9\u9762\u7684\u4f7c\u4f7c\u8005\uff0c\u5176\u6280\u672f\u7684\u5e94\u7528\u6848\u4f8b\uff1a\u5728\u7ebfPDF\u8f6c\u6362\u7f51\u7ad9 Smallpdf \u3002 \u5728\u67d0\u4e2a\u9879\u76ee\u7684\u8c03\u7814\u8fc7\u7a0b\u4e2d\uff0c\u4f5c\u8005\u5c1d\u8bd5\u4e86\u8fd9\u4e2a\u8bdd\u9898\uff0c\u7f16\u5199\u4e86\u4e00\u4e2a\u7528\u4e8e\u8f6c\u6362PDF\u5230Word\u7684Python\u5e93 pdf2docx \u2014\u2014\u501f\u52a9 PyMuPDF \u4ecePDF\u6587\u4ef6\u63d0\u53d6\u5185\u5bb9\uff0c\u57fa\u4e8e\u4f4d\u7f6e\u89c4\u5219\u89e3\u6790\u5185\u5bb9\uff0c\u6700\u540e\u7528 python-docx \u521b\u5efaWord\u6587\u4ef6\u3002 https://github.com/dothinking/pdf2docx \u672c\u6587\u8bb0\u5f55\u4e3b\u8981\u5f00\u53d1\u601d\u8def\uff0c\u5177\u4f53\u7ec6\u8282\u968f\u7740\u7248\u672c\u5347\u7ea7\u53ef\u80fd\u7565\u6709\u5dee\u5f02\u3002 \u601d\u8def \u00b6 PDF\u6587\u4ef6\u9075\u5faa\u4e00\u5b9a\u7684\u683c\u5f0f\u89c4\u8303 1 \uff0cPython\u5e93 PyMuPDF \u63d0\u4f9b\u4e86\u4fbf\u5229\u7684\u89e3\u6790\u51fd\u6570\uff0c\u7528\u4e8e\u83b7\u53d6\u9875\u9762\u5143\u7d20\u4f8b\u5982\u6587\u672c\u548c\u5f62\u72b6\u53ca\u5176\u4f4d\u7f6e\u3002 \u5229\u7528\u5143\u7d20\u95f4\u7684\u76f8\u5bf9\u4f4d\u7f6e\u5173\u7cfb\u63a8\u65ad\u5185\u5bb9\uff0c\u4f8b\u5982\u5c06\u201c\u6a2a\u7eb5\u7ebf\u6761\u56f4\u7ed5\u7740\u6587\u672c\u201d\u89e3\u6790\u4e3a\u201c\u8868\u683c\u201d\uff0c\u5c06\u201c\u6587\u672c\u4e0b\u65b9\u7684\u4e00\u6761\u6a2a\u7ebf\u201d\u89e3\u6790\u4e3a\u201c\u6587\u672c\u4e0b\u5212\u7ebf\u201d\u3002\u8fd9\u5c31\u662f\u672c\u6587\u4e3b\u89d2 pdf2docx \u7684\u4e3b\u8981\u5185\u5bb9\u3002 \u4f7f\u7528Python\u5e93 python-docx \u5c06\u4e0a\u4e00\u6b65\u89e3\u6790\u7684\u5185\u5bb9\u5143\u7d20\u91cd\u5efa\u4e3adocx\u683c\u5f0f\u7684Word\u6587\u6863\u3002 \u4ee5\u4e0a\u6280\u672f\u8def\u7ebf\u4e5f\u51b3\u5b9a\u4e86 pdf2docx \u7684\u5c40\u9650\uff1a \u53ea\u80fd\u5904\u7406\u6807\u51c6\u683c\u5f0f\u7684PDF\uff0c\u4e0d\u652f\u6301\u626b\u63cf\u7248\u3001\u56fe\u7247\u683c\u5f0fPDF\u3002 \u53ea\u80fd\u5904\u7406\u6c34\u5e73\u3001\u7ad6\u76f4\u65b9\u5411\u6587\u672c\uff0c\u5ffd\u7565\u65cb\u8f6c\u89d2\u5ea6\u7684\u6587\u672c\u3002 \u6839\u636e\u6709\u9650\u7684\u3001\u786e\u5b9a\u7684\u89c4\u5219\u5efa\u7acbPDF\u5bfc\u51fa\u5143\u7d20\u4f4d\u7f6e\u4e0edocx\u8981\u6c42\u7684\u5185\u5bb9\u4e4b\u95f4\u7684\u6620\u5c04\u5e76\u975e\u5b8c\u5168\u53ef\u9760\uff0c\u4e5f\u5c31\u662f\u8bf4\u4ec5\u80fd\u5904\u7406\u5e38\u89c1\u7684\u89c4\u8303\u7684\u683c\u5f0f\uff0c\u800c\u975e\u767e\u5206\u767e\u8fd8\u539f\u3002 \u76ee\u5f55 \u00b6 \u4ee5\u4e0b\u5206\u7bc7\u4ecb\u7ecd\u63d0\u53d6PDF\u9875\u9762\u6570\u636e\u3001\u89e3\u6790\u548c\u91cd\u5efadocx\u8fc7\u7a0b\u4e2d\u7684\u5177\u4f53\u7ec6\u8282\uff1a \u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 \u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e \u521b\u5efa\u6d6e\u52a8\u56fe\u7247 \u77e2\u91cf\u56fe\u5904\u7406 \u89e3\u6790\u9875\u9762\u5e03\u5c40 \u89e3\u6790\u8868\u683c \u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf \u89e3\u6790\u6bb5\u843d \u89e3\u6790\u6587\u672c\u6837\u5f0f PDF Reference 1.7 \u21a9","title":"pdf2docx\u5f00\u53d1\u6982\u8981"},{"location":"2020-07-13-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-07-13 | \u5206\u7c7b\uff1a process automation PDF\u8f6cWord \u662f\u4e00\u4e2a\u53e4\u8001\u7684\u8bdd\u9898\uff0c\u5176\u96be\u70b9\u5728\u4e8e\u5efa\u7acbPDF\u57fa\u4e8e\u5143\u7d20\u4f4d\u7f6e\u7684\u683c\u5f0f\u4e0eWord\u57fa\u4e8e\u5185\u5bb9\u7684\u683c\u5f0f\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u3002 Solid Documents \u662f\u8fd9\u65b9\u9762\u7684\u4f7c\u4f7c\u8005\uff0c\u5176\u6280\u672f\u7684\u5e94\u7528\u6848\u4f8b\uff1a\u5728\u7ebfPDF\u8f6c\u6362\u7f51\u7ad9 Smallpdf \u3002 \u5728\u67d0\u4e2a\u9879\u76ee\u7684\u8c03\u7814\u8fc7\u7a0b\u4e2d\uff0c\u4f5c\u8005\u5c1d\u8bd5\u4e86\u8fd9\u4e2a\u8bdd\u9898\uff0c\u7f16\u5199\u4e86\u4e00\u4e2a\u7528\u4e8e\u8f6c\u6362PDF\u5230Word\u7684Python\u5e93 pdf2docx \u2014\u2014\u501f\u52a9 PyMuPDF \u4ecePDF\u6587\u4ef6\u63d0\u53d6\u5185\u5bb9\uff0c\u57fa\u4e8e\u4f4d\u7f6e\u89c4\u5219\u89e3\u6790\u5185\u5bb9\uff0c\u6700\u540e\u7528 python-docx \u521b\u5efaWord\u6587\u4ef6\u3002 https://github.com/dothinking/pdf2docx \u672c\u6587\u8bb0\u5f55\u4e3b\u8981\u5f00\u53d1\u601d\u8def\uff0c\u5177\u4f53\u7ec6\u8282\u968f\u7740\u7248\u672c\u5347\u7ea7\u53ef\u80fd\u7565\u6709\u5dee\u5f02\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981"},{"location":"2020-07-13-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81/#_1","text":"PDF\u6587\u4ef6\u9075\u5faa\u4e00\u5b9a\u7684\u683c\u5f0f\u89c4\u8303 1 \uff0cPython\u5e93 PyMuPDF \u63d0\u4f9b\u4e86\u4fbf\u5229\u7684\u89e3\u6790\u51fd\u6570\uff0c\u7528\u4e8e\u83b7\u53d6\u9875\u9762\u5143\u7d20\u4f8b\u5982\u6587\u672c\u548c\u5f62\u72b6\u53ca\u5176\u4f4d\u7f6e\u3002 \u5229\u7528\u5143\u7d20\u95f4\u7684\u76f8\u5bf9\u4f4d\u7f6e\u5173\u7cfb\u63a8\u65ad\u5185\u5bb9\uff0c\u4f8b\u5982\u5c06\u201c\u6a2a\u7eb5\u7ebf\u6761\u56f4\u7ed5\u7740\u6587\u672c\u201d\u89e3\u6790\u4e3a\u201c\u8868\u683c\u201d\uff0c\u5c06\u201c\u6587\u672c\u4e0b\u65b9\u7684\u4e00\u6761\u6a2a\u7ebf\u201d\u89e3\u6790\u4e3a\u201c\u6587\u672c\u4e0b\u5212\u7ebf\u201d\u3002\u8fd9\u5c31\u662f\u672c\u6587\u4e3b\u89d2 pdf2docx \u7684\u4e3b\u8981\u5185\u5bb9\u3002 \u4f7f\u7528Python\u5e93 python-docx \u5c06\u4e0a\u4e00\u6b65\u89e3\u6790\u7684\u5185\u5bb9\u5143\u7d20\u91cd\u5efa\u4e3adocx\u683c\u5f0f\u7684Word\u6587\u6863\u3002 \u4ee5\u4e0a\u6280\u672f\u8def\u7ebf\u4e5f\u51b3\u5b9a\u4e86 pdf2docx \u7684\u5c40\u9650\uff1a \u53ea\u80fd\u5904\u7406\u6807\u51c6\u683c\u5f0f\u7684PDF\uff0c\u4e0d\u652f\u6301\u626b\u63cf\u7248\u3001\u56fe\u7247\u683c\u5f0fPDF\u3002 \u53ea\u80fd\u5904\u7406\u6c34\u5e73\u3001\u7ad6\u76f4\u65b9\u5411\u6587\u672c\uff0c\u5ffd\u7565\u65cb\u8f6c\u89d2\u5ea6\u7684\u6587\u672c\u3002 \u6839\u636e\u6709\u9650\u7684\u3001\u786e\u5b9a\u7684\u89c4\u5219\u5efa\u7acbPDF\u5bfc\u51fa\u5143\u7d20\u4f4d\u7f6e\u4e0edocx\u8981\u6c42\u7684\u5185\u5bb9\u4e4b\u95f4\u7684\u6620\u5c04\u5e76\u975e\u5b8c\u5168\u53ef\u9760\uff0c\u4e5f\u5c31\u662f\u8bf4\u4ec5\u80fd\u5904\u7406\u5e38\u89c1\u7684\u89c4\u8303\u7684\u683c\u5f0f\uff0c\u800c\u975e\u767e\u5206\u767e\u8fd8\u539f\u3002","title":"\u601d\u8def"},{"location":"2020-07-13-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81/#_2","text":"\u4ee5\u4e0b\u5206\u7bc7\u4ecb\u7ecd\u63d0\u53d6PDF\u9875\u9762\u6570\u636e\u3001\u89e3\u6790\u548c\u91cd\u5efadocx\u8fc7\u7a0b\u4e2d\u7684\u5177\u4f53\u7ec6\u8282\uff1a \u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 \u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e \u521b\u5efa\u6d6e\u52a8\u56fe\u7247 \u77e2\u91cf\u56fe\u5904\u7406 \u89e3\u6790\u9875\u9762\u5e03\u5c40 \u89e3\u6790\u8868\u683c \u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf \u89e3\u6790\u6bb5\u843d \u89e3\u6790\u6587\u672c\u6837\u5f0f PDF Reference 1.7 \u21a9","title":"\u76ee\u5f55"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-07-14 | \u5206\u7c7b\uff1a process automation \u6587\u672c\u3001\u56fe\u7247\u53ca\u5f62\u72b6\u6db5\u76d6\u4e86\u5e38\u89c1\u7684PDF\u5143\u7d20\uff0c\u8fd9\u4e9b\u662f pdf2docx \u7684\u5904\u7406\u5bf9\u8c61\u3002\u672c\u6587\u4ecb\u7ecd\u5229\u7528 PyMuPDF \u63d0\u53d6\u8fd9\u4e9b\u9875\u9762\u5143\u7d20\uff0c\u53ca\u5176\u57fa\u672c\u6570\u636e\u7ed3\u6784\u3002 \u6587\u672c\u4e0e\u56fe\u7247 \u00b6 PyMuPDF \u7684 Textpage \u5bf9\u8c61\u63d0\u4f9b\u7684 extractDICT() \u548c extractRAWDICT() \u7528\u4ee5\u83b7\u53d6\u9875\u9762\u4e2d\u7684\u6240\u6709\u6587\u672c\u548c\u56fe\u7247\uff08\u5185\u5bb9\u3001\u4f4d\u7f6e\u3001\u5c5e\u6027\uff09\uff0c\u57fa\u672c\u6570\u636e\u7ed3\u6784\u5982\u4e0b 1 \uff1a pdf2docx \u7ee7\u7eed\u6cbf\u7528\u4ee5\u4e0a\u6570\u636e\u7ed3\u6784\uff0c\u5e76\u7a0d\u4f5c\u6539\u52a8\uff0c\u4f5c\u4e3a\u7b2c\u4e00\u7c7b\u57fa\u672c\u6570\u636e Block \uff1a \u5c06\u56fe\u7247\u5757\u6574\u5408\u5230\u6587\u672c\u5757 TextBlock \u4e2d\uff0c\u4f5c\u4e3a line > span \u7ea7\u522b\u7684\u5143\u7d20 \u589e\u52a0\u5e03\u5c40\u53c2\u6570\uff0c\u4f8b\u5982 alignment \uff0c left_space \uff0c before_space \uff0c\u7528\u4ee5\u4fdd\u5b58\u540e\u7eed\u6bb5\u843d\u5e03\u5c40\u89e3\u6790\u7ed3\u679c \u6ce8\u610f \u540e\u7eed\u7248\u672c\u4e2d\u53d1\u73b0 extractDICT() \u83b7\u53d6\u56fe\u7247\u5b58\u5728\u95ee\u9898\uff08\u5982\u53ea\u80fd\u83b7\u53d6\u5b8c\u5168\u663e\u793a\u5728\u9875\u9762\u4e2d\u7684\u56fe\u7247\u3001\u4e22\u5931alpha\u901a\u9053\uff09\uff0c\u8fd8\u9700\u914d\u5408 page.getImageList() \u5904\u7406\uff1b\u53e6\u5916\uff0cv0.5.0\u7248\u672c\u4e2d\u5bf9\u6d6e\u52a8\u56fe\u7247\u4e5f\u8fdb\u884c\u4e86\u652f\u6301\uff0c\u8be6\u89c1\u4ee5\u4e0b\u4e24\u7bc7\u56fe\u7247\u76f8\u5173\u7684\u8bb0\u5f55\u3002 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247 \u5f62\u72b6 \u00b6 \u6587\u672c\u4e0e\u56fe\u7247\u6784\u6210\u4e86\u4e3b\u4f53\u5185\u5bb9\uff0c\u5b83\u4eec\u7684\u6837\u5f0f\u5219\u7531 \u5f62\u72b6 \u6765\u63cf\u8ff0\uff0c\u4f8b\u5982\u4ee3\u8868\u6587\u672c\u9ad8\u4eae\u7684\u77e9\u5f62\u5757\uff0c\u8868\u660e\u8868\u683c\u8fb9\u7ebf\u7684\u76f4\u7ebf\uff08\u5f88\u7ec6\u7684\u77e9\u5f62\uff09\u3002\u5f62\u72b6\u6784\u6210\u4e86 pdf2docx \u7684\u7b2c\u4e8c\u7c7b\u57fa\u672c\u6570\u636e Shape \u3002 \u8fd9\u91cc\u7684\u6240\u8c13\u7684\u5f62\u72b6\u5177\u4f53\u6307\u4e24\u7c7b\u6765\u6e90\uff1a PDF\u539f\u59cb\u6587\u4ef6\u4e2d\u7684\u8def\u5f84 Path PDF\u6ce8\u91ca Annotation (a) \u8def\u5f84 \u00b6 PDF\u89c4\u8303\u5b9a\u4e49\u4e86\u5404\u79cd\u8def\u5f84\u53ca\u5176\u56f4\u6210\u7684\u56fe\u5f62\uff08\u63cf\u8fb9\u548c\u586b\u5145\uff09\uff0c\u4f46\u622a\u81f31.17.3\u7248\u672c\uff0c PyMuPDF \u5c1a\u672a\u63d0\u4f9b\u89e3\u6790\u5177\u4f53\u8def\u5f84\u7684API\uff0c\u53ea\u80fd\u63d0\u53d6\u8fd9\u4e9b\u8def\u5f84\u7684\u539f\u59cb\u4ee3\u7801\uff08\u53c2\u8003\u4ee5\u4e0b\u8f93\u51fa\u793a\u4f8b\uff09\u3002 pdf = fitz.open(file_path) for page in pdf: for xref in page._getContents(): page_content = pdf._getXrefStream(xref).decode(encoding=\"ISO-8859-1\") # \u8f93\u51fa\u793a\u4f8b /P<</MCID 0>> BDC ... 1 0 0 1 90.0240021 590.380005 cm ... 1 1 0 rg # or 0 g ... 285.17 500.11 193.97 13.44 re f* ... 214 320 m 249 322 l ... EMC \u56e0\u6b64\u9700\u8981\u53c2\u8003\u539a\u539a\u7684PDF\u89c4\u8303 2 \uff0c\u81ea\u884c\u4ece\u539f\u59cb\u5185\u5bb9\u4e2d\u89e3\u6790\u3002\u4f8b\u5982\uff1a cm \uff1a\u5750\u6807\u53d8\u6362\uff0c\u672c\u4f8b(0,0)\u5e73\u79fb\u81f3(90.0240021 590.380005) q / Q \uff1a\u4fdd\u5b58/\u8c03\u51fa\u753b\u7b14 rg / g \uff1a\u6307\u5b9a\u989c\u8272\u6a21\u5f0f\uff1aRGB/\u7070\u5ea6 re , f / f* : \u4f7f\u7528\u9884\u5b9a\u989c\u8272\u586b\u5145\u77e9\u5f62\u8def\u5f84\u3002\u5982\u679c\u6ca1\u6709 f / f* \uff0c\u5219\u4ec5\u4ec5\u662f\u77e9\u5f62\u8def\u5f84\u800c\u4e0d\u8fdb\u884c\u586b\u5145\u3002\u672c\u4f8b\u4e2d\uff0c \u586b\u5145\u9ec4\u8272 (1,1,0) \u77e9\u5f62\u5de6\u4e0b\u89d2: (285.17 500.11) \u5bbd\u5ea6: 193.97 Pt \u9ad8\u5ea6: 13.44 Pt m , l : \u4ece m \u5411 l \u753b\u76f4\u7ebf\u8def\u5f84\uff1b\u540e\u7eed\u53ef\u4ee5\u7ee7\u7eed l \uff0c\u8868\u793a\u591a\u8fb9\u5f62\u8def\u5f84 c , v , y : \u6839\u636e\u63a7\u5236\u70b9\u753b\u8d1d\u585e\u5c14\u66f2\u7ebf\u8def\u5f84 \u5173\u4e8e\u5750\u6807\u53d8\u6362\uff0c\u4e5f\u5c31\u662f\u4ecePDF\u4e2d\u63d0\u53d6\u7684\u4e00\u4e2a\u5750\u6807\u6620\u5c04\u5230 PyMuPDF \u5904\u7406\u7684\u5750\u6807\uff0c\u9700\u8981\u6ce8\u610f\uff1a - PDF\u89c4\u8303\u5b9a\u4e49\u4e86\u4e00\u4e2a\u539f\u59cb\u7684PDF\u5750\u6807\u7cfb\uff08\u539f\u70b9\u5728\u5de6\u4e0b\u89d2\uff09\uff0c cm \u5b9a\u4e49\u4e86\u6b64\u5750\u6807\u7cfb\u4e0b\u7684\u53d8\u6362\u77e9\u9635 - PyMuPDF \u5b9a\u4e49\u4e86 fitz \u5750\u6807\u7cfb\uff08\u539f\u70b9\u5de6\u4e0a\u89d2\uff0c\u9875\u9762\u65cb\u8f6c\u89d2\u5ea60\uff09\uff0c\u4ecePDF\u5750\u6807\u7cfb\u5230 fitz \u5750\u6807\u7cfb\u7684\u53d8\u6362\u77e9\u9635 page.transformationMatrix - \u771f\u5b9e\u9875\u9762\u53ef\u80fd\u5b58\u5728\u65cb\u8f6c\u89d2\u5ea6\uff0c\u6240\u4ee5 fitz \u5750\u6807\u7cfb\u5230\u771f\u5b9e\u9875\u9762\u5750\u6807\u7cfb\u7684\u53d8\u6362\u77e9\u9635 page.rotationMatrix \u4e0a\u8ff0\u7684PDF\u8def\u5f84\u89e3\u6790\u662f\u4e00\u4e2a\u590d\u6742\u7684\u5de5\u7a0b\uff0c pdf2docx \u63d0\u4f9b\u4e86\u7b80\u5316\u7248\u7684\u89e3\u6790\u51fd\u6570\uff0c\u53ef\u4ee5\u63d0\u53d6\u51fa\u5e38\u89c4\u7684\u8def\u5f84\u5750\u6807\u3001\u989c\u8272\u3001\u63cf\u8fb9/\u586b\u5145\u72b6\u6001\u3002\u5176\u4e2d\uff0c\u6211\u4eec\u53ea\u5173\u6ce8\u6c34\u5e73\u6216\u8005\u7ad6\u76f4\u7684\u8def\u5f84\uff0c\u56e0\u4e3a\u53ea\u6709\u5b83\u4eec\u5bf9\u63a5\u4e0b\u6765\u7684\u8868\u683c\u3001\u6587\u672c\u6837\u5f0f\u89e3\u6790\u6709\u610f\u4e49\u3002 \u81f3\u4e8e\u5176\u4ed6\u7684\u66f2\u7ebf\u8def\u5f84\uff0c\u5b9e\u9645\u4e0a\u7ec4\u6210\u4e86\u77e2\u91cf\u56fe\u5f62\uff0c pdf2docx \u5c06\u5176\u8f6c\u5316\u4e3a\u4f4d\u56fe\uff0c\u4fbf\u4e8e\u63d2\u5165\u5230 docx \u6587\u6863\u4e2d\uff0c\u5177\u4f53\u53c2\u8003\u4e0b\u6587\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406 (b) \u5f62\u72b6\u6ce8\u91ca \u00b6 \u5728PDF\u6587\u4ef6\u57fa\u7840\u4e0a\u8fdb\u884c\u7684\u6279\u6ce8\u64cd\u4f5c\u4f8b\u5982\u9ad8\u4eae\u3001\u4e0b\u5212\u7ebf\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 Page \u5bf9\u8c61\u7684 annots() \u65b9\u6cd5\u83b7\u53d6\uff0c\u5176\u4e2d\u7684 type \u5c5e\u6027\u8868\u660e\u4e86\u8be5\u6279\u6ce8\u7684\u7c7b\u578b 3 \u3002\u4f8b\u5982\uff0c pdf2docx \u5173\u5fc3\u7684\u6709\uff1a PDF_ANNOT_LINE 3 PDF_ANNOT_SQUARE 4 PDF_ANNOT_HIGHLIGHT 8 PDF_ANNOT_UNDERLINE 9 PDF_ANNOT_STRIKEOUT 11 \u7efc\u5408\u4ee5\u4e0a\u4e24\u7c7b\u5f62\u72b6\uff08\u8def\u5f84\u548c\u6ce8\u91ca\uff09\uff0c\u5c06\u5176\u5206\u4e3a\u4e24\u7c7b\uff1a \u63cf\u8fb9 \uff08 Stroke \uff09\u5373\u8f83\u7ec6\u7684\u77e9\u5f62\uff0c\u8868\u5f81\u8868\u683c\u8fb9\u6846\u7ebf\u3001\u6587\u5b57\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u7b49\u6837\u5f0f \u586b\u5145 \uff08 Fill \uff09\u5373\u666e\u901a\u77e9\u5f62\uff0c\u8868\u5f81\u5355\u5143\u683c\u80cc\u666f\u8272\u3001\u6587\u672c\u9ad8\u4eae\u7b49\u6837\u5f0f \u76f8\u5e94\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff1a # Stroke { 'type': int, 'start': (x0, y0), 'end': (x1, y1), 'width': w, 'bbox': (x0+w/2, y0+w/2, x1+w/2, y1+w/2), 'color': int # e.g. 16711680 } # Fill { 'type': int, 'bbox': (x0, y0, x1, y1), 'color': int # e.g. 16711680 } \u5176\u4e2d\uff0c type \u8868\u793a\u8bed\u4e49\u4e0a\u7684\u5206\u7c7b\uff0c\u5373\u4e0a\u8ff0\u63d0\u53ca\u7684\u8868\u683c\u6837\u5f0f\uff08\u8fb9\u6846\u3001\u80cc\u666f\u8272\uff09\u3001\u6587\u672c\u6837\u5f0f\uff08\u9ad8\u4eae\u3001\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\uff09\u3002 \u6ce8\u610f \u4ece1.18.0\u7248\u672c\u5f00\u59cb\uff0c PyMuPDF \u63d0\u4f9b\u4e86\u83b7\u53d6\u9875\u9762\u5185\u6240\u6709\u8def\u5f84\uff08\u5305\u62ecAnnotation\uff09\u7684\u51fd\u6570 page.getDrawings() \u3002\u867d\u7136\u8be5\u65b9\u6cd5\u5c1a\u4e0d\u7a33\u5b9a\uff08\u5982\u4e22\u5931\u67d0\u4e9b\u8def\u5f84\u3001\u4e0d\u652f\u6301\u88c1\u526a\u7684\u8def\u5f84\uff09\uff0c\u4f46\u53ef\u4ee5\u4f7f\u4ee5\u4e0a\u89e3\u6790\u8def\u5f84\u7684\u8fc7\u7a0b\u5927\u5927\u7b80\u5316\uff0c\u56e0\u6b64 pdf2docx \u4ecev0.5.0\u5f00\u59cb\u4f7f\u7528\u8be5\u51fd\u6570\u3002 \u8d85\u94fe\u63a5 \u00b6 PyMuPDF \u53ef\u4ee5\u901a\u8fc7 page.getLinks() \u63d0\u53d6\u8d85\u94fe\u63a5\uff0c\u5f97\u5230\u8d85\u94fe\u63a5\u6587\u672c\u3001URI\u548c\u4f5c\u7528\u533a\u57df\uff08\u77e9\u5f62\u5750\u6807\uff09\u3002\u4e3a\u4e86\u5c06\u8d85\u94fe\u63a5\u6dfb\u52a0\u5230\u76f8\u5e94\u7684\u6587\u672c\u4e0a\u53bb\uff0c pdf2docx \u5c06\u5176\u4f5c\u4e3a\u4e00\u79cd\u865a\u62df\u7684\u5f62\u72b6 Hyperlink \u3002 # hyperlink { 'type': HYPERLINK, 'bbox': (x0, y0, x1, y1), 'uri': str } \u6ce8\u610f Hyperlink \u7c7b\u4f3c\u4e8e Stroke \uff0c\u672c\u8d28\u533a\u522b\u5728\u4e8e Hyperlink \u7684\u8bed\u4e49\u7c7b\u578b\u662f\u5df2\u77e5\u7684\u3002\u66f4\u4e00\u822c\u5730\u7406\u89e3\uff0c Stroke \u662f\u4e00\u79cd\u51e0\u4f55\u7c7b\u578b\uff0c\u4e8b\u5148\u5e76\u4e0d\u77e5\u9053\u5b83\u7684\u8bed\u4e49\u7c7b\u578b\uff08\u8fb9\u6846\u3001\u5220\u9664\u7ebf\u8fd8\u662f\u4e0b\u5212\u7ebf\uff1f\uff09\uff1b\u800c Hyperlink \u662f\u4e00\u79cd\u786e\u5b9a\u4e86\u8bed\u4e49\u7c7b\u578b\u7684 Stroke \u3002 \u603b\u7ed3 \u00b6 \u501f\u52a9 PyMuPDF \u4ecePDF\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6\u6570\u636e\uff0c\u5b83\u4eec\u6784\u6210\u4e86 pdf2docx \u7684\u4e24\u7c7b\u57fa\u7840\u6570\u636e\uff1a \u5757\u5143\u7d20 Block \uff0c\u4ee3\u8868\u4e3b\u4f53\u5185\u5bb9\uff0c\u4f8b\u5982\u76f4\u63a5\u63d0\u53d6\u51fa\u7684\u6587\u672c/\u56fe\u7247\u7ec4\u6210\u7684 TextBlock \uff0c\u4ee5\u53ca\u540e\u7eed\u89e3\u6790\u5f97\u5230\u7684\u8868\u683c\u7ed3\u6784 TableBlock \u3002 \u5f62\u72b6\u5143\u7d20 Shape \uff0c\u4ee3\u8868\u683c\u5f0f\u5185\u5bb9\uff0c\u4f8b\u5982\u63cf\u8fb9 Stroke \u5c06\u5bf9\u5e94\u4e0b\u5212\u7ebf\u3001\u8868\u683c\u8fb9\u6846\u7b49\uff0c\u586b\u5145 Fill \u5c06\u5bf9\u5e94\u6587\u672c\u9ad8\u4eae\u3001\u5355\u5143\u683c\u80cc\u666f\u8272\u7b49\u3002 TextPage \u21a9 PDF Reference 1.7 \u21a9 Annotation Types \u21a9","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-07-14 | \u5206\u7c7b\uff1a process automation \u6587\u672c\u3001\u56fe\u7247\u53ca\u5f62\u72b6\u6db5\u76d6\u4e86\u5e38\u89c1\u7684PDF\u5143\u7d20\uff0c\u8fd9\u4e9b\u662f pdf2docx \u7684\u5904\u7406\u5bf9\u8c61\u3002\u672c\u6587\u4ecb\u7ecd\u5229\u7528 PyMuPDF \u63d0\u53d6\u8fd9\u4e9b\u9875\u9762\u5143\u7d20\uff0c\u53ca\u5176\u57fa\u672c\u6570\u636e\u7ed3\u6784\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#_1","text":"PyMuPDF \u7684 Textpage \u5bf9\u8c61\u63d0\u4f9b\u7684 extractDICT() \u548c extractRAWDICT() \u7528\u4ee5\u83b7\u53d6\u9875\u9762\u4e2d\u7684\u6240\u6709\u6587\u672c\u548c\u56fe\u7247\uff08\u5185\u5bb9\u3001\u4f4d\u7f6e\u3001\u5c5e\u6027\uff09\uff0c\u57fa\u672c\u6570\u636e\u7ed3\u6784\u5982\u4e0b 1 \uff1a pdf2docx \u7ee7\u7eed\u6cbf\u7528\u4ee5\u4e0a\u6570\u636e\u7ed3\u6784\uff0c\u5e76\u7a0d\u4f5c\u6539\u52a8\uff0c\u4f5c\u4e3a\u7b2c\u4e00\u7c7b\u57fa\u672c\u6570\u636e Block \uff1a \u5c06\u56fe\u7247\u5757\u6574\u5408\u5230\u6587\u672c\u5757 TextBlock \u4e2d\uff0c\u4f5c\u4e3a line > span \u7ea7\u522b\u7684\u5143\u7d20 \u589e\u52a0\u5e03\u5c40\u53c2\u6570\uff0c\u4f8b\u5982 alignment \uff0c left_space \uff0c before_space \uff0c\u7528\u4ee5\u4fdd\u5b58\u540e\u7eed\u6bb5\u843d\u5e03\u5c40\u89e3\u6790\u7ed3\u679c \u6ce8\u610f \u540e\u7eed\u7248\u672c\u4e2d\u53d1\u73b0 extractDICT() \u83b7\u53d6\u56fe\u7247\u5b58\u5728\u95ee\u9898\uff08\u5982\u53ea\u80fd\u83b7\u53d6\u5b8c\u5168\u663e\u793a\u5728\u9875\u9762\u4e2d\u7684\u56fe\u7247\u3001\u4e22\u5931alpha\u901a\u9053\uff09\uff0c\u8fd8\u9700\u914d\u5408 page.getImageList() \u5904\u7406\uff1b\u53e6\u5916\uff0cv0.5.0\u7248\u672c\u4e2d\u5bf9\u6d6e\u52a8\u56fe\u7247\u4e5f\u8fdb\u884c\u4e86\u652f\u6301\uff0c\u8be6\u89c1\u4ee5\u4e0b\u4e24\u7bc7\u56fe\u7247\u76f8\u5173\u7684\u8bb0\u5f55\u3002 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247","title":"\u6587\u672c\u4e0e\u56fe\u7247"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#_2","text":"\u6587\u672c\u4e0e\u56fe\u7247\u6784\u6210\u4e86\u4e3b\u4f53\u5185\u5bb9\uff0c\u5b83\u4eec\u7684\u6837\u5f0f\u5219\u7531 \u5f62\u72b6 \u6765\u63cf\u8ff0\uff0c\u4f8b\u5982\u4ee3\u8868\u6587\u672c\u9ad8\u4eae\u7684\u77e9\u5f62\u5757\uff0c\u8868\u660e\u8868\u683c\u8fb9\u7ebf\u7684\u76f4\u7ebf\uff08\u5f88\u7ec6\u7684\u77e9\u5f62\uff09\u3002\u5f62\u72b6\u6784\u6210\u4e86 pdf2docx \u7684\u7b2c\u4e8c\u7c7b\u57fa\u672c\u6570\u636e Shape \u3002 \u8fd9\u91cc\u7684\u6240\u8c13\u7684\u5f62\u72b6\u5177\u4f53\u6307\u4e24\u7c7b\u6765\u6e90\uff1a PDF\u539f\u59cb\u6587\u4ef6\u4e2d\u7684\u8def\u5f84 Path PDF\u6ce8\u91ca Annotation","title":"\u5f62\u72b6"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#a","text":"PDF\u89c4\u8303\u5b9a\u4e49\u4e86\u5404\u79cd\u8def\u5f84\u53ca\u5176\u56f4\u6210\u7684\u56fe\u5f62\uff08\u63cf\u8fb9\u548c\u586b\u5145\uff09\uff0c\u4f46\u622a\u81f31.17.3\u7248\u672c\uff0c PyMuPDF \u5c1a\u672a\u63d0\u4f9b\u89e3\u6790\u5177\u4f53\u8def\u5f84\u7684API\uff0c\u53ea\u80fd\u63d0\u53d6\u8fd9\u4e9b\u8def\u5f84\u7684\u539f\u59cb\u4ee3\u7801\uff08\u53c2\u8003\u4ee5\u4e0b\u8f93\u51fa\u793a\u4f8b\uff09\u3002 pdf = fitz.open(file_path) for page in pdf: for xref in page._getContents(): page_content = pdf._getXrefStream(xref).decode(encoding=\"ISO-8859-1\") # \u8f93\u51fa\u793a\u4f8b /P<</MCID 0>> BDC ... 1 0 0 1 90.0240021 590.380005 cm ... 1 1 0 rg # or 0 g ... 285.17 500.11 193.97 13.44 re f* ... 214 320 m 249 322 l ... EMC \u56e0\u6b64\u9700\u8981\u53c2\u8003\u539a\u539a\u7684PDF\u89c4\u8303 2 \uff0c\u81ea\u884c\u4ece\u539f\u59cb\u5185\u5bb9\u4e2d\u89e3\u6790\u3002\u4f8b\u5982\uff1a cm \uff1a\u5750\u6807\u53d8\u6362\uff0c\u672c\u4f8b(0,0)\u5e73\u79fb\u81f3(90.0240021 590.380005) q / Q \uff1a\u4fdd\u5b58/\u8c03\u51fa\u753b\u7b14 rg / g \uff1a\u6307\u5b9a\u989c\u8272\u6a21\u5f0f\uff1aRGB/\u7070\u5ea6 re , f / f* : \u4f7f\u7528\u9884\u5b9a\u989c\u8272\u586b\u5145\u77e9\u5f62\u8def\u5f84\u3002\u5982\u679c\u6ca1\u6709 f / f* \uff0c\u5219\u4ec5\u4ec5\u662f\u77e9\u5f62\u8def\u5f84\u800c\u4e0d\u8fdb\u884c\u586b\u5145\u3002\u672c\u4f8b\u4e2d\uff0c \u586b\u5145\u9ec4\u8272 (1,1,0) \u77e9\u5f62\u5de6\u4e0b\u89d2: (285.17 500.11) \u5bbd\u5ea6: 193.97 Pt \u9ad8\u5ea6: 13.44 Pt m , l : \u4ece m \u5411 l \u753b\u76f4\u7ebf\u8def\u5f84\uff1b\u540e\u7eed\u53ef\u4ee5\u7ee7\u7eed l \uff0c\u8868\u793a\u591a\u8fb9\u5f62\u8def\u5f84 c , v , y : \u6839\u636e\u63a7\u5236\u70b9\u753b\u8d1d\u585e\u5c14\u66f2\u7ebf\u8def\u5f84 \u5173\u4e8e\u5750\u6807\u53d8\u6362\uff0c\u4e5f\u5c31\u662f\u4ecePDF\u4e2d\u63d0\u53d6\u7684\u4e00\u4e2a\u5750\u6807\u6620\u5c04\u5230 PyMuPDF \u5904\u7406\u7684\u5750\u6807\uff0c\u9700\u8981\u6ce8\u610f\uff1a - PDF\u89c4\u8303\u5b9a\u4e49\u4e86\u4e00\u4e2a\u539f\u59cb\u7684PDF\u5750\u6807\u7cfb\uff08\u539f\u70b9\u5728\u5de6\u4e0b\u89d2\uff09\uff0c cm \u5b9a\u4e49\u4e86\u6b64\u5750\u6807\u7cfb\u4e0b\u7684\u53d8\u6362\u77e9\u9635 - PyMuPDF \u5b9a\u4e49\u4e86 fitz \u5750\u6807\u7cfb\uff08\u539f\u70b9\u5de6\u4e0a\u89d2\uff0c\u9875\u9762\u65cb\u8f6c\u89d2\u5ea60\uff09\uff0c\u4ecePDF\u5750\u6807\u7cfb\u5230 fitz \u5750\u6807\u7cfb\u7684\u53d8\u6362\u77e9\u9635 page.transformationMatrix - \u771f\u5b9e\u9875\u9762\u53ef\u80fd\u5b58\u5728\u65cb\u8f6c\u89d2\u5ea6\uff0c\u6240\u4ee5 fitz \u5750\u6807\u7cfb\u5230\u771f\u5b9e\u9875\u9762\u5750\u6807\u7cfb\u7684\u53d8\u6362\u77e9\u9635 page.rotationMatrix \u4e0a\u8ff0\u7684PDF\u8def\u5f84\u89e3\u6790\u662f\u4e00\u4e2a\u590d\u6742\u7684\u5de5\u7a0b\uff0c pdf2docx \u63d0\u4f9b\u4e86\u7b80\u5316\u7248\u7684\u89e3\u6790\u51fd\u6570\uff0c\u53ef\u4ee5\u63d0\u53d6\u51fa\u5e38\u89c4\u7684\u8def\u5f84\u5750\u6807\u3001\u989c\u8272\u3001\u63cf\u8fb9/\u586b\u5145\u72b6\u6001\u3002\u5176\u4e2d\uff0c\u6211\u4eec\u53ea\u5173\u6ce8\u6c34\u5e73\u6216\u8005\u7ad6\u76f4\u7684\u8def\u5f84\uff0c\u56e0\u4e3a\u53ea\u6709\u5b83\u4eec\u5bf9\u63a5\u4e0b\u6765\u7684\u8868\u683c\u3001\u6587\u672c\u6837\u5f0f\u89e3\u6790\u6709\u610f\u4e49\u3002 \u81f3\u4e8e\u5176\u4ed6\u7684\u66f2\u7ebf\u8def\u5f84\uff0c\u5b9e\u9645\u4e0a\u7ec4\u6210\u4e86\u77e2\u91cf\u56fe\u5f62\uff0c pdf2docx \u5c06\u5176\u8f6c\u5316\u4e3a\u4f4d\u56fe\uff0c\u4fbf\u4e8e\u63d2\u5165\u5230 docx \u6587\u6863\u4e2d\uff0c\u5177\u4f53\u53c2\u8003\u4e0b\u6587\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406","title":"(a) \u8def\u5f84"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#b","text":"\u5728PDF\u6587\u4ef6\u57fa\u7840\u4e0a\u8fdb\u884c\u7684\u6279\u6ce8\u64cd\u4f5c\u4f8b\u5982\u9ad8\u4eae\u3001\u4e0b\u5212\u7ebf\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 Page \u5bf9\u8c61\u7684 annots() \u65b9\u6cd5\u83b7\u53d6\uff0c\u5176\u4e2d\u7684 type \u5c5e\u6027\u8868\u660e\u4e86\u8be5\u6279\u6ce8\u7684\u7c7b\u578b 3 \u3002\u4f8b\u5982\uff0c pdf2docx \u5173\u5fc3\u7684\u6709\uff1a PDF_ANNOT_LINE 3 PDF_ANNOT_SQUARE 4 PDF_ANNOT_HIGHLIGHT 8 PDF_ANNOT_UNDERLINE 9 PDF_ANNOT_STRIKEOUT 11 \u7efc\u5408\u4ee5\u4e0a\u4e24\u7c7b\u5f62\u72b6\uff08\u8def\u5f84\u548c\u6ce8\u91ca\uff09\uff0c\u5c06\u5176\u5206\u4e3a\u4e24\u7c7b\uff1a \u63cf\u8fb9 \uff08 Stroke \uff09\u5373\u8f83\u7ec6\u7684\u77e9\u5f62\uff0c\u8868\u5f81\u8868\u683c\u8fb9\u6846\u7ebf\u3001\u6587\u5b57\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u7b49\u6837\u5f0f \u586b\u5145 \uff08 Fill \uff09\u5373\u666e\u901a\u77e9\u5f62\uff0c\u8868\u5f81\u5355\u5143\u683c\u80cc\u666f\u8272\u3001\u6587\u672c\u9ad8\u4eae\u7b49\u6837\u5f0f \u76f8\u5e94\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff1a # Stroke { 'type': int, 'start': (x0, y0), 'end': (x1, y1), 'width': w, 'bbox': (x0+w/2, y0+w/2, x1+w/2, y1+w/2), 'color': int # e.g. 16711680 } # Fill { 'type': int, 'bbox': (x0, y0, x1, y1), 'color': int # e.g. 16711680 } \u5176\u4e2d\uff0c type \u8868\u793a\u8bed\u4e49\u4e0a\u7684\u5206\u7c7b\uff0c\u5373\u4e0a\u8ff0\u63d0\u53ca\u7684\u8868\u683c\u6837\u5f0f\uff08\u8fb9\u6846\u3001\u80cc\u666f\u8272\uff09\u3001\u6587\u672c\u6837\u5f0f\uff08\u9ad8\u4eae\u3001\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\uff09\u3002 \u6ce8\u610f \u4ece1.18.0\u7248\u672c\u5f00\u59cb\uff0c PyMuPDF \u63d0\u4f9b\u4e86\u83b7\u53d6\u9875\u9762\u5185\u6240\u6709\u8def\u5f84\uff08\u5305\u62ecAnnotation\uff09\u7684\u51fd\u6570 page.getDrawings() \u3002\u867d\u7136\u8be5\u65b9\u6cd5\u5c1a\u4e0d\u7a33\u5b9a\uff08\u5982\u4e22\u5931\u67d0\u4e9b\u8def\u5f84\u3001\u4e0d\u652f\u6301\u88c1\u526a\u7684\u8def\u5f84\uff09\uff0c\u4f46\u53ef\u4ee5\u4f7f\u4ee5\u4e0a\u89e3\u6790\u8def\u5f84\u7684\u8fc7\u7a0b\u5927\u5927\u7b80\u5316\uff0c\u56e0\u6b64 pdf2docx \u4ecev0.5.0\u5f00\u59cb\u4f7f\u7528\u8be5\u51fd\u6570\u3002","title":"(b) \u5f62\u72b6\u6ce8\u91ca"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#_3","text":"PyMuPDF \u53ef\u4ee5\u901a\u8fc7 page.getLinks() \u63d0\u53d6\u8d85\u94fe\u63a5\uff0c\u5f97\u5230\u8d85\u94fe\u63a5\u6587\u672c\u3001URI\u548c\u4f5c\u7528\u533a\u57df\uff08\u77e9\u5f62\u5750\u6807\uff09\u3002\u4e3a\u4e86\u5c06\u8d85\u94fe\u63a5\u6dfb\u52a0\u5230\u76f8\u5e94\u7684\u6587\u672c\u4e0a\u53bb\uff0c pdf2docx \u5c06\u5176\u4f5c\u4e3a\u4e00\u79cd\u865a\u62df\u7684\u5f62\u72b6 Hyperlink \u3002 # hyperlink { 'type': HYPERLINK, 'bbox': (x0, y0, x1, y1), 'uri': str } \u6ce8\u610f Hyperlink \u7c7b\u4f3c\u4e8e Stroke \uff0c\u672c\u8d28\u533a\u522b\u5728\u4e8e Hyperlink \u7684\u8bed\u4e49\u7c7b\u578b\u662f\u5df2\u77e5\u7684\u3002\u66f4\u4e00\u822c\u5730\u7406\u89e3\uff0c Stroke \u662f\u4e00\u79cd\u51e0\u4f55\u7c7b\u578b\uff0c\u4e8b\u5148\u5e76\u4e0d\u77e5\u9053\u5b83\u7684\u8bed\u4e49\u7c7b\u578b\uff08\u8fb9\u6846\u3001\u5220\u9664\u7ebf\u8fd8\u662f\u4e0b\u5212\u7ebf\uff1f\uff09\uff1b\u800c Hyperlink \u662f\u4e00\u79cd\u786e\u5b9a\u4e86\u8bed\u4e49\u7c7b\u578b\u7684 Stroke \u3002","title":"\u8d85\u94fe\u63a5"},{"location":"2020-07-14-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC%E3%80%81%E5%9B%BE%E7%89%87%E5%92%8C%E5%BD%A2%E7%8A%B6/#_4","text":"\u501f\u52a9 PyMuPDF \u4ecePDF\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6\u6570\u636e\uff0c\u5b83\u4eec\u6784\u6210\u4e86 pdf2docx \u7684\u4e24\u7c7b\u57fa\u7840\u6570\u636e\uff1a \u5757\u5143\u7d20 Block \uff0c\u4ee3\u8868\u4e3b\u4f53\u5185\u5bb9\uff0c\u4f8b\u5982\u76f4\u63a5\u63d0\u53d6\u51fa\u7684\u6587\u672c/\u56fe\u7247\u7ec4\u6210\u7684 TextBlock \uff0c\u4ee5\u53ca\u540e\u7eed\u89e3\u6790\u5f97\u5230\u7684\u8868\u683c\u7ed3\u6784 TableBlock \u3002 \u5f62\u72b6\u5143\u7d20 Shape \uff0c\u4ee3\u8868\u683c\u5f0f\u5185\u5bb9\uff0c\u4f8b\u5982\u63cf\u8fb9 Stroke \u5c06\u5bf9\u5e94\u4e0b\u5212\u7ebf\u3001\u8868\u683c\u8fb9\u6846\u7b49\uff0c\u586b\u5145 Fill \u5c06\u5bf9\u5e94\u6587\u672c\u9ad8\u4eae\u3001\u5355\u5143\u683c\u80cc\u666f\u8272\u7b49\u3002 TextPage \u21a9 PDF Reference 1.7 \u21a9 Annotation Types \u21a9","title":"\u603b\u7ed3"},{"location":"2020-07-20-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%96%87%E6%9C%AC%E6%A0%B7%E5%BC%8F/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-07-20 | \u5206\u7c7b\uff1a process automation \u524d\u6587 \u4ecb\u7ecd\u4e86 PyMuPDF \u63d0\u53d6\u7684\u539f\u59cb\u6570\u636e\uff0c\u5373\u6587\u672c\u3001\u56fe\u7247\u3001\u8d85\u94fe\u63a5\u53ca\u5f62\u72b6\u3002\u5176\u4e2d\u6587\u672c\u5757\u81ea\u5e26\u4e86\u5b57\u4f53\u3001\u989c\u8272\u3001\u659c\u4f53\u3001\u7c97\u4f53\u7b49\u5c5e\u6027\uff0c\u4f46\u662f \u9ad8\u4eae \u3001 \u4e0b\u5212\u7ebf \u3001 \u5220\u9664\u7ebf \u7b49\u5177\u4f53\u6837\u5f0f\u9700\u8981\u8fdb\u4e00\u6b65\u6839\u636e \u6587\u672c\u548c\u5f62\u72b6\u7684\u4f4d\u7f6e\u5173\u7cfb \u6765\u5224\u5b9a\u3002 \u89e3\u6790\u601d\u8def \u00b6 \u4ece\u524d\u6587\u53ef\u77e5\uff0c\u5f62\u72b6\u5177\u6709\u4e24\u91cd\u5c5e\u6027\uff1a\u51e0\u4f55\u5c5e\u6027\u51b3\u5b9a\u4e86\u5b83\u4f5c\u7528\u5728\u9875\u9762\u4e0a\u7684\u4f4d\u7f6e\uff0c\u8bed\u4e49\u5c5e\u6027\u51b3\u5b9a\u4e86\u5b83\u7684\u7c7b\u578b\uff08\u9ad8\u4eae\u3001\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u3001\u8d85\u94fe\u63a5\uff09\u3002\u6240\u8c13\u6587\u672c\u6837\u5f0f\u89e3\u6790\uff0c\u5373\u6839\u636e\u6587\u672c\u548c\u5f62\u72b6\u7684\u51e0\u4f55\u5c5e\u6027\uff0c\u786e\u5b9a\u5f62\u72b6\u7684\u8bed\u4e49\u5c5e\u6027\u3002 \u4f9d\u6b21\u68c0\u6d4b\u6587\u672c\u548c\u5f62\u72b6\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6587\u672c\u5757\u548c\u5f62\u72b6\u76f8\u4ea4\uff0c\u5219\u6df1\u5165\u5230 line > span \u7ea7\u522b\uff0c\u5f97\u5230\u8be5\u5f62\u72b6\u5728 span \u4e0a\u7684\u4f5c\u7528\u533a\u57df \u5229\u7528\u5f62\u72b6\u7684\u51e0\u4f55\u7c7b\u578b\u548c\u4f4d\u7f6e\u5173\u7cfb\u5224\u65ad\u8bed\u4e49\u5c5e\u6027\uff1a \u51e0\u4f55\u7c7b\u578b \u76f8\u5bf9\u4f4d\u7f6e \u8bed\u4e49\u5c5e\u6027 Fill \u91cd\u53e0 \u9ad8\u4eae Stroke \u6587\u672c\u4e2d\u90e8 \u5220\u9664\u7ebf Stroke \u6587\u672c\u5e95\u90e8 \u4e0b\u5212\u7ebf Hyperlink \u91cd\u53e0 \u8d85\u94fe\u63a5 pdf2docx \u5173\u6ce8\u7684\u5f62\u72b6\u5206\u4e3a\u4e24\u7c7b\uff1a Stroke \u5373\u8f83\u7ec6\u7684\u77e9\u5f62\uff0c\u8868\u5f81\u8868\u683c\u8fb9\u6846\u7ebf\u3001\u6587\u5b57\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u7b49\u6837\u5f0f\u3002 Hyperlink \u5b9e\u9645\u662f Stroke \u7684\u4e00\u79cd\u7279\u4f8b\u3002 Fill \u5373\u666e\u901a\u77e9\u5f62\uff0c\u8868\u5f81\u5355\u5143\u683c\u80cc\u666f\u8272\u3001\u6587\u672c\u9ad8\u4eae\u7b49\u6837\u5f0f \u6570\u636e\u7ed3\u6784 \u00b6 \u5728\u539f\u59cb\u6587\u672c\u5757\u6570\u636e\u7ed3\u6784\u7684\u57fa\u7840\u4e0a\uff0c\u4e3a span \u5757\u65b0\u589e\u8868\u5f81\u89e3\u6790\u7ed3\u679c\u7684 style \u5c5e\u6027\uff1a # span { \"bbox\": [float, float, float, float], \"size\": float, \"flags\": int, \"font\": str, \"color\": int, \"text\": str, # joined from chars \"chars\": [{...}] # ----- new items ----- \"style\": [ { \"type\": int, \"color\": int\uff0c \"uri\": str # hyperlink only }, {...} ] } \u4ee5\u4e0a\u6587\u672c\u5c5e\u6027\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 python-docx \u63d0\u4f9b\u7684\u5b57\u4f53\u76f8\u5173\u7684API\u91cd\u5efa 1 \u3002 docx.text.run.Font \u21a9","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f"},{"location":"2020-07-20-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%96%87%E6%9C%AC%E6%A0%B7%E5%BC%8F/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-07-20 | \u5206\u7c7b\uff1a process automation \u524d\u6587 \u4ecb\u7ecd\u4e86 PyMuPDF \u63d0\u53d6\u7684\u539f\u59cb\u6570\u636e\uff0c\u5373\u6587\u672c\u3001\u56fe\u7247\u3001\u8d85\u94fe\u63a5\u53ca\u5f62\u72b6\u3002\u5176\u4e2d\u6587\u672c\u5757\u81ea\u5e26\u4e86\u5b57\u4f53\u3001\u989c\u8272\u3001\u659c\u4f53\u3001\u7c97\u4f53\u7b49\u5c5e\u6027\uff0c\u4f46\u662f \u9ad8\u4eae \u3001 \u4e0b\u5212\u7ebf \u3001 \u5220\u9664\u7ebf \u7b49\u5177\u4f53\u6837\u5f0f\u9700\u8981\u8fdb\u4e00\u6b65\u6839\u636e \u6587\u672c\u548c\u5f62\u72b6\u7684\u4f4d\u7f6e\u5173\u7cfb \u6765\u5224\u5b9a\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f"},{"location":"2020-07-20-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%96%87%E6%9C%AC%E6%A0%B7%E5%BC%8F/#_1","text":"\u4ece\u524d\u6587\u53ef\u77e5\uff0c\u5f62\u72b6\u5177\u6709\u4e24\u91cd\u5c5e\u6027\uff1a\u51e0\u4f55\u5c5e\u6027\u51b3\u5b9a\u4e86\u5b83\u4f5c\u7528\u5728\u9875\u9762\u4e0a\u7684\u4f4d\u7f6e\uff0c\u8bed\u4e49\u5c5e\u6027\u51b3\u5b9a\u4e86\u5b83\u7684\u7c7b\u578b\uff08\u9ad8\u4eae\u3001\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u3001\u8d85\u94fe\u63a5\uff09\u3002\u6240\u8c13\u6587\u672c\u6837\u5f0f\u89e3\u6790\uff0c\u5373\u6839\u636e\u6587\u672c\u548c\u5f62\u72b6\u7684\u51e0\u4f55\u5c5e\u6027\uff0c\u786e\u5b9a\u5f62\u72b6\u7684\u8bed\u4e49\u5c5e\u6027\u3002 \u4f9d\u6b21\u68c0\u6d4b\u6587\u672c\u548c\u5f62\u72b6\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6587\u672c\u5757\u548c\u5f62\u72b6\u76f8\u4ea4\uff0c\u5219\u6df1\u5165\u5230 line > span \u7ea7\u522b\uff0c\u5f97\u5230\u8be5\u5f62\u72b6\u5728 span \u4e0a\u7684\u4f5c\u7528\u533a\u57df \u5229\u7528\u5f62\u72b6\u7684\u51e0\u4f55\u7c7b\u578b\u548c\u4f4d\u7f6e\u5173\u7cfb\u5224\u65ad\u8bed\u4e49\u5c5e\u6027\uff1a \u51e0\u4f55\u7c7b\u578b \u76f8\u5bf9\u4f4d\u7f6e \u8bed\u4e49\u5c5e\u6027 Fill \u91cd\u53e0 \u9ad8\u4eae Stroke \u6587\u672c\u4e2d\u90e8 \u5220\u9664\u7ebf Stroke \u6587\u672c\u5e95\u90e8 \u4e0b\u5212\u7ebf Hyperlink \u91cd\u53e0 \u8d85\u94fe\u63a5 pdf2docx \u5173\u6ce8\u7684\u5f62\u72b6\u5206\u4e3a\u4e24\u7c7b\uff1a Stroke \u5373\u8f83\u7ec6\u7684\u77e9\u5f62\uff0c\u8868\u5f81\u8868\u683c\u8fb9\u6846\u7ebf\u3001\u6587\u5b57\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u7b49\u6837\u5f0f\u3002 Hyperlink \u5b9e\u9645\u662f Stroke \u7684\u4e00\u79cd\u7279\u4f8b\u3002 Fill \u5373\u666e\u901a\u77e9\u5f62\uff0c\u8868\u5f81\u5355\u5143\u683c\u80cc\u666f\u8272\u3001\u6587\u672c\u9ad8\u4eae\u7b49\u6837\u5f0f","title":"\u89e3\u6790\u601d\u8def"},{"location":"2020-07-20-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%96%87%E6%9C%AC%E6%A0%B7%E5%BC%8F/#_2","text":"\u5728\u539f\u59cb\u6587\u672c\u5757\u6570\u636e\u7ed3\u6784\u7684\u57fa\u7840\u4e0a\uff0c\u4e3a span \u5757\u65b0\u589e\u8868\u5f81\u89e3\u6790\u7ed3\u679c\u7684 style \u5c5e\u6027\uff1a # span { \"bbox\": [float, float, float, float], \"size\": float, \"flags\": int, \"font\": str, \"color\": int, \"text\": str, # joined from chars \"chars\": [{...}] # ----- new items ----- \"style\": [ { \"type\": int, \"color\": int\uff0c \"uri\": str # hyperlink only }, {...} ] } \u4ee5\u4e0a\u6587\u672c\u5c5e\u6027\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 python-docx \u63d0\u4f9b\u7684\u5b57\u4f53\u76f8\u5173\u7684API\u91cd\u5efa 1 \u3002 docx.text.run.Font \u21a9","title":"\u6570\u636e\u7ed3\u6784"},{"location":"2020-08-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E8%A1%A8%E6%A0%BC/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-08-15 | \u5206\u7c7b\uff1a process automation PDF\u4e2d\u6ca1\u6709\u8bed\u4e49\u4e0a\u7684\u8868\u683c\u7684\u6982\u5ff5\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5916\u89c2\u4e0a\u7684\u8868\u683c\uff0c\u5373\u8fb9\u6846\u7ebf\uff08 Stroke \u7c7b\u578b\u7684\u5f62\u72b6\uff09\u56f4\u6210\u7684\u533a\u57df\uff0c\u6765\u8bc6\u522b\u8bed\u4e49\u4e0a\u7684\u8868\u683c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u4e0d\u501f\u52a9\u6587\u672c\u6846\u7684\u8bdd Word \u4e0d\u652f\u6301\u6d6e\u52a8\u5e03\u5c40\uff0c\u8868\u73b0\u4e3a\u4e00\u6bb5\u6587\u5b57\u9ed8\u8ba4\u5360\u636e\u4e00\u6574\u884c\uff0c\u6240\u4ee5\u9700\u8981\u8868\u683c\u6765\u8fdb\u884c\u8f85\u52a9\u5e03\u5c40\uff0c\u4f8b\u5982\u591a\u5217\u6587\u672c\u3002\u4e8e\u662f\uff0c pdf2docx \u8003\u8651\u4e24\u7c7b\u8868\u683c\uff1a \u663e\u5f0f\u8868\u683c\uff08 Lattice Table \uff09\uff1a\u6709\u8fb9\u7ebf\uff0c\u7ec4\u7ec7\u7ed3\u6784\u5316\u7684\u5185\u5bb9 \u9690\u5f0f\u8868\u683c\uff08 Stream Table \uff09\uff1a\u65e0\u8fb9\u7ebf\uff0c\u65e2\u53ef\u80fd\u7528\u4e8e\u7ec4\u7ec7\u7ed3\u6784\u5316\u7684\u5185\u5bb9\uff08\u9690\u85cf\u8fb9\u6846\u7684\u8868\u683c\uff09\uff0c\u4e5f\u53ef\u80fd\u662f\u4e3a\u4e86\u9875\u9762\u5e03\u5c40\u7684\u9700\u8981 \u89e3\u6790\u663e\u5f0f\u8868\u683c \u00b6 \u4ece\u8fb9\u7ebf\u51fa\u53d1\uff0c\u786e\u5b9a\u8868\u683c\u7ed3\u6784->\u5355\u5143\u683c\u5c5e\u6027->\u5355\u5143\u683c\u5185\u5bb9 \uff1a \u4ee5\u662f\u5426\u76f8\u4ea4\u4e3a\u4f9d\u636e\u5206\u7ec4 Stroke \u5143\u7d20\uff0c\u6bcf\u4e00\u7ec4\u5373\u4e3a\u6f5c\u5728\u7684\u8868\u683c\u533a\u57df\u5185\u7684\u8fb9\u6846\u7ebf\uff08table border\uff09\uff0c\u6839\u636e\u6f5c\u5728\u8868\u683c\u533a\u57df\u83b7\u53d6 Fill \u5355\u5143\u683c\u80cc\u666f\uff08cell shading\uff09\u3002 \u57fa\u4e8e\u8fb9\u6846\u7ebf\u786e\u5b9a\u8868\u683c\u7ed3\u6784 \u5224\u65ad\u662f\u5426\u5b58\u5728\u5916\u8fb9\u6846\u7ebf\uff0c\u6ca1\u6709\u5219\u52a0\u4e0a\u5047\u60f3\u7684\u5916\u8fb9\u6846\u7ebf\uff08\u767d\u8272\u3001\u5bbd\u5ea60\uff09\u3002 \u5c06\u8fb9\u6846\u7ebf\u6309\u6a2a\u3001\u7eb5\u5206\u7ec4\u5f97\u5230\u884c\u95f4\u9694\u7ebf\u548c\u5217\u95f4\u9694\u7ebf\uff0c\u6a2a\u7eb5\u95f4\u9694\u7ebf\u7684\u4ea4\u70b9\u7ec4\u6210\u4e86\u521d\u59cb\u7684\u672a\u8003\u8651\u5408\u5e76\u5355\u5143\u683c\u7684\u8868\u683c\u7ed3\u6784\u3002 \u5bf9\u4e8e\u6bcf\u4e00\u884c\uff0c\u68c0\u6d4b\u4e00\u6761\u5047\u60f3\u6c34\u5e73\u7ebf\u4e0e\u5217\u8fb9\u7ebf\u7684\u4ea4\u70b9\uff1a\u4e0d\u5b58\u5728\u4ea4\u70b9\u7684\u4f4d\u7f6e\u5373\u53d1\u751f\u4e86\u884c\u65b9\u5411\u7684\u5408\u5e76\u5355\u5143\u683c\uff1b\u540c\u7406\u68c0\u6d4b\u5217\u65b9\u5411\u7684\u5408\u5e76\u5355\u5143\u683c\u3002 \u57fa\u4e8e\u8868\u683c\u7ed3\u6784\u786e\u5b9a\u5355\u5143\u683c\u5c5e\u6027 \u4ee5\u5de6\u4e0a\u89d2\u5355\u5143\u683c\u8868\u793a\u5408\u5e76\u5355\u5143\u683c\u533a\u57df\uff0c\u88ab\u5408\u5e76\u7684\u5355\u5143\u683c\u521d\u59cb\u5316\u4e3a\u7a7a Cell() \u3002 \u6839\u636e\u6bcf\u4e00\u4e2a\u5355\u5143\u683c\u7684\u533a\u57df\uff08\u5408\u5e76\u5355\u5143\u683c\u5219\u8003\u8651\u6240\u6709\u5408\u5e76\u533a\u57df\uff09\u786e\u5b9a\u8fb9\u6846\u7684\u56db\u4e2a\u77e9\u5f62\uff1a\u4ece\u800c\u76f4\u63a5\u5f97\u5230\u5404\u4e2a\u8fb9\u6846\u7684\u5bbd\u5ea6\u548c\u989c\u8272\uff1b\u5e76\u6839\u636e\u5355\u5143\u683c\u533a\u57df\u68c0\u6d4b Fill \u7c7b\u578b\u7684\u77e9\u5f62\uff0c\u5b58\u5728\u5219\u5f97\u5230\u5355\u5143\u683c\u80cc\u666f\u8272\u3002 \u57fa\u4e8e\u8868\u683c\u7ed3\u6784\u786e\u5b9a\u5355\u5143\u683c\u5305\u542b\u7684\u6587\u672c \u5c06\u5305\u542b\u4e8e\u5355\u5143\u683c\u533a\u57df\u7684\u6587\u672c/\u56fe\u7247\u52a0\u5165\u5230\u76f8\u5e94\u5355\u5143\u683c\u3002\u6709\u65f6\u6587\u672c\u5757\u7684\u5212\u5206\u4e0e\u5355\u5143\u683c\u533a\u57df\u5e76\u4e0d\u4e25\u683c\u5339\u914d\uff0c\u9700\u8981\u6df1\u5165\u5230 block > line > span > char \u7ea7\u522b\u62c6\u5206\u539f\u59cb\u6587\u672c\u5757\u3002 \u5982\u679c\u4e24\u4e2a\u6587\u672c\u5757\u7269\u7406\u4e0a\u5904\u4e8e\u540c\u4e00\u884c\uff0c\u5219\u5408\u5e76\u4e3a\u4e00\u4e2a\u5927\u6587\u672c\u5757\u3002\u76ee\u7684\u662f\u521b\u5efaWord\u6587\u6863\u65f6\u4fdd\u8bc1\u6b63\u786e\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u56e0\u4e3a\u6bcf\u4e00\u4e2a\u6587\u672c\u5757\u5c06\u88ab\u4f5c\u4e3a\u72ec\u7acb\u7684\u6bb5\u843d\u3002 \u5f97\u5230\u8868\u683c\u7684\u4f4d\u7f6e\u53ca\u5c5e\u6027\u540e\uff0c\u9700\u8981\u8003\u8651\u80fd\u5426\u5728 python-docx \u4e2d\u91cd\u5efa\u3002\u597d\u5728\u6216\u8005\u76f4\u63a5\u4f7f\u7528API\u6216\u8005\u501f\u52a9 openxml \uff0c\u4ee5\u4e0b\u64cd\u4f5c\u90fd\u88ab python-docx \u652f\u6301\uff1a \u8868\u683c\u7f29\u8fdb 1 \u5408\u5e76\u5355\u5143\u683c cell.merge(other_cell) 2 \u884c\u9ad8 row.height \u53ca\u5355\u5143\u683c\u5bbd\u5ea6 cell.width 2 \u5355\u5143\u683c\u5185\u8fb9\u8ddd 3 \u5355\u5143\u683c\u8fb9\u6846\u989c\u8272\u548c\u5bbd\u5ea6 4 \u5355\u5143\u683c\u80cc\u666f\u8272 5 \u89e3\u6790\u9690\u5f0f\u8868\u683c \u00b6 \u5b9e\u9645\u4e0a\u5f88\u96be\u5b8c\u7f8e\u91cd\u5efa\u8bed\u4e49\u4e0a\u7684\u65e0\u8fb9\u7ebf\u8868\u683c\uff0c pdf2docx \u9000\u800c\u6c42\u5176\u6b21\uff0c\u53ea\u662f\u4e3a\u4e86\u4fdd\u8bc1\u4f4d\u7f6e\u5173\u7cfb\uff0c\u4ece\u201c\u770b\u8d77\u6765\u4e00\u6837\u201d\u7684\u89d2\u5ea6\u89e3\u6790\u9690\u5f0f\u8868\u683c\u3002\u57fa\u672c\u601d\u8def\uff1a \u4ece\u6587\u672c\u5757\u51fa\u53d1\uff0c\u786e\u5b9a\u5206\u9694\u7ebf\u5373\u8fb9\u7ebf\uff0c\u63a5\u4e0b\u6765\u4e0e\u663e\u5f0f\u8868\u683c\u7684\u5904\u7406\u6b65\u9aa4\u4e00\u81f4 \u3002 \u57fa\u4e8e\u6587\u672c\u5757\u4f4d\u7f6e\u5173\u7cfb\u68c0\u6d4b\u6f5c\u5728\u7684\u9690\u5f0f\u8868\u683c\u533a\u57df \u5982\u679c\u540c\u4e00\u6587\u672c\u5757\u5185 line \u7ea7\u522b\u5143\u7d20\u7ad6\u76f4\u65b9\u5411\u6709\u91cd\u53e0\u4f46\u7269\u7406\u4e0a\u4e0d\u662f\u4e25\u683c\u5904\u4e8e\u540c\u4e00\u884c\uff0c\u5b83\u5c06\u88ab\u89c6\u4e3a\u8868\u683c\u7684\u884c\u3002\u56e0\u4e3adocx\u91cd\u5efa\u65f6\uff0c\u666e\u901a\u6bb5\u843d\u65e0\u6cd5\u4fdd\u8bc1\u8fd9\u6837\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u6240\u4ee5\u5fc5\u987b\u52a0\u5165\u6f5c\u5728\u8868\u683c\u533a\u57df\uff0c\u540e\u7eed\u8fdb\u4e00\u6b65\u5212\u5206\u4e3a\u4e0d\u540c\u5217\u3002 \u5982\u679c\u540c\u4e00\u6587\u672c\u5757\u5185 line \u7ea7\u522b\u5143\u7d20\u51fa\u73b0\u591a\u6b21\u4e14\u76f8\u90bb\u4e4b\u95f4\u95f4\u9694\u4e00\u5b9a\u8ddd\u79bb\uff0c\u5404\u4e2a line \u5c06\u88ab\u89c6\u4e3a\u6f5c\u5728\u7684\u5355\u5143\u683c\uff0c\u56e0\u6b64\u6574\u4e2a\u6587\u672c\u5757\u88ab\u52a0\u5165\u6f5c\u5728\u8868\u683c\u533a\u57df\u3002 \u540c\u7406\uff0c\u5982\u679c\u76f8\u90bb\u4e24\u4e2a\u6587\u672c\u5757\u7269\u7406\u4e0a\u5904\u4e8e\u540c\u4e00\u884c\uff08\u7ad6\u76f4\u65b9\u5411\u6709\u91cd\u53e0\uff09\uff0c\u5b83\u4eec\u4e5f\u5c06\u88ab\u89c6\u4e3a\u8868\u683c\u533a\u57df\u3002 \u57fa\u4e8e\u4ee5\u4e0a\u6587\u672c\u5757\u7684 line \u7ea7\u522b\u7684\u5143\u7d20\u9012\u5f52\u68c0\u6d4b\u8fb9\u754c\u7ebf \u6309\u5217\u5206\u7ec4\uff0c\u76f8\u90bb\u4e24\u7ec4\u7684\u4e2d\u95f4\u7ebf\u5373\u4e3a\u5217\u8fb9\u754c\u3002\u56e0\u4e3a\u5217\u7684\u89d2\u5ea6\u6709\u5229\u4e8edocx\u91cd\u5efa\uff0c\u884c\u65b9\u5411\u4f1a\u56e0\u4e3a\u4e0d\u540c\u6587\u672c\u5757\u53e6\u8d77\u4e00\u6bb5\u800c\u7834\u574f\u4f4d\u7f6e\u5173\u7cfb\u3002 \u6bcf\u4e00\u7ec4\u5185\u6309\u884c\u5206\u7ec4\uff0c\u76f8\u90bb\u4e24\u7ec4\u7684\u4e2d\u95f4\u7ebf\u5373\u4e3a\u884c\u8fb9\u754c\u3002 \u91cd\u590d\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u76f4\u5230\u6bcf\u7ec4\u53ea\u6709\u5355\u4e00\u6587\u672c\u5757\u3002 \u5982\u4e0a\u5f97\u5230\u9690\u5f0f\u8868\u683c\u533a\u57df\u7684\u5047\u60f3\u8fb9\u6846\u7ebf\uff0c\u63a5\u4e0b\u6765\u6309\u7167\u663e\u5f0f\u8868\u683c\u6d41\u7a0b\u5904\u7406\u5373\u53ef\u3002 \u4ee5\u4e0a\u5c06\u76f8\u90bb\u4e24\u7ec4\u7684\u4e2d\u95f4\u7ebf\u4f5c\u4e3a\u5217\u8fb9\u754c\u7684\u5904\u7406\u65b9\u5f0f\u7b80\u5355\u5feb\u6377\uff0c\u4f46\u4e0d\u8db3\u4e4b\u5904\u662f\u4e0d\u540c\u884c\u4e2d\u7684\u5404\u5217\u8fb9\u754c\u53c2\u5dee\u4e0d\u9f50\uff0c\u4f7f\u8868\u683c\u7ed3\u6784\u590d\u6742\u5316\u3002\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u7c7b\u534a\u663e\u5f0f\u534a\u9690\u5f0f\u8868\u683c\uff0c\u5373\u5728\u9690\u5f0f\u8868\u683c\u7684\u57fa\u7840\u4e0a\uff0c\u53c8\u663e\u5f0f\u7ed9\u51fa\u4e86\u90e8\u5206\u8868\u683c\u7ebf\uff0c\u4f8b\u5982\u5e38\u89c1\u7684\u4e09\u7ebf\u8868\u3002\u8fd9\u4e9b\u90fd\u9700\u8981\u5728\u4e0a\u8ff0\u9690\u5f0f\u8868\u683c\u89e3\u6790\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u8868\u683c\u7ebf\u7684\u4f18\u5316\uff0c\u5177\u4f53\u53c2\u8003\u4e0b\u6587\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf \u6570\u636e\u7ed3\u6784 \u00b6 \u8868\u683c\u5757 TableBlock \u7ee7\u627f\u4e86\u5757\u5143\u7d20 Block \u7684\u7ed3\u6784\uff08\u8be6\u89c1 PDF\u63d0\u53d6 \uff09\uff0c\u540c\u65f6\u65b0\u589e\u4e86\u8868\u5f81\u8868\u683c\u7ed3\u6784\u7684 Row \u548c Cell \u3002\u5176\u4e2d Cell \u662f\u5e03\u5c40\u7ea7\u522b\u7684\u5bf9\u8c61\uff08 Layout \uff09\uff0c\u5d4c\u5957\u4e86\u4e0b\u4e00\u7ea7\u7684\u5757\u5143\u7d20\u548c\u5f62\u72b6\u5143\u7d20\uff0c\u5982\u6b64\u9012\u5f52\uff0c\u76f4\u5230\u5757\u5143\u7d20\u4e2d\u4e0d\u518d\u5305\u542b\u8868\u683c\uff0c\u5373\u53ea\u6709\u8868\u5f81\u6587\u672c\u548c\u56fe\u7247\u7684 TextBlock \u3002 { 'type': int, # 3-explicit table; 4-implicit table 'bbox': (float, float, float, float), ..., # some spacing properties same with Block \"rows\": [ { 'bbox': (float, float, float, float), 'height': float, 'cells': [ { 'bbox': (float, float, float, float), 'bg-color': int, 'border-color': (int, int, int, int), # top, right, bootom, left 'border-width': (float, float, float, float), 'merged-cells': (int, int), 'blocks': [ { # text/image blocks contained in current cell }, { ... } ]\uff0c 'shapes': [ { # shapes contained in current cell } { ... } ] }, ... # more cells ] }, ... # more rows ] } Using Python's docx library, how can a table be indented? \u21a9 Table objects \u21a9 \u21a9 How to set cell margins of tables in ms word using python docx \u21a9 How to setup cell borders with python-docx \u21a9 python docx set table cell background and text color \u21a9","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c"},{"location":"2020-08-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E8%A1%A8%E6%A0%BC/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-08-15 | \u5206\u7c7b\uff1a process automation PDF\u4e2d\u6ca1\u6709\u8bed\u4e49\u4e0a\u7684\u8868\u683c\u7684\u6982\u5ff5\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u5916\u89c2\u4e0a\u7684\u8868\u683c\uff0c\u5373\u8fb9\u6846\u7ebf\uff08 Stroke \u7c7b\u578b\u7684\u5f62\u72b6\uff09\u56f4\u6210\u7684\u533a\u57df\uff0c\u6765\u8bc6\u522b\u8bed\u4e49\u4e0a\u7684\u8868\u683c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u4e0d\u501f\u52a9\u6587\u672c\u6846\u7684\u8bdd Word \u4e0d\u652f\u6301\u6d6e\u52a8\u5e03\u5c40\uff0c\u8868\u73b0\u4e3a\u4e00\u6bb5\u6587\u5b57\u9ed8\u8ba4\u5360\u636e\u4e00\u6574\u884c\uff0c\u6240\u4ee5\u9700\u8981\u8868\u683c\u6765\u8fdb\u884c\u8f85\u52a9\u5e03\u5c40\uff0c\u4f8b\u5982\u591a\u5217\u6587\u672c\u3002\u4e8e\u662f\uff0c pdf2docx \u8003\u8651\u4e24\u7c7b\u8868\u683c\uff1a \u663e\u5f0f\u8868\u683c\uff08 Lattice Table \uff09\uff1a\u6709\u8fb9\u7ebf\uff0c\u7ec4\u7ec7\u7ed3\u6784\u5316\u7684\u5185\u5bb9 \u9690\u5f0f\u8868\u683c\uff08 Stream Table \uff09\uff1a\u65e0\u8fb9\u7ebf\uff0c\u65e2\u53ef\u80fd\u7528\u4e8e\u7ec4\u7ec7\u7ed3\u6784\u5316\u7684\u5185\u5bb9\uff08\u9690\u85cf\u8fb9\u6846\u7684\u8868\u683c\uff09\uff0c\u4e5f\u53ef\u80fd\u662f\u4e3a\u4e86\u9875\u9762\u5e03\u5c40\u7684\u9700\u8981","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c"},{"location":"2020-08-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E8%A1%A8%E6%A0%BC/#_1","text":"\u4ece\u8fb9\u7ebf\u51fa\u53d1\uff0c\u786e\u5b9a\u8868\u683c\u7ed3\u6784->\u5355\u5143\u683c\u5c5e\u6027->\u5355\u5143\u683c\u5185\u5bb9 \uff1a \u4ee5\u662f\u5426\u76f8\u4ea4\u4e3a\u4f9d\u636e\u5206\u7ec4 Stroke \u5143\u7d20\uff0c\u6bcf\u4e00\u7ec4\u5373\u4e3a\u6f5c\u5728\u7684\u8868\u683c\u533a\u57df\u5185\u7684\u8fb9\u6846\u7ebf\uff08table border\uff09\uff0c\u6839\u636e\u6f5c\u5728\u8868\u683c\u533a\u57df\u83b7\u53d6 Fill \u5355\u5143\u683c\u80cc\u666f\uff08cell shading\uff09\u3002 \u57fa\u4e8e\u8fb9\u6846\u7ebf\u786e\u5b9a\u8868\u683c\u7ed3\u6784 \u5224\u65ad\u662f\u5426\u5b58\u5728\u5916\u8fb9\u6846\u7ebf\uff0c\u6ca1\u6709\u5219\u52a0\u4e0a\u5047\u60f3\u7684\u5916\u8fb9\u6846\u7ebf\uff08\u767d\u8272\u3001\u5bbd\u5ea60\uff09\u3002 \u5c06\u8fb9\u6846\u7ebf\u6309\u6a2a\u3001\u7eb5\u5206\u7ec4\u5f97\u5230\u884c\u95f4\u9694\u7ebf\u548c\u5217\u95f4\u9694\u7ebf\uff0c\u6a2a\u7eb5\u95f4\u9694\u7ebf\u7684\u4ea4\u70b9\u7ec4\u6210\u4e86\u521d\u59cb\u7684\u672a\u8003\u8651\u5408\u5e76\u5355\u5143\u683c\u7684\u8868\u683c\u7ed3\u6784\u3002 \u5bf9\u4e8e\u6bcf\u4e00\u884c\uff0c\u68c0\u6d4b\u4e00\u6761\u5047\u60f3\u6c34\u5e73\u7ebf\u4e0e\u5217\u8fb9\u7ebf\u7684\u4ea4\u70b9\uff1a\u4e0d\u5b58\u5728\u4ea4\u70b9\u7684\u4f4d\u7f6e\u5373\u53d1\u751f\u4e86\u884c\u65b9\u5411\u7684\u5408\u5e76\u5355\u5143\u683c\uff1b\u540c\u7406\u68c0\u6d4b\u5217\u65b9\u5411\u7684\u5408\u5e76\u5355\u5143\u683c\u3002 \u57fa\u4e8e\u8868\u683c\u7ed3\u6784\u786e\u5b9a\u5355\u5143\u683c\u5c5e\u6027 \u4ee5\u5de6\u4e0a\u89d2\u5355\u5143\u683c\u8868\u793a\u5408\u5e76\u5355\u5143\u683c\u533a\u57df\uff0c\u88ab\u5408\u5e76\u7684\u5355\u5143\u683c\u521d\u59cb\u5316\u4e3a\u7a7a Cell() \u3002 \u6839\u636e\u6bcf\u4e00\u4e2a\u5355\u5143\u683c\u7684\u533a\u57df\uff08\u5408\u5e76\u5355\u5143\u683c\u5219\u8003\u8651\u6240\u6709\u5408\u5e76\u533a\u57df\uff09\u786e\u5b9a\u8fb9\u6846\u7684\u56db\u4e2a\u77e9\u5f62\uff1a\u4ece\u800c\u76f4\u63a5\u5f97\u5230\u5404\u4e2a\u8fb9\u6846\u7684\u5bbd\u5ea6\u548c\u989c\u8272\uff1b\u5e76\u6839\u636e\u5355\u5143\u683c\u533a\u57df\u68c0\u6d4b Fill \u7c7b\u578b\u7684\u77e9\u5f62\uff0c\u5b58\u5728\u5219\u5f97\u5230\u5355\u5143\u683c\u80cc\u666f\u8272\u3002 \u57fa\u4e8e\u8868\u683c\u7ed3\u6784\u786e\u5b9a\u5355\u5143\u683c\u5305\u542b\u7684\u6587\u672c \u5c06\u5305\u542b\u4e8e\u5355\u5143\u683c\u533a\u57df\u7684\u6587\u672c/\u56fe\u7247\u52a0\u5165\u5230\u76f8\u5e94\u5355\u5143\u683c\u3002\u6709\u65f6\u6587\u672c\u5757\u7684\u5212\u5206\u4e0e\u5355\u5143\u683c\u533a\u57df\u5e76\u4e0d\u4e25\u683c\u5339\u914d\uff0c\u9700\u8981\u6df1\u5165\u5230 block > line > span > char \u7ea7\u522b\u62c6\u5206\u539f\u59cb\u6587\u672c\u5757\u3002 \u5982\u679c\u4e24\u4e2a\u6587\u672c\u5757\u7269\u7406\u4e0a\u5904\u4e8e\u540c\u4e00\u884c\uff0c\u5219\u5408\u5e76\u4e3a\u4e00\u4e2a\u5927\u6587\u672c\u5757\u3002\u76ee\u7684\u662f\u521b\u5efaWord\u6587\u6863\u65f6\u4fdd\u8bc1\u6b63\u786e\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u56e0\u4e3a\u6bcf\u4e00\u4e2a\u6587\u672c\u5757\u5c06\u88ab\u4f5c\u4e3a\u72ec\u7acb\u7684\u6bb5\u843d\u3002 \u5f97\u5230\u8868\u683c\u7684\u4f4d\u7f6e\u53ca\u5c5e\u6027\u540e\uff0c\u9700\u8981\u8003\u8651\u80fd\u5426\u5728 python-docx \u4e2d\u91cd\u5efa\u3002\u597d\u5728\u6216\u8005\u76f4\u63a5\u4f7f\u7528API\u6216\u8005\u501f\u52a9 openxml \uff0c\u4ee5\u4e0b\u64cd\u4f5c\u90fd\u88ab python-docx \u652f\u6301\uff1a \u8868\u683c\u7f29\u8fdb 1 \u5408\u5e76\u5355\u5143\u683c cell.merge(other_cell) 2 \u884c\u9ad8 row.height \u53ca\u5355\u5143\u683c\u5bbd\u5ea6 cell.width 2 \u5355\u5143\u683c\u5185\u8fb9\u8ddd 3 \u5355\u5143\u683c\u8fb9\u6846\u989c\u8272\u548c\u5bbd\u5ea6 4 \u5355\u5143\u683c\u80cc\u666f\u8272 5","title":"\u89e3\u6790\u663e\u5f0f\u8868\u683c"},{"location":"2020-08-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E8%A1%A8%E6%A0%BC/#_2","text":"\u5b9e\u9645\u4e0a\u5f88\u96be\u5b8c\u7f8e\u91cd\u5efa\u8bed\u4e49\u4e0a\u7684\u65e0\u8fb9\u7ebf\u8868\u683c\uff0c pdf2docx \u9000\u800c\u6c42\u5176\u6b21\uff0c\u53ea\u662f\u4e3a\u4e86\u4fdd\u8bc1\u4f4d\u7f6e\u5173\u7cfb\uff0c\u4ece\u201c\u770b\u8d77\u6765\u4e00\u6837\u201d\u7684\u89d2\u5ea6\u89e3\u6790\u9690\u5f0f\u8868\u683c\u3002\u57fa\u672c\u601d\u8def\uff1a \u4ece\u6587\u672c\u5757\u51fa\u53d1\uff0c\u786e\u5b9a\u5206\u9694\u7ebf\u5373\u8fb9\u7ebf\uff0c\u63a5\u4e0b\u6765\u4e0e\u663e\u5f0f\u8868\u683c\u7684\u5904\u7406\u6b65\u9aa4\u4e00\u81f4 \u3002 \u57fa\u4e8e\u6587\u672c\u5757\u4f4d\u7f6e\u5173\u7cfb\u68c0\u6d4b\u6f5c\u5728\u7684\u9690\u5f0f\u8868\u683c\u533a\u57df \u5982\u679c\u540c\u4e00\u6587\u672c\u5757\u5185 line \u7ea7\u522b\u5143\u7d20\u7ad6\u76f4\u65b9\u5411\u6709\u91cd\u53e0\u4f46\u7269\u7406\u4e0a\u4e0d\u662f\u4e25\u683c\u5904\u4e8e\u540c\u4e00\u884c\uff0c\u5b83\u5c06\u88ab\u89c6\u4e3a\u8868\u683c\u7684\u884c\u3002\u56e0\u4e3adocx\u91cd\u5efa\u65f6\uff0c\u666e\u901a\u6bb5\u843d\u65e0\u6cd5\u4fdd\u8bc1\u8fd9\u6837\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u6240\u4ee5\u5fc5\u987b\u52a0\u5165\u6f5c\u5728\u8868\u683c\u533a\u57df\uff0c\u540e\u7eed\u8fdb\u4e00\u6b65\u5212\u5206\u4e3a\u4e0d\u540c\u5217\u3002 \u5982\u679c\u540c\u4e00\u6587\u672c\u5757\u5185 line \u7ea7\u522b\u5143\u7d20\u51fa\u73b0\u591a\u6b21\u4e14\u76f8\u90bb\u4e4b\u95f4\u95f4\u9694\u4e00\u5b9a\u8ddd\u79bb\uff0c\u5404\u4e2a line \u5c06\u88ab\u89c6\u4e3a\u6f5c\u5728\u7684\u5355\u5143\u683c\uff0c\u56e0\u6b64\u6574\u4e2a\u6587\u672c\u5757\u88ab\u52a0\u5165\u6f5c\u5728\u8868\u683c\u533a\u57df\u3002 \u540c\u7406\uff0c\u5982\u679c\u76f8\u90bb\u4e24\u4e2a\u6587\u672c\u5757\u7269\u7406\u4e0a\u5904\u4e8e\u540c\u4e00\u884c\uff08\u7ad6\u76f4\u65b9\u5411\u6709\u91cd\u53e0\uff09\uff0c\u5b83\u4eec\u4e5f\u5c06\u88ab\u89c6\u4e3a\u8868\u683c\u533a\u57df\u3002 \u57fa\u4e8e\u4ee5\u4e0a\u6587\u672c\u5757\u7684 line \u7ea7\u522b\u7684\u5143\u7d20\u9012\u5f52\u68c0\u6d4b\u8fb9\u754c\u7ebf \u6309\u5217\u5206\u7ec4\uff0c\u76f8\u90bb\u4e24\u7ec4\u7684\u4e2d\u95f4\u7ebf\u5373\u4e3a\u5217\u8fb9\u754c\u3002\u56e0\u4e3a\u5217\u7684\u89d2\u5ea6\u6709\u5229\u4e8edocx\u91cd\u5efa\uff0c\u884c\u65b9\u5411\u4f1a\u56e0\u4e3a\u4e0d\u540c\u6587\u672c\u5757\u53e6\u8d77\u4e00\u6bb5\u800c\u7834\u574f\u4f4d\u7f6e\u5173\u7cfb\u3002 \u6bcf\u4e00\u7ec4\u5185\u6309\u884c\u5206\u7ec4\uff0c\u76f8\u90bb\u4e24\u7ec4\u7684\u4e2d\u95f4\u7ebf\u5373\u4e3a\u884c\u8fb9\u754c\u3002 \u91cd\u590d\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u76f4\u5230\u6bcf\u7ec4\u53ea\u6709\u5355\u4e00\u6587\u672c\u5757\u3002 \u5982\u4e0a\u5f97\u5230\u9690\u5f0f\u8868\u683c\u533a\u57df\u7684\u5047\u60f3\u8fb9\u6846\u7ebf\uff0c\u63a5\u4e0b\u6765\u6309\u7167\u663e\u5f0f\u8868\u683c\u6d41\u7a0b\u5904\u7406\u5373\u53ef\u3002 \u4ee5\u4e0a\u5c06\u76f8\u90bb\u4e24\u7ec4\u7684\u4e2d\u95f4\u7ebf\u4f5c\u4e3a\u5217\u8fb9\u754c\u7684\u5904\u7406\u65b9\u5f0f\u7b80\u5355\u5feb\u6377\uff0c\u4f46\u4e0d\u8db3\u4e4b\u5904\u662f\u4e0d\u540c\u884c\u4e2d\u7684\u5404\u5217\u8fb9\u754c\u53c2\u5dee\u4e0d\u9f50\uff0c\u4f7f\u8868\u683c\u7ed3\u6784\u590d\u6742\u5316\u3002\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u7c7b\u534a\u663e\u5f0f\u534a\u9690\u5f0f\u8868\u683c\uff0c\u5373\u5728\u9690\u5f0f\u8868\u683c\u7684\u57fa\u7840\u4e0a\uff0c\u53c8\u663e\u5f0f\u7ed9\u51fa\u4e86\u90e8\u5206\u8868\u683c\u7ebf\uff0c\u4f8b\u5982\u5e38\u89c1\u7684\u4e09\u7ebf\u8868\u3002\u8fd9\u4e9b\u90fd\u9700\u8981\u5728\u4e0a\u8ff0\u9690\u5f0f\u8868\u683c\u89e3\u6790\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u8868\u683c\u7ebf\u7684\u4f18\u5316\uff0c\u5177\u4f53\u53c2\u8003\u4e0b\u6587\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf","title":"\u89e3\u6790\u9690\u5f0f\u8868\u683c"},{"location":"2020-08-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E8%A1%A8%E6%A0%BC/#_3","text":"\u8868\u683c\u5757 TableBlock \u7ee7\u627f\u4e86\u5757\u5143\u7d20 Block \u7684\u7ed3\u6784\uff08\u8be6\u89c1 PDF\u63d0\u53d6 \uff09\uff0c\u540c\u65f6\u65b0\u589e\u4e86\u8868\u5f81\u8868\u683c\u7ed3\u6784\u7684 Row \u548c Cell \u3002\u5176\u4e2d Cell \u662f\u5e03\u5c40\u7ea7\u522b\u7684\u5bf9\u8c61\uff08 Layout \uff09\uff0c\u5d4c\u5957\u4e86\u4e0b\u4e00\u7ea7\u7684\u5757\u5143\u7d20\u548c\u5f62\u72b6\u5143\u7d20\uff0c\u5982\u6b64\u9012\u5f52\uff0c\u76f4\u5230\u5757\u5143\u7d20\u4e2d\u4e0d\u518d\u5305\u542b\u8868\u683c\uff0c\u5373\u53ea\u6709\u8868\u5f81\u6587\u672c\u548c\u56fe\u7247\u7684 TextBlock \u3002 { 'type': int, # 3-explicit table; 4-implicit table 'bbox': (float, float, float, float), ..., # some spacing properties same with Block \"rows\": [ { 'bbox': (float, float, float, float), 'height': float, 'cells': [ { 'bbox': (float, float, float, float), 'bg-color': int, 'border-color': (int, int, int, int), # top, right, bootom, left 'border-width': (float, float, float, float), 'merged-cells': (int, int), 'blocks': [ { # text/image blocks contained in current cell }, { ... } ]\uff0c 'shapes': [ { # shapes contained in current cell } { ... } ] }, ... # more cells ] }, ... # more rows ] } Using Python's docx library, how can a table be indented? \u21a9 Table objects \u21a9 \u21a9 How to set cell margins of tables in ms word using python docx \u21a9 How to setup cell borders with python-docx \u21a9 python docx set table cell background and text color \u21a9","title":"\u6570\u636e\u7ed3\u6784"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-08-27 | \u5206\u7c7b\uff1a process automation \u7ecf\u8fc7 \u8868\u683c\u89e3\u6790 \u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u6574\u5408\u7684\u5757\u5143\u7d20\uff1a\u6587\u672c/\u56fe\u7247\u5757 TextBlock \u548c\u8868\u683c\u5757 TableBlock \u3002\u5176\u4e2d\u6587\u672c/\u56fe\u7247\u5757\u5c06\u88ab\u91cd\u5efa\u4e3a\u6bb5\u843d\uff0c\u8868\u683c\u5757\u5c06\u88ab\u91cd\u5efa\u4e3a\u8868\u683c\uff0c\u5355\u5143\u683c\u5185\u7684\u5757\u5143\u7d20\u6309\u7167\u76f8\u540c\u7684\u903b\u8f91\u8fdb\u884c\u9012\u5f52\u5904\u7406\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u8ba1\u7b97\u76f8\u90bb\u5143\u7d20\u4e4b\u95f4\u7684\u95f4\u8ddd\uff0c\u4f8b\u5982\u7ad6\u76f4\u65b9\u5411\u7684\u524d\u540e\u6bb5\u95f4\u8ddd\u3001\u6c34\u5e73\u65b9\u5411\u7684\u6bb5\u843d\u7f29\u8fdb\u3002 \u7ad6\u76f4\u65b9\u5411\u5b9a\u4f4d\uff1a\u6bb5\u95f4\u8ddd \u00b6 \u5757\u7ea7\u5143\u7d20\u4e4b\u95f4\u901a\u8fc7\u95f4\u8ddd\u786e\u5b9a\u76f8\u5bf9\u4f4d\u7f6e\u5173\u7cfb\u3002\u7531\u4e8eWord\u4e2d \u6bb5\u843d\u5177\u6709\u6bb5\u524d/\u6bb5\u540e\u95f4\u8ddd\u5c5e\u6027 \uff0c\u6587\u672c\u5757\u5c06\u88ab\u4f5c\u4e3a\u5b9a\u4f4d\u7684\u53c2\u8003\u5143\u7d20\u3002 \u7ad6\u76f4\u95f4\u8ddd\u786e\u5b9a\u539f\u5219\uff1a \u8003\u5bdf\u7ad6\u76f4\u65b9\u5411\u4e0a\u76f8\u90bb\u7684\u4e24\u4e2a\u5757\u7ea7\u5143\u7d20\uff0c\u524d\u4e00\u4e2a\u662f\u53c2\u8003\u5757\uff0c\u540e\u4e00\u4e2a\u662f\u5f53\u524d\u5757\u3002\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5757\u7ea7\u5143\u7d20\uff0c\u53c2\u8003\u5757\u662f\u4e0a\u8fb9\u8ddd\uff0c\u5f53\u524d\u5757\u5373\u4e3a\u81ea\u8eab\u3002 \u5982\u679c\u5f53\u524d\u662f\u6587\u672c\u5757\u6216\u8005\u56fe\u7247\u5757\uff08\u4e0d\u8bba\u53c2\u8003\u5757\u662f\u6587\u672c\u3001\u56fe\u7247\u8fd8\u662f\u8868\u683c\uff09\uff0c\u5219\u8bbe\u7f6e\u5f53\u524d\u5757\u7684\u6bb5\u524d\u95f4\u8ddd before_space \u4e3a\u4e8c\u8005\u4e4b\u95f4\u5782\u76f4\u8ddd\u79bb\u3002 \u5982\u679c\u5f53\u524d\u5757\u662f\u8868\u683c\u5757\uff0c\u5219\u8003\u5bdf\u53c2\u8003\u5757\uff1a \u5982\u679c\u53c2\u8003\u5757\u662f\u6587\u672c\u5757\u6216\u8005\u56fe\u7247\u5757\uff08\u6b64\u65f6\u5f53\u524d\u5757\u4e3a\u8868\u683c\uff09\uff0c\u5219\u8bbe\u7f6e\u53c2\u8003\u5757\u7684\u6bb5\u540e\u8ddd\u79bb after_space \u5982\u679c\u53c2\u8003\u5757\u8fd8\u662f\u8868\u683c\u5757\uff0c\u5219\u8bbe\u7f6e\u5f53\u524d\u5757\u7684\u6bb5\u524d\u95f4\u8ddd before_space \u6ce8\u610f docx \u4e2d\u65e0\u6cd5\u76f4\u63a5\u8bbe\u7f6e\u4e24\u4e2a\u8868\u683c\u7684\u95f4\u8ddd\uff0c\u521b\u5efa\u8868\u683c\u65f6\u91c7\u7528\u53d8\u901a\u65b9\u5f0f\uff1a\u5728\u95f4\u8ddd\u4e2d\u63d2\u5165\u7a7a\u6587\u672c\u5757\uff0c\u7136\u540e\u8bbe\u7f6e\u8be5\u6587\u672c\u5757\u7684\u6bb5\u524d\u95f4\u8ddd\u3002 \u5982\u679c\u8868\u683c\u5728\u672b\u5c3e\uff0c MS Word \u4f1a\u81ea\u52a8\u52a0\u4e00\u4e2a\u6807\u51c6\u95f4\u8ddd\u7684\u7a7a\u6bb5\u843d\uff0c\u8fd9\u6837\u53ef\u80fd\u5bfc\u81f4\u975e\u9884\u671f\u7684\u6362\u9875\u3002\u56e0\u6b64\uff0c\u6b64\u79cd\u60c5\u51b5\u6ce8\u610f\u4eba\u4e3a\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u6bb5\u843d\u5e76\u8bbe\u7f6e\u5176\u4e3a\u6700\u5c0f\u7684\u95f4\u8ddd\u503c\uff0c\u4f8b\u5982\u524d\u540e\u96f6\u95f4\u8ddd\uff0c\u884c\u9ad81\u78c5\u3002 \u7ad6\u76f4\u65b9\u5411\u5b9a\u4f4d\uff1a\u884c\u95f4\u8ddd \u00b6 \u5df2\u77e5\u5757\u7684\u9ad8\u5ea6\u548c\u5185\u90e8\u884c\u6570\uff0c\u5bb9\u6613\u8ba1\u7b97\u5f97\u5230\u5e73\u5747\u884c\u8ddd\u3002Word\u4e2d\u6709\u4e24\u79cd\u8bbe\u7f6e\u884c\u95f4\u8ddd\u7684\u65b9\u5f0f\uff1a \u56fa\u5b9a\u503c\uff1a\u76f4\u63a5\u8bbe\u7f6e\u4e3a\u8ba1\u7b97\u51fa\u7684\u5e73\u5747\u884c\u8ddd\uff0c\u4f18\u70b9\u662f\u5b9a\u4f4d\u7cbe\u786e\uff0c\u7f3a\u70b9\u662f\u4e0d\u4f1a\u968f\u7740\u5b57\u53f7\u7684\u53d8\u5316\u800c\u6539\u53d8\uff0c\u4e0d\u5229\u4e8e\u7f16\u8f91\u3002\u4f8b\u5982\u4e00\u65e6\u589e\u5927\u5b57\u53f7\uff0c\u5219\u6709\u53ef\u80fd\u5bfc\u81f4\u8be5\u884c\u6587\u672c\u663e\u793a\u4e0d\u5168\u3002 \u500d\u6570\u884c\u8ddd\uff1a\u4e0e\u5355\u500d\u884c\u8ddd\u7684\u6bd4\u503c\uff0c\u4f18\u7f3a\u70b9\u521a\u597d\u4e0e\u56fa\u5b9a\u884c\u8ddd\u76f8\u53cd\u3002 \u7efc\u5408\u6765\u770b\uff0c\u500d\u6570\u884c\u8ddd\u6709\u66f4\u597d\u7684\u9002\u5e94\u6027\uff0cv0.5.2\u7248\u5f00\u59cb\u542f\u7528\u500d\u6570\u884c\u8ddd\u3002 \u6ce8\u610f\uff0c\u500d\u6570\u884c\u8ddd\u5e76\u975e\u884c\u9ad8\u4e0e\u5b57\u53f7\u7684\u7b80\u5355\u6bd4\u503c\u6216\u8005\u6d41\u4f20\u76841.2\u500d\u7684\u6bd4\u4f8b\u5173\u7cfb\uff0c\u800c\u662f \u4e0e\u5177\u4f53\u5b57\u4f53\u76f8\u5173 \u3002\u5355\u5f00\u4e00\u7bc7\u4ecb\u7ecd\u500d\u6570\u884c\u8ddd\u8ba1\u7b97\u95ee\u9898\uff1a \u6b64\u5751\u5f85\u586b... \u6c34\u5e73\u65b9\u5411\u5b9a\u4f4d\uff1a\u5bf9\u9f50\u65b9\u5f0f\u4e0e\u7f29\u8fdb \u00b6 \u6c34\u5e73\u65b9\u5411\u4ece\u5185\u90e8\uff08\u5757\u5185\u5143\u7d20 Line \u7684\u5bf9\u9f50\u5173\u7cfb\uff09\u548c\u5916\u90e8\uff08\u9875\u9762\u4e2d\u7684\u4f4d\u7f6e\uff09\u4e24\u4e2a\u65b9\u9762\u786e\u5b9a\u5bf9\u9f50\u65b9\u5f0f\uff1a\u5de6/\u5c45\u4e2d/\u53f3/\u5206\u6563\u5bf9\u9f50\u3002\u5176\u4e2d\u5de6\u5bf9\u9f50\u4e3a\u9ed8\u8ba4\u65b9\u5f0f\uff0c\u56e0\u4e3a\u7ed3\u5408\u6bb5\u843d\u5de6\u7f29\u8fdb\u548c\u5236\u8868\u7b26\uff0c\u603b\u80fd\u6b63\u786e\u5b9a\u4f4d\u4efb\u4f55\u5757\u95f4\u5143\u7d20\u3002 \u5185\u90e8\u5bf9\u9f50\u5173\u7cfb \uff1a\u884c\u4e0e\u884c\u4e4b\u95f4\u4f4d\u7f6e\u5173\u7cfb \u5982\u679c\u5757\u5185\u6709\u4e0d\u8fde\u7eed\u7684\u884c\uff08\u76f8\u90bb line \u5b58\u5728\u660e\u663e\u7684\u95f4\u8ddd\uff09\uff0c\u5219\u8bbe\u4e3a\u5de6\u5bf9\u9f50\uff0c\u4ee5\u4fbf\u7ed3\u5408\u5236\u8868\u7b26\u5b9a\u4f4d \u5982\u679c\u53ea\u6709\u4e00\u884c\uff0c\u5219\u53c2\u8003\u5916\u90e8\u5bf9\u9f50\u5173\u7cfb \u5224\u65ad\u5404\u884c\u5de6\u8fb9\u8ddd\u3001\u53f3\u8fb9\u8ddd\u3001\u4e2d\u5fc3\u8ddd\u79bb\u5dee\u503c\u662f\u5426\u5c0f\u4e8e\u6307\u5b9a\u503c\uff0c\u5373\u662f\u5426\u5bf9\u9f50\uff1a \u5de6\u3001\u53f3\u90fd\u5bf9\u9f50\uff1a\u5982\u679c\u884c\u6570\u4e0d\u5c11\u4e8e3\u884c\uff0c\u5219\u4e3a\u5206\u6563\u5bf9\u9f50\uff0c\u5426\u5219\u4e0d\u80fd\u786e\u5b9a\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u53c2\u8003 \u5916\u90e8\u5bf9\u9f50\u5173\u7cfb\uff1b \u5426\u5219\uff0c\u4f9d\u6b21\u6309\u5de6\u5bf9\u9f50\u3001\u53f3\u5bf9\u9f50\u3001\u4e2d\u5fc3\u5bf9\u9f50\u5224\u65ad\u4e0b\u53bb \u6ce8\u610f \u5224\u65ad\u5de6\u5bf9\u9f50\u65f6\u6ce8\u610f\u6392\u9664\u7b2c\u4e00\u884c\uff0c\u56e0\u4e3a\u7b2c\u4e00\u884c\u53ef\u80fd\u7f29\u8fdb\u6216\u60ac\u6302\u7f29\u8fdb\uff1b\u5982\u679c\u6ee1\u8db3\u5de6\u5bf9\u9f50\uff0c\u8ba1\u7b97\u7b2c\u4e00\u884c\u7684\u7f29\u8fdb\u91cf\uff08\u8d1f\u503c\u8868\u793a\u60ac\u6302\u7f29\u8fdb\uff09\u3002 \u5224\u65ad\u53f3\u5bf9\u9f50\u65f6\u6ce8\u610f\u6392\u9664\u6700\u540e\u4e00\u884c\uff0c\u76ee\u7684\u662f\u8003\u8651\u5206\u6563\u5bf9\u9f50\u2014\u2014\u6700\u540e\u4e00\u884c\u53ef\u80fd\u4e0d\u6ee1\uff0c\u4f46\u4f9d\u65e7\u6ee1\u8db3\u5206\u6563\u5bf9\u9f50 \u5916\u90e8\u5bf9\u9f50\u5173\u7cfb \uff1a\u5757\u5728\u9875\u9762\u4e2d\u7684\u4f4d\u7f6e \u5206\u522b\u8ba1\u7b97\u5757\u4e0e\u9875\u9762\u7684\u8fb9\u8ddd\uff1a\u5de6\u8fb9\u8ddd\u3001\u53f3\u8fb9\u8ddd\u3001\u4e2d\u5fc3\u8ddd\u79bb\u5dee\u503c\uff0c\u7136\u540e\u987a\u5e8f\u5224\u65ad \u5757\u4e2d\u5fc3\u4e0e\u9875\u9762\u4e2d\u5fc3\u5dee\u503c\u5f88\u5c0f -> \u5c45\u4e2d\u5bf9\u9f50 \u4f9d\u6b21\u5224\u65ad\u5de6\u3001\u53f3\u8fb9\u8ddd\u5dee\u503c\uff0c\u54ea\u4e2a\u5dee\u503c\u5c0f\u5373\u4e3a\u76f8\u5e94\u5bf9\u9f50\u65b9\u5f0f \u6700\u540e\uff0c\u521b\u5efa docx \u65f6\u901a\u8fc7\u8bbe\u7f6e\u6bb5\u843d\u7684\u5de6/\u53f3\u7f29\u8fdb\u548c\u5bf9\u9f50\u65b9\u5f0f\u6765\u5b9e\u73b0\u3002\u5e76\u4e14\uff0c\u5de6\u5bf9\u9f50\u65b9\u5f0f\u8fd8\u8981\u901a\u8fc7 \u5236\u8868\u4f4d \u6765\u4fdd\u8bc1\u6bb5\u843d\u5185\u4e0d\u540c\u884c\u7684\u6c34\u5e73\u4f4d\u7f6e\u3002 \u91cd\u5efadocx\u65f6\u7684\u4e00\u4e9b\u4f18\u5316\u5904\u7406 \u540c\u65f6\u8bbe\u7f6e\u5de6\u3001\u53f3\u8fb9\u8ddd\u5c06\u4e25\u683c\u9650\u5b9a\u6bb5\u843d\u7684\u6c34\u5e73\u4f4d\u7f6e\uff0c\u53ef\u80fd\u5bfc\u81f4\u610f\u5916\u7684\u6362\u884c\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u9002\u5f53\u653e\u5bbd\u201c\u5bf9\u9762\u201d\u7684\u95f4\u8ddd\uff1a\u5de6\u5bf9\u9f50\u65f6\u653e\u5bbd\uff08\u51cf\u5c0f\uff09\u53f3\u8fb9\u8ddd\uff0c\u53f3\u5bf9\u9f50\u653e\u5bbd\u5de6\u8fb9\u8ddd\uff0c\u5c45\u4e2d\u5bf9\u9f50\u5219\u540c\u65f6\u653e\u5bbd\u5de6\u3001\u53f3\u8fb9\u8ddd\u3002 \u5982\u679c\u53ea\u6709\u4e00\u884c\uff0c\u5219\u5c06\u8fd9\u4e2a\u653e\u5bbd\u653e\u5230\u6781\u9650\uff0c\u5373\u8bbe\u7f6e\u76f8\u5e94\u8fb9\u8ddd\u7b49\u4e8e0\u3002 \u6587\u672c\u6837\u5f0f \u00b6 \u4ee5\u4e0a\u89e3\u6790\u7ed3\u679c\u786e\u5b9a\u4e86\u6bb5\u843d\u5728\u9875\u9762\u4e2d\u7684\u4f4d\u7f6e\u548c\u5448\u73b0\u6837\u5f0f\uff0c\u63a5\u4e0b\u6765\u6df1\u5165\u5230\u6bb5\u5185\u6587\u672c\u3002 PyMuPDF \u63d0\u53d6\u7684\u539f\u59cb\u6587\u672c\u5757\u81ea\u5e26\u4e86\u5b57\u4f53\u3001\u989c\u8272\u3001\u659c\u4f53\u3001\u7c97\u4f53\u7b49\u5c5e\u6027\uff0c\u4f46\u662f \u9ad8\u4eae \u3001 \u4e0b\u5212\u7ebf \u3001 \u5220\u9664\u7ebf \u7b49\u5177\u4f53\u6837\u5f0f\u9700\u8981\u8fdb\u4e00\u6b65\u6839\u636e \u6587\u672c\u548c\u5f62\u72b6\u7684\u4f4d\u7f6e\u5173\u7cfb \u6765\u5224\u5b9a\u3002 \u5177\u4f53\u53c2\u8003\u4e0b\u6587\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f \u6570\u636e\u7ed3\u6784 \u00b6 \u7efc\u4e0a\uff0c\u6587\u672c\u5757 TextBlock \u5728\u6807\u51c6 Block \u6570\u636e\u7ed3\u6784\uff08 Line -> Span -> Char \uff09\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u4e86\u5982\u4e0b\u5b9a\u4f4d\u76f8\u5173\u5c5e\u6027\uff1a # text block { \"type\": 0, \"bbox\": [float, float, float, float], # ----- vertical spacing ----- \"before_space\": float, \"line_space\": float, \"after_space\": float # ----- horizontal spacing ----- \"alignment\": int, \"left_space\": float, \"right_space\": float, \"first_line_space\": float, \"tab_stops\": [float, float, ...], \"lines\": [ { \"bbox\": [float, float, float, float], \"wmode\": int, \"dir\": [float, float], \"line_break\": int, # new property \"tab_stop\": int, # new property \"spans\": [ { \"bbox\": [float, float, float, float], \"color\": int, \"font\": str, \"size\": float, \"flags\": int, \"text\": str, \"chars\": [{ \"bbox\": [float, float, float, float], \"c\": str }] } ] } ] }","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-08-27 | \u5206\u7c7b\uff1a process automation \u7ecf\u8fc7 \u8868\u683c\u89e3\u6790 \u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u6574\u5408\u7684\u5757\u5143\u7d20\uff1a\u6587\u672c/\u56fe\u7247\u5757 TextBlock \u548c\u8868\u683c\u5757 TableBlock \u3002\u5176\u4e2d\u6587\u672c/\u56fe\u7247\u5757\u5c06\u88ab\u91cd\u5efa\u4e3a\u6bb5\u843d\uff0c\u8868\u683c\u5757\u5c06\u88ab\u91cd\u5efa\u4e3a\u8868\u683c\uff0c\u5355\u5143\u683c\u5185\u7684\u5757\u5143\u7d20\u6309\u7167\u76f8\u540c\u7684\u903b\u8f91\u8fdb\u884c\u9012\u5f52\u5904\u7406\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u8ba1\u7b97\u76f8\u90bb\u5143\u7d20\u4e4b\u95f4\u7684\u95f4\u8ddd\uff0c\u4f8b\u5982\u7ad6\u76f4\u65b9\u5411\u7684\u524d\u540e\u6bb5\u95f4\u8ddd\u3001\u6c34\u5e73\u65b9\u5411\u7684\u6bb5\u843d\u7f29\u8fdb\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/#_1","text":"\u5757\u7ea7\u5143\u7d20\u4e4b\u95f4\u901a\u8fc7\u95f4\u8ddd\u786e\u5b9a\u76f8\u5bf9\u4f4d\u7f6e\u5173\u7cfb\u3002\u7531\u4e8eWord\u4e2d \u6bb5\u843d\u5177\u6709\u6bb5\u524d/\u6bb5\u540e\u95f4\u8ddd\u5c5e\u6027 \uff0c\u6587\u672c\u5757\u5c06\u88ab\u4f5c\u4e3a\u5b9a\u4f4d\u7684\u53c2\u8003\u5143\u7d20\u3002 \u7ad6\u76f4\u95f4\u8ddd\u786e\u5b9a\u539f\u5219\uff1a \u8003\u5bdf\u7ad6\u76f4\u65b9\u5411\u4e0a\u76f8\u90bb\u7684\u4e24\u4e2a\u5757\u7ea7\u5143\u7d20\uff0c\u524d\u4e00\u4e2a\u662f\u53c2\u8003\u5757\uff0c\u540e\u4e00\u4e2a\u662f\u5f53\u524d\u5757\u3002\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5757\u7ea7\u5143\u7d20\uff0c\u53c2\u8003\u5757\u662f\u4e0a\u8fb9\u8ddd\uff0c\u5f53\u524d\u5757\u5373\u4e3a\u81ea\u8eab\u3002 \u5982\u679c\u5f53\u524d\u662f\u6587\u672c\u5757\u6216\u8005\u56fe\u7247\u5757\uff08\u4e0d\u8bba\u53c2\u8003\u5757\u662f\u6587\u672c\u3001\u56fe\u7247\u8fd8\u662f\u8868\u683c\uff09\uff0c\u5219\u8bbe\u7f6e\u5f53\u524d\u5757\u7684\u6bb5\u524d\u95f4\u8ddd before_space \u4e3a\u4e8c\u8005\u4e4b\u95f4\u5782\u76f4\u8ddd\u79bb\u3002 \u5982\u679c\u5f53\u524d\u5757\u662f\u8868\u683c\u5757\uff0c\u5219\u8003\u5bdf\u53c2\u8003\u5757\uff1a \u5982\u679c\u53c2\u8003\u5757\u662f\u6587\u672c\u5757\u6216\u8005\u56fe\u7247\u5757\uff08\u6b64\u65f6\u5f53\u524d\u5757\u4e3a\u8868\u683c\uff09\uff0c\u5219\u8bbe\u7f6e\u53c2\u8003\u5757\u7684\u6bb5\u540e\u8ddd\u79bb after_space \u5982\u679c\u53c2\u8003\u5757\u8fd8\u662f\u8868\u683c\u5757\uff0c\u5219\u8bbe\u7f6e\u5f53\u524d\u5757\u7684\u6bb5\u524d\u95f4\u8ddd before_space \u6ce8\u610f docx \u4e2d\u65e0\u6cd5\u76f4\u63a5\u8bbe\u7f6e\u4e24\u4e2a\u8868\u683c\u7684\u95f4\u8ddd\uff0c\u521b\u5efa\u8868\u683c\u65f6\u91c7\u7528\u53d8\u901a\u65b9\u5f0f\uff1a\u5728\u95f4\u8ddd\u4e2d\u63d2\u5165\u7a7a\u6587\u672c\u5757\uff0c\u7136\u540e\u8bbe\u7f6e\u8be5\u6587\u672c\u5757\u7684\u6bb5\u524d\u95f4\u8ddd\u3002 \u5982\u679c\u8868\u683c\u5728\u672b\u5c3e\uff0c MS Word \u4f1a\u81ea\u52a8\u52a0\u4e00\u4e2a\u6807\u51c6\u95f4\u8ddd\u7684\u7a7a\u6bb5\u843d\uff0c\u8fd9\u6837\u53ef\u80fd\u5bfc\u81f4\u975e\u9884\u671f\u7684\u6362\u9875\u3002\u56e0\u6b64\uff0c\u6b64\u79cd\u60c5\u51b5\u6ce8\u610f\u4eba\u4e3a\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u6bb5\u843d\u5e76\u8bbe\u7f6e\u5176\u4e3a\u6700\u5c0f\u7684\u95f4\u8ddd\u503c\uff0c\u4f8b\u5982\u524d\u540e\u96f6\u95f4\u8ddd\uff0c\u884c\u9ad81\u78c5\u3002","title":"\u7ad6\u76f4\u65b9\u5411\u5b9a\u4f4d\uff1a\u6bb5\u95f4\u8ddd"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/#_2","text":"\u5df2\u77e5\u5757\u7684\u9ad8\u5ea6\u548c\u5185\u90e8\u884c\u6570\uff0c\u5bb9\u6613\u8ba1\u7b97\u5f97\u5230\u5e73\u5747\u884c\u8ddd\u3002Word\u4e2d\u6709\u4e24\u79cd\u8bbe\u7f6e\u884c\u95f4\u8ddd\u7684\u65b9\u5f0f\uff1a \u56fa\u5b9a\u503c\uff1a\u76f4\u63a5\u8bbe\u7f6e\u4e3a\u8ba1\u7b97\u51fa\u7684\u5e73\u5747\u884c\u8ddd\uff0c\u4f18\u70b9\u662f\u5b9a\u4f4d\u7cbe\u786e\uff0c\u7f3a\u70b9\u662f\u4e0d\u4f1a\u968f\u7740\u5b57\u53f7\u7684\u53d8\u5316\u800c\u6539\u53d8\uff0c\u4e0d\u5229\u4e8e\u7f16\u8f91\u3002\u4f8b\u5982\u4e00\u65e6\u589e\u5927\u5b57\u53f7\uff0c\u5219\u6709\u53ef\u80fd\u5bfc\u81f4\u8be5\u884c\u6587\u672c\u663e\u793a\u4e0d\u5168\u3002 \u500d\u6570\u884c\u8ddd\uff1a\u4e0e\u5355\u500d\u884c\u8ddd\u7684\u6bd4\u503c\uff0c\u4f18\u7f3a\u70b9\u521a\u597d\u4e0e\u56fa\u5b9a\u884c\u8ddd\u76f8\u53cd\u3002 \u7efc\u5408\u6765\u770b\uff0c\u500d\u6570\u884c\u8ddd\u6709\u66f4\u597d\u7684\u9002\u5e94\u6027\uff0cv0.5.2\u7248\u5f00\u59cb\u542f\u7528\u500d\u6570\u884c\u8ddd\u3002 \u6ce8\u610f\uff0c\u500d\u6570\u884c\u8ddd\u5e76\u975e\u884c\u9ad8\u4e0e\u5b57\u53f7\u7684\u7b80\u5355\u6bd4\u503c\u6216\u8005\u6d41\u4f20\u76841.2\u500d\u7684\u6bd4\u4f8b\u5173\u7cfb\uff0c\u800c\u662f \u4e0e\u5177\u4f53\u5b57\u4f53\u76f8\u5173 \u3002\u5355\u5f00\u4e00\u7bc7\u4ecb\u7ecd\u500d\u6570\u884c\u8ddd\u8ba1\u7b97\u95ee\u9898\uff1a \u6b64\u5751\u5f85\u586b...","title":"\u7ad6\u76f4\u65b9\u5411\u5b9a\u4f4d\uff1a\u884c\u95f4\u8ddd"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/#_3","text":"\u6c34\u5e73\u65b9\u5411\u4ece\u5185\u90e8\uff08\u5757\u5185\u5143\u7d20 Line \u7684\u5bf9\u9f50\u5173\u7cfb\uff09\u548c\u5916\u90e8\uff08\u9875\u9762\u4e2d\u7684\u4f4d\u7f6e\uff09\u4e24\u4e2a\u65b9\u9762\u786e\u5b9a\u5bf9\u9f50\u65b9\u5f0f\uff1a\u5de6/\u5c45\u4e2d/\u53f3/\u5206\u6563\u5bf9\u9f50\u3002\u5176\u4e2d\u5de6\u5bf9\u9f50\u4e3a\u9ed8\u8ba4\u65b9\u5f0f\uff0c\u56e0\u4e3a\u7ed3\u5408\u6bb5\u843d\u5de6\u7f29\u8fdb\u548c\u5236\u8868\u7b26\uff0c\u603b\u80fd\u6b63\u786e\u5b9a\u4f4d\u4efb\u4f55\u5757\u95f4\u5143\u7d20\u3002 \u5185\u90e8\u5bf9\u9f50\u5173\u7cfb \uff1a\u884c\u4e0e\u884c\u4e4b\u95f4\u4f4d\u7f6e\u5173\u7cfb \u5982\u679c\u5757\u5185\u6709\u4e0d\u8fde\u7eed\u7684\u884c\uff08\u76f8\u90bb line \u5b58\u5728\u660e\u663e\u7684\u95f4\u8ddd\uff09\uff0c\u5219\u8bbe\u4e3a\u5de6\u5bf9\u9f50\uff0c\u4ee5\u4fbf\u7ed3\u5408\u5236\u8868\u7b26\u5b9a\u4f4d \u5982\u679c\u53ea\u6709\u4e00\u884c\uff0c\u5219\u53c2\u8003\u5916\u90e8\u5bf9\u9f50\u5173\u7cfb \u5224\u65ad\u5404\u884c\u5de6\u8fb9\u8ddd\u3001\u53f3\u8fb9\u8ddd\u3001\u4e2d\u5fc3\u8ddd\u79bb\u5dee\u503c\u662f\u5426\u5c0f\u4e8e\u6307\u5b9a\u503c\uff0c\u5373\u662f\u5426\u5bf9\u9f50\uff1a \u5de6\u3001\u53f3\u90fd\u5bf9\u9f50\uff1a\u5982\u679c\u884c\u6570\u4e0d\u5c11\u4e8e3\u884c\uff0c\u5219\u4e3a\u5206\u6563\u5bf9\u9f50\uff0c\u5426\u5219\u4e0d\u80fd\u786e\u5b9a\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u53c2\u8003 \u5916\u90e8\u5bf9\u9f50\u5173\u7cfb\uff1b \u5426\u5219\uff0c\u4f9d\u6b21\u6309\u5de6\u5bf9\u9f50\u3001\u53f3\u5bf9\u9f50\u3001\u4e2d\u5fc3\u5bf9\u9f50\u5224\u65ad\u4e0b\u53bb \u6ce8\u610f \u5224\u65ad\u5de6\u5bf9\u9f50\u65f6\u6ce8\u610f\u6392\u9664\u7b2c\u4e00\u884c\uff0c\u56e0\u4e3a\u7b2c\u4e00\u884c\u53ef\u80fd\u7f29\u8fdb\u6216\u60ac\u6302\u7f29\u8fdb\uff1b\u5982\u679c\u6ee1\u8db3\u5de6\u5bf9\u9f50\uff0c\u8ba1\u7b97\u7b2c\u4e00\u884c\u7684\u7f29\u8fdb\u91cf\uff08\u8d1f\u503c\u8868\u793a\u60ac\u6302\u7f29\u8fdb\uff09\u3002 \u5224\u65ad\u53f3\u5bf9\u9f50\u65f6\u6ce8\u610f\u6392\u9664\u6700\u540e\u4e00\u884c\uff0c\u76ee\u7684\u662f\u8003\u8651\u5206\u6563\u5bf9\u9f50\u2014\u2014\u6700\u540e\u4e00\u884c\u53ef\u80fd\u4e0d\u6ee1\uff0c\u4f46\u4f9d\u65e7\u6ee1\u8db3\u5206\u6563\u5bf9\u9f50 \u5916\u90e8\u5bf9\u9f50\u5173\u7cfb \uff1a\u5757\u5728\u9875\u9762\u4e2d\u7684\u4f4d\u7f6e \u5206\u522b\u8ba1\u7b97\u5757\u4e0e\u9875\u9762\u7684\u8fb9\u8ddd\uff1a\u5de6\u8fb9\u8ddd\u3001\u53f3\u8fb9\u8ddd\u3001\u4e2d\u5fc3\u8ddd\u79bb\u5dee\u503c\uff0c\u7136\u540e\u987a\u5e8f\u5224\u65ad \u5757\u4e2d\u5fc3\u4e0e\u9875\u9762\u4e2d\u5fc3\u5dee\u503c\u5f88\u5c0f -> \u5c45\u4e2d\u5bf9\u9f50 \u4f9d\u6b21\u5224\u65ad\u5de6\u3001\u53f3\u8fb9\u8ddd\u5dee\u503c\uff0c\u54ea\u4e2a\u5dee\u503c\u5c0f\u5373\u4e3a\u76f8\u5e94\u5bf9\u9f50\u65b9\u5f0f \u6700\u540e\uff0c\u521b\u5efa docx \u65f6\u901a\u8fc7\u8bbe\u7f6e\u6bb5\u843d\u7684\u5de6/\u53f3\u7f29\u8fdb\u548c\u5bf9\u9f50\u65b9\u5f0f\u6765\u5b9e\u73b0\u3002\u5e76\u4e14\uff0c\u5de6\u5bf9\u9f50\u65b9\u5f0f\u8fd8\u8981\u901a\u8fc7 \u5236\u8868\u4f4d \u6765\u4fdd\u8bc1\u6bb5\u843d\u5185\u4e0d\u540c\u884c\u7684\u6c34\u5e73\u4f4d\u7f6e\u3002 \u91cd\u5efadocx\u65f6\u7684\u4e00\u4e9b\u4f18\u5316\u5904\u7406 \u540c\u65f6\u8bbe\u7f6e\u5de6\u3001\u53f3\u8fb9\u8ddd\u5c06\u4e25\u683c\u9650\u5b9a\u6bb5\u843d\u7684\u6c34\u5e73\u4f4d\u7f6e\uff0c\u53ef\u80fd\u5bfc\u81f4\u610f\u5916\u7684\u6362\u884c\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u9002\u5f53\u653e\u5bbd\u201c\u5bf9\u9762\u201d\u7684\u95f4\u8ddd\uff1a\u5de6\u5bf9\u9f50\u65f6\u653e\u5bbd\uff08\u51cf\u5c0f\uff09\u53f3\u8fb9\u8ddd\uff0c\u53f3\u5bf9\u9f50\u653e\u5bbd\u5de6\u8fb9\u8ddd\uff0c\u5c45\u4e2d\u5bf9\u9f50\u5219\u540c\u65f6\u653e\u5bbd\u5de6\u3001\u53f3\u8fb9\u8ddd\u3002 \u5982\u679c\u53ea\u6709\u4e00\u884c\uff0c\u5219\u5c06\u8fd9\u4e2a\u653e\u5bbd\u653e\u5230\u6781\u9650\uff0c\u5373\u8bbe\u7f6e\u76f8\u5e94\u8fb9\u8ddd\u7b49\u4e8e0\u3002","title":"\u6c34\u5e73\u65b9\u5411\u5b9a\u4f4d\uff1a\u5bf9\u9f50\u65b9\u5f0f\u4e0e\u7f29\u8fdb"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/#_4","text":"\u4ee5\u4e0a\u89e3\u6790\u7ed3\u679c\u786e\u5b9a\u4e86\u6bb5\u843d\u5728\u9875\u9762\u4e2d\u7684\u4f4d\u7f6e\u548c\u5448\u73b0\u6837\u5f0f\uff0c\u63a5\u4e0b\u6765\u6df1\u5165\u5230\u6bb5\u5185\u6587\u672c\u3002 PyMuPDF \u63d0\u53d6\u7684\u539f\u59cb\u6587\u672c\u5757\u81ea\u5e26\u4e86\u5b57\u4f53\u3001\u989c\u8272\u3001\u659c\u4f53\u3001\u7c97\u4f53\u7b49\u5c5e\u6027\uff0c\u4f46\u662f \u9ad8\u4eae \u3001 \u4e0b\u5212\u7ebf \u3001 \u5220\u9664\u7ebf \u7b49\u5177\u4f53\u6837\u5f0f\u9700\u8981\u8fdb\u4e00\u6b65\u6839\u636e \u6587\u672c\u548c\u5f62\u72b6\u7684\u4f4d\u7f6e\u5173\u7cfb \u6765\u5224\u5b9a\u3002 \u5177\u4f53\u53c2\u8003\u4e0b\u6587\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f","title":"\u6587\u672c\u6837\u5f0f"},{"location":"2020-08-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E6%AE%B5%E8%90%BD/#_5","text":"\u7efc\u4e0a\uff0c\u6587\u672c\u5757 TextBlock \u5728\u6807\u51c6 Block \u6570\u636e\u7ed3\u6784\uff08 Line -> Span -> Char \uff09\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u4e86\u5982\u4e0b\u5b9a\u4f4d\u76f8\u5173\u5c5e\u6027\uff1a # text block { \"type\": 0, \"bbox\": [float, float, float, float], # ----- vertical spacing ----- \"before_space\": float, \"line_space\": float, \"after_space\": float # ----- horizontal spacing ----- \"alignment\": int, \"left_space\": float, \"right_space\": float, \"first_line_space\": float, \"tab_stops\": [float, float, ...], \"lines\": [ { \"bbox\": [float, float, float, float], \"wmode\": int, \"dir\": [float, float], \"line_break\": int, # new property \"tab_stop\": int, # new property \"spans\": [ { \"bbox\": [float, float, float, float], \"color\": int, \"font\": str, \"size\": float, \"flags\": int, \"text\": str, \"chars\": [{ \"bbox\": [float, float, float, float], \"c\": str }] } ] } ] }","title":"\u6570\u636e\u7ed3\u6784"},{"location":"2020-09-01-%E6%B1%82%E8%A7%A3%E7%9F%A9%E5%BD%A2%E7%9B%B8%E4%BA%A4%E9%97%AE%E9%A2%98/","text":"\u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-09-01 | \u5206\u7c7b\uff1a mathematics \u672c\u6587\u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898\uff08Rectangle Intersection Problem\uff09\uff1a\u5df2\u77e5 n \u4e2a\u6c34\u5e73\u6216\u8005\u7ad6\u76f4\u653e\u7f6e\u7684\u77e9\u5f62\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u77e9\u5f62\uff0c\u6c42\u6240\u6709\u4e0e\u4e4b\u76f8\u4ea4\u7684\u77e9\u5f62\u3002\u4e00\u5f00\u59cb\u91c7\u7528\u4e86\u66b4\u529b\u6c42\u89e3\u7684\u65b9\u5f0f\uff0cO(n^2)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5728 n<2000 \u65f6\u5c1a\u80fd\u63a5\u53d7\uff08~0.6s\uff09\uff0c\u7ee7\u7eed\u589e\u5927 n \u5219\u5bfc\u81f4\u8ba1\u7b97\u65f6\u95f4\u7206\u70b8\u4e86\u3002\u5b9e\u9645\u4e0a\uff0c\u77e9\u5f62\u6c42\u4ea4\u662f\u4e00\u4e2a\u7814\u7a76\u8fc7\u7684\u95ee\u9898\uff0c\u672c\u6587\u53c2\u8003\u4e00\u7bc7\u8bba\u6587\u4e2d\u7684\u7b97\u6cd5\u8fdb\u884c\u4e86\u5b9e\u73b0\u3002 \u4ece\u5224\u65ad\u4e24\u4e2a\u77e9\u5f62\u662f\u5426\u76f8\u4ea4\u5f00\u59cb \u00b6 \u9996\u5148\uff0c\u4f7f\u7528\u5de6\u4e0b\u89d2 (x0,y0) \u548c\u53f3\u4e0a\u89d2 (x1,y1) \u4e24\u4e2a\u70b9\u6765\u63cf\u8ff0\u4e00\u4e2a\u6807\u51c6\u77e9\u5f62\uff1a ^ y | | (x1, y1) 4 | +-----+ +-------------+ | |A | |C | 3 | | | +-------------+ | | | | |B | | | 2 | +-----+ | +-------------+ |(x0, y0) | | 1 | +-------------+ | x +--------------------------------------> 0 1 2 3 4 5 \u6709\u591a\u79cd\u601d\u8def\u53ef\u4ee5\u5224\u65ad\u76f8\u4ea4\uff0c\u4f8b\u5982\uff0c\u4e24\u4e2a\u77e9\u5f62\u4e2d\u5fc3\u8ddd\u79bb\u6295\u5f71\u4e0e\u8fb9\u957f\u7684\u5173\u7cfb\u3002\u8fd9\u91cc\u4ece\u4e0b\u56fe\u6240\u793a\u56db\u79cd\u4e0d\u76f8\u4ea4\u7684\u60c5\u51b5\u5165\u624b\uff0c\u5176\u53cd\u9762\u5373\u4e3a\u76f8\u4ea4\uff1a B\u5b8c\u5168\u5728A\u7684\u4e0a\u65b9\uff1a B.y0 > A.y1 B\u5b8c\u5168\u5728A\u7684\u4e0b\u65b9\uff1a B.y1 < A.y0 B\u5b8c\u5168\u5728A\u7684\u5de6\u8fb9\uff1a B.x1 < A.x0 B\u5b8c\u5168\u5728A\u7684\u53f3\u8fb9\uff1a B.x0 > A.x1 +----+ +--------------------+ | | | B | | | +--------------------+ | | +----+ | | +----------+ | | | B | | | | | | | | A | | | | | | | | B | | | | | | | | | +----------+ | | +----+ | | +---------------------+ | | | B | | | +---------------------+ +----+ \u7efc\u5408\u4ee5\u4e0a\uff0c\u5f97\u5230\u77e9\u5f62\u7c7b\u53ca\u5176\u5224\u65ad\u76f8\u4ea4\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a class Rect: def __init__(self, points): assert len(points)==4, 'invalid input' self.x0, self.y0, self.x1, self.y1 = points def intersects(self, rect): ''' if intersects with `rect`.''' non_intersection = rect.x1<self.x0 or \\ rect.x0>self.x1 or \\ rect.y1<self.y0 or \\ rect.y0>self.y1 return not non_intersection \u66b4\u529b\u6c42\u89e3 \u00b6 \u65e2\u7136\u5df2\u7ecf\u6709\u4e86\u5224\u65ad\u4e24\u4e2a\u77e9\u5f62\u662f\u5426\u76f8\u4ea4\u7684\u65b9\u6cd5\uff0c\u81ea\u7136\u60f3\u5230\u4e24\u4e24\u5224\u65ad\u6240\u6709\u77e9\u5f62\u7684\u66b4\u529b\u6c42\u89e3\u65b9\u6cd5\u3002\u6700\u540e\u7528\u4e00\u4e2a\u5217\u8868\u8868\u793a\u5404\u4e2a\u77e9\u5f62\u7684\u76f8\u4ea4\u77e9\u5f62\uff0c graph = [set() for i in range(num)] \uff0c\u4e5f\u5c31\u662f\u90bb\u63a5\u8868\u8868\u793a\u7684\u56fe\u7ed3\u6784\u3002 class Rects: '''Collection of Rect instances.''' def __init__(self): self._rects = [] # type: list[Rect] def append(self, instance): self._rects.append(instance) def build_graph(self): '''calculate the connectivity between every two rects by brute force method.''' num = len(self._rects) graph = [set() for i in range(num)] for i in range(num): for j in range(i+1, num): if self._rects[i].intersects(self._rects[j]): graph[i].add(j) graph[j].add(i) return graph if __name__ == '__main__': inputs = [(0.5,2,1.5,4), (2,1,4,3), (3,2,5,4)] # initialize Rects R = Rects() for points in inputs: R.append(Rect(points)) # solving rectangle intersection graph = R.build_graph() print(graph) # output: # [set(), {2}, {1}] \u4ee5\u4e0a\u8ba1\u7b97\u793a\u4f8b\u5373\u4e3a\u4e0a\u56fe\u4e2d\u7684\u77e9\u5f62 A \u3001 B \u548c C \uff0c\u7ed3\u679c\u4e0e\u9884\u671f\u76f8\u7b26\uff1a A \u6ca1\u6709\u76f8\u4ea4\u77e9\u5f62\uff0c B \u4e0e C \u76f8\u4ea4\uff0c C \u4e0e B \u76f8\u4ea4\u3002 \u4f18\u5316\u7684\u6c42\u89e3\u7b97\u6cd5 \u00b6 \u66b4\u529b\u65b9\u6cd5\u7b80\u5355\u6613\u884c\uff0c\u4f46\u968f\u7740\u8f93\u5165\u6570\u91cf\u589e\u5927\uff0c\u6027\u80fd\u6025\u5267\u4e0b\u964d\u3002\u4e8e\u662f\u5bfb\u6c42\u4e00\u79cd\u4f18\u5316\u7684\u7b97\u6cd5\uff0c\u57fa\u672c\u65b9\u5411\u6709\u4e24\u4e2a\uff1a \u4ee5O(n*logn)\u4ee3\u4ef7\u6cbf\u7740\u4e00\u4e2a\u7ef4\u5ea6\u5bf9\u77e9\u5f62\u6392\u5e8f\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u6bcf\u4e24\u4e2a\u77e9\u5f62\u90fd\u8981\u8fdb\u884c\u4e00\u6b21\u5224\u65ad \u5728\u4e00\u4e2a\u7ef4\u5ea6\u7684\u6295\u5f71\u6709\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u9700\u6309\u533a\u95f4\u5224\u65ad\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u7684\u76f8\u4ea4\u60c5\u51b5 \u672c\u6587\u5bf9\u5982\u4e0b\u8bba\u6587\u63d0\u51fa\u7684\u7b97\u6cd5\u8fdb\u884c\u4e86\u5b9e\u73b0\uff1a A Rectangle-Intersection Algorithm with Limited Resource Requirements \u7b97\u6cd5\u5927\u610f\uff1a \u53d6\u6240\u6709 n \u4e2a\u77e9\u5f62\u7684\u7ad6\u76f4\u8fb9\uff0c\u5e76\u6309\u975e\u964d\u7684\u987a\u5e8f\u6392\u5e8f\u5f97\u5230\u5171\u8ba1 m=2n \u6761\u8fb9\u7684\u96c6\u5408 V \u7136\u540e\u91cd\u590d\u5982\u4e0b\u63cf\u8ff0\u7684\u5b50\u8fc7\u7a0b detect(V, m) \uff1a \u5982\u679c m < 2 \u5219\u7ec8\u6b62\u9012\u5f52\uff0c\u5426\u5219\uff0c \u5b9a\u4e49\u5982\u4e0b\u96c6\u5408\uff1a \u4ee4 V1 \u4e3a V \u524d\u4e00\u534a\u5373 \u230am/2\u230b \u4e2a\u5143\u7d20\u7684\u96c6\u5408\uff0c \u4ee4 V2 \u4e3a V \u540e\u4e00\u534a\u5373\u5269\u4e0b\u5143\u7d20\u7684\u96c6\u5408 \u4ee4 S11 \u4e3a\u81f3\u5c11\u4e00\u6761\u7ad6\u76f4\u8fb9\u5728 V1 \u4e2d\uff0c\u4e14\u4e0d\u7ecf\u8fc7 V2 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u4ee4 S22 \u4e3a\u81f3\u5c11\u4e00\u6761\u7ad6\u76f4\u8fb9\u5728 V2 \u4e2d\uff0c\u4e14\u4e0d\u7ecf\u8fc7 V1 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u4ee4 S12 \u4e3a\u5de6\u7ad6\u76f4\u8fb9\u5728 V1 \u4e2d\u4e14\u53f3\u7ad6\u76f4\u8fb9\u8de8\u8fc7\uff08 spanning \uff09 V2 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u4ee4 S21 \u4e3a\u53f3\u7ad6\u76f4\u8fb9\u5728 V2 \u4e2d\u4e14\u5de6\u7ad6\u76f4\u8fb9\u8de8\u8fc7\uff08 spanning \uff09 V1 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u5206\u522b\u5bf9\u96c6\u5408( S12 , S22 )\u3001( S21 , S11 )\u3001( S12 , S21 )\u8fdb\u884c y \u533a\u95f4\u662f\u5426\u91cd\u53e0\u7684\u5224\u65ad stab(S12, S22) \u3001 stab(S21, S11) \u548c stab(S12, S21) \u91cd\u590d\u6267\u884c\u5b50\u8fc7\u7a0b\uff1a detect(V1, \u230am/2\u230b) \u548c detect(V2, m\u2212\u230am/2\u230b) \u4ee5\u7b2c\u4e00\u5e45\u56fe\u77e9\u5f62\u4e3a\u4f8b\uff0c\u7b2c\u4e00\u6b21\u6267\u884c detect \u65f6\u7684\u4e2d\u95f4\u53d8\u91cf\uff0c\u6b64\u65f6\u65e0\u9700\u6267\u884c stab \u64cd\u4f5c\u3002\u6ce8\u610f\u77e9\u5f62 B \uff0c\u867d\u7136\u5de6\u7ad6\u76f4\u8fb9\u5728 V1 \u4e2d\uff0c\u4f46\u53f3\u7ad6\u76f4\u8fb9 x=4 \u4e0d\u6ee1\u8db3**\u8de8\u8fc7** V2 \uff0c\u5373\u8981\u6c42 x>5 \uff0c\u6240\u4ee5 B \u5e76\u4e0d\u5c5e\u4e8e S12 \uff0c\u540c\u7406\u5206\u6790\u4ea6\u4e0d\u5c5e\u4e8e S21 \u3002 ^ y | + V1 = [0.5, 1.5, 2] | (x1, y1) | V2 = [3, 4, 5] 4 | +-----+ | +-------------+ S11 = [A] | |A | | |C | S22 = [C] 3 | | | +-------------+ | S12 = [] | | | |B | | | | S21 = [] 2 | +-----+ | | +-------------+ |(x0, y0) | | | 1 | +-------------+ | | x +-----------------+--------------------> 0 1 2 3 4 5 \u5206\u522b\u5bf9\u4e0a\u56fe\u7684 V1 \u548c V2 \u6267\u884c detect \u64cd\u4f5c\uff1a ^ y | + V1 = [0.5] | | V2 = [1.5, 2] 4 | +-----+ S11 = [] | |A | | S22 = [B] 3 | | | | +--- S12 = [] | | | | |B S21 = [] 2 | +-----+ | | | | 1 | | +--- | | x +-------+------------------------------> 0 1 2 3 4 5 ^ y | V1 = [3] + | V2 = [4,5] | 4 | S11 = [] +-------------+ | S22 = [] |C | | 3 | S12 = [] ---------+ | | S21 = [B] | | | | 2 | +-------------+ | B | | 1 | ---------+ | | x +------------------------+-------------> 0 1 2 3 4 5 \u4e0a\u9762\u7b2c\u4e8c\u5e45\u5b50\u56fe S21=[B] \u7ed9\u51fa\u4e86\u96c6\u5408 S21 \u7684\u4e00\u4e2a\u4f8b\u5b50\uff1a\u53f3\u7ad6\u76f4\u8fb9\u5728 V2 \uff0c\u4e14\u5de6\u7ad6\u76f4\u8fb9 x=2 \u8de8\u8fc7\u4e86 V1 \u5373\u6ee1\u8db3 x<3 \u3002 \u6ce8\u610f\u5230\u4ee5\u4e0a\u4e24\u56fe\u7684 len(V1)=1 \u6ee1\u8db3\u4e86 detect \u7684\u7ec8\u6b62\u6761\u4ef6\uff0c\u63a5\u4e0b\u6765\u7ee7\u7eed\u5bf9 V2 \u6267\u884c detect \uff1a ^ y | + V1 = [1.5] | | V2 = [2] 4 | -+ | S11 = [A] | A | | S22 = [B] 3 | | | +--+ S12 = [] | | | |B S21 = [] 2 | -+ | | | | | 1 | | +--+ | | x +-----------+--------------------------> 0 1 2 3 4 5 ^ y | V1 = [4] + | V2 = [5] | 4 | S11 = [B] ---------+ | S22 = [] | C| 3 | S12 = [] --+ | | | S21 = [C] | | | 2 | ---------+ | B | | 1 | --+ | | | x +------------------------------+-------> 0 1 2 3 4 5 \u7ec8\u4e8e\uff0c\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u6267\u884c stab(S21,S11) \u64cd\u4f5c\u5373\u5224\u65ad B \u3001 C \u5728 y \u533a\u95f4\u4e0a\u7684\u76f8\u4ea4\u60c5\u51b5\uff0c\u663e\u7136\u5b83\u4eec\u662f\u76f8\u4ea4\u7684\uff1b\u4e8e\u662f\uff0c\u6700\u7ec8\u5f97\u5230\u4e00\u7ec4\u76f8\u4ea4\u77e9\u5f62 (B, C) \u3002\u8fd9\u91cc\u7565\u53bb\u4e86 stab \u7684\u7b97\u6cd5\u63cf\u8ff0\uff0c\u5373\u4e00\u7ef4\u533a\u95f4\u7684\u6c42\u4ea4\u95ee\u9898\u3002 \u7efc\u5408\u6765\u770b\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u5c06\u77e9\u5f62\u76f8\u4ea4\u7684\u5224\u65ad\u5206\u89e3\u4e3a\u4e24\u4e2a\u7ef4\u5ea6\u7684\u76f8\u4ea4\uff0c x \u65b9\u5411\u901a\u8fc7\u6392\u5e8f\u548c\u5206\u6cbb\u63d0\u9ad8\u4e86\u6548\u7387\uff0c\u5269\u4e0b\u7684 y \u65b9\u5411\u5c31\u662f\u4e00\u7ef4\u533a\u95f4\u7684\u5224\u65ad\u3002\u6839\u636e S \u96c6\u5408\u7684\u5b9a\u4e49\uff0c\u552f\u6709( S12 , S22 )\u3001( S21 , S11 )\u3001( S12 , S21 )\u8fd9\u4e09\u79cd\u7ec4\u5408\u5728 x \u65b9\u5411\u51fa\u73b0\u91cd\u53e0\uff0c\u6240\u4ee5\u7b97\u6cd5\u4e2d\u4ec5\u5bf9\u5b83\u4eec\u8fdb\u884c y \u533a\u95f4\u7684 stab \u5224\u65ad\u3002 \u4e8e\u662f\uff0c\u4ee5\u4e0a\u7b97\u6cd5\u7684\u4e00\u4e2a Python \u5b9e\u73b0\uff1a def detect(V:list, num:int, index_groups:list): ''' divide and conquer in x-direction. --- Args: - V: rectangle-related x-edges data, [(index, (x0,y0,x1,y1), x), (...), ...] - num: count of V instances, equal to len(V) - index_groups: target adjacent list for connectivity between rects ''' if num==1: return # start/end points of left/right intervals center_pos = int(num/2.0) X0, X, X1 = V[0][-1], V[center_pos-1][-1], V[-1][-1] # split into two groups left = V[0:center_pos] right = V[center_pos:] # filter rects according to their position to each intervals S11 = list(filter( lambda item: item[1][2]<=X, left )) S12 = list(filter( lambda item: item[1][2]>=X1, left )) S22 = list(filter( lambda item: item[1][0]>X, right )) S21 = list(filter( lambda item: item[1][0]<=X0, right )) # intersection in x-direction is fulfilled, so check y-direction further stab(S12, S22, index_groups) stab(S21, S11, index_groups) stab(S12, S21, index_groups) # recursive process detect(left, center_pos, index_groups) detect(right, num-center_pos, index_groups) def stab(S1:list, S2:list, index_groups:list): '''Check interval intersection in y-direction.''' if not S1 or not S2: return # sort S1.sort(key=lambda item: item[1][1]) S2.sort(key=lambda item: item[1][1]) i, j = 0, 0 while i<len(S1) and j<len(S2): m, a, _ = S1[i] n, b, _ = S2[j] if a[1] < b[1]: k = j while k<len(S2) and S2[k][1][1] < a[3]: report_pair(int(m/2), int(S2[k][0]/2), index_groups) k += 1 i += 1 else: k = i while k<len(S1) and S1[k][1][1] < b[3]: report_pair(int(S1[k][0]/2), int(n/2), index_groups) k += 1 j += 1 def report_pair(i:int, j:int, index_groups:list): '''add pair (i,j) to adjacent list.''' index_groups[i].add(j) index_groups[j].add(i) \u8fdb\u800c\uff0c\u8003\u8651\u6539\u8fdb\u7b97\u6cd5\u7684 Rects \u7c7b\uff1a class Rects: '''Collection of Rect instances.''' def __init__(self): self._rects = [] # type: list[Rect] def append(self, instance): self._rects.append(instance) def build_graph(self): '''calculate rects connectivity by solving rectangle intersection problems.''' num = len(self._rects) graph = [set() for i in range(num)] i_rect_x, i = [], 0 for rect in self._rects: points = (rect.x0, rect.y0, rect.x1, rect.y1) i_rect_x.append((i, points, rect.x0)) i_rect_x.append((i+1, points, rect.x1)) i += 2 i_rect_x.sort(key=lambda item: item[-1]) detect(i_rect_x, 2*num, graph) # use the improved algorithm return graph if __name__ == '__main__': import random from time import perf_counter # initialize random coordinates N = 50000 inputs = [] for i in range(N): x0, y0 = random.random()*10000, random.random()*10000 x1 = x0 + random.random()*5 y1 = y0 + random.random()*5 inputs.append((x0,y0,x1,y1)) # initialize Rects R = Rects() for points in inputs: R.append(Rect(points)) # solving rectangle intersection t0 = perf_counter() graph = R.build_graph() print(f'time: {perf_counter()-t0}') # output: # time: 1.2851152 \u8fd9\u6837\uff0c\u5904\u740650000\u4e2a\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898\u7684\u65f6\u95f4\u57282s\u4ee5\u5185\u3002","title":"\u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898"},{"location":"2020-09-01-%E6%B1%82%E8%A7%A3%E7%9F%A9%E5%BD%A2%E7%9B%B8%E4%BA%A4%E9%97%AE%E9%A2%98/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2020-09-01 | \u5206\u7c7b\uff1a mathematics \u672c\u6587\u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898\uff08Rectangle Intersection Problem\uff09\uff1a\u5df2\u77e5 n \u4e2a\u6c34\u5e73\u6216\u8005\u7ad6\u76f4\u653e\u7f6e\u7684\u77e9\u5f62\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u77e9\u5f62\uff0c\u6c42\u6240\u6709\u4e0e\u4e4b\u76f8\u4ea4\u7684\u77e9\u5f62\u3002\u4e00\u5f00\u59cb\u91c7\u7528\u4e86\u66b4\u529b\u6c42\u89e3\u7684\u65b9\u5f0f\uff0cO(n^2)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5728 n<2000 \u65f6\u5c1a\u80fd\u63a5\u53d7\uff08~0.6s\uff09\uff0c\u7ee7\u7eed\u589e\u5927 n \u5219\u5bfc\u81f4\u8ba1\u7b97\u65f6\u95f4\u7206\u70b8\u4e86\u3002\u5b9e\u9645\u4e0a\uff0c\u77e9\u5f62\u6c42\u4ea4\u662f\u4e00\u4e2a\u7814\u7a76\u8fc7\u7684\u95ee\u9898\uff0c\u672c\u6587\u53c2\u8003\u4e00\u7bc7\u8bba\u6587\u4e2d\u7684\u7b97\u6cd5\u8fdb\u884c\u4e86\u5b9e\u73b0\u3002","title":"\u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898"},{"location":"2020-09-01-%E6%B1%82%E8%A7%A3%E7%9F%A9%E5%BD%A2%E7%9B%B8%E4%BA%A4%E9%97%AE%E9%A2%98/#_2","text":"\u9996\u5148\uff0c\u4f7f\u7528\u5de6\u4e0b\u89d2 (x0,y0) \u548c\u53f3\u4e0a\u89d2 (x1,y1) \u4e24\u4e2a\u70b9\u6765\u63cf\u8ff0\u4e00\u4e2a\u6807\u51c6\u77e9\u5f62\uff1a ^ y | | (x1, y1) 4 | +-----+ +-------------+ | |A | |C | 3 | | | +-------------+ | | | | |B | | | 2 | +-----+ | +-------------+ |(x0, y0) | | 1 | +-------------+ | x +--------------------------------------> 0 1 2 3 4 5 \u6709\u591a\u79cd\u601d\u8def\u53ef\u4ee5\u5224\u65ad\u76f8\u4ea4\uff0c\u4f8b\u5982\uff0c\u4e24\u4e2a\u77e9\u5f62\u4e2d\u5fc3\u8ddd\u79bb\u6295\u5f71\u4e0e\u8fb9\u957f\u7684\u5173\u7cfb\u3002\u8fd9\u91cc\u4ece\u4e0b\u56fe\u6240\u793a\u56db\u79cd\u4e0d\u76f8\u4ea4\u7684\u60c5\u51b5\u5165\u624b\uff0c\u5176\u53cd\u9762\u5373\u4e3a\u76f8\u4ea4\uff1a B\u5b8c\u5168\u5728A\u7684\u4e0a\u65b9\uff1a B.y0 > A.y1 B\u5b8c\u5168\u5728A\u7684\u4e0b\u65b9\uff1a B.y1 < A.y0 B\u5b8c\u5168\u5728A\u7684\u5de6\u8fb9\uff1a B.x1 < A.x0 B\u5b8c\u5168\u5728A\u7684\u53f3\u8fb9\uff1a B.x0 > A.x1 +----+ +--------------------+ | | | B | | | +--------------------+ | | +----+ | | +----------+ | | | B | | | | | | | | A | | | | | | | | B | | | | | | | | | +----------+ | | +----+ | | +---------------------+ | | | B | | | +---------------------+ +----+ \u7efc\u5408\u4ee5\u4e0a\uff0c\u5f97\u5230\u77e9\u5f62\u7c7b\u53ca\u5176\u5224\u65ad\u76f8\u4ea4\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a class Rect: def __init__(self, points): assert len(points)==4, 'invalid input' self.x0, self.y0, self.x1, self.y1 = points def intersects(self, rect): ''' if intersects with `rect`.''' non_intersection = rect.x1<self.x0 or \\ rect.x0>self.x1 or \\ rect.y1<self.y0 or \\ rect.y0>self.y1 return not non_intersection","title":"\u4ece\u5224\u65ad\u4e24\u4e2a\u77e9\u5f62\u662f\u5426\u76f8\u4ea4\u5f00\u59cb"},{"location":"2020-09-01-%E6%B1%82%E8%A7%A3%E7%9F%A9%E5%BD%A2%E7%9B%B8%E4%BA%A4%E9%97%AE%E9%A2%98/#_3","text":"\u65e2\u7136\u5df2\u7ecf\u6709\u4e86\u5224\u65ad\u4e24\u4e2a\u77e9\u5f62\u662f\u5426\u76f8\u4ea4\u7684\u65b9\u6cd5\uff0c\u81ea\u7136\u60f3\u5230\u4e24\u4e24\u5224\u65ad\u6240\u6709\u77e9\u5f62\u7684\u66b4\u529b\u6c42\u89e3\u65b9\u6cd5\u3002\u6700\u540e\u7528\u4e00\u4e2a\u5217\u8868\u8868\u793a\u5404\u4e2a\u77e9\u5f62\u7684\u76f8\u4ea4\u77e9\u5f62\uff0c graph = [set() for i in range(num)] \uff0c\u4e5f\u5c31\u662f\u90bb\u63a5\u8868\u8868\u793a\u7684\u56fe\u7ed3\u6784\u3002 class Rects: '''Collection of Rect instances.''' def __init__(self): self._rects = [] # type: list[Rect] def append(self, instance): self._rects.append(instance) def build_graph(self): '''calculate the connectivity between every two rects by brute force method.''' num = len(self._rects) graph = [set() for i in range(num)] for i in range(num): for j in range(i+1, num): if self._rects[i].intersects(self._rects[j]): graph[i].add(j) graph[j].add(i) return graph if __name__ == '__main__': inputs = [(0.5,2,1.5,4), (2,1,4,3), (3,2,5,4)] # initialize Rects R = Rects() for points in inputs: R.append(Rect(points)) # solving rectangle intersection graph = R.build_graph() print(graph) # output: # [set(), {2}, {1}] \u4ee5\u4e0a\u8ba1\u7b97\u793a\u4f8b\u5373\u4e3a\u4e0a\u56fe\u4e2d\u7684\u77e9\u5f62 A \u3001 B \u548c C \uff0c\u7ed3\u679c\u4e0e\u9884\u671f\u76f8\u7b26\uff1a A \u6ca1\u6709\u76f8\u4ea4\u77e9\u5f62\uff0c B \u4e0e C \u76f8\u4ea4\uff0c C \u4e0e B \u76f8\u4ea4\u3002","title":"\u66b4\u529b\u6c42\u89e3"},{"location":"2020-09-01-%E6%B1%82%E8%A7%A3%E7%9F%A9%E5%BD%A2%E7%9B%B8%E4%BA%A4%E9%97%AE%E9%A2%98/#_4","text":"\u66b4\u529b\u65b9\u6cd5\u7b80\u5355\u6613\u884c\uff0c\u4f46\u968f\u7740\u8f93\u5165\u6570\u91cf\u589e\u5927\uff0c\u6027\u80fd\u6025\u5267\u4e0b\u964d\u3002\u4e8e\u662f\u5bfb\u6c42\u4e00\u79cd\u4f18\u5316\u7684\u7b97\u6cd5\uff0c\u57fa\u672c\u65b9\u5411\u6709\u4e24\u4e2a\uff1a \u4ee5O(n*logn)\u4ee3\u4ef7\u6cbf\u7740\u4e00\u4e2a\u7ef4\u5ea6\u5bf9\u77e9\u5f62\u6392\u5e8f\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u6bcf\u4e24\u4e2a\u77e9\u5f62\u90fd\u8981\u8fdb\u884c\u4e00\u6b21\u5224\u65ad \u5728\u4e00\u4e2a\u7ef4\u5ea6\u7684\u6295\u5f71\u6709\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u9700\u6309\u533a\u95f4\u5224\u65ad\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u7684\u76f8\u4ea4\u60c5\u51b5 \u672c\u6587\u5bf9\u5982\u4e0b\u8bba\u6587\u63d0\u51fa\u7684\u7b97\u6cd5\u8fdb\u884c\u4e86\u5b9e\u73b0\uff1a A Rectangle-Intersection Algorithm with Limited Resource Requirements \u7b97\u6cd5\u5927\u610f\uff1a \u53d6\u6240\u6709 n \u4e2a\u77e9\u5f62\u7684\u7ad6\u76f4\u8fb9\uff0c\u5e76\u6309\u975e\u964d\u7684\u987a\u5e8f\u6392\u5e8f\u5f97\u5230\u5171\u8ba1 m=2n \u6761\u8fb9\u7684\u96c6\u5408 V \u7136\u540e\u91cd\u590d\u5982\u4e0b\u63cf\u8ff0\u7684\u5b50\u8fc7\u7a0b detect(V, m) \uff1a \u5982\u679c m < 2 \u5219\u7ec8\u6b62\u9012\u5f52\uff0c\u5426\u5219\uff0c \u5b9a\u4e49\u5982\u4e0b\u96c6\u5408\uff1a \u4ee4 V1 \u4e3a V \u524d\u4e00\u534a\u5373 \u230am/2\u230b \u4e2a\u5143\u7d20\u7684\u96c6\u5408\uff0c \u4ee4 V2 \u4e3a V \u540e\u4e00\u534a\u5373\u5269\u4e0b\u5143\u7d20\u7684\u96c6\u5408 \u4ee4 S11 \u4e3a\u81f3\u5c11\u4e00\u6761\u7ad6\u76f4\u8fb9\u5728 V1 \u4e2d\uff0c\u4e14\u4e0d\u7ecf\u8fc7 V2 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u4ee4 S22 \u4e3a\u81f3\u5c11\u4e00\u6761\u7ad6\u76f4\u8fb9\u5728 V2 \u4e2d\uff0c\u4e14\u4e0d\u7ecf\u8fc7 V1 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u4ee4 S12 \u4e3a\u5de6\u7ad6\u76f4\u8fb9\u5728 V1 \u4e2d\u4e14\u53f3\u7ad6\u76f4\u8fb9\u8de8\u8fc7\uff08 spanning \uff09 V2 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u4ee4 S21 \u4e3a\u53f3\u7ad6\u76f4\u8fb9\u5728 V2 \u4e2d\u4e14\u5de6\u7ad6\u76f4\u8fb9\u8de8\u8fc7\uff08 spanning \uff09 V1 \u533a\u57df\u7684\u77e9\u5f62\u7684\u96c6\u5408 \u5206\u522b\u5bf9\u96c6\u5408( S12 , S22 )\u3001( S21 , S11 )\u3001( S12 , S21 )\u8fdb\u884c y \u533a\u95f4\u662f\u5426\u91cd\u53e0\u7684\u5224\u65ad stab(S12, S22) \u3001 stab(S21, S11) \u548c stab(S12, S21) \u91cd\u590d\u6267\u884c\u5b50\u8fc7\u7a0b\uff1a detect(V1, \u230am/2\u230b) \u548c detect(V2, m\u2212\u230am/2\u230b) \u4ee5\u7b2c\u4e00\u5e45\u56fe\u77e9\u5f62\u4e3a\u4f8b\uff0c\u7b2c\u4e00\u6b21\u6267\u884c detect \u65f6\u7684\u4e2d\u95f4\u53d8\u91cf\uff0c\u6b64\u65f6\u65e0\u9700\u6267\u884c stab \u64cd\u4f5c\u3002\u6ce8\u610f\u77e9\u5f62 B \uff0c\u867d\u7136\u5de6\u7ad6\u76f4\u8fb9\u5728 V1 \u4e2d\uff0c\u4f46\u53f3\u7ad6\u76f4\u8fb9 x=4 \u4e0d\u6ee1\u8db3**\u8de8\u8fc7** V2 \uff0c\u5373\u8981\u6c42 x>5 \uff0c\u6240\u4ee5 B \u5e76\u4e0d\u5c5e\u4e8e S12 \uff0c\u540c\u7406\u5206\u6790\u4ea6\u4e0d\u5c5e\u4e8e S21 \u3002 ^ y | + V1 = [0.5, 1.5, 2] | (x1, y1) | V2 = [3, 4, 5] 4 | +-----+ | +-------------+ S11 = [A] | |A | | |C | S22 = [C] 3 | | | +-------------+ | S12 = [] | | | |B | | | | S21 = [] 2 | +-----+ | | +-------------+ |(x0, y0) | | | 1 | +-------------+ | | x +-----------------+--------------------> 0 1 2 3 4 5 \u5206\u522b\u5bf9\u4e0a\u56fe\u7684 V1 \u548c V2 \u6267\u884c detect \u64cd\u4f5c\uff1a ^ y | + V1 = [0.5] | | V2 = [1.5, 2] 4 | +-----+ S11 = [] | |A | | S22 = [B] 3 | | | | +--- S12 = [] | | | | |B S21 = [] 2 | +-----+ | | | | 1 | | +--- | | x +-------+------------------------------> 0 1 2 3 4 5 ^ y | V1 = [3] + | V2 = [4,5] | 4 | S11 = [] +-------------+ | S22 = [] |C | | 3 | S12 = [] ---------+ | | S21 = [B] | | | | 2 | +-------------+ | B | | 1 | ---------+ | | x +------------------------+-------------> 0 1 2 3 4 5 \u4e0a\u9762\u7b2c\u4e8c\u5e45\u5b50\u56fe S21=[B] \u7ed9\u51fa\u4e86\u96c6\u5408 S21 \u7684\u4e00\u4e2a\u4f8b\u5b50\uff1a\u53f3\u7ad6\u76f4\u8fb9\u5728 V2 \uff0c\u4e14\u5de6\u7ad6\u76f4\u8fb9 x=2 \u8de8\u8fc7\u4e86 V1 \u5373\u6ee1\u8db3 x<3 \u3002 \u6ce8\u610f\u5230\u4ee5\u4e0a\u4e24\u56fe\u7684 len(V1)=1 \u6ee1\u8db3\u4e86 detect \u7684\u7ec8\u6b62\u6761\u4ef6\uff0c\u63a5\u4e0b\u6765\u7ee7\u7eed\u5bf9 V2 \u6267\u884c detect \uff1a ^ y | + V1 = [1.5] | | V2 = [2] 4 | -+ | S11 = [A] | A | | S22 = [B] 3 | | | +--+ S12 = [] | | | |B S21 = [] 2 | -+ | | | | | 1 | | +--+ | | x +-----------+--------------------------> 0 1 2 3 4 5 ^ y | V1 = [4] + | V2 = [5] | 4 | S11 = [B] ---------+ | S22 = [] | C| 3 | S12 = [] --+ | | | S21 = [C] | | | 2 | ---------+ | B | | 1 | --+ | | | x +------------------------------+-------> 0 1 2 3 4 5 \u7ec8\u4e8e\uff0c\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u6267\u884c stab(S21,S11) \u64cd\u4f5c\u5373\u5224\u65ad B \u3001 C \u5728 y \u533a\u95f4\u4e0a\u7684\u76f8\u4ea4\u60c5\u51b5\uff0c\u663e\u7136\u5b83\u4eec\u662f\u76f8\u4ea4\u7684\uff1b\u4e8e\u662f\uff0c\u6700\u7ec8\u5f97\u5230\u4e00\u7ec4\u76f8\u4ea4\u77e9\u5f62 (B, C) \u3002\u8fd9\u91cc\u7565\u53bb\u4e86 stab \u7684\u7b97\u6cd5\u63cf\u8ff0\uff0c\u5373\u4e00\u7ef4\u533a\u95f4\u7684\u6c42\u4ea4\u95ee\u9898\u3002 \u7efc\u5408\u6765\u770b\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u5c06\u77e9\u5f62\u76f8\u4ea4\u7684\u5224\u65ad\u5206\u89e3\u4e3a\u4e24\u4e2a\u7ef4\u5ea6\u7684\u76f8\u4ea4\uff0c x \u65b9\u5411\u901a\u8fc7\u6392\u5e8f\u548c\u5206\u6cbb\u63d0\u9ad8\u4e86\u6548\u7387\uff0c\u5269\u4e0b\u7684 y \u65b9\u5411\u5c31\u662f\u4e00\u7ef4\u533a\u95f4\u7684\u5224\u65ad\u3002\u6839\u636e S \u96c6\u5408\u7684\u5b9a\u4e49\uff0c\u552f\u6709( S12 , S22 )\u3001( S21 , S11 )\u3001( S12 , S21 )\u8fd9\u4e09\u79cd\u7ec4\u5408\u5728 x \u65b9\u5411\u51fa\u73b0\u91cd\u53e0\uff0c\u6240\u4ee5\u7b97\u6cd5\u4e2d\u4ec5\u5bf9\u5b83\u4eec\u8fdb\u884c y \u533a\u95f4\u7684 stab \u5224\u65ad\u3002 \u4e8e\u662f\uff0c\u4ee5\u4e0a\u7b97\u6cd5\u7684\u4e00\u4e2a Python \u5b9e\u73b0\uff1a def detect(V:list, num:int, index_groups:list): ''' divide and conquer in x-direction. --- Args: - V: rectangle-related x-edges data, [(index, (x0,y0,x1,y1), x), (...), ...] - num: count of V instances, equal to len(V) - index_groups: target adjacent list for connectivity between rects ''' if num==1: return # start/end points of left/right intervals center_pos = int(num/2.0) X0, X, X1 = V[0][-1], V[center_pos-1][-1], V[-1][-1] # split into two groups left = V[0:center_pos] right = V[center_pos:] # filter rects according to their position to each intervals S11 = list(filter( lambda item: item[1][2]<=X, left )) S12 = list(filter( lambda item: item[1][2]>=X1, left )) S22 = list(filter( lambda item: item[1][0]>X, right )) S21 = list(filter( lambda item: item[1][0]<=X0, right )) # intersection in x-direction is fulfilled, so check y-direction further stab(S12, S22, index_groups) stab(S21, S11, index_groups) stab(S12, S21, index_groups) # recursive process detect(left, center_pos, index_groups) detect(right, num-center_pos, index_groups) def stab(S1:list, S2:list, index_groups:list): '''Check interval intersection in y-direction.''' if not S1 or not S2: return # sort S1.sort(key=lambda item: item[1][1]) S2.sort(key=lambda item: item[1][1]) i, j = 0, 0 while i<len(S1) and j<len(S2): m, a, _ = S1[i] n, b, _ = S2[j] if a[1] < b[1]: k = j while k<len(S2) and S2[k][1][1] < a[3]: report_pair(int(m/2), int(S2[k][0]/2), index_groups) k += 1 i += 1 else: k = i while k<len(S1) and S1[k][1][1] < b[3]: report_pair(int(S1[k][0]/2), int(n/2), index_groups) k += 1 j += 1 def report_pair(i:int, j:int, index_groups:list): '''add pair (i,j) to adjacent list.''' index_groups[i].add(j) index_groups[j].add(i) \u8fdb\u800c\uff0c\u8003\u8651\u6539\u8fdb\u7b97\u6cd5\u7684 Rects \u7c7b\uff1a class Rects: '''Collection of Rect instances.''' def __init__(self): self._rects = [] # type: list[Rect] def append(self, instance): self._rects.append(instance) def build_graph(self): '''calculate rects connectivity by solving rectangle intersection problems.''' num = len(self._rects) graph = [set() for i in range(num)] i_rect_x, i = [], 0 for rect in self._rects: points = (rect.x0, rect.y0, rect.x1, rect.y1) i_rect_x.append((i, points, rect.x0)) i_rect_x.append((i+1, points, rect.x1)) i += 2 i_rect_x.sort(key=lambda item: item[-1]) detect(i_rect_x, 2*num, graph) # use the improved algorithm return graph if __name__ == '__main__': import random from time import perf_counter # initialize random coordinates N = 50000 inputs = [] for i in range(N): x0, y0 = random.random()*10000, random.random()*10000 x1 = x0 + random.random()*5 y1 = y0 + random.random()*5 inputs.append((x0,y0,x1,y1)) # initialize Rects R = Rects() for points in inputs: R.append(Rect(points)) # solving rectangle intersection t0 = perf_counter() graph = R.build_graph() print(f'time: {perf_counter()-t0}') # output: # time: 1.2851152 \u8fd9\u6837\uff0c\u5904\u740650000\u4e2a\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898\u7684\u65f6\u95f4\u57282s\u4ee5\u5185\u3002","title":"\u4f18\u5316\u7684\u6c42\u89e3\u7b97\u6cd5"},{"location":"2020-09-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%AF%B9%E9%BD%90%E9%9A%90%E5%BC%8F%E8%A1%A8%E6%A0%BC%E7%BA%BF/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-09-27 | \u5206\u7c7b\uff1a process automation \u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c \u8bb0\u5f55\u4e86\u9690\u5f0f\u8868\u683c Stream Table \u7684\u89e3\u6790\u65b9\u5f0f\uff1a\u6839\u636e\u6587\u672c\u5757\u4f4d\u7f6e\u751f\u6210\u6f5c\u5728\u7684\u8868\u683c\u8fb9\u7ebf\uff0c\u7136\u540e\u91c7\u7528\u4e0e\u663e\u5f0f\u8868\u683c\u76f8\u540c\u7684\u5904\u7406\u65b9\u5f0f\u89e3\u6790\u8fd9\u4e9b\u8fb9\u7ebf\u3002\u5176\u4e2d\uff0c\u4e24\u4e2a\u9057\u7559\u95ee\u9898\uff1a \u7b2c\u4e00\u6b65\u5047\u60f3\u8868\u683c\u7ebf\u65f6\uff0c\u5c3d\u91cf\u5bf9\u9f50\u6a2a\u7eb5\u8fb9\u7ebf\u4ee5\u7b80\u5316\u8868\u683c\u7ed3\u6784 \u517c\u5bb9\u534a\u9690\u5f0f\u8868\u683c\u4f8b\u5982\u4e09\u7ebf\u8868 \u672c\u6587\u8bb0\u5f55\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u5904\u7406\u65b9\u6848\u3002 \u95ee\u9898\u4e0e\u6a21\u578b\u7b80\u5316 \u00b6 \u6839\u636e\u4e0b\u56fe\u4e2d\u7eff\u8272\u5757\u8868\u793a\u7684\u6587\u672c\u4f4d\u7f6e\uff0c\u6211\u4eec\u5df2\u7ecf\u8bc6\u522b\u51fa\u4e86\u6f5c\u5728\u7684\u8868\u683c\u533a\u57df\uff1b\u6839\u636e\u76f8\u90bb\u5757\u6b63\u4e2d\u95f4\u63d2\u5165\u5206\u9694\u7ebf\u7684\u539f\u5219\uff0c\u5f97\u5230\u4e86\u56fe\u793a\u6d45\u8272\u7ebf\u8868\u793a\u7684\u8868\u683c\u7ed3\u6784\u3002\u4ece\u663e\u793a\u4e0a\u6765\u8bf4\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u8fb9\u6846\u7ebf\u5bf9\u4e8e\u9690\u5f0f\u8868\u683c\u6765\u8bf4\u90fd\u662f\u9690\u85cf\u7684\u3002 \u9700\u8981\u6539\u8fdb\u7684\u5730\u65b9\u662f\uff0c\u4ece\u7b2c\u4e8c\u884c\u5f00\u59cb\uff0c\u4e24\u5217\u7684\u5206\u9694\u7ebf\u53ef\u4ee5\u5bf9\u9f50\u5408\u5e76\uff0c\u8fd9\u6837\u4f7f\u8868\u683c\u7ed3\u6784\u4ece 6x6 \u7b80\u5316\u6210 6x3 \u3002 \u5355\u72ec\u770b\u4e00\u6761\u7ad6\u76f4\u8fb9\u7ebf\uff0c\u5b83\u5b9e\u9645\u4e0a\u53ef\u4ee5\u5728\u76f8\u90bb\u7684\u4e24\u4e2a\u6587\u672c\u5757\u4e4b\u95f4\u6d3b\u52a8\uff1b\u6211\u4eec\u5e0c\u671b\u5c3d\u53ef\u80fd\u591a\u7684\u7ad6\u76f4\u8fb9\u7ebf\u901a\u8fc7\u540c\u4e00 x \u65b9\u5411\u4f4d\u7f6e\u3002\u4e8e\u662f\u8fd9\u4e2a\u95ee\u9898\u7b80\u5316\u4e3a\uff1a \u5df2\u77e5\u4e00\u7cfb\u5217\u7684\u533a\u95f4 [x1_s,x1_e], [x2_s,x2_e], ... \uff0c\u786e\u5b9a\u5c3d\u53ef\u80fd\u5c11\u7684\u5782\u7ebf x1,x2,... \uff0c\u4f7f\u5f97\u6bcf\u4e2a\u533a\u95f4\u81f3\u5c11\u6709\u4e00\u6761\u7ebf\u7a7f\u8fc7\u3002 \u4e0b\u9762\u4e0d\u59a8\u521d\u59cb\u5316\u533a\u95f4\u4e3a\uff1a inputs = [[8, 10], [2, 6], [4, 6], [1, 6], [4, 6], [5, 6]] \u6c42\u89e3\u7b80\u5316\u6a21\u578b \u00b6 \u9996\u5148\u8bbe\u8ba1\u4e00\u4e2a\u533a\u95f4\u5bf9\u8c61\uff0c\u5b83\u5177\u6709\u5de6\u3001\u53f3\u8fb9\u754c\u5c5e\u6027\uff0c\u7c7b\u4f3c\u4e8e\u7ad6\u76f4\u8fb9\u7ebf\u5141\u8bb8\u5728\u4e00\u5b9a\u8303\u56f4\u5185\u5de6\u53f3\u79fb\u52a8\u3002\u6211\u4eec\u7684\u76ee\u6807\u662f\u786e\u5b9a\u6b64\u533a\u95f4\u5185\u7684\u4e00\u4e2a\u5177\u4f53\u503c\uff0c\u4e5f\u5c31\u662f\u56fa\u5b9a\u8fd9\u6761\u8fb9\u7ebf\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u5982\u679c\u6ca1\u6709\u4f18\u5316\u8fb9\u7ebf\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u53d6\u533a\u95f4\u4e2d\u70b9\u4f4d\u7f6e\u3002 class Interval: def __init__(self, x_range:tuple=None): # valid range if x_range: x0, x1 = x_range else: x0, x1 = -9999, 9999 self.LRange, self.URange = x0, x1 # whether the position is fixed self._x = None self.finalized = False @property def x(self): return self._x if self.finalized else (self.LRange+self.URange)/2.0 def is_valid(self, x): '''Whether the given position `x` locates in the valid instance range.''' return self.LRange < x < self.URange def finalize(self, x): '''Finalize with given position.''' # can be finalized for only one time if self.finalized or not self.is_valid(x): return self._x = x self.finalized = True \u63a5\u4e0b\u6765\u8bbe\u8ba1\u533a\u95f4\u7ec4\u5bf9\u8c61\uff0c\u5bf9\u5e94\u6240\u6709\u7ad6\u76f4\u8fb9\u7ebf\u6216\u8005\u6240\u6709\u6c34\u5e73\u8fb9\u7ebf\u3002\u6211\u4eec\u5c06\u4f18\u5316\u7ec4\u5185\u7684\u6240\u6709\u533a\u95f4\uff0c\u5f97\u5230\u4f18\u5316\u540e\u7684\u4f4d\u7f6e common_x \u3002\u5177\u4f53\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f\u626b\u63cf\u7ebf\u7b97\u6cd5\uff1a \u53d6\u6bcf\u4e2a\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u5e76\u53bb\u91cd\u5f97\u5230\u4e00\u7cfb\u5217 x \u5750\u6807\uff0c x1,x2,x3,... \u76f8\u90bb\u4e24\u4e2a\u5750\u6807\u7ec4\u6210\u4e00\u4e2a\u8003\u5bdf\u533a\u95f4\uff0c\u4f8b\u5982 [x1,x2], [x2,x3], ... \u53d6\u8003\u5bdf\u533a\u95f4\u4e2d\u70b9\u4f8b\u5982 x=(x1+x2)/2 \u4f5c\u4e3a\u5019\u9009\u4f4d\u7f6e\uff0c\u68c0\u6d4b\u5b83\u901a\u8fc7\u539f\u59cb\u533a\u95f4\u7684\u60c5\u51b5\uff0c\u4f8b\u5982\u7528\u5e8f\u5217 0,1,1... \u8868\u793a\u7ecf\u8fc7\u533a\u95f42\u548c3 \u6839\u636e\u7a7f\u8fc7\u533a\u95f4\u6570\u964d\u5e8f\u6392\u5217\u533a\u95f4\u4e2d\u70b9 \u4f9d\u6b21\u53d6\u533a\u95f4\u4e2d\u70b9\u76f4\u5230\u6240\u6709\u533a\u95f4\u90fd\u88ab\u56fa\u5b9a\u4e0b\u6765 class Intervals: '''Collection of Interval instances.''' def __init__(self): self._instances = [] def append(self, instance): self._instances.append(instance) def common_x(self): return set([instance.x for instance in self._instances]) def solve(self): # collect interval points and sort in x-increasing order x_points = set() for instance in self._instances: x_points.add(instance.LRange) x_points.add(instance.URange) x_points = list(x_points) x_points.sort() # check intersection status of each intervals x_status = [] for i in range(len(x_points)-1): x = (x_points[i]+x_points[i+1])/2.0 c = list(map( lambda instance: int(instance.is_valid(x)), self._instances)) x_status.append((x,c)) # sort per count since preferring passing through more intervals x_status.sort(key=lambda item: sum(item[1]), reverse=True) # finalize instances num = len(self._instances) current_status = [0] * num for x, status in x_status: # terminate if all instances are finalized if sum(current_status) == num: break # only one line is allowed to pass through one interval -> sum(A.*B)=0 # e.g. A = [1,0,1,0], B=[0,1,0,0] -> valid # A = [1,0,1,0], B =[1,0,0,0] -> invalid due to two lines passing through interval 1 duplicated = sum([c1*c2 for c1,c2 in zip(current_status, status)]) if duplicated: continue # update current status current_status = [c1+c2 for c1,c2 in zip(current_status, status)] # now, finalize instances for instance, instance_status in zip(self._instances, status): if instance_status: instance.finalize(x) \u76f4\u63a5\u5c55\u793a\u4e00\u4e0b\u7ed3\u679c\uff0c\u5982\u679c\u53bb\u6389\u4e0b\u9762\u4ee3\u7801\u4e2d I.solve() \u5c06\u5f97\u5230 {3.5, 4.0, 5.5, 5.0, 9.0} \uff0c\u4e5f\u5c31\u662f\u5f00\u59cb\u6240\u8bf4\u53c2\u5dee\u4e0d\u9f50\u7684\u60c5\u51b5\uff1b\u5982\u679c\u52a0\u4e0a\u533a\u95f4\u4f18\u5316\uff0c\u5219\u5f97\u5230 {9.0, 5.5} \uff0c\u5373\u5b9e\u9645\u4e0a\u5bf9\u9f50\u540e\u7684\u8fb9\u7ebf\u3002 if __name__ == '__main__': inputs = [[8, 10], [2, 6], [4, 6], [1, 6], [4, 6], [5, 6]] I = Intervals() for x_range in inputs: I.append(Interval(x_range)) I.solve() # optimize x = I.common_x() print(x) # if comment ot I.solve() # {3.5, 4.0, 5.5, 5.0, 9.0} # final result # {9.0, 5.5} \u56de\u5230\u539f\u59cb\u95ee\u9898 \u00b6 \u7b2c\u4e00\u6b65\u5047\u60f3\u8868\u683c\u7ebf\u65f6\uff0c\u5c3d\u91cf\u5bf9\u9f50\u6a2a\u7eb5\u8fb9\u7ebf\u4ee5\u7b80\u5316\u8868\u683c\u7ed3\u6784 \u7c7b\u4f3c\u4e8e\u7b80\u5316\u6a21\u578b\uff0c\u5206\u522b\u4f18\u5316\u6a2a\u3001\u7eb5\u8fb9\u7ebf\u3002\u4ee5\u7ad6\u76f4\u8fb9\u7ebf\u4e3a\u4f8b\uff0c\u6ce8\u610f\u4e0d\u4ec5\u6709\u5de6\u53f3\u533a\u95f4\u5c5e\u6027\uff08\u6c34\u5e73\u79fb\u52a8\u81ea\u7531\u5ea6\uff09\uff0c\u8fd8\u6709\u4e0a\u3001\u4e0b\u8fb9\u7ebf\u5c5e\u6027\uff0c\u5373\u5f15\u7528\u9650\u5b9a\u7ad6\u76f4\u8303\u56f4\u7684\u4e24\u6761\u6c34\u5e73\u8fb9\u7ebf\u3002\u53ea\u6709\u540c\u65f6\u786e\u5b9a\u6c34\u5e73\u4f4d\u7f6e\u548c\u4e0a\u4e0b\u8fb9\u7ebf\u540e\uff0c\u8fd9\u6761\u7ad6\u76f4\u8fb9\u7ebf\u624d\u5f97\u4ee5\u786e\u5b9a\u3002 \u517c\u5bb9\u534a\u9690\u5f0f\u8868\u683c\u4f8b\u5982\u4e09\u7ebf\u8868 \u4e0a\u4e00\u4e2a\u95ee\u9898\u4ee5\u5c3d\u91cf\u5bf9\u9f50\u8fb9\u7ebf\u4e3a\u539f\u5219\u4f18\u5316\u8fb9\u7ebf\u4f4d\u7f6e\uff0c\u5f53\u7ed9\u5b9a\u663e\u5f0f\u7684\u8868\u683c\u7ebf\u65f6\uff0c\u9700\u8981\u5f15\u5165\u4f18\u5148\u7ea7\u66f4\u9ad8\u7684\u539f\u5219\uff1a\u5c3d\u91cf\u901a\u8fc7\u663e\u5f0f\u7684\u8868\u683c\u7ebf\u3002 \u4ee5\u89e3\u6790\u4e09\u7ebf\u8868\u4e2d\u4e3a\u4f8b\uff0c\u5df2\u7ecf\u7ed9\u5b9a\u4e86\u663e\u5f0f\u7684\u6c34\u5e73\u8868\u683c\u7ebf h_i \uff08 i=1,2,3 \uff09\uff0c\u8003\u5bdf\u6240\u6709\u53ef\u80fd\u7684\u6c34\u5e73\u8fb9\u7ebf\u96c6\u5408 H \uff0c\u5982\u679c\u67d0\u6761\u6c34\u5e73\u8fb9\u7ebf H_i \u7684\u7ad6\u76f4\u6d3b\u52a8\u533a\u95f4 [yi_1,yi_2] \u6db5\u76d6\u663e\u5f0f\u8fb9\u7ebf h_i \u7684 yi \u5750\u6807\uff0c\u5e76\u4e14 H_i \u7684\u5de6\u53f3\u4e24\u6761\u7ad6\u76f4\u8fb9\u7ebf\u7684\u53ef\u80fd\u6d3b\u52a8\u533a\u57df [xi_1,xi_2] \u5728 h_i \u7684\u6c34\u5e73\u533a\u95f4\u5185\uff0c\u5219\u786e\u5b9a H_i \u7684\u7eb5\u5750\u6807 y=yi \u3002 \u6ce8\u610f \u534a\u9690\u5f0f\u8868\u683c\u7684\u89e3\u6790\u5b8c\u5168\u4f9d\u8d56\u4e8e\u9690\u5f0f\u8868\u683c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u9690\u5f0f\u8868\u683c\u672a\u80fd\u6b63\u786e\u8bc6\u522b\u539f\u59cb\u6587\u6863\u7684\u8868\u683c\u7ed3\u6784\uff0c\u5219\u76f4\u63a5\u5bfc\u81f4\u534a\u9690\u5f0f\u8868\u683c\u4e2d\u663e\u5f0f\u8868\u683c\u7ebf\u89e3\u6790\u5931\u8d25\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf"},{"location":"2020-09-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%AF%B9%E9%BD%90%E9%9A%90%E5%BC%8F%E8%A1%A8%E6%A0%BC%E7%BA%BF/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-09-27 | \u5206\u7c7b\uff1a process automation \u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c \u8bb0\u5f55\u4e86\u9690\u5f0f\u8868\u683c Stream Table \u7684\u89e3\u6790\u65b9\u5f0f\uff1a\u6839\u636e\u6587\u672c\u5757\u4f4d\u7f6e\u751f\u6210\u6f5c\u5728\u7684\u8868\u683c\u8fb9\u7ebf\uff0c\u7136\u540e\u91c7\u7528\u4e0e\u663e\u5f0f\u8868\u683c\u76f8\u540c\u7684\u5904\u7406\u65b9\u5f0f\u89e3\u6790\u8fd9\u4e9b\u8fb9\u7ebf\u3002\u5176\u4e2d\uff0c\u4e24\u4e2a\u9057\u7559\u95ee\u9898\uff1a \u7b2c\u4e00\u6b65\u5047\u60f3\u8868\u683c\u7ebf\u65f6\uff0c\u5c3d\u91cf\u5bf9\u9f50\u6a2a\u7eb5\u8fb9\u7ebf\u4ee5\u7b80\u5316\u8868\u683c\u7ed3\u6784 \u517c\u5bb9\u534a\u9690\u5f0f\u8868\u683c\u4f8b\u5982\u4e09\u7ebf\u8868 \u672c\u6587\u8bb0\u5f55\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u5904\u7406\u65b9\u6848\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf"},{"location":"2020-09-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%AF%B9%E9%BD%90%E9%9A%90%E5%BC%8F%E8%A1%A8%E6%A0%BC%E7%BA%BF/#_1","text":"\u6839\u636e\u4e0b\u56fe\u4e2d\u7eff\u8272\u5757\u8868\u793a\u7684\u6587\u672c\u4f4d\u7f6e\uff0c\u6211\u4eec\u5df2\u7ecf\u8bc6\u522b\u51fa\u4e86\u6f5c\u5728\u7684\u8868\u683c\u533a\u57df\uff1b\u6839\u636e\u76f8\u90bb\u5757\u6b63\u4e2d\u95f4\u63d2\u5165\u5206\u9694\u7ebf\u7684\u539f\u5219\uff0c\u5f97\u5230\u4e86\u56fe\u793a\u6d45\u8272\u7ebf\u8868\u793a\u7684\u8868\u683c\u7ed3\u6784\u3002\u4ece\u663e\u793a\u4e0a\u6765\u8bf4\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u8fb9\u6846\u7ebf\u5bf9\u4e8e\u9690\u5f0f\u8868\u683c\u6765\u8bf4\u90fd\u662f\u9690\u85cf\u7684\u3002 \u9700\u8981\u6539\u8fdb\u7684\u5730\u65b9\u662f\uff0c\u4ece\u7b2c\u4e8c\u884c\u5f00\u59cb\uff0c\u4e24\u5217\u7684\u5206\u9694\u7ebf\u53ef\u4ee5\u5bf9\u9f50\u5408\u5e76\uff0c\u8fd9\u6837\u4f7f\u8868\u683c\u7ed3\u6784\u4ece 6x6 \u7b80\u5316\u6210 6x3 \u3002 \u5355\u72ec\u770b\u4e00\u6761\u7ad6\u76f4\u8fb9\u7ebf\uff0c\u5b83\u5b9e\u9645\u4e0a\u53ef\u4ee5\u5728\u76f8\u90bb\u7684\u4e24\u4e2a\u6587\u672c\u5757\u4e4b\u95f4\u6d3b\u52a8\uff1b\u6211\u4eec\u5e0c\u671b\u5c3d\u53ef\u80fd\u591a\u7684\u7ad6\u76f4\u8fb9\u7ebf\u901a\u8fc7\u540c\u4e00 x \u65b9\u5411\u4f4d\u7f6e\u3002\u4e8e\u662f\u8fd9\u4e2a\u95ee\u9898\u7b80\u5316\u4e3a\uff1a \u5df2\u77e5\u4e00\u7cfb\u5217\u7684\u533a\u95f4 [x1_s,x1_e], [x2_s,x2_e], ... \uff0c\u786e\u5b9a\u5c3d\u53ef\u80fd\u5c11\u7684\u5782\u7ebf x1,x2,... \uff0c\u4f7f\u5f97\u6bcf\u4e2a\u533a\u95f4\u81f3\u5c11\u6709\u4e00\u6761\u7ebf\u7a7f\u8fc7\u3002 \u4e0b\u9762\u4e0d\u59a8\u521d\u59cb\u5316\u533a\u95f4\u4e3a\uff1a inputs = [[8, 10], [2, 6], [4, 6], [1, 6], [4, 6], [5, 6]]","title":"\u95ee\u9898\u4e0e\u6a21\u578b\u7b80\u5316"},{"location":"2020-09-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%AF%B9%E9%BD%90%E9%9A%90%E5%BC%8F%E8%A1%A8%E6%A0%BC%E7%BA%BF/#_2","text":"\u9996\u5148\u8bbe\u8ba1\u4e00\u4e2a\u533a\u95f4\u5bf9\u8c61\uff0c\u5b83\u5177\u6709\u5de6\u3001\u53f3\u8fb9\u754c\u5c5e\u6027\uff0c\u7c7b\u4f3c\u4e8e\u7ad6\u76f4\u8fb9\u7ebf\u5141\u8bb8\u5728\u4e00\u5b9a\u8303\u56f4\u5185\u5de6\u53f3\u79fb\u52a8\u3002\u6211\u4eec\u7684\u76ee\u6807\u662f\u786e\u5b9a\u6b64\u533a\u95f4\u5185\u7684\u4e00\u4e2a\u5177\u4f53\u503c\uff0c\u4e5f\u5c31\u662f\u56fa\u5b9a\u8fd9\u6761\u8fb9\u7ebf\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u5982\u679c\u6ca1\u6709\u4f18\u5316\u8fb9\u7ebf\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u53d6\u533a\u95f4\u4e2d\u70b9\u4f4d\u7f6e\u3002 class Interval: def __init__(self, x_range:tuple=None): # valid range if x_range: x0, x1 = x_range else: x0, x1 = -9999, 9999 self.LRange, self.URange = x0, x1 # whether the position is fixed self._x = None self.finalized = False @property def x(self): return self._x if self.finalized else (self.LRange+self.URange)/2.0 def is_valid(self, x): '''Whether the given position `x` locates in the valid instance range.''' return self.LRange < x < self.URange def finalize(self, x): '''Finalize with given position.''' # can be finalized for only one time if self.finalized or not self.is_valid(x): return self._x = x self.finalized = True \u63a5\u4e0b\u6765\u8bbe\u8ba1\u533a\u95f4\u7ec4\u5bf9\u8c61\uff0c\u5bf9\u5e94\u6240\u6709\u7ad6\u76f4\u8fb9\u7ebf\u6216\u8005\u6240\u6709\u6c34\u5e73\u8fb9\u7ebf\u3002\u6211\u4eec\u5c06\u4f18\u5316\u7ec4\u5185\u7684\u6240\u6709\u533a\u95f4\uff0c\u5f97\u5230\u4f18\u5316\u540e\u7684\u4f4d\u7f6e common_x \u3002\u5177\u4f53\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f\u626b\u63cf\u7ebf\u7b97\u6cd5\uff1a \u53d6\u6bcf\u4e2a\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u5e76\u53bb\u91cd\u5f97\u5230\u4e00\u7cfb\u5217 x \u5750\u6807\uff0c x1,x2,x3,... \u76f8\u90bb\u4e24\u4e2a\u5750\u6807\u7ec4\u6210\u4e00\u4e2a\u8003\u5bdf\u533a\u95f4\uff0c\u4f8b\u5982 [x1,x2], [x2,x3], ... \u53d6\u8003\u5bdf\u533a\u95f4\u4e2d\u70b9\u4f8b\u5982 x=(x1+x2)/2 \u4f5c\u4e3a\u5019\u9009\u4f4d\u7f6e\uff0c\u68c0\u6d4b\u5b83\u901a\u8fc7\u539f\u59cb\u533a\u95f4\u7684\u60c5\u51b5\uff0c\u4f8b\u5982\u7528\u5e8f\u5217 0,1,1... \u8868\u793a\u7ecf\u8fc7\u533a\u95f42\u548c3 \u6839\u636e\u7a7f\u8fc7\u533a\u95f4\u6570\u964d\u5e8f\u6392\u5217\u533a\u95f4\u4e2d\u70b9 \u4f9d\u6b21\u53d6\u533a\u95f4\u4e2d\u70b9\u76f4\u5230\u6240\u6709\u533a\u95f4\u90fd\u88ab\u56fa\u5b9a\u4e0b\u6765 class Intervals: '''Collection of Interval instances.''' def __init__(self): self._instances = [] def append(self, instance): self._instances.append(instance) def common_x(self): return set([instance.x for instance in self._instances]) def solve(self): # collect interval points and sort in x-increasing order x_points = set() for instance in self._instances: x_points.add(instance.LRange) x_points.add(instance.URange) x_points = list(x_points) x_points.sort() # check intersection status of each intervals x_status = [] for i in range(len(x_points)-1): x = (x_points[i]+x_points[i+1])/2.0 c = list(map( lambda instance: int(instance.is_valid(x)), self._instances)) x_status.append((x,c)) # sort per count since preferring passing through more intervals x_status.sort(key=lambda item: sum(item[1]), reverse=True) # finalize instances num = len(self._instances) current_status = [0] * num for x, status in x_status: # terminate if all instances are finalized if sum(current_status) == num: break # only one line is allowed to pass through one interval -> sum(A.*B)=0 # e.g. A = [1,0,1,0], B=[0,1,0,0] -> valid # A = [1,0,1,0], B =[1,0,0,0] -> invalid due to two lines passing through interval 1 duplicated = sum([c1*c2 for c1,c2 in zip(current_status, status)]) if duplicated: continue # update current status current_status = [c1+c2 for c1,c2 in zip(current_status, status)] # now, finalize instances for instance, instance_status in zip(self._instances, status): if instance_status: instance.finalize(x) \u76f4\u63a5\u5c55\u793a\u4e00\u4e0b\u7ed3\u679c\uff0c\u5982\u679c\u53bb\u6389\u4e0b\u9762\u4ee3\u7801\u4e2d I.solve() \u5c06\u5f97\u5230 {3.5, 4.0, 5.5, 5.0, 9.0} \uff0c\u4e5f\u5c31\u662f\u5f00\u59cb\u6240\u8bf4\u53c2\u5dee\u4e0d\u9f50\u7684\u60c5\u51b5\uff1b\u5982\u679c\u52a0\u4e0a\u533a\u95f4\u4f18\u5316\uff0c\u5219\u5f97\u5230 {9.0, 5.5} \uff0c\u5373\u5b9e\u9645\u4e0a\u5bf9\u9f50\u540e\u7684\u8fb9\u7ebf\u3002 if __name__ == '__main__': inputs = [[8, 10], [2, 6], [4, 6], [1, 6], [4, 6], [5, 6]] I = Intervals() for x_range in inputs: I.append(Interval(x_range)) I.solve() # optimize x = I.common_x() print(x) # if comment ot I.solve() # {3.5, 4.0, 5.5, 5.0, 9.0} # final result # {9.0, 5.5}","title":"\u6c42\u89e3\u7b80\u5316\u6a21\u578b"},{"location":"2020-09-27-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%AF%B9%E9%BD%90%E9%9A%90%E5%BC%8F%E8%A1%A8%E6%A0%BC%E7%BA%BF/#_3","text":"\u7b2c\u4e00\u6b65\u5047\u60f3\u8868\u683c\u7ebf\u65f6\uff0c\u5c3d\u91cf\u5bf9\u9f50\u6a2a\u7eb5\u8fb9\u7ebf\u4ee5\u7b80\u5316\u8868\u683c\u7ed3\u6784 \u7c7b\u4f3c\u4e8e\u7b80\u5316\u6a21\u578b\uff0c\u5206\u522b\u4f18\u5316\u6a2a\u3001\u7eb5\u8fb9\u7ebf\u3002\u4ee5\u7ad6\u76f4\u8fb9\u7ebf\u4e3a\u4f8b\uff0c\u6ce8\u610f\u4e0d\u4ec5\u6709\u5de6\u53f3\u533a\u95f4\u5c5e\u6027\uff08\u6c34\u5e73\u79fb\u52a8\u81ea\u7531\u5ea6\uff09\uff0c\u8fd8\u6709\u4e0a\u3001\u4e0b\u8fb9\u7ebf\u5c5e\u6027\uff0c\u5373\u5f15\u7528\u9650\u5b9a\u7ad6\u76f4\u8303\u56f4\u7684\u4e24\u6761\u6c34\u5e73\u8fb9\u7ebf\u3002\u53ea\u6709\u540c\u65f6\u786e\u5b9a\u6c34\u5e73\u4f4d\u7f6e\u548c\u4e0a\u4e0b\u8fb9\u7ebf\u540e\uff0c\u8fd9\u6761\u7ad6\u76f4\u8fb9\u7ebf\u624d\u5f97\u4ee5\u786e\u5b9a\u3002 \u517c\u5bb9\u534a\u9690\u5f0f\u8868\u683c\u4f8b\u5982\u4e09\u7ebf\u8868 \u4e0a\u4e00\u4e2a\u95ee\u9898\u4ee5\u5c3d\u91cf\u5bf9\u9f50\u8fb9\u7ebf\u4e3a\u539f\u5219\u4f18\u5316\u8fb9\u7ebf\u4f4d\u7f6e\uff0c\u5f53\u7ed9\u5b9a\u663e\u5f0f\u7684\u8868\u683c\u7ebf\u65f6\uff0c\u9700\u8981\u5f15\u5165\u4f18\u5148\u7ea7\u66f4\u9ad8\u7684\u539f\u5219\uff1a\u5c3d\u91cf\u901a\u8fc7\u663e\u5f0f\u7684\u8868\u683c\u7ebf\u3002 \u4ee5\u89e3\u6790\u4e09\u7ebf\u8868\u4e2d\u4e3a\u4f8b\uff0c\u5df2\u7ecf\u7ed9\u5b9a\u4e86\u663e\u5f0f\u7684\u6c34\u5e73\u8868\u683c\u7ebf h_i \uff08 i=1,2,3 \uff09\uff0c\u8003\u5bdf\u6240\u6709\u53ef\u80fd\u7684\u6c34\u5e73\u8fb9\u7ebf\u96c6\u5408 H \uff0c\u5982\u679c\u67d0\u6761\u6c34\u5e73\u8fb9\u7ebf H_i \u7684\u7ad6\u76f4\u6d3b\u52a8\u533a\u95f4 [yi_1,yi_2] \u6db5\u76d6\u663e\u5f0f\u8fb9\u7ebf h_i \u7684 yi \u5750\u6807\uff0c\u5e76\u4e14 H_i \u7684\u5de6\u53f3\u4e24\u6761\u7ad6\u76f4\u8fb9\u7ebf\u7684\u53ef\u80fd\u6d3b\u52a8\u533a\u57df [xi_1,xi_2] \u5728 h_i \u7684\u6c34\u5e73\u533a\u95f4\u5185\uff0c\u5219\u786e\u5b9a H_i \u7684\u7eb5\u5750\u6807 y=yi \u3002 \u6ce8\u610f \u534a\u9690\u5f0f\u8868\u683c\u7684\u89e3\u6790\u5b8c\u5168\u4f9d\u8d56\u4e8e\u9690\u5f0f\u8868\u683c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u9690\u5f0f\u8868\u683c\u672a\u80fd\u6b63\u786e\u8bc6\u522b\u539f\u59cb\u6587\u6863\u7684\u8868\u683c\u7ed3\u6784\uff0c\u5219\u76f4\u63a5\u5bfc\u81f4\u534a\u9690\u5f0f\u8868\u683c\u4e2d\u663e\u5f0f\u8868\u683c\u7ebf\u89e3\u6790\u5931\u8d25\u3002","title":"\u56de\u5230\u539f\u59cb\u95ee\u9898"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-10-15 | \u5206\u7c7b\uff1a process automation \u672c\u6587\u521d\u7a3f\u57fa\u4e8e PyMuPDF v1.18.0 \u7248\u672c\u64b0\u5199\uff0c\u540e\u7eed\u7248\u672c\u66f4\u65b0\uff0c\u90e8\u5206\u95ee\u9898\u5f97\u4ee5\u6539\u5584/\u89e3\u51b3\u3002\u53c2\u89c1\u6587\u4e2d\u5177\u4f53\u6ce8\u91ca\u3002 \u4e3a\u4e86\u5728docx\u4e2d\u91cd\u5efa\u56fe\u7247\uff0c\u6211\u4eec\u9700\u8981\u63d0\u53d6\u56fe\u7247\u7684\u5185\u5bb9\uff08\u4e8c\u8fdb\u5236\u6d41\uff09\u53ca\u5176\u4f4d\u7f6e\uff08\u5750\u6807\uff09\u3002 PyMuPDF \u63d0\u4f9b\u4e86\u4e24\u4e2a\u83b7\u53d6\u9875\u9762\u56fe\u7247\u7684API\uff1a page.getText('rawdict') \u548c page.getImageList() \uff0c\u4f46\u662f\u622a\u81f3 v1.18.0 \u7248\u672c\uff0c\u5176\u4e2d\u4efb\u610f\u5355\u72ec\u4e00\u4e2a\u65b9\u6cd5\u90fd\u65e0\u6cd5\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\uff0c\u672c\u6587\u8bb0\u5f55\u7efc\u5408\u8fd9\u4e24\u4e2aAPI\uff0c\u63d0\u53d6PDF\u9875\u9762\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e\u7684\u65b9\u6cd5\u3002 page.getText('rawdict') \u4e0e page.getImageList() \u00b6 \u4ee5 v1.18.0 \u7248\u672c\u4e3a\u4f8b\uff0c\u8fd9\u4e24\u4e2aAPI\uff08\u4e0b\u6587\u5206\u522b\u4ee5 rawdict \u548c getImageList \u6307\u4ee3\uff09\u7684\u4f7f\u7528\u8bf4\u660e\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a https://pymupdf.readthedocs.io/en/latest/page.html#Page.getText https://pymupdf.readthedocs.io/en/latest/page.html#Page.getImageList \u7b80\u8981\u6982\u62ec\u4e00\u4e0b\uff1a rawdict \u8fd4\u56de\u5f53\u524d\u9875\u9762\u5185\u5143\u7d20\uff08\u6587\u672c\u3001\u56fe\u7247\uff09\u5b57\u5178\uff0c\u5176\u4e2d\u4e0e\u56fe\u7247\u76f8\u5173\u7684\u4e3b\u8981\u952e\u53ca\u5176\u610f\u4e49\u5982\u4e0b key description bbox \u56fe\u7247\u533a\u57df\uff1a\u5de6\u4e0a\u89d2\u3001\u53f3\u4e0b\u89d2\u5750\u6807 (x0, y0, x1, y1) width, height \u56fe\u7247\u539f\u59cb\u5bbd\u5ea6\u548c\u9ad8\u5ea6 ext \u56fe\u7247\u540e\u7f00\u540d image bytes \u683c\u5f0f\u7684\u56fe\u7247\u5185\u5bb9 getImageList \u8fd4\u56de\u5f53\u524d\u9875\u9762\u5185\u56fe\u7247\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5143\u7d20\u662f\u4e00\u4e2a\u5143\u7ec4 (xref, smask, width, height, bpc, colorspace, alt. colorspace, name, filter, referencer) key description xref \u56fe\u7247\u5185\u5bb9\u7d22\u5f15\u53f7\uff0c fitz.Pixmap(doc, xref) \u83b7\u53d6\u5230\u4f4d\u56fe\u5185\u5bb9 smask \u56fe\u7247\u906e\u7f69\uff08Soft Mask\uff09\u7d22\u5f15\u53f7\uff0c\u5b58\u50a8\u901a\u9053\u6570\u636e width, height \u56fe\u7247\u539f\u59cb\u5bbd\u5ea6\u548c\u9ad8\u5ea6 \u521d\u6b65\u5bf9\u6bd4\uff0c\u4e8c\u8005\u76f8\u540c\u70b9\u662f\u90fd\u80fd\u83b7\u53d6\u5230\u56fe\u7247\u5185\u5bb9\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e rawdict \u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\u5230\u4f4d\u7f6e\u4fe1\u606f\uff0c\u800c getImageList \u5f97\u5230\u4e86\u56fe\u7247\u7684\u539f\u59cb\u7d22\u5f15 xref \uff0c\u53ef\u4ee5\u83b7\u53d6\u5305\u62ec\u56fe\u7247\u4f4d\u7f6e\uff08 page.getImageBbox(item) \uff09\u5728\u5185\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u6ce8\u610f page.getImageBbox(item) \u83b7\u53d6\u7684\u4f4d\u7f6e\u4fe1\u606f\u5e76\u975e100%\u53ef\u9760 Issue-699 \u8fd9\u6837\u770b\u6765\uff0c rawdict \u8db3\u4ee5\u6ee1\u8db3\u83b7\u53d6\u56fe\u7247\u5185\u5bb9\u548c\u4f4d\u7f6e\u7684\u8981\u6c42\u3002\u4f46\u662f\uff0c\u5177\u4f53\u5b9e\u8df5\u4e2d\u5374\u53d1\u73b0\u4e86\u4e00\u4e9b\u7279\u6b8a\u60c5\u5f62\u3002 1. rawdict \u6216 getImageList \u83b7\u53d6\u56fe\u7247\u7684\u80cc\u666f\u8272\u9519\u8bef \u00b6 \u5bf9\u4e8e\u67d0\u4e9b\u56fe\u7247\uff0c\u65e0\u8bba\u662f rawdict \u7684 image \uff0c\u8fd8\u662f getImageList \u7684 fitz.Pixmap(doc, xref) \u5f97\u5230\u7684\u56fe\u7247\u989c\u8272\u90fd\u4e0d\u6b63\u786e\u3002\u5177\u4f53\u53c8\u5206\u4e3a\u4ee5\u4e0b\u4e24\u79cd\u60c5\u5f62\uff1a (a) CMYK \u989c\u8272\u7a7a\u95f4\u6216\u900f\u660e\u56fe\u7247\uff0c\u53c2\u89c1 Issue-670 \u00b6 PyMuPDF \u5b98\u65b9\u793a\u4f8b \u501f\u52a9 pillow \u5e93\u8fdb\u884c alpha \u901a\u9053\u4fee\u590d\uff0c\u672c\u6587\u91c7\u7528\u4e86 PyMuPDF \u539f\u751f\u65b9\u6cd5\uff1a \u5982\u679c\u5b58\u5728\u5219\u52a0\u5165 alpha \u901a\u9053 \u5982\u679c\u4e0d\u662f\u5e38\u89c4\u7684 RGB \u6216 gray \u989c\u8272\u7a7a\u95f4\uff08\u4f8b\u5982 CMYK \uff09\uff0c\u5219\u8f6c\u6362\u5230 RGB \u7a7a\u95f4 \u6839\u636e\u4f5c\u8005\u7684\u89e3\u91ca\uff0c\u539f\u751f\u65b9\u6cd5\u5e76\u975e100%\u7a33\u5b9a\uff1b\u4f46\u662f\u4e8e\u6211\u800c\u8a00\uff0c\u53ef\u4ee5\u907f\u514d\u4ec5\u4ec5\u56e0\u4e3a\u8f83\u5c0f\u6982\u7387\u7684\u7279\u6b8a\u60c5\u51b5\u800c\u5f15\u5165 pillow \u5e93\u4f9d\u8d56\u3002 def recover_pixmap(doc:fitz.Document, item:list): '''Restore pixmap with soft mask considered. --- - doc: fitz document - item: an image item got from page.getImageList() ''' # data structure of `item`: # (xref, smask, width, height, bpc, colorspace, ...) x = item[0] # xref of PDF image s = item[1] # xref of its /SMask # base image pix = fitz.Pixmap(doc, x) # reconstruct the alpha channel with the smask if exists if s > 0: # copy of base image, with an alpha channel added pix = fitz.Pixmap(pix, 1) # create pixmap of the /SMask entry ba = bytearray(fitz.Pixmap(doc, s).samples) for i in range(len(ba)): if ba[i] > 0: ba[i] = 255 pix.setAlpha(ba) # we may need to adjust something for CMYK pixmaps here -> # recreate pixmap in RGB color space if necessary # NOTE: pix.colorspace may be None for images with alpha channel values only if pix.colorspace and not pix.colorspace.name in (fitz.csGRAY.name, fitz.csRGB.name): pix = fitz.Pixmap(fitz.csRGB, pix) return pix (b) \u53ea\u6709 alpha \u901a\u9053\u7684\u56fe\u7247\uff0c\u53c2\u89c1 Issue-677 \u00b6 \u6ce8\u610f\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5f53\u989c\u8272\u7a7a\u95f4 pix.colorspace \u4e3a\u7a7a\uff0c\u4e5f\u5c31\u662f\u4e00\u526f\u4ec5\u6709 alpha \u901a\u9053\u7684\u56fe\u7247\uff0c\u90a3\u4e48\u4e0a\u8ff0\u4e3a\u57fa\u672c\u56fe\u7247\u6dfb\u52a0 alpha \u901a\u9053\u7684\u65b9\u6cd5\u5c06\u5931\u6548\u3002 The problem here is that the image at xref 9 consists of alpha values only, i.e. colorspace None as you noted. The turquoise color you see in the PDF is not part of the image, but part of PDF background, established right before that image is invoked for display. \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u4e2a\u53d6\u5de7\u7684\u65b9\u6cd5\u662f\uff1a\u83b7\u53d6\u8be5\u56fe\u7247\u7684\u533a\u57df\uff0c\u7136\u540e\u5728\u8be5\u533a\u57df\u5185\u622a\u56fe\u3002\u540c\u65f6\u5904\u7406\u4e24\u4e2a\u5177\u4f53\u95ee\u9898\uff1a \u4e3a\u907f\u514d\u91cd\u53e0\u7684\u6587\u672c\u51fa\u73b0\u5728\u622a\u56fe\u533a\u57df\uff0c\u9700\u8981\u5728\u622a\u56fe\u524d\u9690\u85cf\u6587\u672c \u8c03\u6574\u5206\u8fa8\u7387\u4ee5\u4fdd\u8bc1\u622a\u56fe\u7684\u8d28\u91cf def clip_page(page:fitz.Page, bbox:fitz.Rect=None, zoom:float=3.0): '''Clip page pixmap (without text) according to `bbox` (entire page by default). ''' # hide text before clip the image only # render Tr: set the text rendering mode # - 3: neither fill nor stroke the text -> invisible # read more: # - https://github.com/pymupdf/PyMuPDF/issues/257 # - https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/pdf_reference_archives/PDFReference.pdf doc = page.parent for xref in page._getContents(): stream = doc._getXrefStream(xref).replace(b'BT', b'BT 3 Tr') \\ .replace(b'Tm', b'Tm 3 Tr') \\ .replace(b'Td', b'Td 3 Tr') doc._updateStream(xref, stream) # improve resolution # - https://pymupdf.readthedocs.io/en/latest/faq.html#how-to-increase-image-resolution # - https://github.com/pymupdf/PyMuPDF/issues/181 bbox = page.rect if bbox is None else bbox & page.rect image = page.getPixmap(clip=bbox, matrix=fitz.Matrix(zoom, zoom)) # type: fitz.Pixmap return image \u7efc\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e00\u5904\u7406 getImageList \u83b7\u53d6\u7684\u56fe\u7247\uff08 rawdict \u65e0\u6cd5\u7ed9\u51fa alpha \u901a\u9053\u7684\u6570\u636e\uff09 def extract_images(page:fitz.Page, clip_image_res_ratio:float=3.0): ''' Get images list with contents recovered.''' doc = page.parent # pdf document # check each image item: # (xref, smask, width, height, bpc, colorspace, ...) images = [] for item in page.getImageList(full=True): try: item = list(item) item[-1] = 0 bbox = page.getImageBbox(item) except ValueError: continue # ignore images outside page if not bbox.intersects(page.rect): continue # recover cmyk / transparent images pix = recover_pixmap(doc, item) # clip page for image with alpha values only if not pix.colorspace: pix = clip_page(page, bbox, zoom=clip_image_res_ratio) images.append(pix) return images 2. getImageList \u4e0d\u5305\u542b\u540c\u4e00\u56fe\u7247\u7684\u4e0d\u540c\u5b9e\u4f8b \u00b6 \u4e0a\u9762\u57fa\u4e8e getImageList \u7684\u65b9\u6cd5\u8c8c\u4f3c\u5b8c\u7f8e\u4e86\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u5982\u679c\u540c\u4e00\u56fe\u7247\u590d\u5236\u591a\u6b21\u540e\u7c98\u8d34\u5728\u9875\u9762\u4e0a\uff0c getImageList \u4ec5\u4ec5\u5305\u542b\u5176\u4e2d\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u800c rawdict \u5219\u4f1a\u8ba1\u7b97\u8be5\u56fe\u7247\u51fa\u73b0\u7684\u6bcf\u4e2a\u5730\u65b9\u3002 Image blocks in a textpage are generated for every image location \u2013 whether or not there are any duplicates. This is in contrast to Page.getImageList(), which will contain each image only once. 1.18.13 \u7248\u672c\u65b0\u589e\u4e86 get_image_rects \u65b9\u6cd5\uff0c\u5b83\u662f getImageBbox \uff08\u5373\u540e\u7eed\u6539\u7528\u4e0b\u5212\u7ebf\u65b9\u5f0f\u7684 get_image_bbox \uff09\u7684\u6539\u8fdb\u65b9\u6cd5\uff0c\u53ef\u4ee5\u83b7\u53d6\u540c\u4e00\u56fe\u7247\u7684\u6bcf\u4e00\u4e2a\u5f15\u7528\u5b9e\u4f8b\u7684\u5177\u4f53\u4f4d\u7f6e\u3002 \u56e0\u6b64\uff0c\u4e0d\u5fc5\u518d\u501f\u52a9 rawdict \u83b7\u53d6\u6240\u6709\u5b9e\u4f8b\uff0c\u5373\u4ee5\u4e0b\u81ea\u5220\u9664\u7ebf\u6bb5\u843d\u8d77\u7684(1)-(4)\u6b65\u9aa4\u5df2\u7ecf\u8fc7\u671f\u3002 The result is a list of Rect or (Rect, Matrix) objects \u2013 depending on transform. Each list item represents one location of the image on the page. Multiple occurrences might not be detectable by Page.get_image_bbox(). \u6240\u4ee5\u8fd8\u4e0d\u80fd\u653e\u5f03 rawdict\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u5df2\u77e5\uff1a getImageList \u5f97\u5230\u4e86\u56fe\u7247\u7684\u6b63\u786e\u5185\u5bb9\uff0c\u4ee5\u53ca\u91cd\u590d\u56fe\u7247\u4e2d\u7684\u67d0\u4e00\u4e2a\u4f4d\u7f6e rawdict \u5f97\u5230\u4e86\u6240\u6709\u91cd\u590d\u56fe\u7247\u7684\u6b63\u786e\u4f4d\u7f6e \u7ed3\u5408\u4e8c\u8005\u5373\u53ef\u5f97\u5230\u6b63\u786e\u7684\u5185\u5bb9\u548c\u6240\u6709\u4f4d\u7f6e\uff1a (1) \u4ee5 rawdict \u7684 image \u503c\u4e3a\u952e\u5206\u7ec4\uff0c\u6bcf\u4e00\u7ec4\u5373\u4e3a\u91cd\u590d\u56fe\u7247\u5217\u8868\uff0c\u5217\u8868\u4e2d\u56fe\u7247\u7684\u4f4d\u7f6e\u6b63\u786e\uff0c\u4f46\u662f\u5185\u5bb9\u53ef\u80fd\u4e0d\u6b63\u786e\uff08\u4f8b\u5982\u4e22\u5931 alpha \u901a\u9053\uff09 (2) \u5982\u679c getImageList \u67d0\u4e00\u56fe\u7247\u7684\u4f4d\u7f6e bbox \u51fa\u73b0\u5728\u4e0a\u8ff0\u67d0\u4e00\u5206\u7ec4\u7684 bbox \u5217\u8868\u4e2d\uff0c\u5219\u5c06\u6539\u7ec4\u6240\u6709\u56fe\u7247\u7684\u5185\u5bb9\u4fee\u6b63\u4e3a getImageList \u8be5\u56fe\u7247\u7684\u5185\u5bb9 3. rawdict \u4ec5\u5305\u542b\u5b8c\u5168\u663e\u793a\u5728\u9875\u9762\u5185\u7684\u56fe\u7247 \u00b6 \u4e0a\u4e00\u6b65\u7684\u5904\u7406\u4ee5 rawdict \u4e3a\u57fa\u7840\uff0c\u4ee5 getImageList \u8fdb\u884c\u4fee\u6b63\u3002\u5982\u679c\u4e00\u526f\u56fe\u7247\u6709\u4efb\u4f55\u90e8\u5206\u51fa\u73b0\u5728\u9875\u9762\u4e4b\u5916\uff0c\u5219\u5e76\u4e0d\u4f1a\u88ab rawdict \u7edf\u8ba1\u3002\u6240\u4ee5\u9700\u8981\u5728\u4e0a\u9762\u5904\u7406\u903b\u8f91\u4e2d\u518d\u52a0\u4e00\u6b65\uff1a (3) \u5982\u679c getImageList \u67d0\u4e00\u56fe\u7247\u7684\u4f4d\u7f6e bbox \u4e0d\u51fa\u73b0\u5728\u4efb\u4f55 rawdict \u5206\u7ec4\u4e2d\uff0c\u5219\u52a0\u5165\u8be5\u56fe\u7247 4. rawdict \u53ef\u80fd\u5305\u542b\u201c\u865a\u5047\u201d\u56fe\u7247 \u00b6 \u4e0a\u4e00\u6b65\u8865\u6551\u4e86 getImageList \u542b\u6709 rawdict \u4e2d\u4e0d\u5b58\u5728\u7684\u56fe\u7247\u7684\u60c5\u5f62\uff1b\u76f8\u53cd\uff0c rawdict \u4e5f\u53ef\u80fd\u542b\u6709 getImageList \u4e2d\u4e0d\u5b58\u5728\u7684\u56fe\u7247\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e9b\u662f\u201c\u865a\u5047\u201d\u56fe\u7247\u2014\u2014\u56e0\u4e3a getImageList \u7edf\u8ba1\u4e86\u6240\u6709\u5df2\u663e\u793a\u6216\u8005\u672a\u663e\u793a\u7684\u56fe\u7247\u3002\u672c\u6587\u9047\u5230\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u67d0\u4e9b\u590d\u6742\u7684\u77e2\u91cf\u56fe\u5f62\u88ab\u9519\u8bef\u5730\u8f6c\u6362\u4e3a\u56fe\u7247\u800c\u8ba1\u7b97\u5230 rawdict \u4e2d\u53bb\u4e86\u3002 \u6b64\u65f6\uff0c\u518d\u8ffd\u52a0\u4e00\u6b65\uff1a (4) \u5982\u679c getImageList \u6240\u6709\u56fe\u7247\u7684\u4f4d\u7f6e bbox \u90fd\u4e0d\u51fa\u73b0\u5728\u67d0\u4e00 rawdict \u5206\u7ec4\uff0c\u5219\u5220\u9664\u8be5\u5206\u7ec4 5. PDF\u626b\u63cf\u56fe\u7247\u7684\u4e00\u4e9b\u4f8b\u5916 \u00b6 \u81ea\u521d\u7a3f\u4ee5\u6765\uff0c\u5b9e\u8df5\u4e2d\u53c8\u53d1\u73b0\u901a\u5e38\u51fa\u73b0\u5728PDF\u626b\u63cf\u4ef6\u4e2d\u7684\u4e24\u7c7b\u4f8b\u5916\uff1a \u4eba\u773c\u53ef\u89c1\u7684\u4e00\u5f20\u5b8c\u6574\u56fe\u7247\u5728PDF\u4e2d\u5374\u662f\u7531\u8bb8\u591a\u5f20\u5b50\u56fe\u7ec4\u6210\u7684\uff0c\u867d\u7136\u76f4\u63a5\u63d0\u53d6\u591a\u5e45\u5b50\u56fe\u903b\u8f91\u4e0a\u6ca1\u9519\uff0c\u4f46\u662f\u901a\u8fc7\u76f8\u4ea4\u68c0\u6d4b\u5e76\u5c06\u5176\u5408\u5e76\u4e3a\u4e00\u5f20\u56fe\u7247\u8f93\u51fa\uff0c\u53ef\u4ee5\u5f97\u5230\u8ddf\u6240\u89c1\u66f4\u4e3a\u76f8\u7b26\u7684\u7ed3\u679c\u3002 \u5f53\u539f\u59cbPDF\u5750\u6807\u7cfb\u4e0e\u6e32\u67d3\u540e\u9875\u9762\u4e4b\u95f4\u5b58\u5728\u975e\u96f6\u7684\u65cb\u8f6c\u89d2\u5ea6\u65f6\uff0c\u4eba\u773c\u53ef\u89c1\u7684\u6b63\u7acb\u56fe\u7247\u5b9e\u9645\u662f\u4ee5\u4e00\u5b9a\u65cb\u8f6c\u89d2\u5ea6\u5b58\u50a8\u5728PDF\u4e2d\u7684\uff0c\u56e0\u6b64\u76f4\u63a5\u63d0\u53d6\u7684\u56fe\u7247\u662f\u65cb\u8f6c\u7684\uff0c\u9700\u8981\u501f\u52a9\u56fe\u50cf\u5904\u7406\u5e93\u9006\u5411\u65cb\u8f6c\u56de\u53bb\u624d\u80fd\u5f97\u5230\u548c\u6240\u89c1\u4e00\u81f4\u7684\u56fe\u7247\u3002 \u603b\u7ed3 \u00b6 getImageList \u6216 rawdict \u5f97\u5230\u56fe\u7247\u7684\u5185\u5bb9\u53ef\u80fd\u4e0d\u6b63\u786e\uff0c\u9700\u8981\u8fdb\u884c\u4fee\u590d\u6216\u622a\u56fe\u5904\u7406 getImageList \u83b7\u53d6\u7684\u56fe\u7247\uff08\u663e\u793a/\u672a\u663e\u793a\uff09\u624d\u7b97\u771f\u6b63\u7684\u56fe\u7247 rawdict \u83b7\u53d6\u91cd\u590d\u56fe\u7247\u7684\u6bcf\u4e00\u4e2a\u4f4d\u7f6e \u6ce8\u610f \u56fe\u7247\u5206\u5272 \u53ca \u9875\u9762\u65cb\u8f6c \u5f15\u8d77\u76f4\u63a5\u63d0\u53d6\u7684\u56fe\u7247\u548c\u6700\u7ec8\u6e32\u67d3\u7ed3\u679c\u4e4b\u95f4\u7684\u5dee\u5f02","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-10-15 | \u5206\u7c7b\uff1a process automation \u672c\u6587\u521d\u7a3f\u57fa\u4e8e PyMuPDF v1.18.0 \u7248\u672c\u64b0\u5199\uff0c\u540e\u7eed\u7248\u672c\u66f4\u65b0\uff0c\u90e8\u5206\u95ee\u9898\u5f97\u4ee5\u6539\u5584/\u89e3\u51b3\u3002\u53c2\u89c1\u6587\u4e2d\u5177\u4f53\u6ce8\u91ca\u3002 \u4e3a\u4e86\u5728docx\u4e2d\u91cd\u5efa\u56fe\u7247\uff0c\u6211\u4eec\u9700\u8981\u63d0\u53d6\u56fe\u7247\u7684\u5185\u5bb9\uff08\u4e8c\u8fdb\u5236\u6d41\uff09\u53ca\u5176\u4f4d\u7f6e\uff08\u5750\u6807\uff09\u3002 PyMuPDF \u63d0\u4f9b\u4e86\u4e24\u4e2a\u83b7\u53d6\u9875\u9762\u56fe\u7247\u7684API\uff1a page.getText('rawdict') \u548c page.getImageList() \uff0c\u4f46\u662f\u622a\u81f3 v1.18.0 \u7248\u672c\uff0c\u5176\u4e2d\u4efb\u610f\u5355\u72ec\u4e00\u4e2a\u65b9\u6cd5\u90fd\u65e0\u6cd5\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\uff0c\u672c\u6587\u8bb0\u5f55\u7efc\u5408\u8fd9\u4e24\u4e2aAPI\uff0c\u63d0\u53d6PDF\u9875\u9762\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e\u7684\u65b9\u6cd5\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#pagegettextrawdict pagegetimagelist","text":"\u4ee5 v1.18.0 \u7248\u672c\u4e3a\u4f8b\uff0c\u8fd9\u4e24\u4e2aAPI\uff08\u4e0b\u6587\u5206\u522b\u4ee5 rawdict \u548c getImageList \u6307\u4ee3\uff09\u7684\u4f7f\u7528\u8bf4\u660e\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a https://pymupdf.readthedocs.io/en/latest/page.html#Page.getText https://pymupdf.readthedocs.io/en/latest/page.html#Page.getImageList \u7b80\u8981\u6982\u62ec\u4e00\u4e0b\uff1a rawdict \u8fd4\u56de\u5f53\u524d\u9875\u9762\u5185\u5143\u7d20\uff08\u6587\u672c\u3001\u56fe\u7247\uff09\u5b57\u5178\uff0c\u5176\u4e2d\u4e0e\u56fe\u7247\u76f8\u5173\u7684\u4e3b\u8981\u952e\u53ca\u5176\u610f\u4e49\u5982\u4e0b key description bbox \u56fe\u7247\u533a\u57df\uff1a\u5de6\u4e0a\u89d2\u3001\u53f3\u4e0b\u89d2\u5750\u6807 (x0, y0, x1, y1) width, height \u56fe\u7247\u539f\u59cb\u5bbd\u5ea6\u548c\u9ad8\u5ea6 ext \u56fe\u7247\u540e\u7f00\u540d image bytes \u683c\u5f0f\u7684\u56fe\u7247\u5185\u5bb9 getImageList \u8fd4\u56de\u5f53\u524d\u9875\u9762\u5185\u56fe\u7247\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5143\u7d20\u662f\u4e00\u4e2a\u5143\u7ec4 (xref, smask, width, height, bpc, colorspace, alt. colorspace, name, filter, referencer) key description xref \u56fe\u7247\u5185\u5bb9\u7d22\u5f15\u53f7\uff0c fitz.Pixmap(doc, xref) \u83b7\u53d6\u5230\u4f4d\u56fe\u5185\u5bb9 smask \u56fe\u7247\u906e\u7f69\uff08Soft Mask\uff09\u7d22\u5f15\u53f7\uff0c\u5b58\u50a8\u901a\u9053\u6570\u636e width, height \u56fe\u7247\u539f\u59cb\u5bbd\u5ea6\u548c\u9ad8\u5ea6 \u521d\u6b65\u5bf9\u6bd4\uff0c\u4e8c\u8005\u76f8\u540c\u70b9\u662f\u90fd\u80fd\u83b7\u53d6\u5230\u56fe\u7247\u5185\u5bb9\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e rawdict \u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\u5230\u4f4d\u7f6e\u4fe1\u606f\uff0c\u800c getImageList \u5f97\u5230\u4e86\u56fe\u7247\u7684\u539f\u59cb\u7d22\u5f15 xref \uff0c\u53ef\u4ee5\u83b7\u53d6\u5305\u62ec\u56fe\u7247\u4f4d\u7f6e\uff08 page.getImageBbox(item) \uff09\u5728\u5185\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u6ce8\u610f page.getImageBbox(item) \u83b7\u53d6\u7684\u4f4d\u7f6e\u4fe1\u606f\u5e76\u975e100%\u53ef\u9760 Issue-699 \u8fd9\u6837\u770b\u6765\uff0c rawdict \u8db3\u4ee5\u6ee1\u8db3\u83b7\u53d6\u56fe\u7247\u5185\u5bb9\u548c\u4f4d\u7f6e\u7684\u8981\u6c42\u3002\u4f46\u662f\uff0c\u5177\u4f53\u5b9e\u8df5\u4e2d\u5374\u53d1\u73b0\u4e86\u4e00\u4e9b\u7279\u6b8a\u60c5\u5f62\u3002","title":"page.getText('rawdict') \u4e0e page.getImageList()"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#1 rawdictgetimagelist","text":"\u5bf9\u4e8e\u67d0\u4e9b\u56fe\u7247\uff0c\u65e0\u8bba\u662f rawdict \u7684 image \uff0c\u8fd8\u662f getImageList \u7684 fitz.Pixmap(doc, xref) \u5f97\u5230\u7684\u56fe\u7247\u989c\u8272\u90fd\u4e0d\u6b63\u786e\u3002\u5177\u4f53\u53c8\u5206\u4e3a\u4ee5\u4e0b\u4e24\u79cd\u60c5\u5f62\uff1a","title":"1. rawdict\u6216getImageList\u83b7\u53d6\u56fe\u7247\u7684\u80cc\u666f\u8272\u9519\u8bef"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#a cmykissue-670","text":"PyMuPDF \u5b98\u65b9\u793a\u4f8b \u501f\u52a9 pillow \u5e93\u8fdb\u884c alpha \u901a\u9053\u4fee\u590d\uff0c\u672c\u6587\u91c7\u7528\u4e86 PyMuPDF \u539f\u751f\u65b9\u6cd5\uff1a \u5982\u679c\u5b58\u5728\u5219\u52a0\u5165 alpha \u901a\u9053 \u5982\u679c\u4e0d\u662f\u5e38\u89c4\u7684 RGB \u6216 gray \u989c\u8272\u7a7a\u95f4\uff08\u4f8b\u5982 CMYK \uff09\uff0c\u5219\u8f6c\u6362\u5230 RGB \u7a7a\u95f4 \u6839\u636e\u4f5c\u8005\u7684\u89e3\u91ca\uff0c\u539f\u751f\u65b9\u6cd5\u5e76\u975e100%\u7a33\u5b9a\uff1b\u4f46\u662f\u4e8e\u6211\u800c\u8a00\uff0c\u53ef\u4ee5\u907f\u514d\u4ec5\u4ec5\u56e0\u4e3a\u8f83\u5c0f\u6982\u7387\u7684\u7279\u6b8a\u60c5\u51b5\u800c\u5f15\u5165 pillow \u5e93\u4f9d\u8d56\u3002 def recover_pixmap(doc:fitz.Document, item:list): '''Restore pixmap with soft mask considered. --- - doc: fitz document - item: an image item got from page.getImageList() ''' # data structure of `item`: # (xref, smask, width, height, bpc, colorspace, ...) x = item[0] # xref of PDF image s = item[1] # xref of its /SMask # base image pix = fitz.Pixmap(doc, x) # reconstruct the alpha channel with the smask if exists if s > 0: # copy of base image, with an alpha channel added pix = fitz.Pixmap(pix, 1) # create pixmap of the /SMask entry ba = bytearray(fitz.Pixmap(doc, s).samples) for i in range(len(ba)): if ba[i] > 0: ba[i] = 255 pix.setAlpha(ba) # we may need to adjust something for CMYK pixmaps here -> # recreate pixmap in RGB color space if necessary # NOTE: pix.colorspace may be None for images with alpha channel values only if pix.colorspace and not pix.colorspace.name in (fitz.csGRAY.name, fitz.csRGB.name): pix = fitz.Pixmap(fitz.csRGB, pix) return pix","title":"(a) CMYK\u989c\u8272\u7a7a\u95f4\u6216\u900f\u660e\u56fe\u7247\uff0c\u53c2\u89c1Issue-670"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#b alphaissue-677","text":"\u6ce8\u610f\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5f53\u989c\u8272\u7a7a\u95f4 pix.colorspace \u4e3a\u7a7a\uff0c\u4e5f\u5c31\u662f\u4e00\u526f\u4ec5\u6709 alpha \u901a\u9053\u7684\u56fe\u7247\uff0c\u90a3\u4e48\u4e0a\u8ff0\u4e3a\u57fa\u672c\u56fe\u7247\u6dfb\u52a0 alpha \u901a\u9053\u7684\u65b9\u6cd5\u5c06\u5931\u6548\u3002 The problem here is that the image at xref 9 consists of alpha values only, i.e. colorspace None as you noted. The turquoise color you see in the PDF is not part of the image, but part of PDF background, established right before that image is invoked for display. \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u4e2a\u53d6\u5de7\u7684\u65b9\u6cd5\u662f\uff1a\u83b7\u53d6\u8be5\u56fe\u7247\u7684\u533a\u57df\uff0c\u7136\u540e\u5728\u8be5\u533a\u57df\u5185\u622a\u56fe\u3002\u540c\u65f6\u5904\u7406\u4e24\u4e2a\u5177\u4f53\u95ee\u9898\uff1a \u4e3a\u907f\u514d\u91cd\u53e0\u7684\u6587\u672c\u51fa\u73b0\u5728\u622a\u56fe\u533a\u57df\uff0c\u9700\u8981\u5728\u622a\u56fe\u524d\u9690\u85cf\u6587\u672c \u8c03\u6574\u5206\u8fa8\u7387\u4ee5\u4fdd\u8bc1\u622a\u56fe\u7684\u8d28\u91cf def clip_page(page:fitz.Page, bbox:fitz.Rect=None, zoom:float=3.0): '''Clip page pixmap (without text) according to `bbox` (entire page by default). ''' # hide text before clip the image only # render Tr: set the text rendering mode # - 3: neither fill nor stroke the text -> invisible # read more: # - https://github.com/pymupdf/PyMuPDF/issues/257 # - https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/pdf_reference_archives/PDFReference.pdf doc = page.parent for xref in page._getContents(): stream = doc._getXrefStream(xref).replace(b'BT', b'BT 3 Tr') \\ .replace(b'Tm', b'Tm 3 Tr') \\ .replace(b'Td', b'Td 3 Tr') doc._updateStream(xref, stream) # improve resolution # - https://pymupdf.readthedocs.io/en/latest/faq.html#how-to-increase-image-resolution # - https://github.com/pymupdf/PyMuPDF/issues/181 bbox = page.rect if bbox is None else bbox & page.rect image = page.getPixmap(clip=bbox, matrix=fitz.Matrix(zoom, zoom)) # type: fitz.Pixmap return image \u7efc\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e00\u5904\u7406 getImageList \u83b7\u53d6\u7684\u56fe\u7247\uff08 rawdict \u65e0\u6cd5\u7ed9\u51fa alpha \u901a\u9053\u7684\u6570\u636e\uff09 def extract_images(page:fitz.Page, clip_image_res_ratio:float=3.0): ''' Get images list with contents recovered.''' doc = page.parent # pdf document # check each image item: # (xref, smask, width, height, bpc, colorspace, ...) images = [] for item in page.getImageList(full=True): try: item = list(item) item[-1] = 0 bbox = page.getImageBbox(item) except ValueError: continue # ignore images outside page if not bbox.intersects(page.rect): continue # recover cmyk / transparent images pix = recover_pixmap(doc, item) # clip page for image with alpha values only if not pix.colorspace: pix = clip_page(page, bbox, zoom=clip_image_res_ratio) images.append(pix) return images","title":"(b) \u53ea\u6709alpha\u901a\u9053\u7684\u56fe\u7247\uff0c\u53c2\u89c1Issue-677"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#2 getimagelist","text":"\u4e0a\u9762\u57fa\u4e8e getImageList \u7684\u65b9\u6cd5\u8c8c\u4f3c\u5b8c\u7f8e\u4e86\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u5982\u679c\u540c\u4e00\u56fe\u7247\u590d\u5236\u591a\u6b21\u540e\u7c98\u8d34\u5728\u9875\u9762\u4e0a\uff0c getImageList \u4ec5\u4ec5\u5305\u542b\u5176\u4e2d\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u800c rawdict \u5219\u4f1a\u8ba1\u7b97\u8be5\u56fe\u7247\u51fa\u73b0\u7684\u6bcf\u4e2a\u5730\u65b9\u3002 Image blocks in a textpage are generated for every image location \u2013 whether or not there are any duplicates. This is in contrast to Page.getImageList(), which will contain each image only once. 1.18.13 \u7248\u672c\u65b0\u589e\u4e86 get_image_rects \u65b9\u6cd5\uff0c\u5b83\u662f getImageBbox \uff08\u5373\u540e\u7eed\u6539\u7528\u4e0b\u5212\u7ebf\u65b9\u5f0f\u7684 get_image_bbox \uff09\u7684\u6539\u8fdb\u65b9\u6cd5\uff0c\u53ef\u4ee5\u83b7\u53d6\u540c\u4e00\u56fe\u7247\u7684\u6bcf\u4e00\u4e2a\u5f15\u7528\u5b9e\u4f8b\u7684\u5177\u4f53\u4f4d\u7f6e\u3002 \u56e0\u6b64\uff0c\u4e0d\u5fc5\u518d\u501f\u52a9 rawdict \u83b7\u53d6\u6240\u6709\u5b9e\u4f8b\uff0c\u5373\u4ee5\u4e0b\u81ea\u5220\u9664\u7ebf\u6bb5\u843d\u8d77\u7684(1)-(4)\u6b65\u9aa4\u5df2\u7ecf\u8fc7\u671f\u3002 The result is a list of Rect or (Rect, Matrix) objects \u2013 depending on transform. Each list item represents one location of the image on the page. Multiple occurrences might not be detectable by Page.get_image_bbox(). \u6240\u4ee5\u8fd8\u4e0d\u80fd\u653e\u5f03 rawdict\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u5df2\u77e5\uff1a getImageList \u5f97\u5230\u4e86\u56fe\u7247\u7684\u6b63\u786e\u5185\u5bb9\uff0c\u4ee5\u53ca\u91cd\u590d\u56fe\u7247\u4e2d\u7684\u67d0\u4e00\u4e2a\u4f4d\u7f6e rawdict \u5f97\u5230\u4e86\u6240\u6709\u91cd\u590d\u56fe\u7247\u7684\u6b63\u786e\u4f4d\u7f6e \u7ed3\u5408\u4e8c\u8005\u5373\u53ef\u5f97\u5230\u6b63\u786e\u7684\u5185\u5bb9\u548c\u6240\u6709\u4f4d\u7f6e\uff1a (1) \u4ee5 rawdict \u7684 image \u503c\u4e3a\u952e\u5206\u7ec4\uff0c\u6bcf\u4e00\u7ec4\u5373\u4e3a\u91cd\u590d\u56fe\u7247\u5217\u8868\uff0c\u5217\u8868\u4e2d\u56fe\u7247\u7684\u4f4d\u7f6e\u6b63\u786e\uff0c\u4f46\u662f\u5185\u5bb9\u53ef\u80fd\u4e0d\u6b63\u786e\uff08\u4f8b\u5982\u4e22\u5931 alpha \u901a\u9053\uff09 (2) \u5982\u679c getImageList \u67d0\u4e00\u56fe\u7247\u7684\u4f4d\u7f6e bbox \u51fa\u73b0\u5728\u4e0a\u8ff0\u67d0\u4e00\u5206\u7ec4\u7684 bbox \u5217\u8868\u4e2d\uff0c\u5219\u5c06\u6539\u7ec4\u6240\u6709\u56fe\u7247\u7684\u5185\u5bb9\u4fee\u6b63\u4e3a getImageList \u8be5\u56fe\u7247\u7684\u5185\u5bb9","title":"2. getImageList\u4e0d\u5305\u542b\u540c\u4e00\u56fe\u7247\u7684\u4e0d\u540c\u5b9e\u4f8b"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#3 rawdict","text":"\u4e0a\u4e00\u6b65\u7684\u5904\u7406\u4ee5 rawdict \u4e3a\u57fa\u7840\uff0c\u4ee5 getImageList \u8fdb\u884c\u4fee\u6b63\u3002\u5982\u679c\u4e00\u526f\u56fe\u7247\u6709\u4efb\u4f55\u90e8\u5206\u51fa\u73b0\u5728\u9875\u9762\u4e4b\u5916\uff0c\u5219\u5e76\u4e0d\u4f1a\u88ab rawdict \u7edf\u8ba1\u3002\u6240\u4ee5\u9700\u8981\u5728\u4e0a\u9762\u5904\u7406\u903b\u8f91\u4e2d\u518d\u52a0\u4e00\u6b65\uff1a (3) \u5982\u679c getImageList \u67d0\u4e00\u56fe\u7247\u7684\u4f4d\u7f6e bbox \u4e0d\u51fa\u73b0\u5728\u4efb\u4f55 rawdict \u5206\u7ec4\u4e2d\uff0c\u5219\u52a0\u5165\u8be5\u56fe\u7247","title":"3. rawdict\u4ec5\u5305\u542b\u5b8c\u5168\u663e\u793a\u5728\u9875\u9762\u5185\u7684\u56fe\u7247"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#4 rawdict","text":"\u4e0a\u4e00\u6b65\u8865\u6551\u4e86 getImageList \u542b\u6709 rawdict \u4e2d\u4e0d\u5b58\u5728\u7684\u56fe\u7247\u7684\u60c5\u5f62\uff1b\u76f8\u53cd\uff0c rawdict \u4e5f\u53ef\u80fd\u542b\u6709 getImageList \u4e2d\u4e0d\u5b58\u5728\u7684\u56fe\u7247\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e9b\u662f\u201c\u865a\u5047\u201d\u56fe\u7247\u2014\u2014\u56e0\u4e3a getImageList \u7edf\u8ba1\u4e86\u6240\u6709\u5df2\u663e\u793a\u6216\u8005\u672a\u663e\u793a\u7684\u56fe\u7247\u3002\u672c\u6587\u9047\u5230\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u67d0\u4e9b\u590d\u6742\u7684\u77e2\u91cf\u56fe\u5f62\u88ab\u9519\u8bef\u5730\u8f6c\u6362\u4e3a\u56fe\u7247\u800c\u8ba1\u7b97\u5230 rawdict \u4e2d\u53bb\u4e86\u3002 \u6b64\u65f6\uff0c\u518d\u8ffd\u52a0\u4e00\u6b65\uff1a (4) \u5982\u679c getImageList \u6240\u6709\u56fe\u7247\u7684\u4f4d\u7f6e bbox \u90fd\u4e0d\u51fa\u73b0\u5728\u67d0\u4e00 rawdict \u5206\u7ec4\uff0c\u5219\u5220\u9664\u8be5\u5206\u7ec4","title":"4. rawdict\u53ef\u80fd\u5305\u542b\u201c\u865a\u5047\u201d\u56fe\u7247"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#5 pdf","text":"\u81ea\u521d\u7a3f\u4ee5\u6765\uff0c\u5b9e\u8df5\u4e2d\u53c8\u53d1\u73b0\u901a\u5e38\u51fa\u73b0\u5728PDF\u626b\u63cf\u4ef6\u4e2d\u7684\u4e24\u7c7b\u4f8b\u5916\uff1a \u4eba\u773c\u53ef\u89c1\u7684\u4e00\u5f20\u5b8c\u6574\u56fe\u7247\u5728PDF\u4e2d\u5374\u662f\u7531\u8bb8\u591a\u5f20\u5b50\u56fe\u7ec4\u6210\u7684\uff0c\u867d\u7136\u76f4\u63a5\u63d0\u53d6\u591a\u5e45\u5b50\u56fe\u903b\u8f91\u4e0a\u6ca1\u9519\uff0c\u4f46\u662f\u901a\u8fc7\u76f8\u4ea4\u68c0\u6d4b\u5e76\u5c06\u5176\u5408\u5e76\u4e3a\u4e00\u5f20\u56fe\u7247\u8f93\u51fa\uff0c\u53ef\u4ee5\u5f97\u5230\u8ddf\u6240\u89c1\u66f4\u4e3a\u76f8\u7b26\u7684\u7ed3\u679c\u3002 \u5f53\u539f\u59cbPDF\u5750\u6807\u7cfb\u4e0e\u6e32\u67d3\u540e\u9875\u9762\u4e4b\u95f4\u5b58\u5728\u975e\u96f6\u7684\u65cb\u8f6c\u89d2\u5ea6\u65f6\uff0c\u4eba\u773c\u53ef\u89c1\u7684\u6b63\u7acb\u56fe\u7247\u5b9e\u9645\u662f\u4ee5\u4e00\u5b9a\u65cb\u8f6c\u89d2\u5ea6\u5b58\u50a8\u5728PDF\u4e2d\u7684\uff0c\u56e0\u6b64\u76f4\u63a5\u63d0\u53d6\u7684\u56fe\u7247\u662f\u65cb\u8f6c\u7684\uff0c\u9700\u8981\u501f\u52a9\u56fe\u50cf\u5904\u7406\u5e93\u9006\u5411\u65cb\u8f6c\u56de\u53bb\u624d\u80fd\u5f97\u5230\u548c\u6240\u89c1\u4e00\u81f4\u7684\u56fe\u7247\u3002","title":"5. PDF\u626b\u63cf\u56fe\u7247\u7684\u4e00\u4e9b\u4f8b\u5916"},{"location":"2020-10-15-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E5%8F%8A%E5%85%B6%E4%BD%8D%E7%BD%AE/#_1","text":"getImageList \u6216 rawdict \u5f97\u5230\u56fe\u7247\u7684\u5185\u5bb9\u53ef\u80fd\u4e0d\u6b63\u786e\uff0c\u9700\u8981\u8fdb\u884c\u4fee\u590d\u6216\u622a\u56fe\u5904\u7406 getImageList \u83b7\u53d6\u7684\u56fe\u7247\uff08\u663e\u793a/\u672a\u663e\u793a\uff09\u624d\u7b97\u771f\u6b63\u7684\u56fe\u7247 rawdict \u83b7\u53d6\u91cd\u590d\u56fe\u7247\u7684\u6bcf\u4e00\u4e2a\u4f4d\u7f6e \u6ce8\u610f \u56fe\u7247\u5206\u5272 \u53ca \u9875\u9762\u65cb\u8f6c \u5f15\u8d77\u76f4\u63a5\u63d0\u53d6\u7684\u56fe\u7247\u548c\u6700\u7ec8\u6e32\u67d3\u7ed3\u679c\u4e4b\u95f4\u7684\u5dee\u5f02","title":"\u603b\u7ed3"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247 \u00b6 \u53d1\u5e03\u4e8e\uff1a2020-10-25 | \u5206\u7c7b\uff1a process automation python-docx \u5e93\u652f\u6301\u4ee5\u5185\u8054\u5f62\u72b6\uff08Inline Shape\uff09\u7684\u5f62\u5f0f\u63d2\u5165\u56fe\u7247\uff0c\u5373\u56fe\u7247\u548c\u6587\u672c\u4e4b\u95f4\u6ca1\u6709\u91cd\u53e0\uff0c\u9075\u5faa\u6240\u8c13\u7684\u6d41\u52a8\u7248\u5f0f\uff08flow layout\uff09\u3002\u622a\u81f3\u6700\u65b0\u7684 0.8.10 \u7248\u672c\uff0c python-docx \u5c1a\u4e0d\u652f\u6301\u63d2\u5165\u6d6e\u52a8\u56fe\u7247\uff08floating picture\uff09\u3002\u8fd9\u663e\u7136\u4e0d\u80fd\u6ee1\u8db3\u4e30\u5bcc\u591a\u5f69\u7684\u6587\u6863\u6837\u5f0f\u7684\u9700\u8981\uff0c\u56e0\u6b64\u672c\u6587\u63a2\u7a76\u57fa\u4e8e python-docx \u63d2\u5165\u6d6e\u52a8\u56fe\u7247\u7684\u65b9\u6cd5\u3002 https://github.com/python-openxml/python-docx/issues/159 https://github.com/python-openxml/python-docx/issues/400 \u95ee\u9898\u63d0\u51fa \u00b6 \u5728\u63d0\u53d6PDF\u9875\u9762\u5143\u7d20\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5df2\u77e5\u80cc\u666f\u56fe\u7247\u7684\u5177\u4f53\u4f4d\u7f6e\uff08\u4f8b\u5982\u5de6\u4e0a\u89d2\u70b9\u5750\u6807\u548c\u56fe\u7247\u533a\u57df\u7684\u957f\u5bbd\uff09\uff0c\u73b0\u5728\u9700\u8981\u5c06\u5176\u91cd\u73b0\u5728docx\u9875\u9762\u76f8\u5e94\u7684\u4f4d\u7f6e\u3002\u8003\u8651\u5230\u53ef\u80fd\u4e0e\u6587\u672c\u533a\u57df\u91cd\u53e0\uff0c\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u7cbe\u786e\u5b9a\u4f4d\u7684\u6d6e\u52a8\u56fe\u7247\u3002 MS Word\u4e2d\u7684\u8bbe\u7f6e \u00b6 \u6211\u4eec\u5148\u5c1d\u8bd5\u5728Office Word\u4e2d\uff0c\u624b\u52a8\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u6709\u4e00\u70b9Word\u4f7f\u7528\u7ecf\u9a8c\u5373\u53ef\u77e5\uff0c\u901a\u8fc7\u8bbe\u7f6e \u56fe\u7247\u7248\u5f0f \u6765\u63a7\u5236\u56fe\u7247\u7684\u6d6e\u52a8\u548c\u5177\u4f53\u4f4d\u7f6e\u3002\u4e0b\u56fe\u7248\u5f0f\u8bbe\u7f6e\u4e2d\u7684\u6587\u672c\u73af\u7ed5\u6837\u5f0f\uff0c\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a\u4e09\u7c7b\uff1a \u5206\u7c7b \u6587\u672c\u91cd\u53e0 \u81ea\u7531\u5b9a\u4f4d \u6837\u5f0f\u540d\u79f0 \u5d4c\u5165\u578b \u5426 \u5426 In line with text \u73af\u7ed5\u578b \u5426 \u662f Square, Tight, Through, Top and bottom \u5b8c\u5168\u6d6e\u52a8 \u662f \u662f behind text, In front of text \u4f8b\u5982\u6700\u5e38\u89c1\u7684\u5d4c\u5165\u578b\u56fe\u7247\uff0c\u5b83\u5360\u636e\u4e86\u6574\u884c\u533a\u57df\uff0c\u6211\u4eec\u65e2\u4e0d\u80fd\u5c06\u5176\u4e0e\u6587\u5b57\u91cd\u53e0\uff0c\u4e5f\u4e0d\u80fd\u81ea\u7531\u653e\u7f6e\u5b83\u7684\u4f4d\u7f6e\uff0c\u800c\u662f\u7531\u9875\u9762\u6392\u7248\u81ea\u52a8\u786e\u5b9a\u3002\u5bf9\u4e8e\u73af\u7ed5\u578b\u56fe\u7247\uff0c\u6587\u672c\u53ef\u4ee5\u8fdb\u5165\u56fe\u7247\u6240\u5728\u884c\uff0c\u4f46\u662f\u65e0\u6cd5\u4e0e\u4e4b\u91cd\u53e0\uff1b\u5e76\u4e14\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u9f20\u6807\u81ea\u7531\u62d6\u52a8\u5176\u4f4d\u7f6e\u3002\u5b8c\u5168\u6d6e\u52a8\u578b\u56fe\u7247\u5219\u53ef\u4ee5\u6d6e\u4e8e\u6587\u672c\u4e0a\u65b9\u6216\u8005\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\uff0c\u540c\u65f6\u652f\u6301\u968f\u610f\u653e\u7f6e\u5176\u4f4d\u7f6e\u3002 \u5982\u679c\u9700\u8981\u7cbe\u786e\u5b9a\u4f4d\uff0c\u5219\u53ef\u5728\u56fe\u7247\u7248\u5f0f\u7684\u4f4d\u7f6e\uff08Position\uff09\u9009\u9879\u5361\u8fdb\u884c\u8bbe\u7f6e\u3002\u5b83\u63d0\u4f9b\u4e86\u591a\u79cd\u5b9a\u4f4d\u65b9\u5f0f\uff0c\u4f8b\u5982 \u7edd\u5bf9\u5b9a\u4f4d \u2014\u2014\u6839\u636e\u56fe\u7247\u5de6\u4e0a\u89d2\u70b9\u8ddd\u79bb\u6c34\u5e73\u548c\u7ad6\u76f4\u53c2\u8003\u7684\u5750\u6807\u503c\u6765\u5b9a\u4f4d\u3002\u81f3\u4e8e\u53c2\u8003\u5bf9\u8c61\uff0c\u53ef\u4ee5\u662f\u9875\u9762\uff08Page\uff09\u672c\u8eab\uff0c\u8fd9\u6837 (0, 0) \u5c31\u662f\u9875\u9762\u5de6\u4e0a\u89d2\uff1b\u4e5f\u53ef\u4ee5\u662f\u8fb9\u8ddd\uff08Margin\uff09\uff0c\u6b64\u65f6 (0, 0) \u5373\u4e3a\u6b63\u6587\u533a\u57df\u7684\u5de6\u4e0a\u89d2\u70b9\u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u7cbe\u786e\u5b9a\u4f4d\u7684 \u886c\u4e8e\u6587\u672c\u4e0b\u65b9 \u7684\u56fe\u7247\u7248\u5f0f\u3002 docx\u80cc\u540e\u7684xml \u00b6 \u6211\u4eec\u8fd8\u77e5\u9053\uff0cdocx\u6587\u6863\u7684\u80cc\u540e\u662fxml\u683c\u5f0f\u7684\u6570\u636e\uff0c python-docx \u6b63\u662f\u901a\u8fc7\u5904\u7406xml\u7684\u65b9\u5f0f\u6765\u8bfb\u5199word\u6587\u6863\u7684\u3002\u6240\u4ee5\uff0c\u63a5\u4e0b\u6765\u5148\u624b\u5de5\u521b\u5efaword\u6587\u6863\uff0c\u7136\u540e\u67e5\u770b\u56fe\u7247\u90e8\u5206\u7684xml\u5185\u5bb9\u3002 \u4f5c\u4e3a\u5bf9\u6bd4\uff0c\u9996\u5148\u5206\u522b\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u5d4c\u5165\u578b\u56fe\u7247\u6587\u4ef6\u548c\u4e00\u4e2a\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\u7684\u6d6e\u52a8\u578b\u56fe\u7247\u6587\u4ef6\u3002\u7136\u540e\u6267\u884c\u67e5\u770b\u6b65\u9aa4\uff1a\u53f3\u952edocx\u6587\u4ef6 | 7-zip\u6253\u5f00\u538b\u7f29\u5305 | word | document.xml\uff0c\u590d\u5236\u6587\u4ef6\u5185\u5bb9\u5e76\u683c\u5f0f\u5316xml\uff0c\u5f97\u5230\u5982\u4e0b\u7684\u5173\u4e8e\u56fe\u7247\u90e8\u5206\u7684\u7247\u6bb5\u3002\u4e3a\u4e86\u4fbf\u4e8e\u5bf9\u6bd4\u5206\u6790\uff0c\u5220\u9664\u4e86\u4e00\u4e9b\u8282\u70b9\u5c5e\u6027\u3002 \u5185\u8054\u56fe\u7247\u7247\u6bb5\uff1a <w:drawing> <wp:inline> <wp:extent cx=\"3297600\" cy=\"2782800\"/> <wp:effectExtent l=\"0\" t=\"0\" r=\"0\" b=\"0\"/> <wp:docPr id=\"1\" name=\"Picture 1\"/> <wp:cNvGraphicFramePr> <a:graphicFrameLocks/> </wp:cNvGraphicFramePr> <a:graphic> <a:graphicData> <pic:pic> <!-- more pic content --> </pic:pic> </a:graphicData> </a:graphic> </wp:inline> </w:drawing> \u6d6e\u52a8\u56fe\u7247\u7247\u6bb5\uff1a <w:drawing> <wp:anchor behindDoc=\"1\" locked=\"0\" layoutInCell=\"1\" allowOverlap=\"1\"> <wp:simplePos x=\"0\" y=\"0\"/> <wp:positionH relativeFrom=\"page\"> <wp:posOffset>285750</wp:posOffset> </wp:positionH> <wp:positionV relativeFrom=\"page\"> <wp:posOffset>457200</wp:posOffset> </wp:positionV> <wp:extent cx=\"3297600\" cy=\"2782800\"/> <wp:effectExtent l=\"0\" t=\"0\" r=\"0\" b=\"0\"/> <wp:wrapNone/> <wp:docPr id=\"1\" name=\"Picture 1\"/> <wp:cNvGraphicFramePr> <a:graphicFrameLocks/> </wp:cNvGraphicFramePr> <a:graphic> <a:graphicData> <pic:pic> <!-- more pic content --> </pic:pic> </a:graphicData> </a:graphic> </wp:anchor> </w:drawing> \u5bf9\u6bd4\u53d1\u73b0\u4ee5\u4e0b\u76f8\u540c/\u76f8\u4f3c\u70b9\uff1a \u4e24\u7c7b\u56fe\u7247\u90fd\u653e\u5728 <w:drawing> \u8282\u70b9\u4e0b\uff0c\u53ea\u4e0d\u8fc7\u5185\u8054\u56fe\u7247 <wp:inline> \uff0c\u6d6e\u52a8\u56fe\u7247 <wp:anchor> \u3002 \u76f8\u540c\u7684\u5185\u5bb9\u8282\u70b9 <wp:extent> \u3001 <wp:docPr> \u3001 <a:graphic> \u7b49\u3002 \u9664\u6b64\u4e4b\u5916\uff0c\u6d6e\u52a8\u56fe\u7247\u8fd8\u6709\u4e00\u4e9b\u72ec\u6709\u7279\u5f81\uff0c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u4ece\u547d\u540d\u4e0a\u731c\u6d4b\u548c\u89e3\u8bfb\uff1a <wp:anchor> \u8282\u70b9\u7684 behindDoc \u5c5e\u6027\u8868\u660e\u56fe\u7247\u7248\u5f0f\u4e3a\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\u3002 <wp:positionH> \u548c <wp:positionV> \u8282\u70b9\u8868\u660e\u6c34\u5e73\u548c\u7ad6\u76f4\u7edd\u5bf9\u5b9a\u4f4d\u65b9\u5f0f\uff0c relativeFrom \u5c5e\u6027\u6307\u5b9a\u7528\u4e8e\u5b9a\u4f4d\u7684\u53c2\u8003\u5bf9\u8c61\uff0c\u5b50\u8282\u70b9 <wp:posOffset> \u6307\u5b9a\u5177\u4f53\u5750\u6807\u503c\u3002 \u4ece\u5185\u8054\u56fe\u7247\u5f00\u59cb \u00b6 \u4ecexml\u7684\u7ed3\u6784\u5bf9\u6bd4\u6765\u770b\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u6839\u636e python-docx \u5bf9\u5185\u8054\u56fe\u7247\u7684\u5b9e\u73b0\u6765\u63d2\u5165\u6d6e\u52a8\u56fe\u7247\u3002\u4e8e\u662f\uff0c\u4ece\u63d2\u5165\u5185\u8054\u56fe\u7247\u7684\u4ee3\u7801\u5165\u624b\uff1a from docx import Document from docx.shared import Pt document = Document() document.add_picture('image.jpg', width=Pt(200)) document.save('output.docx') \u4ece python-docx \u5b89\u88c5\u6587\u4ef6\u5939 site-packages/docx \u8fdb\u884c\u5185\u5bb9\u641c\u7d22 add_picture \uff0c\u5f97\u5230 docx.text.run.add_picture \u539f\u59cb\u5b9a\u4e49\u5904\uff1a def add_picture(self, image_path_or_stream, width=None, height=None): inline = self.part.new_pic_inline(image_path_or_stream, width, height) self._r.add_drawing(inline) return InlineShape(inline) \u7ee7\u7eed\u641c\u7d22 new_pic_inline \u5f97\u5230 docx.parts.story.BaseStoryPart.new_pic_inline \u3002\u4ece\u6ce8\u91ca\u53ef\u77e5\u8fd9\u662f\u5229\u7528 CT_Inline \u7c7b\u521b\u5efa <wp:inline> \u5143\u7d20\uff0c\u540e\u7eed\u521b\u5efa\u6d6e\u52a8\u56fe\u7247\u7684 <wp:anchor> \u5c06\u5728\u6b64\u57fa\u7840\u4e0a\u4fee\u6539\u3002 def new_pic_inline(self, image_descriptor, width, height): \"\"\"Return a newly-created `w:inline` element. The element contains the image specified by *image_descriptor* and is scaled based on the values of *width* and *height*. \"\"\" rId, image = self.get_or_add_image(image_descriptor) cx, cy = image.scaled_dimensions(width, height) shape_id, filename = self.next_id, image.filename return CT_Inline.new_pic_inline(shape_id, rId, filename, cx, cy) \u4e8e\u662f\u8fdb\u5165 CT_Inline \u7c7b\uff08\u9650\u4e8e\u7bc7\u5e45\uff0c\u5220\u9664\u4e86\u524d\u4e24\u4e2a\u7c7b\u65b9\u6cd5\u7684\u5177\u4f53\u4ee3\u7801\uff09\u2014\u2014\u7ec8\u4e8e\u89c1\u5230\u4e86\u4e00\u5f00\u59cb\u63a2\u7d22\u7684xml\u4ee3\u7801\uff0c\u7b80\u5355\u626b\u4e00\u4e0b\u4e09\u4e2a\u7c7b\u65b9\u6cd5\uff0c\u5373\u53ef\u5c06\u5b83\u4eec\u8054\u7cfb\u4e0a\uff1a _inline_xml() \u65b9\u6cd5\u7ed9\u51fa\u5185\u8054\u56fe\u7247 <wp:inline> \u7684xml\u7ed3\u6784\u3002 new() \u65b9\u6cd5\u8c03\u7528 _inline_xml() \uff0c\u5e76\u4e3a\u5176\u4e2d\u7684\u5b50\u8282\u70b9\u4f8b\u5982 <wp:extent> \u548c <wp:docPr> \u8d4b\u503c\u3002 new_pic_inline() \u8c03\u7528 new() \uff0c\u540c\u65f6\u62fc\u63a5 CT_Picture \u7c7b\u7684\u7ed3\u679c\uff08 <pic:pic> \uff0c\u56fe\u7247\u7684\u5177\u4f53\u5185\u5bb9\uff09\u5230 <a:graphicData> \u8282\u70b9\u4e2d\u53bb\u3002 \u7efc\u4e0a\uff0c\u5b9e\u73b0\u4e86\u5185\u8054\u56fe\u7247\u7684\u5b8c\u6574xml\u7ed3\u6784\u3002 class CT_Inline(BaseOxmlElement): \"\"\" ``<w:inline>`` element, container for an inline shape. \"\"\" @classmethod def new(cls, cx, cy, shape_id, pic): pass @classmethod def new_pic_inline(cls, shape_id, rId, filename, cx, cy): pass @classmethod def _inline_xml(cls): return ( '<wp:inline %s>\\n' ' <wp:extent cx=\"914400\" cy=\"914400\"/>\\n' ' <wp:docPr id=\"666\" name=\"unnamed\"/>\\n' ' <wp:cNvGraphicFramePr>\\n' ' <a:graphicFrameLocks noChangeAspect=\"1\"/>\\n' ' </wp:cNvGraphicFramePr>\\n' ' <a:graphic>\\n' ' <a:graphicData uri=\"URI not set\"/>\\n' ' </a:graphic>\\n' '</wp:inline>' % nsdecls('wp', 'a', 'pic', 'r') ) \u63d2\u5165\u6d6e\u52a8\u56fe\u7247 \u00b6 \u4ecexml\u7ed3\u6784\u7684\u5bf9\u6bd4\u53ca\u4e0a\u8ff0 python-docx \u5bf9\u5185\u8054\u56fe\u7247\u7684\u5b9e\u73b0\uff0c\u5f97\u5230\u521b\u5efa\u6d6e\u52a8\u56fe\u7247\u7684\u601d\u8def\uff1a \u521d\u59cb\u5316 <wp:anchor> \u7ed3\u6784\uff0c\u4f8b\u5982 behindDoc=\"1\" \u6307\u5b9a\u56fe\u7247\u7248\u5f0f\u4e3a\u886c\u4e8e\u6587\u672c\u4e0b\u65b9 \u4f7f\u7528\u7c7b\u4f3c\u7684\u4ee3\u7801\u586b\u5145 <wp:anchor> \u5143\u7d20\uff0c\u5c24\u5176\u662f <wp:extent> \u3001 <wp:docPr> \u548c <pic:pic> \u586b\u5145 <wp:positionH> \u548c <wp:positionV> \u7cbe\u786e\u5b9a\u4f4d\u56fe\u7247 \u5177\u4f53\u5b9e\u8df5\u4e2d\u53d1\u73b0\u8fd8\u6709\u5173\u952e\u7684\u4e00\u6b65\uff0c\u6ce8\u518cxml\u6807\u7b7e\u540d\u79f0\u4e0e\u5bf9\u5e94\u7684\u7c7b\uff0c\u4f8b\u5982 <wp:inline> \u548c CT_Inline # docx.oxml.__init__.py register_element_cls('wp:inline', CT_Inline) \u6700\u540e\uff0c\u5229\u7528 python-docx \u63d2\u5165\u6d6e\u52a8\u56fe\u7247\uff08\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\u3001\u9875\u9762\u5b9a\u4f4d\uff09\u7684\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a # -*- coding: utf-8 -*- ''' Implement floating image based on python-docx. - Text wrapping style: BEHIND TEXT <wp:anchor behindDoc=\"1\"> - Picture position: top-left corner of PAGE `<wp:positionH relativeFrom=\"page\">`. Create a docx sample (Layout | Positions | More Layout Options) and explore the source xml (Open as a zip | word | document.xml) to implement other text wrapping styles and position modes per `CT_Anchor._anchor_xml()`. ''' from docx.oxml import parse_xml, register_element_cls from docx.oxml.ns import nsdecls from docx.oxml.shape import CT_Picture from docx.oxml.xmlchemy import BaseOxmlElement, OneAndOnlyOne # refer to docx.oxml.shape.CT_Inline class CT_Anchor(BaseOxmlElement): \"\"\" ``<w:anchor>`` element, container for a floating image. \"\"\" extent = OneAndOnlyOne('wp:extent') docPr = OneAndOnlyOne('wp:docPr') graphic = OneAndOnlyOne('a:graphic') @classmethod def new(cls, cx, cy, shape_id, pic, pos_x, pos_y): \"\"\" Return a new ``<wp:anchor>`` element populated with the values passed as parameters. \"\"\" anchor = parse_xml(cls._anchor_xml(pos_x, pos_y)) anchor.extent.cx = cx anchor.extent.cy = cy anchor.docPr.id = shape_id anchor.docPr.name = 'Picture %d' % shape_id anchor.graphic.graphicData.uri = ( 'http://schemas.openxmlformats.org/drawingml/2006/picture' ) anchor.graphic.graphicData._insert_pic(pic) return anchor @classmethod def new_pic_anchor(cls, shape_id, rId, filename, cx, cy, pos_x, pos_y): \"\"\" Return a new `wp:anchor` element containing the `pic:pic` element specified by the argument values. \"\"\" pic_id = 0 # Word doesn't seem to use this, but does not omit it pic = CT_Picture.new(pic_id, filename, rId, cx, cy) anchor = cls.new(cx, cy, shape_id, pic, pos_x, pos_y) anchor.graphic.graphicData._insert_pic(pic) return anchor @classmethod def _anchor_xml(cls, pos_x, pos_y): return ( '<wp:anchor distT=\"0\" distB=\"0\" distL=\"0\" distR=\"0\" simplePos=\"0\" relativeHeight=\"0\" \\n' ' behindDoc=\"1\" locked=\"0\" layoutInCell=\"1\" allowOverlap=\"1\" \\n' ' %s>\\n' ' <wp:simplePos x=\"0\" y=\"0\"/>\\n' ' <wp:positionH relativeFrom=\"page\">\\n' ' <wp:posOffset>%d</wp:posOffset>\\n' ' </wp:positionH>\\n' ' <wp:positionV relativeFrom=\"page\">\\n' ' <wp:posOffset>%d</wp:posOffset>\\n' ' </wp:positionV>\\n' ' <wp:extent cx=\"914400\" cy=\"914400\"/>\\n' ' <wp:wrapNone/>\\n' ' <wp:docPr id=\"666\" name=\"unnamed\"/>\\n' ' <wp:cNvGraphicFramePr>\\n' ' <a:graphicFrameLocks noChangeAspect=\"1\"/>\\n' ' </wp:cNvGraphicFramePr>\\n' ' <a:graphic>\\n' ' <a:graphicData uri=\"URI not set\"/>\\n' ' </a:graphic>\\n' '</wp:anchor>' % ( nsdecls('wp', 'a', 'pic', 'r'), int(pos_x), int(pos_y) ) ) # refer to docx.parts.story.BaseStoryPart.new_pic_inline def new_pic_anchor(part, image_descriptor, width, height, pos_x, pos_y): \"\"\"Return a newly-created `w:anchor` element. The element contains the image specified by *image_descriptor* and is scaled based on the values of *width* and *height*. \"\"\" rId, image = part.get_or_add_image(image_descriptor) cx, cy = image.scaled_dimensions(width, height) shape_id, filename = part.next_id, image.filename return CT_Anchor.new_pic_anchor(shape_id, rId, filename, cx, cy, pos_x, pos_y) # refer to docx.text.run.add_picture def add_float_picture(p, image_path_or_stream, width=None, height=None, pos_x=0, pos_y=0): \"\"\"Add float picture at fixed position `pos_x` and `pos_y` to the top-left point of page. \"\"\" run = p.add_run() anchor = new_pic_anchor(run.part, image_path_or_stream, width, height, pos_x, pos_y) run._r.add_drawing(anchor) # refer to docx.oxml.__init__.py register_element_cls('wp:anchor', CT_Anchor) if __name__ == '__main__': from docx import Document from docx.shared import Inches, Pt document = Document() # add a floating image p = document.add_paragraph() add_float_picture(p, 'test.png', width=Inches(5.0), pos_x=Pt(20), pos_y=Pt(30)) # add text p.add_run('Hello World'*50) document.save('output.docx')","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2020-10-25 | \u5206\u7c7b\uff1a process automation python-docx \u5e93\u652f\u6301\u4ee5\u5185\u8054\u5f62\u72b6\uff08Inline Shape\uff09\u7684\u5f62\u5f0f\u63d2\u5165\u56fe\u7247\uff0c\u5373\u56fe\u7247\u548c\u6587\u672c\u4e4b\u95f4\u6ca1\u6709\u91cd\u53e0\uff0c\u9075\u5faa\u6240\u8c13\u7684\u6d41\u52a8\u7248\u5f0f\uff08flow layout\uff09\u3002\u622a\u81f3\u6700\u65b0\u7684 0.8.10 \u7248\u672c\uff0c python-docx \u5c1a\u4e0d\u652f\u6301\u63d2\u5165\u6d6e\u52a8\u56fe\u7247\uff08floating picture\uff09\u3002\u8fd9\u663e\u7136\u4e0d\u80fd\u6ee1\u8db3\u4e30\u5bcc\u591a\u5f69\u7684\u6587\u6863\u6837\u5f0f\u7684\u9700\u8981\uff0c\u56e0\u6b64\u672c\u6587\u63a2\u7a76\u57fa\u4e8e python-docx \u63d2\u5165\u6d6e\u52a8\u56fe\u7247\u7684\u65b9\u6cd5\u3002 https://github.com/python-openxml/python-docx/issues/159 https://github.com/python-openxml/python-docx/issues/400","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/#_1","text":"\u5728\u63d0\u53d6PDF\u9875\u9762\u5143\u7d20\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5df2\u77e5\u80cc\u666f\u56fe\u7247\u7684\u5177\u4f53\u4f4d\u7f6e\uff08\u4f8b\u5982\u5de6\u4e0a\u89d2\u70b9\u5750\u6807\u548c\u56fe\u7247\u533a\u57df\u7684\u957f\u5bbd\uff09\uff0c\u73b0\u5728\u9700\u8981\u5c06\u5176\u91cd\u73b0\u5728docx\u9875\u9762\u76f8\u5e94\u7684\u4f4d\u7f6e\u3002\u8003\u8651\u5230\u53ef\u80fd\u4e0e\u6587\u672c\u533a\u57df\u91cd\u53e0\uff0c\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u7cbe\u786e\u5b9a\u4f4d\u7684\u6d6e\u52a8\u56fe\u7247\u3002","title":"\u95ee\u9898\u63d0\u51fa"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/#ms word","text":"\u6211\u4eec\u5148\u5c1d\u8bd5\u5728Office Word\u4e2d\uff0c\u624b\u52a8\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u6709\u4e00\u70b9Word\u4f7f\u7528\u7ecf\u9a8c\u5373\u53ef\u77e5\uff0c\u901a\u8fc7\u8bbe\u7f6e \u56fe\u7247\u7248\u5f0f \u6765\u63a7\u5236\u56fe\u7247\u7684\u6d6e\u52a8\u548c\u5177\u4f53\u4f4d\u7f6e\u3002\u4e0b\u56fe\u7248\u5f0f\u8bbe\u7f6e\u4e2d\u7684\u6587\u672c\u73af\u7ed5\u6837\u5f0f\uff0c\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a\u4e09\u7c7b\uff1a \u5206\u7c7b \u6587\u672c\u91cd\u53e0 \u81ea\u7531\u5b9a\u4f4d \u6837\u5f0f\u540d\u79f0 \u5d4c\u5165\u578b \u5426 \u5426 In line with text \u73af\u7ed5\u578b \u5426 \u662f Square, Tight, Through, Top and bottom \u5b8c\u5168\u6d6e\u52a8 \u662f \u662f behind text, In front of text \u4f8b\u5982\u6700\u5e38\u89c1\u7684\u5d4c\u5165\u578b\u56fe\u7247\uff0c\u5b83\u5360\u636e\u4e86\u6574\u884c\u533a\u57df\uff0c\u6211\u4eec\u65e2\u4e0d\u80fd\u5c06\u5176\u4e0e\u6587\u5b57\u91cd\u53e0\uff0c\u4e5f\u4e0d\u80fd\u81ea\u7531\u653e\u7f6e\u5b83\u7684\u4f4d\u7f6e\uff0c\u800c\u662f\u7531\u9875\u9762\u6392\u7248\u81ea\u52a8\u786e\u5b9a\u3002\u5bf9\u4e8e\u73af\u7ed5\u578b\u56fe\u7247\uff0c\u6587\u672c\u53ef\u4ee5\u8fdb\u5165\u56fe\u7247\u6240\u5728\u884c\uff0c\u4f46\u662f\u65e0\u6cd5\u4e0e\u4e4b\u91cd\u53e0\uff1b\u5e76\u4e14\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u9f20\u6807\u81ea\u7531\u62d6\u52a8\u5176\u4f4d\u7f6e\u3002\u5b8c\u5168\u6d6e\u52a8\u578b\u56fe\u7247\u5219\u53ef\u4ee5\u6d6e\u4e8e\u6587\u672c\u4e0a\u65b9\u6216\u8005\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\uff0c\u540c\u65f6\u652f\u6301\u968f\u610f\u653e\u7f6e\u5176\u4f4d\u7f6e\u3002 \u5982\u679c\u9700\u8981\u7cbe\u786e\u5b9a\u4f4d\uff0c\u5219\u53ef\u5728\u56fe\u7247\u7248\u5f0f\u7684\u4f4d\u7f6e\uff08Position\uff09\u9009\u9879\u5361\u8fdb\u884c\u8bbe\u7f6e\u3002\u5b83\u63d0\u4f9b\u4e86\u591a\u79cd\u5b9a\u4f4d\u65b9\u5f0f\uff0c\u4f8b\u5982 \u7edd\u5bf9\u5b9a\u4f4d \u2014\u2014\u6839\u636e\u56fe\u7247\u5de6\u4e0a\u89d2\u70b9\u8ddd\u79bb\u6c34\u5e73\u548c\u7ad6\u76f4\u53c2\u8003\u7684\u5750\u6807\u503c\u6765\u5b9a\u4f4d\u3002\u81f3\u4e8e\u53c2\u8003\u5bf9\u8c61\uff0c\u53ef\u4ee5\u662f\u9875\u9762\uff08Page\uff09\u672c\u8eab\uff0c\u8fd9\u6837 (0, 0) \u5c31\u662f\u9875\u9762\u5de6\u4e0a\u89d2\uff1b\u4e5f\u53ef\u4ee5\u662f\u8fb9\u8ddd\uff08Margin\uff09\uff0c\u6b64\u65f6 (0, 0) \u5373\u4e3a\u6b63\u6587\u533a\u57df\u7684\u5de6\u4e0a\u89d2\u70b9\u3002 \u7efc\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u7cbe\u786e\u5b9a\u4f4d\u7684 \u886c\u4e8e\u6587\u672c\u4e0b\u65b9 \u7684\u56fe\u7247\u7248\u5f0f\u3002","title":"MS Word\u4e2d\u7684\u8bbe\u7f6e"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/#docxxml","text":"\u6211\u4eec\u8fd8\u77e5\u9053\uff0cdocx\u6587\u6863\u7684\u80cc\u540e\u662fxml\u683c\u5f0f\u7684\u6570\u636e\uff0c python-docx \u6b63\u662f\u901a\u8fc7\u5904\u7406xml\u7684\u65b9\u5f0f\u6765\u8bfb\u5199word\u6587\u6863\u7684\u3002\u6240\u4ee5\uff0c\u63a5\u4e0b\u6765\u5148\u624b\u5de5\u521b\u5efaword\u6587\u6863\uff0c\u7136\u540e\u67e5\u770b\u56fe\u7247\u90e8\u5206\u7684xml\u5185\u5bb9\u3002 \u4f5c\u4e3a\u5bf9\u6bd4\uff0c\u9996\u5148\u5206\u522b\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u5d4c\u5165\u578b\u56fe\u7247\u6587\u4ef6\u548c\u4e00\u4e2a\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\u7684\u6d6e\u52a8\u578b\u56fe\u7247\u6587\u4ef6\u3002\u7136\u540e\u6267\u884c\u67e5\u770b\u6b65\u9aa4\uff1a\u53f3\u952edocx\u6587\u4ef6 | 7-zip\u6253\u5f00\u538b\u7f29\u5305 | word | document.xml\uff0c\u590d\u5236\u6587\u4ef6\u5185\u5bb9\u5e76\u683c\u5f0f\u5316xml\uff0c\u5f97\u5230\u5982\u4e0b\u7684\u5173\u4e8e\u56fe\u7247\u90e8\u5206\u7684\u7247\u6bb5\u3002\u4e3a\u4e86\u4fbf\u4e8e\u5bf9\u6bd4\u5206\u6790\uff0c\u5220\u9664\u4e86\u4e00\u4e9b\u8282\u70b9\u5c5e\u6027\u3002 \u5185\u8054\u56fe\u7247\u7247\u6bb5\uff1a <w:drawing> <wp:inline> <wp:extent cx=\"3297600\" cy=\"2782800\"/> <wp:effectExtent l=\"0\" t=\"0\" r=\"0\" b=\"0\"/> <wp:docPr id=\"1\" name=\"Picture 1\"/> <wp:cNvGraphicFramePr> <a:graphicFrameLocks/> </wp:cNvGraphicFramePr> <a:graphic> <a:graphicData> <pic:pic> <!-- more pic content --> </pic:pic> </a:graphicData> </a:graphic> </wp:inline> </w:drawing> \u6d6e\u52a8\u56fe\u7247\u7247\u6bb5\uff1a <w:drawing> <wp:anchor behindDoc=\"1\" locked=\"0\" layoutInCell=\"1\" allowOverlap=\"1\"> <wp:simplePos x=\"0\" y=\"0\"/> <wp:positionH relativeFrom=\"page\"> <wp:posOffset>285750</wp:posOffset> </wp:positionH> <wp:positionV relativeFrom=\"page\"> <wp:posOffset>457200</wp:posOffset> </wp:positionV> <wp:extent cx=\"3297600\" cy=\"2782800\"/> <wp:effectExtent l=\"0\" t=\"0\" r=\"0\" b=\"0\"/> <wp:wrapNone/> <wp:docPr id=\"1\" name=\"Picture 1\"/> <wp:cNvGraphicFramePr> <a:graphicFrameLocks/> </wp:cNvGraphicFramePr> <a:graphic> <a:graphicData> <pic:pic> <!-- more pic content --> </pic:pic> </a:graphicData> </a:graphic> </wp:anchor> </w:drawing> \u5bf9\u6bd4\u53d1\u73b0\u4ee5\u4e0b\u76f8\u540c/\u76f8\u4f3c\u70b9\uff1a \u4e24\u7c7b\u56fe\u7247\u90fd\u653e\u5728 <w:drawing> \u8282\u70b9\u4e0b\uff0c\u53ea\u4e0d\u8fc7\u5185\u8054\u56fe\u7247 <wp:inline> \uff0c\u6d6e\u52a8\u56fe\u7247 <wp:anchor> \u3002 \u76f8\u540c\u7684\u5185\u5bb9\u8282\u70b9 <wp:extent> \u3001 <wp:docPr> \u3001 <a:graphic> \u7b49\u3002 \u9664\u6b64\u4e4b\u5916\uff0c\u6d6e\u52a8\u56fe\u7247\u8fd8\u6709\u4e00\u4e9b\u72ec\u6709\u7279\u5f81\uff0c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u4ece\u547d\u540d\u4e0a\u731c\u6d4b\u548c\u89e3\u8bfb\uff1a <wp:anchor> \u8282\u70b9\u7684 behindDoc \u5c5e\u6027\u8868\u660e\u56fe\u7247\u7248\u5f0f\u4e3a\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\u3002 <wp:positionH> \u548c <wp:positionV> \u8282\u70b9\u8868\u660e\u6c34\u5e73\u548c\u7ad6\u76f4\u7edd\u5bf9\u5b9a\u4f4d\u65b9\u5f0f\uff0c relativeFrom \u5c5e\u6027\u6307\u5b9a\u7528\u4e8e\u5b9a\u4f4d\u7684\u53c2\u8003\u5bf9\u8c61\uff0c\u5b50\u8282\u70b9 <wp:posOffset> \u6307\u5b9a\u5177\u4f53\u5750\u6807\u503c\u3002","title":"docx\u80cc\u540e\u7684xml"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/#_2","text":"\u4ecexml\u7684\u7ed3\u6784\u5bf9\u6bd4\u6765\u770b\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u6839\u636e python-docx \u5bf9\u5185\u8054\u56fe\u7247\u7684\u5b9e\u73b0\u6765\u63d2\u5165\u6d6e\u52a8\u56fe\u7247\u3002\u4e8e\u662f\uff0c\u4ece\u63d2\u5165\u5185\u8054\u56fe\u7247\u7684\u4ee3\u7801\u5165\u624b\uff1a from docx import Document from docx.shared import Pt document = Document() document.add_picture('image.jpg', width=Pt(200)) document.save('output.docx') \u4ece python-docx \u5b89\u88c5\u6587\u4ef6\u5939 site-packages/docx \u8fdb\u884c\u5185\u5bb9\u641c\u7d22 add_picture \uff0c\u5f97\u5230 docx.text.run.add_picture \u539f\u59cb\u5b9a\u4e49\u5904\uff1a def add_picture(self, image_path_or_stream, width=None, height=None): inline = self.part.new_pic_inline(image_path_or_stream, width, height) self._r.add_drawing(inline) return InlineShape(inline) \u7ee7\u7eed\u641c\u7d22 new_pic_inline \u5f97\u5230 docx.parts.story.BaseStoryPart.new_pic_inline \u3002\u4ece\u6ce8\u91ca\u53ef\u77e5\u8fd9\u662f\u5229\u7528 CT_Inline \u7c7b\u521b\u5efa <wp:inline> \u5143\u7d20\uff0c\u540e\u7eed\u521b\u5efa\u6d6e\u52a8\u56fe\u7247\u7684 <wp:anchor> \u5c06\u5728\u6b64\u57fa\u7840\u4e0a\u4fee\u6539\u3002 def new_pic_inline(self, image_descriptor, width, height): \"\"\"Return a newly-created `w:inline` element. The element contains the image specified by *image_descriptor* and is scaled based on the values of *width* and *height*. \"\"\" rId, image = self.get_or_add_image(image_descriptor) cx, cy = image.scaled_dimensions(width, height) shape_id, filename = self.next_id, image.filename return CT_Inline.new_pic_inline(shape_id, rId, filename, cx, cy) \u4e8e\u662f\u8fdb\u5165 CT_Inline \u7c7b\uff08\u9650\u4e8e\u7bc7\u5e45\uff0c\u5220\u9664\u4e86\u524d\u4e24\u4e2a\u7c7b\u65b9\u6cd5\u7684\u5177\u4f53\u4ee3\u7801\uff09\u2014\u2014\u7ec8\u4e8e\u89c1\u5230\u4e86\u4e00\u5f00\u59cb\u63a2\u7d22\u7684xml\u4ee3\u7801\uff0c\u7b80\u5355\u626b\u4e00\u4e0b\u4e09\u4e2a\u7c7b\u65b9\u6cd5\uff0c\u5373\u53ef\u5c06\u5b83\u4eec\u8054\u7cfb\u4e0a\uff1a _inline_xml() \u65b9\u6cd5\u7ed9\u51fa\u5185\u8054\u56fe\u7247 <wp:inline> \u7684xml\u7ed3\u6784\u3002 new() \u65b9\u6cd5\u8c03\u7528 _inline_xml() \uff0c\u5e76\u4e3a\u5176\u4e2d\u7684\u5b50\u8282\u70b9\u4f8b\u5982 <wp:extent> \u548c <wp:docPr> \u8d4b\u503c\u3002 new_pic_inline() \u8c03\u7528 new() \uff0c\u540c\u65f6\u62fc\u63a5 CT_Picture \u7c7b\u7684\u7ed3\u679c\uff08 <pic:pic> \uff0c\u56fe\u7247\u7684\u5177\u4f53\u5185\u5bb9\uff09\u5230 <a:graphicData> \u8282\u70b9\u4e2d\u53bb\u3002 \u7efc\u4e0a\uff0c\u5b9e\u73b0\u4e86\u5185\u8054\u56fe\u7247\u7684\u5b8c\u6574xml\u7ed3\u6784\u3002 class CT_Inline(BaseOxmlElement): \"\"\" ``<w:inline>`` element, container for an inline shape. \"\"\" @classmethod def new(cls, cx, cy, shape_id, pic): pass @classmethod def new_pic_inline(cls, shape_id, rId, filename, cx, cy): pass @classmethod def _inline_xml(cls): return ( '<wp:inline %s>\\n' ' <wp:extent cx=\"914400\" cy=\"914400\"/>\\n' ' <wp:docPr id=\"666\" name=\"unnamed\"/>\\n' ' <wp:cNvGraphicFramePr>\\n' ' <a:graphicFrameLocks noChangeAspect=\"1\"/>\\n' ' </wp:cNvGraphicFramePr>\\n' ' <a:graphic>\\n' ' <a:graphicData uri=\"URI not set\"/>\\n' ' </a:graphic>\\n' '</wp:inline>' % nsdecls('wp', 'a', 'pic', 'r') )","title":"\u4ece\u5185\u8054\u56fe\u7247\u5f00\u59cb"},{"location":"2020-10-25-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%AE%E5%8A%A8%E5%9B%BE%E7%89%87/#_3","text":"\u4ecexml\u7ed3\u6784\u7684\u5bf9\u6bd4\u53ca\u4e0a\u8ff0 python-docx \u5bf9\u5185\u8054\u56fe\u7247\u7684\u5b9e\u73b0\uff0c\u5f97\u5230\u521b\u5efa\u6d6e\u52a8\u56fe\u7247\u7684\u601d\u8def\uff1a \u521d\u59cb\u5316 <wp:anchor> \u7ed3\u6784\uff0c\u4f8b\u5982 behindDoc=\"1\" \u6307\u5b9a\u56fe\u7247\u7248\u5f0f\u4e3a\u886c\u4e8e\u6587\u672c\u4e0b\u65b9 \u4f7f\u7528\u7c7b\u4f3c\u7684\u4ee3\u7801\u586b\u5145 <wp:anchor> \u5143\u7d20\uff0c\u5c24\u5176\u662f <wp:extent> \u3001 <wp:docPr> \u548c <pic:pic> \u586b\u5145 <wp:positionH> \u548c <wp:positionV> \u7cbe\u786e\u5b9a\u4f4d\u56fe\u7247 \u5177\u4f53\u5b9e\u8df5\u4e2d\u53d1\u73b0\u8fd8\u6709\u5173\u952e\u7684\u4e00\u6b65\uff0c\u6ce8\u518cxml\u6807\u7b7e\u540d\u79f0\u4e0e\u5bf9\u5e94\u7684\u7c7b\uff0c\u4f8b\u5982 <wp:inline> \u548c CT_Inline # docx.oxml.__init__.py register_element_cls('wp:inline', CT_Inline) \u6700\u540e\uff0c\u5229\u7528 python-docx \u63d2\u5165\u6d6e\u52a8\u56fe\u7247\uff08\u886c\u4e8e\u6587\u672c\u4e0b\u65b9\u3001\u9875\u9762\u5b9a\u4f4d\uff09\u7684\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a # -*- coding: utf-8 -*- ''' Implement floating image based on python-docx. - Text wrapping style: BEHIND TEXT <wp:anchor behindDoc=\"1\"> - Picture position: top-left corner of PAGE `<wp:positionH relativeFrom=\"page\">`. Create a docx sample (Layout | Positions | More Layout Options) and explore the source xml (Open as a zip | word | document.xml) to implement other text wrapping styles and position modes per `CT_Anchor._anchor_xml()`. ''' from docx.oxml import parse_xml, register_element_cls from docx.oxml.ns import nsdecls from docx.oxml.shape import CT_Picture from docx.oxml.xmlchemy import BaseOxmlElement, OneAndOnlyOne # refer to docx.oxml.shape.CT_Inline class CT_Anchor(BaseOxmlElement): \"\"\" ``<w:anchor>`` element, container for a floating image. \"\"\" extent = OneAndOnlyOne('wp:extent') docPr = OneAndOnlyOne('wp:docPr') graphic = OneAndOnlyOne('a:graphic') @classmethod def new(cls, cx, cy, shape_id, pic, pos_x, pos_y): \"\"\" Return a new ``<wp:anchor>`` element populated with the values passed as parameters. \"\"\" anchor = parse_xml(cls._anchor_xml(pos_x, pos_y)) anchor.extent.cx = cx anchor.extent.cy = cy anchor.docPr.id = shape_id anchor.docPr.name = 'Picture %d' % shape_id anchor.graphic.graphicData.uri = ( 'http://schemas.openxmlformats.org/drawingml/2006/picture' ) anchor.graphic.graphicData._insert_pic(pic) return anchor @classmethod def new_pic_anchor(cls, shape_id, rId, filename, cx, cy, pos_x, pos_y): \"\"\" Return a new `wp:anchor` element containing the `pic:pic` element specified by the argument values. \"\"\" pic_id = 0 # Word doesn't seem to use this, but does not omit it pic = CT_Picture.new(pic_id, filename, rId, cx, cy) anchor = cls.new(cx, cy, shape_id, pic, pos_x, pos_y) anchor.graphic.graphicData._insert_pic(pic) return anchor @classmethod def _anchor_xml(cls, pos_x, pos_y): return ( '<wp:anchor distT=\"0\" distB=\"0\" distL=\"0\" distR=\"0\" simplePos=\"0\" relativeHeight=\"0\" \\n' ' behindDoc=\"1\" locked=\"0\" layoutInCell=\"1\" allowOverlap=\"1\" \\n' ' %s>\\n' ' <wp:simplePos x=\"0\" y=\"0\"/>\\n' ' <wp:positionH relativeFrom=\"page\">\\n' ' <wp:posOffset>%d</wp:posOffset>\\n' ' </wp:positionH>\\n' ' <wp:positionV relativeFrom=\"page\">\\n' ' <wp:posOffset>%d</wp:posOffset>\\n' ' </wp:positionV>\\n' ' <wp:extent cx=\"914400\" cy=\"914400\"/>\\n' ' <wp:wrapNone/>\\n' ' <wp:docPr id=\"666\" name=\"unnamed\"/>\\n' ' <wp:cNvGraphicFramePr>\\n' ' <a:graphicFrameLocks noChangeAspect=\"1\"/>\\n' ' </wp:cNvGraphicFramePr>\\n' ' <a:graphic>\\n' ' <a:graphicData uri=\"URI not set\"/>\\n' ' </a:graphic>\\n' '</wp:anchor>' % ( nsdecls('wp', 'a', 'pic', 'r'), int(pos_x), int(pos_y) ) ) # refer to docx.parts.story.BaseStoryPart.new_pic_inline def new_pic_anchor(part, image_descriptor, width, height, pos_x, pos_y): \"\"\"Return a newly-created `w:anchor` element. The element contains the image specified by *image_descriptor* and is scaled based on the values of *width* and *height*. \"\"\" rId, image = part.get_or_add_image(image_descriptor) cx, cy = image.scaled_dimensions(width, height) shape_id, filename = part.next_id, image.filename return CT_Anchor.new_pic_anchor(shape_id, rId, filename, cx, cy, pos_x, pos_y) # refer to docx.text.run.add_picture def add_float_picture(p, image_path_or_stream, width=None, height=None, pos_x=0, pos_y=0): \"\"\"Add float picture at fixed position `pos_x` and `pos_y` to the top-left point of page. \"\"\" run = p.add_run() anchor = new_pic_anchor(run.part, image_path_or_stream, width, height, pos_x, pos_y) run._r.add_drawing(anchor) # refer to docx.oxml.__init__.py register_element_cls('wp:anchor', CT_Anchor) if __name__ == '__main__': from docx import Document from docx.shared import Inches, Pt document = Document() # add a floating image p = document.add_paragraph() add_float_picture(p, 'test.png', width=Inches(5.0), pos_x=Pt(20), pos_y=Pt(30)) # add text p.add_run('Hello World'*50) document.save('output.docx')","title":"\u63d2\u5165\u6d6e\u52a8\u56fe\u7247"},{"location":"2021-01-02-Python%E5%A4%84%E7%90%86PDF%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AF%B9%E6%AF%94/","text":"Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-01-02 | \u5206\u7c7b\uff1a process automation 2022.06.07\u4fee\u8ba2\uff1a\u65b0\u589e\u7b2c\u4e09\u65b9\u5e93 borb \u3002\u521d\u7a3f\u5199\u4e8e2021.01.02\uff0c\u5f7c\u65f6 borb \u624d\u53d1\u5e031.0\u7248\u6ca1\u51e0\u4e2a\u6708\uff1b\u4e24\u5e74\u4e0d\u5230\uff0cGithub\u4e0a\u5df2\u8fd1\u4e09\u5343\u8d5e\u3002 PDF\uff08Portable Document Format\uff09\u662f\u4e00\u79cd\u4fbf\u643a\u6587\u6863\u683c\u5f0f\uff0c\u4fbf\u4e8e\u8de8\u64cd\u4f5c\u7cfb\u7edf\u4f20\u64ad\u6587\u6863\u3002PDF\u6587\u6863\u9075\u5faa\u6807\u51c6\u683c\u5f0f\uff0c\u56e0\u6b64\u5b58\u5728\u5f88\u591a\u53ef\u4ee5\u64cd\u4f5cPDF\u6587\u6863\u7684\u5de5\u5177\uff0cPython\u81ea\u7136\u4e5f\u4e0d\u4f8b\u5916\u3002\u9762\u591a\u4f17\u591a\u7684Python\u7b2c\u4e09\u65b9\u5e93\uff0c\u672c\u6587\u4ece\u529f\u80fd\u3001\u5f00\u6e90\u534f\u8bae\u53ca\u793e\u533a\u6d3b\u8dc3\u5ea6\u4e09\u65b9\u9762\u52a0\u4ee5\u5bf9\u6bd4\uff0c\u4ee5\u4fbf\u6839\u636e\u5177\u4f53\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u5e93\u3002 \u6982\u51b5 \u00b6 \u529f\u80fd\u5bf9\u6bd4\u4ece\u5927\u7c92\u5ea6\u4e0a\u5206\u6210\u4e86 \u63d0\u53d6\u5185\u5bb9 \u3001 \u64cd\u4f5c\u9875\u9762 \u548c \u521b\u5efa\u5185\u5bb9 \u4e09\u65b9\u9762\u3002\u524d\u4e24\u8005\u5206\u522b\u662f\u9488\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684PDF\u6587\u6863\u7684\u8bfb\u548c\u5199\u64cd\u4f5c\uff0c\u6700\u540e\u4e00\u9879\u4ece\u5185\u5bb9\u4e0a\u521b\u5efa\u65b0\u6587\u6863\u3002\u8003\u8651\u5230\u65f6\u6548\u6027\uff0c\u4ee5\u4e0b\u5bf9\u6bd4\u5217\u51fa\u4e86\u64b0\u6587\u65f6\uff082021.01\uff09\u76f8\u5e94\u7684\u6700\u65b0\u7248\u672c\u3002 \u63d0\u53d6\u5185\u5bb9 \u5982\u6587\u672c\u3001\u56fe\u7247\u3001\u5143\u4fe1\u606f \u64cd\u4f5c\u9875\u9762 \u7279\u6307\u64cd\u4f5c\u5df2\u7ecf\u5b58\u5728\u7684\u9875\u9762\u4f8b\u5982\u5206\u5272\u3001\u5408\u5e76\u3001\u88c1\u526a\u3001\u65cb\u8f6c\u7b49 \u521b\u5efa\u5185\u5bb9 \u6307\u521b\u5efa\u6216\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u4f8b\u5982\u6587\u672c\u3001\u56fe\u7247\u3001\u5f62\u72b6 Python\u5e93 \u5f53\u524d\u7248\u672c Python\u7248\u672c \u5f00\u6e90\u534f\u8bae \u6700\u65b0\u66f4\u65b0 \u529f\u80fd\uff1a\u63d0\u53d6\u5185\u5bb9 \u529f\u80fd\uff1a\u64cd\u4f5c\u9875\u9762 \u529f\u80fd\uff1a\u521b\u5efa\u5185\u5bb9 \u5907\u6ce8 PyPDF2 1.26.0 2.6-3.6 modified BSD 3\u5e74\u524d \u221a \u221a \u00d7 PyPDF2 \u5df2\u4e0d\u518d\u7ef4\u62a4\uff0c\u7ee7\u4efb\u8005 PyPDF4 \uff08 PyPDF \u3001 PyPDF2 \u53ca PyPDF4 \u7684\u6e0a\u6e90\u53c2\u8003 \u6b64\u5904 \uff09\u3002 \u7531\u4e8e PyPDF2 \u4f3c\u4e4e\u66f4\u77e5\u540d\uff0c\u6545\u4ee5\u5176\u4f5c\u4e3a\u6761\u76ee\u5217\u51fa\u3002 pdfrw 0.4 2.6-3.6 MIT 3\u5e74\u524d \u221a \u221a \u00d7 \u81ea\u8eab\u4e0d\u80fd\u521b\u5efa\u65b0\u5185\u5bb9\uff0c\u4f46\u662f\u96c6\u6210\u4e86 ReportLab \uff0c\u53ef\u4ee5\u517c\u5bb9 ReportLab \u751f\u6210\u65b0\u9875\u9762 ReportLab 3.5.58 2.7\uff0c 3.6+ BSD \u975e\u5e38\u6d3b\u8dc3 \u00d7 \u00d7 \u221a ReportLab \u7684\u5f00\u6e90\u7248\u672c\uff0c\u4e13\u4e1a\u521b\u5efaPDF\u5185\u5bb9\u5982\u6587\u672c\u3001\u56fe\u8868\u7b49 pikepdf 2.2.4 2.7\uff0c 3.6+ MPL 2.0 \u975e\u5e38\u6d3b\u8dc3 \u221a \u221a \u00d7 \u57fa\u4e8eC++\u7684 QPDF \uff0c\u5bf9\u6807 PyPDF2 \u548c pdfrw \uff1b\u504f\u5411\u5e95\u5c42 pdfplumber 0.5.25 3.6-3.8 MIT \u6d3b\u8dc3 \u221a \u00d7 \u00d7 \u57fa\u4e8e pdfminer.six \uff1b\u9664\u4e86\u6587\u672c\u3001\u5f62\u72b6\uff08\u77e9\u5f62\u3001\u76f4\u7ebf/\u66f2\u7ebf\uff09\uff0c\u8fd8\u80fd**\u89e3\u6790\u8868\u683c**\u3002 \u51e0\u4e2a\u63d0\u53d6PDF\u8868\u683c\u7684Python\u5e93\u7684\u5bf9\u6bd4\u53c2\u8003 \u6b64\u5904 pdfminer.six 20201018 3.6+ MIT 2\u4e2a\u6708\u524d \u221a \u00d7 \u00d7 pdfminer \u7684\u793e\u533a\u7ef4\u62a4\u7248\uff0c\u56e0\u4e3a pdfminer \u81ea2020\u5e74\u8d77\u4e0d\u518d\u79ef\u6781\u7ef4\u62a4 PyMuPDF 1.18.5 3.6+ GPL V3 \u975e\u5e38\u6d3b\u8dc3 \u221a \u221a \u221a \u57fa\u4e8e mupdf \uff1b\u4ee5\u5904\u7406\u901f\u5ea6\u8457\u79f0\uff0c\u53c2\u8003 \u6b64\u5904 borb 2.0.27 3.6+ AGPL \u975e\u5e38\u6d3b\u8dc3 \u221a \u221a \u221a \u7eafPython\u5e93\uff0c\u652f\u6301\u8bfb\u3001\u5199\u3001\u64cd\u4f5cPDF\u6587\u6863\uff0c\u517c\u987e\u5e95\u5c42\u548c\u9ad8\u7ea7\u5e94\u7528 borb \u4e8e 2022.06 \u65b0\u52a0\u5165\u5bf9\u6bd4\uff0c\u65f6\u95f4\u70b9\u4ee5\u6b64\u4e3a\u51c6\u3002 \u70b9\u8bc4 \u00b6 PyPDF2 \u7cfb\u5217\u3001 pdfrw \u53ca pikepdf \u4e13\u6ce8\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684PDF\u7684\u64cd\u4f5c\uff08\u5206\u5272\u3001\u5408\u5e76\u3001\u65cb\u8f6c\u7b49\uff09\uff0c\u524d\u4e24\u8005\u57fa\u672c\u5904\u4e8e\u505c\u6b62\u7ef4\u62a4\u7684\u72b6\u6001\u3002 pdfplumber \u53ca\u5176\u4f9d\u8d56 pdfminer.six \u4e13\u6ce8PDF\u5185\u5bb9\u63d0\u53d6\uff0c\u4f8b\u5982\u6587\u672c\uff08\u4f4d\u7f6e\u3001\u5b57\u4f53\u53ca\u989c\u8272\u7b49\uff09\u548c\u5f62\u72b6\uff08\u77e9\u5f62\u3001\u76f4\u7ebf\u3001\u66f2\u7ebf\uff09\uff0c\u524d\u8005\u8fd8\u6709\u89e3\u6790\u8868\u683c\u7684\u529f\u80fd\u3002 ReportLab \u4e13\u6ce8PDF\u9875\u9762\u5185\u5bb9\uff08\u6587\u672c\u3001\u56fe\u3001\u8868\u7b49\uff09\u7684\u521b\u5efa\u3002 PyMuPDF \u548c borb \u540c\u65f6\u652f\u6301\u8bfb\u3001\u5199\u53caPDF\u9875\u9762\u64cd\u4f5c\uff0c\u529f\u80fd\u6700\u4e3a\u5168\u9762\u3002\u5176\u4e2d\uff0c PyMuPDF \u5c24\u5176\u4ee5\u901f\u5ea6\u5feb\u8457\u79f0\uff0c\u800c borb \u662f\u65b0\u5f00\u53d1\u5e76\u6df1\u5f97\u597d\u8bc4\u7684\u5e93\uff0c\u6f5c\u529b\u65e0\u7a77\u3002\u4f46\u662f\uff0c\u4e8c\u8005\u540c\u4e3a GPL \u5bb6\u65cf\u7684\u5f00\u6e90\u534f\u8bae\uff0c\u5bf9\u5546\u7528\u4e0d\u592a\u53cb\u597d*\u3002 * \u652f\u6301\u514d\u8d39\u4f7f\u7528\uff0c\u4f46\u662f\u8981\u6c42\u5f15\u7528\u5176\u7684\u7a0b\u5e8f\u4e5f\u5fc5\u987b\u9075\u5b88\u76f8\u5e94\u534f\u8bae\u5373\u5f00\u6e90\u3002\u5982\u679c\u9700\u8981\u95ed\u6e90\u4f7f\u7528\u7684\u8bdd\uff0c\u9700\u8981\u5411\u4f5c\u8005\u7533\u8bf7\u4ed8\u8d39\u7684\u5546\u7528\u6388\u6743\u3002 \u6700\u540e\uff0c\u7528\u4e0b\u56fe\u7684\u603b\u7ed3\u7ed3\u675f\u5168\u6587\u3002","title":"Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4"},{"location":"2021-01-02-Python%E5%A4%84%E7%90%86PDF%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AF%B9%E6%AF%94/#pythonpdf","text":"\u53d1\u5e03\u4e8e\uff1a2021-01-02 | \u5206\u7c7b\uff1a process automation 2022.06.07\u4fee\u8ba2\uff1a\u65b0\u589e\u7b2c\u4e09\u65b9\u5e93 borb \u3002\u521d\u7a3f\u5199\u4e8e2021.01.02\uff0c\u5f7c\u65f6 borb \u624d\u53d1\u5e031.0\u7248\u6ca1\u51e0\u4e2a\u6708\uff1b\u4e24\u5e74\u4e0d\u5230\uff0cGithub\u4e0a\u5df2\u8fd1\u4e09\u5343\u8d5e\u3002 PDF\uff08Portable Document Format\uff09\u662f\u4e00\u79cd\u4fbf\u643a\u6587\u6863\u683c\u5f0f\uff0c\u4fbf\u4e8e\u8de8\u64cd\u4f5c\u7cfb\u7edf\u4f20\u64ad\u6587\u6863\u3002PDF\u6587\u6863\u9075\u5faa\u6807\u51c6\u683c\u5f0f\uff0c\u56e0\u6b64\u5b58\u5728\u5f88\u591a\u53ef\u4ee5\u64cd\u4f5cPDF\u6587\u6863\u7684\u5de5\u5177\uff0cPython\u81ea\u7136\u4e5f\u4e0d\u4f8b\u5916\u3002\u9762\u591a\u4f17\u591a\u7684Python\u7b2c\u4e09\u65b9\u5e93\uff0c\u672c\u6587\u4ece\u529f\u80fd\u3001\u5f00\u6e90\u534f\u8bae\u53ca\u793e\u533a\u6d3b\u8dc3\u5ea6\u4e09\u65b9\u9762\u52a0\u4ee5\u5bf9\u6bd4\uff0c\u4ee5\u4fbf\u6839\u636e\u5177\u4f53\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u5e93\u3002","title":"Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4"},{"location":"2021-01-02-Python%E5%A4%84%E7%90%86PDF%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AF%B9%E6%AF%94/#_1","text":"\u529f\u80fd\u5bf9\u6bd4\u4ece\u5927\u7c92\u5ea6\u4e0a\u5206\u6210\u4e86 \u63d0\u53d6\u5185\u5bb9 \u3001 \u64cd\u4f5c\u9875\u9762 \u548c \u521b\u5efa\u5185\u5bb9 \u4e09\u65b9\u9762\u3002\u524d\u4e24\u8005\u5206\u522b\u662f\u9488\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684PDF\u6587\u6863\u7684\u8bfb\u548c\u5199\u64cd\u4f5c\uff0c\u6700\u540e\u4e00\u9879\u4ece\u5185\u5bb9\u4e0a\u521b\u5efa\u65b0\u6587\u6863\u3002\u8003\u8651\u5230\u65f6\u6548\u6027\uff0c\u4ee5\u4e0b\u5bf9\u6bd4\u5217\u51fa\u4e86\u64b0\u6587\u65f6\uff082021.01\uff09\u76f8\u5e94\u7684\u6700\u65b0\u7248\u672c\u3002 \u63d0\u53d6\u5185\u5bb9 \u5982\u6587\u672c\u3001\u56fe\u7247\u3001\u5143\u4fe1\u606f \u64cd\u4f5c\u9875\u9762 \u7279\u6307\u64cd\u4f5c\u5df2\u7ecf\u5b58\u5728\u7684\u9875\u9762\u4f8b\u5982\u5206\u5272\u3001\u5408\u5e76\u3001\u88c1\u526a\u3001\u65cb\u8f6c\u7b49 \u521b\u5efa\u5185\u5bb9 \u6307\u521b\u5efa\u6216\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u4f8b\u5982\u6587\u672c\u3001\u56fe\u7247\u3001\u5f62\u72b6 Python\u5e93 \u5f53\u524d\u7248\u672c Python\u7248\u672c \u5f00\u6e90\u534f\u8bae \u6700\u65b0\u66f4\u65b0 \u529f\u80fd\uff1a\u63d0\u53d6\u5185\u5bb9 \u529f\u80fd\uff1a\u64cd\u4f5c\u9875\u9762 \u529f\u80fd\uff1a\u521b\u5efa\u5185\u5bb9 \u5907\u6ce8 PyPDF2 1.26.0 2.6-3.6 modified BSD 3\u5e74\u524d \u221a \u221a \u00d7 PyPDF2 \u5df2\u4e0d\u518d\u7ef4\u62a4\uff0c\u7ee7\u4efb\u8005 PyPDF4 \uff08 PyPDF \u3001 PyPDF2 \u53ca PyPDF4 \u7684\u6e0a\u6e90\u53c2\u8003 \u6b64\u5904 \uff09\u3002 \u7531\u4e8e PyPDF2 \u4f3c\u4e4e\u66f4\u77e5\u540d\uff0c\u6545\u4ee5\u5176\u4f5c\u4e3a\u6761\u76ee\u5217\u51fa\u3002 pdfrw 0.4 2.6-3.6 MIT 3\u5e74\u524d \u221a \u221a \u00d7 \u81ea\u8eab\u4e0d\u80fd\u521b\u5efa\u65b0\u5185\u5bb9\uff0c\u4f46\u662f\u96c6\u6210\u4e86 ReportLab \uff0c\u53ef\u4ee5\u517c\u5bb9 ReportLab \u751f\u6210\u65b0\u9875\u9762 ReportLab 3.5.58 2.7\uff0c 3.6+ BSD \u975e\u5e38\u6d3b\u8dc3 \u00d7 \u00d7 \u221a ReportLab \u7684\u5f00\u6e90\u7248\u672c\uff0c\u4e13\u4e1a\u521b\u5efaPDF\u5185\u5bb9\u5982\u6587\u672c\u3001\u56fe\u8868\u7b49 pikepdf 2.2.4 2.7\uff0c 3.6+ MPL 2.0 \u975e\u5e38\u6d3b\u8dc3 \u221a \u221a \u00d7 \u57fa\u4e8eC++\u7684 QPDF \uff0c\u5bf9\u6807 PyPDF2 \u548c pdfrw \uff1b\u504f\u5411\u5e95\u5c42 pdfplumber 0.5.25 3.6-3.8 MIT \u6d3b\u8dc3 \u221a \u00d7 \u00d7 \u57fa\u4e8e pdfminer.six \uff1b\u9664\u4e86\u6587\u672c\u3001\u5f62\u72b6\uff08\u77e9\u5f62\u3001\u76f4\u7ebf/\u66f2\u7ebf\uff09\uff0c\u8fd8\u80fd**\u89e3\u6790\u8868\u683c**\u3002 \u51e0\u4e2a\u63d0\u53d6PDF\u8868\u683c\u7684Python\u5e93\u7684\u5bf9\u6bd4\u53c2\u8003 \u6b64\u5904 pdfminer.six 20201018 3.6+ MIT 2\u4e2a\u6708\u524d \u221a \u00d7 \u00d7 pdfminer \u7684\u793e\u533a\u7ef4\u62a4\u7248\uff0c\u56e0\u4e3a pdfminer \u81ea2020\u5e74\u8d77\u4e0d\u518d\u79ef\u6781\u7ef4\u62a4 PyMuPDF 1.18.5 3.6+ GPL V3 \u975e\u5e38\u6d3b\u8dc3 \u221a \u221a \u221a \u57fa\u4e8e mupdf \uff1b\u4ee5\u5904\u7406\u901f\u5ea6\u8457\u79f0\uff0c\u53c2\u8003 \u6b64\u5904 borb 2.0.27 3.6+ AGPL \u975e\u5e38\u6d3b\u8dc3 \u221a \u221a \u221a \u7eafPython\u5e93\uff0c\u652f\u6301\u8bfb\u3001\u5199\u3001\u64cd\u4f5cPDF\u6587\u6863\uff0c\u517c\u987e\u5e95\u5c42\u548c\u9ad8\u7ea7\u5e94\u7528 borb \u4e8e 2022.06 \u65b0\u52a0\u5165\u5bf9\u6bd4\uff0c\u65f6\u95f4\u70b9\u4ee5\u6b64\u4e3a\u51c6\u3002","title":"\u6982\u51b5"},{"location":"2021-01-02-Python%E5%A4%84%E7%90%86PDF%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AF%B9%E6%AF%94/#_2","text":"PyPDF2 \u7cfb\u5217\u3001 pdfrw \u53ca pikepdf \u4e13\u6ce8\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684PDF\u7684\u64cd\u4f5c\uff08\u5206\u5272\u3001\u5408\u5e76\u3001\u65cb\u8f6c\u7b49\uff09\uff0c\u524d\u4e24\u8005\u57fa\u672c\u5904\u4e8e\u505c\u6b62\u7ef4\u62a4\u7684\u72b6\u6001\u3002 pdfplumber \u53ca\u5176\u4f9d\u8d56 pdfminer.six \u4e13\u6ce8PDF\u5185\u5bb9\u63d0\u53d6\uff0c\u4f8b\u5982\u6587\u672c\uff08\u4f4d\u7f6e\u3001\u5b57\u4f53\u53ca\u989c\u8272\u7b49\uff09\u548c\u5f62\u72b6\uff08\u77e9\u5f62\u3001\u76f4\u7ebf\u3001\u66f2\u7ebf\uff09\uff0c\u524d\u8005\u8fd8\u6709\u89e3\u6790\u8868\u683c\u7684\u529f\u80fd\u3002 ReportLab \u4e13\u6ce8PDF\u9875\u9762\u5185\u5bb9\uff08\u6587\u672c\u3001\u56fe\u3001\u8868\u7b49\uff09\u7684\u521b\u5efa\u3002 PyMuPDF \u548c borb \u540c\u65f6\u652f\u6301\u8bfb\u3001\u5199\u53caPDF\u9875\u9762\u64cd\u4f5c\uff0c\u529f\u80fd\u6700\u4e3a\u5168\u9762\u3002\u5176\u4e2d\uff0c PyMuPDF \u5c24\u5176\u4ee5\u901f\u5ea6\u5feb\u8457\u79f0\uff0c\u800c borb \u662f\u65b0\u5f00\u53d1\u5e76\u6df1\u5f97\u597d\u8bc4\u7684\u5e93\uff0c\u6f5c\u529b\u65e0\u7a77\u3002\u4f46\u662f\uff0c\u4e8c\u8005\u540c\u4e3a GPL \u5bb6\u65cf\u7684\u5f00\u6e90\u534f\u8bae\uff0c\u5bf9\u5546\u7528\u4e0d\u592a\u53cb\u597d*\u3002 * \u652f\u6301\u514d\u8d39\u4f7f\u7528\uff0c\u4f46\u662f\u8981\u6c42\u5f15\u7528\u5176\u7684\u7a0b\u5e8f\u4e5f\u5fc5\u987b\u9075\u5b88\u76f8\u5e94\u534f\u8bae\u5373\u5f00\u6e90\u3002\u5982\u679c\u9700\u8981\u95ed\u6e90\u4f7f\u7528\u7684\u8bdd\uff0c\u9700\u8981\u5411\u4f5c\u8005\u7533\u8bf7\u4ed8\u8d39\u7684\u5546\u7528\u6388\u6743\u3002 \u6700\u540e\uff0c\u7528\u4e0b\u56fe\u7684\u603b\u7ed3\u7ed3\u675f\u5168\u6587\u3002","title":"\u70b9\u8bc4"},{"location":"2021-04-24-Python-xlwings%E6%A8%A1%E5%9D%97%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8VBA%E5%87%BD%E6%95%B0/","text":"Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-04-24 | \u5206\u7c7b\uff1a process automation xlwings \u662f win32com \u7684\u9ad8\u7ea7\u5c01\u88c5\uff0c\u5176\u4e2d xlwings.App.macro(name) \u65b9\u6cd5\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528VBA\u6a21\u5757\u4e2d\u5b9a\u4e49\u597d\u7684\u51fd\u6570\u3002\u7ed3\u5408 \u524d\u6587 win32com \u64cd\u4f5cVBA\u6a21\u5757\u7684\u65b9\u6cd5\uff0c\u8fd9\u5c31\u4ea7\u751f\u4e86\u4e00\u79cd\u65b0\u7684\u4f7f\u7528\u65b9\u5f0f\uff1a \u76f4\u63a5\u7528Python\u6ce8\u5165VBA\u4ee3\u7801\u5e76\u83b7\u53d6\u8be5\u51fd\u6570\u53e5\u67c4\uff0c\u7136\u540e\u5728Python\u4e2d\u8c03\u7528\uff0c\u6700\u540e\u5b9e\u9645\u4ee5VBA\u65b9\u5f0f\u6267\u884c \u3002 \u6211\u4eec\u5f53\u521d\u9009\u62e9xlwings\u662f\u4e3a\u4e86\u7b80\u5316VBA\u4ee3\u7801\uff0c\u90a3\u4e3a\u4f55\u8fd8\u8981\u56de\u8fc7\u5934\u6765\u5199VBA\u5462\uff1fxlwings\u7684\u7b80\u5316\u662f\u4ee5\u6027\u80fd\u635f\u8017\u4e3a\u4ee3\u4ef7\u7684\uff0c\u56e0\u6b64\u5bf9\u4e8e\u9700\u8981\u63d0\u9ad8\u6027\u80fd\u7684\u573a\u666f\uff0c\u53ef\u4ee5\u8003\u8651\u672c\u6587\u65b9\u6cd5\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u5047\u8bbe\u7684\u573a\u666f\u6765\u6f14\u793a\u6574\u4e2a\u8fc7\u7a0b\u3002 \u9700\u6c42 \u00b6 \u5047\u8bbe\u9700\u8981\u586b\u5199 target.xlsm \u6bcf\u4e00\u4e2a\u5de5\u4f5c\u8868\u4e2d\u7ea2\u8272\u80cc\u666f\u7684\u5355\u5143\u683c\uff0c\u5b83\u7684\u503c\u6765\u6e90\u4e8e source.xlsx \u76f8\u540c\u4f4d\u7f6e\u7684\u5355\u5143\u683c\u3002 \u8003\u8651\u5355\u4e2a\u5de5\u4f5c\u8868\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9xlwings\u7684API\u904d\u5386 target.xlsm \u4e2d\u5df2\u4f7f\u7528\u7684\u5355\u5143\u683c\u5e76\u5224\u65ad\u80cc\u666f\u8272\uff0c\u6ee1\u8db3\u8981\u6c42\u5219\u63d0\u53d6\u5176\u5730\u5740\uff1b\u7136\u540e\u63d0\u53d6 source.xlsx \u76f8\u5e94\u4f4d\u7f6e\u5355\u5143\u683c\u7684\u503c\uff0c\u5e76\u8d4b\u503c\u5230 target.xlsm \u7684\u5355\u5143\u683c\u3002\u6574\u4e2a\u8fc7\u7a0b\u4e0d\u590d\u6742\uff0c\u4f46\u662f\u968f\u7740\u6570\u636e\u91cf\u589e\u5927\uff0c\u8fd0\u884c\u65f6\u95f4\u9010\u6e10\u96be\u4ee5\u63a5\u53d7\u3002 \u81ea\u5b9a\u4e49VBA\u51fd\u6570 \u00b6 \u68c0\u67e5\u53d1\u73b0\u4e3b\u8981\u65f6\u95f4\u82b1\u8d39\u5728\u76ee\u6807\u5355\u5143\u683c\u7684\u904d\u5386\u8bc6\u522b\u4e0a\uff0c\u56e0\u6b64\u8003\u8651\u4f7f\u7528VBA\u539f\u751f\u65b9\u6cd5\uff1a Function GetRange(sheetName) Dim rng As Range, res As Range Set res = Nothing For Each rng In ThisWorkbook.Worksheets(sheetName).UsedRange If rng.Interior.Color = RGB(255, 0, 0) Then If res Is Nothing Then Set res = rng Else: Set res = Union(res, rng) End If Next Set GetRange = res End Function \u6ce8\u5165\u548c\u5f15\u7528VBA\u51fd\u6570 \u00b6 \u7136\u540e\u5229\u7528xlwings\u5728 target.xlsm \u521b\u5efaVBA\u6a21\u5757\u5e76\u5199\u5165\u4e0a\u8ff0\u51fd\u6570\uff1a import xlwings as xw # Excel application app = xw.App(add_book=False, visible=False) app.screen_updating = False app.display_alerts = False app.api.AutomationSecurity = 1 # open target.xlsm com_target = app.books.api.Open('path/to/target.xlsm', UpdateLinks=False) # win32com object wb_target = app.books[com_target.Name] # xlwings object # add module and inject codes code = '''...GetRange code...''' insert_module('any_module_name') update_module('any_module_name', code) # save wb_target.save() \u6ce8\u610f insert_module \u548c update_module \u5206\u522b\u662f\u521b\u5efa\u548c\u66f4\u65b0\u6a21\u5757\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u53c2\u8003\u672c\u6587\u5f00\u5934\u63d0\u53ca\u7684\u6587\u7ae0\u3002 \u63a5\u4e0b\u6765\uff0c\u5229\u7528 xlwings.Book.macro \u83b7\u53d6VBA\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570 GetRange(sheetName, sourceWbName) \uff1a fun_get_range = wb_target.macro('GetRange') \u8c03\u7528VBA\u51fd\u6570 \u00b6 fun_get_range \u4f5c\u4e3a\u51fd\u6570\u53e5\u67c4\uff0c\u540c GetRange \u7684\u539f\u59cb\u5b9a\u4e49\u4e00\u6837\uff0c\u4e5f\u5e26\u53c2\u6570 sheetName \uff0c\u5e94\u7528\u4e3e\u4f8b\uff1a sheet_names = [sheet.name for sheet in wb_target.sheets] for sheet_name in sheet_names: # source/target sheets target_sheet = wb_target.sheets(sheet_name) source_sheet = wb_source.sheets(sheet_name) # satisfied ranges in current sheet input_ranges = fun_get_range(sheet_name) # process with input_ranges # ... \u6ce8\u610f fun_get_range() \u83b7\u53d6VBA\u7684\u6267\u884c\u7ed3\u679c\uff0c\u5e76\u672a\u7ecf\u8fc7 xlwings \u7684\u5305\u88c5\uff0c\u4ecd\u65e7\u662f win32com \u7c7b\u578b\u7684\u5bf9\u8c61\u3002\u4e3b\u8981\u533a\u522b\u5728\u4e8eAPI\u7684\u9996\u5b57\u6bcd\uff0c win32com \u901a\u5e38\u662f\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u800c xlwings \u503e\u5411\u4e8e\u5168\u90e8\u5c0f\u5199\u3002 \u6700\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u904d\u5386 input_ranges \uff0c\u5b9e\u73b0\u4ece source.xlsx \u5411 target.xlsm \u8d4b\u503c\u3002\u8fd8\u6709\u4e00\u4e2a\u63d0\u901f\u7684\u5c0f\u6280\u5de7\uff1a\u9010\u4e2a\u8d4b\u503c\u5f53\u7136\u4e0d\u5982\u8fde\u7eed\u533a\u57df\u7684\u4e00\u6b21\u6027\u8d4b\u503c\u6765\u7684\u5feb\uff1a for area in input_ranges.Areas: # fill all cells in same area, here v is a list of list by setting nidm=2 address = area.Address v = source_sheet.range(address).options(ndim=2).value target_sheet.range(address).value = v","title":"Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570"},{"location":"2021-04-24-Python-xlwings%E6%A8%A1%E5%9D%97%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8VBA%E5%87%BD%E6%95%B0/#python xlwingsvba","text":"\u53d1\u5e03\u4e8e\uff1a2021-04-24 | \u5206\u7c7b\uff1a process automation xlwings \u662f win32com \u7684\u9ad8\u7ea7\u5c01\u88c5\uff0c\u5176\u4e2d xlwings.App.macro(name) \u65b9\u6cd5\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528VBA\u6a21\u5757\u4e2d\u5b9a\u4e49\u597d\u7684\u51fd\u6570\u3002\u7ed3\u5408 \u524d\u6587 win32com \u64cd\u4f5cVBA\u6a21\u5757\u7684\u65b9\u6cd5\uff0c\u8fd9\u5c31\u4ea7\u751f\u4e86\u4e00\u79cd\u65b0\u7684\u4f7f\u7528\u65b9\u5f0f\uff1a \u76f4\u63a5\u7528Python\u6ce8\u5165VBA\u4ee3\u7801\u5e76\u83b7\u53d6\u8be5\u51fd\u6570\u53e5\u67c4\uff0c\u7136\u540e\u5728Python\u4e2d\u8c03\u7528\uff0c\u6700\u540e\u5b9e\u9645\u4ee5VBA\u65b9\u5f0f\u6267\u884c \u3002 \u6211\u4eec\u5f53\u521d\u9009\u62e9xlwings\u662f\u4e3a\u4e86\u7b80\u5316VBA\u4ee3\u7801\uff0c\u90a3\u4e3a\u4f55\u8fd8\u8981\u56de\u8fc7\u5934\u6765\u5199VBA\u5462\uff1fxlwings\u7684\u7b80\u5316\u662f\u4ee5\u6027\u80fd\u635f\u8017\u4e3a\u4ee3\u4ef7\u7684\uff0c\u56e0\u6b64\u5bf9\u4e8e\u9700\u8981\u63d0\u9ad8\u6027\u80fd\u7684\u573a\u666f\uff0c\u53ef\u4ee5\u8003\u8651\u672c\u6587\u65b9\u6cd5\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u5047\u8bbe\u7684\u573a\u666f\u6765\u6f14\u793a\u6574\u4e2a\u8fc7\u7a0b\u3002","title":"Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570"},{"location":"2021-04-24-Python-xlwings%E6%A8%A1%E5%9D%97%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8VBA%E5%87%BD%E6%95%B0/#_1","text":"\u5047\u8bbe\u9700\u8981\u586b\u5199 target.xlsm \u6bcf\u4e00\u4e2a\u5de5\u4f5c\u8868\u4e2d\u7ea2\u8272\u80cc\u666f\u7684\u5355\u5143\u683c\uff0c\u5b83\u7684\u503c\u6765\u6e90\u4e8e source.xlsx \u76f8\u540c\u4f4d\u7f6e\u7684\u5355\u5143\u683c\u3002 \u8003\u8651\u5355\u4e2a\u5de5\u4f5c\u8868\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9xlwings\u7684API\u904d\u5386 target.xlsm \u4e2d\u5df2\u4f7f\u7528\u7684\u5355\u5143\u683c\u5e76\u5224\u65ad\u80cc\u666f\u8272\uff0c\u6ee1\u8db3\u8981\u6c42\u5219\u63d0\u53d6\u5176\u5730\u5740\uff1b\u7136\u540e\u63d0\u53d6 source.xlsx \u76f8\u5e94\u4f4d\u7f6e\u5355\u5143\u683c\u7684\u503c\uff0c\u5e76\u8d4b\u503c\u5230 target.xlsm \u7684\u5355\u5143\u683c\u3002\u6574\u4e2a\u8fc7\u7a0b\u4e0d\u590d\u6742\uff0c\u4f46\u662f\u968f\u7740\u6570\u636e\u91cf\u589e\u5927\uff0c\u8fd0\u884c\u65f6\u95f4\u9010\u6e10\u96be\u4ee5\u63a5\u53d7\u3002","title":"\u9700\u6c42"},{"location":"2021-04-24-Python-xlwings%E6%A8%A1%E5%9D%97%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8VBA%E5%87%BD%E6%95%B0/#vba","text":"\u68c0\u67e5\u53d1\u73b0\u4e3b\u8981\u65f6\u95f4\u82b1\u8d39\u5728\u76ee\u6807\u5355\u5143\u683c\u7684\u904d\u5386\u8bc6\u522b\u4e0a\uff0c\u56e0\u6b64\u8003\u8651\u4f7f\u7528VBA\u539f\u751f\u65b9\u6cd5\uff1a Function GetRange(sheetName) Dim rng As Range, res As Range Set res = Nothing For Each rng In ThisWorkbook.Worksheets(sheetName).UsedRange If rng.Interior.Color = RGB(255, 0, 0) Then If res Is Nothing Then Set res = rng Else: Set res = Union(res, rng) End If Next Set GetRange = res End Function","title":"\u81ea\u5b9a\u4e49VBA\u51fd\u6570"},{"location":"2021-04-24-Python-xlwings%E6%A8%A1%E5%9D%97%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8VBA%E5%87%BD%E6%95%B0/#vba_1","text":"\u7136\u540e\u5229\u7528xlwings\u5728 target.xlsm \u521b\u5efaVBA\u6a21\u5757\u5e76\u5199\u5165\u4e0a\u8ff0\u51fd\u6570\uff1a import xlwings as xw # Excel application app = xw.App(add_book=False, visible=False) app.screen_updating = False app.display_alerts = False app.api.AutomationSecurity = 1 # open target.xlsm com_target = app.books.api.Open('path/to/target.xlsm', UpdateLinks=False) # win32com object wb_target = app.books[com_target.Name] # xlwings object # add module and inject codes code = '''...GetRange code...''' insert_module('any_module_name') update_module('any_module_name', code) # save wb_target.save() \u6ce8\u610f insert_module \u548c update_module \u5206\u522b\u662f\u521b\u5efa\u548c\u66f4\u65b0\u6a21\u5757\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u53c2\u8003\u672c\u6587\u5f00\u5934\u63d0\u53ca\u7684\u6587\u7ae0\u3002 \u63a5\u4e0b\u6765\uff0c\u5229\u7528 xlwings.Book.macro \u83b7\u53d6VBA\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570 GetRange(sheetName, sourceWbName) \uff1a fun_get_range = wb_target.macro('GetRange')","title":"\u6ce8\u5165\u548c\u5f15\u7528VBA\u51fd\u6570"},{"location":"2021-04-24-Python-xlwings%E6%A8%A1%E5%9D%97%E5%88%9B%E5%BB%BA%E5%92%8C%E8%B0%83%E7%94%A8VBA%E5%87%BD%E6%95%B0/#vba_2","text":"fun_get_range \u4f5c\u4e3a\u51fd\u6570\u53e5\u67c4\uff0c\u540c GetRange \u7684\u539f\u59cb\u5b9a\u4e49\u4e00\u6837\uff0c\u4e5f\u5e26\u53c2\u6570 sheetName \uff0c\u5e94\u7528\u4e3e\u4f8b\uff1a sheet_names = [sheet.name for sheet in wb_target.sheets] for sheet_name in sheet_names: # source/target sheets target_sheet = wb_target.sheets(sheet_name) source_sheet = wb_source.sheets(sheet_name) # satisfied ranges in current sheet input_ranges = fun_get_range(sheet_name) # process with input_ranges # ... \u6ce8\u610f fun_get_range() \u83b7\u53d6VBA\u7684\u6267\u884c\u7ed3\u679c\uff0c\u5e76\u672a\u7ecf\u8fc7 xlwings \u7684\u5305\u88c5\uff0c\u4ecd\u65e7\u662f win32com \u7c7b\u578b\u7684\u5bf9\u8c61\u3002\u4e3b\u8981\u533a\u522b\u5728\u4e8eAPI\u7684\u9996\u5b57\u6bcd\uff0c win32com \u901a\u5e38\u662f\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u800c xlwings \u503e\u5411\u4e8e\u5168\u90e8\u5c0f\u5199\u3002 \u6700\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u904d\u5386 input_ranges \uff0c\u5b9e\u73b0\u4ece source.xlsx \u5411 target.xlsm \u8d4b\u503c\u3002\u8fd8\u6709\u4e00\u4e2a\u63d0\u901f\u7684\u5c0f\u6280\u5de7\uff1a\u9010\u4e2a\u8d4b\u503c\u5f53\u7136\u4e0d\u5982\u8fde\u7eed\u533a\u57df\u7684\u4e00\u6b21\u6027\u8d4b\u503c\u6765\u7684\u5feb\uff1a for area in input_ranges.Areas: # fill all cells in same area, here v is a list of list by setting nidm=2 address = area.Address v = source_sheet.range(address).options(ndim=2).value target_sheet.range(address).value = v","title":"\u8c03\u7528VBA\u51fd\u6570"},{"location":"2021-05-01-Python%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%97%ADExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86/","text":"Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-05-01 | \u5206\u7c7b\uff1a process automation \u5229\u7528Python\u5b9e\u73b0Excel\u81ea\u52a8\u5316\uff0c\u5c24\u5176\u662f\u6d89\u53caVBA\u65f6\uff0c\u6709\u53ef\u80fd\u597d\u5fc3\u51fa\u73b0\u6d88\u606f\u6846 1 2 \uff0c\u4f8b\u5982\u52a8\u4f5c\u5b8c\u6210\u540e\u7684\u4e00\u4e2aVBA\u5f39\u7a97\uff08MsgBox\uff09\u3002\u6b64\u65f6\u9700\u8981\u4eba\u4e3a\u54cd\u5e94\uff0c\u5426\u5219\u4ee3\u7801\u5361\u6b7b\u76f4\u81f3\u8d85\u65f6\u3002\u5f53\u7136\uff0c\u6839\u672c\u7684\u65b9\u6cd5\u662fVBA\u4ee3\u7801\u4e2d\u4e0d\u8981\u51fa\u73b0\u7c7b\u4f3c\u5f39\u7a97\uff1b\u4f46\u6709\u65f6\u6211\u4eec\u65e0\u6743\u4fee\u6539\u88ab\u64cd\u4f5c\u7684Excel\u6587\u4ef6\uff0c\u4f8b\u5982\u8fd9\u662f\u6211\u4eec\u8fdb\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u5bf9\u8c61\u3002\u6240\u4ee5\u672c\u6587\u8bb0\u5f55\u4ece\u4ee3\u7801\u89d2\u5ea6\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u7684\u65b9\u6cd5\u3002 \u5047\u60f3\u573a\u666f \u00b6 \u4f7f\u7528 xlwings \uff08\u6216\u8005\u5176\u4ed6\u81ea\u52a8\u5316\u5e93\uff09\u6253\u5f00Excel\u6587\u4ef6 test.xlsm \uff0c\u8bfb\u53d6 Sheet1!A1 \u5355\u5143\u683c\u5185\u5bb9\u3002\u5f88\u7b80\u5355\u7684\u4e00\u4e2a\u64cd\u4f5c\uff1a import xlwings as xw wb = xw.Book('test.xlsm') msg = wb.sheets('Sheet1').range('A1').value print(msg) wb.close() \u7136\u800c\u4e0d\u5e78\u7684\u662f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5728\u6253\u5f00\u5de5\u4f5c\u7c3f\u65f6\u8fdb\u884c\u4e86\u70ed\u60c5\u7684\u6b22\u8fce\u4eea\u5f0f\uff1a Private Sub Workbook_Open() MsgBox \"Welcome\" MsgBox \"to open\" MsgBox \"this file.\" End Sub \u7b2c\u4e00\u4e2a\u5f39\u7a97 Welcome \u5c31\u5361\u4f4f\u4e86Excel\uff0cPython\u4ee3\u7801\u76f8\u5e94\u88ab\u5361\u6b7b\u5728\u7b2c\u4e00\u884c\u3002 \u57fa\u672c\u601d\u8def \u00b6 \u4e3b\u7a0b\u5e8f\u4e2d\u4e0d\u53ef\u80fd\u76f4\u63a5\u5904\u7406\u6216\u8005\u7ed5\u8fc7\u6b64\u7c7b\u95ee\u9898\uff0c\u4e5f\u4e0d\u80fd\u5962\u671b\u6709\u4eba\u968f\u65f6\u8e72\u5b88\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u2014\u2014\u90a3\u5c31\u65b0\u5f00\u4e00\u4e2a\u7ebf\u7a0b\u6765\u575a\u5b88\u5427\u3002\u56e0\u6b64\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u5229\u7528\u5b50\u7ebf\u7a0b\u76d1\u542c\u5e76\u968f\u65f6\u5173\u95ed\u5f39\u7a97\uff0c\u76f4\u5230\u4e3b\u7a0b\u5e8f\u5706\u6ee1\u7ed3\u675f\u3002 Excel\u5f39\u7a97\u9ed8\u8ba4\u7684\u6807\u9898\u662f Microsoft Excel \uff0c\u63a5\u4e0b\u6765\u4ee5\u6b64\u4e3a\u4f8b\u6355\u6349\u7a97\u53e3\u5e76\u70b9\u51fb\u6309\u94ae\u3002 pywinauto\u65b9\u6848 \u00b6 pywinauto \u987e\u540d\u601d\u4e49\u662fWindows\u754c\u9762\u81ea\u52a8\u5316\u5e93\uff0c\u6a21\u62df\u9f20\u6807\u548c\u952e\u76d8\u64cd\u4f5c\u7a97\u4f53\u548c\u63a7\u4ef6 3 \u3002\u4e0d\u540c\u4e8e\u5148\u83b7\u53d6\u53e5\u67c4\u518d\u83b7\u53d6\u5c5e\u6027\u7684\u4f20\u7edf\u65b9\u5f0f\uff0c pywinauto \u7684API\u66f4\u52a0\u53cb\u597d\u548cpythonic\u3002\u4f8b\u5982\uff0c\u4e24\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7a97\u53e3\u6355\u6349\u548c\u70b9\u51fb\uff1a win = Application(backend=\"win32\").connect(title='Microsoft Excel') win.Dialog.Button.click() \u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ebf\u7a0b\u7c7b\u6267\u884c\u4ee5\u4e0a\u64cd\u4f5c\uff1a # listener_pywinauto.py import time from threading import Thread, Event from pywinauto.application import Application class MsgBoxListener(Thread): def __init__(self, title:str, interval:int): Thread.__init__(self) self._title = title self._interval = interval self._stop_event = Event() def stop(self): self._stop_event.set() @property def is_running(self): return not self._stop_event.is_set() def run(self): while self.is_running: try: time.sleep(self._interval) self._close_msgbox() except Exception as e: print(e, flush=True) def _close_msgbox(self): '''Close the default Excel MsgBox with title \"Microsoft Excel\".''' win = Application(backend=\"win32\").connect(title=self._title) win.Dialog.Button.click() if __name__=='__main__': t = MsgBoxListener('Microsoft Excel', 1) t.start() time.sleep(10) t.stop() \u6700\u7ec8\uff0c\u5728\u5f00\u59cb\u4e3b\u8981\u64cd\u4f5c\u524d\u542f\u52a8\u5b50\u7ebf\u7a0b\uff0c\u5e76\u5728\u7ed3\u675f\u540e\u5173\u95ed\uff1a import xlwings as xw from listener_pywinauto import MsgBoxListener # start listen thread listener = MsgBoxListener('Microsoft Excel', 3) listener.start() # main process wb = xw.Book('test.xlsm') msg = wb.sheets('Sheet1').range('A1').value print(msg) wb.close() # stop listener thread listener.stop() \u5230\u6b64\u95ee\u9898\u57fa\u672c\u89e3\u51b3\uff0c\u672c\u5730\u8fd0\u884c\u6548\u679c\u5b8c\u5168\u8fbe\u5230\u9884\u671f\u3002\u4f46\u6211\u7684\u771f\u5b9e\u9700\u6c42\u662f\u4ee5\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u5728\u670d\u52a1\u5668\u4e0a\u8fdb\u884cExcel\u6587\u4ef6\u81ea\u52a8\u5316\u6d4b\u8bd5\uff0c\u540e\u7eed\u53d1\u73b0\uff0c\u5f53\u4ee5\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u8fd0\u884c\u65f6\uff0c pywinauto \u7adf\u7136\u6355\u6349\u4e0d\u5230\u5f39\u7a97\uff01\u8fd9\u6216\u8bb8\u662f pywinauto \u4e00\u4e2a\u6f5c\u5728\u7684\u95ee\u9898 4 \u3002 win32gui\u65b9\u6848 \u00b6 \u90a3\u5c31\u53ea\u597d\u8f6c\u5411\u76f8\u5bf9\u5e95\u5c42\u7684 win32gui \uff08\u5b9e\u9645\u662f pywin32 \u5e93\u7684\u4e00\u90e8\u5206\uff09\uff0c\u6240\u5e78\u89e3\u51b3\u4e86\u4e0a\u8ff0\u95ee\u9898\u3002 # pip install pywin32 import win32gui import win32con \u4ee5\u4e0b\u4ec5\u5217\u51fa MsgBoxListener \u7c7b\u4e2d\u5173\u952e\u64cd\u4f5c\uff0c\u5176\u4f59\u4ee3\u7801\u5b8c\u5168\u4e00\u81f4\uff1a def _close_msgbox(self): # find the top window by title hwnd = win32gui.FindWindow(None, self._title) if not hwnd: return # find child button h_btn = win32gui.FindWindowEx(hwnd, None,'Button', None) if not h_btn: return # show text text = win32gui.GetWindowText(h_btn) print(text) # click button win32gui.PostMessage(h_btn, win32con.WM_LBUTTONDOWN, None, None) time.sleep(0.2) win32gui.PostMessage(h_btn, win32con.WM_LBUTTONUP, None, None) time.sleep(0.2) \u518d\u8fdb\u4e00\u6b65\uff0c\u539fVBA\u4ee3\u7801\u53ef\u80fd\u4e0d\u662f\u91c7\u7528\u9ed8\u8ba4\u7684\u5f39\u7a97\u6807\u9898\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u80fd\u4ec5\u6839\u636e\u6807\u9898\u8fdb\u884c\u6355\u6349\u3002\u90a3\u5c31\u6269\u5927\u5316\u8303\u56f4\uff0c\u5c1d\u8bd5\u70b9\u51fb\u4efb\u4f55\u5305\u542b\u786e\u5b9a\u6027\u6309\u94ae\uff08\u4f8b\u5982OK\uff0cYes\uff0cConfirm\uff09\u7684\u7a97\u53e3\u3002 def _close_msgbox(self): '''Click button to close message box if has text \"OK\", \"Yes\" or \"Confirm\".''' # Get handles of all top wondows h_windows = [] win32gui.EnumWindows(lambda hWnd, param: param.append(hWnd), h_windows) for h_window in h_windows: # Get child button with text OK, Yes or Confirm of given window. h_btn = win32gui.FindWindowEx(h_window, None,'Button', None) if not h_btn: continue # check button text text = win32gui.GetWindowText(h_btn) if not text.lower() in ('ok', 'yes', 'confirm'): continue # click button win32gui.PostMessage(h_btn, win32con.WM_LBUTTONDOWN, None, None) time.sleep(0.2) win32gui.PostMessage(h_btn, win32con.WM_LBUTTONUP, None, None) time.sleep(0.2) Handling VBA popup message boxes in Microsoft Excel \u21a9 Trying to catch MsgBox text and press button in xlwings \u21a9 What is pywinauto \u21a9 Remote Execution Guide \u21a9","title":"Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846"},{"location":"2021-05-01-Python%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%97%ADExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86/#pythonexcel","text":"\u53d1\u5e03\u4e8e\uff1a2021-05-01 | \u5206\u7c7b\uff1a process automation \u5229\u7528Python\u5b9e\u73b0Excel\u81ea\u52a8\u5316\uff0c\u5c24\u5176\u662f\u6d89\u53caVBA\u65f6\uff0c\u6709\u53ef\u80fd\u597d\u5fc3\u51fa\u73b0\u6d88\u606f\u6846 1 2 \uff0c\u4f8b\u5982\u52a8\u4f5c\u5b8c\u6210\u540e\u7684\u4e00\u4e2aVBA\u5f39\u7a97\uff08MsgBox\uff09\u3002\u6b64\u65f6\u9700\u8981\u4eba\u4e3a\u54cd\u5e94\uff0c\u5426\u5219\u4ee3\u7801\u5361\u6b7b\u76f4\u81f3\u8d85\u65f6\u3002\u5f53\u7136\uff0c\u6839\u672c\u7684\u65b9\u6cd5\u662fVBA\u4ee3\u7801\u4e2d\u4e0d\u8981\u51fa\u73b0\u7c7b\u4f3c\u5f39\u7a97\uff1b\u4f46\u6709\u65f6\u6211\u4eec\u65e0\u6743\u4fee\u6539\u88ab\u64cd\u4f5c\u7684Excel\u6587\u4ef6\uff0c\u4f8b\u5982\u8fd9\u662f\u6211\u4eec\u8fdb\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u5bf9\u8c61\u3002\u6240\u4ee5\u672c\u6587\u8bb0\u5f55\u4ece\u4ee3\u7801\u89d2\u5ea6\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u7684\u65b9\u6cd5\u3002","title":"Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846"},{"location":"2021-05-01-Python%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%97%ADExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86/#_1","text":"\u4f7f\u7528 xlwings \uff08\u6216\u8005\u5176\u4ed6\u81ea\u52a8\u5316\u5e93\uff09\u6253\u5f00Excel\u6587\u4ef6 test.xlsm \uff0c\u8bfb\u53d6 Sheet1!A1 \u5355\u5143\u683c\u5185\u5bb9\u3002\u5f88\u7b80\u5355\u7684\u4e00\u4e2a\u64cd\u4f5c\uff1a import xlwings as xw wb = xw.Book('test.xlsm') msg = wb.sheets('Sheet1').range('A1').value print(msg) wb.close() \u7136\u800c\u4e0d\u5e78\u7684\u662f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5728\u6253\u5f00\u5de5\u4f5c\u7c3f\u65f6\u8fdb\u884c\u4e86\u70ed\u60c5\u7684\u6b22\u8fce\u4eea\u5f0f\uff1a Private Sub Workbook_Open() MsgBox \"Welcome\" MsgBox \"to open\" MsgBox \"this file.\" End Sub \u7b2c\u4e00\u4e2a\u5f39\u7a97 Welcome \u5c31\u5361\u4f4f\u4e86Excel\uff0cPython\u4ee3\u7801\u76f8\u5e94\u88ab\u5361\u6b7b\u5728\u7b2c\u4e00\u884c\u3002","title":"\u5047\u60f3\u573a\u666f"},{"location":"2021-05-01-Python%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%97%ADExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86/#_2","text":"\u4e3b\u7a0b\u5e8f\u4e2d\u4e0d\u53ef\u80fd\u76f4\u63a5\u5904\u7406\u6216\u8005\u7ed5\u8fc7\u6b64\u7c7b\u95ee\u9898\uff0c\u4e5f\u4e0d\u80fd\u5962\u671b\u6709\u4eba\u968f\u65f6\u8e72\u5b88\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u2014\u2014\u90a3\u5c31\u65b0\u5f00\u4e00\u4e2a\u7ebf\u7a0b\u6765\u575a\u5b88\u5427\u3002\u56e0\u6b64\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u5229\u7528\u5b50\u7ebf\u7a0b\u76d1\u542c\u5e76\u968f\u65f6\u5173\u95ed\u5f39\u7a97\uff0c\u76f4\u5230\u4e3b\u7a0b\u5e8f\u5706\u6ee1\u7ed3\u675f\u3002 Excel\u5f39\u7a97\u9ed8\u8ba4\u7684\u6807\u9898\u662f Microsoft Excel \uff0c\u63a5\u4e0b\u6765\u4ee5\u6b64\u4e3a\u4f8b\u6355\u6349\u7a97\u53e3\u5e76\u70b9\u51fb\u6309\u94ae\u3002","title":"\u57fa\u672c\u601d\u8def"},{"location":"2021-05-01-Python%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%97%ADExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86/#pywinauto","text":"pywinauto \u987e\u540d\u601d\u4e49\u662fWindows\u754c\u9762\u81ea\u52a8\u5316\u5e93\uff0c\u6a21\u62df\u9f20\u6807\u548c\u952e\u76d8\u64cd\u4f5c\u7a97\u4f53\u548c\u63a7\u4ef6 3 \u3002\u4e0d\u540c\u4e8e\u5148\u83b7\u53d6\u53e5\u67c4\u518d\u83b7\u53d6\u5c5e\u6027\u7684\u4f20\u7edf\u65b9\u5f0f\uff0c pywinauto \u7684API\u66f4\u52a0\u53cb\u597d\u548cpythonic\u3002\u4f8b\u5982\uff0c\u4e24\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7a97\u53e3\u6355\u6349\u548c\u70b9\u51fb\uff1a win = Application(backend=\"win32\").connect(title='Microsoft Excel') win.Dialog.Button.click() \u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ebf\u7a0b\u7c7b\u6267\u884c\u4ee5\u4e0a\u64cd\u4f5c\uff1a # listener_pywinauto.py import time from threading import Thread, Event from pywinauto.application import Application class MsgBoxListener(Thread): def __init__(self, title:str, interval:int): Thread.__init__(self) self._title = title self._interval = interval self._stop_event = Event() def stop(self): self._stop_event.set() @property def is_running(self): return not self._stop_event.is_set() def run(self): while self.is_running: try: time.sleep(self._interval) self._close_msgbox() except Exception as e: print(e, flush=True) def _close_msgbox(self): '''Close the default Excel MsgBox with title \"Microsoft Excel\".''' win = Application(backend=\"win32\").connect(title=self._title) win.Dialog.Button.click() if __name__=='__main__': t = MsgBoxListener('Microsoft Excel', 1) t.start() time.sleep(10) t.stop() \u6700\u7ec8\uff0c\u5728\u5f00\u59cb\u4e3b\u8981\u64cd\u4f5c\u524d\u542f\u52a8\u5b50\u7ebf\u7a0b\uff0c\u5e76\u5728\u7ed3\u675f\u540e\u5173\u95ed\uff1a import xlwings as xw from listener_pywinauto import MsgBoxListener # start listen thread listener = MsgBoxListener('Microsoft Excel', 3) listener.start() # main process wb = xw.Book('test.xlsm') msg = wb.sheets('Sheet1').range('A1').value print(msg) wb.close() # stop listener thread listener.stop() \u5230\u6b64\u95ee\u9898\u57fa\u672c\u89e3\u51b3\uff0c\u672c\u5730\u8fd0\u884c\u6548\u679c\u5b8c\u5168\u8fbe\u5230\u9884\u671f\u3002\u4f46\u6211\u7684\u771f\u5b9e\u9700\u6c42\u662f\u4ee5\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u5728\u670d\u52a1\u5668\u4e0a\u8fdb\u884cExcel\u6587\u4ef6\u81ea\u52a8\u5316\u6d4b\u8bd5\uff0c\u540e\u7eed\u53d1\u73b0\uff0c\u5f53\u4ee5\u7cfb\u7edf\u670d\u52a1\u65b9\u5f0f\u8fd0\u884c\u65f6\uff0c pywinauto \u7adf\u7136\u6355\u6349\u4e0d\u5230\u5f39\u7a97\uff01\u8fd9\u6216\u8bb8\u662f pywinauto \u4e00\u4e2a\u6f5c\u5728\u7684\u95ee\u9898 4 \u3002","title":"pywinauto\u65b9\u6848"},{"location":"2021-05-01-Python%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%85%B3%E9%97%ADExcel%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86/#win32gui","text":"\u90a3\u5c31\u53ea\u597d\u8f6c\u5411\u76f8\u5bf9\u5e95\u5c42\u7684 win32gui \uff08\u5b9e\u9645\u662f pywin32 \u5e93\u7684\u4e00\u90e8\u5206\uff09\uff0c\u6240\u5e78\u89e3\u51b3\u4e86\u4e0a\u8ff0\u95ee\u9898\u3002 # pip install pywin32 import win32gui import win32con \u4ee5\u4e0b\u4ec5\u5217\u51fa MsgBoxListener \u7c7b\u4e2d\u5173\u952e\u64cd\u4f5c\uff0c\u5176\u4f59\u4ee3\u7801\u5b8c\u5168\u4e00\u81f4\uff1a def _close_msgbox(self): # find the top window by title hwnd = win32gui.FindWindow(None, self._title) if not hwnd: return # find child button h_btn = win32gui.FindWindowEx(hwnd, None,'Button', None) if not h_btn: return # show text text = win32gui.GetWindowText(h_btn) print(text) # click button win32gui.PostMessage(h_btn, win32con.WM_LBUTTONDOWN, None, None) time.sleep(0.2) win32gui.PostMessage(h_btn, win32con.WM_LBUTTONUP, None, None) time.sleep(0.2) \u518d\u8fdb\u4e00\u6b65\uff0c\u539fVBA\u4ee3\u7801\u53ef\u80fd\u4e0d\u662f\u91c7\u7528\u9ed8\u8ba4\u7684\u5f39\u7a97\u6807\u9898\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u80fd\u4ec5\u6839\u636e\u6807\u9898\u8fdb\u884c\u6355\u6349\u3002\u90a3\u5c31\u6269\u5927\u5316\u8303\u56f4\uff0c\u5c1d\u8bd5\u70b9\u51fb\u4efb\u4f55\u5305\u542b\u786e\u5b9a\u6027\u6309\u94ae\uff08\u4f8b\u5982OK\uff0cYes\uff0cConfirm\uff09\u7684\u7a97\u53e3\u3002 def _close_msgbox(self): '''Click button to close message box if has text \"OK\", \"Yes\" or \"Confirm\".''' # Get handles of all top wondows h_windows = [] win32gui.EnumWindows(lambda hWnd, param: param.append(hWnd), h_windows) for h_window in h_windows: # Get child button with text OK, Yes or Confirm of given window. h_btn = win32gui.FindWindowEx(h_window, None,'Button', None) if not h_btn: continue # check button text text = win32gui.GetWindowText(h_btn) if not text.lower() in ('ok', 'yes', 'confirm'): continue # click button win32gui.PostMessage(h_btn, win32con.WM_LBUTTONDOWN, None, None) time.sleep(0.2) win32gui.PostMessage(h_btn, win32con.WM_LBUTTONUP, None, None) time.sleep(0.2) Handling VBA popup message boxes in Microsoft Excel \u21a9 Trying to catch MsgBox text and press button in xlwings \u21a9 What is pywinauto \u21a9 Remote Execution Guide \u21a9","title":"win32gui\u65b9\u6848"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/","text":"Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-05-09 | \u5206\u7c7b\uff1a devops Jenkins\u662fCI/CD\u94fe\u6761\u4e2d\u8fde\u63a5\u4e0a\u6e38\u7248\u672c\u7ba1\u7406\u548c\u4e0b\u6e38\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u7684\u91cd\u8981\u4e00\u73af\u3002\u5373\u4fbf\u7248\u672c\u7ba1\u7406\u4e0eCI/CD\u65e5\u8d8b\u878d\u5408\u7684\u4eca\u5929\uff0c\u4f8b\u5982GitLab CI\u3001GitHub Action\u7684\u5174\u8d77\uff0cJenkins\u4ee5\u5176\u5148\u53d1\u4f18\u52bf\u548c\u5f3a\u5927\u6269\u5c55\u6027\u4ecd\u65e7\u805a\u96c6\u4e86\u5927\u91cf\u7528\u6237\u3002\u672c\u6587\u5728\u53c2\u6570\u5316\u6784\u5efa\u7684\u524d\u63d0\u4e0b\uff0c\u5faa\u5e8f\u6e10\u8fdb\u5730\u4ecb\u7ecd\u4f7f\u7528Jenkins\u521b\u5efa Freestyle \u3001 Pipeline \u53ca Multibranch Pipeline \u9879\u76ee\u7684\u8981\u70b9\u3002 \u53c2\u6570\u5316\u6784\u5efa \u00b6 \u4f5c\u4e3a\u5165\u95e8\uff0c\u6211\u4eec\u9009\u62e9\u5728Jenkins\u9875\u9762\u4e0a\u624b\u52a8\u6267\u884c/\u6784\u5efa/build\u9879\u76ee\uff1b\u4e00\u4e2a\u4ed3\u5e93\u901a\u5e38\u5305\u542b\u591a\u4e2a\u5206\u652f\uff0c\u90a3\u4e48\u80fd\u5426\u5728\u540c\u4e00\u4e2a\u9879\u76ee\u4e2d\u6839\u636e\u9700\u8981\u9009\u62e9\u6027\u6784\u5efa\u67d0\u4e2a\u5206\u652f\u5462\uff1f\u8fd9\u5c31\u662f\u53c2\u6570\u5316\u6784\u5efa\uff0c\u5728\u5f00\u59cb\u6784\u5efa\u4e4b\u524d\u6307\u5b9a\u67d0\u4e2a\u53c2\u6570\u3002\u8bbe\u7f6e\u65b9\u5f0f\uff1a General -> This project is parameterized \u8fd9\u91cc\u6211\u4eec\u5173\u5fc3\u7684\u53c2\u6570\u662f\u5206\u652f\u540d\u79f0\u3002\u6570\u636e\u6765\u6e90\u5f62\u5f0f\u6709\u5f88\u591a\uff0c\u4f8b\u5982\u624b\u52a8\u6307\u5b9a\u9ed8\u8ba4\u7684\u9009\u9879\uff08master, alpha, beta\u7b49\uff09\uff0c\u4f46\u66f4\u597d\u7684\u65b9\u5f0f\u662f\u76f4\u63a5\u4ece\u4ed3\u5e93\u4e2d\u8bfb\u53d6\u3002\u8fd9\u5c31\u9700\u8981Git Parameter\u63d2\u4ef6\u7684\u652f\u6301\u3002\u5b89\u88c5\u63d2\u4ef6\u540e\uff0c\u5728\u9879\u76ee\u914d\u7f6e\u9875\u5f00\u542f\u53c2\u6570\u5316\u6784\u5efa\uff0c\u9009\u62e9Git Parameter\uff0c\u5e76\u914d\u7f6e\u5982\u4e0b\u5177\u4f53\u5185\u5bb9\uff08\u4ec5\u5217\u51fa\u5173\u952e\u9879\uff09\uff1a Name \u53c2\u6570\u540d\u79f0\uff0c\u672c\u6587\u4ee5 BRANCH_TAG \u4e3a\u4f8b\uff0c\u5219\u540e\u7eed\u5176\u4ed6\u5730\u65b9\u53ef\u4ee5\u5f15\u7528 ${BRANCH_TAG} Parameter Type \u9009\u62e9 Branch or Tag \u8868\u793a\u540c\u65f6\u5173\u5fc3\u5206\u652f\u540d\u548c\u6807\u7b7e Default Value \u9ed8\u8ba4\u5206\u652f\u540d\uff0c\u4f8b\u5982 master Branch Filter \u586b\u5199 origin/(.*) \uff0c\u5b8c\u6574\u7684\u5206\u652f\u540d\u901a\u5e38\u662f origin/xxx \uff0c\u56e0\u6b64\u9700\u8981\u63d0\u53d6\u51fa\u540d\u5b57\u672c\u8eab xxx \u8fd9\u4e00\u6b65\u8bbe\u7f6e\u7684\u6548\u679c\u662fJenkins UI\u4e0a\u7684\u6784\u5efa\u6309\u94ae\u4ece Build Now \u53d8\u6210\u4e86 Build with Parameters \uff0c\u5373\u9700\u8981\u6307\u5b9a\u53c2\u6570\u540e\u624d\u80fd\u7ee7\u7eed\uff1b\u5e76\u4e14\u81ea\u52a8\u5217\u51fa\u4e86\u4ed3\u5e93\u4e2d\u7684\u6240\u6709\u5206\u652f\u548c\u6807\u7b7e\u3002 Freestyle\u9879\u76ee \u00b6 \u6700\u57fa\u7840\u3001\u7075\u6d3b\u7684\u914d\u7f6e\u65b9\u5f0f\uff0c\u53ef\u4ee5\u914d\u7f6e\u4ee5\u4e0b\u516d\u4e2a\u65b9\u9762\uff1a General \u57fa\u672c\u8bbe\u7f6e\uff0c\u5982\u662f\u5426\u53c2\u6570\u5316\u6784\u5efa\u3001\u662f\u5426\u6307\u5b9a\u8282\u70b9\u6267\u884c\u6b64\u9879\u76ee\u3002 \u5982\u4e0a\u4e00\u8282\u63cf\u8ff0\u8fdb\u884c\u53c2\u6570\u5316\u6784\u5efa\u8bbe\u7f6e\uff0c\u53c2\u6570\u540d BRANCH_TAG Source Code Management \u6307\u5b9a\u6e90\u7801 git\u4ed3\u5e93\u5730\u5740\u3001\u767b\u9646\u51ed\u8bc1\u3001\u5206\u652f\u540d\u79f0\uff0c\u5176\u4e2d\u5206\u652f\u540d\u79f0\u4f7f\u7528 ${BRANCH_TAG} \uff0c\u4ee5\u4fbf\u8fdb\u884c\u53c2\u6570\u5316\u6784\u5efa \u5f53\u7136\u4e5f\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5373\u4e0d\u9488\u5bf9\u6e90\u7801\u7684\u6784\u5efa Build Triggers \u89e6\u53d1\u81ea\u52a8\u6784\u5efa\u7684\u65b9\u5f0f\u4f8b\u5982\u8f6e\u8be2\u4ed3\u5e93\u3001\u4ed3\u5e93\u7684Push\u64cd\u4f5c\u7b49\u3002\u672c\u6587\u624b\u52a8\u89e6\u53d1\uff0c\u6545\u7565\u8fc7\u3002 Build Environment \u7565\u8fc7 Build \u6784\u5efa\u65b9\u5f0f\u4f8b\u5982\u6267\u884cshell\u6216\u8005batch\u811a\u672c\u3002 Post-build Actions \u6784\u5efa\u5b8c\u6210\u540e\u7684\u64cd\u4f5c\u4f8b\u5982\u751f\u6210\u62a5\u544a\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\u3002 Freestyle\u9879\u76ee\u601d\u8def\u6e05\u6670\u7b80\u5355\uff0c\u4f46\u6d89\u53ca\u6574\u4e2a\u6784\u5efa\u5468\u671f\u7684\u65b9\u65b9\u9762\u9762\uff1b\u4ee5\u6700\u5927\u7075\u6d3b\u5ea6\u624b\u52a8\u914d\u7f6e\u4e0a\u4e0b\u6e38\uff0c\u800c\u6838\u5fc3\u6784\u5efa\u8fc7\u7a0b\u7531\u811a\u672c\u5b8c\u6210\u3002\u8003\u8651\u5230\u5b9e\u9645\u5e94\u7528\u4e2dBuild\u90e8\u5206\u6d89\u53ca\u591a\u4e2a\u9636\u6bb5\uff0c\u4f8b\u5982\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u53d1\u5e03\u7b49\uff0c\u4e00\u6574\u6bb5\u811a\u672c\u7684\u65b9\u5f0f\u53ef\u80fd\u4e0d\u591f\u660e\u6670\u548c\u7075\u6d3b\uff0c\u8fd9\u5c31\u5f15\u51fa\u4e86\u4e0b\u9762\u7684 Pipeline \u9879\u76ee\u3002 Pipeline\u9879\u76ee \u00b6 Pipeline\u9879\u76ee\u5c06Freestyle\u9879\u76ee\u4e2d\u7684\u8bb8\u591a\u624b\u52a8\u8bbe\u7f6e\u65b9\u5f0f\u6539\u4e3a\u914d\u7f6e\u6587\u4ef6 Jenkinsfile \uff0c\u5e76\u4e14\u6700\u5927\u7684\u4eae\u70b9\u5728\u4e8e\u4ee5\u5206\u9636\u6bb5\u7684\u65b9\u5f0f\u7ba1\u7406\u6574\u4e2a\u6784\u5efa\u6d41\u7a0b\uff0c\u6545\u800c\u79f0\u4e3a Pipeline \u9879\u76ee\u3002\u9700\u8981\u914d\u7f6e\u7684\u65b9\u9762\u4e5f\u4ece6\u4e2a\u51cf\u4e3a3\u4e2a\uff1a General \u540c\u4e0a\uff0c\u5f00\u542fGit Parameter\u53c2\u6570\u5316\u6784\u5efa\u3002 Build Triggers \u540c\u4e0a\uff0c\u7565\u8fc7\u3002 Advanced Project Options \u6307\u5b9a\u6784\u5efa\u8fc7\u7a0b\u7684\u9879\u76ee\u663e\u793a\u540d\u79f0\uff0c\u9ed8\u8ba4\u5373\u4e3a\u9879\u76ee\u540d\u3002\u4ec5\u4e3a\u663e\u793a\u6548\u679c\uff0c\u6545\u6ca1\u7b97\u505a\u4e00\u4e2a\u914d\u7f6e\u65b9\u9762\u3002 Pipeline \u6307\u5b9a Jenkinsfile \u2014\u2014\u9075\u5b88Jenkins Pipeline\u8bed\u6cd5\u89c4\u5219\u7684\u811a\u672c\u3002 \u4e00\u4e2a\u660e\u663e\u7684\u95ee\u9898\uff0c\u5982\u4f55\u6307\u5b9a\u6e90\u7801\u4ed3\u5e93\uff1f\u5982\u4e0a\u6240\u8ff0\uff0c\u7531\u624b\u52a8\u6307\u5b9a\u6539\u4e3a\u7531Pipeline\u6307\u5b9a\u3002\u4e24\u79cd\u65b9\u5f0f\u6307\u5b9aPipeline\uff1a Pipeline script \uff1a\u76f4\u63a5\u5728Jenkins\u9875\u9762\u4e0a\u8f93\u5165Pipeline\u811a\u672c\uff0c\u672c\u6587\u79f0\u4f5cUI\u6258\u7ba1\u7684Jenkinsfile Pipeline script from SCM \uff1aPipeline\u811a\u672c\u968f\u6e90\u7801\u4e00\u540c\u7ba1\u7406\uff0c\u672c\u6587\u79f0\u4f5c\u6e90\u7801\u6258\u7ba1\u7684Jenkinsfile 1. UI\u6258\u7ba1\u7684Jenkinsfile \u00b6 \u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff0c\u57fa\u672c\u8bed\u6cd5\u53c2\u8003\u5b98\u7f51\u6587\u6863\u3002 \u7b2c\u4e00\u6b65\u5f97\u6307\u5b9a\u6e90\u7801\u4ed3\u5e93\uff0c\u4e8e\u662f\u6709\u4e86 stage('Checkout') \u8fd9\u4e2a\u9636\u6bb5\u3002 \u8fd9\u90e8\u5206\u811a\u672c\u53ef\u501f\u52a9Snippet Generator\u81ea\u52a8\u751f\u6210\uff08\u6a21\u677f\uff1acheckout: Checkout from version control\uff09\u3002 Checkout \u4e2d\u5206\u652f\u540d\u79f0 branches \u5fc5\u987b\u8ddf\u968f\u53c2\u6570\u53d8\u5316\uff0c\u56e0\u6b64\u9700\u8981 parameters \u90e8\u5206\u5b9a\u4e49\u53c2\u6570 BRANCH_TAG \u3002 \u8fd9\u90e8\u5206\u811a\u672c\u53ef\u501f\u52a9Snippet Generator\u81ea\u52a8\u751f\u6210\uff08\u6a21\u677f\uff1aproperties: Set job properties\uff09\u3002 stage('Init') \u90e8\u5206\u662f\u4e00\u4e2a\u5e94\u7528\u793a\u4f8b\uff0c\u6839\u636e BRANCH_TAG \u53c2\u6570\u5b9a\u4e49\u4e24\u4e2a\u73af\u5883\u53d8\u91cf BRANCH \u548c TAG \uff0c\u5206\u522b\u4ee3\u8868\u5f53\u524d\u6784\u5efa\u7684\u662f\u5206\u652f\u8fd8\u662f\u6807\u7b7e\uff0c\u4ee5\u4fbf\u540e\u7eed\u6709\u9488\u5bf9\u6027\u7684\u64cd\u4f5c\u3002 \u6ce8\u610f BRANCH_NAME \u867d\u7136\u662fJenkins\u5185\u7f6e\u7684\u8868\u793a\u5206\u652f\u540d\u79f0\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f46\u662f\u4ec5\u5728\u591a\u5206\u652f\u7684 Pipeline \u9879\u76ee\u6709\u6548\u3002 stage('Build') \u662f\u53e6\u4e00\u4e2a\u793a\u4f8b\uff0c\u793a\u610fWindows\u4e0a\u901a\u8fc7\u9ed8\u8ba4\u7684cmd\u548cgit batch\u6267\u884cshell\u547d\u4ee4\u7684\u65b9\u5f0f \u6267\u884c\u8282\u70b9 win_agent \u662fWindows\u673a\u5668\uff0c\u6240\u4ee5\u7528 bat \u6267\u884ccmd\u547d\u4ee4 \u5b9e\u9645\u9700\u8981\u6267\u884cshell\u547d\u4ee4\uff0c\u6240\u4ee5\u9700\u8981 sh \uff08Git_Home\\bin\\sh.exe\uff09\u6267\u884c\uff0c\u5e76\u7528 -c \u6307\u5b9a\u6267\u884c\u547d\u4ee4\u7684\u6587\u672c pipeline { agent {label 'win_agent'} parameters { gitParameter name: 'BRANCH_TAG', type: 'PT_BRANCH_TAG', branchFilter: 'origin/(.*)', tagFilter: '*', defaultValue: 'master', selectedValue: 'DEFAULT', sortMode: 'DESCENDING_SMART', description: 'Select branch/tag to build...' } stages { stage('Checkout') { steps { echo 'Checkout git repo..' checkout([$class: 'GitSCM', branches: [[name: \"${params.BRANCH_TAG}\"]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[ credentialsId: 'bd3cxxxxxxx', url: 'git@gitlab-url/group/name.git']] ]) } } stage('Init') { steps { script { if (params.BRANCH_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+).*/) { env.BRANCH = params.BRANCH_TAG env.TAG = params.BRANCH_TAG } else { env.BRANCH = params.BRANCH_TAG env.TAG = \"\" } } } } stage('Build') { steps { bat \"sh -c 'make build'\" } } stage('Test') { steps { bat \"sh -c 'make test'\" } } stage('Deploy') { steps { bat \"sh -c 'make deploy'\" } } } } 2. \u6e90\u7801\u6258\u7ba1\u7684Jenkinsfile \u00b6 \u4e3a\u4fbf\u4e8e\u7ef4\u62a4\uff0c\u901a\u5e38\u5c06\u4ee5\u4e0aPipeline\u811a\u672c\u548c\u6e90\u7801\u653e\u4e00\u8d77\u7ba1\u7406\uff0c\u8fd9\u5c31\u5bf9\u5e94\u5b9a\u4e49Pipeline\u7684\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u4ece\u4e0b\u62c9\u6846\u9009\u62e9 Pipeline script from SCM \uff0c\u7136\u540e\u6307\u5b9a\u6e90\u4ed3\u5e93\u7684\u4fe1\u606f\uff0c\u7c7b\u4f3c\u4e8eFreestyle\u9879\u76ee\u6307\u5b9a\u4ed3\u5e93\u7684\u65b9\u5f0f\uff1a \u4ed3\u5e93\u5730\u5740\u548c\u767b\u9646\u51ed\u8bc1 \u5206\u652f\u540d\u79f0\uff0c\u914d\u5408\u53c2\u6570\u5316\u6784\u5efa\uff0c\u8f93\u5165 ${BRANCH_TAG} \u6ce8\u610f \u5b9e\u9645\u4e0a\u8fd9\u79cd\u4f20\u5165\u53c2\u6570\u7684\u65b9\u5f0f\u4ec5\u9002\u7528\u4e8eFreestyle\u9879\u76ee\uff0c\u6240\u4ee5\u6b64\u5904 ${BRANCH_TAG} \u5e76\u4e0d\u4f1a\u88ab\u89e3\u6790\u4e3a\u5177\u4f53\u540d\u79f0\uff0c\u800c\u662f\u539f\u5c01\u4e0d\u52a8\u4f5c\u4e3agit\u5206\u652f\u540d\u79f0\uff0c\u5bfc\u81f4Checkout\u4ed3\u5e93\u5931\u8d25\u3002\u4e00\u4e2a\u89e3\u51b3\u65b9\u5f0f\u662f\u53d6\u6d88\u52fe\u9009\u6700\u540e\u7684 Lightweight checkout \u3002 Pipeline\u811a\u672c\u76f8\u5bf9\u4ed3\u5e93\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u8fd9\u662f\u65b0\u589e\u7684\u90e8\u5206 \u6700\u7ec8\uff0c\u5220\u9664\u4e0a\u4e00\u6bb5Jenkinsfile\u4e2d stage('Checkout') \u90e8\u5206\u5373\u53ef\u76f4\u63a5\u5b58\u5165\u4ed3\u5e93\u4f7f\u7528\u3002 \u591a\u5206\u652fPipeline\u9879\u76ee \u00b6 \u501f\u52a9Git Parameter\u7684\u53c2\u6570\u5316\u6784\u5efa\u65b9\u5f0f\u8fd8\u662f\u6709\u4e9b\u7e41\u7410\uff0c\u6240\u4ee5Jenkins\u76f4\u63a5\u5185\u7f6e\u4e86\u591a\u5206\u652f Pipeline \u9879\u76ee\uff0c\u914d\u7f6e\u6e90\u7801\u4ed3\u5e93\u540e\uff0cJenkins\u81ea\u52a8\u4e3a\u6bcf\u4e00\u4e2a\u5e26\u6709Jenkinsfile\u7684\u5206\u652f/\u6807\u7b7e\u521b\u5efa\u5b50\u9879\u76ee\uff0c\u6700\u7ec8\u5f62\u6210 project_name/branch_name \u4e24\u7ea7\u9879\u76ee\u7684\u7ed3\u6784\u3002 \u591a\u5206\u652fPipeline\u9879\u76ee\u914d\u7f6e\u9009\u9879\u7565\u591a\uff0c\u4f5c\u4e3a\u5165\u95e8\u914d\u7f6e\u53ea\u9700\u8003\u8651\u4ee5\u4e0b\u4e24\u65b9\u9762\uff1a Branch Sources \u6307\u5b9a\u5206\u652f\u6765\u6e90 \u6e90\u7801\u4ed3\u5e93\u548c\u767b\u9646\u51ed\u8bc1 Behavious \u9009\u62e9 Discover branches \u548c Discover tags \uff0c\u8868\u793a\u540c\u65f6\u8003\u8651\u5206\u652f\u548c\u6807\u7b7e Build Configuration \u6307\u5b9aJenkinsfile\u5728\u4ed3\u5e93\u4e2d\u7684\u8def\u5f84 \u6ce8\u610f\uff0c\u6211\u4eec\u4e0d\u518d\u4f7f\u7528\u524d\u9762\u7684\u53c2\u6570\u5316\u6784\u5efa\uff0c\u4e14 BRANCH_NAME \u5bf9\u591a\u5206\u652fPipeline\u9879\u76ee\u751f\u6548\u4e86\uff0c\u6545Pipeline\u811a\u672c\u505a\u76f8\u5e94\u7684\u7b80\u5316\uff1a \u65e0\u9700 parameters \u65e0\u9700 stage('Checkout') \u76f4\u63a5\u4f7f\u7528 BRANCH_NAME \u548c TAG_NAME pipeline { agent {label 'win_agent'} stages { stage('Init') { steps { script { if (env.TAG_NAME == null) { env.BRANCH = env.BRANCH_NAME env.TAG = \"\" } else { env.BRANCH = env.TAG_NAME env.TAG = env.TAG_NAME } } } } stage('Build') { steps { bat \"sh -c 'make build'\" } } stage('Test') { steps { bat \"sh -c 'make test'\" } } stage('Deploy') { steps { bat \"sh -c 'make deploy'\" } } } } \u6700\u7ec8\u7ed3\u679c","title":"Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#jenkins","text":"\u53d1\u5e03\u4e8e\uff1a2021-05-09 | \u5206\u7c7b\uff1a devops Jenkins\u662fCI/CD\u94fe\u6761\u4e2d\u8fde\u63a5\u4e0a\u6e38\u7248\u672c\u7ba1\u7406\u548c\u4e0b\u6e38\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u7684\u91cd\u8981\u4e00\u73af\u3002\u5373\u4fbf\u7248\u672c\u7ba1\u7406\u4e0eCI/CD\u65e5\u8d8b\u878d\u5408\u7684\u4eca\u5929\uff0c\u4f8b\u5982GitLab CI\u3001GitHub Action\u7684\u5174\u8d77\uff0cJenkins\u4ee5\u5176\u5148\u53d1\u4f18\u52bf\u548c\u5f3a\u5927\u6269\u5c55\u6027\u4ecd\u65e7\u805a\u96c6\u4e86\u5927\u91cf\u7528\u6237\u3002\u672c\u6587\u5728\u53c2\u6570\u5316\u6784\u5efa\u7684\u524d\u63d0\u4e0b\uff0c\u5faa\u5e8f\u6e10\u8fdb\u5730\u4ecb\u7ecd\u4f7f\u7528Jenkins\u521b\u5efa Freestyle \u3001 Pipeline \u53ca Multibranch Pipeline \u9879\u76ee\u7684\u8981\u70b9\u3002","title":"Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#_1","text":"\u4f5c\u4e3a\u5165\u95e8\uff0c\u6211\u4eec\u9009\u62e9\u5728Jenkins\u9875\u9762\u4e0a\u624b\u52a8\u6267\u884c/\u6784\u5efa/build\u9879\u76ee\uff1b\u4e00\u4e2a\u4ed3\u5e93\u901a\u5e38\u5305\u542b\u591a\u4e2a\u5206\u652f\uff0c\u90a3\u4e48\u80fd\u5426\u5728\u540c\u4e00\u4e2a\u9879\u76ee\u4e2d\u6839\u636e\u9700\u8981\u9009\u62e9\u6027\u6784\u5efa\u67d0\u4e2a\u5206\u652f\u5462\uff1f\u8fd9\u5c31\u662f\u53c2\u6570\u5316\u6784\u5efa\uff0c\u5728\u5f00\u59cb\u6784\u5efa\u4e4b\u524d\u6307\u5b9a\u67d0\u4e2a\u53c2\u6570\u3002\u8bbe\u7f6e\u65b9\u5f0f\uff1a General -> This project is parameterized \u8fd9\u91cc\u6211\u4eec\u5173\u5fc3\u7684\u53c2\u6570\u662f\u5206\u652f\u540d\u79f0\u3002\u6570\u636e\u6765\u6e90\u5f62\u5f0f\u6709\u5f88\u591a\uff0c\u4f8b\u5982\u624b\u52a8\u6307\u5b9a\u9ed8\u8ba4\u7684\u9009\u9879\uff08master, alpha, beta\u7b49\uff09\uff0c\u4f46\u66f4\u597d\u7684\u65b9\u5f0f\u662f\u76f4\u63a5\u4ece\u4ed3\u5e93\u4e2d\u8bfb\u53d6\u3002\u8fd9\u5c31\u9700\u8981Git Parameter\u63d2\u4ef6\u7684\u652f\u6301\u3002\u5b89\u88c5\u63d2\u4ef6\u540e\uff0c\u5728\u9879\u76ee\u914d\u7f6e\u9875\u5f00\u542f\u53c2\u6570\u5316\u6784\u5efa\uff0c\u9009\u62e9Git Parameter\uff0c\u5e76\u914d\u7f6e\u5982\u4e0b\u5177\u4f53\u5185\u5bb9\uff08\u4ec5\u5217\u51fa\u5173\u952e\u9879\uff09\uff1a Name \u53c2\u6570\u540d\u79f0\uff0c\u672c\u6587\u4ee5 BRANCH_TAG \u4e3a\u4f8b\uff0c\u5219\u540e\u7eed\u5176\u4ed6\u5730\u65b9\u53ef\u4ee5\u5f15\u7528 ${BRANCH_TAG} Parameter Type \u9009\u62e9 Branch or Tag \u8868\u793a\u540c\u65f6\u5173\u5fc3\u5206\u652f\u540d\u548c\u6807\u7b7e Default Value \u9ed8\u8ba4\u5206\u652f\u540d\uff0c\u4f8b\u5982 master Branch Filter \u586b\u5199 origin/(.*) \uff0c\u5b8c\u6574\u7684\u5206\u652f\u540d\u901a\u5e38\u662f origin/xxx \uff0c\u56e0\u6b64\u9700\u8981\u63d0\u53d6\u51fa\u540d\u5b57\u672c\u8eab xxx \u8fd9\u4e00\u6b65\u8bbe\u7f6e\u7684\u6548\u679c\u662fJenkins UI\u4e0a\u7684\u6784\u5efa\u6309\u94ae\u4ece Build Now \u53d8\u6210\u4e86 Build with Parameters \uff0c\u5373\u9700\u8981\u6307\u5b9a\u53c2\u6570\u540e\u624d\u80fd\u7ee7\u7eed\uff1b\u5e76\u4e14\u81ea\u52a8\u5217\u51fa\u4e86\u4ed3\u5e93\u4e2d\u7684\u6240\u6709\u5206\u652f\u548c\u6807\u7b7e\u3002","title":"\u53c2\u6570\u5316\u6784\u5efa"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#freestyle","text":"\u6700\u57fa\u7840\u3001\u7075\u6d3b\u7684\u914d\u7f6e\u65b9\u5f0f\uff0c\u53ef\u4ee5\u914d\u7f6e\u4ee5\u4e0b\u516d\u4e2a\u65b9\u9762\uff1a General \u57fa\u672c\u8bbe\u7f6e\uff0c\u5982\u662f\u5426\u53c2\u6570\u5316\u6784\u5efa\u3001\u662f\u5426\u6307\u5b9a\u8282\u70b9\u6267\u884c\u6b64\u9879\u76ee\u3002 \u5982\u4e0a\u4e00\u8282\u63cf\u8ff0\u8fdb\u884c\u53c2\u6570\u5316\u6784\u5efa\u8bbe\u7f6e\uff0c\u53c2\u6570\u540d BRANCH_TAG Source Code Management \u6307\u5b9a\u6e90\u7801 git\u4ed3\u5e93\u5730\u5740\u3001\u767b\u9646\u51ed\u8bc1\u3001\u5206\u652f\u540d\u79f0\uff0c\u5176\u4e2d\u5206\u652f\u540d\u79f0\u4f7f\u7528 ${BRANCH_TAG} \uff0c\u4ee5\u4fbf\u8fdb\u884c\u53c2\u6570\u5316\u6784\u5efa \u5f53\u7136\u4e5f\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5373\u4e0d\u9488\u5bf9\u6e90\u7801\u7684\u6784\u5efa Build Triggers \u89e6\u53d1\u81ea\u52a8\u6784\u5efa\u7684\u65b9\u5f0f\u4f8b\u5982\u8f6e\u8be2\u4ed3\u5e93\u3001\u4ed3\u5e93\u7684Push\u64cd\u4f5c\u7b49\u3002\u672c\u6587\u624b\u52a8\u89e6\u53d1\uff0c\u6545\u7565\u8fc7\u3002 Build Environment \u7565\u8fc7 Build \u6784\u5efa\u65b9\u5f0f\u4f8b\u5982\u6267\u884cshell\u6216\u8005batch\u811a\u672c\u3002 Post-build Actions \u6784\u5efa\u5b8c\u6210\u540e\u7684\u64cd\u4f5c\u4f8b\u5982\u751f\u6210\u62a5\u544a\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\u3002 Freestyle\u9879\u76ee\u601d\u8def\u6e05\u6670\u7b80\u5355\uff0c\u4f46\u6d89\u53ca\u6574\u4e2a\u6784\u5efa\u5468\u671f\u7684\u65b9\u65b9\u9762\u9762\uff1b\u4ee5\u6700\u5927\u7075\u6d3b\u5ea6\u624b\u52a8\u914d\u7f6e\u4e0a\u4e0b\u6e38\uff0c\u800c\u6838\u5fc3\u6784\u5efa\u8fc7\u7a0b\u7531\u811a\u672c\u5b8c\u6210\u3002\u8003\u8651\u5230\u5b9e\u9645\u5e94\u7528\u4e2dBuild\u90e8\u5206\u6d89\u53ca\u591a\u4e2a\u9636\u6bb5\uff0c\u4f8b\u5982\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u53d1\u5e03\u7b49\uff0c\u4e00\u6574\u6bb5\u811a\u672c\u7684\u65b9\u5f0f\u53ef\u80fd\u4e0d\u591f\u660e\u6670\u548c\u7075\u6d3b\uff0c\u8fd9\u5c31\u5f15\u51fa\u4e86\u4e0b\u9762\u7684 Pipeline \u9879\u76ee\u3002","title":"Freestyle\u9879\u76ee"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#pipeline","text":"Pipeline\u9879\u76ee\u5c06Freestyle\u9879\u76ee\u4e2d\u7684\u8bb8\u591a\u624b\u52a8\u8bbe\u7f6e\u65b9\u5f0f\u6539\u4e3a\u914d\u7f6e\u6587\u4ef6 Jenkinsfile \uff0c\u5e76\u4e14\u6700\u5927\u7684\u4eae\u70b9\u5728\u4e8e\u4ee5\u5206\u9636\u6bb5\u7684\u65b9\u5f0f\u7ba1\u7406\u6574\u4e2a\u6784\u5efa\u6d41\u7a0b\uff0c\u6545\u800c\u79f0\u4e3a Pipeline \u9879\u76ee\u3002\u9700\u8981\u914d\u7f6e\u7684\u65b9\u9762\u4e5f\u4ece6\u4e2a\u51cf\u4e3a3\u4e2a\uff1a General \u540c\u4e0a\uff0c\u5f00\u542fGit Parameter\u53c2\u6570\u5316\u6784\u5efa\u3002 Build Triggers \u540c\u4e0a\uff0c\u7565\u8fc7\u3002 Advanced Project Options \u6307\u5b9a\u6784\u5efa\u8fc7\u7a0b\u7684\u9879\u76ee\u663e\u793a\u540d\u79f0\uff0c\u9ed8\u8ba4\u5373\u4e3a\u9879\u76ee\u540d\u3002\u4ec5\u4e3a\u663e\u793a\u6548\u679c\uff0c\u6545\u6ca1\u7b97\u505a\u4e00\u4e2a\u914d\u7f6e\u65b9\u9762\u3002 Pipeline \u6307\u5b9a Jenkinsfile \u2014\u2014\u9075\u5b88Jenkins Pipeline\u8bed\u6cd5\u89c4\u5219\u7684\u811a\u672c\u3002 \u4e00\u4e2a\u660e\u663e\u7684\u95ee\u9898\uff0c\u5982\u4f55\u6307\u5b9a\u6e90\u7801\u4ed3\u5e93\uff1f\u5982\u4e0a\u6240\u8ff0\uff0c\u7531\u624b\u52a8\u6307\u5b9a\u6539\u4e3a\u7531Pipeline\u6307\u5b9a\u3002\u4e24\u79cd\u65b9\u5f0f\u6307\u5b9aPipeline\uff1a Pipeline script \uff1a\u76f4\u63a5\u5728Jenkins\u9875\u9762\u4e0a\u8f93\u5165Pipeline\u811a\u672c\uff0c\u672c\u6587\u79f0\u4f5cUI\u6258\u7ba1\u7684Jenkinsfile Pipeline script from SCM \uff1aPipeline\u811a\u672c\u968f\u6e90\u7801\u4e00\u540c\u7ba1\u7406\uff0c\u672c\u6587\u79f0\u4f5c\u6e90\u7801\u6258\u7ba1\u7684Jenkinsfile","title":"Pipeline\u9879\u76ee"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#1 uijenkinsfile","text":"\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff0c\u57fa\u672c\u8bed\u6cd5\u53c2\u8003\u5b98\u7f51\u6587\u6863\u3002 \u7b2c\u4e00\u6b65\u5f97\u6307\u5b9a\u6e90\u7801\u4ed3\u5e93\uff0c\u4e8e\u662f\u6709\u4e86 stage('Checkout') \u8fd9\u4e2a\u9636\u6bb5\u3002 \u8fd9\u90e8\u5206\u811a\u672c\u53ef\u501f\u52a9Snippet Generator\u81ea\u52a8\u751f\u6210\uff08\u6a21\u677f\uff1acheckout: Checkout from version control\uff09\u3002 Checkout \u4e2d\u5206\u652f\u540d\u79f0 branches \u5fc5\u987b\u8ddf\u968f\u53c2\u6570\u53d8\u5316\uff0c\u56e0\u6b64\u9700\u8981 parameters \u90e8\u5206\u5b9a\u4e49\u53c2\u6570 BRANCH_TAG \u3002 \u8fd9\u90e8\u5206\u811a\u672c\u53ef\u501f\u52a9Snippet Generator\u81ea\u52a8\u751f\u6210\uff08\u6a21\u677f\uff1aproperties: Set job properties\uff09\u3002 stage('Init') \u90e8\u5206\u662f\u4e00\u4e2a\u5e94\u7528\u793a\u4f8b\uff0c\u6839\u636e BRANCH_TAG \u53c2\u6570\u5b9a\u4e49\u4e24\u4e2a\u73af\u5883\u53d8\u91cf BRANCH \u548c TAG \uff0c\u5206\u522b\u4ee3\u8868\u5f53\u524d\u6784\u5efa\u7684\u662f\u5206\u652f\u8fd8\u662f\u6807\u7b7e\uff0c\u4ee5\u4fbf\u540e\u7eed\u6709\u9488\u5bf9\u6027\u7684\u64cd\u4f5c\u3002 \u6ce8\u610f BRANCH_NAME \u867d\u7136\u662fJenkins\u5185\u7f6e\u7684\u8868\u793a\u5206\u652f\u540d\u79f0\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f46\u662f\u4ec5\u5728\u591a\u5206\u652f\u7684 Pipeline \u9879\u76ee\u6709\u6548\u3002 stage('Build') \u662f\u53e6\u4e00\u4e2a\u793a\u4f8b\uff0c\u793a\u610fWindows\u4e0a\u901a\u8fc7\u9ed8\u8ba4\u7684cmd\u548cgit batch\u6267\u884cshell\u547d\u4ee4\u7684\u65b9\u5f0f \u6267\u884c\u8282\u70b9 win_agent \u662fWindows\u673a\u5668\uff0c\u6240\u4ee5\u7528 bat \u6267\u884ccmd\u547d\u4ee4 \u5b9e\u9645\u9700\u8981\u6267\u884cshell\u547d\u4ee4\uff0c\u6240\u4ee5\u9700\u8981 sh \uff08Git_Home\\bin\\sh.exe\uff09\u6267\u884c\uff0c\u5e76\u7528 -c \u6307\u5b9a\u6267\u884c\u547d\u4ee4\u7684\u6587\u672c pipeline { agent {label 'win_agent'} parameters { gitParameter name: 'BRANCH_TAG', type: 'PT_BRANCH_TAG', branchFilter: 'origin/(.*)', tagFilter: '*', defaultValue: 'master', selectedValue: 'DEFAULT', sortMode: 'DESCENDING_SMART', description: 'Select branch/tag to build...' } stages { stage('Checkout') { steps { echo 'Checkout git repo..' checkout([$class: 'GitSCM', branches: [[name: \"${params.BRANCH_TAG}\"]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[ credentialsId: 'bd3cxxxxxxx', url: 'git@gitlab-url/group/name.git']] ]) } } stage('Init') { steps { script { if (params.BRANCH_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+).*/) { env.BRANCH = params.BRANCH_TAG env.TAG = params.BRANCH_TAG } else { env.BRANCH = params.BRANCH_TAG env.TAG = \"\" } } } } stage('Build') { steps { bat \"sh -c 'make build'\" } } stage('Test') { steps { bat \"sh -c 'make test'\" } } stage('Deploy') { steps { bat \"sh -c 'make deploy'\" } } } }","title":"1. UI\u6258\u7ba1\u7684Jenkinsfile"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#2 jenkinsfile","text":"\u4e3a\u4fbf\u4e8e\u7ef4\u62a4\uff0c\u901a\u5e38\u5c06\u4ee5\u4e0aPipeline\u811a\u672c\u548c\u6e90\u7801\u653e\u4e00\u8d77\u7ba1\u7406\uff0c\u8fd9\u5c31\u5bf9\u5e94\u5b9a\u4e49Pipeline\u7684\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u4ece\u4e0b\u62c9\u6846\u9009\u62e9 Pipeline script from SCM \uff0c\u7136\u540e\u6307\u5b9a\u6e90\u4ed3\u5e93\u7684\u4fe1\u606f\uff0c\u7c7b\u4f3c\u4e8eFreestyle\u9879\u76ee\u6307\u5b9a\u4ed3\u5e93\u7684\u65b9\u5f0f\uff1a \u4ed3\u5e93\u5730\u5740\u548c\u767b\u9646\u51ed\u8bc1 \u5206\u652f\u540d\u79f0\uff0c\u914d\u5408\u53c2\u6570\u5316\u6784\u5efa\uff0c\u8f93\u5165 ${BRANCH_TAG} \u6ce8\u610f \u5b9e\u9645\u4e0a\u8fd9\u79cd\u4f20\u5165\u53c2\u6570\u7684\u65b9\u5f0f\u4ec5\u9002\u7528\u4e8eFreestyle\u9879\u76ee\uff0c\u6240\u4ee5\u6b64\u5904 ${BRANCH_TAG} \u5e76\u4e0d\u4f1a\u88ab\u89e3\u6790\u4e3a\u5177\u4f53\u540d\u79f0\uff0c\u800c\u662f\u539f\u5c01\u4e0d\u52a8\u4f5c\u4e3agit\u5206\u652f\u540d\u79f0\uff0c\u5bfc\u81f4Checkout\u4ed3\u5e93\u5931\u8d25\u3002\u4e00\u4e2a\u89e3\u51b3\u65b9\u5f0f\u662f\u53d6\u6d88\u52fe\u9009\u6700\u540e\u7684 Lightweight checkout \u3002 Pipeline\u811a\u672c\u76f8\u5bf9\u4ed3\u5e93\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u8fd9\u662f\u65b0\u589e\u7684\u90e8\u5206 \u6700\u7ec8\uff0c\u5220\u9664\u4e0a\u4e00\u6bb5Jenkinsfile\u4e2d stage('Checkout') \u90e8\u5206\u5373\u53ef\u76f4\u63a5\u5b58\u5165\u4ed3\u5e93\u4f7f\u7528\u3002","title":"2. \u6e90\u7801\u6258\u7ba1\u7684Jenkinsfile"},{"location":"2021-05-09-Jenkins%E5%85%A5%E9%97%A8%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA/#pipeline_1","text":"\u501f\u52a9Git Parameter\u7684\u53c2\u6570\u5316\u6784\u5efa\u65b9\u5f0f\u8fd8\u662f\u6709\u4e9b\u7e41\u7410\uff0c\u6240\u4ee5Jenkins\u76f4\u63a5\u5185\u7f6e\u4e86\u591a\u5206\u652f Pipeline \u9879\u76ee\uff0c\u914d\u7f6e\u6e90\u7801\u4ed3\u5e93\u540e\uff0cJenkins\u81ea\u52a8\u4e3a\u6bcf\u4e00\u4e2a\u5e26\u6709Jenkinsfile\u7684\u5206\u652f/\u6807\u7b7e\u521b\u5efa\u5b50\u9879\u76ee\uff0c\u6700\u7ec8\u5f62\u6210 project_name/branch_name \u4e24\u7ea7\u9879\u76ee\u7684\u7ed3\u6784\u3002 \u591a\u5206\u652fPipeline\u9879\u76ee\u914d\u7f6e\u9009\u9879\u7565\u591a\uff0c\u4f5c\u4e3a\u5165\u95e8\u914d\u7f6e\u53ea\u9700\u8003\u8651\u4ee5\u4e0b\u4e24\u65b9\u9762\uff1a Branch Sources \u6307\u5b9a\u5206\u652f\u6765\u6e90 \u6e90\u7801\u4ed3\u5e93\u548c\u767b\u9646\u51ed\u8bc1 Behavious \u9009\u62e9 Discover branches \u548c Discover tags \uff0c\u8868\u793a\u540c\u65f6\u8003\u8651\u5206\u652f\u548c\u6807\u7b7e Build Configuration \u6307\u5b9aJenkinsfile\u5728\u4ed3\u5e93\u4e2d\u7684\u8def\u5f84 \u6ce8\u610f\uff0c\u6211\u4eec\u4e0d\u518d\u4f7f\u7528\u524d\u9762\u7684\u53c2\u6570\u5316\u6784\u5efa\uff0c\u4e14 BRANCH_NAME \u5bf9\u591a\u5206\u652fPipeline\u9879\u76ee\u751f\u6548\u4e86\uff0c\u6545Pipeline\u811a\u672c\u505a\u76f8\u5e94\u7684\u7b80\u5316\uff1a \u65e0\u9700 parameters \u65e0\u9700 stage('Checkout') \u76f4\u63a5\u4f7f\u7528 BRANCH_NAME \u548c TAG_NAME pipeline { agent {label 'win_agent'} stages { stage('Init') { steps { script { if (env.TAG_NAME == null) { env.BRANCH = env.BRANCH_NAME env.TAG = \"\" } else { env.BRANCH = env.TAG_NAME env.TAG = env.TAG_NAME } } } } stage('Build') { steps { bat \"sh -c 'make build'\" } } stage('Test') { steps { bat \"sh -c 'make test'\" } } stage('Deploy') { steps { bat \"sh -c 'make deploy'\" } } } } \u6700\u7ec8\u7ed3\u679c","title":"\u591a\u5206\u652fPipeline\u9879\u76ee"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-05-30 | \u5206\u7c7b\uff1a process automation \u524d\u6587 \u4ecb\u7ecd\u4e86\u4ecePDF\u76f4\u63a5\u63d0\u53d6\u51fa\u7684\u57fa\u672c\u6570\u636e\uff1a\u5757\u5143\u7d20 Block \u548c\u5f62\u72b6 Shape \uff0c\u4f46\u662f\u5b83\u4eec\u76ee\u524d\u8fd8\u53ea\u6709\u4f4d\u7f6e\u6570\u636e\uff0c\u63a5\u4e0b\u6765\u8981\u505a\u7684\u662f\u89e3\u6790\u8bed\u4e49\u6570\u636e\uff0c\u4f8b\u5982\u4ece\u5757\u5143\u7d20\u89e3\u6790\u51fa\u8868\u683c\u548c\u666e\u901a\u6bb5\u843d\uff0c\u4ece\u5f62\u72b6\u5143\u7d20\u89e3\u6790\u51fa\u6587\u672c\u6837\u5f0f\u4f8b\u5982\u4e0b\u5212\u7ebf\u3001\u9ad8\u4eae\u53ca\u5176\u4f5c\u7528\u7684\u6587\u672c\u3001\u89e3\u6790\u8868\u683c\u6837\u5f0f\u5982\u8fb9\u6846\u989c\u8272\u3001\u80cc\u666f\u8272\u53ca\u5176\u5305\u542b\u7684\u6bb5\u843d\u3002\u6211\u4eec\u5148\u4ece\u9875\u9762\u5e03\u5c40\u5f00\u59cb\u3002 \u6570\u636e\u7ed3\u6784 \u00b6 \u4e3a\u4e86\u66f4\u597d\u5730\u7ba1\u7406\u548c\u89e3\u6790 Block \u548c Shape \uff0c\u5e76\u4e14\u8003\u8651\u6700\u540e\u5728Word\u4e2d\u7684\u91cd\u5efa\uff0c\u8bbe\u8ba1 pdf2docx \u8f6c\u6362\u7c7b\u7684\u57fa\u672c\u7ed3\u6784\u5982\u4e0b\u3002\u5176\u4e2d\uff1a Page \u7c7b\u5bf9\u5e94\u7269\u7406\u4e0a\u7684\u4e00\u4e2a\u9875\u9762\uff0c\u5177\u6709\u5c3a\u5bf8\u3001\u8fb9\u8ddd\u3001\u9875\u7709\u9875\u811a\u7b49\u5c5e\u6027\uff0c\u4e3b\u8981\u5185\u5bb9\u6309\u7167\u6d41\u5f0f\u5e03\u5c40\u987a\u5e8f\u88ab\u5206\u4e3a\u4e00\u4e2a\u6216\u8005\u591a\u4e2a Section Section \u5bf9\u5e94Word\u7684\u8282\uff08Section\uff09\uff0c\u8868\u793a\u5177\u6709\u7c7b\u4f3c\u7ed3\u6784\u7684\u5e03\u5c40\uff0c\u4f8b\u5982\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5206\u680f Column Column \u5bf9\u5e94Word\u7684\u5206\u680f\uff08Column\uff09\uff0c\u8868\u793a\u5206\u680f\u4e2d\u7684\u4e00\u5217\u3002\u5bf9\u4e8e\u666e\u901a\u7684\u6392\u7248\uff0c\u5757\u5143\u7d20\u548c\u5f62\u72b6\u5143\u7d20\u90fd\u5728\u4e00\u4e2a Section \u7684\u4e00\u4e2a Column \u4e0b \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502pdf2docx Converter \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502Page-1 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2502Section-1 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 Column-1 \u2502 \u2502 Column-2 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 Section-2 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 Page-2 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u9875\u7709\u9875\u811a \u00b6 \u7406\u8bba\u4e0a\uff0c\u65e0\u6cd5\u4ece\u5355\u4e2a\u9875\u9762\u8bc6\u522b\u51fa\u9875\u7709\u548c\u9875\u811a\uff0c\u6240\u4ee5\u9700\u8981\u4ece\u6587\u6863\u7ea7\u522b\u5373\u591a\u4e2aPages\u4e00\u8d77\u5bf9\u6bd4\u7ed3\u6784\u76f8\u4f3c\u6027\uff0c\u4ece\u800c\u4ece\u9875\u9762\u5f00\u59cb\u90e8\u5206\u5206\u79bb\u51fa\u9875\u7709\u3001\u4ece\u9875\u9762\u7ed3\u675f\u90e8\u5206\u5206\u79bb\u51fa\u9875\u811a\u3002\u540c\u65f6\uff0c\u9700\u8981\u5904\u7406\u4e00\u4e9b\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u4f8b\u5982\u9875\u7801\u3001\u5947\u5076\u9875\u4e0d\u540c\u7684\u9875\u7709\u9875\u811a\u3002 \u622a\u81f3 v0.5.2 \uff0c\u8fd9\u90e8\u5206\u4f9d\u7136\u5360\u5751\u5f85\u5904\u7406\u4e2d\u3002 \u9875\u9762\u5927\u5c0f\u4e0e\u9875\u8fb9\u8ddd \u00b6 PyMuPDF \u63d0\u53d6\u7684\u6570\u636e\u76f4\u63a5\u5305\u62ec\u4e86\u9875\u9762\u5bbd\u5ea6\u548c\u9ad8\u5ea6\uff0c\u7136\u540e\u6839\u636e \u9664\u53bb\u9875\u7709\u9875\u811a\u540e \u7684\u6240\u6709\u5757\u7ea7\u3001\u5f62\u72b6\u5143\u7d20\u6240\u5360\u636e\u7684\u533a\u57df\u8ba1\u7b97\u9875\u8fb9\u8ddd\uff0c\u4f8b\u5982\u6700\u5c0f\u5de6\u4e0a\u89d2\u70b9\u786e\u5b9a\u4e86\u5de6\u8fb9\u8ddd\u548c\u4e0a\u8fb9\u8ddd\u3002 python-docx \u4e2d\u9875\u9762 section \u5bf9\u8c61\u6070\u597d\u63d0\u4f9b\u4e86\u8fd9\u516d\u4e2a\u5c5e\u6027\uff0c\u4f8b\u5982 page_width \u3001 left_margin \u3002\u4e8e\u662f\u9875\u9762\u57fa\u672c\u5f62\u5f0f\u5f97\u4ee5\u786e\u5b9a\u3002 \u5206\u680f \u00b6 \u65e9\u671f\u7248\u672c\u901a\u8fc7\u8868\u683c\u6765\u5b9e\u73b0\u5206\u680f\u5e03\u5c40\uff0c\u4ece0.5.2\u7248\u5f00\u59cb\u5f15\u5165 Section \u548c Column \uff0c\u4ee5\u4fdd\u8bc1\u9875\u9762\u903b\u8f91\u7684\u5408\u7406\u6027\uff0c\u540c\u65f6\u51cf\u5c11\u5d4c\u5957\u8868\u683c\u7684\u6cdb\u6ee5\u3002 \u6ce8\u610f \u4e3a\u517c\u987e\u901a\u7528\u6027\u548c\u964d\u4f4e\u590d\u6742\u5ea6\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5355\u680f\u6216\u8005\u4e24\u680f\u7684\u5e03\u5c40\uff0c\u66f4\u591a\u7684\u5206\u680f\u5c06\u88ab\u89e3\u6790\u4e3a\u8868\u683c\u3002 \u5206\u680f\u903b\u8f91 \u00b6 \u81ea\u4e0a\u800c\u4e0b\u68c0\u6d4b\u6bcf\u4e00\u884c\uff0c\u5c06\u8fde\u7eed\u7684\u5355\u5217\u6216\u8005\u53cc\u5217\u5f52\u4e3a\u540c\u4e00\u4e2a Section \uff0c\u5176\u4e2d\u6bcf\u4e00\u5217\u5373\u4e3a\u4e00\u4e2a Column \u3002\u540c\u65f6\uff0c\u6ce8\u610f\u4ee5\u4e0b\u7ec6\u8282\uff1a \u76ee\u524d\u6700\u591a\u8003\u8651\u4e24\u680f\uff0c\u6545\u5217\u6570\u5927\u4e8e2\u7684\u884c\u89c6\u4e3a\u5355\u680f \u5f53\u524d\u884c\u53ef\u4ee5\u5206\u4e3a\u4e24\u5217\u65f6\uff0c \u5f53\u5176\u4e2d\u4e00\u5217\u5bbd\u5ea6\u5f88\u5c0f\u4f8b\u5982\u5c0f\u4e8e5Pt\uff0c\u5219\u89c6\u4e3a\u5355\u680f\uff1b \u524d\u4e00\u4e2a Section \u4e5f\u662f\u4e24\u680f\uff0c\u4f46\u662f\u5404\u81ea\u7684\u680f\u5206\u9694\u7ebf\u4e0d\u91cd\u5408\uff0c\u5219\u5f53\u524d\u884c\u89c6\u4e3a\u5355\u680f \u5f53\u524d\u884c\u4ec5\u4e3a\u4e00\u5217\uff0c\u4e14\u524d\u4e00\u4e2a Section \u4e3a\u4e24\u680f\u65f6\uff0c \u5f53\u524d\u884c\u5b8c\u5168\u5904\u4e8e\u524d\u4e00\u4e2a Section \u7684\u5de6\u680f\uff0c\u5219\u5f53\u524d\u884c\u89c6\u4e3a\u4e24\u680f\uff08\u53f3\u680f\u4e3a\u7a7a\uff09\uff1b \u524d\u4e00\u4e2a Section \u9ad8\u5ea6\u8f83\u5c0f\u4f8b\u5982\u5c0f\u4e8e20Pt\uff0c\u5219\u524d\u4e00\u4e2a Section \u9000\u5316\u4e3a\u4e00\u680f \u7ad6\u76f4\u5b9a\u4f4d \u00b6 \u6bcf\u4e00\u4e2a Section \u5728\u9875\u9762\u7ad6\u76f4\u65b9\u5411\u7684\u4f4d\u7f6e \u7531\u524d\u4e00\u4e2a\u6bb5\u843d\u7684\u6bb5\u540e\u95f4\u8ddd \u786e\u5b9a\uff0c\u56e0\u6b64\u5728\u786e\u5b9a\u597d Section \u540e\uff0c\u8ba1\u7b97\u5f53\u524d Section \u5f00\u59cb\u4f4d\u7f6e y0 \u4e0e\u524d\u4e00\u4e2a Section \u7ed3\u675f\u4f4d\u7f6e y1 \u7684\u5dee\u503c\uff0c\u4f5c\u4e3a Section \u7684\u4e00\u4e2a\u5c5e\u6027 before_space \u3002 \u4f7f\u7528 python-docx \u91cd\u5efa Section \u65f6\uff0c\u8bbe\u7f6e\u524d\u4e00\u4e2a Section \u6700\u540e\u4e00\u4e2a\u6bb5\u843d\u7684\u6bb5\u540e\u8ddd\u79bb\u7b49\u4e8e\u5f53\u524d Section \u7684 before_space \u5373\u53ef\u3002\u4e24\u4e2a Column \u4e4b\u95f4\u8bbe\u7f6e\u5217\u5206\u9694\u7b26 WD_SECTION.NEW_COLUMN \u3002 \u6bcf\u4e00\u9875\u7b2c\u4e00\u4e2a Section \u7684\u5904\u7406 \u8ba1\u7b97 before_space \u65f6\uff0c\u524d\u4e00\u4e2a\u53c2\u8003\u4f4d\u7f6e\u4e3a\u9875\u9762\u4e0a\u8fb9\u8ddd\u3002 \u91cd\u5efa Section \u65f6\uff0c\u65b0\u5efa\u4e00\u4e2a\u7a7a\u6bb5\u843d\u4f5c\u4e3a\u8bbe\u7f6e\u6bb5\u540e\u95f4\u8ddd\u7684\u53c2\u8003\u3002 \u8868\u683c\u548c\u6bb5\u843d\u89e3\u6790 \u00b6 \u521b\u5efa Section \u540e\uff0c\u5c06\u539f\u59cb\u7684 Block \u548c Shape \u6309\u7167\u4f4d\u7f6e\u5173\u7cfb\u5206\u914d\u5230\u76f8\u5e94\u7684 Column \u4e2d\u53bb\uff0c\u4ee5\u4fbf\u8fdb\u4e00\u6b65\u89e3\u6790\u8868\u683c\u548c\u6bb5\u843d\u3002 Column \u662f\u4e00\u4e2a\u5e03\u5c40\u5bf9\u8c61\uff0c\u76f4\u63a5\u5bb9\u7eb3 Block \u548c Shape \uff0c\u6240\u4ee5 pdf2docx \u4e3a\u5176\u62bd\u8c61\u51fa\u4e00\u4e2a Layout \u7c7b\uff0c\u4fbf\u4e8e\u7ba1\u7406\u548c\u64cd\u4f5c\u3002 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502Layout \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502Blocks \u2502 \u2502Shapes \u2502 \u2502 \u2502 \u2502 TextBlock \u2502 \u2502 Stroke \u2502 \u2502 \u2502 \u2502 TableBlock\u2502 \u2502 Fill \u2502 \u2502 \u2502 \u2502 ... \u2502 \u2502 ... \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 PDF\u76f4\u63a5\u63d0\u53d6\u51fa\u7684\u5757\u5143\u7d20\u53ea\u6709 TextBlock \uff0c\u7ed3\u5408\u5f62\u72b6\u5143\u7d20\uff08\u6f5c\u5728\u7684\u8868\u683c\u8fb9\u6846\u3001\u5355\u5143\u683c\u80cc\u666f\u8272\uff09\u89e3\u6790\u51fa TableBlock \u540e\uff0c\u7ee7\u7eed\u6839\u636e\u4f4d\u7f6e\u5173\u7cfb\u5c06\u8868\u683c\u8303\u56f4\u5185\u7684 Block \u548c Shape \u5206\u914d\u5230\u76f8\u5e94\u7684\u5355\u5143\u683c\u4e2d\u53bb\u3002\u7531\u6b64\u53ef\u77e5\uff0c\u5bb9\u7eb3 Block \u548c Shape \u7684\u5355\u5143\u683c\u4e5f\u662f\u4e00\u4e2a Layout \u5bf9\u8c61\uff0c\u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u5355\u5143\u683c\u5185\u7684\u5d4c\u5957\u8868\u683c\u548c\u6bb5\u843d\u89e3\u6790\u3002\u8fd9\u6837\u7684\u8bbe\u8ba1\u786e\u4fdd\u53ef\u4ee5\u9012\u5f52\u89e3\u6790\u51fa\u65e0\u9650\u5d4c\u5957\u7684\u8868\u683c\uff0c\u540c\u65f6\u4e5f\u6709\u52a9\u4e8e\u5c06PDF\u7684\u6d6e\u52a8\u5e03\u5c40\u8f6c\u5316\u4e3a\u6d41\u52a8\u5e03\u5c40\uff0c\u4fbf\u4e8e\u5728Word\u4e2d\u91cd\u5efa\u3002 \u81f3\u4e8e\u8868\u683c\u7684\u5177\u4f53\u89e3\u6790\u65b9\u6cd5\uff0c\u5355\u5f00\u4e00\u7bc7\u8fdb\u884c\u5177\u4f53\u4ecb\u7ecd\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c \u6700\u540e\uff0c\u603b\u7ed3\u9875\u9762\u5e03\u5c40\u7ea7\u522b\u7684\u6570\u636e\u7ed3\u6784\u53ca\u57fa\u672c\u5c5e\u6027\u5982\u4e0b\uff1a # page -> section -> column { \"filename\": \"demo.pdf\", \"page_cnt\": 2, \"pages\": [ { \"id\": 0, \"width\": float, \"height\": float, \"margin\": [float, float, float, float], \"sections\": [ { \"bbox\": [float, float, float, float], \"cols\": int, \"space\": float, \"before_space\": float, \"columns\": [ { \"bbox\": [float, float, float, float], \"blocks\": [], \"shapes\": [] }, { # column 2 } ] }, { # section 2 } ], \"header\": str, \"footer\": str, \"floats\": [] }, { # page 2 } ] }","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2021-05-30 | \u5206\u7c7b\uff1a process automation \u524d\u6587 \u4ecb\u7ecd\u4e86\u4ecePDF\u76f4\u63a5\u63d0\u53d6\u51fa\u7684\u57fa\u672c\u6570\u636e\uff1a\u5757\u5143\u7d20 Block \u548c\u5f62\u72b6 Shape \uff0c\u4f46\u662f\u5b83\u4eec\u76ee\u524d\u8fd8\u53ea\u6709\u4f4d\u7f6e\u6570\u636e\uff0c\u63a5\u4e0b\u6765\u8981\u505a\u7684\u662f\u89e3\u6790\u8bed\u4e49\u6570\u636e\uff0c\u4f8b\u5982\u4ece\u5757\u5143\u7d20\u89e3\u6790\u51fa\u8868\u683c\u548c\u666e\u901a\u6bb5\u843d\uff0c\u4ece\u5f62\u72b6\u5143\u7d20\u89e3\u6790\u51fa\u6587\u672c\u6837\u5f0f\u4f8b\u5982\u4e0b\u5212\u7ebf\u3001\u9ad8\u4eae\u53ca\u5176\u4f5c\u7528\u7684\u6587\u672c\u3001\u89e3\u6790\u8868\u683c\u6837\u5f0f\u5982\u8fb9\u6846\u989c\u8272\u3001\u80cc\u666f\u8272\u53ca\u5176\u5305\u542b\u7684\u6bb5\u843d\u3002\u6211\u4eec\u5148\u4ece\u9875\u9762\u5e03\u5c40\u5f00\u59cb\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_1","text":"\u4e3a\u4e86\u66f4\u597d\u5730\u7ba1\u7406\u548c\u89e3\u6790 Block \u548c Shape \uff0c\u5e76\u4e14\u8003\u8651\u6700\u540e\u5728Word\u4e2d\u7684\u91cd\u5efa\uff0c\u8bbe\u8ba1 pdf2docx \u8f6c\u6362\u7c7b\u7684\u57fa\u672c\u7ed3\u6784\u5982\u4e0b\u3002\u5176\u4e2d\uff1a Page \u7c7b\u5bf9\u5e94\u7269\u7406\u4e0a\u7684\u4e00\u4e2a\u9875\u9762\uff0c\u5177\u6709\u5c3a\u5bf8\u3001\u8fb9\u8ddd\u3001\u9875\u7709\u9875\u811a\u7b49\u5c5e\u6027\uff0c\u4e3b\u8981\u5185\u5bb9\u6309\u7167\u6d41\u5f0f\u5e03\u5c40\u987a\u5e8f\u88ab\u5206\u4e3a\u4e00\u4e2a\u6216\u8005\u591a\u4e2a Section Section \u5bf9\u5e94Word\u7684\u8282\uff08Section\uff09\uff0c\u8868\u793a\u5177\u6709\u7c7b\u4f3c\u7ed3\u6784\u7684\u5e03\u5c40\uff0c\u4f8b\u5982\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5206\u680f Column Column \u5bf9\u5e94Word\u7684\u5206\u680f\uff08Column\uff09\uff0c\u8868\u793a\u5206\u680f\u4e2d\u7684\u4e00\u5217\u3002\u5bf9\u4e8e\u666e\u901a\u7684\u6392\u7248\uff0c\u5757\u5143\u7d20\u548c\u5f62\u72b6\u5143\u7d20\u90fd\u5728\u4e00\u4e2a Section \u7684\u4e00\u4e2a Column \u4e0b \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502pdf2docx Converter \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502Page-1 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2502Section-1 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 Column-1 \u2502 \u2502 Column-2 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 Section-2 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 Page-2 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"\u6570\u636e\u7ed3\u6784"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_2","text":"\u7406\u8bba\u4e0a\uff0c\u65e0\u6cd5\u4ece\u5355\u4e2a\u9875\u9762\u8bc6\u522b\u51fa\u9875\u7709\u548c\u9875\u811a\uff0c\u6240\u4ee5\u9700\u8981\u4ece\u6587\u6863\u7ea7\u522b\u5373\u591a\u4e2aPages\u4e00\u8d77\u5bf9\u6bd4\u7ed3\u6784\u76f8\u4f3c\u6027\uff0c\u4ece\u800c\u4ece\u9875\u9762\u5f00\u59cb\u90e8\u5206\u5206\u79bb\u51fa\u9875\u7709\u3001\u4ece\u9875\u9762\u7ed3\u675f\u90e8\u5206\u5206\u79bb\u51fa\u9875\u811a\u3002\u540c\u65f6\uff0c\u9700\u8981\u5904\u7406\u4e00\u4e9b\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u4f8b\u5982\u9875\u7801\u3001\u5947\u5076\u9875\u4e0d\u540c\u7684\u9875\u7709\u9875\u811a\u3002 \u622a\u81f3 v0.5.2 \uff0c\u8fd9\u90e8\u5206\u4f9d\u7136\u5360\u5751\u5f85\u5904\u7406\u4e2d\u3002","title":"\u9875\u7709\u9875\u811a"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_3","text":"PyMuPDF \u63d0\u53d6\u7684\u6570\u636e\u76f4\u63a5\u5305\u62ec\u4e86\u9875\u9762\u5bbd\u5ea6\u548c\u9ad8\u5ea6\uff0c\u7136\u540e\u6839\u636e \u9664\u53bb\u9875\u7709\u9875\u811a\u540e \u7684\u6240\u6709\u5757\u7ea7\u3001\u5f62\u72b6\u5143\u7d20\u6240\u5360\u636e\u7684\u533a\u57df\u8ba1\u7b97\u9875\u8fb9\u8ddd\uff0c\u4f8b\u5982\u6700\u5c0f\u5de6\u4e0a\u89d2\u70b9\u786e\u5b9a\u4e86\u5de6\u8fb9\u8ddd\u548c\u4e0a\u8fb9\u8ddd\u3002 python-docx \u4e2d\u9875\u9762 section \u5bf9\u8c61\u6070\u597d\u63d0\u4f9b\u4e86\u8fd9\u516d\u4e2a\u5c5e\u6027\uff0c\u4f8b\u5982 page_width \u3001 left_margin \u3002\u4e8e\u662f\u9875\u9762\u57fa\u672c\u5f62\u5f0f\u5f97\u4ee5\u786e\u5b9a\u3002","title":"\u9875\u9762\u5927\u5c0f\u4e0e\u9875\u8fb9\u8ddd"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_4","text":"\u65e9\u671f\u7248\u672c\u901a\u8fc7\u8868\u683c\u6765\u5b9e\u73b0\u5206\u680f\u5e03\u5c40\uff0c\u4ece0.5.2\u7248\u5f00\u59cb\u5f15\u5165 Section \u548c Column \uff0c\u4ee5\u4fdd\u8bc1\u9875\u9762\u903b\u8f91\u7684\u5408\u7406\u6027\uff0c\u540c\u65f6\u51cf\u5c11\u5d4c\u5957\u8868\u683c\u7684\u6cdb\u6ee5\u3002 \u6ce8\u610f \u4e3a\u517c\u987e\u901a\u7528\u6027\u548c\u964d\u4f4e\u590d\u6742\u5ea6\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5355\u680f\u6216\u8005\u4e24\u680f\u7684\u5e03\u5c40\uff0c\u66f4\u591a\u7684\u5206\u680f\u5c06\u88ab\u89e3\u6790\u4e3a\u8868\u683c\u3002","title":"\u5206\u680f"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_5","text":"\u81ea\u4e0a\u800c\u4e0b\u68c0\u6d4b\u6bcf\u4e00\u884c\uff0c\u5c06\u8fde\u7eed\u7684\u5355\u5217\u6216\u8005\u53cc\u5217\u5f52\u4e3a\u540c\u4e00\u4e2a Section \uff0c\u5176\u4e2d\u6bcf\u4e00\u5217\u5373\u4e3a\u4e00\u4e2a Column \u3002\u540c\u65f6\uff0c\u6ce8\u610f\u4ee5\u4e0b\u7ec6\u8282\uff1a \u76ee\u524d\u6700\u591a\u8003\u8651\u4e24\u680f\uff0c\u6545\u5217\u6570\u5927\u4e8e2\u7684\u884c\u89c6\u4e3a\u5355\u680f \u5f53\u524d\u884c\u53ef\u4ee5\u5206\u4e3a\u4e24\u5217\u65f6\uff0c \u5f53\u5176\u4e2d\u4e00\u5217\u5bbd\u5ea6\u5f88\u5c0f\u4f8b\u5982\u5c0f\u4e8e5Pt\uff0c\u5219\u89c6\u4e3a\u5355\u680f\uff1b \u524d\u4e00\u4e2a Section \u4e5f\u662f\u4e24\u680f\uff0c\u4f46\u662f\u5404\u81ea\u7684\u680f\u5206\u9694\u7ebf\u4e0d\u91cd\u5408\uff0c\u5219\u5f53\u524d\u884c\u89c6\u4e3a\u5355\u680f \u5f53\u524d\u884c\u4ec5\u4e3a\u4e00\u5217\uff0c\u4e14\u524d\u4e00\u4e2a Section \u4e3a\u4e24\u680f\u65f6\uff0c \u5f53\u524d\u884c\u5b8c\u5168\u5904\u4e8e\u524d\u4e00\u4e2a Section \u7684\u5de6\u680f\uff0c\u5219\u5f53\u524d\u884c\u89c6\u4e3a\u4e24\u680f\uff08\u53f3\u680f\u4e3a\u7a7a\uff09\uff1b \u524d\u4e00\u4e2a Section \u9ad8\u5ea6\u8f83\u5c0f\u4f8b\u5982\u5c0f\u4e8e20Pt\uff0c\u5219\u524d\u4e00\u4e2a Section \u9000\u5316\u4e3a\u4e00\u680f","title":"\u5206\u680f\u903b\u8f91"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_6","text":"\u6bcf\u4e00\u4e2a Section \u5728\u9875\u9762\u7ad6\u76f4\u65b9\u5411\u7684\u4f4d\u7f6e \u7531\u524d\u4e00\u4e2a\u6bb5\u843d\u7684\u6bb5\u540e\u95f4\u8ddd \u786e\u5b9a\uff0c\u56e0\u6b64\u5728\u786e\u5b9a\u597d Section \u540e\uff0c\u8ba1\u7b97\u5f53\u524d Section \u5f00\u59cb\u4f4d\u7f6e y0 \u4e0e\u524d\u4e00\u4e2a Section \u7ed3\u675f\u4f4d\u7f6e y1 \u7684\u5dee\u503c\uff0c\u4f5c\u4e3a Section \u7684\u4e00\u4e2a\u5c5e\u6027 before_space \u3002 \u4f7f\u7528 python-docx \u91cd\u5efa Section \u65f6\uff0c\u8bbe\u7f6e\u524d\u4e00\u4e2a Section \u6700\u540e\u4e00\u4e2a\u6bb5\u843d\u7684\u6bb5\u540e\u8ddd\u79bb\u7b49\u4e8e\u5f53\u524d Section \u7684 before_space \u5373\u53ef\u3002\u4e24\u4e2a Column \u4e4b\u95f4\u8bbe\u7f6e\u5217\u5206\u9694\u7b26 WD_SECTION.NEW_COLUMN \u3002 \u6bcf\u4e00\u9875\u7b2c\u4e00\u4e2a Section \u7684\u5904\u7406 \u8ba1\u7b97 before_space \u65f6\uff0c\u524d\u4e00\u4e2a\u53c2\u8003\u4f4d\u7f6e\u4e3a\u9875\u9762\u4e0a\u8fb9\u8ddd\u3002 \u91cd\u5efa Section \u65f6\uff0c\u65b0\u5efa\u4e00\u4e2a\u7a7a\u6bb5\u843d\u4f5c\u4e3a\u8bbe\u7f6e\u6bb5\u540e\u95f4\u8ddd\u7684\u53c2\u8003\u3002","title":"\u7ad6\u76f4\u5b9a\u4f4d"},{"location":"2021-05-30-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80/#_7","text":"\u521b\u5efa Section \u540e\uff0c\u5c06\u539f\u59cb\u7684 Block \u548c Shape \u6309\u7167\u4f4d\u7f6e\u5173\u7cfb\u5206\u914d\u5230\u76f8\u5e94\u7684 Column \u4e2d\u53bb\uff0c\u4ee5\u4fbf\u8fdb\u4e00\u6b65\u89e3\u6790\u8868\u683c\u548c\u6bb5\u843d\u3002 Column \u662f\u4e00\u4e2a\u5e03\u5c40\u5bf9\u8c61\uff0c\u76f4\u63a5\u5bb9\u7eb3 Block \u548c Shape \uff0c\u6240\u4ee5 pdf2docx \u4e3a\u5176\u62bd\u8c61\u51fa\u4e00\u4e2a Layout \u7c7b\uff0c\u4fbf\u4e8e\u7ba1\u7406\u548c\u64cd\u4f5c\u3002 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502Layout \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502Blocks \u2502 \u2502Shapes \u2502 \u2502 \u2502 \u2502 TextBlock \u2502 \u2502 Stroke \u2502 \u2502 \u2502 \u2502 TableBlock\u2502 \u2502 Fill \u2502 \u2502 \u2502 \u2502 ... \u2502 \u2502 ... \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 PDF\u76f4\u63a5\u63d0\u53d6\u51fa\u7684\u5757\u5143\u7d20\u53ea\u6709 TextBlock \uff0c\u7ed3\u5408\u5f62\u72b6\u5143\u7d20\uff08\u6f5c\u5728\u7684\u8868\u683c\u8fb9\u6846\u3001\u5355\u5143\u683c\u80cc\u666f\u8272\uff09\u89e3\u6790\u51fa TableBlock \u540e\uff0c\u7ee7\u7eed\u6839\u636e\u4f4d\u7f6e\u5173\u7cfb\u5c06\u8868\u683c\u8303\u56f4\u5185\u7684 Block \u548c Shape \u5206\u914d\u5230\u76f8\u5e94\u7684\u5355\u5143\u683c\u4e2d\u53bb\u3002\u7531\u6b64\u53ef\u77e5\uff0c\u5bb9\u7eb3 Block \u548c Shape \u7684\u5355\u5143\u683c\u4e5f\u662f\u4e00\u4e2a Layout \u5bf9\u8c61\uff0c\u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u5355\u5143\u683c\u5185\u7684\u5d4c\u5957\u8868\u683c\u548c\u6bb5\u843d\u89e3\u6790\u3002\u8fd9\u6837\u7684\u8bbe\u8ba1\u786e\u4fdd\u53ef\u4ee5\u9012\u5f52\u89e3\u6790\u51fa\u65e0\u9650\u5d4c\u5957\u7684\u8868\u683c\uff0c\u540c\u65f6\u4e5f\u6709\u52a9\u4e8e\u5c06PDF\u7684\u6d6e\u52a8\u5e03\u5c40\u8f6c\u5316\u4e3a\u6d41\u52a8\u5e03\u5c40\uff0c\u4fbf\u4e8e\u5728Word\u4e2d\u91cd\u5efa\u3002 \u81f3\u4e8e\u8868\u683c\u7684\u5177\u4f53\u89e3\u6790\u65b9\u6cd5\uff0c\u5355\u5f00\u4e00\u7bc7\u8fdb\u884c\u5177\u4f53\u4ecb\u7ecd\uff1a pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c \u6700\u540e\uff0c\u603b\u7ed3\u9875\u9762\u5e03\u5c40\u7ea7\u522b\u7684\u6570\u636e\u7ed3\u6784\u53ca\u57fa\u672c\u5c5e\u6027\u5982\u4e0b\uff1a # page -> section -> column { \"filename\": \"demo.pdf\", \"page_cnt\": 2, \"pages\": [ { \"id\": 0, \"width\": float, \"height\": float, \"margin\": [float, float, float, float], \"sections\": [ { \"bbox\": [float, float, float, float], \"cols\": int, \"space\": float, \"before_space\": float, \"columns\": [ { \"bbox\": [float, float, float, float], \"blocks\": [], \"shapes\": [] }, { # column 2 } ] }, { # section 2 } ], \"header\": str, \"footer\": str, \"floats\": [] }, { # page 2 } ] }","title":"\u8868\u683c\u548c\u6bb5\u843d\u89e3\u6790"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/","text":"pytest\u53c2\u6570\u5316\u6d4b\u8bd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-06-06 | \u5206\u7c7b\uff1a devops , python/vba/cpp pytest \u662f\u4e00\u4e2a\u6d41\u884c\u7684Python\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff0c\u81ea\u8eab\u529f\u80fd\u5f3a\u5927\uff0c\u4e14\u53ef\u4ee5\u96c6\u6210\u5404\u79cd\u63d2\u4ef6\u4f8b\u5982\u4ee3\u7801\u8986\u76d6\u7387\u3001\u6d4b\u8bd5\u62a5\u544a\u3002\u6211\u4eec\u53ef\u80fd\u9047\u5230\u7684\u8fd9\u6837\u7684\u5e94\u7528\u573a\u666f\uff0c\u540c\u4e00\u529f\u80fd\u9700\u8981\u5728\u5927\u91cf\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5e76\u4e14\u6bcf\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c\u5bf9\u5e94\u4e00\u4e2a\u6d4b\u8bd5\u6848\u4f8b\u3002\u663e\u7136\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u6848\u4f8b\u4ec5\u662f\u8f93\u5165\u4e0d\u540c\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c\u5199\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\u4e0d\u592a\u73b0\u5b9e\u3002\u672c\u6587\u4ecb\u7ecd\u7684pytest\u53c2\u6570\u5316\u6d4b\u8bd5\u5373\u662f\u9488\u5bf9\u8fd9\u7c7b\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u76ee\u6807\u573a\u666f \u00b6 N\u4e2a\u6d4b\u8bd5\u6837\u672c\u5206\u522b\u653e\u5728\u5982\u4e0b\u6587\u4ef6\u5939 test-001 \uff0c test-002 \uff0c...\uff0c\u8981\u6c42\uff1a \u4e3a\u6bcf\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c\u751f\u6210\u4e00\u4e2a\u6d4b\u8bd5\u6848\u4f8b \u9ed8\u8ba4\u6d4b\u8bd5\u6240\u6709\u6848\u4f8b \u5982\u679c\u8f93\u5165\u53c2\u6570 n \uff0c\u5219\u53ea\u6d4b\u8bd5\u524d n \u4e2a\u6848\u4f8b \u4ecepytest.fixture()\u5f00\u59cb 1 \u00b6 \u987e\u540d\u601d\u4e49\uff0c fixture \u662f\u8f85\u52a9\u6d4b\u8bd5\u51fd\u6570\u7684\u5de5\u88c5\u5939\u5177\uff0c\u5176\u4e2d params \u53c2\u6570\u63d0\u4f9b\u4e86\u53c2\u6570\u5316\u8f93\u5165\u7684\u529f\u80fd\uff0c\u6bcf\u4e00\u4e2a\u53c2\u6570\u90fd\u4f1a\u88ab\u521b\u5efa\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u6d4b\u8bd5\u6848\u4f8b\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a # test.py import pytest inputs = ['test-001', 'test-002', 'test-003'] @pytest.fixture(scope=\"module\", params=inputs) def get_input(request): return request.param # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') \u8fd9\u6837\uff0c\u4f7f\u7528\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\u5373\u53ef\u5b8c\u6210\u4e09\u4e2a\u7c7b\u4f3c\u6848\u4f8b\u7684\u6d4b\u8bd5\u3002 $ pytest -sv test.py test.py::test[test-001] Testing test-001 PASSED test.py::test[test-002] Testing test-002 PASSED test.py::test[test-003] Testing test-003 PASSED \u518d\u5230@pytest.mark.parametrize 2 \u00b6 \u4e0e fixture \u7c7b\u4f3c\uff0c pytest.mark.parametrize \u88c5\u9970\u5668\u4e5f\u63d0\u4f9b\u4e86\u53c2\u6570\u5316\u8f93\u5165\u7684\u529f\u80fd\u3002 fixture \u4f8b\u5b50\u4e2d\uff0c\u6d4b\u8bd5\u51fd\u6570\u7684\u53c2\u6570 get_input \u662f\u4e00\u4e2a fixture \uff0c\u672c\u4f8b\u4e2d get_input \u662f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u53c2\u6570\u540d\u79f0\u3002 import pytest inputs = ['test-001', 'test-002', 'test-003'] # \u6d4b\u8bd5\u51fd\u6570 @pytest.mark.parametrize(\"get_input\", inputs) def test(get_input): print(f'Testing {get_input}') \u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u90fd\u6ee1\u8db3\u4e86 \u4e3a\u6bcf\u4e00\u4e2a\u6837\u672c\u521b\u5efa\u72ec\u7acb\u6d4b\u8bd5\u6848\u4f8b \u7684\u9700\u6c42\uff0c\u7136\u800c\u95ee\u9898\u662f\u8f93\u5165\u53c2\u6570\u662f\u4ee5\u786c\u7f16\u7801\u7684\u65b9\u5f0f\u5199\u6b7b\u7684\uff0c\u53ef\u6269\u5c55\u6027\u5f88\u5dee\u3002\u4e8e\u662f\uff0c\u5f15\u51fa\u4e86\u4e0b\u9762\u7684\u53c2\u6570\u5316\u6d4b\u8bd5\u65b9\u6cd5\u3002 \u52a8\u6001\u751f\u6210\u53c2\u6570\u5316\u6d4b\u8bd5\u6848\u4f8b 3 \u00b6 pytest_generate_tests(metafunc) \u662fpytest\u81ea\u5e26\u7684\u5728\u6536\u96c6\u6d4b\u8bd5\u51fd\u6570\u65f6\u8c03\u7528\u7684\u94a9\u5b50\u51fd\u6570\uff0c\u4ee5\u4fbf\u6309\u7167\u81ea\u5b9a\u4e49\u65b9\u5f0f\u3001\u52a8\u6001\u5730\u751f\u6210\u53c2\u6570\u5316\u65b9\u6848\u3002\u5176\u4e2d\uff0c metafunc \u53c2\u6570\u53ef\u4ee5\u68c0\u67e5\u8bf7\u6c42\u7684\u6d4b\u8bd5\u4e0a\u4e0b\u6587\uff0c metafunc.fixturenames \u83b7\u53d6\u6240\u6709 fixture metafunc.parametrize(name, params) \u751f\u6210\u81ea\u5b9a\u4e49\u6d4b\u8bd5\u65b9\u6848 prefix = 'test-00' def pytest_generate_tests(metafunc): if not \"get_input\" in metafunc.fixturenames: return params = [f'{prefix}{i+1}' for i in range(3)] metafunc.parametrize(\"get_input\", params) # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') \u8fd9\u4e2a\u4f8b\u5b50\u4e0d\u518d\u76f4\u63a5\u7ed9\u51fa\u786c\u7f16\u7801\u7684 test-001 ~ test-003 \uff0c\u800c\u662f\u6839\u636e\u9700\u8981\u52a8\u6001\u751f\u6210\u7684\uff0c\u8fd9\u4e3a\u5b9e\u9645\u5e94\u7528\u5e26\u6765\u65e0\u9650\u53ef\u80fd\u3002\u4f46\u662f\uff0c\u5176\u4e2d\u6d4b\u8bd5\u6848\u4f8b\u4e2a\u6570 3 \u8fd8\u662f\u786c\u7f16\u7801\u65b9\u5f0f\u5199\u5165\u7684\uff01\u4e3a\u4e86\u5b9e\u73b0\u7ec8\u6781\u76ee\u6807\uff0c\u6211\u4eec\u5fc5\u987b\u5f15\u5165\u547d\u4ee4\u884c\u53c2\u6570\u3002 \u6ce8\u518c\u547d\u4ee4\u884c\u53c2\u6570 4 5 \u00b6 pytest_addoption(parser) \u662f\u53e6\u4e00\u4e2apytest\u94a9\u5b50\u51fd\u6570\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u6ce8\u518c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u7136\u540e\u901a\u8fc7 fixture \u6216\u5176\u4ed6\u94a9\u5b50\u83b7\u53d6\u7528\u6237\u8f93\u5165\u3002 parser.addoption \u6ce8\u518c\u547d\u4ee4\u884c\u53c2\u6570 fixture \u7684 pytestconfig \u53c2\u6570\u83b7\u53d6\u53c2\u6570\uff1a @pytest.fixture(scope='session') def user_param(pytestconfig): return pytestconfig.getoption('--param_name') \u6216\u8005 pytest_generate_tests \u7684 metafunc \u83b7\u53d6\u53c2\u6570\uff1a metafunc.config.getoption('param_name') \u6ce8\u610f pytest_addoption \u5fc5\u987b\u5199\u5728\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1aconftest.py\u3002 \u56de\u5230\u672c\u95ee\u9898\uff0c\u521b\u5efa\u914d\u7f6e\u6587\u4ef6 conftext.py \uff0c\u6ce8\u518c\u7528\u6237\u8f93\u5165\u53c2\u6570 n \u3002 # conftest.py def pytest_addoption(parser): parser.addoption( \"--n\", action=\"store\", default=None, help=\"Specify the count of test cases.\") \u6b64\u65f6\uff0c\u5728 conftext.py \u6240\u5728\u76ee\u5f55\u4e0b\u67e5\u770b pytest \u5e2e\u52a9\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c pytest \u6210\u529f\u8bfb\u53d6\u4e86\u914d\u7f6e\u6587\u4ef6\u5e76\u6ce8\u518c\u4e86\u7528\u6237\u8f93\u5165\u53c2\u6570 --n \u3002 $ pytest -h ... custom options: --n=N Specify the count of test cases. ... \u63a5\u4e0b\u6765\uff0c\u4e0e\u4e4b\u524d\u52a8\u6001\u751f\u6210\u6d4b\u8bd5\u65b9\u6848\u7684\u4f8b\u5b50\u7ed3\u5408\uff1a prefix = 'test-00' def pytest_generate_tests(metafunc): if not \"get_input\" in metafunc.fixturenames: return n = metafunc.config.getoption(\"n\") # \u83b7\u53d6\u8f93\u5165\u53c2\u6570\u503c n = int(n) if n is not None else 3 params = [f'{prefix}{i+1}' for i in range(n)] metafunc.parametrize(\"get_input\", params) # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') \u8bd5\u9a8c\u4e00\u4e0b\u53ef\u77e5\u6ee1\u8db3\u65e2\u5b9a\u9700\u6c42\uff1a \u4e0d\u6307\u5b9a n \u65f6\uff0c\u9ed8\u8ba4\u8fd0\u884c3\u4e2a\u6d4b\u8bd5\u6848\u4f8b\uff1b $ pytest -sv test.py test.py::test[test-001] Testing test-001 PASSED test.py::test[test-002] Testing test-002 PASSED test.py::test[test-003] Testing test-003 PASSED \u5982\u679c\u6307\u5b9a n \uff0c\u5219\u8fd0\u884c n \u4e2a\u6d4b\u8bd5\u6848\u4f8b\u3002 $ pytest -sv test.py --n=2 test.py::test[test-001] Testing test-001 PASSED test.py::test[test-002] Testing test-002 PASSED \u4ecePython\u4ee3\u7801\u542f\u52a8pytest\u6d4b\u8bd5 \u00b6 \u4ee5\u4e0a\u5185\u5bb9\u57fa\u4e8e\u4ece\u547d\u4ee4\u884c\u542f\u52a8\u6d4b\u8bd5\u7684\u524d\u63d0\uff0c\u5df2\u7ecf\u53ef\u4ee5\u6ee1\u8db3\u672c\u6587\u5f00\u5934\u76ee\u6807\u573a\u666f\u7684\u9700\u8981\u3002\u4e0d\u8fc7\uff0c\u8fd8\u53ef\u4ee5\u8fdb\u4e00\u6b65\uff0c\u76f4\u63a5\u4ece\u4ee3\u7801\u542f\u52a8\u6d4b\u8bd5\u3002\u6709\u4ec0\u4e48\u4f5c\u7528\u5462\uff1f\u9526\u4e0a\u6dfb\u82b1\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5c01\u88c5\u6210\u4e00\u4e2a\u9488\u5bf9\u672c\u6587\u573a\u666f\u7684\u4e13\u7528\u6d4b\u8bd5\u5de5\u5177\u3002 pytest\u63d0\u4f9b\u4e86\u4ece\u4ee3\u7801\u6267\u884c\u6d4b\u8bd5\u7684\u51fd\u6570 pytest.main() \uff0c\u5b83\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a args \u53c2\u6570\u5217\u8868\uff0c\u7b49\u540c\u4e8e\u547d\u4ee4\u884c\u6a21\u5f0f\u8f93\u5165\u7684\u5404\u79cd\u53c2\u6570 plugins \u63d2\u4ef6\u5217\u8868\u3002 \u4ec0\u4e48\u662fpytest\u63d2\u4ef6\uff1f pytest\u63d2\u4ef6\u662f\u901a\u8fc7\u94a9\u5b50\u51fd\u6570\u5b9e\u73b0\u7684\u4e00\u4e9b\u529f\u80fd\uff0c\u4f8b\u5982\u524d\u9762\u63d0\u5230\u7684 conftest.py \u5373\u4e3a\u63d2\u4ef6\u7c7b\u578b\u7684\u4e00\u79cd\uff1a \u672c\u5730\u63d2\u4ef6 \u3002 \u6211\u4eec\u6b63\u597d\u5c06 conftest.py \u7684\u4ee3\u7801\u6574\u5408\u5230\u4e00\u8d77\uff0c\u5f97\u5230\u5b8c\u6574\u7248\uff1a # test.py # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') # main.py import pytest prefix = 'test-00' class MyPlugin: def pytest_addoption(self, parser): parser.addoption( \"--n\", action=\"store\", default=None, help=\"Specify the count of test cases.\") def pytest_generate_tests(self, metafunc): if not \"get_input\" in metafunc.fixturenames: return n = metafunc.config.getoption(\"n\") # \u83b7\u53d6\u8f93\u5165\u53c2\u6570\u503c n = int(n) if n is not None else 3 params = [f'{prefix}{i+1}' for i in range(n)] metafunc.parametrize(\"get_input\", params) if __name__=='__main__': pytest.main( args=['-sv', '--n=2', 'test.py'], plugins=[MyPlugin()]) \u6700\u540e\uff0c python main.py \u542f\u52a8\u6d4b\u8bd5\u5373\u53ef\u3002 \u6ce8\u610f\uff0c\u867d\u7136\u6700\u540e\u4f8b\u5b50\u4e2d\u76f4\u63a5\u5199\u5165 --n=2 \uff0c\u5b9e\u9645\u4e0a main.py \u53ef\u4ee5\u501f\u52a9 fire \u7b49\u7b2c\u4e09\u65b9\u5e93\u8f6c\u4e3a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4ece\u800c\u63a5\u53d7\u7528\u6237\u8f93\u5165\u3002\u672c\u6587\u7565\u8fc7\u3002 Parametrizing fixtures \u21a9 pytest.mark.parametrize: parametrizing test functions \u21a9 Basic pytest_generate_tests example \u21a9 Custom marker and command line option to control test runs \u21a9 Hook \u65b9\u6cd5\u4e4b pytest_addoption \uff1a\u6ce8\u518c\u547d\u4ee4\u884c\u53c2\u6570 \u21a9 Calling pytest from Python code \u21a9","title":"pytest\u53c2\u6570\u5316\u6d4b\u8bd5"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#pytest","text":"\u53d1\u5e03\u4e8e\uff1a2021-06-06 | \u5206\u7c7b\uff1a devops , python/vba/cpp pytest \u662f\u4e00\u4e2a\u6d41\u884c\u7684Python\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff0c\u81ea\u8eab\u529f\u80fd\u5f3a\u5927\uff0c\u4e14\u53ef\u4ee5\u96c6\u6210\u5404\u79cd\u63d2\u4ef6\u4f8b\u5982\u4ee3\u7801\u8986\u76d6\u7387\u3001\u6d4b\u8bd5\u62a5\u544a\u3002\u6211\u4eec\u53ef\u80fd\u9047\u5230\u7684\u8fd9\u6837\u7684\u5e94\u7528\u573a\u666f\uff0c\u540c\u4e00\u529f\u80fd\u9700\u8981\u5728\u5927\u91cf\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5e76\u4e14\u6bcf\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c\u5bf9\u5e94\u4e00\u4e2a\u6d4b\u8bd5\u6848\u4f8b\u3002\u663e\u7136\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u6848\u4f8b\u4ec5\u662f\u8f93\u5165\u4e0d\u540c\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c\u5199\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\u4e0d\u592a\u73b0\u5b9e\u3002\u672c\u6587\u4ecb\u7ecd\u7684pytest\u53c2\u6570\u5316\u6d4b\u8bd5\u5373\u662f\u9488\u5bf9\u8fd9\u7c7b\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6848\u3002","title":"pytest\u53c2\u6570\u5316\u6d4b\u8bd5"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#_1","text":"N\u4e2a\u6d4b\u8bd5\u6837\u672c\u5206\u522b\u653e\u5728\u5982\u4e0b\u6587\u4ef6\u5939 test-001 \uff0c test-002 \uff0c...\uff0c\u8981\u6c42\uff1a \u4e3a\u6bcf\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c\u751f\u6210\u4e00\u4e2a\u6d4b\u8bd5\u6848\u4f8b \u9ed8\u8ba4\u6d4b\u8bd5\u6240\u6709\u6848\u4f8b \u5982\u679c\u8f93\u5165\u53c2\u6570 n \uff0c\u5219\u53ea\u6d4b\u8bd5\u524d n \u4e2a\u6848\u4f8b","title":"\u76ee\u6807\u573a\u666f"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#pytestfixture 1","text":"\u987e\u540d\u601d\u4e49\uff0c fixture \u662f\u8f85\u52a9\u6d4b\u8bd5\u51fd\u6570\u7684\u5de5\u88c5\u5939\u5177\uff0c\u5176\u4e2d params \u53c2\u6570\u63d0\u4f9b\u4e86\u53c2\u6570\u5316\u8f93\u5165\u7684\u529f\u80fd\uff0c\u6bcf\u4e00\u4e2a\u53c2\u6570\u90fd\u4f1a\u88ab\u521b\u5efa\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u6d4b\u8bd5\u6848\u4f8b\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a # test.py import pytest inputs = ['test-001', 'test-002', 'test-003'] @pytest.fixture(scope=\"module\", params=inputs) def get_input(request): return request.param # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') \u8fd9\u6837\uff0c\u4f7f\u7528\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\u5373\u53ef\u5b8c\u6210\u4e09\u4e2a\u7c7b\u4f3c\u6848\u4f8b\u7684\u6d4b\u8bd5\u3002 $ pytest -sv test.py test.py::test[test-001] Testing test-001 PASSED test.py::test[test-002] Testing test-002 PASSED test.py::test[test-003] Testing test-003 PASSED","title":"\u4ecepytest.fixture()\u5f00\u59cb 1"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#pytestmarkparametrize 2","text":"\u4e0e fixture \u7c7b\u4f3c\uff0c pytest.mark.parametrize \u88c5\u9970\u5668\u4e5f\u63d0\u4f9b\u4e86\u53c2\u6570\u5316\u8f93\u5165\u7684\u529f\u80fd\u3002 fixture \u4f8b\u5b50\u4e2d\uff0c\u6d4b\u8bd5\u51fd\u6570\u7684\u53c2\u6570 get_input \u662f\u4e00\u4e2a fixture \uff0c\u672c\u4f8b\u4e2d get_input \u662f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u53c2\u6570\u540d\u79f0\u3002 import pytest inputs = ['test-001', 'test-002', 'test-003'] # \u6d4b\u8bd5\u51fd\u6570 @pytest.mark.parametrize(\"get_input\", inputs) def test(get_input): print(f'Testing {get_input}') \u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u90fd\u6ee1\u8db3\u4e86 \u4e3a\u6bcf\u4e00\u4e2a\u6837\u672c\u521b\u5efa\u72ec\u7acb\u6d4b\u8bd5\u6848\u4f8b \u7684\u9700\u6c42\uff0c\u7136\u800c\u95ee\u9898\u662f\u8f93\u5165\u53c2\u6570\u662f\u4ee5\u786c\u7f16\u7801\u7684\u65b9\u5f0f\u5199\u6b7b\u7684\uff0c\u53ef\u6269\u5c55\u6027\u5f88\u5dee\u3002\u4e8e\u662f\uff0c\u5f15\u51fa\u4e86\u4e0b\u9762\u7684\u53c2\u6570\u5316\u6d4b\u8bd5\u65b9\u6cd5\u3002","title":"\u518d\u5230@pytest.mark.parametrize 2"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#3","text":"pytest_generate_tests(metafunc) \u662fpytest\u81ea\u5e26\u7684\u5728\u6536\u96c6\u6d4b\u8bd5\u51fd\u6570\u65f6\u8c03\u7528\u7684\u94a9\u5b50\u51fd\u6570\uff0c\u4ee5\u4fbf\u6309\u7167\u81ea\u5b9a\u4e49\u65b9\u5f0f\u3001\u52a8\u6001\u5730\u751f\u6210\u53c2\u6570\u5316\u65b9\u6848\u3002\u5176\u4e2d\uff0c metafunc \u53c2\u6570\u53ef\u4ee5\u68c0\u67e5\u8bf7\u6c42\u7684\u6d4b\u8bd5\u4e0a\u4e0b\u6587\uff0c metafunc.fixturenames \u83b7\u53d6\u6240\u6709 fixture metafunc.parametrize(name, params) \u751f\u6210\u81ea\u5b9a\u4e49\u6d4b\u8bd5\u65b9\u6848 prefix = 'test-00' def pytest_generate_tests(metafunc): if not \"get_input\" in metafunc.fixturenames: return params = [f'{prefix}{i+1}' for i in range(3)] metafunc.parametrize(\"get_input\", params) # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') \u8fd9\u4e2a\u4f8b\u5b50\u4e0d\u518d\u76f4\u63a5\u7ed9\u51fa\u786c\u7f16\u7801\u7684 test-001 ~ test-003 \uff0c\u800c\u662f\u6839\u636e\u9700\u8981\u52a8\u6001\u751f\u6210\u7684\uff0c\u8fd9\u4e3a\u5b9e\u9645\u5e94\u7528\u5e26\u6765\u65e0\u9650\u53ef\u80fd\u3002\u4f46\u662f\uff0c\u5176\u4e2d\u6d4b\u8bd5\u6848\u4f8b\u4e2a\u6570 3 \u8fd8\u662f\u786c\u7f16\u7801\u65b9\u5f0f\u5199\u5165\u7684\uff01\u4e3a\u4e86\u5b9e\u73b0\u7ec8\u6781\u76ee\u6807\uff0c\u6211\u4eec\u5fc5\u987b\u5f15\u5165\u547d\u4ee4\u884c\u53c2\u6570\u3002","title":"\u52a8\u6001\u751f\u6210\u53c2\u6570\u5316\u6d4b\u8bd5\u6848\u4f8b 3"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#4 5","text":"pytest_addoption(parser) \u662f\u53e6\u4e00\u4e2apytest\u94a9\u5b50\u51fd\u6570\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u6ce8\u518c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u7136\u540e\u901a\u8fc7 fixture \u6216\u5176\u4ed6\u94a9\u5b50\u83b7\u53d6\u7528\u6237\u8f93\u5165\u3002 parser.addoption \u6ce8\u518c\u547d\u4ee4\u884c\u53c2\u6570 fixture \u7684 pytestconfig \u53c2\u6570\u83b7\u53d6\u53c2\u6570\uff1a @pytest.fixture(scope='session') def user_param(pytestconfig): return pytestconfig.getoption('--param_name') \u6216\u8005 pytest_generate_tests \u7684 metafunc \u83b7\u53d6\u53c2\u6570\uff1a metafunc.config.getoption('param_name') \u6ce8\u610f pytest_addoption \u5fc5\u987b\u5199\u5728\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1aconftest.py\u3002 \u56de\u5230\u672c\u95ee\u9898\uff0c\u521b\u5efa\u914d\u7f6e\u6587\u4ef6 conftext.py \uff0c\u6ce8\u518c\u7528\u6237\u8f93\u5165\u53c2\u6570 n \u3002 # conftest.py def pytest_addoption(parser): parser.addoption( \"--n\", action=\"store\", default=None, help=\"Specify the count of test cases.\") \u6b64\u65f6\uff0c\u5728 conftext.py \u6240\u5728\u76ee\u5f55\u4e0b\u67e5\u770b pytest \u5e2e\u52a9\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c pytest \u6210\u529f\u8bfb\u53d6\u4e86\u914d\u7f6e\u6587\u4ef6\u5e76\u6ce8\u518c\u4e86\u7528\u6237\u8f93\u5165\u53c2\u6570 --n \u3002 $ pytest -h ... custom options: --n=N Specify the count of test cases. ... \u63a5\u4e0b\u6765\uff0c\u4e0e\u4e4b\u524d\u52a8\u6001\u751f\u6210\u6d4b\u8bd5\u65b9\u6848\u7684\u4f8b\u5b50\u7ed3\u5408\uff1a prefix = 'test-00' def pytest_generate_tests(metafunc): if not \"get_input\" in metafunc.fixturenames: return n = metafunc.config.getoption(\"n\") # \u83b7\u53d6\u8f93\u5165\u53c2\u6570\u503c n = int(n) if n is not None else 3 params = [f'{prefix}{i+1}' for i in range(n)] metafunc.parametrize(\"get_input\", params) # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') \u8bd5\u9a8c\u4e00\u4e0b\u53ef\u77e5\u6ee1\u8db3\u65e2\u5b9a\u9700\u6c42\uff1a \u4e0d\u6307\u5b9a n \u65f6\uff0c\u9ed8\u8ba4\u8fd0\u884c3\u4e2a\u6d4b\u8bd5\u6848\u4f8b\uff1b $ pytest -sv test.py test.py::test[test-001] Testing test-001 PASSED test.py::test[test-002] Testing test-002 PASSED test.py::test[test-003] Testing test-003 PASSED \u5982\u679c\u6307\u5b9a n \uff0c\u5219\u8fd0\u884c n \u4e2a\u6d4b\u8bd5\u6848\u4f8b\u3002 $ pytest -sv test.py --n=2 test.py::test[test-001] Testing test-001 PASSED test.py::test[test-002] Testing test-002 PASSED","title":"\u6ce8\u518c\u547d\u4ee4\u884c\u53c2\u6570 4 5"},{"location":"2021-06-06-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95/#pythonpytest","text":"\u4ee5\u4e0a\u5185\u5bb9\u57fa\u4e8e\u4ece\u547d\u4ee4\u884c\u542f\u52a8\u6d4b\u8bd5\u7684\u524d\u63d0\uff0c\u5df2\u7ecf\u53ef\u4ee5\u6ee1\u8db3\u672c\u6587\u5f00\u5934\u76ee\u6807\u573a\u666f\u7684\u9700\u8981\u3002\u4e0d\u8fc7\uff0c\u8fd8\u53ef\u4ee5\u8fdb\u4e00\u6b65\uff0c\u76f4\u63a5\u4ece\u4ee3\u7801\u542f\u52a8\u6d4b\u8bd5\u3002\u6709\u4ec0\u4e48\u4f5c\u7528\u5462\uff1f\u9526\u4e0a\u6dfb\u82b1\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5c01\u88c5\u6210\u4e00\u4e2a\u9488\u5bf9\u672c\u6587\u573a\u666f\u7684\u4e13\u7528\u6d4b\u8bd5\u5de5\u5177\u3002 pytest\u63d0\u4f9b\u4e86\u4ece\u4ee3\u7801\u6267\u884c\u6d4b\u8bd5\u7684\u51fd\u6570 pytest.main() \uff0c\u5b83\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a args \u53c2\u6570\u5217\u8868\uff0c\u7b49\u540c\u4e8e\u547d\u4ee4\u884c\u6a21\u5f0f\u8f93\u5165\u7684\u5404\u79cd\u53c2\u6570 plugins \u63d2\u4ef6\u5217\u8868\u3002 \u4ec0\u4e48\u662fpytest\u63d2\u4ef6\uff1f pytest\u63d2\u4ef6\u662f\u901a\u8fc7\u94a9\u5b50\u51fd\u6570\u5b9e\u73b0\u7684\u4e00\u4e9b\u529f\u80fd\uff0c\u4f8b\u5982\u524d\u9762\u63d0\u5230\u7684 conftest.py \u5373\u4e3a\u63d2\u4ef6\u7c7b\u578b\u7684\u4e00\u79cd\uff1a \u672c\u5730\u63d2\u4ef6 \u3002 \u6211\u4eec\u6b63\u597d\u5c06 conftest.py \u7684\u4ee3\u7801\u6574\u5408\u5230\u4e00\u8d77\uff0c\u5f97\u5230\u5b8c\u6574\u7248\uff1a # test.py # \u6d4b\u8bd5\u51fd\u6570 def test(get_input): print(f'Testing {get_input}') # main.py import pytest prefix = 'test-00' class MyPlugin: def pytest_addoption(self, parser): parser.addoption( \"--n\", action=\"store\", default=None, help=\"Specify the count of test cases.\") def pytest_generate_tests(self, metafunc): if not \"get_input\" in metafunc.fixturenames: return n = metafunc.config.getoption(\"n\") # \u83b7\u53d6\u8f93\u5165\u53c2\u6570\u503c n = int(n) if n is not None else 3 params = [f'{prefix}{i+1}' for i in range(n)] metafunc.parametrize(\"get_input\", params) if __name__=='__main__': pytest.main( args=['-sv', '--n=2', 'test.py'], plugins=[MyPlugin()]) \u6700\u540e\uff0c python main.py \u542f\u52a8\u6d4b\u8bd5\u5373\u53ef\u3002 \u6ce8\u610f\uff0c\u867d\u7136\u6700\u540e\u4f8b\u5b50\u4e2d\u76f4\u63a5\u5199\u5165 --n=2 \uff0c\u5b9e\u9645\u4e0a main.py \u53ef\u4ee5\u501f\u52a9 fire \u7b49\u7b2c\u4e09\u65b9\u5e93\u8f6c\u4e3a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4ece\u800c\u63a5\u53d7\u7528\u6237\u8f93\u5165\u3002\u672c\u6587\u7565\u8fc7\u3002 Parametrizing fixtures \u21a9 pytest.mark.parametrize: parametrizing test functions \u21a9 Basic pytest_generate_tests example \u21a9 Custom marker and command line option to control test runs \u21a9 Hook \u65b9\u6cd5\u4e4b pytest_addoption \uff1a\u6ce8\u518c\u547d\u4ee4\u884c\u53c2\u6570 \u21a9 Calling pytest from Python code \u21a9","title":"\u4ecePython\u4ee3\u7801\u542f\u52a8pytest\u6d4b\u8bd5"},{"location":"2021-06-19-%E9%80%92%E5%BD%92%E6%8A%95%E5%BD%B1%E5%88%86%E5%89%B2%E7%AE%97%E6%B3%95/","text":"\u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-06-19 | \u5206\u7c7b\uff1a mathematics \u9012\u5f52\u6295\u5f71\u5206\u5272\uff08Recursive XY Cut\uff09\u662f\u4e00\u79cd\u81ea\u9876\u5411\u4e0b\u7684\u7248\u9762\u5206\u5272\u65b9\u6cd5\uff0c\u5c06\u9875\u9762\u5206\u5272\u6210\u4e00\u7cfb\u5217\u76f8\u5bf9\u72ec\u7acb\u7684\u77e9\u5f62\u533a\u57df\u3002\u4f8b\u5982\uff0c\u6839\u636e\u7ad6\u76f4\u65b9\u5411\u95f4\u9699\u7684\u4e0d\u540c\uff0c\u53ef\u4ee5\u5212\u5206\u6bb5\u843d\u3001\u884c\u3002\u672c\u6587\u8bb0\u5f55\u8be5\u7b97\u6cd5\u7684\u601d\u8def\u548c\u5b9e\u73b0\u3002 \u57fa\u672c\u6b65\u9aa4 \u00b6 \u6b64\u7b97\u6cd5\u7684\u8f93\u5165\u662f\u4e00\u5f20\u4e8c\u503c\u5316\u7684\u56fe\u7247\uff0c\u6bcf\u4e00\u4e2a\u50cf\u7d20\u7684\u503c\u4e3a0\u6216\u8005255\u3002\u5e76\u4e14\uff0c\u672c\u6587\u7ea6\u5b9a 255\u8868\u793a\u6709\u6548\u533a\u57df\uff0c0\u8868\u793a\u9875\u9762\u7a7a\u767d \u3002 \u5bf9\u4e8c\u503c\u56fe\u4f5c\u6c34\u5e73\u6295\u5f71\uff0c\u6839\u636e\u95f4\u9699\u5206\u5272\u5b50\u56fe\uff0c\u786e\u5b9a\u5b50\u56fe\u533a\u57df\u7684\u4e0a\u4e0b\u8fb9\u754c \u5bf9\u6bcf\u4e00\u4e2a\u5b50\u56fe\u4f5c\u5782\u76f4\u6295\u5f71\uff0c\u6839\u636e\u95f4\u9699\u8fdb\u4e00\u6b65\u5206\u5272\u5b50\u56fe\uff0c\u786e\u5b9a\u5b50\u56fe\u7684\u5de6\u53f3\u8fb9\u754c \u6839\u636e\u524d\u4e24\u6b65\u5f97\u5230\u4e00\u6b21\u5206\u5272\u540e\u7684\u77e9\u5f62\u6846 \u5bf9\u8be5\u77e9\u5f62\u6846\u5185\u7684\u5b50\u56fe\uff0c\u91cd\u590d\u5982\u4e0a\u8fc7\u7a0b\uff1b\u76f4\u5230\u6c34\u5e73\u6295\u5f71\u5206\u5272\u6ca1\u6709\u5f97\u5230\u65b0\u7684\u5b50\u56fe\uff0c\u6216\u8005\u5782\u76f4\u6295\u5f71\u5206\u5272\u5f97\u5230\u5b50\u56fe\u6570<=2 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 1 \u2502 root \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 1\u2500\u2500\u2534\u2500\u2500\u25002-5 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 2 \u2502 \u2502 3 \u2502 2\u2500\u2500\u2500\u2500\u2534\u2500\u25003-5 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2510 \u250c\u2500\u2500\u2510 4-5 \u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u25003 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u25024 \u2502 \u2502 5\u2502 4\u2500\u2500\u2500\u2534\u2500\u2500\u25005 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2518 \u2514\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518 (a) normal layout (b) hierarchy (c) unavailable layout \u4ee5\u4e0a\u56fe\uff08a\uff09\u6240\u793a\u7248\u9762\u4e3a\u4f8b\uff0c\u6700\u7ec8\u5f97\u5230\u5404\u4e2a\u533a\u57df\u53ca\u5176\u5c42\u7ea7\u5173\u7cfb\u6811\u5982\u56fe\uff08b\uff09\u6240\u793a\u3002 \u7b2c\u4e00\u6b21\u9012\u5f52\uff1a\u6c34\u5e73\u6295\u5f71\u5206\u79bb\u51fa\u5b50\u56fe\u533a\u57df1\u548c\u5b50\u56fe\u533a\u57df2-5\uff0c\u7136\u540e\u5206\u522b\u5bf9\u8fd9\u4e24\u4e2a\u5b50\u56fe\u8fdb\u884c\u5782\u76f4\u6295\u5f71\uff1a \u5b50\u56fe\u533a\u57df1\uff1a\u5f97\u5230\u552f\u4e00\u5b50\u56fe1\uff0c\u56e0\u6b64\u5b8c\u5168\u786e\u5b9a\u533a\u57df1\u7684\u77e9\u5f62\u6846\uff0c\u4e14\u4e0d\u5fc5\u8fdb\u5165\u4e0b\u4e00\u6b21\u9012\u5f52 \u5b50\u56fe\u533a\u57df2-5\uff1a\u5206\u79bb\u51fa\u533a\u57df2\u548c\u5b50\u56fe\u533a\u57df3-5\uff1b\u56e0\u4e3a\u5f97\u5230\u4e24\u4e2a\u533a\u57df\uff0c\u8fd8\u9700\u8fdb\u5165\u4e0b\u4e00\u6b21\u9012\u5f52 \u7b2c\u4e8c\u6b21\u9012\u5f52\uff1a \u533a\u57df2\uff1a\u6c34\u5e73\u548c\u5782\u76f4\u6295\u5f71\u90fd\u5f97\u5230\u552f\u4e00\u5b50\u56fe2\uff0c\u505c\u6b62 \u533a\u57df3-5\uff1a\u6c34\u5e73\u6295\u5f71\u5206\u5272\u51fa3\u548c4-5\uff0c3\u7684\u5782\u76f4\u6295\u5f71\u5b8c\u5168\u786e\u5b9a3\uff0c\u505c\u6b62\uff1b4-5\u7684\u5782\u76f4\u6295\u5f71\u5206\u5272\u51fa4\u548c5\uff0c\u7ee7\u7eed\u8fdb\u5165\u4e0b\u4e00\u8f6e \u7b2c\u4e09\u6b21\u9012\u5f52\uff1a\u6c34\u5e73\u3001\u5782\u76f4\u5206\u5272\u5206\u522b\u786e\u5b9a\u533a\u57df4\u548c5 \u5c40\u9650 \u9012\u5f52\u6295\u5f71\u5206\u5272\u6cd5\u4ec5\u5bf9\u6309\u77e9\u5f62\u5206\u5757\u7684\u7248\u9762\u6709\u6548\uff0c\u65e0\u6cd5\u5904\u7406\u76f8\u4e92\u5d4c\u5165\u7684\u77e9\u5f62\uff0c\u4f8b\u5982\u56fe\uff08c\uff09\u3002 \u6c34\u5e73\u6295\u5f71\u548c\u5782\u76f4\u6295\u5f71 \u00b6 \u5728\u4e86\u89e3\u57fa\u672c\u539f\u7406\u540e\uff0c\u6211\u4eec\u9010\u6e10\u8fdb\u5165\u7ec6\u8282\u548c\u4ee3\u7801\u5b9e\u73b0\u5c42\u9762\u3002 \u6c34\u5e73\u6295\u5f71\uff1a\u4e8c\u7ef4\u56fe\u50cf\uff08\u4e8c\u503c\u56fe\uff09\u5728y\u8f74\u4e0a\u7684\u6295\u5f71\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u884c\u4e2d\u7b49\u4e8e255\u7684\u50cf\u7d20\u7684\u4e2a\u6570 \u5782\u76f4\u6295\u5f71\uff1a\u4e8c\u7ef4\u56fe\u50cf\uff08\u4e8c\u503c\u56fe\uff09\u5728x\u8f74\u4e0a\u7684\u6295\u5f71\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u5217\u4e2d\u7b49\u4e8e255\u7684\u50cf\u7d20\u7684\u4e2a\u6570 \u501f\u52a9 opencv \uff0c\u56fe\u50cf\u6570\u636e\u5df2\u7ecf\u662f numpy.ndarray \u7c7b\u578b\u4e86\uff0c\u6240\u4ee5\u65e0\u9700\u5faa\u73af\u7edf\u8ba1\uff0c\u800c\u662f\u91c7\u7528\u66f4\u4e3a\u9ad8\u6548\u7684numpy\u51fd\u6570\uff1a x_projection = np.count_nonzero(img==255, axis=1) y_projection = np.count_nonzero(img==255, axis=0) \u6295\u5f71\u7ed3\u679c\u672c\u8d28\u4e0a\u662f\u4e00\u7ef4\u6570\u7ec4\uff0c\u4ee5\u6570\u503c\u5927\u5c0f\u4e3a\u9ad8\u5ea6\u7ed8\u5236\u5728\u5750\u6807\u8f74\u4e0a\u5f97\u5230\u6295\u5f71\u8f6e\u5ed3\u3002\u5176\u4e2d\uff0c\u5927\u4e8e\u9608\u503c\uff08\u4f8b\u59820\uff09\u7684\u4f4d\u7f6e\u8868\u73b0\u4e3a\u5c71\u5cf0\uff0c\u8868\u5f81\u6709\u6548\u50cf\u7d20\u533a\u57df\uff1b\u5c0f\u4e8e\u9608\u503c\u7684\u4f4d\u7f6e\u4e3a\u5c71\u8c37\uff0c\u8868\u73b0\u4e3a\u7a7a\u767d\uff08\u5ffd\u7565\uff09\u533a\u57df\u3002\u5c71\u8c37\u5206\u5272\u4e86\u5c71\u5cf0\u533a\u57df\uff0c\u6bcf\u4e00\u5ea7\u5c71\u5373\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u533a\u57df\u3002 x x x xx xx x x x x x xxx xxx x xxxxx xxx xxxx xxxx xx xxxxxx xxxxx xxxxx xxxx xx xxxxxxxxxxxxx xxxxxxxx xxx xxxxx xxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx \u5206\u5272\u6295\u5f71\u8f6e\u5ed3 \u00b6 \u6839\u636e\u6295\u5f71\u8f6e\u5ed3\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u5272\u51fa\u72ec\u7acb\u533a\u57df\u3002\u5206\u5272\u7ed3\u679c\u4f9d\u8d56\u4e8e\u4e24\u7c7b\u9608\u503c\uff1a \u6700\u5c0f\u6295\u5f71\u503c min_value \uff0c\u8868\u793a\u6cbf\u7740\u6295\u5f71\u65b9\u5411\u4e0a\u7684\u6709\u6548\u50cf\u7d20\u6570\u3002\u5bf9\u4e8e\u6c34\u5e73\u6295\u5f71\u6765\u8bf4\uff0c\u5373\u4e3a\u9700\u8981\u5173\u6ce8\u7684\u77e9\u5f62\u7684\u6700\u5c0f\u5bbd\u5ea6\u3002 \u6295\u5f71\u95f4\u9699 min_gap \uff0c\u8868\u793a\u4e24\u4e2a\u533a\u57df\u5728\u5782\u76f4\u6295\u5f71\u65b9\u5411\u4e0a\u7684\u6700\u5c0f\u8ddd\u79bb\u3002\u5bf9\u4e8e\u6c34\u5e73\u6295\u5f71\u6765\u8bf4\uff0c\u4f8b\u5982\u6bb5\u95f4\u8ddd\u3001\u884c\u95f4\u8ddd\u7b49\u53c2\u6570\u3002 \u250c\u2500\u2500\u2510 projection \u2502 \u2502 \u250c\u2500\u2510\u2500\u2500\u2500 \u250c\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 | \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502min_value \u2502 \u2502<- min_gap ->\u2502 \u2502 \u2502 \u2502 \u2502 \u2502 | \u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2500\u2500 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u4e0b\u9762\u7ed9\u4e00\u4e2a\u5b9e\u4f8b\u6f14\u793a\uff0c\u5047\u8bbe\u6295\u5f71\u6570\u7ec4\uff1a >>> P = np.array([1, 2, 3, 0, 0, 1, 2, 3, 4, 0, 0, 0, 1, 2, 3, 0]) \u4e3a\u7b80\u5316\u95ee\u9898\uff0c\u5047\u5b9a\u4e24\u7c7b\u9608\u503c\u90fd\u7b49\u4e8e0\u3002\u90a3\u4e48\uff0c\u901a\u8fc7\u904d\u5386\u6295\u5f71\u6570\u7ec4\uff0c\u6570\u4e00\u6570\u8fde\u7eed\u7684\u975e\u96f6\u5143\u7d20\uff0c\u5373\u53ef\u5f97\u52303\u4e2a\u5b50\u533a\u57df\uff0c\u5176\u4f4d\u7f6e\u7d22\u5f15\u8303\u56f4\u5206\u522b\u662f\uff1a[0,2]\uff0c[5,8]\u548c[12,14]\u3002 \u4f46\u65e2\u7136\u5df2\u7ecf\u7528\u4e0anumpy\u4e86\uff0c\u90a3\u5c31\u6362\u4e0anumpy\u6570\u7ec4\u8fd0\u7b97\u7684\u601d\u7ef4\uff1a \u8ba1\u7b97\u6295\u5f71\u6570\u7ec4\u975e\u96f6\u5143\u7d20\u7684\u7d22\u5f15\u4f4d\u7f6e\u6570\u7ec4 I >>> I = np.where(P>0)[0] array([ 0, 1, 2, 5, 6, 7, 8, 12, 13, 14], dtype=int64) np.where \u8fd4\u56de\u503c\u4e0e\u539f\u6570\u7ec4\u7ef4\u5ea6\u4e00\u81f4\uff0c\u5373\u4e00\u7ef4\u7684\u5143\u7ec4\uff0c\u6240\u4ee5\u53d6\u5176\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002 \u7d22\u5f15\u6570\u7ec4 I \u9519\u4f4d\u6c42\u5dee\u5f97\u5230\u5dee\u503c\u6570\u7ec4 D >>> D=I[1:]-I[0:-1] array([1, 1, 3, 1, 1, 1, 4, 1, 1], dtype=int64) \u5dee\u503c\u6570\u7ec4 D \u5927\u4e8e1\uff08\u5373\u81f3\u5c11\u95f4\u96941\u50cf\u7d20\uff09\u7684\u5143\u7d20\u7684\u7d22\u5f15\u4f4d\u7f6e pos \u5bf9\u5e94 I \u4e2d\u5143\u7d20\u7684\u503c I[pos] \uff0c\u5373\u4e3a\u7a7a\u767d\u533a\u95f4\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u5bf9\u5e94\u6709\u6548\u5206\u5272\u533a\u57df\u7684\u7ed3\u675f\u7d22\u5f15 E \u3002\u6ce8\u610f\uff0c\u6b64\u65f6\u5e76\u672a\u8003\u8651\u6700\u540e\u4e00\u4e2a\u533a\u57df\uff0c\u9700\u8981\u989d\u5916\u8865\u5230\u6700\u540e\u3002 >>> pos = np.where(D>1)[0] array([2, 6], dtype=int64) >>> E = I[pos] array([2, 8], dtype=int64) >>> E = np.append(E, I[-1]) array([ 2, 8, 14], dtype=int64) \u76f8\u5e94\u5730\uff0c pos \u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e I[pos+1] \u5bf9\u5e94\u7a7a\u767d\u533a\u95f4\u7684\u7ed3\u675f\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u662f\u6709\u6548\u5206\u5272\u533a\u57df\u7684\u5f00\u59cb\u7d22\u5f15 S \u3002\u6ce8\u610f\uff0c\u6b64\u65f6\u5e76\u672a\u8003\u8651\u7b2c\u4e00\u4e2a\u533a\u57df\uff0c\u9700\u8981\u989d\u5916\u63d2\u5165\u5230\u6700\u524d\u9762\u3002 >>> S = I[pos+1] array([ 5, 12], dtype=int64) >>> S = np.insert(S, 0, I[0]) array([ 0, 5, 12], dtype=int64) \u7efc\u5408\u8d77\u59cb\u7d22\u5f15 [ 0, 5, 12] \u548c\u7ed3\u675f\u7d22\u5f15 [ 2, 8, 14] \uff0c\u4e5f\u5f97\u5230\u4e86\u540c\u6837\u6b63\u786e\u7684\u4e09\u4e2a\u533a\u95f4\u3002 Python\u5b9e\u73b0 \u00b6 \u6700\u540e\uff0c\u6c47\u603b\u4ee3\u7801\u5982\u4e0b\u3002\u6ce8\u610f\uff1a\u5206\u5272\u540e\u7684\u533a\u57df\u7406\u8bba\u4e0a\u662f\u5206\u5c42\u7ea7\u7684\uff0c\u4e0d\u8fc7\u4ee5\u4e0b\u5b9e\u73b0\u4e2d\u5c06\u6240\u6709\u533a\u57df\u653e\u5728\u4e00\u4e2a\u540c\u7ea7\u5217\u8868\u4e2d\u3002 # ------------------------------------------------------------------------------------------- # Implementation of recursive X-Y cut algorithm, which is: # a top-down page segmentation technique that decomposes a document image recursively into a # set of rectangular blocks. # # - https://en.wikipedia.org/wiki/Recursive_X-Y_cut # - Recursive X-Y Cut using Bounding Boxes of Connected Components by Jaekyu Ha, # Robert M.Haralick and Ihsin T. Phillips # ------------------------------------------------------------------------------------------- def recursive_xy_cut(img_binary:np.array, min_w:float=0.0, min_h:float=0.0, min_dx:float=15.0, min_dy:float=15.0): '''Split image with recursive xy-cut algorithm. Args: img_binary (np.array): Binarized image with interesting region (255) and empty region (0). min_w (float): Ignore bbox if the width is less than this value. min_h (float): Ignore bbox if the height is less than this value. min_dx (float): Merge two bbox-es if the x-gap is less than this value. min_dy (float): Merge two bbox-es if the y-gap is less than this value. Returns: list: bbox (x0, y0, x1, y1) of split blocks. ''' def xy_cut(arr:np.array, top_left:tuple, res:list, min_w:float, min_h:float, min_dx:float, min_dy:float): x0, y0 = top_left h, w = arr.shape # cut along x-direction projection = np.count_nonzero(arr==255, axis=1) pos_y = _split_projection_profile(projection, min_w, min_dy) if not pos_y: return # cut along y-direction for each part arr_y0, arr_y1 = pos_y for r0, r1 in zip(arr_y0, arr_y1): x_arr = arr[r0:r1, 0:w] projection = np.count_nonzero(x_arr==255, axis=0) pos_x = _split_projection_profile(projection, min_h, min_dx) if not pos_x: continue # determined the block bbox arr_x0, arr_x1 = pos_x if len(arr_x0)==1: res.append((x0+arr_x0[0], y0+r0, x0+arr_x1[0], y0+r1)) continue # xy-cut recursively if the count of blocks > 1 for c0, c1 in zip(arr_x0, arr_x1): y_arr = arr[r0:r1, c0:c1] top_left = (x0+c0, y0+r0) xy_cut(y_arr, top_left, res, min_w, min_h, min_dx, min_dy) # do xy-cut recursively res = [] xy_cut(arr=img_binary, top_left=(0, 0), res=res, min_w=min_w, min_h=min_h, min_dx=min_dx, min_dy=min_dy) return res def _split_projection_profile(arr_values:np.array, min_value:float, min_gap:float): '''Split projection profile: ``` \u250c\u2500\u2500\u2510 arr_values \u2502 \u2502 \u250c\u2500\u2510\u2500\u2500\u2500 \u250c\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 | \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502min_value \u2502 \u2502<- min_gap ->\u2502 \u2502 \u2502 \u2502 \u2502 \u2502 | \u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2500\u2500 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ``` Args: arr_values (np.array): 1-d array representing the projection profile. min_value (float): Ignore the profile if `arr_value` is less than `min_value`. min_gap (float): Ignore the gap if less than this value. Returns: tuple: Start indexes and end indexes of split groups. ''' # all indexes with projection height exceeding the threshold arr_index = np.where(arr_values>min_value)[0] if not len(arr_index): return # find zero intervals between adjacent projections # | | || # ||||<- zero-interval -> ||||| arr_diff = arr_index[1:] - arr_index[0:-1] arr_diff_index = np.where(arr_diff>min_gap)[0] arr_zero_intvl_start = arr_index[arr_diff_index] arr_zero_intvl_end = arr_index[arr_diff_index+1] # convert to index of projection range: # the start index of zero interval is the end index of projection arr_start = np.insert(arr_zero_intvl_end, 0, arr_index[0]) arr_end = np.append(arr_zero_intvl_start, arr_index[-1]) arr_end += 1 # end index will be excluded as index slice return arr_start, arr_end","title":"\u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5"},{"location":"2021-06-19-%E9%80%92%E5%BD%92%E6%8A%95%E5%BD%B1%E5%88%86%E5%89%B2%E7%AE%97%E6%B3%95/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2021-06-19 | \u5206\u7c7b\uff1a mathematics \u9012\u5f52\u6295\u5f71\u5206\u5272\uff08Recursive XY Cut\uff09\u662f\u4e00\u79cd\u81ea\u9876\u5411\u4e0b\u7684\u7248\u9762\u5206\u5272\u65b9\u6cd5\uff0c\u5c06\u9875\u9762\u5206\u5272\u6210\u4e00\u7cfb\u5217\u76f8\u5bf9\u72ec\u7acb\u7684\u77e9\u5f62\u533a\u57df\u3002\u4f8b\u5982\uff0c\u6839\u636e\u7ad6\u76f4\u65b9\u5411\u95f4\u9699\u7684\u4e0d\u540c\uff0c\u53ef\u4ee5\u5212\u5206\u6bb5\u843d\u3001\u884c\u3002\u672c\u6587\u8bb0\u5f55\u8be5\u7b97\u6cd5\u7684\u601d\u8def\u548c\u5b9e\u73b0\u3002","title":"\u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5"},{"location":"2021-06-19-%E9%80%92%E5%BD%92%E6%8A%95%E5%BD%B1%E5%88%86%E5%89%B2%E7%AE%97%E6%B3%95/#_2","text":"\u6b64\u7b97\u6cd5\u7684\u8f93\u5165\u662f\u4e00\u5f20\u4e8c\u503c\u5316\u7684\u56fe\u7247\uff0c\u6bcf\u4e00\u4e2a\u50cf\u7d20\u7684\u503c\u4e3a0\u6216\u8005255\u3002\u5e76\u4e14\uff0c\u672c\u6587\u7ea6\u5b9a 255\u8868\u793a\u6709\u6548\u533a\u57df\uff0c0\u8868\u793a\u9875\u9762\u7a7a\u767d \u3002 \u5bf9\u4e8c\u503c\u56fe\u4f5c\u6c34\u5e73\u6295\u5f71\uff0c\u6839\u636e\u95f4\u9699\u5206\u5272\u5b50\u56fe\uff0c\u786e\u5b9a\u5b50\u56fe\u533a\u57df\u7684\u4e0a\u4e0b\u8fb9\u754c \u5bf9\u6bcf\u4e00\u4e2a\u5b50\u56fe\u4f5c\u5782\u76f4\u6295\u5f71\uff0c\u6839\u636e\u95f4\u9699\u8fdb\u4e00\u6b65\u5206\u5272\u5b50\u56fe\uff0c\u786e\u5b9a\u5b50\u56fe\u7684\u5de6\u53f3\u8fb9\u754c \u6839\u636e\u524d\u4e24\u6b65\u5f97\u5230\u4e00\u6b21\u5206\u5272\u540e\u7684\u77e9\u5f62\u6846 \u5bf9\u8be5\u77e9\u5f62\u6846\u5185\u7684\u5b50\u56fe\uff0c\u91cd\u590d\u5982\u4e0a\u8fc7\u7a0b\uff1b\u76f4\u5230\u6c34\u5e73\u6295\u5f71\u5206\u5272\u6ca1\u6709\u5f97\u5230\u65b0\u7684\u5b50\u56fe\uff0c\u6216\u8005\u5782\u76f4\u6295\u5f71\u5206\u5272\u5f97\u5230\u5b50\u56fe\u6570<=2 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 1 \u2502 root \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 1\u2500\u2500\u2534\u2500\u2500\u25002-5 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 2 \u2502 \u2502 3 \u2502 2\u2500\u2500\u2500\u2500\u2534\u2500\u25003-5 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2510 \u250c\u2500\u2500\u2510 4-5 \u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u25003 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u25024 \u2502 \u2502 5\u2502 4\u2500\u2500\u2500\u2534\u2500\u2500\u25005 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2518 \u2514\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518 (a) normal layout (b) hierarchy (c) unavailable layout \u4ee5\u4e0a\u56fe\uff08a\uff09\u6240\u793a\u7248\u9762\u4e3a\u4f8b\uff0c\u6700\u7ec8\u5f97\u5230\u5404\u4e2a\u533a\u57df\u53ca\u5176\u5c42\u7ea7\u5173\u7cfb\u6811\u5982\u56fe\uff08b\uff09\u6240\u793a\u3002 \u7b2c\u4e00\u6b21\u9012\u5f52\uff1a\u6c34\u5e73\u6295\u5f71\u5206\u79bb\u51fa\u5b50\u56fe\u533a\u57df1\u548c\u5b50\u56fe\u533a\u57df2-5\uff0c\u7136\u540e\u5206\u522b\u5bf9\u8fd9\u4e24\u4e2a\u5b50\u56fe\u8fdb\u884c\u5782\u76f4\u6295\u5f71\uff1a \u5b50\u56fe\u533a\u57df1\uff1a\u5f97\u5230\u552f\u4e00\u5b50\u56fe1\uff0c\u56e0\u6b64\u5b8c\u5168\u786e\u5b9a\u533a\u57df1\u7684\u77e9\u5f62\u6846\uff0c\u4e14\u4e0d\u5fc5\u8fdb\u5165\u4e0b\u4e00\u6b21\u9012\u5f52 \u5b50\u56fe\u533a\u57df2-5\uff1a\u5206\u79bb\u51fa\u533a\u57df2\u548c\u5b50\u56fe\u533a\u57df3-5\uff1b\u56e0\u4e3a\u5f97\u5230\u4e24\u4e2a\u533a\u57df\uff0c\u8fd8\u9700\u8fdb\u5165\u4e0b\u4e00\u6b21\u9012\u5f52 \u7b2c\u4e8c\u6b21\u9012\u5f52\uff1a \u533a\u57df2\uff1a\u6c34\u5e73\u548c\u5782\u76f4\u6295\u5f71\u90fd\u5f97\u5230\u552f\u4e00\u5b50\u56fe2\uff0c\u505c\u6b62 \u533a\u57df3-5\uff1a\u6c34\u5e73\u6295\u5f71\u5206\u5272\u51fa3\u548c4-5\uff0c3\u7684\u5782\u76f4\u6295\u5f71\u5b8c\u5168\u786e\u5b9a3\uff0c\u505c\u6b62\uff1b4-5\u7684\u5782\u76f4\u6295\u5f71\u5206\u5272\u51fa4\u548c5\uff0c\u7ee7\u7eed\u8fdb\u5165\u4e0b\u4e00\u8f6e \u7b2c\u4e09\u6b21\u9012\u5f52\uff1a\u6c34\u5e73\u3001\u5782\u76f4\u5206\u5272\u5206\u522b\u786e\u5b9a\u533a\u57df4\u548c5 \u5c40\u9650 \u9012\u5f52\u6295\u5f71\u5206\u5272\u6cd5\u4ec5\u5bf9\u6309\u77e9\u5f62\u5206\u5757\u7684\u7248\u9762\u6709\u6548\uff0c\u65e0\u6cd5\u5904\u7406\u76f8\u4e92\u5d4c\u5165\u7684\u77e9\u5f62\uff0c\u4f8b\u5982\u56fe\uff08c\uff09\u3002","title":"\u57fa\u672c\u6b65\u9aa4"},{"location":"2021-06-19-%E9%80%92%E5%BD%92%E6%8A%95%E5%BD%B1%E5%88%86%E5%89%B2%E7%AE%97%E6%B3%95/#_3","text":"\u5728\u4e86\u89e3\u57fa\u672c\u539f\u7406\u540e\uff0c\u6211\u4eec\u9010\u6e10\u8fdb\u5165\u7ec6\u8282\u548c\u4ee3\u7801\u5b9e\u73b0\u5c42\u9762\u3002 \u6c34\u5e73\u6295\u5f71\uff1a\u4e8c\u7ef4\u56fe\u50cf\uff08\u4e8c\u503c\u56fe\uff09\u5728y\u8f74\u4e0a\u7684\u6295\u5f71\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u884c\u4e2d\u7b49\u4e8e255\u7684\u50cf\u7d20\u7684\u4e2a\u6570 \u5782\u76f4\u6295\u5f71\uff1a\u4e8c\u7ef4\u56fe\u50cf\uff08\u4e8c\u503c\u56fe\uff09\u5728x\u8f74\u4e0a\u7684\u6295\u5f71\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u5217\u4e2d\u7b49\u4e8e255\u7684\u50cf\u7d20\u7684\u4e2a\u6570 \u501f\u52a9 opencv \uff0c\u56fe\u50cf\u6570\u636e\u5df2\u7ecf\u662f numpy.ndarray \u7c7b\u578b\u4e86\uff0c\u6240\u4ee5\u65e0\u9700\u5faa\u73af\u7edf\u8ba1\uff0c\u800c\u662f\u91c7\u7528\u66f4\u4e3a\u9ad8\u6548\u7684numpy\u51fd\u6570\uff1a x_projection = np.count_nonzero(img==255, axis=1) y_projection = np.count_nonzero(img==255, axis=0) \u6295\u5f71\u7ed3\u679c\u672c\u8d28\u4e0a\u662f\u4e00\u7ef4\u6570\u7ec4\uff0c\u4ee5\u6570\u503c\u5927\u5c0f\u4e3a\u9ad8\u5ea6\u7ed8\u5236\u5728\u5750\u6807\u8f74\u4e0a\u5f97\u5230\u6295\u5f71\u8f6e\u5ed3\u3002\u5176\u4e2d\uff0c\u5927\u4e8e\u9608\u503c\uff08\u4f8b\u59820\uff09\u7684\u4f4d\u7f6e\u8868\u73b0\u4e3a\u5c71\u5cf0\uff0c\u8868\u5f81\u6709\u6548\u50cf\u7d20\u533a\u57df\uff1b\u5c0f\u4e8e\u9608\u503c\u7684\u4f4d\u7f6e\u4e3a\u5c71\u8c37\uff0c\u8868\u73b0\u4e3a\u7a7a\u767d\uff08\u5ffd\u7565\uff09\u533a\u57df\u3002\u5c71\u8c37\u5206\u5272\u4e86\u5c71\u5cf0\u533a\u57df\uff0c\u6bcf\u4e00\u5ea7\u5c71\u5373\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u533a\u57df\u3002 x x x xx xx x x x x x xxx xxx x xxxxx xxx xxxx xxxx xx xxxxxx xxxxx xxxxx xxxx xx xxxxxxxxxxxxx xxxxxxxx xxx xxxxx xxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx","title":"\u6c34\u5e73\u6295\u5f71\u548c\u5782\u76f4\u6295\u5f71"},{"location":"2021-06-19-%E9%80%92%E5%BD%92%E6%8A%95%E5%BD%B1%E5%88%86%E5%89%B2%E7%AE%97%E6%B3%95/#_4","text":"\u6839\u636e\u6295\u5f71\u8f6e\u5ed3\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u5272\u51fa\u72ec\u7acb\u533a\u57df\u3002\u5206\u5272\u7ed3\u679c\u4f9d\u8d56\u4e8e\u4e24\u7c7b\u9608\u503c\uff1a \u6700\u5c0f\u6295\u5f71\u503c min_value \uff0c\u8868\u793a\u6cbf\u7740\u6295\u5f71\u65b9\u5411\u4e0a\u7684\u6709\u6548\u50cf\u7d20\u6570\u3002\u5bf9\u4e8e\u6c34\u5e73\u6295\u5f71\u6765\u8bf4\uff0c\u5373\u4e3a\u9700\u8981\u5173\u6ce8\u7684\u77e9\u5f62\u7684\u6700\u5c0f\u5bbd\u5ea6\u3002 \u6295\u5f71\u95f4\u9699 min_gap \uff0c\u8868\u793a\u4e24\u4e2a\u533a\u57df\u5728\u5782\u76f4\u6295\u5f71\u65b9\u5411\u4e0a\u7684\u6700\u5c0f\u8ddd\u79bb\u3002\u5bf9\u4e8e\u6c34\u5e73\u6295\u5f71\u6765\u8bf4\uff0c\u4f8b\u5982\u6bb5\u95f4\u8ddd\u3001\u884c\u95f4\u8ddd\u7b49\u53c2\u6570\u3002 \u250c\u2500\u2500\u2510 projection \u2502 \u2502 \u250c\u2500\u2510\u2500\u2500\u2500 \u250c\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 | \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502min_value \u2502 \u2502<- min_gap ->\u2502 \u2502 \u2502 \u2502 \u2502 \u2502 | \u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2500\u2500 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u4e0b\u9762\u7ed9\u4e00\u4e2a\u5b9e\u4f8b\u6f14\u793a\uff0c\u5047\u8bbe\u6295\u5f71\u6570\u7ec4\uff1a >>> P = np.array([1, 2, 3, 0, 0, 1, 2, 3, 4, 0, 0, 0, 1, 2, 3, 0]) \u4e3a\u7b80\u5316\u95ee\u9898\uff0c\u5047\u5b9a\u4e24\u7c7b\u9608\u503c\u90fd\u7b49\u4e8e0\u3002\u90a3\u4e48\uff0c\u901a\u8fc7\u904d\u5386\u6295\u5f71\u6570\u7ec4\uff0c\u6570\u4e00\u6570\u8fde\u7eed\u7684\u975e\u96f6\u5143\u7d20\uff0c\u5373\u53ef\u5f97\u52303\u4e2a\u5b50\u533a\u57df\uff0c\u5176\u4f4d\u7f6e\u7d22\u5f15\u8303\u56f4\u5206\u522b\u662f\uff1a[0,2]\uff0c[5,8]\u548c[12,14]\u3002 \u4f46\u65e2\u7136\u5df2\u7ecf\u7528\u4e0anumpy\u4e86\uff0c\u90a3\u5c31\u6362\u4e0anumpy\u6570\u7ec4\u8fd0\u7b97\u7684\u601d\u7ef4\uff1a \u8ba1\u7b97\u6295\u5f71\u6570\u7ec4\u975e\u96f6\u5143\u7d20\u7684\u7d22\u5f15\u4f4d\u7f6e\u6570\u7ec4 I >>> I = np.where(P>0)[0] array([ 0, 1, 2, 5, 6, 7, 8, 12, 13, 14], dtype=int64) np.where \u8fd4\u56de\u503c\u4e0e\u539f\u6570\u7ec4\u7ef4\u5ea6\u4e00\u81f4\uff0c\u5373\u4e00\u7ef4\u7684\u5143\u7ec4\uff0c\u6240\u4ee5\u53d6\u5176\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002 \u7d22\u5f15\u6570\u7ec4 I \u9519\u4f4d\u6c42\u5dee\u5f97\u5230\u5dee\u503c\u6570\u7ec4 D >>> D=I[1:]-I[0:-1] array([1, 1, 3, 1, 1, 1, 4, 1, 1], dtype=int64) \u5dee\u503c\u6570\u7ec4 D \u5927\u4e8e1\uff08\u5373\u81f3\u5c11\u95f4\u96941\u50cf\u7d20\uff09\u7684\u5143\u7d20\u7684\u7d22\u5f15\u4f4d\u7f6e pos \u5bf9\u5e94 I \u4e2d\u5143\u7d20\u7684\u503c I[pos] \uff0c\u5373\u4e3a\u7a7a\u767d\u533a\u95f4\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u5bf9\u5e94\u6709\u6548\u5206\u5272\u533a\u57df\u7684\u7ed3\u675f\u7d22\u5f15 E \u3002\u6ce8\u610f\uff0c\u6b64\u65f6\u5e76\u672a\u8003\u8651\u6700\u540e\u4e00\u4e2a\u533a\u57df\uff0c\u9700\u8981\u989d\u5916\u8865\u5230\u6700\u540e\u3002 >>> pos = np.where(D>1)[0] array([2, 6], dtype=int64) >>> E = I[pos] array([2, 8], dtype=int64) >>> E = np.append(E, I[-1]) array([ 2, 8, 14], dtype=int64) \u76f8\u5e94\u5730\uff0c pos \u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e I[pos+1] \u5bf9\u5e94\u7a7a\u767d\u533a\u95f4\u7684\u7ed3\u675f\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u662f\u6709\u6548\u5206\u5272\u533a\u57df\u7684\u5f00\u59cb\u7d22\u5f15 S \u3002\u6ce8\u610f\uff0c\u6b64\u65f6\u5e76\u672a\u8003\u8651\u7b2c\u4e00\u4e2a\u533a\u57df\uff0c\u9700\u8981\u989d\u5916\u63d2\u5165\u5230\u6700\u524d\u9762\u3002 >>> S = I[pos+1] array([ 5, 12], dtype=int64) >>> S = np.insert(S, 0, I[0]) array([ 0, 5, 12], dtype=int64) \u7efc\u5408\u8d77\u59cb\u7d22\u5f15 [ 0, 5, 12] \u548c\u7ed3\u675f\u7d22\u5f15 [ 2, 8, 14] \uff0c\u4e5f\u5f97\u5230\u4e86\u540c\u6837\u6b63\u786e\u7684\u4e09\u4e2a\u533a\u95f4\u3002","title":"\u5206\u5272\u6295\u5f71\u8f6e\u5ed3"},{"location":"2021-06-19-%E9%80%92%E5%BD%92%E6%8A%95%E5%BD%B1%E5%88%86%E5%89%B2%E7%AE%97%E6%B3%95/#python","text":"\u6700\u540e\uff0c\u6c47\u603b\u4ee3\u7801\u5982\u4e0b\u3002\u6ce8\u610f\uff1a\u5206\u5272\u540e\u7684\u533a\u57df\u7406\u8bba\u4e0a\u662f\u5206\u5c42\u7ea7\u7684\uff0c\u4e0d\u8fc7\u4ee5\u4e0b\u5b9e\u73b0\u4e2d\u5c06\u6240\u6709\u533a\u57df\u653e\u5728\u4e00\u4e2a\u540c\u7ea7\u5217\u8868\u4e2d\u3002 # ------------------------------------------------------------------------------------------- # Implementation of recursive X-Y cut algorithm, which is: # a top-down page segmentation technique that decomposes a document image recursively into a # set of rectangular blocks. # # - https://en.wikipedia.org/wiki/Recursive_X-Y_cut # - Recursive X-Y Cut using Bounding Boxes of Connected Components by Jaekyu Ha, # Robert M.Haralick and Ihsin T. Phillips # ------------------------------------------------------------------------------------------- def recursive_xy_cut(img_binary:np.array, min_w:float=0.0, min_h:float=0.0, min_dx:float=15.0, min_dy:float=15.0): '''Split image with recursive xy-cut algorithm. Args: img_binary (np.array): Binarized image with interesting region (255) and empty region (0). min_w (float): Ignore bbox if the width is less than this value. min_h (float): Ignore bbox if the height is less than this value. min_dx (float): Merge two bbox-es if the x-gap is less than this value. min_dy (float): Merge two bbox-es if the y-gap is less than this value. Returns: list: bbox (x0, y0, x1, y1) of split blocks. ''' def xy_cut(arr:np.array, top_left:tuple, res:list, min_w:float, min_h:float, min_dx:float, min_dy:float): x0, y0 = top_left h, w = arr.shape # cut along x-direction projection = np.count_nonzero(arr==255, axis=1) pos_y = _split_projection_profile(projection, min_w, min_dy) if not pos_y: return # cut along y-direction for each part arr_y0, arr_y1 = pos_y for r0, r1 in zip(arr_y0, arr_y1): x_arr = arr[r0:r1, 0:w] projection = np.count_nonzero(x_arr==255, axis=0) pos_x = _split_projection_profile(projection, min_h, min_dx) if not pos_x: continue # determined the block bbox arr_x0, arr_x1 = pos_x if len(arr_x0)==1: res.append((x0+arr_x0[0], y0+r0, x0+arr_x1[0], y0+r1)) continue # xy-cut recursively if the count of blocks > 1 for c0, c1 in zip(arr_x0, arr_x1): y_arr = arr[r0:r1, c0:c1] top_left = (x0+c0, y0+r0) xy_cut(y_arr, top_left, res, min_w, min_h, min_dx, min_dy) # do xy-cut recursively res = [] xy_cut(arr=img_binary, top_left=(0, 0), res=res, min_w=min_w, min_h=min_h, min_dx=min_dx, min_dy=min_dy) return res def _split_projection_profile(arr_values:np.array, min_value:float, min_gap:float): '''Split projection profile: ``` \u250c\u2500\u2500\u2510 arr_values \u2502 \u2502 \u250c\u2500\u2510\u2500\u2500\u2500 \u250c\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 | \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502min_value \u2502 \u2502<- min_gap ->\u2502 \u2502 \u2502 \u2502 \u2502 \u2502 | \u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2534\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2534\u2500\u2500\u2500 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ``` Args: arr_values (np.array): 1-d array representing the projection profile. min_value (float): Ignore the profile if `arr_value` is less than `min_value`. min_gap (float): Ignore the gap if less than this value. Returns: tuple: Start indexes and end indexes of split groups. ''' # all indexes with projection height exceeding the threshold arr_index = np.where(arr_values>min_value)[0] if not len(arr_index): return # find zero intervals between adjacent projections # | | || # ||||<- zero-interval -> ||||| arr_diff = arr_index[1:] - arr_index[0:-1] arr_diff_index = np.where(arr_diff>min_gap)[0] arr_zero_intvl_start = arr_index[arr_diff_index] arr_zero_intvl_end = arr_index[arr_diff_index+1] # convert to index of projection range: # the start index of zero interval is the end index of projection arr_start = np.insert(arr_zero_intvl_end, 0, arr_index[0]) arr_end = np.append(arr_zero_intvl_start, arr_index[-1]) arr_end += 1 # end index will be excluded as index slice return arr_start, arr_end","title":"Python\u5b9e\u73b0"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/","text":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-06-26 | \u5206\u7c7b\uff1a process automation \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cPDF\u63d0\u53d6\u51fa\u7684\u8def\u5f84 Path \u662f\u4e00\u4e9b\u76f4\u7ebf/\u66f2\u7ebf\u63cf\u8fb9\uff08Stroke\uff09\u6216\u586b\u5145\uff08Fill\uff09\uff0c\u53ef\u4ee5\u7528\u4e8e\u8868\u683c\u8fb9\u6846/\u5355\u5143\u683c\u80cc\u666f\u3001\u6587\u5b57\u9ad8\u4eae/\u4e0b\u5212\u7ebf\u7b49\u6837\u5f0f\u7684\u89e3\u6790\u3002\u5b9e\u9645\u4e0a\uff0c \u77e2\u91cf\u56fe\u4e5f\u662f\u7531\u8fd9\u4e9b\u8def\u5f84\u7ec4\u6210\u7684 \uff0c\u8fd9\u5c31\u53ef\u80fd\u51fa\u73b0\u5982\u4e0b\u95ee\u9898\uff1a \u5bf9\u542b\u6709\u77e2\u91cf\u56fe\u7684\u8def\u5f84\u8fdb\u884c\u8868\u683c\u89e3\u6790\uff0c\u5bfc\u81f4\u9519\u8bef\u7684\u3001\u4e0d\u5b58\u5728\u7684\u8868\u683c\u7ed3\u6784 PyMuPDF \u63d0\u53d6\u7684 pixmap \u5e76\u4e0d\u5305\u542b\u77e2\u91cf\u56fe\uff0c\u5bfc\u81f4\u91cd\u5efa docx \u65f6\u4e22\u5931\u77e2\u91cf\u56fe \u89e3\u51b3\u65b9\u6848\u662f\u8bc6\u522b\u548c\u91cd\u5efa\u77e2\u91cf\u56fe\u3002\u6280\u672f\u5f3a\u5982 Solid Document \uff0c\u53ef\u4ee5\u5728Word\u4e2d\u4ee5Shape\u5f62\u5f0f\u8fd1\u4e4e\u5b8c\u7f8e\u91cd\u5efa\u77e2\u91cf\u56fe\uff1b\u5948\u4f55\u672c\u4eba\u6c34\u5e73\u6709\u9650\uff0c\u53ea\u80fd\u91c7\u7528\u622a\u56fe\u7684\u5f62\u5f0f\u622a\u53d6\u77e2\u91cf\u56fe\u533a\u57df\uff0c\u7136\u540e\u63d2\u5165\u5230Word\u4e2d\u76f8\u5e94\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u622a\u56fe\u524d\u9700\u8981\u9690\u85cf\u6587\u5b57\uff0c\u4ee5\u907f\u514d\u622a\u56fe\u7684\u6587\u5b57\u548c\u539f\u6765\u7684\u6587\u672c\u91cd\u590d\u3002\u81f3\u6b64\uff0c\u5173\u952e\u7684\u5de5\u4f5c\u662f\u8bc6\u522b\u77e2\u91cf\u56fe\u533a\u57df\u2014\u2014\u672c\u6587\u8bb0\u5f55\u9488\u5bf9\u6b64\u95ee\u9898\u63a2\u7d22\u7684\u4e00\u4e9b\u65b9\u6848\u3002 \u8def\u5f84\u5206\u7ec4+\u66f2\u7ebf\u6bd4\u4f8b\u5224\u636e \u00b6 \u8fd9\u662f <=0.5.2 \u7248\u672c\u4e00\u76f4\u91c7\u7528\u7684\u65b9\u6848\uff0c\u57fa\u4e8e**\u57fa\u672c\u5047\u8bbe**\uff1a\u8003\u8651\u5230\u590d\u6742\u56fe\u5f62/\u5f62\u72b6\u7684\u5c55\u73b0\u79bb\u4e0d\u5f00\u66f2\u7ebf\uff0c\u5047\u8bbe\u77e2\u91cf\u56fe\u4e2d\u5fc5\u7136\u5b58\u5728 \u4e00\u5b9a\u6bd4\u4f8b \u7684\u66f2\u7ebf\u8def\u5f84\u3002\u5206\u4e3a\u4e24\u6b65\uff0c\u540c\u65f6\u4e5f\u662f\u4e24\u4e2a\u5173\u952e\u70b9\uff1a \u4ee5\u662f\u5426\u76f8\u4ea4\u4e3a\u4f9d\u636e\u5206\u7ec4\u6240\u6709\u8def\u5f84 \uff0c\u6bcf\u4e00\u7ec4\u8def\u5f84\u90fd\u662f\u6f5c\u5728\u7684\u77e2\u91cf\u56fe\u3001\u8868\u683c\u533a\u57df\uff0c\u5f53\u7136\u4e5f\u53ef\u80fd\u662f\u6587\u672c\u6837\u5f0f\u4f8b\u5982\u4e00\u6761\u4e0b\u5212\u7ebf \u7edf\u8ba1\u6bcf\u4e00\u4e2a\u5206\u7ec4\u4e2d\u7684\u66f2\u7ebf\u8def\u5f84\uff1a \u66f2\u7ebf\u8def\u5f84\u6570\u91cf\u7684\u5360\u6bd4\u8fbe\u5230\u9608\u503c\uff08\u53ef\u81ea\u5b9a\u4e49\uff09\uff0c\u8be5\u5206\u7ec4\u5373\u88ab\u8ba4\u4e3a\u662f\u77e2\u91cf\u56fe\uff0c\u8fdb\u800c\u622a\u56fe\u4f5c\u4e3a\u666e\u901a\u56fe\u7247\u5904\u7406 \u5426\u5219\uff0c\u4ec5\u4fdd\u7559\u8be5\u5206\u7ec4\u4e2d\u6b63\u4ea4\u4e8e\u5750\u6807\u8f74\u7684\u8def\u5f84\uff0c\u7528\u4e8e\u540e\u7eed\u8868\u683c\u3001\u6587\u5b57\u6837\u5f0f\u7684\u89e3\u6790 (a) \u4ee5\u662f\u5426\u76f8\u4ea4\u4e3a\u4f9d\u636e\u5206\u7ec4\u6240\u6709\u8def\u5f84 \u00b6 \u56fe\u662f\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u76f4\u63a5\u624b\u6bb5\uff1a \u6bcf\u4e00\u6761\u8def\u5f84\u770b\u4f5c\u56fe\u7684 \u9876\u70b9 \uff0c\u4e24\u6761\u8def\u5f84\u662f\u5426\u76f8\u4ea4\u6784\u6210\u4e86 \u8fb9 \u4e8e\u662f\uff0c\u6240\u6709\u8def\u5f84\u53ca\u5176\u8fde\u63a5\u5173\u7cfb\u6784\u6210\u4e86\u4e00\u4e2a \u975e\u8fde\u901a\u56fe \u904d\u5386\u8fd9\u4e2a\u975e\u8fde\u901a\u56fe\u5f97\u5230\u6bcf\u4e00\u4e2a \u8fde\u901a\u5206\u91cf \uff0c\u5373\u4e3a\u6bcf\u4e00\u4e2a\u5206\u7ec4 \u5173\u952e\u70b9\u5728\u4e8e\u5efa\u7acb\u8fd9\u4e2a\u56fe\uff0c\u5373\u4ee5 \u4efb\u610f\u4e24\u6761\u8def\u5f84\u662f\u5426\u76f8\u4ea4 \u4e3a\u4f9d\u636e\u5efa\u7acb\u56fe\u7684\u90bb\u63a5\u5217\u8868\u8868\u793a\u3002\u4e3a\u964d\u4f4e\u590d\u6742\u5ea6\uff0c\u5f15\u5165\u7b80\u5316\u5904\u7406\uff1a\u5224\u65ad\u8def\u5f84\u7684\u5305\u7edc\u77e9\u5f62\u662f\u5426\u76f8\u4ea4\u3002\u6ce8\u610f\u672c\u6587\u63d0\u53ca\u7684\u5305\u7edc\u77e9\u5f62 Boundary Box \u90fd\u662f\u5e73\u884c\u4e8e\u5750\u6807\u8f74\u7684\uff08 ISO-oriented \uff09\u3002 \u5177\u4f53\u7ec6\u8282\u53c2\u8003\uff1a \u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 Rectangle-Intersection-Problem (b) \u4ee5\u66f2\u7ebf\u8def\u5f84\uff08\u8bed\u4e49\u4e0a\uff09\u6570\u91cf\u6bd4\u4f8b\u4e3a\u4f9d\u636e\u5224\u5b9a\u77e2\u91cf\u56fe \u00b6 \u901a\u5e38\uff0c\u8868\u683c\u7684\u8fb9\u6846/\u80cc\u666f\u3001\u6587\u672c\u6837\u5f0f\u5982\u9ad8\u4eae/\u4e0b\u5212\u7ebf\u7b49\u90fd\u662f\u6c34\u5e73\u6216\u8005\u7ad6\u76f4\u7684\u8def\u5f84\uff1b\u4f46\u662f\u5b58\u5728\u4f8b\u5916\u60c5\u51b5\uff0c\u4f8b\u5982\u67d0\u4e9bPDF\u7f16\u8f91\u5668\u7684\u6587\u672c\u9ad8\u4eae\u6ce8\u91ca\u662f\u4e00\u4e2a \u5706\u89d2\u77e9\u5f62 \u586b\u5145\u533a\u57df\u2014\u2014\u5b83\u7684\u8fb9\u754c\u7531\u56db\u6bb5\u5706\u89d2\u66f2\u7ebf\u548c\u5404\u8fb9\u7684\u76f4\u7ebf\u8def\u5f84\u7ec4\u6210\uff0c\u51e0\u4f55\u4e0a\u5b83\u5c5e\u4e8e\u66f2\u7ebf\uff0c\u4f46\u8bed\u4e49\u4e0a\u503e\u5411\u4e8e\u7528\u4e8e\u6587\u672c\u6837\u5f0f\u89e3\u6790\u7684\u666e\u901a\u77e9\u5f62\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u4ece\u8bed\u4e49\u7684\u89d2\u5ea6\u533a\u5206\u51e0\u4f55\u4e0a\u7684\u66f2\u7ebf\u8def\u5f84\u3002 \u5b9a\u4e49\u8bed\u4e49\u4e0a\u7684\u66f2\u7ebf\u8def\u5f84\u4e3a\uff1a \u8def\u5f84\u56f4\u6210\u9762\u79ef\u4e0e\u5305\u7edc\u77e9\u5f62\u9762\u79ef\u4e4b\u6bd4\u5c0f\u4e8e\u9608\u503c\uff08\u4f8b\u59820.95\uff09\u3002 \u66f2\u7ebf\u56f4\u6210\u9762\u79ef\u7684\u8ba1\u7b97 PDF\u4e2d\u7684\u66f2\u7ebf\u8def\u5f84\u7531 c \u3001 v \u3001 y \u7b49\u7b97\u7b26\u63cf\u8ff0\u7684\u8d1d\u585e\u5c14\u66f2\u7ebf\u8868\u793a\u3002\u6839\u636ePDF\u7ed9\u51fa\u76844\u4e2a\u63a7\u5236\u70b9\u8ba1\u7b97\u53c2\u6570\u65b9\u7a0b\uff0c\u8fdb\u800c\u91c7\u6837\u66f2\u7ebf\u4e0a\u4e00\u7cfb\u5217\u7684\u70b9\uff0c\u5e76\u6839\u636e Shoelace formula \u8ba1\u7b97\u9762\u79ef\u3002 \u6700\u540e\uff0c\u7edf\u8ba1\u6bcf\u4e00\u4e2a\u5206\u7ec4\u4e2d\u8bed\u4e49\u66f2\u7ebf\u8def\u5f84\u6570\u91cf\u7684\u5360\u6bd4\uff0c\u4e00\u65e6\u8d85\u8fc7\u67d0\u4e2a\u9608\u503c\uff0c\u5c31\u8ba4\u4e3a\u8fd9\u4e2a\u5206\u7ec4\u7684\u6240\u6709\u8def\u5f84\u7ec4\u6210\u4e86\u77e2\u91cf\u56fe\u3002 \u8fd9\u4e2a\u65b9\u6848\u7684\u7f3a\u70b9\u5f88\u660e\u663e\uff1a \u5982\u679c\u4e00\u526f\u77e2\u91cf\u56fe\u5b58\u5728\u5b64\u7acb\u7684\u5c40\u90e8\u7279\u5f81\uff0c\u5c06\u88ab\u9519\u8bef\u5730\u62c6\u5206\u4e3a\u591a\u4e2a\u5206\u7ec4 \u5982\u679c\u8868\u683c\u7684\u5355\u5143\u683c\u5185\u5d4c\u5957\u7740\u77e2\u91cf\u56fe\uff0c\u8be5\u77e2\u91cf\u56fe\u5c06\u88ab\u4e22\u5f03 \u9012\u5f52\u6295\u5f71\u5206\u5272+\u5b50\u8f6e\u5ed3+\u66f2\u7ebf\u6bd4\u4f8b\u5224\u636e \u00b6 \u5f53\u524d\u6d4b\u8bd5\u4e2d\u7684\u65b9\u6848\uff0c\u9700\u8981 python-opency \u652f\u6301\u3002\u57fa\u672c\u601d\u8def\uff1a \u9690\u85cf\u6587\u672c\u548c\u666e\u901a\u56fe\u7247\uff0c\u622a\u56fe\u6574\u4e2a\u9875\u9762\u5e76\u8fdb\u884c\u4e8c\u503c\u5316\u540e\u4f5c\u4e3a\u56fe\u7247\u8f93\u5165 \u9012\u5f52\u6295\u5f71\u5206\u5272\u9875\u9762\uff0c\u5f97\u5230\u4e00\u4e9b\u5217\u5b50\u533a\u57df \u9488\u5bf9\u6bcf\u4e00\u4e2a\u5b50\u533a\u57df bbox \uff0c\u7528 opencv \u67e5\u627e\u6240\u6709\u8f6e\u5ed3\uff0c\u63d0\u53d6\u5176\u4e2dlevel-2\u7ea7\u522b\u7684\u5b50\u8f6e\u5ed3 inner_bboxes \u68c0\u67e5\u5305\u542b\u4e8e bbox \u4f46 \u4e0d\u5b58\u5728\u4e8e inner_bboxes \u4e2d\u7684\u8def\u5f84\u96c6\u5408 P \uff0c \u5982\u679c\u66f2\u7ebf\u8def\u5f84\uff08\u8bed\u4e49\uff09\u6570\u91cf\u7684\u5360\u6bd4\u8fbe\u5230\u9608\u503c\uff0c\u5219\u8ba4\u4e3a\u8be5\u5b50\u533a\u57df\u4e3a\u77e2\u91cf\u56fe\uff0c\u8fdb\u800c\u622a\u53d6\u9875\u9762\u7684 bbox \u533a\u57df\u4f5c\u4e3a\u4f4d\u56fe\u5904\u7406 \u5426\u5219\uff0c\u5bfc\u51fa\u8def\u5f84\u96c6\u5408 P \u4f5c\u8fdb\u4e00\u6b65\u8868\u683c\u8fb9\u6846/\u6587\u672c\u6837\u5f0f\u89e3\u6790\uff0c\u540c\u65f6\u622a\u53d6 inner_bboxes \u5b50\u533a\u57df\u7684\u5d4c\u5957\u77e2\u91cf\u56fe \u5176\u4e2d\uff0c\u9012\u5f52\u6295\u5f71\u5206\u5272\uff08recursive xy cut\uff09\u89e3\u51b3\u524d\u4e00\u65b9\u6848\u9057\u7559\u7684\u77e2\u91cf\u56fe\u5c40\u90e8\u7279\u5f81\u95ee\u9898\uff0c\u901a\u8fc7\u8bbe\u7f6e\u5206\u5272\u7684\u95f4\u9699\u53c2\u6570\u5408\u5e76\u90bb\u8fd1\u7684\u672c\u5c5e\u4e8e\u540c\u4e00\u77e2\u91cf\u56fe\u7684\u5b50\u533a\u57df\u3002\u5173\u4e8e\u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5\u7684\u7ec6\u8282\u53c2\u8003\uff1a \u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 Recursive XY Cut \u63d0\u53d6level-2\u5b50\u8f6e\u5ed3\u7684\u7406\u89e3 \u65e8\u5728\u89e3\u51b3\u8868\u683c\u4e2d\u5d4c\u5957\u77e2\u91cf\u56fe\u7684\u95ee\u9898\u3002 \u5982\u679c\u5f53\u524d\u533a\u57df\u4e3a\u8868\u683c\uff0c\u4e14\u67d0\u4e2a\u5355\u5143\u683c\u4e2d\u5b58\u5728\u4e00\u5f20\u77e2\u91cf\u56fe\uff0c\u5219level-0\u4e3a\u8868\u683c\u5916\u8f6e\u5ed3\uff0clevel-1\u4e3a\u8868\u683c\u5185\u8f6e\u5ed3\u5373\u5355\u5143\u683c\u8f6e\u5ed3\uff0c\u4e8e\u662flevel-2\u4e3a\u6f5c\u5728\u7684\u5355\u5143\u683c\u5185\u77e2\u91cf\u56fe\u7684\u8f6e\u5ed3\u3002\u8fd9\u4e5f\u662f\u5224\u65ad\u8def\u5f84\u65f6\u6392\u9664level-2\u7ea7\u8f6e\u5ed3\u7684\u539f\u56e0\u6240\u5728\u3002 \u5982\u679c\u5f53\u524d\u533a\u57df\u4e3a\u77e2\u91cf\u56fe\uff0c\u5219\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5b58\u5728level-2\u8f6e\u5ed3\uff0c\u4ece\u800c\u5e76\u4e0d\u5f71\u54cd\u5224\u65ad\u903b\u8f91\u3002 \u6ce8\u610f opency \u8f6e\u5ed3\u5c42\u7ea7\u7684\u4e00\u4e2a\u7ec6\u8282\uff1a \u5982\u679c\u5355\u5143\u683c\u5185\u77e2\u91cf\u56fe\u4e0e\u5355\u5143\u683c\u8fb9\u6846\u4e4b\u95f4\u7684\u8ddd\u79bb\u5f88\u5c0f\uff0c\u672c\u5e94\u5c5e\u4e8elevel-2\u7684\u77e2\u91cf\u56fe\u8f6e\u5ed3\u5c06\u88ab\u5206\u914d\u5230level-1\u7ea7\uff0c\u5373\u4e0e\u5305\u542b\u5b83\u7684\u5355\u5143\u683c\u8f6e\u5ed3\u5728\u540c\u4e00\u7ea7\u3002\u56e0\u6b64\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u6ce8\u610f\u5c06\u5305\u542b\u4e8e\u5176\u4ed6\u540c\u7ea7\u8f6e\u5ed3\u7684\u4f2alevel-1\u8f6e\u5ed3\u8003\u8651\u5230level-2\u8f6e\u5ed3\u4e2d\u53bb\uff1b\u76f8\u5e94\u5730\uff0c\u6392\u9664level-2\u4e2d\u5305\u542b\u4e8e\u8be5\u4f2alevel-1\u7ea7\u7684\u8f6e\u5ed3\uff0c\u56e0\u4e3a\u5b83\u5b9e\u9645\u4e0a\u5c5e\u4e8elevel-3\u4e86\u3002 \u76f8\u6bd4\u4ece\u8def\u5f84\u672c\u8eab\u51fa\u53d1\u7684\u8def\u5f84\u5206\u7ec4\u65b9\u6848\uff0c\u57fa\u4e8e opencv \u56fe\u50cf\u5904\u7406\u7684\u9012\u5f52\u6295\u5f71\u5206\u5272+\u5b50\u8f6e\u5ed3\u65b9\u6848\u8868\u73b0\u51fa\u4e86\u66f4\u597d\u7684\u7a33\u5b9a\u6027\uff0c\u4f46\u662f\u4f9d\u65e7\u65e0\u6cd5\u6446\u8131\u57fa\u4e8e\u89c4\u5219\u7684\u65b9\u6cd5\u7684\u5c40\u9650\u6027\u2014\u2014\u603b\u662f\u5b58\u5728\u4f8b\u5916\u60c5\u51b5\uff0c\u4f8b\u5982\uff1a\u4e00\u526f\u4e0d\u5305\u542b\u4efb\u4f55\u66f2\u7ebf\u8def\u5f84\u7684\u67f1\u72b6\u56fe\u3002 \u9012\u5f52\u6295\u5f71\u5206\u5272+CNN\u5206\u7c7b \u00b6 \u5f85\u63a2\u7d22\u7684\u65b9\u5411\u3002 opencv \u652f\u6301 tensorflow \u6a21\u578b\u5960\u5b9a\u4e86\u6b64\u65b9\u6848\u90e8\u7f72\u4e0a\u7684\u53ef\u884c\u6027\uff0c\u5269\u4e0b\u9700\u8981\u89e3\u51b3\u7684\u4e24\u4e2a\u5173\u952e\u95ee\u9898\uff1a \u6570\u636e\u96c6\u7684\u51c6\u5907 \u6a21\u578b\u53ca\u7cbe\u5ea6","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/#pdf2docx","text":"\u53d1\u5e03\u4e8e\uff1a2021-06-26 | \u5206\u7c7b\uff1a process automation \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cPDF\u63d0\u53d6\u51fa\u7684\u8def\u5f84 Path \u662f\u4e00\u4e9b\u76f4\u7ebf/\u66f2\u7ebf\u63cf\u8fb9\uff08Stroke\uff09\u6216\u586b\u5145\uff08Fill\uff09\uff0c\u53ef\u4ee5\u7528\u4e8e\u8868\u683c\u8fb9\u6846/\u5355\u5143\u683c\u80cc\u666f\u3001\u6587\u5b57\u9ad8\u4eae/\u4e0b\u5212\u7ebf\u7b49\u6837\u5f0f\u7684\u89e3\u6790\u3002\u5b9e\u9645\u4e0a\uff0c \u77e2\u91cf\u56fe\u4e5f\u662f\u7531\u8fd9\u4e9b\u8def\u5f84\u7ec4\u6210\u7684 \uff0c\u8fd9\u5c31\u53ef\u80fd\u51fa\u73b0\u5982\u4e0b\u95ee\u9898\uff1a \u5bf9\u542b\u6709\u77e2\u91cf\u56fe\u7684\u8def\u5f84\u8fdb\u884c\u8868\u683c\u89e3\u6790\uff0c\u5bfc\u81f4\u9519\u8bef\u7684\u3001\u4e0d\u5b58\u5728\u7684\u8868\u683c\u7ed3\u6784 PyMuPDF \u63d0\u53d6\u7684 pixmap \u5e76\u4e0d\u5305\u542b\u77e2\u91cf\u56fe\uff0c\u5bfc\u81f4\u91cd\u5efa docx \u65f6\u4e22\u5931\u77e2\u91cf\u56fe \u89e3\u51b3\u65b9\u6848\u662f\u8bc6\u522b\u548c\u91cd\u5efa\u77e2\u91cf\u56fe\u3002\u6280\u672f\u5f3a\u5982 Solid Document \uff0c\u53ef\u4ee5\u5728Word\u4e2d\u4ee5Shape\u5f62\u5f0f\u8fd1\u4e4e\u5b8c\u7f8e\u91cd\u5efa\u77e2\u91cf\u56fe\uff1b\u5948\u4f55\u672c\u4eba\u6c34\u5e73\u6709\u9650\uff0c\u53ea\u80fd\u91c7\u7528\u622a\u56fe\u7684\u5f62\u5f0f\u622a\u53d6\u77e2\u91cf\u56fe\u533a\u57df\uff0c\u7136\u540e\u63d2\u5165\u5230Word\u4e2d\u76f8\u5e94\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u622a\u56fe\u524d\u9700\u8981\u9690\u85cf\u6587\u5b57\uff0c\u4ee5\u907f\u514d\u622a\u56fe\u7684\u6587\u5b57\u548c\u539f\u6765\u7684\u6587\u672c\u91cd\u590d\u3002\u81f3\u6b64\uff0c\u5173\u952e\u7684\u5de5\u4f5c\u662f\u8bc6\u522b\u77e2\u91cf\u56fe\u533a\u57df\u2014\u2014\u672c\u6587\u8bb0\u5f55\u9488\u5bf9\u6b64\u95ee\u9898\u63a2\u7d22\u7684\u4e00\u4e9b\u65b9\u6848\u3002","title":"pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/#_1","text":"\u8fd9\u662f <=0.5.2 \u7248\u672c\u4e00\u76f4\u91c7\u7528\u7684\u65b9\u6848\uff0c\u57fa\u4e8e**\u57fa\u672c\u5047\u8bbe**\uff1a\u8003\u8651\u5230\u590d\u6742\u56fe\u5f62/\u5f62\u72b6\u7684\u5c55\u73b0\u79bb\u4e0d\u5f00\u66f2\u7ebf\uff0c\u5047\u8bbe\u77e2\u91cf\u56fe\u4e2d\u5fc5\u7136\u5b58\u5728 \u4e00\u5b9a\u6bd4\u4f8b \u7684\u66f2\u7ebf\u8def\u5f84\u3002\u5206\u4e3a\u4e24\u6b65\uff0c\u540c\u65f6\u4e5f\u662f\u4e24\u4e2a\u5173\u952e\u70b9\uff1a \u4ee5\u662f\u5426\u76f8\u4ea4\u4e3a\u4f9d\u636e\u5206\u7ec4\u6240\u6709\u8def\u5f84 \uff0c\u6bcf\u4e00\u7ec4\u8def\u5f84\u90fd\u662f\u6f5c\u5728\u7684\u77e2\u91cf\u56fe\u3001\u8868\u683c\u533a\u57df\uff0c\u5f53\u7136\u4e5f\u53ef\u80fd\u662f\u6587\u672c\u6837\u5f0f\u4f8b\u5982\u4e00\u6761\u4e0b\u5212\u7ebf \u7edf\u8ba1\u6bcf\u4e00\u4e2a\u5206\u7ec4\u4e2d\u7684\u66f2\u7ebf\u8def\u5f84\uff1a \u66f2\u7ebf\u8def\u5f84\u6570\u91cf\u7684\u5360\u6bd4\u8fbe\u5230\u9608\u503c\uff08\u53ef\u81ea\u5b9a\u4e49\uff09\uff0c\u8be5\u5206\u7ec4\u5373\u88ab\u8ba4\u4e3a\u662f\u77e2\u91cf\u56fe\uff0c\u8fdb\u800c\u622a\u56fe\u4f5c\u4e3a\u666e\u901a\u56fe\u7247\u5904\u7406 \u5426\u5219\uff0c\u4ec5\u4fdd\u7559\u8be5\u5206\u7ec4\u4e2d\u6b63\u4ea4\u4e8e\u5750\u6807\u8f74\u7684\u8def\u5f84\uff0c\u7528\u4e8e\u540e\u7eed\u8868\u683c\u3001\u6587\u5b57\u6837\u5f0f\u7684\u89e3\u6790","title":"\u8def\u5f84\u5206\u7ec4+\u66f2\u7ebf\u6bd4\u4f8b\u5224\u636e"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/#a","text":"\u56fe\u662f\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u76f4\u63a5\u624b\u6bb5\uff1a \u6bcf\u4e00\u6761\u8def\u5f84\u770b\u4f5c\u56fe\u7684 \u9876\u70b9 \uff0c\u4e24\u6761\u8def\u5f84\u662f\u5426\u76f8\u4ea4\u6784\u6210\u4e86 \u8fb9 \u4e8e\u662f\uff0c\u6240\u6709\u8def\u5f84\u53ca\u5176\u8fde\u63a5\u5173\u7cfb\u6784\u6210\u4e86\u4e00\u4e2a \u975e\u8fde\u901a\u56fe \u904d\u5386\u8fd9\u4e2a\u975e\u8fde\u901a\u56fe\u5f97\u5230\u6bcf\u4e00\u4e2a \u8fde\u901a\u5206\u91cf \uff0c\u5373\u4e3a\u6bcf\u4e00\u4e2a\u5206\u7ec4 \u5173\u952e\u70b9\u5728\u4e8e\u5efa\u7acb\u8fd9\u4e2a\u56fe\uff0c\u5373\u4ee5 \u4efb\u610f\u4e24\u6761\u8def\u5f84\u662f\u5426\u76f8\u4ea4 \u4e3a\u4f9d\u636e\u5efa\u7acb\u56fe\u7684\u90bb\u63a5\u5217\u8868\u8868\u793a\u3002\u4e3a\u964d\u4f4e\u590d\u6742\u5ea6\uff0c\u5f15\u5165\u7b80\u5316\u5904\u7406\uff1a\u5224\u65ad\u8def\u5f84\u7684\u5305\u7edc\u77e9\u5f62\u662f\u5426\u76f8\u4ea4\u3002\u6ce8\u610f\u672c\u6587\u63d0\u53ca\u7684\u5305\u7edc\u77e9\u5f62 Boundary Box \u90fd\u662f\u5e73\u884c\u4e8e\u5750\u6807\u8f74\u7684\uff08 ISO-oriented \uff09\u3002 \u5177\u4f53\u7ec6\u8282\u53c2\u8003\uff1a \u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 Rectangle-Intersection-Problem","title":"(a) \u4ee5\u662f\u5426\u76f8\u4ea4\u4e3a\u4f9d\u636e\u5206\u7ec4\u6240\u6709\u8def\u5f84"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/#b","text":"\u901a\u5e38\uff0c\u8868\u683c\u7684\u8fb9\u6846/\u80cc\u666f\u3001\u6587\u672c\u6837\u5f0f\u5982\u9ad8\u4eae/\u4e0b\u5212\u7ebf\u7b49\u90fd\u662f\u6c34\u5e73\u6216\u8005\u7ad6\u76f4\u7684\u8def\u5f84\uff1b\u4f46\u662f\u5b58\u5728\u4f8b\u5916\u60c5\u51b5\uff0c\u4f8b\u5982\u67d0\u4e9bPDF\u7f16\u8f91\u5668\u7684\u6587\u672c\u9ad8\u4eae\u6ce8\u91ca\u662f\u4e00\u4e2a \u5706\u89d2\u77e9\u5f62 \u586b\u5145\u533a\u57df\u2014\u2014\u5b83\u7684\u8fb9\u754c\u7531\u56db\u6bb5\u5706\u89d2\u66f2\u7ebf\u548c\u5404\u8fb9\u7684\u76f4\u7ebf\u8def\u5f84\u7ec4\u6210\uff0c\u51e0\u4f55\u4e0a\u5b83\u5c5e\u4e8e\u66f2\u7ebf\uff0c\u4f46\u8bed\u4e49\u4e0a\u503e\u5411\u4e8e\u7528\u4e8e\u6587\u672c\u6837\u5f0f\u89e3\u6790\u7684\u666e\u901a\u77e9\u5f62\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u4ece\u8bed\u4e49\u7684\u89d2\u5ea6\u533a\u5206\u51e0\u4f55\u4e0a\u7684\u66f2\u7ebf\u8def\u5f84\u3002 \u5b9a\u4e49\u8bed\u4e49\u4e0a\u7684\u66f2\u7ebf\u8def\u5f84\u4e3a\uff1a \u8def\u5f84\u56f4\u6210\u9762\u79ef\u4e0e\u5305\u7edc\u77e9\u5f62\u9762\u79ef\u4e4b\u6bd4\u5c0f\u4e8e\u9608\u503c\uff08\u4f8b\u59820.95\uff09\u3002 \u66f2\u7ebf\u56f4\u6210\u9762\u79ef\u7684\u8ba1\u7b97 PDF\u4e2d\u7684\u66f2\u7ebf\u8def\u5f84\u7531 c \u3001 v \u3001 y \u7b49\u7b97\u7b26\u63cf\u8ff0\u7684\u8d1d\u585e\u5c14\u66f2\u7ebf\u8868\u793a\u3002\u6839\u636ePDF\u7ed9\u51fa\u76844\u4e2a\u63a7\u5236\u70b9\u8ba1\u7b97\u53c2\u6570\u65b9\u7a0b\uff0c\u8fdb\u800c\u91c7\u6837\u66f2\u7ebf\u4e0a\u4e00\u7cfb\u5217\u7684\u70b9\uff0c\u5e76\u6839\u636e Shoelace formula \u8ba1\u7b97\u9762\u79ef\u3002 \u6700\u540e\uff0c\u7edf\u8ba1\u6bcf\u4e00\u4e2a\u5206\u7ec4\u4e2d\u8bed\u4e49\u66f2\u7ebf\u8def\u5f84\u6570\u91cf\u7684\u5360\u6bd4\uff0c\u4e00\u65e6\u8d85\u8fc7\u67d0\u4e2a\u9608\u503c\uff0c\u5c31\u8ba4\u4e3a\u8fd9\u4e2a\u5206\u7ec4\u7684\u6240\u6709\u8def\u5f84\u7ec4\u6210\u4e86\u77e2\u91cf\u56fe\u3002 \u8fd9\u4e2a\u65b9\u6848\u7684\u7f3a\u70b9\u5f88\u660e\u663e\uff1a \u5982\u679c\u4e00\u526f\u77e2\u91cf\u56fe\u5b58\u5728\u5b64\u7acb\u7684\u5c40\u90e8\u7279\u5f81\uff0c\u5c06\u88ab\u9519\u8bef\u5730\u62c6\u5206\u4e3a\u591a\u4e2a\u5206\u7ec4 \u5982\u679c\u8868\u683c\u7684\u5355\u5143\u683c\u5185\u5d4c\u5957\u7740\u77e2\u91cf\u56fe\uff0c\u8be5\u77e2\u91cf\u56fe\u5c06\u88ab\u4e22\u5f03","title":"(b) \u4ee5\u66f2\u7ebf\u8def\u5f84\uff08\u8bed\u4e49\u4e0a\uff09\u6570\u91cf\u6bd4\u4f8b\u4e3a\u4f9d\u636e\u5224\u5b9a\u77e2\u91cf\u56fe"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/#_2","text":"\u5f53\u524d\u6d4b\u8bd5\u4e2d\u7684\u65b9\u6848\uff0c\u9700\u8981 python-opency \u652f\u6301\u3002\u57fa\u672c\u601d\u8def\uff1a \u9690\u85cf\u6587\u672c\u548c\u666e\u901a\u56fe\u7247\uff0c\u622a\u56fe\u6574\u4e2a\u9875\u9762\u5e76\u8fdb\u884c\u4e8c\u503c\u5316\u540e\u4f5c\u4e3a\u56fe\u7247\u8f93\u5165 \u9012\u5f52\u6295\u5f71\u5206\u5272\u9875\u9762\uff0c\u5f97\u5230\u4e00\u4e9b\u5217\u5b50\u533a\u57df \u9488\u5bf9\u6bcf\u4e00\u4e2a\u5b50\u533a\u57df bbox \uff0c\u7528 opencv \u67e5\u627e\u6240\u6709\u8f6e\u5ed3\uff0c\u63d0\u53d6\u5176\u4e2dlevel-2\u7ea7\u522b\u7684\u5b50\u8f6e\u5ed3 inner_bboxes \u68c0\u67e5\u5305\u542b\u4e8e bbox \u4f46 \u4e0d\u5b58\u5728\u4e8e inner_bboxes \u4e2d\u7684\u8def\u5f84\u96c6\u5408 P \uff0c \u5982\u679c\u66f2\u7ebf\u8def\u5f84\uff08\u8bed\u4e49\uff09\u6570\u91cf\u7684\u5360\u6bd4\u8fbe\u5230\u9608\u503c\uff0c\u5219\u8ba4\u4e3a\u8be5\u5b50\u533a\u57df\u4e3a\u77e2\u91cf\u56fe\uff0c\u8fdb\u800c\u622a\u53d6\u9875\u9762\u7684 bbox \u533a\u57df\u4f5c\u4e3a\u4f4d\u56fe\u5904\u7406 \u5426\u5219\uff0c\u5bfc\u51fa\u8def\u5f84\u96c6\u5408 P \u4f5c\u8fdb\u4e00\u6b65\u8868\u683c\u8fb9\u6846/\u6587\u672c\u6837\u5f0f\u89e3\u6790\uff0c\u540c\u65f6\u622a\u53d6 inner_bboxes \u5b50\u533a\u57df\u7684\u5d4c\u5957\u77e2\u91cf\u56fe \u5176\u4e2d\uff0c\u9012\u5f52\u6295\u5f71\u5206\u5272\uff08recursive xy cut\uff09\u89e3\u51b3\u524d\u4e00\u65b9\u6848\u9057\u7559\u7684\u77e2\u91cf\u56fe\u5c40\u90e8\u7279\u5f81\u95ee\u9898\uff0c\u901a\u8fc7\u8bbe\u7f6e\u5206\u5272\u7684\u95f4\u9699\u53c2\u6570\u5408\u5e76\u90bb\u8fd1\u7684\u672c\u5c5e\u4e8e\u540c\u4e00\u77e2\u91cf\u56fe\u7684\u5b50\u533a\u57df\u3002\u5173\u4e8e\u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5\u7684\u7ec6\u8282\u53c2\u8003\uff1a \u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 Recursive XY Cut \u63d0\u53d6level-2\u5b50\u8f6e\u5ed3\u7684\u7406\u89e3 \u65e8\u5728\u89e3\u51b3\u8868\u683c\u4e2d\u5d4c\u5957\u77e2\u91cf\u56fe\u7684\u95ee\u9898\u3002 \u5982\u679c\u5f53\u524d\u533a\u57df\u4e3a\u8868\u683c\uff0c\u4e14\u67d0\u4e2a\u5355\u5143\u683c\u4e2d\u5b58\u5728\u4e00\u5f20\u77e2\u91cf\u56fe\uff0c\u5219level-0\u4e3a\u8868\u683c\u5916\u8f6e\u5ed3\uff0clevel-1\u4e3a\u8868\u683c\u5185\u8f6e\u5ed3\u5373\u5355\u5143\u683c\u8f6e\u5ed3\uff0c\u4e8e\u662flevel-2\u4e3a\u6f5c\u5728\u7684\u5355\u5143\u683c\u5185\u77e2\u91cf\u56fe\u7684\u8f6e\u5ed3\u3002\u8fd9\u4e5f\u662f\u5224\u65ad\u8def\u5f84\u65f6\u6392\u9664level-2\u7ea7\u8f6e\u5ed3\u7684\u539f\u56e0\u6240\u5728\u3002 \u5982\u679c\u5f53\u524d\u533a\u57df\u4e3a\u77e2\u91cf\u56fe\uff0c\u5219\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5b58\u5728level-2\u8f6e\u5ed3\uff0c\u4ece\u800c\u5e76\u4e0d\u5f71\u54cd\u5224\u65ad\u903b\u8f91\u3002 \u6ce8\u610f opency \u8f6e\u5ed3\u5c42\u7ea7\u7684\u4e00\u4e2a\u7ec6\u8282\uff1a \u5982\u679c\u5355\u5143\u683c\u5185\u77e2\u91cf\u56fe\u4e0e\u5355\u5143\u683c\u8fb9\u6846\u4e4b\u95f4\u7684\u8ddd\u79bb\u5f88\u5c0f\uff0c\u672c\u5e94\u5c5e\u4e8elevel-2\u7684\u77e2\u91cf\u56fe\u8f6e\u5ed3\u5c06\u88ab\u5206\u914d\u5230level-1\u7ea7\uff0c\u5373\u4e0e\u5305\u542b\u5b83\u7684\u5355\u5143\u683c\u8f6e\u5ed3\u5728\u540c\u4e00\u7ea7\u3002\u56e0\u6b64\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u6ce8\u610f\u5c06\u5305\u542b\u4e8e\u5176\u4ed6\u540c\u7ea7\u8f6e\u5ed3\u7684\u4f2alevel-1\u8f6e\u5ed3\u8003\u8651\u5230level-2\u8f6e\u5ed3\u4e2d\u53bb\uff1b\u76f8\u5e94\u5730\uff0c\u6392\u9664level-2\u4e2d\u5305\u542b\u4e8e\u8be5\u4f2alevel-1\u7ea7\u7684\u8f6e\u5ed3\uff0c\u56e0\u4e3a\u5b83\u5b9e\u9645\u4e0a\u5c5e\u4e8elevel-3\u4e86\u3002 \u76f8\u6bd4\u4ece\u8def\u5f84\u672c\u8eab\u51fa\u53d1\u7684\u8def\u5f84\u5206\u7ec4\u65b9\u6848\uff0c\u57fa\u4e8e opencv \u56fe\u50cf\u5904\u7406\u7684\u9012\u5f52\u6295\u5f71\u5206\u5272+\u5b50\u8f6e\u5ed3\u65b9\u6848\u8868\u73b0\u51fa\u4e86\u66f4\u597d\u7684\u7a33\u5b9a\u6027\uff0c\u4f46\u662f\u4f9d\u65e7\u65e0\u6cd5\u6446\u8131\u57fa\u4e8e\u89c4\u5219\u7684\u65b9\u6cd5\u7684\u5c40\u9650\u6027\u2014\u2014\u603b\u662f\u5b58\u5728\u4f8b\u5916\u60c5\u51b5\uff0c\u4f8b\u5982\uff1a\u4e00\u526f\u4e0d\u5305\u542b\u4efb\u4f55\u66f2\u7ebf\u8def\u5f84\u7684\u67f1\u72b6\u56fe\u3002","title":"\u9012\u5f52\u6295\u5f71\u5206\u5272+\u5b50\u8f6e\u5ed3+\u66f2\u7ebf\u6bd4\u4f8b\u5224\u636e"},{"location":"2021-06-26-pdf2docx%E5%BC%80%E5%8F%91%E6%A6%82%E8%A6%81%EF%BC%9A%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%A4%84%E7%90%86/#cnn","text":"\u5f85\u63a2\u7d22\u7684\u65b9\u5411\u3002 opencv \u652f\u6301 tensorflow \u6a21\u578b\u5960\u5b9a\u4e86\u6b64\u65b9\u6848\u90e8\u7f72\u4e0a\u7684\u53ef\u884c\u6027\uff0c\u5269\u4e0b\u9700\u8981\u89e3\u51b3\u7684\u4e24\u4e2a\u5173\u952e\u95ee\u9898\uff1a \u6570\u636e\u96c6\u7684\u51c6\u5907 \u6a21\u578b\u53ca\u7cbe\u5ea6","title":"\u9012\u5f52\u6295\u5f71\u5206\u5272+CNN\u5206\u7c7b"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-08 | \u5206\u7c7b\uff1a optimization , mathematics \u7ec4\u5408\u4f18\u5316\u95ee\u9898\u5e7f\u6cdb\u51fa\u73b0\u4e8e\u5404\u884c\u5404\u4e1a\uff0c\u4f8b\u5982\u751f\u4ea7\u5236\u9020\u6392\u7a0b\uff0c\u673a\u573a\u822a\u73ed\u8c03\u5ea6\u3001\u9879\u76ee\u7ba1\u7406\u8ba1\u5212\u7b49\uff0c\u6c42\u89e3\u8fd9\u7c7b\u95ee\u9898\u6709\u52a9\u4e8e\u89e3\u51b3\u5b9e\u9645\u5e94\u7528\u4e2d\u7684\u8c03\u5ea6\u96be\u9898\u3001\u63d0\u9ad8\u751f\u4ea7\u6548\u7387\uff1b\u8003\u8651\u5230\u5b9e\u9645\u7684\u4e1a\u52a1\u903b\u8f91\u56e0\u884c\u4e1a\u800c\u5f02\u4e14\u53ef\u80fd\u76f8\u5f53\u590d\u6742\uff0c\u672c\u7cfb\u5217\u6587\u7ae0\u9488\u5bf9\u8c03\u5ea6\u7c7b\u95ee\u9898\u7684\u57fa\u672c\u6a21\u578b\u2014\u2014\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\uff08Job Shop Schedule\uff09\uff0c\u57fa\u4e8ePython\u5f00\u53d1\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u6c42\u89e3\u6846\u67b6\uff1a \u53c2\u8003\u6587\u732e\u5b9e\u73b0\u4e86\u4e00\u4e9b\u57fa\u672c\u89e3\u6cd5\u4f8b\u5982\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\u3001\u5c40\u90e8\u641c\u7d22\u3001\u7fa4\u4f53\u65b9\u6cd5\u7b49 \u4fbf\u4e8e\u5feb\u901f\u5b9e\u65bd\u548c\u6d4b\u8bd5\u65b0\u7b97\u6cd5\uff08\u53c2\u8003 Python\u5efa\u6a21 \uff09 \u9879\u76ee\u4ed3\u5e93 \u00b6 https://github.com/dothinking/jsp_framework \u5efa\u6a21 \u00b6 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u901a\u5e38\u6709\u4e24\u7c7b\u63cf\u8ff0\u65b9\u5f0f\uff1a \u4ee5\u5de5\u5e8f\u5f00\u59cb\u65f6\u95f4\u4e3a\u89c4\u5212\u53d8\u91cf\u7684\u7ebf\u6027\u89c4\u5212\u6570\u5b66\u6a21\u578b \u4ee5\u5de5\u5e8f\u987a\u5e8f\uff08\u4f5c\u4e1a\u5de5\u5e8f\u987a\u5e8f\u548c\u673a\u5668\u5de5\u5e8f\u987a\u5e8f\uff09\u4e3a\u57fa\u7840\u7684\u6790\u53d6\u56fe\u63cf\u8ff0 \u672c\u8282\u4ece\u8fd9\u4e24\u79cd\u63cf\u8ff0\u5165\u624b\u8ba4\u8bc6\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff0c\u5e76\u57fa\u4e8e\u6b64\u8bbe\u8ba1\u4e86\u6574\u4e2a\u6c42\u89e3\u6846\u67b6\uff0c\u628a\u95ee\u9898\u5206\u89e3\u3001\u62bd\u8c61\u4e3a\u53ef\u91cd\u7528\u7684\u90e8\u5206\uff0c\u4ece\u800c\u4e13\u6ce8\u6c42\u89e3\u7b97\u6cd5\u7684\u5f00\u53d1\u3001\u5b9e\u65bd\u548c\u9a8c\u8bc1\u3002 \u95ee\u9898\u63cf\u8ff0 Python\u5efa\u6a21 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe \u6c42\u89e3 \u00b6 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u901a\u5e38\u6709\u4e24\u7c7b\u89e3\u6cd5\uff1a \u7cbe\u786e\u89e3\u6cd5\u4f8b\u5982\u7ebf\u6027\u89c4\u5212\u3001\u52a8\u6001\u89c4\u5212\u3001\u5206\u679d\u5b9a\u754c\u7b49 \u8fd1\u4f3c\u89e3\u6cd5\u4f8b\u5982\u5c40\u90e8\u641c\u7d22\uff08\u7981\u5fcc\u641c\u7d22\u3001\u6a21\u62df\u9000\u706b\u7b49\uff09\u3001\u7fa4\u4f53\u7b97\u6cd5\uff08\u9057\u4f20\u7b97\u6cd5\u3001\u8681\u7fa4\u3001\u7c92\u5b50\u7fa4\u7b49\uff09\u3001\u57fa\u4e8e\u89c4\u5219\u7b97\u6cd5\u7b49 \u7cbe\u786e\u89e3\u6cd5\u7406\u8bba\u4e0a\u603b\u80fd\u83b7\u5f97\u5168\u5c40\u6700\u4f18\u89e3\uff0c\u4f46\u662f\u6c42\u89e3\u6548\u7387\u968f\u7740\u95ee\u9898\u89c4\u6a21\u7684\u589e\u5927\u800c\u6025\u5267\u4e0b\u964d\uff0c\u4f8b\u5982\u4e00\u4e2a 85 job x 8 machines \u95ee\u9898\u7684\u641c\u7d22\u7a7a\u95f4\u8fbe\u5230\u4e86 10^{880} 10^{880} \u3002 \u8fd1\u4f3c\u89e3\u6cd5\u5219\u8ffd\u6c42\u4ee5\u5408\u7406\u7684\u8ba1\u7b97\u65f6\u95f4\u83b7\u53d6\u8f83\u597d\u8d28\u91cf\u7684\u89e3\uff0c\u4f46\u4e0d\u4fdd\u8bc1\u662f\u5168\u5c40\u6700\u4f18\u89e3 \u3002 OR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 PuLP\u6c42\u89e3\u5668 \u57fa\u4e8e\u89c4\u5219\u6307\u6d3e \u53c2\u8003\u6587\u732e \u00b6 Blackstone, John H., Don T. Phillips, and Gary L. Hogg. \"A state-of-the-art survey of dispatching rules for manufacturing job shop operations.\" The International Journal of Production Research 20.1 (1982): 27-45. Zahmani, M. H. et al. \"Multiple priority dispatching rules for the job shop scheduling problem.\" 2015 3 rd International Conference on Control, Engineering & Information Technology (CEIT) (2015): 1-6. \u9ec4\u5fd7, and \u9ec4\u6587\u5947. \"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e00\u79cd\u542f\u53d1\u5f0f\u7b97\u6cd5.\" \u8ba1\u7b97\u673a\u5de5\u7a0b\u4e0e\u5e94\u7528 26(2004):25-27.","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-08 | \u5206\u7c7b\uff1a optimization , mathematics \u7ec4\u5408\u4f18\u5316\u95ee\u9898\u5e7f\u6cdb\u51fa\u73b0\u4e8e\u5404\u884c\u5404\u4e1a\uff0c\u4f8b\u5982\u751f\u4ea7\u5236\u9020\u6392\u7a0b\uff0c\u673a\u573a\u822a\u73ed\u8c03\u5ea6\u3001\u9879\u76ee\u7ba1\u7406\u8ba1\u5212\u7b49\uff0c\u6c42\u89e3\u8fd9\u7c7b\u95ee\u9898\u6709\u52a9\u4e8e\u89e3\u51b3\u5b9e\u9645\u5e94\u7528\u4e2d\u7684\u8c03\u5ea6\u96be\u9898\u3001\u63d0\u9ad8\u751f\u4ea7\u6548\u7387\uff1b\u8003\u8651\u5230\u5b9e\u9645\u7684\u4e1a\u52a1\u903b\u8f91\u56e0\u884c\u4e1a\u800c\u5f02\u4e14\u53ef\u80fd\u76f8\u5f53\u590d\u6742\uff0c\u672c\u7cfb\u5217\u6587\u7ae0\u9488\u5bf9\u8c03\u5ea6\u7c7b\u95ee\u9898\u7684\u57fa\u672c\u6a21\u578b\u2014\u2014\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\uff08Job Shop Schedule\uff09\uff0c\u57fa\u4e8ePython\u5f00\u53d1\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u6c42\u89e3\u6846\u67b6\uff1a \u53c2\u8003\u6587\u732e\u5b9e\u73b0\u4e86\u4e00\u4e9b\u57fa\u672c\u89e3\u6cd5\u4f8b\u5982\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\u3001\u5c40\u90e8\u641c\u7d22\u3001\u7fa4\u4f53\u65b9\u6cd5\u7b49 \u4fbf\u4e8e\u5feb\u901f\u5b9e\u65bd\u548c\u6d4b\u8bd5\u65b0\u7b97\u6cd5\uff08\u53c2\u8003 Python\u5efa\u6a21 \uff09","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_2","text":"https://github.com/dothinking/jsp_framework","title":"\u9879\u76ee\u4ed3\u5e93"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_3","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u901a\u5e38\u6709\u4e24\u7c7b\u63cf\u8ff0\u65b9\u5f0f\uff1a \u4ee5\u5de5\u5e8f\u5f00\u59cb\u65f6\u95f4\u4e3a\u89c4\u5212\u53d8\u91cf\u7684\u7ebf\u6027\u89c4\u5212\u6570\u5b66\u6a21\u578b \u4ee5\u5de5\u5e8f\u987a\u5e8f\uff08\u4f5c\u4e1a\u5de5\u5e8f\u987a\u5e8f\u548c\u673a\u5668\u5de5\u5e8f\u987a\u5e8f\uff09\u4e3a\u57fa\u7840\u7684\u6790\u53d6\u56fe\u63cf\u8ff0 \u672c\u8282\u4ece\u8fd9\u4e24\u79cd\u63cf\u8ff0\u5165\u624b\u8ba4\u8bc6\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff0c\u5e76\u57fa\u4e8e\u6b64\u8bbe\u8ba1\u4e86\u6574\u4e2a\u6c42\u89e3\u6846\u67b6\uff0c\u628a\u95ee\u9898\u5206\u89e3\u3001\u62bd\u8c61\u4e3a\u53ef\u91cd\u7528\u7684\u90e8\u5206\uff0c\u4ece\u800c\u4e13\u6ce8\u6c42\u89e3\u7b97\u6cd5\u7684\u5f00\u53d1\u3001\u5b9e\u65bd\u548c\u9a8c\u8bc1\u3002 \u95ee\u9898\u63cf\u8ff0 Python\u5efa\u6a21 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe","title":"\u5efa\u6a21"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_4","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u901a\u5e38\u6709\u4e24\u7c7b\u89e3\u6cd5\uff1a \u7cbe\u786e\u89e3\u6cd5\u4f8b\u5982\u7ebf\u6027\u89c4\u5212\u3001\u52a8\u6001\u89c4\u5212\u3001\u5206\u679d\u5b9a\u754c\u7b49 \u8fd1\u4f3c\u89e3\u6cd5\u4f8b\u5982\u5c40\u90e8\u641c\u7d22\uff08\u7981\u5fcc\u641c\u7d22\u3001\u6a21\u62df\u9000\u706b\u7b49\uff09\u3001\u7fa4\u4f53\u7b97\u6cd5\uff08\u9057\u4f20\u7b97\u6cd5\u3001\u8681\u7fa4\u3001\u7c92\u5b50\u7fa4\u7b49\uff09\u3001\u57fa\u4e8e\u89c4\u5219\u7b97\u6cd5\u7b49 \u7cbe\u786e\u89e3\u6cd5\u7406\u8bba\u4e0a\u603b\u80fd\u83b7\u5f97\u5168\u5c40\u6700\u4f18\u89e3\uff0c\u4f46\u662f\u6c42\u89e3\u6548\u7387\u968f\u7740\u95ee\u9898\u89c4\u6a21\u7684\u589e\u5927\u800c\u6025\u5267\u4e0b\u964d\uff0c\u4f8b\u5982\u4e00\u4e2a 85 job x 8 machines \u95ee\u9898\u7684\u641c\u7d22\u7a7a\u95f4\u8fbe\u5230\u4e86 10^{880} 10^{880} \u3002 \u8fd1\u4f3c\u89e3\u6cd5\u5219\u8ffd\u6c42\u4ee5\u5408\u7406\u7684\u8ba1\u7b97\u65f6\u95f4\u83b7\u53d6\u8f83\u597d\u8d28\u91cf\u7684\u89e3\uff0c\u4f46\u4e0d\u4fdd\u8bc1\u662f\u5168\u5c40\u6700\u4f18\u89e3 \u3002 OR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 PuLP\u6c42\u89e3\u5668 \u57fa\u4e8e\u89c4\u5219\u6307\u6d3e","title":"\u6c42\u89e3"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_5","text":"Blackstone, John H., Don T. Phillips, and Gary L. Hogg. \"A state-of-the-art survey of dispatching rules for manufacturing job shop operations.\" The International Journal of Production Research 20.1 (1982): 27-45. Zahmani, M. H. et al. \"Multiple priority dispatching rules for the job shop scheduling problem.\" 2015 3 rd International Conference on Control, Engineering & Information Technology (CEIT) (2015): 1-6. \u9ec4\u5fd7, and \u9ec4\u6587\u5947. \"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e00\u79cd\u542f\u53d1\u5f0f\u7b97\u6cd5.\" \u8ba1\u7b97\u673a\u5de5\u7a0b\u4e0e\u5e94\u7528 26(2004):25-27.","title":"\u53c2\u8003\u6587\u732e"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-08 | \u5206\u7c7b\uff1a optimization , mathematics \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\uff08Job Shop Schedule\uff09\u662f\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u7ec4\u5408\u4f18\u5316\u95ee\u9898\uff0c\u672c\u6587\u8bb0\u5f55\u8be5\u95ee\u9898\u7684\u57fa\u672c\u5b9a\u4e49\uff0c\u66f4\u76f4\u89c2\u7684\u793a\u610f\u56fe\u89e3\u8bfb\u53c2\u8003 \u535a\u6587 \u3002 \u4ece\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff08Shop Problem\uff09\u5f00\u59cb \u00b6 \u5728\u8f66\u95f4 m \u53f0\u673a\u5668\uff08machine\uff09\u4e0a\u8c03\u5ea6 n \u4e2a\u4f5c\u4e1a\uff08job\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u4f5c\u4e1a\u5305\u542b\u4e00\u5b9a\u6570\u91cf\u7684\u6b65\u9aa4/\u5de5\u5e8f\uff08operation\uff09\u4e14\u6bcf\u4e2a\u5de5\u5e8f\u9700\u8981\u5728\u7ed9\u5b9a\u7684\u67d0\u4e00\u53f0\u673a\u5668\u4e0a\u6765\u5b8c\u6210\u3002\u5b9a\u4e49\uff1a \u673a\u5668\u96c6\u5408 \\mathbb{M} = \\left \\{ 1, 2, \\cdots, m \\right \\} \\mathbb{M} = \\left \\{ 1, 2, \\cdots, m \\right \\} \u4f5c\u4e1a\u96c6\u5408 \\mathbb{J} = \\left \\{ 1, 2, \\cdots, n \\right \\} \\mathbb{J} = \\left \\{ 1, 2, \\cdots, n \\right \\} \u5de5\u5e8f\u96c6\u5408 \\mathbb{O} = \\left \\{ (i, j) \\; | \\; i \\in \\mathbb{M}^j \\subset \\mathbb{M}, j \\in \\mathbb{J} \\right \\} \\mathbb{O} = \\left \\{ (i, j) \\; | \\; i \\in \\mathbb{M}^j \\subset \\mathbb{M}, j \\in \\mathbb{J} \\right \\} \u8868\u793a\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5c06\u5728\u673a\u5668 i i \u4e0a\u52a0\u5de5\u7684\u5de5\u5e8f\uff0c\u8bb0\u5f55\u5176\u6240\u9700\u65f6\u95f4\u4e3a p_{ij} p_{ij} \u3002\u5176\u4e2d \\mathbb{M}^j \\mathbb{M}^j \u662f\u5b8c\u6210\u4f5c\u4e1a j j \u6240\u6709\u5de5\u5e8f\u6240\u9700\u7684\u673a\u5668\u96c6\u5408\u3002 \u63a5\u4e0b\u6765\u6839\u636e\u4f5c\u4e1a\u4e2d\u5de5\u5e8f\u6570\u91cf\u548c\u987a\u5e8f\u7684\u4e0d\u540c\uff0c\u5c06\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u5206\u4e3a\u4ee5\u4e0b\u4e09\u7c7b\uff1a \u6d41\u6c34\u8f66\u95f4\uff08Flow shop\uff09\uff1a \\mathbb{M}^j=\\mathbb{M} \\mathbb{M}^j=\\mathbb{M} \uff0c\u4e14 \\mathbb{C}_{pre}=\\left\\{(i, j) \\rightarrow (i+1, j)\\;|\\; i=1,2,\\cdots,m\u22121; j=1,2,\\cdots,n \\right\\} \\mathbb{C}_{pre}=\\left\\{(i, j) \\rightarrow (i+1, j)\\;|\\; i=1,2,\\cdots,m\u22121; j=1,2,\\cdots,n \\right\\} \u5f00\u653e\u8f66\u95f4\uff08Open shop\uff09\uff1a \\mathbb{M}^j=\\mathbb{M} \\mathbb{M}^j=\\mathbb{M} \uff0c\u4e14 \\mathbb{C}_{pre}=\\emptyset \\mathbb{C}_{pre}=\\emptyset \u4f5c\u4e1a\u8f66\u95f4\uff08Job shop\uff09\uff1a \\mathbb{C}_{pre}=\\left\\{ (i_1,j) \\rightarrow (i_2,j), \\cdots, \\rightarrow (i_{|\\mathbb{M}^j|}, j) \\;|\\; j=1,2,\\cdots,n \\right\\} \\mathbb{C}_{pre}=\\left\\{ (i_1,j) \\rightarrow (i_2,j), \\cdots, \\rightarrow (i_{|\\mathbb{M}^j|}, j) \\;|\\; j=1,2,\\cdots,n \\right\\} \u5176\u4e2d\uff0c \\mathbb{C}_{pre} \\mathbb{C}_{pre} \u8868\u793a\u5de5\u5e8f\u524d\u540e\u987a\u5e8f\u7684\u5173\u7cfb\u3002 \u7efc\u5408\u8d77\u6765\uff0c\u767d\u8bdd\u5c31\u662f\uff1a \u6d41\u6c34\u8f66\u95f4\uff1a\u4efb\u610f\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5de5\u5e8f\u6570\u76f8\u540c\uff08 m m \uff09\uff0c\u4e14\u5de5\u5e8f\u9075\u5faa\u7684\u5148\u540e\u987a\u5e8f\u76f8\u540c\uff0c\u5373\u6d41\u6c34\u4f5c\u4e1a \u5f00\u653e\u8f66\u95f4\uff1a\u4efb\u610f\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5de5\u5e8f\u6570\u76f8\u540c\uff08 m m \uff09\uff0c\u4f46\u5de5\u5e8f\u6ca1\u6709\u524d\u540e\u987a\u5e8f\u4e4b\u5206\uff0c\u5373\u65e0\u5e8f\u4f5c\u4e1a \u4f5c\u4e1a\u8f66\u95f4\uff1a\u4efb\u610f\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5de5\u5e8f\u6570\u65e0\u5173\uff0c\u4f46\u5404\u81ea\u9075\u5faa\u4e00\u5b9a\u7684\u5148\u540e\u987a\u5e8f\uff0c\u5373\u5f02\u5e8f\u4f5c\u4e1a \u6ce8\u610f \u6d41\u6c34\u8f66\u95f4\u4f5c\u4e1a\u7684\u5de5\u5e8f\u987a\u5e8f\u76f8\u540c\uff0c\u4f46\u662f\u5de5\u5e8f\u7684\u52a0\u5de5\u65f6\u95f4\u53ef\u80fd\u4e0d\u540c\uff0c\u5e76\u4e14\u5206\u914d\u5230\u673a\u5668\u540e\uff0c\u4e0d\u540c\u673a\u5668\u4e0a\u6267\u884c\u4f5c\u4e1a\u7684\u987a\u5e8f\u53ef\u80fd\u4e0d\u540c\u3002 \u767d\u8bdd\u63cf\u8ff0 \u00b6 \u7efc\u4e0a\uff0c\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u53ef\u4ee5\u5b9a\u4e49\u4e3a\uff1a \u7ed9\u5b9a n n \u4e2a\u4f5c\u4e1a\uff0c\u6bcf\u4e2a\u4f5c\u4e1a\u7684\u52a0\u5de5\u8fc7\u7a0b\u5206\u4e3a\u82e5\u5e72\u9053\u5de5\u5e8f\uff0c\u6bcf\u9053\u5de5\u5e8f\u6ee1\u8db3\uff081\uff09\u5e8f\u5217\u7ea6\u675f\u5373\u5fc5\u987b\u5728\u8be5\u4f5c\u4e1a\u7684\u524d\u7eed\u5de5\u5e8f\u5b8c\u6210\u540e\u624d\u80fd\u5f00\u59cb\uff0c\uff082\uff09\u8d44\u6e90\u7ea6\u675f\u5373\u5fc5\u987b\u5728\u7ed9\u5b9a\u7684 m m \u53f0\u673a\u5668\u4e2d\u786e\u5b9a\u7684 \u4e00\u53f0 \u4e0a\u52a0\u5de5\u4e14\u72ec\u5360\u8be5\u65f6\u95f4\u6bb5\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f\u3002 \u5728\u8fd9\u4e9b\u7ea6\u675f\u6761\u4ef6\u4e0b\uff0c\u89c4\u5212\u6bcf\u9053\u5de5\u5e8f\u7684\u5f00\u59cb\u52a0\u5de5\u65f6\u523b\uff0c\u4f7f\u5f97\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u52a0\u5de5\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u523b\u5230\u6700\u540e\u4e00\u4e2a\u5b8c\u6210\u52a0\u5de5\u5de5\u5e8f\u7684\u5b8c\u6210\u65f6\u523b\u7684\u65f6\u95f4\u8de8\u5ea6\uff08makespan\uff09\u5c3d\u53ef\u80fd\u7684\u77ed\u3002 \u4e3e\u4e00\u4e2a3\u673a\u56683\u4f5c\u4e1a\u7684\u4f8b\u5b50\uff1a \u4f5c\u4e1a1\uff1a (3,1) -> (2,1) -> (1,1) \uff0cp31 = 4, p21 = 2, p11 = 1 \u4f5c\u4e1a2\uff1a (1,2) -> (3,2) \uff0cp12 = 3, p32 = 3 \u4f5c\u4e1a3\uff1a (2,3) -> (1,3) -> (3,3) \uff0cp23 = 2, p13 = 4, p33 = 1 \u4f5c\u4e1a1\u75313\u9053\u5de5\u5e8f\u7ec4\u6210\uff0c\u5206\u522b\u6309\u673a\u56683\uff0c\u673a\u56682\uff0c\u673a\u56681\u7684\u987a\u5e8f\u52a0\u5de5\uff0c\u52a0\u5de5\u65f6\u95f4\u5206\u522b\u4e3a4\uff0c2\uff0c1\uff1b\u4f5c\u4e1a2\uff0c3\u540c\u7406\u89e3\u8bfb\u3002\u5c06\u5176\u4ee5\u8868\u683c\u7684\u5f62\u5f0f\u5217\u51fa\u6765\u4e3a\uff1a -------------------------------------- \u5de5\u5e8f,\u65f6\u95f4 \u4f5c\u4e1a ------------------------------ 1 2 3 -------------------------------------- 1 M3, 4 M2, 2 M1, 1 2 M1, 3 M3, 3 3 M2, 2 M1, 4 M3, 1 --------------------------------------- \u6570\u5b66\u63cf\u8ff0 \u00b6 \u5b9a\u4e49\u5de5\u5e8f (i,j) (i,j) \u7684\u5b8c\u5de5\u65f6\u95f4\u4e3a c_{ij} c_{ij} \uff0c\u5219\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7b49\u6548\u4e3a\u5982\u4e0b\u4f18\u5316\u95ee\u9898\uff1a \\begin{align*} &\\min\\,\\, c_{m} = \\max \\left \\{ c_{ij} \\, | \\, (i,j) \\in \\mathbb{O} \\right \\} \\\\ \\\\ &s.t.\\quad \\begin{cases} c_{ij} \\geq p_{ij} & (i,j) \\in \\mathbb{O} \\\\ \\\\ c_{ij}-c_{kj} \\geq p_{ij} & if \\,\\, (k,j) \\rightarrow (i,j), \\,\\, i, k \\in \\mathbb{M}^j \\\\ \\\\ c_{ij} - c_{ik} \\geq p_{ij} \\,\\, or \\,\\, c_{ik}-c_{ij} \\geq p_{ik} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5176\u4e2d\uff0c \u7b2c\u4e00\u4e2a\u7ea6\u675f\u8868\u660e\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4\u975e\u8d1f \u7b2c\u4e8c\u4e2a\u662f\u5de5\u5e8f\u5e8f\u5217\u7ea6\u675f\uff0c\u5373\u540c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u76f8\u90bb\u5de5\u5e8f\u5fc5\u987b\u6ee1\u8db3\u5148\u540e\u987a\u5e8f \u7b2c\u4e09\u4e2a\u662f\u8d44\u6e90\u7ea6\u675f\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f\u3002 \u8fd9\u79cd\u63cf\u8ff0\u65b9\u5f0f\u7b26\u5408\u6574\u6570\u89c4\u5212\u6a21\u578b\uff0c\u4fbf\u4e8e\u76f4\u63a5\u5229\u7528\u5b9e\u73b0\u4e86\u9ad8\u6548\u6574\u6570\u4f18\u5316\u7b97\u6cd5\u7684\u6c42\u89e3\u5668\u8fdb\u884c\u6c42\u89e3\uff1b\u7f3a\u70b9\u6c42\u89e3\u6548\u7387\u53d7\u5230\u95ee\u9898\u89c4\u6a21\u7684\u9650\u5236\u3002 \u6790\u53d6\u56fe\u63cf\u8ff0 \u00b6 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u8868\u9762\u4e0a\u662f\u6c42\u89e3\u5de5\u5e8f\u7684\u5f00\u59cb/\u7ed3\u675f\u65f6\u95f4\uff0c\u5b9e\u9645\u4e0a\u662f\u5de5\u5e8f\u5728\u673a\u5668\u4e0a\u7684\u6392\u5e8f\u95ee\u9898\u3002\u4e8e\u662f\uff0c\u6d89\u53ca\u4e24\u7c7b\u5e8f\u5217\uff1a \u4f5c\u4e1a\u5de5\u5e8f\u94fe\u5373\u4f5c\u4e1a\u89c6\u89d2\u4e0a\u5de5\u5e8f\u7684\u987a\u5e8f\uff0c\u8fd9\u4e2a\u662f\u5df2\u77e5\u7684\u7ea6\u675f\u6761\u4ef6 \u673a\u5668\u5de5\u5e8f\u94fe\u5373\u5206\u914d\u5230\u76f8\u5e94\u673a\u5668\u4e0a\u7684\u6240\u6709\u5de5\u5e8f\u7684\u5e8f\u5217\uff0c\u6bcf\u4e2a\u673a\u5668\u7684\u6bcf\u4e00\u79cd\u6392\u5217\u65b9\u5f0f\u5373\u5bf9\u5e94\u4e00\u79cd\u8c03\u5ea6\u65b9\u5f0f \u4e8e\u662f\uff0c\u4ea7\u751f\u4e86\u7528\u6790\u53d6\u56fe\uff08Disjunctive Graph\uff09\u6765\u63cf\u8ff0\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u65b9\u5f0f\u3002 \u5b9a\u4e49\u56fe\u7ed3\u6784 G = (V, C, D) G = (V, C, D) \uff0c\u5176\u4e2d\uff1a V V \u662f\u8282\u70b9\u96c6\u5408\uff0c\u5bf9\u5e94\u5de5\u5e8f\u96c6 \\mathbb{O} \\mathbb{O} \uff0c\u4ee5\u53ca\u989d\u5916\u52a0\u5165\u7684\u4e24\u4e2a\u7b49\u6548\u52a0\u5de5\u65f6\u95f4\u90fd\u4e3a0\u7684\u865a\u62df\u8282\u70b9\uff1a \u6e90\u8282\u70b9\uff08source\uff09 s s \uff1a\u6e90\u8282\u70b9\u6307\u5411\u6240\u6709\u4f5c\u4e1a\u7684\u7b2c\u4e00\u4e2a\u5de5\u5e8f \u6c47\u8282\u70b9\uff08sink\uff09 e e \uff1a\u6240\u6709\u4f5c\u4e1a\u7684\u6700\u540e\u4e00\u4e2a\u5de5\u5e8f\u6307\u5411\u6c47\u8282\u70b9 C C \u662f\u8fde\u63a5\u8fb9\u96c6\u5408\uff08conjunctive arcs\uff09\uff0c\u5bf9\u5e94\u4f5c\u4e1a\u5de5\u5e8f\u94fe\u7684\u987a\u5e8f\u5173\u7cfb\uff0c\u7531\u4e0a\u4e00\u5de5\u5e8f\u6307\u5411\u4e0b\u4e00\u5de5\u5e8f\uff1b\u540c\u65f6\u5305\u62ec\u7531\u865a\u62df\u8282\u70b9\u5f15\u5165\u7684 2n 2n \u6761\u6709\u5411\u8fb9\uff1a \u6e90\u8282\u70b9\u6307\u5411\u6240\u6709\u4f5c\u4e1a\u7684\u7b2c\u4e00\u4e2a\u5de5\u5e8f\u7684 n n \u6761\u6709\u5411\u8fb9 \u6240\u6709\u4f5c\u4e1a\u7684\u6700\u540e\u4e00\u4e2a\u5de5\u5e8f\u6307\u5411\u6c47\u8282\u70b9\u7684 n n \u6761\u6709\u5411\u8fb9 D D \u662f\u6790\u53d6\u8fb9\u96c6\u5408\uff08disjunctive arcs\uff09\uff0c\u5bf9\u5e94\u6f5c\u5728\u7684\u673a\u5668\u5de5\u5e8f\u94fe\u8fde\u63a5\u5173\u7cfb\uff0c\u6bcf\u4e00\u6761\u6790\u53d6\u8fb9\u8fde\u63a5\u540c\u4e00\u673a\u5668\u4e0a\u52a0\u5de5\u7684\u4e24\u4e2a\u5de5\u5e8f\u3002 \u8fd8\u662f\u4ee5\u524d\u97623\u673a\u56683\u4f5c\u4e1a\u4e3a\u4f8b\uff0c\u6790\u53d6\u56fe\u5982\u4e0b\u3002\u5176\u4e2d\uff0c \u5f69\u8272\u7bad\u5934\u8868\u793a\u7684\u6709\u5411\u8fb9\u4e3a\u8fde\u63a5\u8fb9\u96c6\u5408 C C \uff0c\u7bad\u5934\u4ece\u4e0a\u4e00\u9053\u5de5\u5e8f\u6307\u5411\u4e0b\u4e00\u9053\u5de5\u5e8f\uff0c\u5b9a\u4e49\u8fb9\u7684\u6743\u503c\u4e3a\u51fa\u53d1\u8282\u70b9\u5373\u4e0a\u4e00\u9053\u5de5\u5e8f\u7684\u52a0\u5de5\u65f6\u95f4\u3002 \u9ed1\u8272\u5b9e\u7ebf\u8868\u793a\u7684\u65e0\u5411\u8fb9\u4e3a\u6790\u53d6\u8fb9\u96c6\u5408 D D \uff0c\u76f8\u540c\u673a\u5668\u4e0a\u7684\u5de5\u5e8f\u4e4b\u95f4\u90fd\u6709\u4e00\u6761\u6790\u53d6\u8fb9\uff0c\u4f8b\u59821\u53f7\u673a\u5668\u4e0a\u7684 (1,1) \u3001 (1,2) \u548c (1,3) \u3002\u6b64\u65f6\u5c1a\u672a\u786e\u5b9a\u8fb9\u7684\u65b9\u5411\uff0c\u6545\u6743\u503c\u6682\u65f6\u4e3a\u7a7a\u3002 \u641c\u7d22\u7a7a\u95f4 \u00b6 \u4e3a\u6240\u6709\u6790\u53d6\u8fb9\u9009\u62e9\u4e00\u4e2a\u65b9\u5411\u5373\u786e\u5b9a\u673a\u5668\u4e0a\u5de5\u5e8f\u7684\u5148\u540e\u987a\u5e8f\u540e\uff0c\u6790\u53d6\u56fe\u9000\u5316\u4e3a\u6709\u5411\u56fe\uff0c\u4e5f\u5373\u5bf9\u5e94\u4e00\u79cd\u8c03\u5ea6\u65b9\u6848\u3002\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u53ef\u80fd\u7684\u65b9\u6848\u5373\u89e3\u7684\u641c\u7d22\u7a7a\u95f4\u5927\u5c0f\u4e3a\uff1a N = \\prod_{i=0}^m |\\mathbb{J}^i|! N = \\prod_{i=0}^m |\\mathbb{J}^i|! \u5176\u4e2d\uff0c |\\mathbb{J}^i| |\\mathbb{J}^i| \u8868\u793a\u673a\u5668 i i \u4e0a\u52a0\u5de5\u7684\u5de5\u5e8f\u6570\u91cf\u3002 \u663e\u7136\uff0c\u95ee\u9898\u89c4\u6a21\u968f\u7740\u673a\u5668\u6570\u548c\u4f5c\u4e1a\u6570\u7684\u589e\u52a0\u800c\u6025\u5267\u589e\u5927\u3002 \u6709\u5411\u56fe\u4e0e\u8def\u5f84\u957f\u5ea6 \u00b6 \u5047\u8bbe\u6240\u6709\u673a\u5668\u4e0a\u7684\u5de5\u5e8f\u90fd\u6309\u4f5c\u4e1a\u53f7\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4f8b\u59823\u53f7\u673a\u5668\u4e0a (3,1) -> (3,2) -> (3,3) \uff0c\u5219\u5f97\u5230\u5982\u4e0b\u4e00\u4e2a\u6709\u5411\u56fe\u7ed3\u6784\u3002 \u6709\u5411\u56fe\u53cd\u6620\u4e86\u4f5c\u4e1a\u5de5\u5e8f\u94fe\u548c\u673a\u5668\u5de5\u5e8f\u94fe\u4e0a\u5de5\u5e8f\u7684\u987a\u5e8f\u5173\u7cfb\uff0c\u5e76\u4e14 \u6e90\u8282\u70b9\u5230\u67d0\u8282\u70b9\u7684\u6700\u957f\u8def\u5f84\u957f\u5ea6\u5373\u4e3a\u8be5\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4 \u3002\u4e8e\u662f\uff0c\u6e90\u8282\u70b9\u5230\u6c47\u7ed3\u70b9\u7684\u6700\u957f\u8def\u5f84\uff08\u56fe\u4e2d\u9ec4\u8272\u7ebf\uff09\u5373\u4e3a\u76ee\u6807\u51fd\u6570\uff08\u52a0\u5de5\u5468\u671f\uff09 c_m c_m \u3002 \u6709\u5411\u56fe\u7684\u6700\u957f\u8def\u5f84\u7b97\u6cd5\uff08\u4f8b\u5982\u62d3\u6251\u6392\u5e8f\uff09\u6709\u52a9\u4e8e\u6211\u4eec\u8ba1\u7b97\u548c\u8bc4\u4f30\u76ee\u6807\u51fd\u6570\u503c\u3002 \u6709\u5411\u65e0\u73af\u56fe \u00b6 \u6709\u5411\u56fe\u7684\u8fb9\u5f88\u597d\u5730\u8868\u793a\u4e86\u5de5\u5e8f\u7684\u5148\u540e\u987a\u5e8f\uff0c\u4f46\u662f\u5982\u679c\u5b58\u5728 \u73af \uff0c\u5219\u4f1a\u4ea7\u751f\u77db\u76fe\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u6709\u5411\u56fe\u7ed3\u6784\u4e2d\uff0c\u9ec4\u8272\u7ebf\u8def\u5f84\u6784\u6210\u4e86\u4e00\u4e2a\u73af\u8def\uff1a \u673a\u56683\u4e0a\uff0c\u5de5\u5e8f (3,1) \u6392\u5728\u4f5c\u4e1a2\u7684\u5de5\u5e8f (3,2) \u4e4b\u540e\uff0c\u5373\u5fc5\u987b\u7b49\u5f85 (3,2) \u5b8c\u5de5 \u4f5c\u4e1a2\u4e0a\uff0c\u5de5\u5e8f (3,2) \u5219\u5fc5\u987b\u7b49\u5f85\u7b2c\u4e00\u9053\u5de5\u5e8f (1,2) \u5b8c\u5de5 \u673a\u56681\u4e0a\uff0c\u5de5\u5e8f (1,2) \u6392\u5728\u4f5c\u4e1a1\u7684 (1,1) \u4e4b\u540e\uff0c\u5373\u5fc5\u987b\u7b49\u5f85 (1,1) \u5b8c\u5de5 \u4f5c\u4e1a1\u4e0a\uff0c\u5de5\u5e8f (1,1) \u5219\u5fc5\u987b\u7b49\u5f85\u7b2c\u4e00\u9053\u5de5\u5e8f (3,1) \u5b8c\u5de5 \u7efc\u4e0a\uff0c\u5de5\u5e8f (3,1) \u5fc5\u987b\u7b49\u5f85\u81ea\u8eab\u5b8c\u6210\u4e4b\u540e\u624d\u80fd\u5f00\u59cb\uff01\u8fd9\u663e\u7136\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u6240\u4ee5\uff0c \u4e00\u4e2a\u53ef\u884c\u7684\u89e3\u5fc5\u987b\u662f\u6709\u5411\u65e0\u73af\u56fe \u3002\u56e0\u6b64\uff0c\u9700\u8981\u6709\u5411\u56fe\u7684\u73af\u8def\u68c0\u6d4b\u7b97\u6cd5\uff08\u4f8b\u5982\u62d3\u6251\u6392\u5e8f\uff09\u6765\u8fc7\u6ee4\u5019\u9009\u89e3\u3002 \u603b\u7ed3 \u00b6 \u6d41\u6c34\u8f66\u95f4\u3001\u5f00\u653e\u8f66\u95f4\u53ca\u4f5c\u4e1a\u8f66\u95f4\u95ee\u9898\u7684\u4e3b\u8981\u533a\u522b\u8868\u73b0\u4e3a\u4f5c\u4e1a\u5de5\u5e8f\u7684\u6570\u91cf\u548c\u987a\u5e8f\u662f\u5426\u76f8\u540c\u3002 \u65e0\u8bba\u6570\u5b66\u63cf\u8ff0\u8fd8\u662f\u6790\u53d6\u56fe\u63cf\u8ff0\uff0c\u4f5c\u4e1a\u8f66\u95f4\u95ee\u9898\u90fd\u8868\u73b0\u4e3a\u5728 \u4f5c\u4e1a\u5de5\u5e8f\u94fe \u7684\u7ea6\u675f\u4e0b\uff0c\u6c42\u89e3 \u673a\u5668\u5de5\u5e8f\u94fe \u4e0a\u7684\u5de5\u5e8f\u987a\u5e8f\u3002 \u8868\u5f81\u5de5\u5e8f\u987a\u5e8f\u7684\u4efb\u610f\u6709\u5411\u65e0\u73af\u56fe\u662f\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e00\u4e2a\u53ef\u884c\u89e3\uff0c\u5176\u4e2d\u4ece\u6e90\u8282\u70b9\u5230\u6c47\u7ed3\u70b9\u7684\u6700\u957f\u8def\u5f84\u957f\u5ea6\u76f8\u5bf9\u8f83\u77ed\u8005\u4e3a\u95ee\u9898\u7684\u89e3\u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-08 | \u5206\u7c7b\uff1a optimization , mathematics \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\uff08Job Shop Schedule\uff09\u662f\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u7ec4\u5408\u4f18\u5316\u95ee\u9898\uff0c\u672c\u6587\u8bb0\u5f55\u8be5\u95ee\u9898\u7684\u57fa\u672c\u5b9a\u4e49\uff0c\u66f4\u76f4\u89c2\u7684\u793a\u610f\u56fe\u89e3\u8bfb\u53c2\u8003 \u535a\u6587 \u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#shop problem","text":"\u5728\u8f66\u95f4 m \u53f0\u673a\u5668\uff08machine\uff09\u4e0a\u8c03\u5ea6 n \u4e2a\u4f5c\u4e1a\uff08job\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u4f5c\u4e1a\u5305\u542b\u4e00\u5b9a\u6570\u91cf\u7684\u6b65\u9aa4/\u5de5\u5e8f\uff08operation\uff09\u4e14\u6bcf\u4e2a\u5de5\u5e8f\u9700\u8981\u5728\u7ed9\u5b9a\u7684\u67d0\u4e00\u53f0\u673a\u5668\u4e0a\u6765\u5b8c\u6210\u3002\u5b9a\u4e49\uff1a \u673a\u5668\u96c6\u5408 \\mathbb{M} = \\left \\{ 1, 2, \\cdots, m \\right \\} \\mathbb{M} = \\left \\{ 1, 2, \\cdots, m \\right \\} \u4f5c\u4e1a\u96c6\u5408 \\mathbb{J} = \\left \\{ 1, 2, \\cdots, n \\right \\} \\mathbb{J} = \\left \\{ 1, 2, \\cdots, n \\right \\} \u5de5\u5e8f\u96c6\u5408 \\mathbb{O} = \\left \\{ (i, j) \\; | \\; i \\in \\mathbb{M}^j \\subset \\mathbb{M}, j \\in \\mathbb{J} \\right \\} \\mathbb{O} = \\left \\{ (i, j) \\; | \\; i \\in \\mathbb{M}^j \\subset \\mathbb{M}, j \\in \\mathbb{J} \\right \\} \u8868\u793a\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5c06\u5728\u673a\u5668 i i \u4e0a\u52a0\u5de5\u7684\u5de5\u5e8f\uff0c\u8bb0\u5f55\u5176\u6240\u9700\u65f6\u95f4\u4e3a p_{ij} p_{ij} \u3002\u5176\u4e2d \\mathbb{M}^j \\mathbb{M}^j \u662f\u5b8c\u6210\u4f5c\u4e1a j j \u6240\u6709\u5de5\u5e8f\u6240\u9700\u7684\u673a\u5668\u96c6\u5408\u3002 \u63a5\u4e0b\u6765\u6839\u636e\u4f5c\u4e1a\u4e2d\u5de5\u5e8f\u6570\u91cf\u548c\u987a\u5e8f\u7684\u4e0d\u540c\uff0c\u5c06\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u5206\u4e3a\u4ee5\u4e0b\u4e09\u7c7b\uff1a \u6d41\u6c34\u8f66\u95f4\uff08Flow shop\uff09\uff1a \\mathbb{M}^j=\\mathbb{M} \\mathbb{M}^j=\\mathbb{M} \uff0c\u4e14 \\mathbb{C}_{pre}=\\left\\{(i, j) \\rightarrow (i+1, j)\\;|\\; i=1,2,\\cdots,m\u22121; j=1,2,\\cdots,n \\right\\} \\mathbb{C}_{pre}=\\left\\{(i, j) \\rightarrow (i+1, j)\\;|\\; i=1,2,\\cdots,m\u22121; j=1,2,\\cdots,n \\right\\} \u5f00\u653e\u8f66\u95f4\uff08Open shop\uff09\uff1a \\mathbb{M}^j=\\mathbb{M} \\mathbb{M}^j=\\mathbb{M} \uff0c\u4e14 \\mathbb{C}_{pre}=\\emptyset \\mathbb{C}_{pre}=\\emptyset \u4f5c\u4e1a\u8f66\u95f4\uff08Job shop\uff09\uff1a \\mathbb{C}_{pre}=\\left\\{ (i_1,j) \\rightarrow (i_2,j), \\cdots, \\rightarrow (i_{|\\mathbb{M}^j|}, j) \\;|\\; j=1,2,\\cdots,n \\right\\} \\mathbb{C}_{pre}=\\left\\{ (i_1,j) \\rightarrow (i_2,j), \\cdots, \\rightarrow (i_{|\\mathbb{M}^j|}, j) \\;|\\; j=1,2,\\cdots,n \\right\\} \u5176\u4e2d\uff0c \\mathbb{C}_{pre} \\mathbb{C}_{pre} \u8868\u793a\u5de5\u5e8f\u524d\u540e\u987a\u5e8f\u7684\u5173\u7cfb\u3002 \u7efc\u5408\u8d77\u6765\uff0c\u767d\u8bdd\u5c31\u662f\uff1a \u6d41\u6c34\u8f66\u95f4\uff1a\u4efb\u610f\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5de5\u5e8f\u6570\u76f8\u540c\uff08 m m \uff09\uff0c\u4e14\u5de5\u5e8f\u9075\u5faa\u7684\u5148\u540e\u987a\u5e8f\u76f8\u540c\uff0c\u5373\u6d41\u6c34\u4f5c\u4e1a \u5f00\u653e\u8f66\u95f4\uff1a\u4efb\u610f\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5de5\u5e8f\u6570\u76f8\u540c\uff08 m m \uff09\uff0c\u4f46\u5de5\u5e8f\u6ca1\u6709\u524d\u540e\u987a\u5e8f\u4e4b\u5206\uff0c\u5373\u65e0\u5e8f\u4f5c\u4e1a \u4f5c\u4e1a\u8f66\u95f4\uff1a\u4efb\u610f\u4e24\u4e2a\u4f5c\u4e1a\u7684\u5de5\u5e8f\u6570\u65e0\u5173\uff0c\u4f46\u5404\u81ea\u9075\u5faa\u4e00\u5b9a\u7684\u5148\u540e\u987a\u5e8f\uff0c\u5373\u5f02\u5e8f\u4f5c\u4e1a \u6ce8\u610f \u6d41\u6c34\u8f66\u95f4\u4f5c\u4e1a\u7684\u5de5\u5e8f\u987a\u5e8f\u76f8\u540c\uff0c\u4f46\u662f\u5de5\u5e8f\u7684\u52a0\u5de5\u65f6\u95f4\u53ef\u80fd\u4e0d\u540c\uff0c\u5e76\u4e14\u5206\u914d\u5230\u673a\u5668\u540e\uff0c\u4e0d\u540c\u673a\u5668\u4e0a\u6267\u884c\u4f5c\u4e1a\u7684\u987a\u5e8f\u53ef\u80fd\u4e0d\u540c\u3002","title":"\u4ece\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff08Shop Problem\uff09\u5f00\u59cb"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_2","text":"\u7efc\u4e0a\uff0c\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u53ef\u4ee5\u5b9a\u4e49\u4e3a\uff1a \u7ed9\u5b9a n n \u4e2a\u4f5c\u4e1a\uff0c\u6bcf\u4e2a\u4f5c\u4e1a\u7684\u52a0\u5de5\u8fc7\u7a0b\u5206\u4e3a\u82e5\u5e72\u9053\u5de5\u5e8f\uff0c\u6bcf\u9053\u5de5\u5e8f\u6ee1\u8db3\uff081\uff09\u5e8f\u5217\u7ea6\u675f\u5373\u5fc5\u987b\u5728\u8be5\u4f5c\u4e1a\u7684\u524d\u7eed\u5de5\u5e8f\u5b8c\u6210\u540e\u624d\u80fd\u5f00\u59cb\uff0c\uff082\uff09\u8d44\u6e90\u7ea6\u675f\u5373\u5fc5\u987b\u5728\u7ed9\u5b9a\u7684 m m \u53f0\u673a\u5668\u4e2d\u786e\u5b9a\u7684 \u4e00\u53f0 \u4e0a\u52a0\u5de5\u4e14\u72ec\u5360\u8be5\u65f6\u95f4\u6bb5\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f\u3002 \u5728\u8fd9\u4e9b\u7ea6\u675f\u6761\u4ef6\u4e0b\uff0c\u89c4\u5212\u6bcf\u9053\u5de5\u5e8f\u7684\u5f00\u59cb\u52a0\u5de5\u65f6\u523b\uff0c\u4f7f\u5f97\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u52a0\u5de5\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u523b\u5230\u6700\u540e\u4e00\u4e2a\u5b8c\u6210\u52a0\u5de5\u5de5\u5e8f\u7684\u5b8c\u6210\u65f6\u523b\u7684\u65f6\u95f4\u8de8\u5ea6\uff08makespan\uff09\u5c3d\u53ef\u80fd\u7684\u77ed\u3002 \u4e3e\u4e00\u4e2a3\u673a\u56683\u4f5c\u4e1a\u7684\u4f8b\u5b50\uff1a \u4f5c\u4e1a1\uff1a (3,1) -> (2,1) -> (1,1) \uff0cp31 = 4, p21 = 2, p11 = 1 \u4f5c\u4e1a2\uff1a (1,2) -> (3,2) \uff0cp12 = 3, p32 = 3 \u4f5c\u4e1a3\uff1a (2,3) -> (1,3) -> (3,3) \uff0cp23 = 2, p13 = 4, p33 = 1 \u4f5c\u4e1a1\u75313\u9053\u5de5\u5e8f\u7ec4\u6210\uff0c\u5206\u522b\u6309\u673a\u56683\uff0c\u673a\u56682\uff0c\u673a\u56681\u7684\u987a\u5e8f\u52a0\u5de5\uff0c\u52a0\u5de5\u65f6\u95f4\u5206\u522b\u4e3a4\uff0c2\uff0c1\uff1b\u4f5c\u4e1a2\uff0c3\u540c\u7406\u89e3\u8bfb\u3002\u5c06\u5176\u4ee5\u8868\u683c\u7684\u5f62\u5f0f\u5217\u51fa\u6765\u4e3a\uff1a -------------------------------------- \u5de5\u5e8f,\u65f6\u95f4 \u4f5c\u4e1a ------------------------------ 1 2 3 -------------------------------------- 1 M3, 4 M2, 2 M1, 1 2 M1, 3 M3, 3 3 M2, 2 M1, 4 M3, 1 ---------------------------------------","title":"\u767d\u8bdd\u63cf\u8ff0"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_3","text":"\u5b9a\u4e49\u5de5\u5e8f (i,j) (i,j) \u7684\u5b8c\u5de5\u65f6\u95f4\u4e3a c_{ij} c_{ij} \uff0c\u5219\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7b49\u6548\u4e3a\u5982\u4e0b\u4f18\u5316\u95ee\u9898\uff1a \\begin{align*} &\\min\\,\\, c_{m} = \\max \\left \\{ c_{ij} \\, | \\, (i,j) \\in \\mathbb{O} \\right \\} \\\\ \\\\ &s.t.\\quad \\begin{cases} c_{ij} \\geq p_{ij} & (i,j) \\in \\mathbb{O} \\\\ \\\\ c_{ij}-c_{kj} \\geq p_{ij} & if \\,\\, (k,j) \\rightarrow (i,j), \\,\\, i, k \\in \\mathbb{M}^j \\\\ \\\\ c_{ij} - c_{ik} \\geq p_{ij} \\,\\, or \\,\\, c_{ik}-c_{ij} \\geq p_{ik} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5176\u4e2d\uff0c \u7b2c\u4e00\u4e2a\u7ea6\u675f\u8868\u660e\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4\u975e\u8d1f \u7b2c\u4e8c\u4e2a\u662f\u5de5\u5e8f\u5e8f\u5217\u7ea6\u675f\uff0c\u5373\u540c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u76f8\u90bb\u5de5\u5e8f\u5fc5\u987b\u6ee1\u8db3\u5148\u540e\u987a\u5e8f \u7b2c\u4e09\u4e2a\u662f\u8d44\u6e90\u7ea6\u675f\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f\u3002 \u8fd9\u79cd\u63cf\u8ff0\u65b9\u5f0f\u7b26\u5408\u6574\u6570\u89c4\u5212\u6a21\u578b\uff0c\u4fbf\u4e8e\u76f4\u63a5\u5229\u7528\u5b9e\u73b0\u4e86\u9ad8\u6548\u6574\u6570\u4f18\u5316\u7b97\u6cd5\u7684\u6c42\u89e3\u5668\u8fdb\u884c\u6c42\u89e3\uff1b\u7f3a\u70b9\u6c42\u89e3\u6548\u7387\u53d7\u5230\u95ee\u9898\u89c4\u6a21\u7684\u9650\u5236\u3002","title":"\u6570\u5b66\u63cf\u8ff0"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_4","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u8868\u9762\u4e0a\u662f\u6c42\u89e3\u5de5\u5e8f\u7684\u5f00\u59cb/\u7ed3\u675f\u65f6\u95f4\uff0c\u5b9e\u9645\u4e0a\u662f\u5de5\u5e8f\u5728\u673a\u5668\u4e0a\u7684\u6392\u5e8f\u95ee\u9898\u3002\u4e8e\u662f\uff0c\u6d89\u53ca\u4e24\u7c7b\u5e8f\u5217\uff1a \u4f5c\u4e1a\u5de5\u5e8f\u94fe\u5373\u4f5c\u4e1a\u89c6\u89d2\u4e0a\u5de5\u5e8f\u7684\u987a\u5e8f\uff0c\u8fd9\u4e2a\u662f\u5df2\u77e5\u7684\u7ea6\u675f\u6761\u4ef6 \u673a\u5668\u5de5\u5e8f\u94fe\u5373\u5206\u914d\u5230\u76f8\u5e94\u673a\u5668\u4e0a\u7684\u6240\u6709\u5de5\u5e8f\u7684\u5e8f\u5217\uff0c\u6bcf\u4e2a\u673a\u5668\u7684\u6bcf\u4e00\u79cd\u6392\u5217\u65b9\u5f0f\u5373\u5bf9\u5e94\u4e00\u79cd\u8c03\u5ea6\u65b9\u5f0f \u4e8e\u662f\uff0c\u4ea7\u751f\u4e86\u7528\u6790\u53d6\u56fe\uff08Disjunctive Graph\uff09\u6765\u63cf\u8ff0\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u65b9\u5f0f\u3002 \u5b9a\u4e49\u56fe\u7ed3\u6784 G = (V, C, D) G = (V, C, D) \uff0c\u5176\u4e2d\uff1a V V \u662f\u8282\u70b9\u96c6\u5408\uff0c\u5bf9\u5e94\u5de5\u5e8f\u96c6 \\mathbb{O} \\mathbb{O} \uff0c\u4ee5\u53ca\u989d\u5916\u52a0\u5165\u7684\u4e24\u4e2a\u7b49\u6548\u52a0\u5de5\u65f6\u95f4\u90fd\u4e3a0\u7684\u865a\u62df\u8282\u70b9\uff1a \u6e90\u8282\u70b9\uff08source\uff09 s s \uff1a\u6e90\u8282\u70b9\u6307\u5411\u6240\u6709\u4f5c\u4e1a\u7684\u7b2c\u4e00\u4e2a\u5de5\u5e8f \u6c47\u8282\u70b9\uff08sink\uff09 e e \uff1a\u6240\u6709\u4f5c\u4e1a\u7684\u6700\u540e\u4e00\u4e2a\u5de5\u5e8f\u6307\u5411\u6c47\u8282\u70b9 C C \u662f\u8fde\u63a5\u8fb9\u96c6\u5408\uff08conjunctive arcs\uff09\uff0c\u5bf9\u5e94\u4f5c\u4e1a\u5de5\u5e8f\u94fe\u7684\u987a\u5e8f\u5173\u7cfb\uff0c\u7531\u4e0a\u4e00\u5de5\u5e8f\u6307\u5411\u4e0b\u4e00\u5de5\u5e8f\uff1b\u540c\u65f6\u5305\u62ec\u7531\u865a\u62df\u8282\u70b9\u5f15\u5165\u7684 2n 2n \u6761\u6709\u5411\u8fb9\uff1a \u6e90\u8282\u70b9\u6307\u5411\u6240\u6709\u4f5c\u4e1a\u7684\u7b2c\u4e00\u4e2a\u5de5\u5e8f\u7684 n n \u6761\u6709\u5411\u8fb9 \u6240\u6709\u4f5c\u4e1a\u7684\u6700\u540e\u4e00\u4e2a\u5de5\u5e8f\u6307\u5411\u6c47\u8282\u70b9\u7684 n n \u6761\u6709\u5411\u8fb9 D D \u662f\u6790\u53d6\u8fb9\u96c6\u5408\uff08disjunctive arcs\uff09\uff0c\u5bf9\u5e94\u6f5c\u5728\u7684\u673a\u5668\u5de5\u5e8f\u94fe\u8fde\u63a5\u5173\u7cfb\uff0c\u6bcf\u4e00\u6761\u6790\u53d6\u8fb9\u8fde\u63a5\u540c\u4e00\u673a\u5668\u4e0a\u52a0\u5de5\u7684\u4e24\u4e2a\u5de5\u5e8f\u3002 \u8fd8\u662f\u4ee5\u524d\u97623\u673a\u56683\u4f5c\u4e1a\u4e3a\u4f8b\uff0c\u6790\u53d6\u56fe\u5982\u4e0b\u3002\u5176\u4e2d\uff0c \u5f69\u8272\u7bad\u5934\u8868\u793a\u7684\u6709\u5411\u8fb9\u4e3a\u8fde\u63a5\u8fb9\u96c6\u5408 C C \uff0c\u7bad\u5934\u4ece\u4e0a\u4e00\u9053\u5de5\u5e8f\u6307\u5411\u4e0b\u4e00\u9053\u5de5\u5e8f\uff0c\u5b9a\u4e49\u8fb9\u7684\u6743\u503c\u4e3a\u51fa\u53d1\u8282\u70b9\u5373\u4e0a\u4e00\u9053\u5de5\u5e8f\u7684\u52a0\u5de5\u65f6\u95f4\u3002 \u9ed1\u8272\u5b9e\u7ebf\u8868\u793a\u7684\u65e0\u5411\u8fb9\u4e3a\u6790\u53d6\u8fb9\u96c6\u5408 D D \uff0c\u76f8\u540c\u673a\u5668\u4e0a\u7684\u5de5\u5e8f\u4e4b\u95f4\u90fd\u6709\u4e00\u6761\u6790\u53d6\u8fb9\uff0c\u4f8b\u59821\u53f7\u673a\u5668\u4e0a\u7684 (1,1) \u3001 (1,2) \u548c (1,3) \u3002\u6b64\u65f6\u5c1a\u672a\u786e\u5b9a\u8fb9\u7684\u65b9\u5411\uff0c\u6545\u6743\u503c\u6682\u65f6\u4e3a\u7a7a\u3002","title":"\u6790\u53d6\u56fe\u63cf\u8ff0"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_5","text":"\u4e3a\u6240\u6709\u6790\u53d6\u8fb9\u9009\u62e9\u4e00\u4e2a\u65b9\u5411\u5373\u786e\u5b9a\u673a\u5668\u4e0a\u5de5\u5e8f\u7684\u5148\u540e\u987a\u5e8f\u540e\uff0c\u6790\u53d6\u56fe\u9000\u5316\u4e3a\u6709\u5411\u56fe\uff0c\u4e5f\u5373\u5bf9\u5e94\u4e00\u79cd\u8c03\u5ea6\u65b9\u6848\u3002\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u53ef\u80fd\u7684\u65b9\u6848\u5373\u89e3\u7684\u641c\u7d22\u7a7a\u95f4\u5927\u5c0f\u4e3a\uff1a N = \\prod_{i=0}^m |\\mathbb{J}^i|! N = \\prod_{i=0}^m |\\mathbb{J}^i|! \u5176\u4e2d\uff0c |\\mathbb{J}^i| |\\mathbb{J}^i| \u8868\u793a\u673a\u5668 i i \u4e0a\u52a0\u5de5\u7684\u5de5\u5e8f\u6570\u91cf\u3002 \u663e\u7136\uff0c\u95ee\u9898\u89c4\u6a21\u968f\u7740\u673a\u5668\u6570\u548c\u4f5c\u4e1a\u6570\u7684\u589e\u52a0\u800c\u6025\u5267\u589e\u5927\u3002","title":"\u641c\u7d22\u7a7a\u95f4"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_6","text":"\u5047\u8bbe\u6240\u6709\u673a\u5668\u4e0a\u7684\u5de5\u5e8f\u90fd\u6309\u4f5c\u4e1a\u53f7\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4f8b\u59823\u53f7\u673a\u5668\u4e0a (3,1) -> (3,2) -> (3,3) \uff0c\u5219\u5f97\u5230\u5982\u4e0b\u4e00\u4e2a\u6709\u5411\u56fe\u7ed3\u6784\u3002 \u6709\u5411\u56fe\u53cd\u6620\u4e86\u4f5c\u4e1a\u5de5\u5e8f\u94fe\u548c\u673a\u5668\u5de5\u5e8f\u94fe\u4e0a\u5de5\u5e8f\u7684\u987a\u5e8f\u5173\u7cfb\uff0c\u5e76\u4e14 \u6e90\u8282\u70b9\u5230\u67d0\u8282\u70b9\u7684\u6700\u957f\u8def\u5f84\u957f\u5ea6\u5373\u4e3a\u8be5\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4 \u3002\u4e8e\u662f\uff0c\u6e90\u8282\u70b9\u5230\u6c47\u7ed3\u70b9\u7684\u6700\u957f\u8def\u5f84\uff08\u56fe\u4e2d\u9ec4\u8272\u7ebf\uff09\u5373\u4e3a\u76ee\u6807\u51fd\u6570\uff08\u52a0\u5de5\u5468\u671f\uff09 c_m c_m \u3002 \u6709\u5411\u56fe\u7684\u6700\u957f\u8def\u5f84\u7b97\u6cd5\uff08\u4f8b\u5982\u62d3\u6251\u6392\u5e8f\uff09\u6709\u52a9\u4e8e\u6211\u4eec\u8ba1\u7b97\u548c\u8bc4\u4f30\u76ee\u6807\u51fd\u6570\u503c\u3002","title":"\u6709\u5411\u56fe\u4e0e\u8def\u5f84\u957f\u5ea6"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_7","text":"\u6709\u5411\u56fe\u7684\u8fb9\u5f88\u597d\u5730\u8868\u793a\u4e86\u5de5\u5e8f\u7684\u5148\u540e\u987a\u5e8f\uff0c\u4f46\u662f\u5982\u679c\u5b58\u5728 \u73af \uff0c\u5219\u4f1a\u4ea7\u751f\u77db\u76fe\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u6709\u5411\u56fe\u7ed3\u6784\u4e2d\uff0c\u9ec4\u8272\u7ebf\u8def\u5f84\u6784\u6210\u4e86\u4e00\u4e2a\u73af\u8def\uff1a \u673a\u56683\u4e0a\uff0c\u5de5\u5e8f (3,1) \u6392\u5728\u4f5c\u4e1a2\u7684\u5de5\u5e8f (3,2) \u4e4b\u540e\uff0c\u5373\u5fc5\u987b\u7b49\u5f85 (3,2) \u5b8c\u5de5 \u4f5c\u4e1a2\u4e0a\uff0c\u5de5\u5e8f (3,2) \u5219\u5fc5\u987b\u7b49\u5f85\u7b2c\u4e00\u9053\u5de5\u5e8f (1,2) \u5b8c\u5de5 \u673a\u56681\u4e0a\uff0c\u5de5\u5e8f (1,2) \u6392\u5728\u4f5c\u4e1a1\u7684 (1,1) \u4e4b\u540e\uff0c\u5373\u5fc5\u987b\u7b49\u5f85 (1,1) \u5b8c\u5de5 \u4f5c\u4e1a1\u4e0a\uff0c\u5de5\u5e8f (1,1) \u5219\u5fc5\u987b\u7b49\u5f85\u7b2c\u4e00\u9053\u5de5\u5e8f (3,1) \u5b8c\u5de5 \u7efc\u4e0a\uff0c\u5de5\u5e8f (3,1) \u5fc5\u987b\u7b49\u5f85\u81ea\u8eab\u5b8c\u6210\u4e4b\u540e\u624d\u80fd\u5f00\u59cb\uff01\u8fd9\u663e\u7136\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u6240\u4ee5\uff0c \u4e00\u4e2a\u53ef\u884c\u7684\u89e3\u5fc5\u987b\u662f\u6709\u5411\u65e0\u73af\u56fe \u3002\u56e0\u6b64\uff0c\u9700\u8981\u6709\u5411\u56fe\u7684\u73af\u8def\u68c0\u6d4b\u7b97\u6cd5\uff08\u4f8b\u5982\u62d3\u6251\u6392\u5e8f\uff09\u6765\u8fc7\u6ee4\u5019\u9009\u89e3\u3002","title":"\u6709\u5411\u65e0\u73af\u56fe"},{"location":"2021-08-08-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0/#_8","text":"\u6d41\u6c34\u8f66\u95f4\u3001\u5f00\u653e\u8f66\u95f4\u53ca\u4f5c\u4e1a\u8f66\u95f4\u95ee\u9898\u7684\u4e3b\u8981\u533a\u522b\u8868\u73b0\u4e3a\u4f5c\u4e1a\u5de5\u5e8f\u7684\u6570\u91cf\u548c\u987a\u5e8f\u662f\u5426\u76f8\u540c\u3002 \u65e0\u8bba\u6570\u5b66\u63cf\u8ff0\u8fd8\u662f\u6790\u53d6\u56fe\u63cf\u8ff0\uff0c\u4f5c\u4e1a\u8f66\u95f4\u95ee\u9898\u90fd\u8868\u73b0\u4e3a\u5728 \u4f5c\u4e1a\u5de5\u5e8f\u94fe \u7684\u7ea6\u675f\u4e0b\uff0c\u6c42\u89e3 \u673a\u5668\u5de5\u5e8f\u94fe \u4e0a\u7684\u5de5\u5e8f\u987a\u5e8f\u3002 \u8868\u5f81\u5de5\u5e8f\u987a\u5e8f\u7684\u4efb\u610f\u6709\u5411\u65e0\u73af\u56fe\u662f\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e00\u4e2a\u53ef\u884c\u89e3\uff0c\u5176\u4e2d\u4ece\u6e90\u8282\u70b9\u5230\u6c47\u7ed3\u70b9\u7684\u6700\u957f\u8def\u5f84\u957f\u5ea6\u76f8\u5bf9\u8f83\u77ed\u8005\u4e3a\u95ee\u9898\u7684\u89e3\u3002","title":"\u603b\u7ed3"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-14 | \u5206\u7c7b\uff1a optimization , python/vba/cpp \u57fa\u4e8e\u524d\u6587\u5bf9\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u5b9a\u4e49\u548c\u63cf\u8ff0\uff0c\u672c\u6587\u8fdb\u884cPython\u5efa\u6a21\uff0c\u5f00\u53d1\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff0c\u628a\u95ee\u9898\u5206\u89e3\u3001\u62bd\u8c61\u4e3a\u53ef\u91cd\u7528\u7684\u90e8\u5206\uff0c\u4ece\u800c\u4e13\u6ce8\u6c42\u89e3\u7b97\u6cd5\u7684\u5f00\u53d1\u3001\u5b9e\u65bd\u548c\u9a8c\u8bc1\u3002 dothinking/jsp_framework \u6846\u67b6\u7ed3\u6784 \u00b6 \u6574\u4e2a\u6c42\u89e3\u6846\u67b6\u57fa\u4e8ePython\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u5b9e\u73b0\uff0c\u4e3b\u8981\u7ed3\u6784\u53c2\u8003\u4e0b\u56fe\u3002 \u5176\u4e2d\uff0c\u6240\u6709\u5bf9\u8c61\u6309\u7528\u9014\u53ef\u4ee5\u5f52\u4e3a\u4e09\u7c7b\uff1a \uff081\uff09\u7269\u7406\u5bf9\u8c61 \u00b6 Job \u4f5c\u4e1a\u5b9e\u4f53 Machine \u673a\u5668\u5b9e\u4f53 Operation \u5de5\u5e8f\u5b9e\u4f53\uff0c\u5305\u542b\u6240\u5c5e\u4f5c\u4e1a\u3001\u5206\u914d\u7684\u673a\u5668\u3001\u52a0\u5de5\u65f6\u957f\u7b49\u5c5e\u6027 \uff082\uff09\u6c42\u89e3\u53d8\u91cf \u00b6 OperationStep \u662f\u5de5\u5e8f\u5b9e\u4f53 Operation \u7684\u5c01\u88c5\uff0c\u540c\u65f6\u52a0\u4e0a\u5f85\u6c42\u89e3\u7684\u53c2\u6570 start_time \u3002\u6839\u636e\u524d\u6587\u5173\u4e8e\u4f5c\u4e1a\u8f66\u95f4\u95ee\u9898\u7684\u4e24\u79cd\u4e0d\u540c\u7684\u63cf\u8ff0\u65b9\u5f0f\uff0c\u76f8\u5e94\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u6c42\u89e3\u601d\u8def\uff1a \u5bf9\u4e8e\u4ee5 start_time \u4e3a\u53d8\u91cf\u63cf\u8ff0\u7684\u6570\u5b66\u6a21\u578b\uff0c\u76f4\u63a5\u6c42\u89e3 start_time \u5373\u53ef \u5bf9\u4e8e\u4ee5 \u6790\u53d6\u56fe \u63cf\u8ff0\u7684\u6a21\u578b\uff0c\u9700\u8981\u5148\u6c42\u89e3\u5de5\u5e8f\u7684\u987a\u5e8f\uff0c\u7136\u540e\u9012\u63a8\u51fa start_time \u56e0\u6b64\uff0c\u5bf9\u4e8e\u6790\u53d6\u56fe\u63cf\u8ff0\u7684\u6a21\u578b\uff0c\u8fd8\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u4e2d\u95f4\u5c5e\u6027\uff1a \u7ee7\u627f\u81ea JobStep \u7684 pre_job_op \u548c next_job_op \uff0c\u5206\u522b\u8868\u793a\u5f53\u524d\u5de5\u5e8f\u5728\u6240\u5c5e\u4f5c\u4e1a\u5b9e\u4f53\u4e0a\u7684\u987a\u5e8f\uff1a\u524d\u4e00\u9053\u5de5\u5e8f\u548c\u4e0b\u4e00\u9053\u5de5\u5e8f\uff1b\u5e76\u4e14\uff0c\u5b83\u4eec\u662f\u5df2\u77e5\u7684\u3002 \u7ee7\u627f\u81ea MachineStep \u7684 pre_machine_op \u548c next_machine_op \uff0c\u5206\u522b\u8868\u793a\u5f53\u524d\u5de5\u5e8f\u5728\u5206\u914d\u673a\u5668\u4e0a\u7684\u52a0\u5de5\u987a\u5e8f\uff1a\u524d\u4e00\u9053\u5de5\u5e8f\u548c\u4e0b\u4e00\u9053\u5de5\u5e8f\uff1b\u6ce8\u610f\u8fd9\u4e2a\u987a\u5e8f\u5373\u4e3a\u9700\u8981\u6c42\u89e3\u7684\u53d8\u91cf\u3002 \uff083\uff09\u6c42\u89e3\u6d41\u7a0b \u00b6 JSProblem \u662f\u6240\u6709\u5de5\u5e8f\u5b9e\u4f53 Operation \u7684\u5c01\u88c5\uff1a \u5b83\u7684\u89e3\u4e3a\u4e00\u4e2a JSSolution \u5b9e\u4f8b \u6bcf\u5f53\u83b7\u5f97\u4e00\u4e2a\u66f4\u597d\u7684\u89e3\uff0c \u9700\u8981\u4f7f\u7528 update_solution() \u65b9\u6cd5\u663e\u5f0f\u66f4\u65b0 JSSolution \u662f\u6240\u6709\u53d8\u91cf OperationStep \u7684\u5c01\u88c5\uff1a \u5bf9\u4e8e\u6790\u53d6\u56fe\u6c42\u89e3\u6a21\u578b\uff0c\u9700\u8981\u663e\u5f0f\u5730\u8c03\u7528 evaluate() \u6765\u57fa\u4e8e\u6c42\u89e3\u7684\u987a\u5e8f\u8ba1\u7b97\u6700\u7ec8\u53d8\u91cf start_time \uff1b\u57fa\u4e8e\u6570\u5b66\u6a21\u578b\u5219\u65e0\u9700\u8fd9\u4e00\u6b65\u3002 is_feasible() \u5224\u65ad\u4e00\u4e2a\u89e3\u662f\u5426\u6ee1\u8db3\u6240\u6709\u7ea6\u675f \u5982\u679c\u662f\u4e00\u4e2a\u53ef\u884c\u89e3\uff0c makespan \u5c5e\u6027\u5f97\u5230\u6700\u5927\u52a0\u5de5\u5468\u671f\u957f\u5ea6 JSSolver \u662f\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u5668\u7684\u57fa\u7c7b\uff0c\u4fbf\u4e8e\u7ee7\u627f\u6b64\u57fa\u7c7b\u540e\u5b9e\u65bd\u65b0\u7b97\u6cd5\u3002 \u5b9e\u65bd\u65b0\u7b97\u6cd5 \u00b6 \u4ee5\u4e0a\u7684\u8bbe\u8ba1\u53ef\u4ee5\u907f\u514d\u91cd\u590d\u5de5\u4f5c\uff0c\u4ece\u800c\u4e13\u6ce8\u4e8e\u7b97\u6cd5\u672c\u8eab\u7684\u5b9e\u73b0\u548c\u6d4b\u8bd5\u3002\u57fa\u4e8e\u6b64\u6846\u67b6\uff0c\u5b9e\u65bd\u65b0\u7b97\u6cd5\u7684\u53ea\u9700\u521b\u5efa\u81ea\u5b9a\u4e49\u6c42\u89e3\u5668\u7c7b\uff0c\u7136\u540e\u7ee7\u627f JSSolver \u5e76\u5b9e\u73b0 do_solver() \u65b9\u6cd5\u3002 do_solver() \u65b9\u6cd5\u5185\u90e8\u4e3b\u8981\u5206\u4e3a\u4e09\u5927\u6b65\u9aa4\uff1a \u57fa\u4e8e\u95ee\u9898\u521b\u5efa\u521d\u59cb\u72b6\u6001\u7684\u89e3\uff08\u6ce8\u610f\u5e76\u975e\u53ef\u884c\u7684 \u521d\u59cb\u89e3 \uff09 solution = JSSolution(problem) \u5b9e\u65bd\u7b97\u6cd5\uff0c\u8ba1\u7b97\u6216\u8005\u4f18\u5316\u8fd9\u4e2a\u89e3 \u5bf9\u4e8e\u4ee5 start_time \u4e3a\u53d8\u91cf\u63cf\u8ff0\u7684\u6570\u5b66\u6a21\u578b\uff0c\u76f4\u63a5\u6c42\u89e3\u6bcf\u4e2a\u5de5\u5e8f\u7684 start_time \u5373\u53ef \u5bf9\u4e8e\u4ee5\u6790\u53d6\u56fe\u63cf\u8ff0\u7684\u6a21\u578b\uff0c\u9700\u8981\u5148\u6c42\u89e3\u5de5\u5e8f\u7684\u987a\u5e8f\uff0c\u7136\u540e\u663e\u5f0f\u5730\u8c03\u7528 solution.evaluate() \u9012\u63a8\u51fa start_time \u6bcf\u6b21\u8fed\u4ee3\u5f97\u5230\u66f4\u597d\u7684\u89e3\u540e\uff0c\u663e\u5f0f\u66f4\u65b0\u95ee\u9898\u7684\u89e3 problem.update_solution(solution) \u5173\u952e\u4ee3\u7801\u53c2\u8003\uff1a # user defined path, e.g. path/to/UserSolver.py from jsp_fwk import (JSProblem, JSSolution, JSSolver) class UserSolver(JSSolver): def do_solve(self, problem:JSProblem): '''User defined solving process.''' # (1) Initialize an empty solution from problem solution = JSSolution(problem) # (2) Solve or optimize the solution, # i.e. determine the start_time of OperationStep instances. # Note to evaluate solution explicitly if disjunctive graph model. ... # solution.evaluate() # (3) Update the solution for problem iteratively problem.update_solution(solution) \u6d4b\u8bd5\u7b97\u6cd5 \u00b6 \u6846\u67b6\u5df2\u7ecf\u5185\u7f6e\u4e86\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6807\u51c6\u95ee\u9898\u6570\u636e\uff0c\u4fbf\u4e8e\u6839\u636e\u540d\u79f0\u76f4\u63a5\u521d\u59cb\u5316\u95ee\u9898\u3002\u66f4\u591a\u57fa\u672c\u95ee\u9898\u6570\u636e \u53c2\u8003 \u3002 \uff081\uff09\u5355\u4e2a\u7b97\u6cd5\u5355\u4e2a\u95ee\u9898 \u00b6 \u5355\u4e2a\u7b97\u6cd5\u6c42\u89e3\u5355\u4e2a\u95ee\u9898\u4e3b\u8981\u7528\u4e8e\u7b97\u6cd5\u8c03\u8bd5\u9636\u6bb5\uff0c solve() \u65b9\u6cd5\u4e2d\u7684\u4e24\u4e2a\u53c2\u6570\uff1a interval \u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u68c0\u6d4b\u548c\u52a8\u6001\u663e\u793a\u5f53\u524d\u89e3\u7684\u7518\u7279\u56fe\uff0c\u5982\u679c\u8bbe\u4e3a None \u5219\u4e0d\u663e\u793a\u7518\u7279\u56fe callback \u5728\u6bcf\u6b21\u83b7\u5f97\u66f4\u597d\u7684\u89e3\u540e\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u52a8\u4f5c\uff0c\u4f8b\u5982\u6253\u5370\u8fd9\u4e2a\u89e3 \u4ee5\u4e0b\u793a\u4f8b\u8c03\u7528\u4e0a\u4e00\u8282\u81ea\u5b9a\u4e49\u7684\u6c42\u89e3\u5668 UserSolver \u6c42\u89e3 ft10 \u95ee\u9898\u3002 # run.py from jsp_fwk import JSProblem from path/to/UserSolver import UserSolver # load benchmark problem problem = JSProblem(benchmark='ft10') # solve problem with user defined solver s = UserSolver() fun = lambda solution: print(f'makespan: {solution.makespan}') s.solve(problem=problem, interval=2000, callback=fun) \uff082\uff09\u591a\u4e2a\u7b97\u6cd5\u591a\u4e2a\u95ee\u9898 \u00b6 \u5f53\u7b97\u6cd5\u8c03\u8bd5\u7a33\u5b9a\u540e\uff0c\u6211\u4eec\u9700\u8981\u6d4b\u8bd5\u5b83\u5728\u4e0d\u540c\u89c4\u6a21\u95ee\u9898\u4e0a\u7684\u8868\u73b0\uff0c\u6216\u8005\u5bf9\u6bd4\u4e0d\u540c\u7b97\u6cd5\u5bf9\u76f8\u540c\u95ee\u9898\u7684\u6c42\u89e3\u6548\u7387\u3002\u9488\u5bf9\u6b64\u7c7b\u573a\u666f\uff0c\u672c\u6846\u67b6\u5185\u7f6e\u4e86 Benchmark \u7c7b\uff1a\u6392\u5217\u7ec4\u5408\u8f93\u5165\u7684\u6c42\u89e3\u5668\u548c\u95ee\u9898\uff0c\u7136\u540e\u8fdb\u884c\u591a\u7ebf\u7a0b\u5f02\u6b65\u6c42\u89e3\uff0c\u6700\u540e\u5bf9\u6bd4\u7ed3\u679c\u3002\u663e\u7136\uff0c Benchmark \u7c7b\u4e5f\u9002\u7528\u4e8e\u5355\u4e2a\u7b97\u6cd5\u5355\u4e2a\u95ee\u9898\u7684\u573a\u666f\u3002 \u4e0b\u9762\u4f8b\u5b50\u6f14\u793a\u4e86\u4e24\u7c7b\u6c42\u89e3\u5668\uff0cGoogle OR-Tools\u6574\u6570\u89c4\u5212\u548c\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5\uff0c\u6c42\u89e3\u4e0d\u540c\u89c4\u6a21\u76845\u4e2a\u95ee\u9898\u7684\u5bf9\u6bd4\u3002 # benchmark.py import logging from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import (GoogleORCPSolver, PriorityDispatchSolver) # ---------------------------------------- # create problem from benchmark # ---------------------------------------- names = ['ft06', 'la01', 'ft10', 'swv01', 'la38'] problems = [JSProblem(benchmark=name) for name in names] # ---------------------------------------- # test built-in solver # ---------------------------------------- # googl or-tools s1 = GoogleORCPSolver(max_time=300, name='or-tools') # priority dispatching s2 = PriorityDispatchSolver(rule='t', name='pd-t-rule') solvers = [s1, s2] # ---------------------------------------- # solve and result # ---------------------------------------- benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=4) benchmark.run(show_info=True) \u7ed3\u679c\u793a\u4f8b\uff1a +---------+-----------+-------+---------+----------+---------+-------+ | Problem | Solver | Scale | Optimum | Solution | Error % | Time | +---------+-----------+-------+---------+----------+---------+-------+ | ft06 | pd-t-rule | 6x6 | 55 | 60.0 | 9.1 | 0.0 | | la01 | pd-t-rule | 10x5 | 666 | 666.0 | 0.0 | 0.0 | | ft10 | pd-t-rule | 10x10 | 930 | 1082.0 | 16.3 | 0.1 | | ft06 | or-tools | 6x6 | 55 | 55 | 0.0 | 0.1 | | swv01 | pd-t-rule | 20x10 | 1407 | 1839.0 | 30.7 | 0.2 | | la01 | or-tools | 10x5 | 666 | 666 | 0.0 | 0.4 | | la38 | pd-t-rule | 15x15 | 1196 | 1387.0 | 16.0 | 0.6 | | ft10 | or-tools | 10x10 | 930 | 930 | 0.0 | 4.2 | | la38 | or-tools | 15x15 | 1196 | 1196 | 0.0 | 141.1 | | swv01 | or-tools | 20x10 | 1407 | 1414 | 0.5 | 300.1 | +---------+-----------+-------+---------+----------+---------+-------+","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#python","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-14 | \u5206\u7c7b\uff1a optimization , python/vba/cpp \u57fa\u4e8e\u524d\u6587\u5bf9\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u5b9a\u4e49\u548c\u63cf\u8ff0\uff0c\u672c\u6587\u8fdb\u884cPython\u5efa\u6a21\uff0c\u5f00\u53d1\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff0c\u628a\u95ee\u9898\u5206\u89e3\u3001\u62bd\u8c61\u4e3a\u53ef\u91cd\u7528\u7684\u90e8\u5206\uff0c\u4ece\u800c\u4e13\u6ce8\u6c42\u89e3\u7b97\u6cd5\u7684\u5f00\u53d1\u3001\u5b9e\u65bd\u548c\u9a8c\u8bc1\u3002 dothinking/jsp_framework","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#_1","text":"\u6574\u4e2a\u6c42\u89e3\u6846\u67b6\u57fa\u4e8ePython\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u5b9e\u73b0\uff0c\u4e3b\u8981\u7ed3\u6784\u53c2\u8003\u4e0b\u56fe\u3002 \u5176\u4e2d\uff0c\u6240\u6709\u5bf9\u8c61\u6309\u7528\u9014\u53ef\u4ee5\u5f52\u4e3a\u4e09\u7c7b\uff1a","title":"\u6846\u67b6\u7ed3\u6784"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#1","text":"Job \u4f5c\u4e1a\u5b9e\u4f53 Machine \u673a\u5668\u5b9e\u4f53 Operation \u5de5\u5e8f\u5b9e\u4f53\uff0c\u5305\u542b\u6240\u5c5e\u4f5c\u4e1a\u3001\u5206\u914d\u7684\u673a\u5668\u3001\u52a0\u5de5\u65f6\u957f\u7b49\u5c5e\u6027","title":"\uff081\uff09\u7269\u7406\u5bf9\u8c61"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#2","text":"OperationStep \u662f\u5de5\u5e8f\u5b9e\u4f53 Operation \u7684\u5c01\u88c5\uff0c\u540c\u65f6\u52a0\u4e0a\u5f85\u6c42\u89e3\u7684\u53c2\u6570 start_time \u3002\u6839\u636e\u524d\u6587\u5173\u4e8e\u4f5c\u4e1a\u8f66\u95f4\u95ee\u9898\u7684\u4e24\u79cd\u4e0d\u540c\u7684\u63cf\u8ff0\u65b9\u5f0f\uff0c\u76f8\u5e94\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u6c42\u89e3\u601d\u8def\uff1a \u5bf9\u4e8e\u4ee5 start_time \u4e3a\u53d8\u91cf\u63cf\u8ff0\u7684\u6570\u5b66\u6a21\u578b\uff0c\u76f4\u63a5\u6c42\u89e3 start_time \u5373\u53ef \u5bf9\u4e8e\u4ee5 \u6790\u53d6\u56fe \u63cf\u8ff0\u7684\u6a21\u578b\uff0c\u9700\u8981\u5148\u6c42\u89e3\u5de5\u5e8f\u7684\u987a\u5e8f\uff0c\u7136\u540e\u9012\u63a8\u51fa start_time \u56e0\u6b64\uff0c\u5bf9\u4e8e\u6790\u53d6\u56fe\u63cf\u8ff0\u7684\u6a21\u578b\uff0c\u8fd8\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u4e2d\u95f4\u5c5e\u6027\uff1a \u7ee7\u627f\u81ea JobStep \u7684 pre_job_op \u548c next_job_op \uff0c\u5206\u522b\u8868\u793a\u5f53\u524d\u5de5\u5e8f\u5728\u6240\u5c5e\u4f5c\u4e1a\u5b9e\u4f53\u4e0a\u7684\u987a\u5e8f\uff1a\u524d\u4e00\u9053\u5de5\u5e8f\u548c\u4e0b\u4e00\u9053\u5de5\u5e8f\uff1b\u5e76\u4e14\uff0c\u5b83\u4eec\u662f\u5df2\u77e5\u7684\u3002 \u7ee7\u627f\u81ea MachineStep \u7684 pre_machine_op \u548c next_machine_op \uff0c\u5206\u522b\u8868\u793a\u5f53\u524d\u5de5\u5e8f\u5728\u5206\u914d\u673a\u5668\u4e0a\u7684\u52a0\u5de5\u987a\u5e8f\uff1a\u524d\u4e00\u9053\u5de5\u5e8f\u548c\u4e0b\u4e00\u9053\u5de5\u5e8f\uff1b\u6ce8\u610f\u8fd9\u4e2a\u987a\u5e8f\u5373\u4e3a\u9700\u8981\u6c42\u89e3\u7684\u53d8\u91cf\u3002","title":"\uff082\uff09\u6c42\u89e3\u53d8\u91cf"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#3","text":"JSProblem \u662f\u6240\u6709\u5de5\u5e8f\u5b9e\u4f53 Operation \u7684\u5c01\u88c5\uff1a \u5b83\u7684\u89e3\u4e3a\u4e00\u4e2a JSSolution \u5b9e\u4f8b \u6bcf\u5f53\u83b7\u5f97\u4e00\u4e2a\u66f4\u597d\u7684\u89e3\uff0c \u9700\u8981\u4f7f\u7528 update_solution() \u65b9\u6cd5\u663e\u5f0f\u66f4\u65b0 JSSolution \u662f\u6240\u6709\u53d8\u91cf OperationStep \u7684\u5c01\u88c5\uff1a \u5bf9\u4e8e\u6790\u53d6\u56fe\u6c42\u89e3\u6a21\u578b\uff0c\u9700\u8981\u663e\u5f0f\u5730\u8c03\u7528 evaluate() \u6765\u57fa\u4e8e\u6c42\u89e3\u7684\u987a\u5e8f\u8ba1\u7b97\u6700\u7ec8\u53d8\u91cf start_time \uff1b\u57fa\u4e8e\u6570\u5b66\u6a21\u578b\u5219\u65e0\u9700\u8fd9\u4e00\u6b65\u3002 is_feasible() \u5224\u65ad\u4e00\u4e2a\u89e3\u662f\u5426\u6ee1\u8db3\u6240\u6709\u7ea6\u675f \u5982\u679c\u662f\u4e00\u4e2a\u53ef\u884c\u89e3\uff0c makespan \u5c5e\u6027\u5f97\u5230\u6700\u5927\u52a0\u5de5\u5468\u671f\u957f\u5ea6 JSSolver \u662f\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u5668\u7684\u57fa\u7c7b\uff0c\u4fbf\u4e8e\u7ee7\u627f\u6b64\u57fa\u7c7b\u540e\u5b9e\u65bd\u65b0\u7b97\u6cd5\u3002","title":"\uff083\uff09\u6c42\u89e3\u6d41\u7a0b"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#_2","text":"\u4ee5\u4e0a\u7684\u8bbe\u8ba1\u53ef\u4ee5\u907f\u514d\u91cd\u590d\u5de5\u4f5c\uff0c\u4ece\u800c\u4e13\u6ce8\u4e8e\u7b97\u6cd5\u672c\u8eab\u7684\u5b9e\u73b0\u548c\u6d4b\u8bd5\u3002\u57fa\u4e8e\u6b64\u6846\u67b6\uff0c\u5b9e\u65bd\u65b0\u7b97\u6cd5\u7684\u53ea\u9700\u521b\u5efa\u81ea\u5b9a\u4e49\u6c42\u89e3\u5668\u7c7b\uff0c\u7136\u540e\u7ee7\u627f JSSolver \u5e76\u5b9e\u73b0 do_solver() \u65b9\u6cd5\u3002 do_solver() \u65b9\u6cd5\u5185\u90e8\u4e3b\u8981\u5206\u4e3a\u4e09\u5927\u6b65\u9aa4\uff1a \u57fa\u4e8e\u95ee\u9898\u521b\u5efa\u521d\u59cb\u72b6\u6001\u7684\u89e3\uff08\u6ce8\u610f\u5e76\u975e\u53ef\u884c\u7684 \u521d\u59cb\u89e3 \uff09 solution = JSSolution(problem) \u5b9e\u65bd\u7b97\u6cd5\uff0c\u8ba1\u7b97\u6216\u8005\u4f18\u5316\u8fd9\u4e2a\u89e3 \u5bf9\u4e8e\u4ee5 start_time \u4e3a\u53d8\u91cf\u63cf\u8ff0\u7684\u6570\u5b66\u6a21\u578b\uff0c\u76f4\u63a5\u6c42\u89e3\u6bcf\u4e2a\u5de5\u5e8f\u7684 start_time \u5373\u53ef \u5bf9\u4e8e\u4ee5\u6790\u53d6\u56fe\u63cf\u8ff0\u7684\u6a21\u578b\uff0c\u9700\u8981\u5148\u6c42\u89e3\u5de5\u5e8f\u7684\u987a\u5e8f\uff0c\u7136\u540e\u663e\u5f0f\u5730\u8c03\u7528 solution.evaluate() \u9012\u63a8\u51fa start_time \u6bcf\u6b21\u8fed\u4ee3\u5f97\u5230\u66f4\u597d\u7684\u89e3\u540e\uff0c\u663e\u5f0f\u66f4\u65b0\u95ee\u9898\u7684\u89e3 problem.update_solution(solution) \u5173\u952e\u4ee3\u7801\u53c2\u8003\uff1a # user defined path, e.g. path/to/UserSolver.py from jsp_fwk import (JSProblem, JSSolution, JSSolver) class UserSolver(JSSolver): def do_solve(self, problem:JSProblem): '''User defined solving process.''' # (1) Initialize an empty solution from problem solution = JSSolution(problem) # (2) Solve or optimize the solution, # i.e. determine the start_time of OperationStep instances. # Note to evaluate solution explicitly if disjunctive graph model. ... # solution.evaluate() # (3) Update the solution for problem iteratively problem.update_solution(solution)","title":"\u5b9e\u65bd\u65b0\u7b97\u6cd5"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#_3","text":"\u6846\u67b6\u5df2\u7ecf\u5185\u7f6e\u4e86\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6807\u51c6\u95ee\u9898\u6570\u636e\uff0c\u4fbf\u4e8e\u6839\u636e\u540d\u79f0\u76f4\u63a5\u521d\u59cb\u5316\u95ee\u9898\u3002\u66f4\u591a\u57fa\u672c\u95ee\u9898\u6570\u636e \u53c2\u8003 \u3002","title":"\u6d4b\u8bd5\u7b97\u6cd5"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#1_1","text":"\u5355\u4e2a\u7b97\u6cd5\u6c42\u89e3\u5355\u4e2a\u95ee\u9898\u4e3b\u8981\u7528\u4e8e\u7b97\u6cd5\u8c03\u8bd5\u9636\u6bb5\uff0c solve() \u65b9\u6cd5\u4e2d\u7684\u4e24\u4e2a\u53c2\u6570\uff1a interval \u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u68c0\u6d4b\u548c\u52a8\u6001\u663e\u793a\u5f53\u524d\u89e3\u7684\u7518\u7279\u56fe\uff0c\u5982\u679c\u8bbe\u4e3a None \u5219\u4e0d\u663e\u793a\u7518\u7279\u56fe callback \u5728\u6bcf\u6b21\u83b7\u5f97\u66f4\u597d\u7684\u89e3\u540e\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u52a8\u4f5c\uff0c\u4f8b\u5982\u6253\u5370\u8fd9\u4e2a\u89e3 \u4ee5\u4e0b\u793a\u4f8b\u8c03\u7528\u4e0a\u4e00\u8282\u81ea\u5b9a\u4e49\u7684\u6c42\u89e3\u5668 UserSolver \u6c42\u89e3 ft10 \u95ee\u9898\u3002 # run.py from jsp_fwk import JSProblem from path/to/UserSolver import UserSolver # load benchmark problem problem = JSProblem(benchmark='ft10') # solve problem with user defined solver s = UserSolver() fun = lambda solution: print(f'makespan: {solution.makespan}') s.solve(problem=problem, interval=2000, callback=fun)","title":"\uff081\uff09\u5355\u4e2a\u7b97\u6cd5\u5355\u4e2a\u95ee\u9898"},{"location":"2021-08-14-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APython%E5%BB%BA%E6%A8%A1/#2_1","text":"\u5f53\u7b97\u6cd5\u8c03\u8bd5\u7a33\u5b9a\u540e\uff0c\u6211\u4eec\u9700\u8981\u6d4b\u8bd5\u5b83\u5728\u4e0d\u540c\u89c4\u6a21\u95ee\u9898\u4e0a\u7684\u8868\u73b0\uff0c\u6216\u8005\u5bf9\u6bd4\u4e0d\u540c\u7b97\u6cd5\u5bf9\u76f8\u540c\u95ee\u9898\u7684\u6c42\u89e3\u6548\u7387\u3002\u9488\u5bf9\u6b64\u7c7b\u573a\u666f\uff0c\u672c\u6846\u67b6\u5185\u7f6e\u4e86 Benchmark \u7c7b\uff1a\u6392\u5217\u7ec4\u5408\u8f93\u5165\u7684\u6c42\u89e3\u5668\u548c\u95ee\u9898\uff0c\u7136\u540e\u8fdb\u884c\u591a\u7ebf\u7a0b\u5f02\u6b65\u6c42\u89e3\uff0c\u6700\u540e\u5bf9\u6bd4\u7ed3\u679c\u3002\u663e\u7136\uff0c Benchmark \u7c7b\u4e5f\u9002\u7528\u4e8e\u5355\u4e2a\u7b97\u6cd5\u5355\u4e2a\u95ee\u9898\u7684\u573a\u666f\u3002 \u4e0b\u9762\u4f8b\u5b50\u6f14\u793a\u4e86\u4e24\u7c7b\u6c42\u89e3\u5668\uff0cGoogle OR-Tools\u6574\u6570\u89c4\u5212\u548c\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5\uff0c\u6c42\u89e3\u4e0d\u540c\u89c4\u6a21\u76845\u4e2a\u95ee\u9898\u7684\u5bf9\u6bd4\u3002 # benchmark.py import logging from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import (GoogleORCPSolver, PriorityDispatchSolver) # ---------------------------------------- # create problem from benchmark # ---------------------------------------- names = ['ft06', 'la01', 'ft10', 'swv01', 'la38'] problems = [JSProblem(benchmark=name) for name in names] # ---------------------------------------- # test built-in solver # ---------------------------------------- # googl or-tools s1 = GoogleORCPSolver(max_time=300, name='or-tools') # priority dispatching s2 = PriorityDispatchSolver(rule='t', name='pd-t-rule') solvers = [s1, s2] # ---------------------------------------- # solve and result # ---------------------------------------- benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=4) benchmark.run(show_info=True) \u7ed3\u679c\u793a\u4f8b\uff1a +---------+-----------+-------+---------+----------+---------+-------+ | Problem | Solver | Scale | Optimum | Solution | Error % | Time | +---------+-----------+-------+---------+----------+---------+-------+ | ft06 | pd-t-rule | 6x6 | 55 | 60.0 | 9.1 | 0.0 | | la01 | pd-t-rule | 10x5 | 666 | 666.0 | 0.0 | 0.0 | | ft10 | pd-t-rule | 10x10 | 930 | 1082.0 | 16.3 | 0.1 | | ft06 | or-tools | 6x6 | 55 | 55 | 0.0 | 0.1 | | swv01 | pd-t-rule | 20x10 | 1407 | 1839.0 | 30.7 | 0.2 | | la01 | or-tools | 10x5 | 666 | 666 | 0.0 | 0.4 | | la38 | pd-t-rule | 15x15 | 1196 | 1387.0 | 16.0 | 0.6 | | ft10 | or-tools | 10x10 | 930 | 930 | 0.0 | 4.2 | | la38 | or-tools | 15x15 | 1196 | 1196 | 0.0 | 141.1 | | swv01 | or-tools | 20x10 | 1407 | 1414 | 0.5 | 300.1 | +---------+-----------+-------+---------+----------+---------+-------+","title":"\uff082\uff09\u591a\u4e2a\u7b97\u6cd5\u591a\u4e2a\u95ee\u9898"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/","text":"\u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-15 | \u5206\u7c7b\uff1a python/vba/cpp \u672c\u6587\u5728\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u80cc\u666f\u4e0b\uff0c\u57fa\u4e8e matplotlib \u5e93\u5b9e\u73b0\u7518\u7279\u56fe\u5e76\u76d1\u542c\u6570\u636e\u8fdb\u884c\u52a8\u6001\u66f4\u65b0\u3002\u6587\u4e2d\u63cf\u8ff0\u7684\u57fa\u672c\u6d41\u7a0b\u4e5f\u9002\u7528\u4e8e\u5176\u4ed6\u7c7b\u578b\u56fe\u8868\u7684\u52a8\u6001\u66f4\u65b0\u3002\u6700\u7ec8\u6548\u679c\u5982\u4e0b\u3002 \u4ece\u9759\u6001\u7518\u7279\u56fe\u5f00\u59cb \u00b6 \u7518\u7279\u56fe\u53ef\u4ee5\u7528 matplotlib \u7684\u6761\u5f62\u56fe\uff08\u6c34\u5e73\u67f1\u72b6\u56fe\uff09\u6765\u6a21\u62df\uff0c\u6a2a\u8f74\u4e3a\u65f6\u95f4\uff0c\u7eb5\u8f74\u4e3a\u5de5\u5e8f/\u4efb\u52a1\u7c7b\u578b\uff1b\u6bcf\u4e00\u4e2a\u6a2a\u6761(bar)\u5bf9\u5e94\u4e00\u4e2a\u5de5\u5e8f/\u4efb\u52a1\u3002 matplotlib.pyplot.barh(y, width, height=0.8, left=None, *, align='center', **kwargs) \u5176\u4e2d\uff0c y \u5373\u4e3ay\u8f74\u5750\u6807\uff0c\u5bf9\u5e94 \u5de5\u5e8f\u7c7b\u522b \uff0c\u4f8b\u5982\u4ece\u4f5c\u4e1a\u7684\u89c6\u89d2\u5373\u4e3a\u4f5c\u4e1aID\uff0c\u4ece\u673a\u5668\u7684\u89c6\u89d2\u5373\u4e3a\u673a\u5668ID width \u4e3a\u6a2a\u6761\u5bbd\u5ea6\uff0c\u5bf9\u5e94 \u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4 height \u4e3a\u6a2a\u6761\u9ad8\u5ea6\uff0c\u6ca1\u6709\u76f4\u63a5\u610f\u4e49 left \u4e3a\u6a2a\u6761\u5de6\u8fb9\u754c\u7684x\u5750\u6807\uff0c\u5bf9\u5e94 \u5de5\u5e8f\u5f00\u59cb\u65f6\u95f4 \u901a\u5e38\uff0c\u6211\u4eec\u53ef\u4ee5\u753b\u51fa\u4e24\u7c7b\u7518\u7279\u56fe: \u9879\u76ee/\u4f5c\u4e1a\u89c6\u89d2\uff0c\u9879\u76ee\u4efb\u52a1\u6216\u8005\u4f5c\u4e1a\u5de5\u5e8f\u7684\u65f6\u95f4\u5b89\u6392 \u8d44\u6e90/\u8bbe\u5907\u89c6\u89d2\uff0c\u5206\u914d\u5230\u540c\u7c7b\u8d44\u6e90/\u8bbe\u5907\u4e0a\u7684\u4efb\u52a1/\u5de5\u5e8f\u7684\u65f6\u95f4\u5b89\u6392 \u672c\u6587\u5c06\u5176\u7ed8\u5236\u4e3a\u540c\u4e00\u5e45\u56fe\u7684\u4e24\u5f20\u5b50\u56fe\uff0c\u6548\u679c\u53ca\u4ee3\u7801\u5982\u4e0b\u3002\u5176\u4e2d\uff0c\u5de5\u5e8f\u5c5e\u6027\u7528\u4e00\u4e2a\u56db\u5143\u7ec4\u8868\u793a\uff1a \uff08\u4f5c\u4e1a\u53f7\uff0c\u673a\u5668\u53f7\uff0c\u5f00\u59cb\u65f6\u95f4\uff0c\u52a0\u5de5\u65f6\u957f\uff09 \u3002 import matplotlib.pyplot as plt # dummy data: # - job number # - machine number # - task properties: (job id, machine id, start time, duration) num_job, num_machine = 2, 3 tasks = [(0,2,0,10), (0,1,10,5), (0,0,35,20), (1,0,15,15),(1,1,40,15), (1,2,50,10)] # create two subplots: job view and machine view fig, (gnt_job, gnt_machine) = plt.subplots(2,1, sharex=True) # title fig.suptitle('Gantt Chart', fontweight='bold') # axis style for job subplot job_ids = range(num_job) gnt_job.set(ylabel='Job', \\ yticks=job_ids, \\ yticklabels=[f'Job-{i}' for i in job_ids]) gnt_job.grid(which='major', axis='x', linestyle='--') # axis style for machine subplot machine_ids = range(num_machine) gnt_machine.set(xlabel='Time', ylabel='Machine',\\ yticks=machine_ids, \\ yticklabels=[f'M-{i}' for i in machine_ids]) gnt_machine.grid(which='major', axis='x', linestyle='--') # plot each task for (jid,mid,start,duration) in tasks: gnt_job.barh(jid, duration, left=start, height=0.5) gnt_machine.barh(mid, duration, left=start, height=0.5) plt.show() \u52a8\u6001\u66f4\u65b0\u601d\u8def \u00b6 \u52a8\u6001\u66f4\u65b0\u5373\u4fee\u6539\u7ed8\u56fe\u5bf9\u8c61/\u6570\u636e\uff0c\u901a\u5e38\u6709\u4ee5\u4e0b\u4e24\u79cd\u505a\u6cd5\uff1a \u4ea4\u4e92\u7ed8\u56fe\u6a21\u5f0f\uff1a plt.ion \u548c plt.ioff \u52a8\u753b\u6a21\u5f0f\uff1a\u6309\u7167\u4e00\u5b9a\u7684\u9891\u7387\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u65b9\u6cd5\u6765\u66f4\u65b0\u6570\u636e\uff0c\u6bcf\u4e00\u6b21\u66f4\u65b0\u6570\u636e\u5bf9\u5e94 \u4e00\u5e27 \u7684\u7ed3\u679c \u672c\u6587\u91c7\u7528\u52a8\u753b\u6a21\u5f0f\uff1a matplotlib.animation.FuncAnimation(fig, func, frames=None, \\ init_func=None, fargs=None, save_count=None, *, cache_frame_data=True, **kwargs) \u5176\u4e2d\u51e0\u4e2a\u5173\u952e\u53c2\u6570\uff1a fig \u4e3a\u5f53\u524d\u753b\u5e03 func \u4e3a\u66f4\u65b0\u56fe\u5f62\u6570\u636e\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u53c2\u6570\u6784\u6210\u5982\u4e0b\uff1a def func(frame, *fargs) -> iterable_of_artists \u5176\u4e2d\uff0c frame \u4e3a\u6bcf\u4e00\u5e27\u7684\u53c2\u6570\uff0c\u7531\u4e0b\u9762\u7684 frames \u53c2\u6570\u4f20\u5165 fargs \u4e3a\u989d\u5916\u7684\u53c2\u6570\uff0c\u7531\u4e0b\u9762\u7684 fargs \u4f20\u5165 frames \u4e00\u822c\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u63a7\u5236\u6574\u4e2a\u52a8\u753b\u8fc7\u7a0b\uff0c\u6bcf\u4e00\u5e27\u4f20\u4e00\u4e2a\u5143\u7d20\u7ed9 func \u5982\u679c\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1a\u6bcf\u4e00\u5e27\u4f20\u4e00\u4e2a\u5143\u7d20 \u5982\u679c\u662f int \uff0c\u7b49\u6548\u4e3a range(frames) \u5982\u679c\u662f\u751f\u6210\u5668\uff0c\u6bcf\u4e00\u5e27\u4f20\u4e00\u4e2a\u751f\u6210\u7684\u5bf9\u8c61 \u5982\u679c\u662f None \uff0c\u6bcf\u4e00\u5e27\u4f20\u5165\u5f53\u524d\u8fd0\u884c\u6b21\u6570 init_func \u662f\u56fe\u5f62\u521d\u59cb\u5316\u51fd\u6570\uff0c\u5728\u7ed8\u5236\u7b2c\u4e00\u5e27\u524d\u8c03\u7528 def init_func() -> iterable_of_artists fargs \u4e3a\u6bcf\u4e00\u5e27\u8c03\u7528\u65f6\u4f20\u7ed9 func \u7684\u989d\u5916\u7684\u53c2\u6570 interval \u4e3a\u9891\u7387\u53c2\u6570\uff0c\u8868\u793a\u4e24\u5e27\u4e4b\u95f4\u7684\u95f4\u9694\uff0c\u9ed8\u8ba4 200ms repeat \u8868\u793a frames \u5b9a\u4e49\u7684\u5e27\u6570\u7ed3\u675f\u540e\u662f\u5426\u91cd\u590d\uff0c\u9ed8\u8ba4 False blit \u8868\u793a\u662f\u5426\u542f\u7528 blitting \u6280\u672f\u4f18\u5316\u7ed8\u56fe\uff0c\u9ed8\u8ba4 False \u66f4\u8be6\u7ec6\u4ecb\u7ecd\u53c2\u8003\uff1a https://matplotlib.org/stable/api/_as_gen/matplotlib.animation.FuncAnimation.html \u5173\u4e8e func \u7684\u8fdb\u4e00\u6b65\u7406\u89e3 \u4e00\u822c\u5728 func \u4e2d\u66f4\u65b0\u5df2\u7ecf\u521b\u5efa\u597d\u7684\u5bf9\u8c61\u7684\u6570\u636e\uff0c\u4f8b\u5982 plt.plot() \u8fd4\u56de\u7684\u66f2\u7ebf\uff1b\u4e5f\u53ef\u4ee5\u6e05\u9664\u4e4b\u524d\u7684\u6240\u6709\u5bf9\u8c61\uff0c\u518d\u7528\u65b0\u7684\u6570\u636e\u91cd\u65b0\u7ed8\u56fe\uff0c\u7279\u522b\u662f\u5bf9\u4e0d\u9002\u7528\u76f4\u63a5\u66f4\u65b0\u6570\u636e\u7684\u573a\u5408\uff0c\u4f8b\u5982\u672c\u6587\u6d89\u53ca\u7684\u6761\u5f62\u56fe\u3002 func \u7684\u8fd4\u56de\u503c\uff08\u8be5\u5e27\u6240\u6709\u7ed8\u56fe\u5bf9\u8c61\u7ec4\u6210\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff09\u4e3b\u8981\u7528\u4e8e blit=True \u65f6\u4f18\u5316\u7ed8\u56fe\u663e\u793a\uff0c\u6240\u4ee5\u5982\u679c\u8bbe\u7f6e blit=False \uff0c\u5b8c\u5168\u53ef\u4ee5\u4e0d\u7528\u8fd4\u56de\u503c\u3002 \u56de\u5230\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u80cc\u666f \u00b6 matplotlib\u7684animation\u4ee5\u56fa\u5b9a\u7684\u9891\u7387\u5237\u65b0\u6570\u636e\uff0c\u7136\u800c\uff0c\u56de\u5230\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u80cc\u666f\u4e0b\uff0c\u6211\u4eec\u65e0\u6cd5\u9884\u77e5\u5728\u54ea\u4e00\u523b\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u89e3\u3002\u4e3a\u4e86\u907f\u514d\u65e0\u610f\u4e49\u7684\u5237\u65b0\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u5f00\u5173\u53d8\u91cf\uff0c\u4e00\u65e6\u5f97\u5230\u4e86\u65b0\u89e3\u5219\u5237\u65b0\u7518\u7279\u56fe\uff0c\u5426\u5219\u5565\u4e5f\u4e0d\u505a\u3002 \u9488\u5bf9\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff0c\u6211\u4eec\u62bd\u8c61\u51fa\u4e24\u4e2a\u4e3b\u8981\u7684\u7c7b\uff1a Problem \uff1a\u6307\u5b9a\u95ee\u9898\u7684\u89c4\u6a21\uff0c\u7136\u540e\u6c42\u89e3 solve() \uff0c\u751f\u6210\u5e76\u52a8\u6001\u66f4\u65b0\u7518\u7279\u56fe __dynamic_gantt() class Problem: def __init__(self, num_job:int, num_machine:int, solution) -> None: '''Initialize problem with the count of job and machine.''' self.num_job = num_job self.num_machine = num_machine # a solution is a collection of tasks with determined start time self.__solution = solution # type: Solution # implement dynamic gantt chart by animation self.__animation = None def solve(self): '''Solve problem and update Gantt chart dynamically.''' pass def __dynamic_gantt(self, interval:int=1000): '''Create plot and define animation to update data dynamically.''' pass Solution \uff1a\u95ee\u9898\u7684\u89e3\u5373\u4e00\u7cfb\u5217\u5c5e\u6027\u5df2\u77e5\uff08\u4e3b\u8981\u662f \u5f00\u59cb\u65f6\u95f4 \uff09\u7684\u5de5\u5e8f\uff0c\u4e3b\u8981\u8d1f\u8d23\u66f4\u65b0\u89e3 update() \u548c\u7ed8\u5236\u7518\u7279\u56fe\u7684\u56fe\u5f62\u533a\u57df plot() \u3002 class Solution: Task = namedtuple('Task',['jid','mid', 'start', 'duration']) def __init__(self) -> None: self.__tasks = [] # list[Task] self.__update_plot = False def update(self, num_job:int, num_machine:int): '''Simulate a real solving process to update solution iteratively.''' pass def plot(self, axes:tuple): '''Plot Gantt chart data area.''' pass \u6c42\u89e3\u6846\u67b6 \u00b6 problem.solve() \u65b9\u6cd5\u6a21\u62df\u6c42\u89e3\u8fc7\u7a0b\uff0c\u4e3b\u7ebf\u7a0b\u7684\u7518\u7279\u56fe\u6301\u7eed\u76d1\u542c\u65b0\u89e3\uff1a\u5728\u83b7\u5f97\u65b0\u89e3\u4e4b\u524d\uff0c\u7ed8\u56fe\u72b6\u6001\u4e3a\u5173\uff0c\u4fdd\u6301\u4e0d\u52a8\uff1b\u4e00\u65e6\u5b50\u7ebf\u7a0b\u7684\u6c42\u89e3\u83b7\u5f97\u4e86\u66f4\u597d\u7684\u89e3\uff0c\u7ed8\u56fe\u9009\u9879\u88ab\u6253\u5f00\uff0c\u4ece\u800c\u66f4\u65b0\u7518\u7279\u56fe\u3002\u57fa\u672c\u6846\u67b6\u548c\u76f8\u5e94\u4ee3\u7801\u5982\u4e0b\uff1a \u5728\u5b50\u7ebf\u7a0b\u4e2d\u6c42\u89e3\uff0c\u5373\u8c03\u7528 Solution \u7684 update() \u65b9\u6cd5 \u5728\u4e3b\u7ebf\u7a0b\u4e2d\u5c55\u793a\u548c\u66f4\u65b0\u7518\u7279\u56fe problem.__dynamic_gantt() \uff0c\u5373\u901a\u8fc7\u4e0a\u4e00\u8282\u4ecb\u7ecd\u7684 animation.FuncAnimation \u5bf9\u8c61\u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u6267\u884c Solution \u7684 plot() \u65b9\u6cd5 class Problem: def solve(self): '''Solve problem and update Gantt chart dynamically.''' # solve problem in child thread thread = Thread(target=self.__solution.update, \\ args=(self.num_job, self.num_machine)) thread.start() # show gantt chart and listen to the solution update in main thread self.__dynamic_gantt(interval=1000) plt.show() \u5b9a\u4e49\u7518\u7279\u56fe\u52a8\u753b \u00b6 \u7ed8\u5236\u7518\u7279\u56fe\u7684\u4ee3\u7801\u548c\u7b2c\u4e00\u8282\u7684\u9759\u6001\u7518\u7279\u56fe\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u4ec5\u7ed9\u51fa\u5b9a\u4e49\u52a8\u753b\u7684\u90e8\u5206\uff1a \u56e0\u4e3a\u65e0\u6cd5\u9884\u77e5\u52a8\u753b\u7684\u5468\u671f\uff0c\u6240\u4ee5 frames \u53c2\u6570\u4e3a\u7a7a\uff0c\u5373\u4f20\u5165\u8c03\u7528\u6b21\u6570 i \u867d\u7136\u4ee5\u56fa\u5b9a\u9891\u7387\u5237\u65b0\u52a8\u753b\uff08\u8c03\u7528 solution.plot() \uff09\uff0c\u4f46\u5b9e\u9645\u56fe\u5f62\u5728\u83b7\u5f97\u65b0\u89e3\u4e4b\u524d\u5e76\u4e0d\u4f1a\u88ab\u65e0\u610f\u4e49\u5730\u91cd\u590d\u7ed8\u5236\uff08\u5177\u4f53\u53c2\u8003\u524d\u9762\u7684\u4ecb\u7ecd\u548c\u4e0b\u9762\u7684\u5b9e\u73b0\uff09 class Problem: def __dynamic_gantt(self, interval:int=1000): '''Create plot and define animation to update data dynamically.''' ... # animation self.__animation = FuncAnimation(fig, \\ func=lambda i: self.__solution.plot(axes=(gnt_job, gnt_machine)), \\ interval=interval, \\ repeat=False) \u66f4\u65b0\u7518\u7279\u56fe \u00b6 \u66f4\u65b0\u7518\u7279\u56fe\u7684\u4ee3\u7801\u5982\u4e0b\uff1a self.__update_plot \u63a7\u5236\u4e86\u662f\u5426\u771f\u6b63\u91cd\u7ed8 \u5bf9\u4e8e\u7518\u7279\u56fe\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6a2a\u6761\uff0c\u8fd9\u91cc\u91c7\u7528\u4e86\u5148\u6e05\u9664\u518d\u91cd\u7ed8\u7684\u65b9\u5f0f class Solution: def plot(self, axes:tuple): '''Plot Gantt chart data area.''' # update plot only if the solution is updated if not self.__update_plot: return else: self.__update_plot = False # clear plotted bars for axis in axes: bars = [bar for bar in axis.containers if isinstance(bar, BarContainer)] for bar in bars: bar.remove() # plot new bars gnt_job, gnt_machine = axes for task in self.__tasks: gnt_job.barh(task.jid, task.duration, left=task.start, height=0.5) gnt_machine.barh(task.mid, task.duration, left=task.start, height=0.5) # reset x-limit for axis in axes: axis.relim() axis.autoscale() \u6700\u540e\uff0c\u5b8c\u6574\u4ee3\u7801\u53c2\u8003\uff1a https://github.com/dothinking/dothinking.github.io/tree/master/samples/gantt","title":"\u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#matplotlib","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-15 | \u5206\u7c7b\uff1a python/vba/cpp \u672c\u6587\u5728\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u80cc\u666f\u4e0b\uff0c\u57fa\u4e8e matplotlib \u5e93\u5b9e\u73b0\u7518\u7279\u56fe\u5e76\u76d1\u542c\u6570\u636e\u8fdb\u884c\u52a8\u6001\u66f4\u65b0\u3002\u6587\u4e2d\u63cf\u8ff0\u7684\u57fa\u672c\u6d41\u7a0b\u4e5f\u9002\u7528\u4e8e\u5176\u4ed6\u7c7b\u578b\u56fe\u8868\u7684\u52a8\u6001\u66f4\u65b0\u3002\u6700\u7ec8\u6548\u679c\u5982\u4e0b\u3002","title":"\u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#_1","text":"\u7518\u7279\u56fe\u53ef\u4ee5\u7528 matplotlib \u7684\u6761\u5f62\u56fe\uff08\u6c34\u5e73\u67f1\u72b6\u56fe\uff09\u6765\u6a21\u62df\uff0c\u6a2a\u8f74\u4e3a\u65f6\u95f4\uff0c\u7eb5\u8f74\u4e3a\u5de5\u5e8f/\u4efb\u52a1\u7c7b\u578b\uff1b\u6bcf\u4e00\u4e2a\u6a2a\u6761(bar)\u5bf9\u5e94\u4e00\u4e2a\u5de5\u5e8f/\u4efb\u52a1\u3002 matplotlib.pyplot.barh(y, width, height=0.8, left=None, *, align='center', **kwargs) \u5176\u4e2d\uff0c y \u5373\u4e3ay\u8f74\u5750\u6807\uff0c\u5bf9\u5e94 \u5de5\u5e8f\u7c7b\u522b \uff0c\u4f8b\u5982\u4ece\u4f5c\u4e1a\u7684\u89c6\u89d2\u5373\u4e3a\u4f5c\u4e1aID\uff0c\u4ece\u673a\u5668\u7684\u89c6\u89d2\u5373\u4e3a\u673a\u5668ID width \u4e3a\u6a2a\u6761\u5bbd\u5ea6\uff0c\u5bf9\u5e94 \u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4 height \u4e3a\u6a2a\u6761\u9ad8\u5ea6\uff0c\u6ca1\u6709\u76f4\u63a5\u610f\u4e49 left \u4e3a\u6a2a\u6761\u5de6\u8fb9\u754c\u7684x\u5750\u6807\uff0c\u5bf9\u5e94 \u5de5\u5e8f\u5f00\u59cb\u65f6\u95f4 \u901a\u5e38\uff0c\u6211\u4eec\u53ef\u4ee5\u753b\u51fa\u4e24\u7c7b\u7518\u7279\u56fe: \u9879\u76ee/\u4f5c\u4e1a\u89c6\u89d2\uff0c\u9879\u76ee\u4efb\u52a1\u6216\u8005\u4f5c\u4e1a\u5de5\u5e8f\u7684\u65f6\u95f4\u5b89\u6392 \u8d44\u6e90/\u8bbe\u5907\u89c6\u89d2\uff0c\u5206\u914d\u5230\u540c\u7c7b\u8d44\u6e90/\u8bbe\u5907\u4e0a\u7684\u4efb\u52a1/\u5de5\u5e8f\u7684\u65f6\u95f4\u5b89\u6392 \u672c\u6587\u5c06\u5176\u7ed8\u5236\u4e3a\u540c\u4e00\u5e45\u56fe\u7684\u4e24\u5f20\u5b50\u56fe\uff0c\u6548\u679c\u53ca\u4ee3\u7801\u5982\u4e0b\u3002\u5176\u4e2d\uff0c\u5de5\u5e8f\u5c5e\u6027\u7528\u4e00\u4e2a\u56db\u5143\u7ec4\u8868\u793a\uff1a \uff08\u4f5c\u4e1a\u53f7\uff0c\u673a\u5668\u53f7\uff0c\u5f00\u59cb\u65f6\u95f4\uff0c\u52a0\u5de5\u65f6\u957f\uff09 \u3002 import matplotlib.pyplot as plt # dummy data: # - job number # - machine number # - task properties: (job id, machine id, start time, duration) num_job, num_machine = 2, 3 tasks = [(0,2,0,10), (0,1,10,5), (0,0,35,20), (1,0,15,15),(1,1,40,15), (1,2,50,10)] # create two subplots: job view and machine view fig, (gnt_job, gnt_machine) = plt.subplots(2,1, sharex=True) # title fig.suptitle('Gantt Chart', fontweight='bold') # axis style for job subplot job_ids = range(num_job) gnt_job.set(ylabel='Job', \\ yticks=job_ids, \\ yticklabels=[f'Job-{i}' for i in job_ids]) gnt_job.grid(which='major', axis='x', linestyle='--') # axis style for machine subplot machine_ids = range(num_machine) gnt_machine.set(xlabel='Time', ylabel='Machine',\\ yticks=machine_ids, \\ yticklabels=[f'M-{i}' for i in machine_ids]) gnt_machine.grid(which='major', axis='x', linestyle='--') # plot each task for (jid,mid,start,duration) in tasks: gnt_job.barh(jid, duration, left=start, height=0.5) gnt_machine.barh(mid, duration, left=start, height=0.5) plt.show()","title":"\u4ece\u9759\u6001\u7518\u7279\u56fe\u5f00\u59cb"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#_2","text":"\u52a8\u6001\u66f4\u65b0\u5373\u4fee\u6539\u7ed8\u56fe\u5bf9\u8c61/\u6570\u636e\uff0c\u901a\u5e38\u6709\u4ee5\u4e0b\u4e24\u79cd\u505a\u6cd5\uff1a \u4ea4\u4e92\u7ed8\u56fe\u6a21\u5f0f\uff1a plt.ion \u548c plt.ioff \u52a8\u753b\u6a21\u5f0f\uff1a\u6309\u7167\u4e00\u5b9a\u7684\u9891\u7387\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u65b9\u6cd5\u6765\u66f4\u65b0\u6570\u636e\uff0c\u6bcf\u4e00\u6b21\u66f4\u65b0\u6570\u636e\u5bf9\u5e94 \u4e00\u5e27 \u7684\u7ed3\u679c \u672c\u6587\u91c7\u7528\u52a8\u753b\u6a21\u5f0f\uff1a matplotlib.animation.FuncAnimation(fig, func, frames=None, \\ init_func=None, fargs=None, save_count=None, *, cache_frame_data=True, **kwargs) \u5176\u4e2d\u51e0\u4e2a\u5173\u952e\u53c2\u6570\uff1a fig \u4e3a\u5f53\u524d\u753b\u5e03 func \u4e3a\u66f4\u65b0\u56fe\u5f62\u6570\u636e\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u53c2\u6570\u6784\u6210\u5982\u4e0b\uff1a def func(frame, *fargs) -> iterable_of_artists \u5176\u4e2d\uff0c frame \u4e3a\u6bcf\u4e00\u5e27\u7684\u53c2\u6570\uff0c\u7531\u4e0b\u9762\u7684 frames \u53c2\u6570\u4f20\u5165 fargs \u4e3a\u989d\u5916\u7684\u53c2\u6570\uff0c\u7531\u4e0b\u9762\u7684 fargs \u4f20\u5165 frames \u4e00\u822c\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u63a7\u5236\u6574\u4e2a\u52a8\u753b\u8fc7\u7a0b\uff0c\u6bcf\u4e00\u5e27\u4f20\u4e00\u4e2a\u5143\u7d20\u7ed9 func \u5982\u679c\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1a\u6bcf\u4e00\u5e27\u4f20\u4e00\u4e2a\u5143\u7d20 \u5982\u679c\u662f int \uff0c\u7b49\u6548\u4e3a range(frames) \u5982\u679c\u662f\u751f\u6210\u5668\uff0c\u6bcf\u4e00\u5e27\u4f20\u4e00\u4e2a\u751f\u6210\u7684\u5bf9\u8c61 \u5982\u679c\u662f None \uff0c\u6bcf\u4e00\u5e27\u4f20\u5165\u5f53\u524d\u8fd0\u884c\u6b21\u6570 init_func \u662f\u56fe\u5f62\u521d\u59cb\u5316\u51fd\u6570\uff0c\u5728\u7ed8\u5236\u7b2c\u4e00\u5e27\u524d\u8c03\u7528 def init_func() -> iterable_of_artists fargs \u4e3a\u6bcf\u4e00\u5e27\u8c03\u7528\u65f6\u4f20\u7ed9 func \u7684\u989d\u5916\u7684\u53c2\u6570 interval \u4e3a\u9891\u7387\u53c2\u6570\uff0c\u8868\u793a\u4e24\u5e27\u4e4b\u95f4\u7684\u95f4\u9694\uff0c\u9ed8\u8ba4 200ms repeat \u8868\u793a frames \u5b9a\u4e49\u7684\u5e27\u6570\u7ed3\u675f\u540e\u662f\u5426\u91cd\u590d\uff0c\u9ed8\u8ba4 False blit \u8868\u793a\u662f\u5426\u542f\u7528 blitting \u6280\u672f\u4f18\u5316\u7ed8\u56fe\uff0c\u9ed8\u8ba4 False \u66f4\u8be6\u7ec6\u4ecb\u7ecd\u53c2\u8003\uff1a https://matplotlib.org/stable/api/_as_gen/matplotlib.animation.FuncAnimation.html \u5173\u4e8e func \u7684\u8fdb\u4e00\u6b65\u7406\u89e3 \u4e00\u822c\u5728 func \u4e2d\u66f4\u65b0\u5df2\u7ecf\u521b\u5efa\u597d\u7684\u5bf9\u8c61\u7684\u6570\u636e\uff0c\u4f8b\u5982 plt.plot() \u8fd4\u56de\u7684\u66f2\u7ebf\uff1b\u4e5f\u53ef\u4ee5\u6e05\u9664\u4e4b\u524d\u7684\u6240\u6709\u5bf9\u8c61\uff0c\u518d\u7528\u65b0\u7684\u6570\u636e\u91cd\u65b0\u7ed8\u56fe\uff0c\u7279\u522b\u662f\u5bf9\u4e0d\u9002\u7528\u76f4\u63a5\u66f4\u65b0\u6570\u636e\u7684\u573a\u5408\uff0c\u4f8b\u5982\u672c\u6587\u6d89\u53ca\u7684\u6761\u5f62\u56fe\u3002 func \u7684\u8fd4\u56de\u503c\uff08\u8be5\u5e27\u6240\u6709\u7ed8\u56fe\u5bf9\u8c61\u7ec4\u6210\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff09\u4e3b\u8981\u7528\u4e8e blit=True \u65f6\u4f18\u5316\u7ed8\u56fe\u663e\u793a\uff0c\u6240\u4ee5\u5982\u679c\u8bbe\u7f6e blit=False \uff0c\u5b8c\u5168\u53ef\u4ee5\u4e0d\u7528\u8fd4\u56de\u503c\u3002","title":"\u52a8\u6001\u66f4\u65b0\u601d\u8def"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#_3","text":"matplotlib\u7684animation\u4ee5\u56fa\u5b9a\u7684\u9891\u7387\u5237\u65b0\u6570\u636e\uff0c\u7136\u800c\uff0c\u56de\u5230\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u80cc\u666f\u4e0b\uff0c\u6211\u4eec\u65e0\u6cd5\u9884\u77e5\u5728\u54ea\u4e00\u523b\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u89e3\u3002\u4e3a\u4e86\u907f\u514d\u65e0\u610f\u4e49\u7684\u5237\u65b0\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u5f00\u5173\u53d8\u91cf\uff0c\u4e00\u65e6\u5f97\u5230\u4e86\u65b0\u89e3\u5219\u5237\u65b0\u7518\u7279\u56fe\uff0c\u5426\u5219\u5565\u4e5f\u4e0d\u505a\u3002 \u9488\u5bf9\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff0c\u6211\u4eec\u62bd\u8c61\u51fa\u4e24\u4e2a\u4e3b\u8981\u7684\u7c7b\uff1a Problem \uff1a\u6307\u5b9a\u95ee\u9898\u7684\u89c4\u6a21\uff0c\u7136\u540e\u6c42\u89e3 solve() \uff0c\u751f\u6210\u5e76\u52a8\u6001\u66f4\u65b0\u7518\u7279\u56fe __dynamic_gantt() class Problem: def __init__(self, num_job:int, num_machine:int, solution) -> None: '''Initialize problem with the count of job and machine.''' self.num_job = num_job self.num_machine = num_machine # a solution is a collection of tasks with determined start time self.__solution = solution # type: Solution # implement dynamic gantt chart by animation self.__animation = None def solve(self): '''Solve problem and update Gantt chart dynamically.''' pass def __dynamic_gantt(self, interval:int=1000): '''Create plot and define animation to update data dynamically.''' pass Solution \uff1a\u95ee\u9898\u7684\u89e3\u5373\u4e00\u7cfb\u5217\u5c5e\u6027\u5df2\u77e5\uff08\u4e3b\u8981\u662f \u5f00\u59cb\u65f6\u95f4 \uff09\u7684\u5de5\u5e8f\uff0c\u4e3b\u8981\u8d1f\u8d23\u66f4\u65b0\u89e3 update() \u548c\u7ed8\u5236\u7518\u7279\u56fe\u7684\u56fe\u5f62\u533a\u57df plot() \u3002 class Solution: Task = namedtuple('Task',['jid','mid', 'start', 'duration']) def __init__(self) -> None: self.__tasks = [] # list[Task] self.__update_plot = False def update(self, num_job:int, num_machine:int): '''Simulate a real solving process to update solution iteratively.''' pass def plot(self, axes:tuple): '''Plot Gantt chart data area.''' pass","title":"\u56de\u5230\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u80cc\u666f"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#_4","text":"problem.solve() \u65b9\u6cd5\u6a21\u62df\u6c42\u89e3\u8fc7\u7a0b\uff0c\u4e3b\u7ebf\u7a0b\u7684\u7518\u7279\u56fe\u6301\u7eed\u76d1\u542c\u65b0\u89e3\uff1a\u5728\u83b7\u5f97\u65b0\u89e3\u4e4b\u524d\uff0c\u7ed8\u56fe\u72b6\u6001\u4e3a\u5173\uff0c\u4fdd\u6301\u4e0d\u52a8\uff1b\u4e00\u65e6\u5b50\u7ebf\u7a0b\u7684\u6c42\u89e3\u83b7\u5f97\u4e86\u66f4\u597d\u7684\u89e3\uff0c\u7ed8\u56fe\u9009\u9879\u88ab\u6253\u5f00\uff0c\u4ece\u800c\u66f4\u65b0\u7518\u7279\u56fe\u3002\u57fa\u672c\u6846\u67b6\u548c\u76f8\u5e94\u4ee3\u7801\u5982\u4e0b\uff1a \u5728\u5b50\u7ebf\u7a0b\u4e2d\u6c42\u89e3\uff0c\u5373\u8c03\u7528 Solution \u7684 update() \u65b9\u6cd5 \u5728\u4e3b\u7ebf\u7a0b\u4e2d\u5c55\u793a\u548c\u66f4\u65b0\u7518\u7279\u56fe problem.__dynamic_gantt() \uff0c\u5373\u901a\u8fc7\u4e0a\u4e00\u8282\u4ecb\u7ecd\u7684 animation.FuncAnimation \u5bf9\u8c61\u4ee5\u4e00\u5b9a\u7684\u9891\u7387\u6267\u884c Solution \u7684 plot() \u65b9\u6cd5 class Problem: def solve(self): '''Solve problem and update Gantt chart dynamically.''' # solve problem in child thread thread = Thread(target=self.__solution.update, \\ args=(self.num_job, self.num_machine)) thread.start() # show gantt chart and listen to the solution update in main thread self.__dynamic_gantt(interval=1000) plt.show()","title":"\u6c42\u89e3\u6846\u67b6"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#_5","text":"\u7ed8\u5236\u7518\u7279\u56fe\u7684\u4ee3\u7801\u548c\u7b2c\u4e00\u8282\u7684\u9759\u6001\u7518\u7279\u56fe\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u4ec5\u7ed9\u51fa\u5b9a\u4e49\u52a8\u753b\u7684\u90e8\u5206\uff1a \u56e0\u4e3a\u65e0\u6cd5\u9884\u77e5\u52a8\u753b\u7684\u5468\u671f\uff0c\u6240\u4ee5 frames \u53c2\u6570\u4e3a\u7a7a\uff0c\u5373\u4f20\u5165\u8c03\u7528\u6b21\u6570 i \u867d\u7136\u4ee5\u56fa\u5b9a\u9891\u7387\u5237\u65b0\u52a8\u753b\uff08\u8c03\u7528 solution.plot() \uff09\uff0c\u4f46\u5b9e\u9645\u56fe\u5f62\u5728\u83b7\u5f97\u65b0\u89e3\u4e4b\u524d\u5e76\u4e0d\u4f1a\u88ab\u65e0\u610f\u4e49\u5730\u91cd\u590d\u7ed8\u5236\uff08\u5177\u4f53\u53c2\u8003\u524d\u9762\u7684\u4ecb\u7ecd\u548c\u4e0b\u9762\u7684\u5b9e\u73b0\uff09 class Problem: def __dynamic_gantt(self, interval:int=1000): '''Create plot and define animation to update data dynamically.''' ... # animation self.__animation = FuncAnimation(fig, \\ func=lambda i: self.__solution.plot(axes=(gnt_job, gnt_machine)), \\ interval=interval, \\ repeat=False)","title":"\u5b9a\u4e49\u7518\u7279\u56fe\u52a8\u753b"},{"location":"2021-08-15-%E5%9F%BA%E4%BA%8Ematplotlib%E7%9A%84%E5%8A%A8%E6%80%81%E7%94%98%E7%89%B9%E5%9B%BE/#_6","text":"\u66f4\u65b0\u7518\u7279\u56fe\u7684\u4ee3\u7801\u5982\u4e0b\uff1a self.__update_plot \u63a7\u5236\u4e86\u662f\u5426\u771f\u6b63\u91cd\u7ed8 \u5bf9\u4e8e\u7518\u7279\u56fe\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6a2a\u6761\uff0c\u8fd9\u91cc\u91c7\u7528\u4e86\u5148\u6e05\u9664\u518d\u91cd\u7ed8\u7684\u65b9\u5f0f class Solution: def plot(self, axes:tuple): '''Plot Gantt chart data area.''' # update plot only if the solution is updated if not self.__update_plot: return else: self.__update_plot = False # clear plotted bars for axis in axes: bars = [bar for bar in axis.containers if isinstance(bar, BarContainer)] for bar in bars: bar.remove() # plot new bars gnt_job, gnt_machine = axes for task in self.__tasks: gnt_job.barh(task.jid, task.duration, left=task.start, height=0.5) gnt_machine.barh(task.mid, task.duration, left=task.start, height=0.5) # reset x-limit for axis in axes: axis.relim() axis.autoscale() \u6700\u540e\uff0c\u5b8c\u6574\u4ee3\u7801\u53c2\u8003\uff1a https://github.com/dothinking/dothinking.github.io/tree/master/samples/gantt","title":"\u66f4\u65b0\u7518\u7279\u56fe"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-22 | \u5206\u7c7b\uff1a optimization , mathematics \u672c\u6587\u6839\u636e\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6570\u5b66\u63cf\u8ff0\uff0c\u5229\u7528 Google \u7684\u6574\u6570\u89c4\u5212\u6c42\u89e3\u5668 OR-Tools \u8fdb\u884c\u6c42\u89e3\uff0c\u4f5c\u4e3a jsp_framework \u5185\u7f6e\u7684\u7b2c\u4e00\u4e2a\u6c42\u89e3\u5668\u3002 OR-Tools \u00b6 OR-Tools \u662f Google \u57fa\u4e8e C++ \u5f00\u53d1\u7684\u9488\u5bf9\u7ec4\u5408\u4f18\u5316\u95ee\u9898\u7684\u6c42\u89e3\u5e93\uff0c\u540c\u65f6\u652f\u6301 Python\uff0cC#\uff0c\u6216 Java \u8bed\u8a00\u7684\u8c03\u7528\u3002 https://developers.google.cn/optimization/ \u4f5c\u4e3aPython\u5e93\uff0c\u652f\u6301 pip \u4e00\u952e\u5b89\u88c5\u3002 pip install ortools \u6570\u5b66\u6a21\u578b \u00b6 \u524d\u6587 \u7ed9\u51fa\u4e86\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e24\u79cd\u5178\u578b\u63cf\u8ff0\uff0c\u5176\u4e2d\u6570\u5b66\u6a21\u578b\u63cf\u8ff0\u4e3a\uff1a \\begin{align*} &\\min\\,\\, c_{m} = \\max \\left \\{ c_{ij} \\, | \\, (i,j) \\in \\mathbb{O} \\right \\} \\\\ \\\\ &s.t.\\quad \\begin{cases} c_{ij} \\geq p_{ij} & (i,j) \\in \\mathbb{O} \\\\ \\\\ c_{ij}-c_{kj} \\geq p_{ij} & if \\,\\, (k,j) \\rightarrow (i,j), \\,\\, i, k \\in \\mathbb{M}^j \\\\ \\\\ c_{ij} - c_{ik} \\geq p_{ij} \\,\\, or \\,\\, c_{ik}-c_{ij} \\geq p_{ik} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5177\u4f53\u53d8\u91cf\u8bf4\u660e\u53c2\u8003\u539f\u6587\uff0c\u5176\u4e2d\u4e24\u4e2a\u57fa\u672c\u53d8\u91cf\uff1a c_{ij} c_{ij} \u8868\u793a\u5de5\u5e8f (i,j) (i,j) \u5373\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u7684\u5b8c\u6210\u65f6\u95f4 p_{ij} p_{ij} \u8868\u793a\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u6240\u9700\u7684\u52a0\u5de5\u65f6\u95f4 \u4e09\u4e2a\u7ea6\u675f\u4e2d\uff1a \u7b2c\u4e00\u4e2a\u8868\u660e\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4\u975e\u8d1f \u7b2c\u4e8c\u4e2a\u662f\u5de5\u5e8f\u5e8f\u5217\u7ea6\u675f\uff0c\u5373\u540c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u76f8\u90bb\u5de5\u5e8f\u5fc5\u987b\u6ee1\u8db3\u5148\u540e\u987a\u5e8f \u7b2c\u4e09\u4e2a\u662f\u8d44\u6e90\u7ea6\u675f\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f OR-Tools \u6a21\u578b \u00b6 \u4f7f\u7528 OR-Tools \u7684\u6b65\u9aa4\u4e3a\uff1a\u7528\u5185\u7f6e\u8bed\u8a00\u5efa\u7acb\u6a21\u578b\u4f8b\u5982\u5b9a\u4e49\u53d8\u91cf\u3001\u7ea6\u675f\u53ca\u76ee\u6807\u51fd\u6570\uff0c\u7136\u540e\u4f7f\u7528\u5185\u7f6e\u6216\u8005\u7b2c\u4e09\u65b9\u6c42\u89e3\u5668\u6c42\u89e3\u3002 \u6ce8\u610f OR-Tools \u4f7f\u7528 CP-SAT \u7ea6\u675f\u6c42\u89e3\u5668\u6c42\u89e3\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u3002 CP-SAT \u6c42\u89e3\u5668\u4ec5\u652f\u6301\u6574\u6570\u53d8\u91cf\u3002 \u4e0a\u4e00\u8282\u6570\u5b66\u6a21\u578b\u4e2d\u5c06\u5de5\u5e8f\u5b8c\u5de5\u65f6\u523b\u4f5c\u4e3a\u6c42\u89e3\u53d8\u91cf\uff0c\u4e3a\u4e86\u5efa\u6a21\u65b9\u4fbf\uff0c\u8fd9\u91cc\u4e3a\u6bcf\u4e2a\u5de5\u5e8f\u521b\u5efa\u4e24\u4e2a\u53d8\u91cf s_{ij} s_{ij} \u548c c_{ij} c_{ij} \uff0c\u5206\u522b\u8868\u793a\u5f00\u59cb\u65f6\u523b\u548c\u7ed3\u675f\u65f6\u523b\u3002 OR-Tools \u5185\u7f6e\u4e86 NewIntVar \u6574\u6570\u53d8\u91cf\uff0c\u6839\u636e\u51fd\u6570\u7b7e\u540d\u53ef\u77e5\uff0c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u53d8\u91cf\u540d\u53ca\u53d8\u91cf\u8303\u56f4 [lb, ub] [lb, ub] \u3002 def NewIntVar(self, lb, ub, name): pass \u57fa\u4e8e\u8fd9\u4e9b\u53d8\u91cf\uff0c \u7528 AddMaxEquality \u53d6 c_{ij} c_{ij} \u7684\u6700\u5927\u503c\u7136\u540e\u6700\u5c0f\u5316\u5f97\u5230\u76ee\u6807\u51fd\u6570 \u5b9a\u4e49\u53d8\u91cf\u4e0b\u9650 lb \\geq 0 lb \\geq 0 \u5373\u53ef\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u975e\u8d1f\u7684\u7ea6\u675f\u6761\u4ef6 \u7b2c\u4e8c\u4e2a\u7ea6\u675f\u6761\u4ef6\u57fa\u4e8e\u524d\u540e\u5de5\u5e8f\u7684 s_{ij} s_{ij} \u548c c_{ij} c_{ij} \u5b9e\u73b0 \u4e3a\u4e86\u5b9e\u65bd\u7b2c\u4e09\u4e2a\u7ea6\u675f\u6761\u4ef6\uff0c\u5373\u540c\u4e00\u673a\u5668\u4e0a\u7684\u4efb\u610f\u4e24\u4e2a\u5de5\u5e8f\u4e0d\u91cd\u53e0\uff0c\u9700\u8981\u7528\u5230 OR-Tools \u7684 \u533a\u95f4\u53d8\u91cf NewIntervalVar \u3002\u9488\u5bf9\u4e0d\u53ef\u91cd\u53e0\u7684\u6240\u6709\u5de5\u5e8f/\u533a\u95f4\uff0c\u76f4\u63a5\u65bd\u52a0\u5185\u7f6e\u7684 NoOverlap \u7ea6\u675f\u3002 def NewIntervalVar(self, start, size, end, name): pass \u5176\u4e2d\uff0c start \u3001 end \u53ca size \u5206\u522b\u8868\u793a\u533a\u95f4\u7684\u5f00\u59cb\u3001\u7ed3\u675f\u4f4d\u7f6e\u53ca\u533a\u95f4\u7684\u5927\u5c0f\uff0c\u5e76\u4e14\u59cb\u7ec8\u6ee1\u8db3 start + size = end start + size = end \u3002\u5bf9\u4e8e\u672c\u95ee\u9898\uff0c start \u3001 end \u4e3a\u4e0a\u4e00\u6b65\u7684 s_{ij} s_{ij} \u548c c_{ij} c_{ij} \uff0c size \u4e3a\u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4\u5e38\u91cf\u3002 \u57fa\u4e8e jsp_framework \u5b9e\u73b0 \u00b6 OR-Tools \u7684\u5b98\u65b9\u6587\u6863\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6c42\u89e3\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684 \u5b8c\u6574\u6848\u4f8b \uff0c\u672c\u6587\u5c06\u57fa\u4e8e\u672c\u7cfb\u5217\u7684 jsp_framework \u5b9e\u73b0\u3002 \u57fa\u672c\u6d41\u7a0b\uff08\u53c2\u8003 Python\u5efa\u6a21 \u90e8\u5206\uff09\uff1a \u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ee7\u627f\u81ea JSSolver \u7684 GoogleORCPSolver \u7c7b\uff0c\u7136\u540e\u91cd\u70b9\u5b9e\u73b0 do_solve() \u65b9\u6cd5\u3002 \u5b8c\u6574\u4ee3\u7801\u53c2\u8003\uff1a https://github.com/dothinking/jsp_framework/blob/dev/jsp_fwk/solver/ortools.py \u5176\u4e2d\uff0c \u4e3a\u4e86\u907f\u514d\u6c42\u89e3\u89c4\u6a21\u592a\u5927\u800c\u5931\u53bb\u54cd\u5e94\uff0c\u4eba\u4e3a\u8bbe\u5b9a\u8fd0\u884c\u65f6\u95f4\u7684\u4e0a\u9650\uff1a solver.parameters.max_time_in_seconds = 300.0 \u4e3a\u4e86\u5b9e\u65f6\u8f93\u51fa\u5f53\u524d\u6700\u4f18\u89e3\uff0c\u5b9a\u4e49\u5982\u4e0b\u6267\u884c\u56de\u8c03\u51fd\u6570\u7684\u7c7b\uff1a class VarArraySolutionPrinter(cp_model.CpSolverSolutionCallback): '''Output intermediate solutions.''' def __init__(self, variables:dict, problem:JSProblem, solution:JSSolution): '''Initialize with variable map: operation step -> OR-Tools variable.''' cp_model.CpSolverSolutionCallback.__init__(self) self.__variables = variables self.__problem = problem self.__solution = solution def on_solution_callback(self): '''Pass data back to domain class.''' # assign OR-Tools solution back to JSPSolution for op, var in self.__variables.items(): op.update_start_time(self.Value(var.start)) # update solution self.__problem.update_solution(self.__solution) \u76f8\u5e94\u5730\uff0c\u5c06\u666e\u901a\u7684\u6c42\u89e3\u65b9\u5f0f\uff1a status = solver.Solve(model) \u6539\u4e3a\uff1a solution_printer = VarArraySolutionPrinter(variables, problem, solution) status = solver.SolveWithSolutionCallback(model, solution_printer) \u8ba1\u7b97\u5b9e\u4f8b \u00b6 \u6700\u540e\uff0c\u6c42\u89e3\u51e0\u4e2a\u6807\u51c6\u95ee\u9898\u3002\u6c42\u89e3\u65f6\u95f4\u4e0a\u9650\u8bbe\u5b9a\u4e3a300\u79d2\u3002 # benchmark.py from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import GoogleORCPSolver # problems names = ['ft06', 'la01', 'ft10', 'swv01', 'la38', \\ 'ta31', 'swv12', 'ta42', 'ta54', 'ta70'] problems = [JSProblem(benchmark=name) for name in names] # solver solvers = [GoogleORCPSolver(max_time=300)] # solve benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=5) benchmark.run(show_info=True) \u7ed3\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a \u524d5\u884c\u53d8\u91cf\u603b\u6570300\u4ee5\u5185\uff0c OR-Tools \u57fa\u672c\u5f97\u5230\u4e86\u6700\u4f18\u89e3\u3002\u4f8b4\u867d\u7136\u6ca1\u80fd\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6c42\u5f97\u6700\u4f18\u89e3\uff0c\u4f46\u662f\u76f8\u5bf9\u8bef\u5dee0.5%\u5df2\u7ecf\u5f88\u5c0f\u3002 \u540e5\u884c\u53d8\u91cf\u603b\u6570\u5728 [450, 1000] [450, 1000] \u91cf\u7ea7\uff0c\u9664\u4e86\u4f8b9\u6709\u4e9b\u53cd\u5e38\u5916\uff0c\u5176\u4f59\u90fd\u6ca1\u80fd\u5728300\u79d2\u5185\u6c42\u5f97\u6700\u4f18\u89e3\uff0c\u5e76\u4e14\u7cbe\u5ea6\u968f\u7740\u95ee\u9898\u590d\u6742\u5ea6\uff08\u4f8b\u5982\u53d8\u91cf\u603b\u6570\u3001\u5de5\u5e8f\u6570\u7b49\uff09\u589e\u52a0\u800c\u964d\u4f4e\u3002 +----+---------+------------------+-------+--------------+----------+---------+-------+ | ID | Problem | Solver | Scale | Optimum | Solution | Error % | Time | +----+---------+------------------+-------+--------------+----------+---------+-------+ | 1 | ft06 | GoogleORCPSolver | 6x6 | 55 | 55 | 0.0 | 0.1 | | 2 | la01 | GoogleORCPSolver | 10x5 | 666 | 666 | 0.0 | 0.2 | | 3 | ft10 | GoogleORCPSolver | 10x10 | 930 | 930 | 0.0 | 3.4 | | 4 | swv01 | GoogleORCPSolver | 20x10 | 1407 | 1414 | 0.5 | 300.1 | | 5 | la38 | GoogleORCPSolver | 15x15 | 1196 | 1196 | 0.0 | 168.7 | | 6 | ta31 | GoogleORCPSolver | 30x15 | 1764 | 1814 | 2.8 | 300.2 | | 7 | swv12 | GoogleORCPSolver | 50x10 | (2972, 3003) | 3339 | 11.8 | 300.3 | | 8 | ta42 | GoogleORCPSolver | 30x20 | (1867, 1956) | 2130 | 11.4 | 303.5 | | 9 | ta54 | GoogleORCPSolver | 50x15 | 2839 | 2862 | 0.8 | 468.8 | | 10 | ta70 | GoogleORCPSolver | 50x20 | 2995 | 3283 | 9.6 | 600.3 | +----+---------+------------------+-------+--------------+----------+---------+-------+ \u95ee\u9898\u89c4\u6a21\u8f83\u5c0f\u65f6\uff0c\u80fd\u9ad8\u6548\u6c42\u51fa\u6700\u4f18\u89e3\uff1b\u4f46\u968f\u7740\u95ee\u9898\u89c4\u6a21\u7684\u589e\u5927\uff0c\u6c42\u89e3\u6548\u7387\u6025\u5267\u4e0b\u964d\u3002\u4f8b\u5982\uff0c\u4e0a\u4f8b\u4e2d\u5373\u4fbf\u5c06\u8ba1\u7b97\u65f6\u95f4\u4e0a\u9650\u589e\u52a0\u5230600\u79d2\uff0c\u540e5\u4e2a\u4f8b\u5b50\u7684\u7ed3\u679c\u4e5f\u6ca1\u6709\u663e\u8457\u6539\u5584\u3002\u8fd9\u662f\u6574\u6570\u89c4\u5212\u7b49\u7cbe\u786e\u6c42\u89e3\u65b9\u6cd5\u5e94\u7528\u4e8e\u5b9e\u9645\u5927\u89c4\u6a21\u8c03\u5ea6\u95ee\u9898\u7684\u9650\u5236\u6240\u5728\u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/#or-tools","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-22 | \u5206\u7c7b\uff1a optimization , mathematics \u672c\u6587\u6839\u636e\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6570\u5b66\u63cf\u8ff0\uff0c\u5229\u7528 Google \u7684\u6574\u6570\u89c4\u5212\u6c42\u89e3\u5668 OR-Tools \u8fdb\u884c\u6c42\u89e3\uff0c\u4f5c\u4e3a jsp_framework \u5185\u7f6e\u7684\u7b2c\u4e00\u4e2a\u6c42\u89e3\u5668\u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/#or-tools_1","text":"OR-Tools \u662f Google \u57fa\u4e8e C++ \u5f00\u53d1\u7684\u9488\u5bf9\u7ec4\u5408\u4f18\u5316\u95ee\u9898\u7684\u6c42\u89e3\u5e93\uff0c\u540c\u65f6\u652f\u6301 Python\uff0cC#\uff0c\u6216 Java \u8bed\u8a00\u7684\u8c03\u7528\u3002 https://developers.google.cn/optimization/ \u4f5c\u4e3aPython\u5e93\uff0c\u652f\u6301 pip \u4e00\u952e\u5b89\u88c5\u3002 pip install ortools","title":"OR-Tools"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/#_1","text":"\u524d\u6587 \u7ed9\u51fa\u4e86\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e24\u79cd\u5178\u578b\u63cf\u8ff0\uff0c\u5176\u4e2d\u6570\u5b66\u6a21\u578b\u63cf\u8ff0\u4e3a\uff1a \\begin{align*} &\\min\\,\\, c_{m} = \\max \\left \\{ c_{ij} \\, | \\, (i,j) \\in \\mathbb{O} \\right \\} \\\\ \\\\ &s.t.\\quad \\begin{cases} c_{ij} \\geq p_{ij} & (i,j) \\in \\mathbb{O} \\\\ \\\\ c_{ij}-c_{kj} \\geq p_{ij} & if \\,\\, (k,j) \\rightarrow (i,j), \\,\\, i, k \\in \\mathbb{M}^j \\\\ \\\\ c_{ij} - c_{ik} \\geq p_{ij} \\,\\, or \\,\\, c_{ik}-c_{ij} \\geq p_{ik} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5177\u4f53\u53d8\u91cf\u8bf4\u660e\u53c2\u8003\u539f\u6587\uff0c\u5176\u4e2d\u4e24\u4e2a\u57fa\u672c\u53d8\u91cf\uff1a c_{ij} c_{ij} \u8868\u793a\u5de5\u5e8f (i,j) (i,j) \u5373\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u7684\u5b8c\u6210\u65f6\u95f4 p_{ij} p_{ij} \u8868\u793a\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u6240\u9700\u7684\u52a0\u5de5\u65f6\u95f4 \u4e09\u4e2a\u7ea6\u675f\u4e2d\uff1a \u7b2c\u4e00\u4e2a\u8868\u660e\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4\u975e\u8d1f \u7b2c\u4e8c\u4e2a\u662f\u5de5\u5e8f\u5e8f\u5217\u7ea6\u675f\uff0c\u5373\u540c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u76f8\u90bb\u5de5\u5e8f\u5fc5\u987b\u6ee1\u8db3\u5148\u540e\u987a\u5e8f \u7b2c\u4e09\u4e2a\u662f\u8d44\u6e90\u7ea6\u675f\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f","title":"\u6570\u5b66\u6a21\u578b"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/#or-tools_2","text":"\u4f7f\u7528 OR-Tools \u7684\u6b65\u9aa4\u4e3a\uff1a\u7528\u5185\u7f6e\u8bed\u8a00\u5efa\u7acb\u6a21\u578b\u4f8b\u5982\u5b9a\u4e49\u53d8\u91cf\u3001\u7ea6\u675f\u53ca\u76ee\u6807\u51fd\u6570\uff0c\u7136\u540e\u4f7f\u7528\u5185\u7f6e\u6216\u8005\u7b2c\u4e09\u65b9\u6c42\u89e3\u5668\u6c42\u89e3\u3002 \u6ce8\u610f OR-Tools \u4f7f\u7528 CP-SAT \u7ea6\u675f\u6c42\u89e3\u5668\u6c42\u89e3\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u3002 CP-SAT \u6c42\u89e3\u5668\u4ec5\u652f\u6301\u6574\u6570\u53d8\u91cf\u3002 \u4e0a\u4e00\u8282\u6570\u5b66\u6a21\u578b\u4e2d\u5c06\u5de5\u5e8f\u5b8c\u5de5\u65f6\u523b\u4f5c\u4e3a\u6c42\u89e3\u53d8\u91cf\uff0c\u4e3a\u4e86\u5efa\u6a21\u65b9\u4fbf\uff0c\u8fd9\u91cc\u4e3a\u6bcf\u4e2a\u5de5\u5e8f\u521b\u5efa\u4e24\u4e2a\u53d8\u91cf s_{ij} s_{ij} \u548c c_{ij} c_{ij} \uff0c\u5206\u522b\u8868\u793a\u5f00\u59cb\u65f6\u523b\u548c\u7ed3\u675f\u65f6\u523b\u3002 OR-Tools \u5185\u7f6e\u4e86 NewIntVar \u6574\u6570\u53d8\u91cf\uff0c\u6839\u636e\u51fd\u6570\u7b7e\u540d\u53ef\u77e5\uff0c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u53d8\u91cf\u540d\u53ca\u53d8\u91cf\u8303\u56f4 [lb, ub] [lb, ub] \u3002 def NewIntVar(self, lb, ub, name): pass \u57fa\u4e8e\u8fd9\u4e9b\u53d8\u91cf\uff0c \u7528 AddMaxEquality \u53d6 c_{ij} c_{ij} \u7684\u6700\u5927\u503c\u7136\u540e\u6700\u5c0f\u5316\u5f97\u5230\u76ee\u6807\u51fd\u6570 \u5b9a\u4e49\u53d8\u91cf\u4e0b\u9650 lb \\geq 0 lb \\geq 0 \u5373\u53ef\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u975e\u8d1f\u7684\u7ea6\u675f\u6761\u4ef6 \u7b2c\u4e8c\u4e2a\u7ea6\u675f\u6761\u4ef6\u57fa\u4e8e\u524d\u540e\u5de5\u5e8f\u7684 s_{ij} s_{ij} \u548c c_{ij} c_{ij} \u5b9e\u73b0 \u4e3a\u4e86\u5b9e\u65bd\u7b2c\u4e09\u4e2a\u7ea6\u675f\u6761\u4ef6\uff0c\u5373\u540c\u4e00\u673a\u5668\u4e0a\u7684\u4efb\u610f\u4e24\u4e2a\u5de5\u5e8f\u4e0d\u91cd\u53e0\uff0c\u9700\u8981\u7528\u5230 OR-Tools \u7684 \u533a\u95f4\u53d8\u91cf NewIntervalVar \u3002\u9488\u5bf9\u4e0d\u53ef\u91cd\u53e0\u7684\u6240\u6709\u5de5\u5e8f/\u533a\u95f4\uff0c\u76f4\u63a5\u65bd\u52a0\u5185\u7f6e\u7684 NoOverlap \u7ea6\u675f\u3002 def NewIntervalVar(self, start, size, end, name): pass \u5176\u4e2d\uff0c start \u3001 end \u53ca size \u5206\u522b\u8868\u793a\u533a\u95f4\u7684\u5f00\u59cb\u3001\u7ed3\u675f\u4f4d\u7f6e\u53ca\u533a\u95f4\u7684\u5927\u5c0f\uff0c\u5e76\u4e14\u59cb\u7ec8\u6ee1\u8db3 start + size = end start + size = end \u3002\u5bf9\u4e8e\u672c\u95ee\u9898\uff0c start \u3001 end \u4e3a\u4e0a\u4e00\u6b65\u7684 s_{ij} s_{ij} \u548c c_{ij} c_{ij} \uff0c size \u4e3a\u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4\u5e38\u91cf\u3002","title":"OR-Tools \u6a21\u578b"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/#jsp_framework","text":"OR-Tools \u7684\u5b98\u65b9\u6587\u6863\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6c42\u89e3\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684 \u5b8c\u6574\u6848\u4f8b \uff0c\u672c\u6587\u5c06\u57fa\u4e8e\u672c\u7cfb\u5217\u7684 jsp_framework \u5b9e\u73b0\u3002 \u57fa\u672c\u6d41\u7a0b\uff08\u53c2\u8003 Python\u5efa\u6a21 \u90e8\u5206\uff09\uff1a \u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ee7\u627f\u81ea JSSolver \u7684 GoogleORCPSolver \u7c7b\uff0c\u7136\u540e\u91cd\u70b9\u5b9e\u73b0 do_solve() \u65b9\u6cd5\u3002 \u5b8c\u6574\u4ee3\u7801\u53c2\u8003\uff1a https://github.com/dothinking/jsp_framework/blob/dev/jsp_fwk/solver/ortools.py \u5176\u4e2d\uff0c \u4e3a\u4e86\u907f\u514d\u6c42\u89e3\u89c4\u6a21\u592a\u5927\u800c\u5931\u53bb\u54cd\u5e94\uff0c\u4eba\u4e3a\u8bbe\u5b9a\u8fd0\u884c\u65f6\u95f4\u7684\u4e0a\u9650\uff1a solver.parameters.max_time_in_seconds = 300.0 \u4e3a\u4e86\u5b9e\u65f6\u8f93\u51fa\u5f53\u524d\u6700\u4f18\u89e3\uff0c\u5b9a\u4e49\u5982\u4e0b\u6267\u884c\u56de\u8c03\u51fd\u6570\u7684\u7c7b\uff1a class VarArraySolutionPrinter(cp_model.CpSolverSolutionCallback): '''Output intermediate solutions.''' def __init__(self, variables:dict, problem:JSProblem, solution:JSSolution): '''Initialize with variable map: operation step -> OR-Tools variable.''' cp_model.CpSolverSolutionCallback.__init__(self) self.__variables = variables self.__problem = problem self.__solution = solution def on_solution_callback(self): '''Pass data back to domain class.''' # assign OR-Tools solution back to JSPSolution for op, var in self.__variables.items(): op.update_start_time(self.Value(var.start)) # update solution self.__problem.update_solution(self.__solution) \u76f8\u5e94\u5730\uff0c\u5c06\u666e\u901a\u7684\u6c42\u89e3\u65b9\u5f0f\uff1a status = solver.Solve(model) \u6539\u4e3a\uff1a solution_printer = VarArraySolutionPrinter(variables, problem, solution) status = solver.SolveWithSolutionCallback(model, solution_printer)","title":"\u57fa\u4e8e jsp_framework \u5b9e\u73b0"},{"location":"2021-08-22-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9AOR-Tools%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E5%99%A8/#_2","text":"\u6700\u540e\uff0c\u6c42\u89e3\u51e0\u4e2a\u6807\u51c6\u95ee\u9898\u3002\u6c42\u89e3\u65f6\u95f4\u4e0a\u9650\u8bbe\u5b9a\u4e3a300\u79d2\u3002 # benchmark.py from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import GoogleORCPSolver # problems names = ['ft06', 'la01', 'ft10', 'swv01', 'la38', \\ 'ta31', 'swv12', 'ta42', 'ta54', 'ta70'] problems = [JSProblem(benchmark=name) for name in names] # solver solvers = [GoogleORCPSolver(max_time=300)] # solve benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=5) benchmark.run(show_info=True) \u7ed3\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a \u524d5\u884c\u53d8\u91cf\u603b\u6570300\u4ee5\u5185\uff0c OR-Tools \u57fa\u672c\u5f97\u5230\u4e86\u6700\u4f18\u89e3\u3002\u4f8b4\u867d\u7136\u6ca1\u80fd\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6c42\u5f97\u6700\u4f18\u89e3\uff0c\u4f46\u662f\u76f8\u5bf9\u8bef\u5dee0.5%\u5df2\u7ecf\u5f88\u5c0f\u3002 \u540e5\u884c\u53d8\u91cf\u603b\u6570\u5728 [450, 1000] [450, 1000] \u91cf\u7ea7\uff0c\u9664\u4e86\u4f8b9\u6709\u4e9b\u53cd\u5e38\u5916\uff0c\u5176\u4f59\u90fd\u6ca1\u80fd\u5728300\u79d2\u5185\u6c42\u5f97\u6700\u4f18\u89e3\uff0c\u5e76\u4e14\u7cbe\u5ea6\u968f\u7740\u95ee\u9898\u590d\u6742\u5ea6\uff08\u4f8b\u5982\u53d8\u91cf\u603b\u6570\u3001\u5de5\u5e8f\u6570\u7b49\uff09\u589e\u52a0\u800c\u964d\u4f4e\u3002 +----+---------+------------------+-------+--------------+----------+---------+-------+ | ID | Problem | Solver | Scale | Optimum | Solution | Error % | Time | +----+---------+------------------+-------+--------------+----------+---------+-------+ | 1 | ft06 | GoogleORCPSolver | 6x6 | 55 | 55 | 0.0 | 0.1 | | 2 | la01 | GoogleORCPSolver | 10x5 | 666 | 666 | 0.0 | 0.2 | | 3 | ft10 | GoogleORCPSolver | 10x10 | 930 | 930 | 0.0 | 3.4 | | 4 | swv01 | GoogleORCPSolver | 20x10 | 1407 | 1414 | 0.5 | 300.1 | | 5 | la38 | GoogleORCPSolver | 15x15 | 1196 | 1196 | 0.0 | 168.7 | | 6 | ta31 | GoogleORCPSolver | 30x15 | 1764 | 1814 | 2.8 | 300.2 | | 7 | swv12 | GoogleORCPSolver | 50x10 | (2972, 3003) | 3339 | 11.8 | 300.3 | | 8 | ta42 | GoogleORCPSolver | 30x20 | (1867, 1956) | 2130 | 11.4 | 303.5 | | 9 | ta54 | GoogleORCPSolver | 50x15 | 2839 | 2862 | 0.8 | 468.8 | | 10 | ta70 | GoogleORCPSolver | 50x20 | 2995 | 3283 | 9.6 | 600.3 | +----+---------+------------------+-------+--------------+----------+---------+-------+ \u95ee\u9898\u89c4\u6a21\u8f83\u5c0f\u65f6\uff0c\u80fd\u9ad8\u6548\u6c42\u51fa\u6700\u4f18\u89e3\uff1b\u4f46\u968f\u7740\u95ee\u9898\u89c4\u6a21\u7684\u589e\u5927\uff0c\u6c42\u89e3\u6548\u7387\u6025\u5267\u4e0b\u964d\u3002\u4f8b\u5982\uff0c\u4e0a\u4f8b\u4e2d\u5373\u4fbf\u5c06\u8ba1\u7b97\u65f6\u95f4\u4e0a\u9650\u589e\u52a0\u5230600\u79d2\uff0c\u540e5\u4e2a\u4f8b\u5b50\u7684\u7ed3\u679c\u4e5f\u6ca1\u6709\u663e\u8457\u6539\u5584\u3002\u8fd9\u662f\u6574\u6570\u89c4\u5212\u7b49\u7cbe\u786e\u6c42\u89e3\u65b9\u6cd5\u5e94\u7528\u4e8e\u5b9e\u9645\u5927\u89c4\u6a21\u8c03\u5ea6\u95ee\u9898\u7684\u9650\u5236\u6240\u5728\u3002","title":"\u8ba1\u7b97\u5b9e\u4f8b"},{"location":"2021-08-28-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E8%A7%84%E5%88%99%E6%8C%87%E6%B4%BE%E7%AE%97%E6%B3%95/","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-28 | \u5206\u7c7b\uff1a optimization , mathematics \u4ee5\u7ebf\u6027\u89c4\u5212\u4e3a\u4ee3\u8868\u7684\u7cbe\u786e\u89e3\u6cd5\u5bf9\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6548\u7387\u968f\u7740\u95ee\u9898\u89c4\u6a21\u7684\u589e\u5927\u800c\u6025\u5267\u4e0b\u964d\uff0c\u6211\u4eec\u8fdb\u800c\u8f6c\u5411\u8fd1\u4f3c\u89e3\u6cd5\uff1b\u672c\u6587\u57fa\u4e8e jsp_framework \u5b9e\u73b0\u6548\u7387\u6700\u9ad8\u7684\u4e00\u79cd\u8fd1\u4f3c\u89e3\u6cd5\uff1a\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\uff08Priority Dispatching based on Rule\uff09\u3002\u6839\u636e\u6587\u732e\u8bb0\u8f7d\uff0c\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5\u4e3a\u73b0\u5b9e\u8c03\u5ea6\u95ee\u9898\u7684\u5b9e\u65f6\u6eda\u52a8\u6c42\u89e3\u63d0\u4f9b\u4e86\u6709\u529b\u652f\u6301\u3002 \u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 \u00b6 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u6307\u6d3e\u95ee\u9898\uff0c\u5373\u4ece\u4f5c\u4e1a\u961f\u5217\u4e2d\u4f9d\u6b21\u9009\u62e9\u4e00\u4e2a\u5de5\u5e8f\u5206\u914d\u5230\u76f8\u5e94\u7684\u673a\u5668\u4e0a\u3002\u4e3a\u4e86\u66f4\u51c6\u786e\u5730\u63cf\u8ff0\u7b97\u6cd5\u8fc7\u7a0b\uff0c\u5b9a\u4e49\uff1a \u524d\u6cbf\u5de5\u5e8f \uff1a\u4f5c\u4e1a\u5de5\u5e8f\u5e8f\u5217\u4e2d\u5373\u5c06\u88ab\u5904\u7406\u7684\u5de5\u5e8f\u3002\u4f8b\u5982\u5f00\u59cb\u4f5c\u4e1a\u524d\uff0c\u7b2c\u4e00\u9053\u5de5\u5e8f\u5373\u4e3a\u524d\u6cbf\u5de5\u5e8f\uff1b\u4f5c\u4e1a\u5b8c\u6210\u540e\uff0c\u524d\u6cbf\u5de5\u5e8f\u4e3a\u7a7a\u3002 \u524d\u6cbf\u5de5\u5e8f\u96c6 \uff1a\u6240\u6709\u4f5c\u4e1a\u7684\u524d\u6cbf\u5de5\u5e8f\u7ec4\u6210\u7684\u96c6\u5408\u3002 \u4e8e\u662f\uff0c\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\uff08Priority Dispatching based on Rule\uff09\u7b97\u6cd5\uff1a \u8ba1\u7b97\u524d\u6cbf\u5de5\u5e8f\u96c6 \\mathbb{Q} \\mathbb{Q} \u6309\u7167\u4e00\u5b9a\u89c4\u5219\u4ece \\mathbb{Q} \\mathbb{Q} \u4e2d\u9009\u62e9\u4e00\u4e2a\u5de5\u5e8f o_{i,j} o_{i,j} \uff0c\u5206\u914d\u5230\u76f8\u5e94\u673a\u5668 m_i m_i \u4e0a \u91cd\u590d\u524d\u4e24\u6b65\u76f4\u5230 \\mathbb{Q} = \\emptyset \\mathbb{Q} = \\emptyset \u6d41\u7a0b\u975e\u5e38\u7b80\u5355\uff0c\u57fa\u4e8e jsp_framework \u6846\u67b6\u5b9e\u73b0\uff1a solution.imminent_ops \u83b7\u53d6\u521d\u59cb\u524d\u6cbf\u5de5\u5e8f\u96c6 head_ops \uff0c\u521d\u59cb\u4e3a\u6bcf\u4e2a\u4f5c\u4e1a\u7684\u7b2c\u4e00\u9053\u5de5\u5e8f\uff1b\u4e3a\u4e86\u4fdd\u8bc1\u66f4\u597d\u7684\u62d3\u5c55\u6027\uff0c\u5b9e\u9645\u4e0a\u662f\u4f5c\u4e1a\u5de5\u5e8f\u5e8f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u5c1a\u672a\u5206\u914d\u5373 pre_machine_op \u4e3a\u7a7a\u7684\u5de5\u5e8f\u3002 \u6309\u7167\u89c4\u5219 self.__dispatching_rule(op, solution) \u6392\u5e8f\u524d\u6cbf\u5de5\u5e8f\u96c6 head_ops \uff0c\u5c06\u4f18\u5148\u7ea7\u6700\u9ad8\u5373\u7b2c\u4e00\u4e2a\u5de5\u5e8f\u5206\u6d3e\u5230\u76f8\u5e94\u673a\u5668\u4e0a\u53bb \u6bcf\u4e00\u6b21\u6307\u6d3e\u540e\u66f4\u65b0\u524d\u6cbf\u5de5\u5e8f\u96c6\uff1a\u79fb\u9664\u5f53\u524d\u5de5\u5e8f\uff0c\u5982\u679c\u5b58\u5728\u4e0b\u4e00\u9053\u5de5\u5e8f\u5219\u5c06\u5176\u52a0\u5165\u524d\u6cbf\u5de5\u5e8f\u96c6 class PriorityDispatchSolver(JSSolver): '''General Priority Dispatching Solver.''' def do_solve(self, problem: JSProblem): solution = JSSolution(problem=problem) self.solving_iteration(solution=solution) problem.update_solution(solution=solution) def solving_iteration(self, solution:JSSolution): '''One iteration applying priority dispatching rule.''' # collect imminent operations in the processing queue head_ops = solution.imminent_ops # dispatch operation by priority while head_ops: # sort by priority head_ops.sort(key=lambda op: self.__dispatching_rule(op, solution)) # dispatch operation with the first priority op = head_ops[0] solution.dispatch(op) # update imminent operations next_job_op = op.next_job_op if next_job_op is None: head_ops = head_ops[1:] else: head_ops[0] = next_job_op \u5176\u4e2d\uff0c\u5b9a\u4e49\u89c4\u5219\u7684\u51fd\u6570\u7b7e\u540d\u4e3a\uff1a def user_defined_rule(op:OperationStep, solution:JSSolution): pass \u4ee5\u5de5\u5e8f\u548c\u5f53\u524d\u89e3\u5b9e\u4f8b\u4e3a\u8f93\u5165 \u8fd4\u56de\u7ed3\u679c\u4e3a\u6570\u503c\u7c7b\u578b\uff0c\u6216\u8005\u6570\u503c\u7c7b\u578b\u5143\u7d20\u7684\u5143\u7ec4\uff08\u5373\u7ec4\u5408\u5f0f\u89c4\u5219\uff0c\u6309\u5143\u7ec4\u987a\u5e8f\u5b9a\u4e49\u4f18\u5148\u7ea7\uff09 \u8fd4\u56de\u6570\u503c\u8d8a\u5c0f\u8868\u660e\u4f18\u5148\u7ea7\u8d8a\u9ad8 \u5178\u578b\u89c4\u5219 \u00b6 \u63a5\u4e0b\u6765\u95ee\u9898\u7684\u5173\u952e\u5728\u4e8e\u8bbe\u8ba1\u4ec0\u4e48\u6837\u7684\u89c4\u5219\u6765\u5b9a\u4e49\u5de5\u5e8f\u7684\u4f18\u5148\u7ea7\u3002\u5b9e\u9645\u95ee\u9898\u4e2d\uff0c\u57fa\u4e8e\u4e0d\u540c\u7684\u76ee\u6807\u4f8b\u5982\u52a0\u5de5\u5468\u671f\uff08flow-time\uff09\u3001\u5ef6\u8bef\u65f6\u95f4\uff08lateness / tardiness\uff09\u3001\u5728\u5236\u54c1\u6570\u7b49\uff0c\u53ef\u80fd\u6709\u5404\u5f0f\u5404\u6837\u7684\u89c4\u5219\uff0c\u4f46\u672c\u8d28\u4e0a\u90fd\u4f9d\u8d56\u4e8e\u4f5c\u4e1a\u5de5\u5e8f\u7684\u76f8\u5173\u5c5e\u6027\u3002 \u6587\u732e 1 \u603b\u7ed3\u4e86 34 \u4e2a\u5178\u578b\u89c4\u5219\uff0c\u5e76\u6839\u636e\u4f9d\u8d56\u5c5e\u6027\u7684\u4e0d\u540c\u5206\u4e3a 4 \u7c7b\u3002\u672c\u6587\u53c2\u8003\u6587\u732e 2 \u7684\u7b80\u5316\u7248\u672c\uff0c\u4ecb\u7ecd\u57fa\u4e8e\u5982\u4e0b3\u4e2a\u9759\u6001\u5c5e\u6027\u548c3\u4e2a\u52a8\u6001\u5c5e\u6027\u5f97\u5230\u768414\u4e2a\u57fa\u672c\u89c4\u5219\u3002 \u9759\u6001\u5c5e\u6027\uff1a\u5de5\u5e8f/\u4f5c\u4e1a\u7684\u56fa\u6709\u5c5e\u6027\uff0c\u4e0d\u968f\u52a0\u5de5\u8fdb\u5ea6\u6539\u53d8 \u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4 p_{i,j} p_{i,j} \u4f5c\u4e1a\u5de5\u5e8f\u6570\u91cf |M_j| |M_j| \u4f5c\u4e1a\u52a0\u5de5\u65f6\u95f4 \\,\\Sigma_{i=1}^{m} p_{i,j} \\,\\Sigma_{i=1}^{m} p_{i,j} \uff1a\u4f5c\u4e1a\u5305\u542b\u7684\u6240\u6709\u5de5\u5e8f\u7684\u52a0\u5de5\u65f6\u95f4\u603b\u548c \u52a8\u6001\u5c5e\u6027\uff1a\u4e0e\u52a0\u5de5\u8fdb\u7a0b\u76f8\u5173\u7684\u5c5e\u6027 \u5de5\u5e8f\u751f\u6210\u65f6\u523b t_{i,j} t_{i,j} \uff1a\u5de5\u5e8f O_{i,j} O_{i,j} \u8fbe\u5230\u673a\u5668 m_i m_i \u7684\u65f6\u523b\uff0c\u5373\u4e0a\u4e00\u9053\u5de5\u5e8f\u7ed3\u675f\u7684\u65f6\u95f4 \u5de5\u5e8f\u7b49\u5f85\u65f6\u95f4 w_{i,j} w_{i,j} \uff1a\u4ece\u5de5\u5e8f\u5230\u8fbe\u673a\u5668\u5f00\u59cb\u5230\u53ef\u4ee5\u8fdb\u884c\u52a0\u5de5\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u5982\u679c\u9a6c\u4e0a\u53ef\u4ee5\u52a0\u5de5\u5219\u7b49\u5f85\u4e3a\u65f6\u95f4\u7b49\u4e8e0 \u4f5c\u4e1a\u5269\u4f59\u5de5\u4f5c\u65f6\u95f4 r_{i,j} r_{i,j} \uff1a\u5de5\u5e8f\u6240\u5728\u4f5c\u4e1a\u5c1a\u672a\u8fdb\u884c\u7684\u5de5\u5e8f\uff08\u5305\u542b\u5f53\u524d\u5de5\u5e8f\uff09\u7684\u52a0\u5de5\u65f6\u95f4\u4e4b\u548c \u5728\u8fd96\u4e2a\u5c5e\u6027\u7684\u57fa\u7840\u4e0a\uff0c\u5b9a\u4e49\u51fa\u5982\u4e0b14\u4e2a\u57fa\u672c\u89c4\u5219\u3002 No. Rules Description Type ---------------------------------------------------- 1 FIFO First In First Out Static 2 LIFO Last In First Out Static 3 SPT Shortest Processing Time Static 4 LPT Longest Processing Time Static 5 SPS Shortest Process Sequence Static 6 LPS Longest Process Sequence Static 7 STPT Shortest Total Processing Time Static 8 LTPT Longest Total Processing Time Static 9 ECT Earliest Creation Time Dynamic 10 LCT Longest Creation Time Dynamic 11 SWT Shortest Waiting Time Dynamic 12 LWT Longest Waiting Time Dynamic 13 LTWR Least Total Work Remaining Dynamic 14 MTWR Most Total Work Remaining Dynamic \u8fdb\u800c\uff0c\u7ec4\u5408\u5176\u4e2d\u7684\u591a\u4e2a\u89c4\u5219\u53ef\u4ee5\u5f97\u5230\u66f4\u591a\u7ec4\u5408\u5f0f\u89c4\u5219\u3002\u672c\u6587\u7279\u522b\u5217\u51fa\u6587\u732e 3 \u63d0\u51fa\u7684\u4e00\u4e2a\u7ec4\u5408\u5f0f\u89c4\u5219\uff0c\u59d1\u4e14\u4ee5\u4f5c\u8005\u59d3\u6c0f\u547d\u540d\u4e3a HH \u3002 z_{i,j} = \\left (t_{i,j}+w_{i,j} \\uparrow, \\,\\, r_{i,j}-1.5\\,p_{i,j} \\downarrow \\right ) z_{i,j} = \\left (t_{i,j}+w_{i,j} \\uparrow, \\,\\, r_{i,j}-1.5\\,p_{i,j} \\downarrow \\right ) \u8be5\u89c4\u5219\u8868\u660e\uff1a \u5b9e\u9645\u5f00\u59cb\u52a0\u5de5\u65f6\u95f4\u8d8a\u65e9\u4f18\u5148\u7ea7\u8d8a\u9ad8 \u4f5c\u4e1a\u5269\u4f59\u5de5\u4f5c\u65f6\u95f4\u4e0e1.5\u500d\u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4\u7684\u5dee\u503c\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8 \u8ba1\u7b97\u5b9e\u4f8b \u00b6 \u51e0\u4e4e\u6240\u6709\u7684\u6587\u732e\u90fd\u6709\u4e00\u4e2a\u5171\u8bc6\uff1a\u6ca1\u6709\u54ea\u4e00\u79cd\u5355\u4e00\u89c4\u5219\u53ef\u4ee5\u5168\u65b9\u4f4d\u4f18\u4e8e\u5176\u4ed6\u89c4\u5219\uff0c\u4f46\u6298\u8877\u6765\u770b\u8fd8\u662f\u5b58\u5728\u5177\u6709\u76f8\u5bf9\u4f18\u52bf\u7684\u67d0\u4e9b\u89c4\u5219\u3002\u4f8b\u5982\uff0c\u4e0a\u4e00\u8282\u57fa\u672c\u89c4\u5219\u4e2d\u7684 SPT \u548c MTWR \u5f97\u5230\u8f83\u591a\u6587\u732e\u7684\u5173\u6ce8\uff1a\u6587\u732e 1 \u8ba4\u4e3a SPT \u7efc\u5408\u8868\u73b0\u6700\u597d\uff0c\u6587\u732e 2 \u5219\u8ba4\u4e3a MTWR \u8868\u73b0\u66f4\u597d\u3002\u672c\u8282\u5e26\u4e0a HH \u89c4\u5219\uff0c\u5728\u6700\u5c0f\u5316\u52a0\u5de5\u5468\u671f\u7684\u76ee\u6807\u4e0b\uff0c\u770b\u770b\u6548\u679c\u7a76\u7adf\u5982\u4f55\u3002 SPT \u4f18\u5148\u52a0\u5de5\u8017\u65f6\u77ed\u7684\u5de5\u5e8f\uff0c\u5373\u7b80\u5355\u7684\u4e8b\u60c5\u5148\u505a MTWR \u4f18\u5148\u52a0\u5de5\u5269\u4f59\u6d3b\u513f\u591a\u7684\u5de5\u5e8f\uff0c\u5373\u590d\u6742\u7684\u4e8b\u60c5\u5148\u505a HH \u4f18\u5148\u52a0\u5de5\u53ef\u4ee5\u5c3d\u65e9\u5f00\u59cb\u7684\u5de5\u5e8f\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u9009\u62e9\u76f8\u5bf9\u590d\u6742\u7684\u5de5\u5e8f\uff0c\u5373\u5177\u5907\u6761\u4ef6\u4e14\u590d\u6742\u5ea6\u9ad8\u7684\u4e8b\u60c5\u5148\u505a from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import PriorityDispatchSolver # create problem from benchmark names = ['ft06', 'la01', 'ft10', 'swv01', 'la38', 'ta24', \\ 'ta31', 'swv12', 'ta24', 'ta42', 'ta54', 'ta68', 'ta69', 'ta70'] problems = [JSProblem(benchmark=name) for name in names] # priority dispatching solver solvers = [] rules = ['spt', 'mtwr', 'hh'] for rule in rules: solvers.append(PriorityDispatchSolver(rule=rule, name=rule.upper())) # solve and result benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=6) benchmark.run(show_info=True) \u65e0\u9700\u753b\u6210\u56fe\uff0c\u8868\u683c\u6570\u636e\u5c55\u793a\u7684\u7ed3\u679c\u5df2\u7ecf\u5f88\u660e\u663e\u4e14\u9707\u64bc\u3002 \u57fa\u4e8e3\u79cd\u89c4\u5219\u7684\u6c42\u89e3\u65f6\u95f4\u76f8\u5dee\u65e0\u51e0\uff0c\u4f46\u76f8\u5bf9\u7cbe\u5ea6\u5dee\u5f02\u751a\u5927 HH >> MTWR >> SPT HH \u4ee5\u6781\u9ad8\u7684\u8ba1\u7b97\u6548\u7387\uff08\u7cbe\u5ea6\u548c\u65f6\u95f4\u7684\u5e73\u8861\uff09\u5c55\u73b0\u4e86\u5176\u5b9e\u7528\u6027 +----+---------+--------+---------------+--------------+----------+---------+------+ | ID | Problem | Solver | job x machine | Optimum | Solution | Error % | Time | +----+---------+--------+---------------+--------------+----------+---------+------+ | 1 | ft06 | SPT | 6 x 6 | 55 | 109.0 | 98.2 | 0.0 | | 2 | ft06 | MTWR | 6 x 6 | 55 | 74.0 | 34.5 | 0.0 | | 3 | ft06 | HH | 6 x 6 | 55 | 60.0 | 9.1 | 0.0 | | 4 | la01 | SPT | 10 x 5 | 666 | 1462.0 | 119.5 | 0.0 | | 5 | la01 | MTWR | 10 x 5 | 666 | 880.0 | 32.1 | 0.0 | | 6 | la01 | HH | 10 x 5 | 666 | 666.0 | 0.0 | 0.0 | | 7 | ft10 | SPT | 10 x 10 | 930 | 2648.0 | 184.7 | 0.1 | | 8 | ft10 | MTWR | 10 x 10 | 930 | 1289.0 | 38.6 | 0.1 | | 9 | ft10 | HH | 10 x 10 | 930 | 1082.0 | 16.3 | 0.1 | | 10 | swv01 | SPT | 20 x 10 | 1407 | 4474.0 | 218.0 | 0.3 | | 11 | swv01 | MTWR | 20 x 10 | 1407 | 2682.0 | 90.6 | 0.4 | | 12 | swv01 | HH | 20 x 10 | 1407 | 1839.0 | 30.7 | 0.5 | | 13 | la38 | SPT | 15 x 15 | 1196 | 6560.0 | 448.5 | 0.7 | | 14 | la38 | MTWR | 15 x 15 | 1196 | 1860.0 | 55.5 | 0.7 | | 15 | la38 | HH | 15 x 15 | 1196 | 1387.0 | 16.0 | 0.8 | | 16 | ta24 | SPT | 20 x 20 | (1602, 1647) | 12103.0 | 645.0 | 1.9 | | 17 | ta24 | MTWR | 20 x 20 | (1602, 1647) | 2773.0 | 70.7 | 3.0 | | 18 | ta24 | HH | 20 x 20 | (1602, 1647) | 1842.0 | 13.4 | 3.2 | | 19 | ta31 | SPT | 30 x 15 | 1764 | 12398.0 | 602.8 | 3.5 | | 20 | ta31 | MTWR | 30 x 15 | 1764 | 3120.0 | 76.9 | 4.3 | | 21 | ta31 | HH | 30 x 15 | 1764 | 2127.0 | 20.6 | 5.1 | | 22 | swv12 | SPT | 50 x 10 | (2972, 3003) | 10315.0 | 245.3 | 6.3 | | 23 | swv12 | MTWR | 50 x 10 | (2972, 3003) | 6666.0 | 123.1 | 6.7 | | 24 | swv12 | HH | 50 x 10 | (2972, 3003) | 4337.0 | 45.2 | 8.9 | | 25 | ta24 | SPT | 20 x 20 | (1602, 1647) | 12103.0 | 645.0 | 5.7 | | 26 | ta24 | MTWR | 20 x 20 | (1602, 1647) | 2773.0 | 70.7 | 7.4 | | 27 | ta24 | HH | 20 x 20 | (1602, 1647) | 1842.0 | 13.4 | 7.5 | | 28 | ta42 | SPT | 30 x 20 | (1867, 1956) | 19301.0 | 909.7 | 11.4 | | 29 | ta42 | MTWR | 30 x 20 | (1867, 1956) | 3411.0 | 78.4 | 13.2 | | 30 | ta42 | HH | 30 x 20 | (1867, 1956) | 2307.0 | 20.7 | 13.9 | | 31 | ta54 | SPT | 50 x 15 | 2839 | 18775.0 | 561.3 | 16.0 | | 32 | ta54 | MTWR | 50 x 15 | 2839 | 4419.0 | 55.7 | 16.9 | | 33 | ta54 | HH | 50 x 15 | 2839 | 3063.0 | 7.9 | 20.4 | | 34 | ta68 | SPT | 50 x 20 | 2784 | 28490.0 | 923.3 | 25.2 | | 35 | ta68 | MTWR | 50 x 20 | 2784 | 4560.0 | 63.8 | 29.2 | | 36 | ta68 | HH | 50 x 20 | 2784 | 3023.0 | 8.6 | 35.7 | | 37 | ta69 | SPT | 50 x 20 | 3071 | 27347.0 | 790.5 | 30.3 | | 38 | ta69 | MTWR | 50 x 20 | 3071 | 4819.0 | 56.9 | 35.4 | | 39 | ta69 | HH | 50 x 20 | 3071 | 3511.0 | 14.3 | 38.4 | | 40 | ta70 | SPT | 50 x 20 | 2995 | 27728.0 | 825.8 | 38.5 | | 41 | ta70 | MTWR | 50 x 20 | 2995 | 4879.0 | 62.9 | 40.8 | | 42 | ta70 | HH | 50 x 20 | 2995 | 3438.0 | 14.8 | 41.2 | +----+---------+--------+---------------+--------------+----------+---------+------+ \u8ba1\u7b97\u7ed3\u679c\u8fd8\u662f\u5f88\u7b26\u5408\u6211\u4eec\u65e5\u5e38\u505a\u4e8b\u54f2\u5b66\u7684\uff1a \u4f18\u5148\u505a\u5df2\u7ecf\u5177\u5907\u6761\u4ef6\u7684\u4e8b\u60c5\uff08\u4e0d\u6d6a\u8d39\u8d44\u6e90\uff09\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u9009\u62e9\u590d\u6742\u5ea6\u9ad8\u7684\u4e8b\u60c5\uff08\u6293\u4e3b\u8981\u77db\u76fe\uff09 \u3002 Blackstone, John H., Don T. Phillips, and Gary L. Hogg. \"A state-of-the-art survey of dispatching rules for manufacturing job shop operations.\" The International Journal of Production Research 20.1 (1982): 27-45. \u21a9 \u21a9 Kaban, A. et al. \"Comparison of dispatching rules in job-shop scheduling problem using simulation: a case study.\" International Journal of Simulation Modelling 11 (2012): 129-140. \u21a9 \u21a9 \u9ec4\u5fd7, and \u9ec4\u6587\u5947. \"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e00\u79cd\u542f\u53d1\u5f0f\u7b97\u6cd5.\" \u8ba1\u7b97\u673a\u5de5\u7a0b\u4e0e\u5e94\u7528 26(2004):25-27. \u21a9","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5"},{"location":"2021-08-28-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E8%A7%84%E5%88%99%E6%8C%87%E6%B4%BE%E7%AE%97%E6%B3%95/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-28 | \u5206\u7c7b\uff1a optimization , mathematics \u4ee5\u7ebf\u6027\u89c4\u5212\u4e3a\u4ee3\u8868\u7684\u7cbe\u786e\u89e3\u6cd5\u5bf9\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6548\u7387\u968f\u7740\u95ee\u9898\u89c4\u6a21\u7684\u589e\u5927\u800c\u6025\u5267\u4e0b\u964d\uff0c\u6211\u4eec\u8fdb\u800c\u8f6c\u5411\u8fd1\u4f3c\u89e3\u6cd5\uff1b\u672c\u6587\u57fa\u4e8e jsp_framework \u5b9e\u73b0\u6548\u7387\u6700\u9ad8\u7684\u4e00\u79cd\u8fd1\u4f3c\u89e3\u6cd5\uff1a\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\uff08Priority Dispatching based on Rule\uff09\u3002\u6839\u636e\u6587\u732e\u8bb0\u8f7d\uff0c\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5\u4e3a\u73b0\u5b9e\u8c03\u5ea6\u95ee\u9898\u7684\u5b9e\u65f6\u6eda\u52a8\u6c42\u89e3\u63d0\u4f9b\u4e86\u6709\u529b\u652f\u6301\u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5"},{"location":"2021-08-28-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E8%A7%84%E5%88%99%E6%8C%87%E6%B4%BE%E7%AE%97%E6%B3%95/#_2","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u6307\u6d3e\u95ee\u9898\uff0c\u5373\u4ece\u4f5c\u4e1a\u961f\u5217\u4e2d\u4f9d\u6b21\u9009\u62e9\u4e00\u4e2a\u5de5\u5e8f\u5206\u914d\u5230\u76f8\u5e94\u7684\u673a\u5668\u4e0a\u3002\u4e3a\u4e86\u66f4\u51c6\u786e\u5730\u63cf\u8ff0\u7b97\u6cd5\u8fc7\u7a0b\uff0c\u5b9a\u4e49\uff1a \u524d\u6cbf\u5de5\u5e8f \uff1a\u4f5c\u4e1a\u5de5\u5e8f\u5e8f\u5217\u4e2d\u5373\u5c06\u88ab\u5904\u7406\u7684\u5de5\u5e8f\u3002\u4f8b\u5982\u5f00\u59cb\u4f5c\u4e1a\u524d\uff0c\u7b2c\u4e00\u9053\u5de5\u5e8f\u5373\u4e3a\u524d\u6cbf\u5de5\u5e8f\uff1b\u4f5c\u4e1a\u5b8c\u6210\u540e\uff0c\u524d\u6cbf\u5de5\u5e8f\u4e3a\u7a7a\u3002 \u524d\u6cbf\u5de5\u5e8f\u96c6 \uff1a\u6240\u6709\u4f5c\u4e1a\u7684\u524d\u6cbf\u5de5\u5e8f\u7ec4\u6210\u7684\u96c6\u5408\u3002 \u4e8e\u662f\uff0c\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\uff08Priority Dispatching based on Rule\uff09\u7b97\u6cd5\uff1a \u8ba1\u7b97\u524d\u6cbf\u5de5\u5e8f\u96c6 \\mathbb{Q} \\mathbb{Q} \u6309\u7167\u4e00\u5b9a\u89c4\u5219\u4ece \\mathbb{Q} \\mathbb{Q} \u4e2d\u9009\u62e9\u4e00\u4e2a\u5de5\u5e8f o_{i,j} o_{i,j} \uff0c\u5206\u914d\u5230\u76f8\u5e94\u673a\u5668 m_i m_i \u4e0a \u91cd\u590d\u524d\u4e24\u6b65\u76f4\u5230 \\mathbb{Q} = \\emptyset \\mathbb{Q} = \\emptyset \u6d41\u7a0b\u975e\u5e38\u7b80\u5355\uff0c\u57fa\u4e8e jsp_framework \u6846\u67b6\u5b9e\u73b0\uff1a solution.imminent_ops \u83b7\u53d6\u521d\u59cb\u524d\u6cbf\u5de5\u5e8f\u96c6 head_ops \uff0c\u521d\u59cb\u4e3a\u6bcf\u4e2a\u4f5c\u4e1a\u7684\u7b2c\u4e00\u9053\u5de5\u5e8f\uff1b\u4e3a\u4e86\u4fdd\u8bc1\u66f4\u597d\u7684\u62d3\u5c55\u6027\uff0c\u5b9e\u9645\u4e0a\u662f\u4f5c\u4e1a\u5de5\u5e8f\u5e8f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u5c1a\u672a\u5206\u914d\u5373 pre_machine_op \u4e3a\u7a7a\u7684\u5de5\u5e8f\u3002 \u6309\u7167\u89c4\u5219 self.__dispatching_rule(op, solution) \u6392\u5e8f\u524d\u6cbf\u5de5\u5e8f\u96c6 head_ops \uff0c\u5c06\u4f18\u5148\u7ea7\u6700\u9ad8\u5373\u7b2c\u4e00\u4e2a\u5de5\u5e8f\u5206\u6d3e\u5230\u76f8\u5e94\u673a\u5668\u4e0a\u53bb \u6bcf\u4e00\u6b21\u6307\u6d3e\u540e\u66f4\u65b0\u524d\u6cbf\u5de5\u5e8f\u96c6\uff1a\u79fb\u9664\u5f53\u524d\u5de5\u5e8f\uff0c\u5982\u679c\u5b58\u5728\u4e0b\u4e00\u9053\u5de5\u5e8f\u5219\u5c06\u5176\u52a0\u5165\u524d\u6cbf\u5de5\u5e8f\u96c6 class PriorityDispatchSolver(JSSolver): '''General Priority Dispatching Solver.''' def do_solve(self, problem: JSProblem): solution = JSSolution(problem=problem) self.solving_iteration(solution=solution) problem.update_solution(solution=solution) def solving_iteration(self, solution:JSSolution): '''One iteration applying priority dispatching rule.''' # collect imminent operations in the processing queue head_ops = solution.imminent_ops # dispatch operation by priority while head_ops: # sort by priority head_ops.sort(key=lambda op: self.__dispatching_rule(op, solution)) # dispatch operation with the first priority op = head_ops[0] solution.dispatch(op) # update imminent operations next_job_op = op.next_job_op if next_job_op is None: head_ops = head_ops[1:] else: head_ops[0] = next_job_op \u5176\u4e2d\uff0c\u5b9a\u4e49\u89c4\u5219\u7684\u51fd\u6570\u7b7e\u540d\u4e3a\uff1a def user_defined_rule(op:OperationStep, solution:JSSolution): pass \u4ee5\u5de5\u5e8f\u548c\u5f53\u524d\u89e3\u5b9e\u4f8b\u4e3a\u8f93\u5165 \u8fd4\u56de\u7ed3\u679c\u4e3a\u6570\u503c\u7c7b\u578b\uff0c\u6216\u8005\u6570\u503c\u7c7b\u578b\u5143\u7d20\u7684\u5143\u7ec4\uff08\u5373\u7ec4\u5408\u5f0f\u89c4\u5219\uff0c\u6309\u5143\u7ec4\u987a\u5e8f\u5b9a\u4e49\u4f18\u5148\u7ea7\uff09 \u8fd4\u56de\u6570\u503c\u8d8a\u5c0f\u8868\u660e\u4f18\u5148\u7ea7\u8d8a\u9ad8","title":"\u57fa\u4e8e\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5"},{"location":"2021-08-28-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E8%A7%84%E5%88%99%E6%8C%87%E6%B4%BE%E7%AE%97%E6%B3%95/#_3","text":"\u63a5\u4e0b\u6765\u95ee\u9898\u7684\u5173\u952e\u5728\u4e8e\u8bbe\u8ba1\u4ec0\u4e48\u6837\u7684\u89c4\u5219\u6765\u5b9a\u4e49\u5de5\u5e8f\u7684\u4f18\u5148\u7ea7\u3002\u5b9e\u9645\u95ee\u9898\u4e2d\uff0c\u57fa\u4e8e\u4e0d\u540c\u7684\u76ee\u6807\u4f8b\u5982\u52a0\u5de5\u5468\u671f\uff08flow-time\uff09\u3001\u5ef6\u8bef\u65f6\u95f4\uff08lateness / tardiness\uff09\u3001\u5728\u5236\u54c1\u6570\u7b49\uff0c\u53ef\u80fd\u6709\u5404\u5f0f\u5404\u6837\u7684\u89c4\u5219\uff0c\u4f46\u672c\u8d28\u4e0a\u90fd\u4f9d\u8d56\u4e8e\u4f5c\u4e1a\u5de5\u5e8f\u7684\u76f8\u5173\u5c5e\u6027\u3002 \u6587\u732e 1 \u603b\u7ed3\u4e86 34 \u4e2a\u5178\u578b\u89c4\u5219\uff0c\u5e76\u6839\u636e\u4f9d\u8d56\u5c5e\u6027\u7684\u4e0d\u540c\u5206\u4e3a 4 \u7c7b\u3002\u672c\u6587\u53c2\u8003\u6587\u732e 2 \u7684\u7b80\u5316\u7248\u672c\uff0c\u4ecb\u7ecd\u57fa\u4e8e\u5982\u4e0b3\u4e2a\u9759\u6001\u5c5e\u6027\u548c3\u4e2a\u52a8\u6001\u5c5e\u6027\u5f97\u5230\u768414\u4e2a\u57fa\u672c\u89c4\u5219\u3002 \u9759\u6001\u5c5e\u6027\uff1a\u5de5\u5e8f/\u4f5c\u4e1a\u7684\u56fa\u6709\u5c5e\u6027\uff0c\u4e0d\u968f\u52a0\u5de5\u8fdb\u5ea6\u6539\u53d8 \u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4 p_{i,j} p_{i,j} \u4f5c\u4e1a\u5de5\u5e8f\u6570\u91cf |M_j| |M_j| \u4f5c\u4e1a\u52a0\u5de5\u65f6\u95f4 \\,\\Sigma_{i=1}^{m} p_{i,j} \\,\\Sigma_{i=1}^{m} p_{i,j} \uff1a\u4f5c\u4e1a\u5305\u542b\u7684\u6240\u6709\u5de5\u5e8f\u7684\u52a0\u5de5\u65f6\u95f4\u603b\u548c \u52a8\u6001\u5c5e\u6027\uff1a\u4e0e\u52a0\u5de5\u8fdb\u7a0b\u76f8\u5173\u7684\u5c5e\u6027 \u5de5\u5e8f\u751f\u6210\u65f6\u523b t_{i,j} t_{i,j} \uff1a\u5de5\u5e8f O_{i,j} O_{i,j} \u8fbe\u5230\u673a\u5668 m_i m_i \u7684\u65f6\u523b\uff0c\u5373\u4e0a\u4e00\u9053\u5de5\u5e8f\u7ed3\u675f\u7684\u65f6\u95f4 \u5de5\u5e8f\u7b49\u5f85\u65f6\u95f4 w_{i,j} w_{i,j} \uff1a\u4ece\u5de5\u5e8f\u5230\u8fbe\u673a\u5668\u5f00\u59cb\u5230\u53ef\u4ee5\u8fdb\u884c\u52a0\u5de5\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u5982\u679c\u9a6c\u4e0a\u53ef\u4ee5\u52a0\u5de5\u5219\u7b49\u5f85\u4e3a\u65f6\u95f4\u7b49\u4e8e0 \u4f5c\u4e1a\u5269\u4f59\u5de5\u4f5c\u65f6\u95f4 r_{i,j} r_{i,j} \uff1a\u5de5\u5e8f\u6240\u5728\u4f5c\u4e1a\u5c1a\u672a\u8fdb\u884c\u7684\u5de5\u5e8f\uff08\u5305\u542b\u5f53\u524d\u5de5\u5e8f\uff09\u7684\u52a0\u5de5\u65f6\u95f4\u4e4b\u548c \u5728\u8fd96\u4e2a\u5c5e\u6027\u7684\u57fa\u7840\u4e0a\uff0c\u5b9a\u4e49\u51fa\u5982\u4e0b14\u4e2a\u57fa\u672c\u89c4\u5219\u3002 No. Rules Description Type ---------------------------------------------------- 1 FIFO First In First Out Static 2 LIFO Last In First Out Static 3 SPT Shortest Processing Time Static 4 LPT Longest Processing Time Static 5 SPS Shortest Process Sequence Static 6 LPS Longest Process Sequence Static 7 STPT Shortest Total Processing Time Static 8 LTPT Longest Total Processing Time Static 9 ECT Earliest Creation Time Dynamic 10 LCT Longest Creation Time Dynamic 11 SWT Shortest Waiting Time Dynamic 12 LWT Longest Waiting Time Dynamic 13 LTWR Least Total Work Remaining Dynamic 14 MTWR Most Total Work Remaining Dynamic \u8fdb\u800c\uff0c\u7ec4\u5408\u5176\u4e2d\u7684\u591a\u4e2a\u89c4\u5219\u53ef\u4ee5\u5f97\u5230\u66f4\u591a\u7ec4\u5408\u5f0f\u89c4\u5219\u3002\u672c\u6587\u7279\u522b\u5217\u51fa\u6587\u732e 3 \u63d0\u51fa\u7684\u4e00\u4e2a\u7ec4\u5408\u5f0f\u89c4\u5219\uff0c\u59d1\u4e14\u4ee5\u4f5c\u8005\u59d3\u6c0f\u547d\u540d\u4e3a HH \u3002 z_{i,j} = \\left (t_{i,j}+w_{i,j} \\uparrow, \\,\\, r_{i,j}-1.5\\,p_{i,j} \\downarrow \\right ) z_{i,j} = \\left (t_{i,j}+w_{i,j} \\uparrow, \\,\\, r_{i,j}-1.5\\,p_{i,j} \\downarrow \\right ) \u8be5\u89c4\u5219\u8868\u660e\uff1a \u5b9e\u9645\u5f00\u59cb\u52a0\u5de5\u65f6\u95f4\u8d8a\u65e9\u4f18\u5148\u7ea7\u8d8a\u9ad8 \u4f5c\u4e1a\u5269\u4f59\u5de5\u4f5c\u65f6\u95f4\u4e0e1.5\u500d\u5de5\u5e8f\u52a0\u5de5\u65f6\u95f4\u7684\u5dee\u503c\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8","title":"\u5178\u578b\u89c4\u5219"},{"location":"2021-08-28-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9A%E8%A7%84%E5%88%99%E6%8C%87%E6%B4%BE%E7%AE%97%E6%B3%95/#_4","text":"\u51e0\u4e4e\u6240\u6709\u7684\u6587\u732e\u90fd\u6709\u4e00\u4e2a\u5171\u8bc6\uff1a\u6ca1\u6709\u54ea\u4e00\u79cd\u5355\u4e00\u89c4\u5219\u53ef\u4ee5\u5168\u65b9\u4f4d\u4f18\u4e8e\u5176\u4ed6\u89c4\u5219\uff0c\u4f46\u6298\u8877\u6765\u770b\u8fd8\u662f\u5b58\u5728\u5177\u6709\u76f8\u5bf9\u4f18\u52bf\u7684\u67d0\u4e9b\u89c4\u5219\u3002\u4f8b\u5982\uff0c\u4e0a\u4e00\u8282\u57fa\u672c\u89c4\u5219\u4e2d\u7684 SPT \u548c MTWR \u5f97\u5230\u8f83\u591a\u6587\u732e\u7684\u5173\u6ce8\uff1a\u6587\u732e 1 \u8ba4\u4e3a SPT \u7efc\u5408\u8868\u73b0\u6700\u597d\uff0c\u6587\u732e 2 \u5219\u8ba4\u4e3a MTWR \u8868\u73b0\u66f4\u597d\u3002\u672c\u8282\u5e26\u4e0a HH \u89c4\u5219\uff0c\u5728\u6700\u5c0f\u5316\u52a0\u5de5\u5468\u671f\u7684\u76ee\u6807\u4e0b\uff0c\u770b\u770b\u6548\u679c\u7a76\u7adf\u5982\u4f55\u3002 SPT \u4f18\u5148\u52a0\u5de5\u8017\u65f6\u77ed\u7684\u5de5\u5e8f\uff0c\u5373\u7b80\u5355\u7684\u4e8b\u60c5\u5148\u505a MTWR \u4f18\u5148\u52a0\u5de5\u5269\u4f59\u6d3b\u513f\u591a\u7684\u5de5\u5e8f\uff0c\u5373\u590d\u6742\u7684\u4e8b\u60c5\u5148\u505a HH \u4f18\u5148\u52a0\u5de5\u53ef\u4ee5\u5c3d\u65e9\u5f00\u59cb\u7684\u5de5\u5e8f\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u9009\u62e9\u76f8\u5bf9\u590d\u6742\u7684\u5de5\u5e8f\uff0c\u5373\u5177\u5907\u6761\u4ef6\u4e14\u590d\u6742\u5ea6\u9ad8\u7684\u4e8b\u60c5\u5148\u505a from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import PriorityDispatchSolver # create problem from benchmark names = ['ft06', 'la01', 'ft10', 'swv01', 'la38', 'ta24', \\ 'ta31', 'swv12', 'ta24', 'ta42', 'ta54', 'ta68', 'ta69', 'ta70'] problems = [JSProblem(benchmark=name) for name in names] # priority dispatching solver solvers = [] rules = ['spt', 'mtwr', 'hh'] for rule in rules: solvers.append(PriorityDispatchSolver(rule=rule, name=rule.upper())) # solve and result benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=6) benchmark.run(show_info=True) \u65e0\u9700\u753b\u6210\u56fe\uff0c\u8868\u683c\u6570\u636e\u5c55\u793a\u7684\u7ed3\u679c\u5df2\u7ecf\u5f88\u660e\u663e\u4e14\u9707\u64bc\u3002 \u57fa\u4e8e3\u79cd\u89c4\u5219\u7684\u6c42\u89e3\u65f6\u95f4\u76f8\u5dee\u65e0\u51e0\uff0c\u4f46\u76f8\u5bf9\u7cbe\u5ea6\u5dee\u5f02\u751a\u5927 HH >> MTWR >> SPT HH \u4ee5\u6781\u9ad8\u7684\u8ba1\u7b97\u6548\u7387\uff08\u7cbe\u5ea6\u548c\u65f6\u95f4\u7684\u5e73\u8861\uff09\u5c55\u73b0\u4e86\u5176\u5b9e\u7528\u6027 +----+---------+--------+---------------+--------------+----------+---------+------+ | ID | Problem | Solver | job x machine | Optimum | Solution | Error % | Time | +----+---------+--------+---------------+--------------+----------+---------+------+ | 1 | ft06 | SPT | 6 x 6 | 55 | 109.0 | 98.2 | 0.0 | | 2 | ft06 | MTWR | 6 x 6 | 55 | 74.0 | 34.5 | 0.0 | | 3 | ft06 | HH | 6 x 6 | 55 | 60.0 | 9.1 | 0.0 | | 4 | la01 | SPT | 10 x 5 | 666 | 1462.0 | 119.5 | 0.0 | | 5 | la01 | MTWR | 10 x 5 | 666 | 880.0 | 32.1 | 0.0 | | 6 | la01 | HH | 10 x 5 | 666 | 666.0 | 0.0 | 0.0 | | 7 | ft10 | SPT | 10 x 10 | 930 | 2648.0 | 184.7 | 0.1 | | 8 | ft10 | MTWR | 10 x 10 | 930 | 1289.0 | 38.6 | 0.1 | | 9 | ft10 | HH | 10 x 10 | 930 | 1082.0 | 16.3 | 0.1 | | 10 | swv01 | SPT | 20 x 10 | 1407 | 4474.0 | 218.0 | 0.3 | | 11 | swv01 | MTWR | 20 x 10 | 1407 | 2682.0 | 90.6 | 0.4 | | 12 | swv01 | HH | 20 x 10 | 1407 | 1839.0 | 30.7 | 0.5 | | 13 | la38 | SPT | 15 x 15 | 1196 | 6560.0 | 448.5 | 0.7 | | 14 | la38 | MTWR | 15 x 15 | 1196 | 1860.0 | 55.5 | 0.7 | | 15 | la38 | HH | 15 x 15 | 1196 | 1387.0 | 16.0 | 0.8 | | 16 | ta24 | SPT | 20 x 20 | (1602, 1647) | 12103.0 | 645.0 | 1.9 | | 17 | ta24 | MTWR | 20 x 20 | (1602, 1647) | 2773.0 | 70.7 | 3.0 | | 18 | ta24 | HH | 20 x 20 | (1602, 1647) | 1842.0 | 13.4 | 3.2 | | 19 | ta31 | SPT | 30 x 15 | 1764 | 12398.0 | 602.8 | 3.5 | | 20 | ta31 | MTWR | 30 x 15 | 1764 | 3120.0 | 76.9 | 4.3 | | 21 | ta31 | HH | 30 x 15 | 1764 | 2127.0 | 20.6 | 5.1 | | 22 | swv12 | SPT | 50 x 10 | (2972, 3003) | 10315.0 | 245.3 | 6.3 | | 23 | swv12 | MTWR | 50 x 10 | (2972, 3003) | 6666.0 | 123.1 | 6.7 | | 24 | swv12 | HH | 50 x 10 | (2972, 3003) | 4337.0 | 45.2 | 8.9 | | 25 | ta24 | SPT | 20 x 20 | (1602, 1647) | 12103.0 | 645.0 | 5.7 | | 26 | ta24 | MTWR | 20 x 20 | (1602, 1647) | 2773.0 | 70.7 | 7.4 | | 27 | ta24 | HH | 20 x 20 | (1602, 1647) | 1842.0 | 13.4 | 7.5 | | 28 | ta42 | SPT | 30 x 20 | (1867, 1956) | 19301.0 | 909.7 | 11.4 | | 29 | ta42 | MTWR | 30 x 20 | (1867, 1956) | 3411.0 | 78.4 | 13.2 | | 30 | ta42 | HH | 30 x 20 | (1867, 1956) | 2307.0 | 20.7 | 13.9 | | 31 | ta54 | SPT | 50 x 15 | 2839 | 18775.0 | 561.3 | 16.0 | | 32 | ta54 | MTWR | 50 x 15 | 2839 | 4419.0 | 55.7 | 16.9 | | 33 | ta54 | HH | 50 x 15 | 2839 | 3063.0 | 7.9 | 20.4 | | 34 | ta68 | SPT | 50 x 20 | 2784 | 28490.0 | 923.3 | 25.2 | | 35 | ta68 | MTWR | 50 x 20 | 2784 | 4560.0 | 63.8 | 29.2 | | 36 | ta68 | HH | 50 x 20 | 2784 | 3023.0 | 8.6 | 35.7 | | 37 | ta69 | SPT | 50 x 20 | 3071 | 27347.0 | 790.5 | 30.3 | | 38 | ta69 | MTWR | 50 x 20 | 3071 | 4819.0 | 56.9 | 35.4 | | 39 | ta69 | HH | 50 x 20 | 3071 | 3511.0 | 14.3 | 38.4 | | 40 | ta70 | SPT | 50 x 20 | 2995 | 27728.0 | 825.8 | 38.5 | | 41 | ta70 | MTWR | 50 x 20 | 2995 | 4879.0 | 62.9 | 40.8 | | 42 | ta70 | HH | 50 x 20 | 2995 | 3438.0 | 14.8 | 41.2 | +----+---------+--------+---------------+--------------+----------+---------+------+ \u8ba1\u7b97\u7ed3\u679c\u8fd8\u662f\u5f88\u7b26\u5408\u6211\u4eec\u65e5\u5e38\u505a\u4e8b\u54f2\u5b66\u7684\uff1a \u4f18\u5148\u505a\u5df2\u7ecf\u5177\u5907\u6761\u4ef6\u7684\u4e8b\u60c5\uff08\u4e0d\u6d6a\u8d39\u8d44\u6e90\uff09\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u9009\u62e9\u590d\u6742\u5ea6\u9ad8\u7684\u4e8b\u60c5\uff08\u6293\u4e3b\u8981\u77db\u76fe\uff09 \u3002 Blackstone, John H., Don T. Phillips, and Gary L. Hogg. \"A state-of-the-art survey of dispatching rules for manufacturing job shop operations.\" The International Journal of Production Research 20.1 (1982): 27-45. \u21a9 \u21a9 Kaban, A. et al. \"Comparison of dispatching rules in job-shop scheduling problem using simulation: a case study.\" International Journal of Simulation Modelling 11 (2012): 129-140. \u21a9 \u21a9 \u9ec4\u5fd7, and \u9ec4\u6587\u5947. \"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u4e00\u79cd\u542f\u53d1\u5f0f\u7b97\u6cd5.\" \u8ba1\u7b97\u673a\u5de5\u7a0b\u4e0e\u5e94\u7528 26(2004):25-27. \u21a9","title":"\u8ba1\u7b97\u5b9e\u4f8b"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/","text":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 \u00b6 \u53d1\u5e03\u4e8e\uff1a2021-08-29 | \u5206\u7c7b\uff1a optimization , mathematics \u672c\u6587\u6839\u636e\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6570\u5b66\u63cf\u8ff0\uff0c\u5229\u7528 Python \u6574\u6570\u89c4\u5212\u6846\u67b6 PuLP \u8fdb\u884c\u5efa\u6a21\uff0c\u5e76\u5206\u522b\u4f7f\u7528\u9ed8\u8ba4\u7684 CBC \u6c42\u89e3\u5668\u53ca\u5546\u4e1a\u6c42\u89e3\u5668 Gurobi \u6c42\u89e3\u3002 PuLP \u00b6 PuLP \u662f\u5f00\u6e90\u57fa\u91d1\u4f1a COIN-OR (Computational Infrastructure for Operations Research) \u7ef4\u62a4\u7684\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u5efa\u6a21\u5de5\u5177\uff08LP modeler\uff09\uff0c\u5185\u7f6e\u4e86 CBC\uff08COIN-OR Branch-and-Cut\uff09\u6c42\u89e3\u5668\uff0c\u4e5f\u652f\u6301\u96c6\u6210\u5404\u79cd\u5f00\u6e90\uff08\u5982GLPK\uff09 \u6216\u8005\u5546\u4e1a\uff08CPLEX\u3001GUROBI\u7b49\uff09\u7684\u7ebf\u6027\u89c4\u5212\u6c42\u89e3\u5668\u3002 https://github.com/coin-or/pulp \u4f5c\u4e3a Python \u5e93\uff0cPuLP \u652f\u6301 pip \u4e00\u952e\u5b89\u88c5\u3002 pip install pulp \u66f4\u591a\u5165\u95e8\u6750\u6599\u53c2\u8003\uff1a \u5b98\u65b9\u6587\u6863 PuLP\u7b80\u4ecb \u6570\u5b66\u6a21\u578b \u00b6 \u524d\u6587 \u7ed9\u51fa\u4e86\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6570\u5b66\u6a21\u578b\u3002\u4e3a\u4e86\u65b9\u4fbf\u63a5\u4e0b\u6765\u7684\u5efa\u6a21\u63cf\u8ff0\uff0c\u6539\u4e3a\u4ee5\u5de5\u5e8f \u5f00\u59cb\u65f6\u95f4 \u4e3a\u51b3\u7b56\u53d8\u91cf\u7684\u63cf\u8ff0\u65b9\u5f0f\uff1a \\begin{align*} &\\min\\,\\, c_{m} \\\\ \\\\ &s.t.\\quad \\begin{cases} s_{ij} \\geq 0 & (i,j) \\in \\mathbb{O} \\\\ \\\\ c_m-s_{ij} \\geq p_{ij} & (i,j) \\in \\mathbb{O} \\\\ \\\\ s_{ij}-s_{kj} \\geq p_{kj} & if \\,\\, (k,j) \\rightarrow (i,j), \\,\\, i, k \\in \\mathbb{M}^j \\\\ \\\\ s_{ij} - s_{ik} \\geq p_{ik} \\,\\, or \\,\\, s_{ik}-s_{ij} \\geq p_{ij} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5176\u4e2d\u4e24\u4e2a\u57fa\u672c\u53d8\u91cf\uff1a s_{ij} s_{ij} \u8868\u793a\u5de5\u5e8f (i,j) (i,j) \u5373\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4 p_{ij} p_{ij} \u8868\u793a\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u6240\u9700\u7684\u52a0\u5de5\u65f6\u95f4 \u56db\u4e2a\u57fa\u672c\u7ea6\u675f\uff1a \u7b2c\u4e00\u4e2a\u8868\u660e\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4\u975e\u8d1f \u7b2c\u4e8c\u4e2a\u5b9a\u4e49\u4e86\u6700\u5927\u5b8c\u5de5\u65f6\u95f4 c_m c_m \u7b2c\u4e09\u4e2a\u662f\u5de5\u5e8f\u5e8f\u5217\u7ea6\u675f\uff0c\u5373\u540c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u76f8\u90bb\u5de5\u5e8f\u5fc5\u987b\u6ee1\u8db3\u5148\u540e\u987a\u5e8f \u7b2c\u56db\u4e2a\u662f\u8d44\u6e90\u7ea6\u675f\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f \u6211\u4eec\u9700\u8981\u7279\u522b\u5173\u6ce8\u4e00\u4e0b\u7b2c\u56db\u5f0f\uff0c\u56e0\u4e3a\u5b83\u51fa\u73b0\u4e86\u4e00\u4e2a \u6216 \u7684\u7ea6\u675f\u5173\u7cfb\uff0c\u4f46\u7ebf\u6027\u89c4\u5212\u95ee\u9898\u7684\u7ea6\u675f\u5f0f\u901a\u5e38\u90fd\u662f \u4e0e \u4e5f\u5c31\u662f\u4e14\u7684\u5173\u7cfb\u3002\u4e3a\u4e86\u6b63\u786e\u5b9e\u65bd\u8fd9\u4e2a\u7ea6\u675f\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u989d\u5916\u7684\u53d8\u91cf b_{jk} b_{jk} \uff0c\u8868\u793a\u5206\u914d\u5230\u673a\u5668 m_i m_i \u7684\u6240\u6709\u5de5\u5e8f\u4e2d\u4efb\u610f\u4e24\u8005\u4f8b\u5982\u5de5\u5e8f (i,j) (i,j) \u548c\u5de5\u5e8f (i,k) (i,k) \u7684\u5148\u540e\u5173\u7cfb\uff1a \\begin{align*} b_{jk} = \\begin{cases} 0 & if \\,\\, (i,j) \\rightarrow (i,k) \\\\ \\\\ 1 & if \\,\\, (i,k) \\rightarrow (i,j) \\end{cases} \\end{align*} \u5373\uff0c b_{jk} b_{jk} \u662f\u4e00\u4e2a 0-1 0-1 \u53d8\u91cf\uff0c\u5f53\u5de5\u5e8f (i,j) (i,j) \u6392\u5728\u5de5\u5e8f (i,k) (i,k) \u4e4b\u524d\u53d6\u503c 0\uff0c\u5426\u5219 1\u3002 \u4e8e\u662f\uff0c\u539f\u6765\u5199\u6cd5\u4e2d\u903b\u8f91 \u6216 \u7684\u4e24\u79cd\u60c5\u51b5\u88ab\u7b49\u6548\u4e3a 0-1 0-1 \u53d8\u91cf b_{jk} b_{jk} \u7684\u4e24\u79cd\u53ef\u80fd\u3002\u8fdb\u800c\uff0c\u6539\u5199\u7ea6\u675f\u5f0f\u7684\u601d\u8def\u662f\u5408\u5e76/\u7edf\u4e00\u539f\u6765\u4e24\u4e2a\u5206\u652f\uff0c\u4e00\u65e6\u786e\u5b9a b_{jk} b_{jk} \u5219\u9000\u5316\u4e3a\u5176\u4e2d\u4e00\u4e2a\u5206\u652f\u3002\u8fd9\u4e00\u6b65\u8fd8\u9700\u8981\u4e00\u70b9\u5c0f\u6280\u5de7\uff0c\u6700\u7ec8\u7ea6\u675f\u56db\u88ab\u6539\u5199\u4e3a\u4ee5\u4e0b\u4e24\u4e2a\u5f0f\u5b50\uff1a \\begin{align*} \\begin{cases} s_{ij}-s_{ik} \\geq p_{ik} - C*(1-b_{jk}) & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\\\ \\\\ s_{ik}-s_{ij} \\geq p_{ij} - C*b_{jk} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5176\u4e2d\uff0c C C \u662f\u4e00\u4e2a\u8db3\u591f\u5927\u4f8b\u5982\u6ee1\u8db3 C>\\Sigma \\, p_{ij} C>\\Sigma \\, p_{ij} \u7684\u5e38\u6570\u3002 \u9a8c\u8bc1\u4e00\u4e0b\uff0c\u5047\u8bbe\u5de5\u5e8f (i,j) (i,j) \u6392\u5728\u5de5\u5e8f (i,k) (i,k) \u4e4b\u524d\u5373 b_{jk}=0 b_{jk}=0 \uff0c\u5219\u7b2c\u4e8c\u5f0f\u53cd\u6620\u6b63\u786e\u7684\u7ea6\u675f\u5173\u7cfb\uff0c\u800c\u7b2c\u4e00\u5f0f\u663e\u7136\u6210\u7acb\u5373\u4e0d\u53cd\u5e94\u4efb\u4f55\u6709\u6548\u4fe1\u606f\uff1b\u76f8\u53cd\uff0c b_{jk}=1 b_{jk}=1 \u65f6\uff0c\u7b2c\u4e00\u5f0f\u53cd\u6620\u76ee\u6807\u7ea6\u675f\u800c\u7b2c\u4e8c\u5f0f\u663e\u7136\u6210\u7acb\u3002 PuLP \u6a21\u578b \u00b6 \u4f7f\u7528 PuLP \u5efa\u6a21\u548c\u6c42\u89e3\u7684\u6b65\u9aa4\u4e0e Google OR-Tools \u6781\u4e3a\u7c7b\u4f3c\uff0c\u4f46 PuLP \u5e76\u672a\u63d0\u4f9b\u5982 OR-Tools \u4e00\u822c\u4fbf\u6377\u7684\u5efa\u7acb\u7ea6\u675f\u7684 API\u3002\u4f8b\u5982\uff0cOR-Tools \u7684\u533a\u95f4\u7c7b\u578b\u53d8\u91cf\u914d\u5408 NoOverlap \u7ea6\u675f\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5b9e\u73b0\u673a\u5668\u4e0a\u5de5\u5e8f\u4e0d\u91cd\u53e0\u7684\u7ea6\u675f\uff08\u5373\u4e0a\u4e00\u8282\u63cf\u8ff0\u7684\u7ea6\u675f\u56db\uff09\uff0c\u4f46 PuLP \u9700\u8981\u66f4\u57fa\u7840\u7684\u6570\u5b66\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e0a\u4e00\u8282\u8fdb\u884c\u7684\u7ea6\u675f\u8f6c\u6362\u5373\u4e3a\u6b64\u670d\u52a1\u3002 PuLP \u5efa\u6a21\u5e38\u7528\u7684API\uff1a LpProblem \u7c7b LpProblem(name='NoName', sense=LpMinimize) \u5176\u4e2d\uff0c sense \u53c2\u6570\u76ee\u6807\u51fd\u6570\u662f\u6c42\u6781\u5927\u503c\uff08LpMaximize\uff09\u8fd8\u662f\u6781\u5c0f\u503c\uff08LpMinimize\uff09\u3002 \u5efa\u7acb\u7ea6\u675f\u540e\u8c03\u7528 solve(solver=None, **kwargs) \u6c42\u89e3\uff0c\u9ed8\u8ba4\u4e3a CBC \u6c42\u89e3\u5668\u3002 LpVariable \u7c7b LpVariable(name, lowBound=None, upBound=None, cat='Continuous', e=None) \u5176\u4e2d\uff0c name \u8868\u793a\u53d8\u91cf\u540d lowBound \u548c upBound \u8868\u793a\u53d8\u91cf\u8303\u56f4\u4e0b\u754c\u548c\u4e0a\u754c\uff0c\u9ed8\u8ba4\u8d1f\u65e0\u7a77\u5230\u6b63\u65e0\u7a77 cat \u6307\u5b9a\u53d8\u91cf\u662f\u79bb\u6563\u7c7b\u578b\uff08Integer\u6216Binary\uff09\uff0c\u8fd8\u662f\u8fde\u7eed\u7c7b\u578b\uff08Continuous\uff09 \u7279\u522b\u5730\uff0c\u5f53\u53d8\u91cf\u4e2a\u6570\u7279\u522b\u591a\u4e14\u6ee1\u8db3\u6279\u91cf\u5316\u5904\u7406\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u5efa\u7acb\u5b57\u5178\u683c\u5f0f\u7684\u53d8\u91cf\u96c6\u5408\u3002 LpVariable.dicts(name, indexs, lowBound=None, upBound=None, cat='Continuous', indexStart=[]) \u5176\u4e2d\uff0c name \u6307\u5b9a\u6240\u6709\u53d8\u91cf\u7684\u524d\u7f00 indexs \u662f\u4e00\u4e2a\u5217\u8868\uff0c\u5c06\u4f1a\u4e3a\u5176\u4e2d\u6bcf\u4e00\u4e2a\u5143\u7d20\u521b\u5efa\u4e00\u4e2a\u53d8\u91cf\uff0c\u5e76\u5efa\u7acb\u5bf9\u5e94\u5173\u7cfb \u57fa\u4e8e jsp_framework \u5b9e\u73b0 \u00b6 \u672c\u6587\u53c2\u8003 \u6848\u4f8b \uff0c\u57fa\u4e8e jsp_framework \u8fdb\u884c\u5b9e\u73b0\u548c\u96c6\u6210\uff0c\u5b8c\u6574\u4ee3\u7801\u53c2\u8003\uff1a https://github.com/dothinking/jsp_framework/blob/dev/jsp_fwk/solver/pulp.py \u57fa\u672c\u6d41\u7a0b \u00b6 \u53c2\u8003 Python\u5efa\u6a21 \uff0c\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ee7\u627f\u81ea JSSolver \u7684 PuLPSolver \u7c7b\uff0c\u7136\u540e\u91cd\u70b9\u5b9e\u73b0 do_solve() \u65b9\u6cd5\u3002 class PuLPSolver(JSSolver): ... def do_solve(self, problem:JSProblem): '''Solve JSP with PuLP default CBC solver.''' # Initialize an empty solution from problem solution = JSSolution(problem) # create model model, variables = self.__create_model(solution) # The problem is solved using PuLP's choice of Solver model.solve(pulp.PULP_CBC_CMD(maxSeconds=self.__max_time, msg=1, fracGap=0)) if model.status!=pulp.LpStatusOptimal: raise JSPException('No feasible solution found.') # assign pulp solution back to JSPSolution for op, var in variables.items(): op.update_start_time(var.varValue) problem.update_solution(solution) # update solution \u6ce8\u610f \u5f53\u524d\u7248\u672c\u652f\u6301 CBC\uff08COIN-OR Branch-and-Cut\uff09\u3001SCIP \uff08\u5f00\u6e90\uff09 \u548c Gurobi\uff08\u5546\u4e1a\uff09\u6c42\u89e3\u5668\u3002\u5176\u4e2d CBC \u4e3a Pulp \u9ed8\u8ba4\u6c42\u89e3\u5668\uff0c\u5f00\u7bb1\u5373\u7528\uff1b\u5176\u4f59\u4e8c\u8005\u9700\u8981\u81ea\u884c\u4e0b\u8f7d\u5b89\u88c5\u548c\u6388\u6743\u3002 PuLP \u5efa\u6a21 \u00b6 \u5373\u4e0a\u4e00\u4ee3\u7801\u7247\u6bb5 self.__create_model(solution) \u7684\u5177\u4f53\u5c55\u5f00\u3002 \u521b\u5efa\u95ee\u9898 # create the model model = pulp.LpProblem(\"min_makespan\", pulp.LpMinimize) \u521b\u5efa\u53d8\u91cf \u57fa\u672c\u53d8\u91cf\uff1a\u6bcf\u4e00\u9053\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4 # (1) start time of each operation max_time = sum(op.source.duration for op in solution.ops) # upper bound of variables variables = pulp.LpVariable.dicts(name='start_time', \\ indexs=solution.ops, \\ lowBound=0, \\ upBound=max_time, \\ cat='Integer') \u5176\u4e2d\uff0c max_time \u662f\u6240\u6709\u5de5\u5e8f\u7528\u65f6\u4e4b\u548c\uff0c\u5373\u4e0d\u91cd\u53e0\u4efb\u4f55\u5de5\u5e8f\u7684\u8c03\u5ea6\u7ed3\u679c\u3002\u663e\u7136\uff0c\u8fd9\u662f\u4efb\u610f\u5de5\u5e8f\u5f00\u59cb\u65f6\u95f4\u7684\u4e0a\u9650\u3002\u5e76\u4e14\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u4f5c\u4e3a\u95ee\u9898\u63cf\u8ff0\u4e2d\u63d0\u53ca\u7684 \u8db3\u591f\u5927\u7684\u6570 \u3002 0-1\u53d8\u91cf\uff1a\u8868\u5f81\u540c\u4e00\u673a\u5668\u4e0a\u4efb\u610f\u4e24\u9053\u5de5\u5e8f\u7684\u524d\u540e\u987a\u5e8f # (2) binary variable, i.e. 0 or 1, indicating the sequence of every two # operations assigned in same machine combinations = [] for _, ops in solution.machine_ops.items(): combinations.extend(pulp.combination(ops, 2)) bin_vars = pulp.LpVariable.dicts(name='binary_var', \\ indexs=combinations, \\ lowBound=0, \\ cat='Binary') \u5176\u4e2d\uff0c pulp.combination \u5f97\u5230\u4e86\u673a\u5668\u961f\u5217\u5de5\u5e8f\u7684\u4e24\u4e24\u7ec4\u5408\u3002 \u521b\u5efa\u76ee\u6807\u51fd\u6570\uff1a\u603b\u7684\u52a0\u5de5\u5468\u671f # objective: makespan / flowtime s_max = pulp.LpVariable(name='max_start_time', \\ lowBound=0, \\ upBound=max_time, \\ cat='Integer') model += s_max \u6ce8\u610f\uff1a\u6b64\u5904\u76ee\u6807\u51fd\u6570\u4ec5\u4ec5\u662f\u4e00\u4e2a\u666e\u901a\u7684\u53d8\u91cf\uff0c\u540e\u7eed\u6dfb\u52a0\u7ea6\u675f\u4fdd\u8bc1\u5176\u4e3a\u6700\u5927\u7684\u52a0\u5de5\u5468\u671f \u6dfb\u52a0\u7ea6\u675f \u6700\u5927\u52a0\u5de5\u5468\u671f\u7ea6\u675f # (1) the max start time for _, ops in solution.job_ops.items(): last_op = ops[-1] model += (s_max-variables[last_op]) >= last_op.source.duration \u4f5c\u4e1a\u89c6\u89d2\u7684\u5de5\u5e8f\u987a\u5e8f\u7ea6\u675f # (2) operation sequence inside a job pre = None for op in solution.ops: if pre and pre.source.job==op.source.job: model += (variables[op]-variables[pre]) >= pre.source.duration pre = op \u673a\u5668\u89c6\u89d2\u7684\u5de5\u5e8f\u987a\u5e8f\u7ea6\u675f # (3) no overlap for operations assigned to same machine for op_a, op_b in combinations: model += (variables[op_a]-variables[op_b]) >= (op_b.source.duration - max_time*(1-bin_vars[op_a, op_b])) model += (variables[op_b]-variables[op_a]) >= (op_a.source.duration - max_time*bin_vars[op_a, op_b]) \u8ba1\u7b97\u5b9e\u4f8b \u00b6 \u6700\u540e\uff0c\u6c42\u89e3\u51e0\u4e2a\u6807\u51c6\u95ee\u9898\u3002\u4e0eGoogle OR-Tools\u4e00\u6837\uff0c\u6c42\u89e3\u65f6\u95f4\u4e0a\u9650\u8bbe\u5b9a\u4e3a300\u79d2\u3002 # benchmark.py from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import PuLPSolver # problems names = ['ft06', 'la01', 'ft10', 'swv01', 'la38', \\ 'ta31', 'swv12', 'ta42', 'ta54', 'ta70'] problems = [JSProblem(benchmark=name) for name in names] # solver solvers = [PuLPSolver(name=name, solver_name=name, max_time=300) \\ for name in ('cbc', 'gurobi')] # solve benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=5) benchmark.run(show_info=True) \u7ed3\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a +----+---------+--------+---------------+--------------+----------+---------+-------+ | ID | Problem | Solver | job x machine | Optimum | Solution | Error % | Time | +----+---------+--------+---------------+--------------+----------+---------+-------+ | 1 | ft06 | cbc | 6 x 6 | 55 | 55.0 | 0.0 | 3.5 | | 2 | la01 | cbc | 10 x 5 | 666 | 666.0 | 0.0 | 209.0 | | 3 | ft10 | cbc | 10 x 10 | 930 | 1034.0 | 11.2 | 301.2 | | 4 | swv01 | cbc | 20 x 10 | 1407 | 2941.0 | 109.0 | 301.2 | | 5 | la38 | cbc | 15 x 15 | 1196 | 1769.0 | 47.9 | 301.2 | | 6 | ta31 | cbc | 30 x 15 | 1764 | 13294.0 | 653.6 | 301.1 | | 7 | swv12 | cbc | 50 x 10 | (2972, 3003) | 9527.0 | 218.9 | 309.9 | | 8 | ta42 | cbc | 30 x 20 | (1867, 1956) | 23202.0 | 1113.8 | 507.1 | | 9 | ta54 | cbc | 50 x 15 | 2839 | 26229.0 | 823.9 | 608.0 | | 10 | ta70 | cbc | 50 x 20 | 2995 | 36851.0 | 1130.4 | 625.6 | +----+---------+--------+---------------+--------------+----------+---------+-------+ +----+---------+--------+---------------+--------------+----------+---------+-------+ | ID | Problem | Solver | job x machine | Optimum | Solution | Error % | Time | +----+---------+--------+---------------+--------------+----------+---------+-------+ | 1 | ft06 | gurobi | 6 x 6 | 55 | 55.0 | 0.0 | 0.7 | | 2 | la01 | gurobi | 10 x 5 | 666 | 666.0 | 0.0 | 5.2 | | 3 | ft10 | gurobi | 10 x 10 | 930 | 930.0 | 0.0 | 60.2 | | 4 | swv01 | gurobi | 20 x 10 | 1407 | 1757.0 | 24.9 | 301.4 | | 5 | la38 | gurobi | 15 x 15 | 1196 | 1196.0 | 0.0 | 300.9 | | 6 | ta31 | gurobi | 30 x 15 | 1764 | 2142.0 | 21.4 | 304.5 | | 7 | swv12 | gurobi | 50 x 10 | (2972, 3003) | unsolved | n.a. | 308.9 | | 8 | ta42 | gurobi | 30 x 20 | (1867, 1956) | 2457.0 | 28.5 | 362.8 | | 9 | ta54 | gurobi | 50 x 15 | 2839 | unsolved | n.a. | 607.6 | | 10 | ta70 | gurobi | 50 x 20 | 2995 | 4513.0 | 50.7 | 608.2 | +----+---------+--------+---------------+--------------+----------+---------+-------+ cbc \u6c42\u89e3\u5668\u7684\u8ba1\u7b97\u6548\u679c\u5e76\u4e0d\u7406\u60f3\uff0c\u53ea\u6709\u524d\u4e24\u4e2a\u95ee\u9898\u5373\u5de5\u5e8f\u603b\u6570 50 \u4ee5\u5185\u5f97\u5230\u4e86\u6700\u4f18\u89e3\uff0c\u5176\u4f59\u6848\u4f8b\u8bef\u5dee\u8f83\u5927\u3002 Gurobi \u7684\u7ed3\u679c\u7565\u6709\u6539\u8fdb\uff0c\u524d5\u9898\u7ed3\u679c\u5c1a\u53ef\uff0c\u540e5\u9898\u6216\u8005\u65e0\u6cd5\u6c42\u89e3\u6216\u8005\u8bef\u5dee\u8f83\u5927\uff0c\u6574\u4f53\u4e0d\u5982\u524d\u6587\u7684OR-Tools \u7ea6\u675f\u6c42\u89e3\u5668\u3002 \u7531\u6b64\u8868\u660e\uff0c\u5bf9\u4e8e\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff0c \u6df7\u5408\u6574\u6570\u89c4\u5212\u6c42\u89e3\u5668 \uff08\u5982CBC\u3001Gurobi\uff09\u7684\u6c42\u89e3\u6027\u80fd\u4e0d\u5982**\u7ea6\u675f\u6c42\u89e3\u5668**\uff08\u5982Google OR-Tools \u7684CpSolver\uff09\u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#pulp","text":"\u53d1\u5e03\u4e8e\uff1a2021-08-29 | \u5206\u7c7b\uff1a optimization , mathematics \u672c\u6587\u6839\u636e\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6570\u5b66\u63cf\u8ff0\uff0c\u5229\u7528 Python \u6574\u6570\u89c4\u5212\u6846\u67b6 PuLP \u8fdb\u884c\u5efa\u6a21\uff0c\u5e76\u5206\u522b\u4f7f\u7528\u9ed8\u8ba4\u7684 CBC \u6c42\u89e3\u5668\u53ca\u5546\u4e1a\u6c42\u89e3\u5668 Gurobi \u6c42\u89e3\u3002","title":"\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#pulp_1","text":"PuLP \u662f\u5f00\u6e90\u57fa\u91d1\u4f1a COIN-OR (Computational Infrastructure for Operations Research) \u7ef4\u62a4\u7684\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u5efa\u6a21\u5de5\u5177\uff08LP modeler\uff09\uff0c\u5185\u7f6e\u4e86 CBC\uff08COIN-OR Branch-and-Cut\uff09\u6c42\u89e3\u5668\uff0c\u4e5f\u652f\u6301\u96c6\u6210\u5404\u79cd\u5f00\u6e90\uff08\u5982GLPK\uff09 \u6216\u8005\u5546\u4e1a\uff08CPLEX\u3001GUROBI\u7b49\uff09\u7684\u7ebf\u6027\u89c4\u5212\u6c42\u89e3\u5668\u3002 https://github.com/coin-or/pulp \u4f5c\u4e3a Python \u5e93\uff0cPuLP \u652f\u6301 pip \u4e00\u952e\u5b89\u88c5\u3002 pip install pulp \u66f4\u591a\u5165\u95e8\u6750\u6599\u53c2\u8003\uff1a \u5b98\u65b9\u6587\u6863 PuLP\u7b80\u4ecb","title":"PuLP"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_1","text":"\u524d\u6587 \u7ed9\u51fa\u4e86\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u7684\u6570\u5b66\u6a21\u578b\u3002\u4e3a\u4e86\u65b9\u4fbf\u63a5\u4e0b\u6765\u7684\u5efa\u6a21\u63cf\u8ff0\uff0c\u6539\u4e3a\u4ee5\u5de5\u5e8f \u5f00\u59cb\u65f6\u95f4 \u4e3a\u51b3\u7b56\u53d8\u91cf\u7684\u63cf\u8ff0\u65b9\u5f0f\uff1a \\begin{align*} &\\min\\,\\, c_{m} \\\\ \\\\ &s.t.\\quad \\begin{cases} s_{ij} \\geq 0 & (i,j) \\in \\mathbb{O} \\\\ \\\\ c_m-s_{ij} \\geq p_{ij} & (i,j) \\in \\mathbb{O} \\\\ \\\\ s_{ij}-s_{kj} \\geq p_{kj} & if \\,\\, (k,j) \\rightarrow (i,j), \\,\\, i, k \\in \\mathbb{M}^j \\\\ \\\\ s_{ij} - s_{ik} \\geq p_{ik} \\,\\, or \\,\\, s_{ik}-s_{ij} \\geq p_{ij} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5176\u4e2d\u4e24\u4e2a\u57fa\u672c\u53d8\u91cf\uff1a s_{ij} s_{ij} \u8868\u793a\u5de5\u5e8f (i,j) (i,j) \u5373\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4 p_{ij} p_{ij} \u8868\u793a\u4f5c\u4e1a j j \u7684\u67d0\u4e2a\u5728\u673a\u5668 i i \u4e0a\u8fdb\u884c\u7684\u5de5\u5e8f\u6240\u9700\u7684\u52a0\u5de5\u65f6\u95f4 \u56db\u4e2a\u57fa\u672c\u7ea6\u675f\uff1a \u7b2c\u4e00\u4e2a\u8868\u660e\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4\u975e\u8d1f \u7b2c\u4e8c\u4e2a\u5b9a\u4e49\u4e86\u6700\u5927\u5b8c\u5de5\u65f6\u95f4 c_m c_m \u7b2c\u4e09\u4e2a\u662f\u5de5\u5e8f\u5e8f\u5217\u7ea6\u675f\uff0c\u5373\u540c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u76f8\u90bb\u5de5\u5e8f\u5fc5\u987b\u6ee1\u8db3\u5148\u540e\u987a\u5e8f \u7b2c\u56db\u4e2a\u662f\u8d44\u6e90\u7ea6\u675f\uff0c\u5373\u6bcf\u4e00\u53f0\u673a\u5668\u5728\u67d0\u4e2a\u65f6\u523b\u53ea\u80fd\u52a0\u5de5\u4e00\u9053\u5de5\u5e8f \u6211\u4eec\u9700\u8981\u7279\u522b\u5173\u6ce8\u4e00\u4e0b\u7b2c\u56db\u5f0f\uff0c\u56e0\u4e3a\u5b83\u51fa\u73b0\u4e86\u4e00\u4e2a \u6216 \u7684\u7ea6\u675f\u5173\u7cfb\uff0c\u4f46\u7ebf\u6027\u89c4\u5212\u95ee\u9898\u7684\u7ea6\u675f\u5f0f\u901a\u5e38\u90fd\u662f \u4e0e \u4e5f\u5c31\u662f\u4e14\u7684\u5173\u7cfb\u3002\u4e3a\u4e86\u6b63\u786e\u5b9e\u65bd\u8fd9\u4e2a\u7ea6\u675f\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u989d\u5916\u7684\u53d8\u91cf b_{jk} b_{jk} \uff0c\u8868\u793a\u5206\u914d\u5230\u673a\u5668 m_i m_i \u7684\u6240\u6709\u5de5\u5e8f\u4e2d\u4efb\u610f\u4e24\u8005\u4f8b\u5982\u5de5\u5e8f (i,j) (i,j) \u548c\u5de5\u5e8f (i,k) (i,k) \u7684\u5148\u540e\u5173\u7cfb\uff1a \\begin{align*} b_{jk} = \\begin{cases} 0 & if \\,\\, (i,j) \\rightarrow (i,k) \\\\ \\\\ 1 & if \\,\\, (i,k) \\rightarrow (i,j) \\end{cases} \\end{align*} \u5373\uff0c b_{jk} b_{jk} \u662f\u4e00\u4e2a 0-1 0-1 \u53d8\u91cf\uff0c\u5f53\u5de5\u5e8f (i,j) (i,j) \u6392\u5728\u5de5\u5e8f (i,k) (i,k) \u4e4b\u524d\u53d6\u503c 0\uff0c\u5426\u5219 1\u3002 \u4e8e\u662f\uff0c\u539f\u6765\u5199\u6cd5\u4e2d\u903b\u8f91 \u6216 \u7684\u4e24\u79cd\u60c5\u51b5\u88ab\u7b49\u6548\u4e3a 0-1 0-1 \u53d8\u91cf b_{jk} b_{jk} \u7684\u4e24\u79cd\u53ef\u80fd\u3002\u8fdb\u800c\uff0c\u6539\u5199\u7ea6\u675f\u5f0f\u7684\u601d\u8def\u662f\u5408\u5e76/\u7edf\u4e00\u539f\u6765\u4e24\u4e2a\u5206\u652f\uff0c\u4e00\u65e6\u786e\u5b9a b_{jk} b_{jk} \u5219\u9000\u5316\u4e3a\u5176\u4e2d\u4e00\u4e2a\u5206\u652f\u3002\u8fd9\u4e00\u6b65\u8fd8\u9700\u8981\u4e00\u70b9\u5c0f\u6280\u5de7\uff0c\u6700\u7ec8\u7ea6\u675f\u56db\u88ab\u6539\u5199\u4e3a\u4ee5\u4e0b\u4e24\u4e2a\u5f0f\u5b50\uff1a \\begin{align*} \\begin{cases} s_{ij}-s_{ik} \\geq p_{ik} - C*(1-b_{jk}) & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\\\ \\\\ s_{ik}-s_{ij} \\geq p_{ij} - C*b_{jk} & (i,j), (i,k) \\in \\mathbb{O}, \\,\\, j \\neq k \\end{cases} \\end{align*} \u5176\u4e2d\uff0c C C \u662f\u4e00\u4e2a\u8db3\u591f\u5927\u4f8b\u5982\u6ee1\u8db3 C>\\Sigma \\, p_{ij} C>\\Sigma \\, p_{ij} \u7684\u5e38\u6570\u3002 \u9a8c\u8bc1\u4e00\u4e0b\uff0c\u5047\u8bbe\u5de5\u5e8f (i,j) (i,j) \u6392\u5728\u5de5\u5e8f (i,k) (i,k) \u4e4b\u524d\u5373 b_{jk}=0 b_{jk}=0 \uff0c\u5219\u7b2c\u4e8c\u5f0f\u53cd\u6620\u6b63\u786e\u7684\u7ea6\u675f\u5173\u7cfb\uff0c\u800c\u7b2c\u4e00\u5f0f\u663e\u7136\u6210\u7acb\u5373\u4e0d\u53cd\u5e94\u4efb\u4f55\u6709\u6548\u4fe1\u606f\uff1b\u76f8\u53cd\uff0c b_{jk}=1 b_{jk}=1 \u65f6\uff0c\u7b2c\u4e00\u5f0f\u53cd\u6620\u76ee\u6807\u7ea6\u675f\u800c\u7b2c\u4e8c\u5f0f\u663e\u7136\u6210\u7acb\u3002","title":"\u6570\u5b66\u6a21\u578b"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#pulp_2","text":"\u4f7f\u7528 PuLP \u5efa\u6a21\u548c\u6c42\u89e3\u7684\u6b65\u9aa4\u4e0e Google OR-Tools \u6781\u4e3a\u7c7b\u4f3c\uff0c\u4f46 PuLP \u5e76\u672a\u63d0\u4f9b\u5982 OR-Tools \u4e00\u822c\u4fbf\u6377\u7684\u5efa\u7acb\u7ea6\u675f\u7684 API\u3002\u4f8b\u5982\uff0cOR-Tools \u7684\u533a\u95f4\u7c7b\u578b\u53d8\u91cf\u914d\u5408 NoOverlap \u7ea6\u675f\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5b9e\u73b0\u673a\u5668\u4e0a\u5de5\u5e8f\u4e0d\u91cd\u53e0\u7684\u7ea6\u675f\uff08\u5373\u4e0a\u4e00\u8282\u63cf\u8ff0\u7684\u7ea6\u675f\u56db\uff09\uff0c\u4f46 PuLP \u9700\u8981\u66f4\u57fa\u7840\u7684\u6570\u5b66\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e0a\u4e00\u8282\u8fdb\u884c\u7684\u7ea6\u675f\u8f6c\u6362\u5373\u4e3a\u6b64\u670d\u52a1\u3002 PuLP \u5efa\u6a21\u5e38\u7528\u7684API\uff1a LpProblem \u7c7b LpProblem(name='NoName', sense=LpMinimize) \u5176\u4e2d\uff0c sense \u53c2\u6570\u76ee\u6807\u51fd\u6570\u662f\u6c42\u6781\u5927\u503c\uff08LpMaximize\uff09\u8fd8\u662f\u6781\u5c0f\u503c\uff08LpMinimize\uff09\u3002 \u5efa\u7acb\u7ea6\u675f\u540e\u8c03\u7528 solve(solver=None, **kwargs) \u6c42\u89e3\uff0c\u9ed8\u8ba4\u4e3a CBC \u6c42\u89e3\u5668\u3002 LpVariable \u7c7b LpVariable(name, lowBound=None, upBound=None, cat='Continuous', e=None) \u5176\u4e2d\uff0c name \u8868\u793a\u53d8\u91cf\u540d lowBound \u548c upBound \u8868\u793a\u53d8\u91cf\u8303\u56f4\u4e0b\u754c\u548c\u4e0a\u754c\uff0c\u9ed8\u8ba4\u8d1f\u65e0\u7a77\u5230\u6b63\u65e0\u7a77 cat \u6307\u5b9a\u53d8\u91cf\u662f\u79bb\u6563\u7c7b\u578b\uff08Integer\u6216Binary\uff09\uff0c\u8fd8\u662f\u8fde\u7eed\u7c7b\u578b\uff08Continuous\uff09 \u7279\u522b\u5730\uff0c\u5f53\u53d8\u91cf\u4e2a\u6570\u7279\u522b\u591a\u4e14\u6ee1\u8db3\u6279\u91cf\u5316\u5904\u7406\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u5efa\u7acb\u5b57\u5178\u683c\u5f0f\u7684\u53d8\u91cf\u96c6\u5408\u3002 LpVariable.dicts(name, indexs, lowBound=None, upBound=None, cat='Continuous', indexStart=[]) \u5176\u4e2d\uff0c name \u6307\u5b9a\u6240\u6709\u53d8\u91cf\u7684\u524d\u7f00 indexs \u662f\u4e00\u4e2a\u5217\u8868\uff0c\u5c06\u4f1a\u4e3a\u5176\u4e2d\u6bcf\u4e00\u4e2a\u5143\u7d20\u521b\u5efa\u4e00\u4e2a\u53d8\u91cf\uff0c\u5e76\u5efa\u7acb\u5bf9\u5e94\u5173\u7cfb","title":"PuLP \u6a21\u578b"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#jsp_framework","text":"\u672c\u6587\u53c2\u8003 \u6848\u4f8b \uff0c\u57fa\u4e8e jsp_framework \u8fdb\u884c\u5b9e\u73b0\u548c\u96c6\u6210\uff0c\u5b8c\u6574\u4ee3\u7801\u53c2\u8003\uff1a https://github.com/dothinking/jsp_framework/blob/dev/jsp_fwk/solver/pulp.py","title":"\u57fa\u4e8e jsp_framework \u5b9e\u73b0"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_2","text":"\u53c2\u8003 Python\u5efa\u6a21 \uff0c\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ee7\u627f\u81ea JSSolver \u7684 PuLPSolver \u7c7b\uff0c\u7136\u540e\u91cd\u70b9\u5b9e\u73b0 do_solve() \u65b9\u6cd5\u3002 class PuLPSolver(JSSolver): ... def do_solve(self, problem:JSProblem): '''Solve JSP with PuLP default CBC solver.''' # Initialize an empty solution from problem solution = JSSolution(problem) # create model model, variables = self.__create_model(solution) # The problem is solved using PuLP's choice of Solver model.solve(pulp.PULP_CBC_CMD(maxSeconds=self.__max_time, msg=1, fracGap=0)) if model.status!=pulp.LpStatusOptimal: raise JSPException('No feasible solution found.') # assign pulp solution back to JSPSolution for op, var in variables.items(): op.update_start_time(var.varValue) problem.update_solution(solution) # update solution \u6ce8\u610f \u5f53\u524d\u7248\u672c\u652f\u6301 CBC\uff08COIN-OR Branch-and-Cut\uff09\u3001SCIP \uff08\u5f00\u6e90\uff09 \u548c Gurobi\uff08\u5546\u4e1a\uff09\u6c42\u89e3\u5668\u3002\u5176\u4e2d CBC \u4e3a Pulp \u9ed8\u8ba4\u6c42\u89e3\u5668\uff0c\u5f00\u7bb1\u5373\u7528\uff1b\u5176\u4f59\u4e8c\u8005\u9700\u8981\u81ea\u884c\u4e0b\u8f7d\u5b89\u88c5\u548c\u6388\u6743\u3002","title":"\u57fa\u672c\u6d41\u7a0b"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#pulp_3","text":"\u5373\u4e0a\u4e00\u4ee3\u7801\u7247\u6bb5 self.__create_model(solution) \u7684\u5177\u4f53\u5c55\u5f00\u3002 \u521b\u5efa\u95ee\u9898 # create the model model = pulp.LpProblem(\"min_makespan\", pulp.LpMinimize) \u521b\u5efa\u53d8\u91cf \u57fa\u672c\u53d8\u91cf\uff1a\u6bcf\u4e00\u9053\u5de5\u5e8f\u7684\u5f00\u59cb\u65f6\u95f4 # (1) start time of each operation max_time = sum(op.source.duration for op in solution.ops) # upper bound of variables variables = pulp.LpVariable.dicts(name='start_time', \\ indexs=solution.ops, \\ lowBound=0, \\ upBound=max_time, \\ cat='Integer') \u5176\u4e2d\uff0c max_time \u662f\u6240\u6709\u5de5\u5e8f\u7528\u65f6\u4e4b\u548c\uff0c\u5373\u4e0d\u91cd\u53e0\u4efb\u4f55\u5de5\u5e8f\u7684\u8c03\u5ea6\u7ed3\u679c\u3002\u663e\u7136\uff0c\u8fd9\u662f\u4efb\u610f\u5de5\u5e8f\u5f00\u59cb\u65f6\u95f4\u7684\u4e0a\u9650\u3002\u5e76\u4e14\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u4f5c\u4e3a\u95ee\u9898\u63cf\u8ff0\u4e2d\u63d0\u53ca\u7684 \u8db3\u591f\u5927\u7684\u6570 \u3002 0-1\u53d8\u91cf\uff1a\u8868\u5f81\u540c\u4e00\u673a\u5668\u4e0a\u4efb\u610f\u4e24\u9053\u5de5\u5e8f\u7684\u524d\u540e\u987a\u5e8f # (2) binary variable, i.e. 0 or 1, indicating the sequence of every two # operations assigned in same machine combinations = [] for _, ops in solution.machine_ops.items(): combinations.extend(pulp.combination(ops, 2)) bin_vars = pulp.LpVariable.dicts(name='binary_var', \\ indexs=combinations, \\ lowBound=0, \\ cat='Binary') \u5176\u4e2d\uff0c pulp.combination \u5f97\u5230\u4e86\u673a\u5668\u961f\u5217\u5de5\u5e8f\u7684\u4e24\u4e24\u7ec4\u5408\u3002 \u521b\u5efa\u76ee\u6807\u51fd\u6570\uff1a\u603b\u7684\u52a0\u5de5\u5468\u671f # objective: makespan / flowtime s_max = pulp.LpVariable(name='max_start_time', \\ lowBound=0, \\ upBound=max_time, \\ cat='Integer') model += s_max \u6ce8\u610f\uff1a\u6b64\u5904\u76ee\u6807\u51fd\u6570\u4ec5\u4ec5\u662f\u4e00\u4e2a\u666e\u901a\u7684\u53d8\u91cf\uff0c\u540e\u7eed\u6dfb\u52a0\u7ea6\u675f\u4fdd\u8bc1\u5176\u4e3a\u6700\u5927\u7684\u52a0\u5de5\u5468\u671f \u6dfb\u52a0\u7ea6\u675f \u6700\u5927\u52a0\u5de5\u5468\u671f\u7ea6\u675f # (1) the max start time for _, ops in solution.job_ops.items(): last_op = ops[-1] model += (s_max-variables[last_op]) >= last_op.source.duration \u4f5c\u4e1a\u89c6\u89d2\u7684\u5de5\u5e8f\u987a\u5e8f\u7ea6\u675f # (2) operation sequence inside a job pre = None for op in solution.ops: if pre and pre.source.job==op.source.job: model += (variables[op]-variables[pre]) >= pre.source.duration pre = op \u673a\u5668\u89c6\u89d2\u7684\u5de5\u5e8f\u987a\u5e8f\u7ea6\u675f # (3) no overlap for operations assigned to same machine for op_a, op_b in combinations: model += (variables[op_a]-variables[op_b]) >= (op_b.source.duration - max_time*(1-bin_vars[op_a, op_b])) model += (variables[op_b]-variables[op_a]) >= (op_a.source.duration - max_time*bin_vars[op_a, op_b])","title":"PuLP \u5efa\u6a21"},{"location":"2021-08-29-%E4%BD%9C%E4%B8%9A%E8%BD%A6%E9%97%B4%E8%B0%83%E5%BA%A6%E9%97%AE%E9%A2%98%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6%EF%BC%9APuLP%E6%B1%82%E8%A7%A3%E6%A1%86%E6%9E%B6/#_3","text":"\u6700\u540e\uff0c\u6c42\u89e3\u51e0\u4e2a\u6807\u51c6\u95ee\u9898\u3002\u4e0eGoogle OR-Tools\u4e00\u6837\uff0c\u6c42\u89e3\u65f6\u95f4\u4e0a\u9650\u8bbe\u5b9a\u4e3a300\u79d2\u3002 # benchmark.py from jsp_fwk import (JSProblem, BenchMark) from jsp_fwk.solver import PuLPSolver # problems names = ['ft06', 'la01', 'ft10', 'swv01', 'la38', \\ 'ta31', 'swv12', 'ta42', 'ta54', 'ta70'] problems = [JSProblem(benchmark=name) for name in names] # solver solvers = [PuLPSolver(name=name, solver_name=name, max_time=300) \\ for name in ('cbc', 'gurobi')] # solve benchmark = BenchMark(problems=problems, solvers=solvers, num_threads=5) benchmark.run(show_info=True) \u7ed3\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a +----+---------+--------+---------------+--------------+----------+---------+-------+ | ID | Problem | Solver | job x machine | Optimum | Solution | Error % | Time | +----+---------+--------+---------------+--------------+----------+---------+-------+ | 1 | ft06 | cbc | 6 x 6 | 55 | 55.0 | 0.0 | 3.5 | | 2 | la01 | cbc | 10 x 5 | 666 | 666.0 | 0.0 | 209.0 | | 3 | ft10 | cbc | 10 x 10 | 930 | 1034.0 | 11.2 | 301.2 | | 4 | swv01 | cbc | 20 x 10 | 1407 | 2941.0 | 109.0 | 301.2 | | 5 | la38 | cbc | 15 x 15 | 1196 | 1769.0 | 47.9 | 301.2 | | 6 | ta31 | cbc | 30 x 15 | 1764 | 13294.0 | 653.6 | 301.1 | | 7 | swv12 | cbc | 50 x 10 | (2972, 3003) | 9527.0 | 218.9 | 309.9 | | 8 | ta42 | cbc | 30 x 20 | (1867, 1956) | 23202.0 | 1113.8 | 507.1 | | 9 | ta54 | cbc | 50 x 15 | 2839 | 26229.0 | 823.9 | 608.0 | | 10 | ta70 | cbc | 50 x 20 | 2995 | 36851.0 | 1130.4 | 625.6 | +----+---------+--------+---------------+--------------+----------+---------+-------+ +----+---------+--------+---------------+--------------+----------+---------+-------+ | ID | Problem | Solver | job x machine | Optimum | Solution | Error % | Time | +----+---------+--------+---------------+--------------+----------+---------+-------+ | 1 | ft06 | gurobi | 6 x 6 | 55 | 55.0 | 0.0 | 0.7 | | 2 | la01 | gurobi | 10 x 5 | 666 | 666.0 | 0.0 | 5.2 | | 3 | ft10 | gurobi | 10 x 10 | 930 | 930.0 | 0.0 | 60.2 | | 4 | swv01 | gurobi | 20 x 10 | 1407 | 1757.0 | 24.9 | 301.4 | | 5 | la38 | gurobi | 15 x 15 | 1196 | 1196.0 | 0.0 | 300.9 | | 6 | ta31 | gurobi | 30 x 15 | 1764 | 2142.0 | 21.4 | 304.5 | | 7 | swv12 | gurobi | 50 x 10 | (2972, 3003) | unsolved | n.a. | 308.9 | | 8 | ta42 | gurobi | 30 x 20 | (1867, 1956) | 2457.0 | 28.5 | 362.8 | | 9 | ta54 | gurobi | 50 x 15 | 2839 | unsolved | n.a. | 607.6 | | 10 | ta70 | gurobi | 50 x 20 | 2995 | 4513.0 | 50.7 | 608.2 | +----+---------+--------+---------------+--------------+----------+---------+-------+ cbc \u6c42\u89e3\u5668\u7684\u8ba1\u7b97\u6548\u679c\u5e76\u4e0d\u7406\u60f3\uff0c\u53ea\u6709\u524d\u4e24\u4e2a\u95ee\u9898\u5373\u5de5\u5e8f\u603b\u6570 50 \u4ee5\u5185\u5f97\u5230\u4e86\u6700\u4f18\u89e3\uff0c\u5176\u4f59\u6848\u4f8b\u8bef\u5dee\u8f83\u5927\u3002 Gurobi \u7684\u7ed3\u679c\u7565\u6709\u6539\u8fdb\uff0c\u524d5\u9898\u7ed3\u679c\u5c1a\u53ef\uff0c\u540e5\u9898\u6216\u8005\u65e0\u6cd5\u6c42\u89e3\u6216\u8005\u8bef\u5dee\u8f83\u5927\uff0c\u6574\u4f53\u4e0d\u5982\u524d\u6587\u7684OR-Tools \u7ea6\u675f\u6c42\u89e3\u5668\u3002 \u7531\u6b64\u8868\u660e\uff0c\u5bf9\u4e8e\u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\uff0c \u6df7\u5408\u6574\u6570\u89c4\u5212\u6c42\u89e3\u5668 \uff08\u5982CBC\u3001Gurobi\uff09\u7684\u6c42\u89e3\u6027\u80fd\u4e0d\u5982**\u7ea6\u675f\u6c42\u89e3\u5668**\uff08\u5982Google OR-Tools \u7684CpSolver\uff09\u3002","title":"\u8ba1\u7b97\u5b9e\u4f8b"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/","text":"GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline \u00b6 \u53d1\u5e03\u4e8e\uff1a2022-01-27 | \u5206\u7c7b\uff1a devops \u8fd1\u671f\u9047\u5230\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u7075\u6d3b\u7ba1\u7406\u5206\u7cfb\u7edf\u7684\u7248\u672c\u53f7\u548c\u6700\u7ec8\u4ea7\u54c1\u7684\u7248\u672c\u53f7\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u524d\u540e\u7aef\u5206\u79bb\u4e14\u5206\u4ed3\u5e93\u7ba1\u7406\u7684Web\u9879\u76ee\uff0c\u524d\u3001\u540e\u7aef\u7ef4\u62a4\u5404\u81ea\u7684\u7248\u672c\u53f7\uff08\u524d\u7aef1.2.3\uff0c\u540e\u7aef1.3.4\uff09\uff0c\u5e76\u4e14\u53d1\u5e03Web\u4ea7\u54c1\u65f6\u81ea\u52a8\u6839\u636e tag \uff081.0.0\uff09\u4f5c\u4e3a\u4ea7\u54c1\u7684\u7248\u672c\u53f7\u7f16\u8bd1\u5230\u9875\u9762\u4e0a\u3002\u6ce8\u610f\u95ee\u9898\u5728\u4e8e\uff1a \u6700\u7ec8\u4ea7\u54c1\u7684\u7248\u672c\u53f7\u5f88\u53ef\u80fd\u4e0e\u524d\u3001\u540e\u7aef\u90fd\u4e0d\u76f8\u540c\uff0c\u56e0\u6b64\u901a\u8fc7\u524d\u7aef\u6216\u8005\u540e\u7aef\u4ed3\u5e93\u63d0\u4ea4 tag \u53d1\u5e03\u4ea7\u54c1\u90fd\u4e0d\u5408\u9002 \u3002 \u57fa\u672c\u601d\u8def\uff1a\u521b\u5efa\u53d1\u5e03\u4ed3\u5e93 \u00b6 \u56e0\u6b64\u8003\u8651\u65b0\u5efa\u4e00\u4e2a\u53d1\u5e03\u4ed3\u5e93\uff0c\u4ec5\u7ef4\u62a4\u6c47\u603b\u540e\u7684\u524d\u540e\u7aef\u66f4\u65b0\u65e5\u5fd7\u548c\u53d1\u5e03\u7248\u672c\u53f7\u3002\u540c\u65f6\u8003\u8651\u5230\u4ea7\u54c1\u53d1\u5e03\u540e\u7684 hotfix \uff0c\u4e5f\u652f\u6301\u76f4\u63a5\u4ece\u53d7\u5f71\u54cd\u7684\u524d\u7aef\u6216\u8005\u540e\u7aef\u4ed3\u5e93\u63d0\u4ea4\u4fee\u590d\u5e76\u90e8\u7f72\u3002 \u7efc\u5408\u6765\u8bf4\uff0c\u6d89\u53ca\u4e24\u7c7b\u81ea\u52a8\u5316\u6d41\u7a0b\uff1a \u4ece\u53d1\u5e03\u4ed3\u5e93\u53d1\u5e03\u4ea7\u54c1\uff0c\u540c\u65f6\u89e6\u53d1\u524d\u3001\u540e\u7aef\u4ed3\u5e93\u7684\u90e8\u7f72\uff0c\u5e76\u6839\u636e\u63d0\u4f9b\u7684 tag \u66f4\u65b0\u4ea7\u54c1\u7248\u672c\u53f7 \u4ece\u524d\u3001\u540e\u7aef\u53d1\u5e03 hotfix \uff0c\u4ec5\u89e6\u53d1\u5404\u81ea\u7684\u90e8\u7f72\uff0c\u4e14\u4e0d\u66f4\u65b0\u4ea7\u54c1\u7248\u672c\u53f7\uff0c\u800c\u662f\u6cbf\u7528\u53d1\u5e03\u4ed3\u5e93\u6700\u65b0\u7684 tag \u4e3a\u7b80\u5316\u8868\u8ff0\uff0c\u7528 A \u8868\u793a\u53d1\u5e03\u4ed3\u5e93\uff0c\u5206\u522b\u7528 B1 \u3001 B2 \u8868\u793a\u524d\u3001\u540e\u7aef\u4ed3\u5e93\uff0c\u5219\u53ef\u7528\u4e0b\u56fe\u8868\u793a\u4ee5\u4e0a\u6d41\u7a0b\u3002 \u5177\u4f53\u6d41\u7a0b \u00b6 \u57fa\u672c\u8bbe\u5b9a\uff1a \u4ed3\u5e93 B1 \u548c B2 \u4efb\u610f\u63d0\u4ea4\u89e6\u53d1\u7f16\u8bd1 build \uff0c\u5ffd\u7565\u6d4b\u8bd5 test \uff0c\u5982\u679c\u662f release \u5206\u652f\u5219\u89e6\u53d1\u90e8\u7f72 deploy \u4ed3\u5e93 A \u4ec5\u5728\u63d0\u4ea4 tag \u540e\u89e6\u53d1\u6d41\u7a0b \u8003\u8651\u5230\u6a21\u5757\u5316\u548c\u5c31\u8fd1\u539f\u5219\uff0c\u4ed3\u5e93 A \u8d1f\u8d23\u83b7\u53d6\u5f53\u524d\u6700\u65b0\u7684 tag \u4f5c\u4e3a\u4ea7\u54c1\u7248\u672c\u53f7\uff0c\u4ed3\u5e93 B1 \u3001 B2 \u8d1f\u8d23\u5404\u81ea\u7684\u7f16\u8bd1\u548c\u53d1\u5e03\uff0c\u53ea\u4e0d\u8fc7\u7f16\u8bd1\u524d\u9700\u8981\u62ff\u5230\u4ea7\u54c1\u7248\u672c\u53f7\u3002\u53c2\u8003\u4e0b\u56fe\u5177\u4f53\u6d41\u7a0b\uff1a \u5982\u679c\u4ece\u4ed3\u5e93 A \u63d0\u4ea4 tag \u89e6\u53d1\u6d41\u7a0b\uff0c\u5219\u76f4\u63a5\u83b7\u53d6\u6700\u65b0\u7248\u672c\u53f7\uff0c\u7136\u540e\u5206\u522b\u89e6\u53d1\u4ed3\u5e93 B1 \u548c B2 \u7684\u6d41\u7a0b\u3002 \u4ee5 B1 \u4e3a\u4f8b\uff0c\u6ce8\u610f\u6b64\u65f6\u76f4\u63a5\u5230 build \u8fd9\u4e2a\u4efb\u52a1\uff1b B2 \u540c\u7406\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002 \u5982\u679c\u4ece\u4ed3\u5e93 B1 \u63d0\u4ea4\uff0c\u7531\u4e8e\u7f16\u8bd1\u524d\u9700\u8981\u83b7\u53d6\u4ea7\u54c1\u5f53\u524d\u7248\u672c\u53f7\uff0c\u56e0\u6b64\u901a\u8fc7 trigger A \u4efb\u52a1\u89e6\u53d1\u4ed3\u5e93 A \u7684\u6d41\u7a0b\u3002 \u7c7b\u4f3c\u4e0a\u6587\u6240\u8ff0 A \u7684\u6d41\u7a0b\uff0c\u53ea\u4e0d\u8fc7\u6b64\u65f6\u9700\u8981\u6839\u636e\u539f\u59cb\u4ed3\u5e93\uff08\u5373 B1 \uff09\u786e\u5b9a\u53ea\u89e6\u53d1 B1 \u7684\u6d41\u7a0b\uff0c\u8fdb\u800c\u6765\u5230 B1 \u7684 build \u3002 \u6700\u7ec8\u6548\u679c \u00b6 \u501f\u52a9 GitLab CI/CD \u7684\u57fa\u672c\u529f\u80fd\uff0c\u6267\u884c\u6548\u679c\u53c2\u8003\u4e0b\u56fe\uff0c\u53ef\u89c1\u5b8c\u6574\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u6d41\u7a0b\u3002 \u4ece A \u53d1\u5e03\u7248\u672c 1.1.0 \u4ece B1 \u7684 release \u5206\u652f\u63d0\u4ea4 hotfix \u5b9e\u73b0\u7ec6\u8282 \u00b6 \u603b\u7ed3\u51e0\u4e2a\u5173\u952e\u70b9\uff1a \u8de8\u9879\u76ee\u89e6\u53d1\u6d41\u7a0b\uff0c\u4f8b\u5982\u4e0a\u56fe\u4e2d B1 \u4e2d trigger A \u548c A \u4e2d trigger B1 \u3001 trigger B2 \u6267\u884c\u4efb\u52a1\u7684\u65f6\u673a\uff0c\u4f8b\u5982 B1 \u4e2d trigger A \u4ec5\u5728\u76f4\u63a5\u63d0\u4ea4\u65f6\u6267\u884c\uff0c\u800c build \u4ec5\u5f53\u4ece\u4e0a\u6e38\u6d41\u6c34 pipeline \u89e6\u53d1\u65f6\u6267\u884c\u3002 \u8de8\u9879\u76ee\u89e6\u53d1\u6d41\u7a0b\u65f6\u4f20\u9012\u53c2\u6570\uff0c\u4f8b\u5982\u901a\u8fc7 B1 \u7684 trigger A \u8fdb\u5165 A \u7684\u6d41\u7a0b\u65f6\uff0c\u4f20\u9012\u8868\u660e\u539f\u59cb\u4ed3\u5e93\u5373 B1 \u7684\u53c2\u6570\uff0c\u4ee5\u4fbf\u9009\u62e9\u6027\u8fdb\u5165 trigger B1 \u8de8\u9879\u76ee\u89e6\u53d1\u6d41\u7a0b \u00b6 \u8fd9\u662f\u672c\u6587\u7684\u57fa\u7840\uff0c\u5177\u4f53\u8bf4\u660e\u53c2\u8003\u5b98\u65b9\u6587\u6863 Multi-project pipelines \u3002 downstream-job: variables: UPSTREAM_BRANCH: $CI_COMMIT_REF_NAME trigger: project: path/to/downstream/project branch: stable-11-2 trigger \u5173\u952e\u5b57\u6307\u5b9a\u5c06\u8981\u89e6\u53d1\u7684\u4e0b\u6e38\u9879\u76ee\u7684\u5177\u4f53\u8def\u5f84\uff0c\u540c\u65f6\u53ef\u4ee5\u6307\u5b9a\u57fa\u4e8e\u7684\u5206\u652f branch \u5982\u679c\u5ffd\u7565\u5206\u652f\u5373\u9ed8\u8ba4\u6700\u65b0\u5206\u652f\uff0c\u5219\u53ef\u4ee5\u5408\u5e76\u4e3a trigger: path/to/downstream/project variables \u5173\u952e\u5b57\u5c06\u5f53\u524d\u6d41\u7a0b\u7684\u53c2\u6570\u4f20\u9012\u5230\u4e0b\u6e38\u6d41\u7a0b\u7684\u6bcf\u4e2a\u4efb\u52a1\u4e2d\u53bb\uff0c\u4f8b\u5982\u6b64\u5904 $CI_COMMIT_REF_NAME \u8868\u793a\u5f53\u524d\u5206\u652f\u540d \u66f4\u591a\u5185\u7f6e\u53c2\u6570\u53c2\u8003 Predefined CI/CD variables \u6ce8\u610f\uff1a trigger:project \u4e0d\u652f\u6301\u53d8\u91cf\u8f93\u5165\uff0c trigger:branch \u652f\u6301\u53d8\u91cf\u8f93\u5165\u3002 \u4efb\u52a1\u6267\u884c\u6761\u4ef6 \u00b6 GitLab CI/CD\u901a\u8fc7 only / except \u548c rules \u5173\u952e\u5b57\uff0c\u4ee5\u975e\u5e38\u7075\u6d3b\u7684\u65b9\u5f0f\u5c06\u4efb\u52a1\u52a0\u5165\u6216\u8005\u6392\u9664\u5f53\u524d\u6d41\u7a0b\u3002 \u672c\u6587\u76f8\u5173\u7684\u51e0\u4e2a\u4f8b\u5b50\uff1a \u4ece\u4e0a\u6e38\u4ed3\u5e93\u89e6\u53d1 B1 \u4e0d\u6267\u884c trigger A trigger_a: stage: trigger trigger: path/to/A except: - pipelines \u5f53\u4e14\u4ec5\u5f53\u4ece\u4e0a\u6e38\u4ed3\u5e93\u89e6\u53d1 B1 \u65f6\u624d\u6267\u884c build build: stage: build script: - ... only: - pipelines \u4ece\u4e0a\u6e38\u4ed3\u5e93\u89e6\u53d1 B1 \u4e14\u5f53\u524d\u5206\u652f\u662f release \u65f6\u624d\u6267\u884c deploy deploy: stage: deploy script: - echo \"Deploying application only if branch=release...\" rules: - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_BRANCH==\"release\" \u5176\u4e2d\uff0c CI_PIPELINE_SOURCE \u4e5f\u662f\u9ed8\u8ba4CI/CD\u53c2\u6570\uff0c\u8868\u793a\u6d41\u7a0b\u7684\u89e6\u53d1\u6e90\uff0c\u503c pipeline \u8868\u660e\u4ece\u4e0a\u6e38\u6d41\u7a0b\u89e6\u53d1\u800c\u6765\uff1b SOURCE_BRANCH \u4e5f\u662f\u4ece\u4e0a\u6e38\u6d41\u7a0b\u4f20\u9012\u8fc7\u6765\u7684\u8868\u660e\u5f53\u524d\u5206\u652f\u7684\u81ea\u5b9a\u4e49\u53c2\u6570\u3002 A \u4e2d get version number \u4efb\u52a1\u53ea\u6709\u5728 tag \u63d0\u4ea4\u6216\u8005\u4ece\u5176\u4ed6\u6d41\u7a0b\u89e6\u53d1\u800c\u6765\u624d\u6267\u884c get_version_number: stage: prepare script: - ... only: - /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - pipelines A \u4e2d trigger B1 \u4efb\u52a1\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u79cd\u60c5\u5f62\u4e4b\u4e00\u5373\u53ef\u6267\u884c\uff1a \u76f4\u63a5\u4ece A \u4ed3\u5e93 tag \u63d0\u4ea4 \u4ece\u5176\u4ed6\u6d41\u7a0b\u89e6\u53d1\u4e14\u81ea\u5b9a\u4e49\u53c2\u6570 SOURCE_PROJECT \u7684\u503c\u7b49\u4e8e B1 \u5373\u4ece B1 \u89e6\u53d1\u7684\u6d41\u7a0b trigger_b1: stage: trigger trigger: project: path/to/B1 branch: $TARGET_BRANCH rules: - if: $CI_COMMIT_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_PROJECT==\"B1\" \u5b8c\u6574 ymal \u6587\u4ef6 \u00b6 \u8865\u5145\u4e00\u70b9\uff1a\u672c\u4f8b\u7684\u4ea7\u54c1\u7248\u672c\u53f7\u662f\u901a\u8fc7\u4fdd\u5b58\u6587\u4ef6\u7684\u5f62\u5f0f\u5728\u4e24\u4e2a\u6d41\u7a0b\u95f4\u4f20\u9012\u7684\uff0c\u56e0\u6b64\u9700\u8981\u4fdd\u8bc1\u5404\u6d41\u7a0b\u90fd\u5728\u540c\u4e00\u53f0gitlab-runner\u4e0a\u6267\u884c\u3002\u800c\u8fd9\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u5b9a\u76f8\u540c\u7684 tags \u6765\u5b9e\u73b0\u3002 \u6700\u540e\uff0c\u5206\u522b\u5217\u51fa\u5404\u4ed3\u5e93\u7684ymal\u6587\u4ef6\u3002 # .gitlab-ci.yml for project A variables: PROJECT_B1: \"B1\" PROJECT_B2: \"B2\" VERSION_FILE: /tmp/version TARGET_BRANCH: \"release\" stages: - prepare - trigger check_version: stage: prepare script: - VERSION=$(git describe --tags $(git rev-list --tags --max-count=1)) # recent tag - if [ \"$VERSION\" = \"\" ]; then VERSION=\"1.0.0\"; fi - VERSION=\"$VERSION.$(date +%Y%m%d)\" - echo $VERSION>$VERSION_FILE only: - /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - pipelines tags: - shell_runner trigger_b1: stage: trigger variables: SOURCE_BRANCH: $TARGET_BRANCH trigger: project: path/to/B1 branch: $TARGET_BRANCH rules: - if: $CI_COMMIT_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_PROJECT==$PROJECT_B1 trigger_b2: stage: trigger variables: SOURCE_BRANCH: $TARGET_BRANCH trigger: project: path/to/B2 branch: $TARGET_BRANCH rules: - if: $CI_COMMIT_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_PROJECT==$PROJECT_B2 # .gitlab-ci.yml for project B1; same with B2 stages: - trigger - build - deploy trigger_a: variables: SOURCE_PROJECT: $CI_PROJECT_NAME TARGET_BRANCH: $CI_COMMIT_REF_NAME stage: trigger trigger: path/to/A except: - pipelines build: stage: build script: - VERSION=$(cat $VERSION_FILE) - echo $VERSION only: - pipelines tags: - shell_runner deploy: stage: deploy script: - echo \"Deploying application only if branch=release...\" rules: - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_BRANCH==\"release\" tags: - shell_runner","title":"GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#gitlab ci cdpipeline","text":"\u53d1\u5e03\u4e8e\uff1a2022-01-27 | \u5206\u7c7b\uff1a devops \u8fd1\u671f\u9047\u5230\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u7075\u6d3b\u7ba1\u7406\u5206\u7cfb\u7edf\u7684\u7248\u672c\u53f7\u548c\u6700\u7ec8\u4ea7\u54c1\u7684\u7248\u672c\u53f7\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u524d\u540e\u7aef\u5206\u79bb\u4e14\u5206\u4ed3\u5e93\u7ba1\u7406\u7684Web\u9879\u76ee\uff0c\u524d\u3001\u540e\u7aef\u7ef4\u62a4\u5404\u81ea\u7684\u7248\u672c\u53f7\uff08\u524d\u7aef1.2.3\uff0c\u540e\u7aef1.3.4\uff09\uff0c\u5e76\u4e14\u53d1\u5e03Web\u4ea7\u54c1\u65f6\u81ea\u52a8\u6839\u636e tag \uff081.0.0\uff09\u4f5c\u4e3a\u4ea7\u54c1\u7684\u7248\u672c\u53f7\u7f16\u8bd1\u5230\u9875\u9762\u4e0a\u3002\u6ce8\u610f\u95ee\u9898\u5728\u4e8e\uff1a \u6700\u7ec8\u4ea7\u54c1\u7684\u7248\u672c\u53f7\u5f88\u53ef\u80fd\u4e0e\u524d\u3001\u540e\u7aef\u90fd\u4e0d\u76f8\u540c\uff0c\u56e0\u6b64\u901a\u8fc7\u524d\u7aef\u6216\u8005\u540e\u7aef\u4ed3\u5e93\u63d0\u4ea4 tag \u53d1\u5e03\u4ea7\u54c1\u90fd\u4e0d\u5408\u9002 \u3002","title":"GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#_1","text":"\u56e0\u6b64\u8003\u8651\u65b0\u5efa\u4e00\u4e2a\u53d1\u5e03\u4ed3\u5e93\uff0c\u4ec5\u7ef4\u62a4\u6c47\u603b\u540e\u7684\u524d\u540e\u7aef\u66f4\u65b0\u65e5\u5fd7\u548c\u53d1\u5e03\u7248\u672c\u53f7\u3002\u540c\u65f6\u8003\u8651\u5230\u4ea7\u54c1\u53d1\u5e03\u540e\u7684 hotfix \uff0c\u4e5f\u652f\u6301\u76f4\u63a5\u4ece\u53d7\u5f71\u54cd\u7684\u524d\u7aef\u6216\u8005\u540e\u7aef\u4ed3\u5e93\u63d0\u4ea4\u4fee\u590d\u5e76\u90e8\u7f72\u3002 \u7efc\u5408\u6765\u8bf4\uff0c\u6d89\u53ca\u4e24\u7c7b\u81ea\u52a8\u5316\u6d41\u7a0b\uff1a \u4ece\u53d1\u5e03\u4ed3\u5e93\u53d1\u5e03\u4ea7\u54c1\uff0c\u540c\u65f6\u89e6\u53d1\u524d\u3001\u540e\u7aef\u4ed3\u5e93\u7684\u90e8\u7f72\uff0c\u5e76\u6839\u636e\u63d0\u4f9b\u7684 tag \u66f4\u65b0\u4ea7\u54c1\u7248\u672c\u53f7 \u4ece\u524d\u3001\u540e\u7aef\u53d1\u5e03 hotfix \uff0c\u4ec5\u89e6\u53d1\u5404\u81ea\u7684\u90e8\u7f72\uff0c\u4e14\u4e0d\u66f4\u65b0\u4ea7\u54c1\u7248\u672c\u53f7\uff0c\u800c\u662f\u6cbf\u7528\u53d1\u5e03\u4ed3\u5e93\u6700\u65b0\u7684 tag \u4e3a\u7b80\u5316\u8868\u8ff0\uff0c\u7528 A \u8868\u793a\u53d1\u5e03\u4ed3\u5e93\uff0c\u5206\u522b\u7528 B1 \u3001 B2 \u8868\u793a\u524d\u3001\u540e\u7aef\u4ed3\u5e93\uff0c\u5219\u53ef\u7528\u4e0b\u56fe\u8868\u793a\u4ee5\u4e0a\u6d41\u7a0b\u3002","title":"\u57fa\u672c\u601d\u8def\uff1a\u521b\u5efa\u53d1\u5e03\u4ed3\u5e93"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#_2","text":"\u57fa\u672c\u8bbe\u5b9a\uff1a \u4ed3\u5e93 B1 \u548c B2 \u4efb\u610f\u63d0\u4ea4\u89e6\u53d1\u7f16\u8bd1 build \uff0c\u5ffd\u7565\u6d4b\u8bd5 test \uff0c\u5982\u679c\u662f release \u5206\u652f\u5219\u89e6\u53d1\u90e8\u7f72 deploy \u4ed3\u5e93 A \u4ec5\u5728\u63d0\u4ea4 tag \u540e\u89e6\u53d1\u6d41\u7a0b \u8003\u8651\u5230\u6a21\u5757\u5316\u548c\u5c31\u8fd1\u539f\u5219\uff0c\u4ed3\u5e93 A \u8d1f\u8d23\u83b7\u53d6\u5f53\u524d\u6700\u65b0\u7684 tag \u4f5c\u4e3a\u4ea7\u54c1\u7248\u672c\u53f7\uff0c\u4ed3\u5e93 B1 \u3001 B2 \u8d1f\u8d23\u5404\u81ea\u7684\u7f16\u8bd1\u548c\u53d1\u5e03\uff0c\u53ea\u4e0d\u8fc7\u7f16\u8bd1\u524d\u9700\u8981\u62ff\u5230\u4ea7\u54c1\u7248\u672c\u53f7\u3002\u53c2\u8003\u4e0b\u56fe\u5177\u4f53\u6d41\u7a0b\uff1a \u5982\u679c\u4ece\u4ed3\u5e93 A \u63d0\u4ea4 tag \u89e6\u53d1\u6d41\u7a0b\uff0c\u5219\u76f4\u63a5\u83b7\u53d6\u6700\u65b0\u7248\u672c\u53f7\uff0c\u7136\u540e\u5206\u522b\u89e6\u53d1\u4ed3\u5e93 B1 \u548c B2 \u7684\u6d41\u7a0b\u3002 \u4ee5 B1 \u4e3a\u4f8b\uff0c\u6ce8\u610f\u6b64\u65f6\u76f4\u63a5\u5230 build \u8fd9\u4e2a\u4efb\u52a1\uff1b B2 \u540c\u7406\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002 \u5982\u679c\u4ece\u4ed3\u5e93 B1 \u63d0\u4ea4\uff0c\u7531\u4e8e\u7f16\u8bd1\u524d\u9700\u8981\u83b7\u53d6\u4ea7\u54c1\u5f53\u524d\u7248\u672c\u53f7\uff0c\u56e0\u6b64\u901a\u8fc7 trigger A \u4efb\u52a1\u89e6\u53d1\u4ed3\u5e93 A \u7684\u6d41\u7a0b\u3002 \u7c7b\u4f3c\u4e0a\u6587\u6240\u8ff0 A \u7684\u6d41\u7a0b\uff0c\u53ea\u4e0d\u8fc7\u6b64\u65f6\u9700\u8981\u6839\u636e\u539f\u59cb\u4ed3\u5e93\uff08\u5373 B1 \uff09\u786e\u5b9a\u53ea\u89e6\u53d1 B1 \u7684\u6d41\u7a0b\uff0c\u8fdb\u800c\u6765\u5230 B1 \u7684 build \u3002","title":"\u5177\u4f53\u6d41\u7a0b"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#_3","text":"\u501f\u52a9 GitLab CI/CD \u7684\u57fa\u672c\u529f\u80fd\uff0c\u6267\u884c\u6548\u679c\u53c2\u8003\u4e0b\u56fe\uff0c\u53ef\u89c1\u5b8c\u6574\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u6d41\u7a0b\u3002 \u4ece A \u53d1\u5e03\u7248\u672c 1.1.0 \u4ece B1 \u7684 release \u5206\u652f\u63d0\u4ea4 hotfix","title":"\u6700\u7ec8\u6548\u679c"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#_4","text":"\u603b\u7ed3\u51e0\u4e2a\u5173\u952e\u70b9\uff1a \u8de8\u9879\u76ee\u89e6\u53d1\u6d41\u7a0b\uff0c\u4f8b\u5982\u4e0a\u56fe\u4e2d B1 \u4e2d trigger A \u548c A \u4e2d trigger B1 \u3001 trigger B2 \u6267\u884c\u4efb\u52a1\u7684\u65f6\u673a\uff0c\u4f8b\u5982 B1 \u4e2d trigger A \u4ec5\u5728\u76f4\u63a5\u63d0\u4ea4\u65f6\u6267\u884c\uff0c\u800c build \u4ec5\u5f53\u4ece\u4e0a\u6e38\u6d41\u6c34 pipeline \u89e6\u53d1\u65f6\u6267\u884c\u3002 \u8de8\u9879\u76ee\u89e6\u53d1\u6d41\u7a0b\u65f6\u4f20\u9012\u53c2\u6570\uff0c\u4f8b\u5982\u901a\u8fc7 B1 \u7684 trigger A \u8fdb\u5165 A \u7684\u6d41\u7a0b\u65f6\uff0c\u4f20\u9012\u8868\u660e\u539f\u59cb\u4ed3\u5e93\u5373 B1 \u7684\u53c2\u6570\uff0c\u4ee5\u4fbf\u9009\u62e9\u6027\u8fdb\u5165 trigger B1","title":"\u5b9e\u73b0\u7ec6\u8282"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#_5","text":"\u8fd9\u662f\u672c\u6587\u7684\u57fa\u7840\uff0c\u5177\u4f53\u8bf4\u660e\u53c2\u8003\u5b98\u65b9\u6587\u6863 Multi-project pipelines \u3002 downstream-job: variables: UPSTREAM_BRANCH: $CI_COMMIT_REF_NAME trigger: project: path/to/downstream/project branch: stable-11-2 trigger \u5173\u952e\u5b57\u6307\u5b9a\u5c06\u8981\u89e6\u53d1\u7684\u4e0b\u6e38\u9879\u76ee\u7684\u5177\u4f53\u8def\u5f84\uff0c\u540c\u65f6\u53ef\u4ee5\u6307\u5b9a\u57fa\u4e8e\u7684\u5206\u652f branch \u5982\u679c\u5ffd\u7565\u5206\u652f\u5373\u9ed8\u8ba4\u6700\u65b0\u5206\u652f\uff0c\u5219\u53ef\u4ee5\u5408\u5e76\u4e3a trigger: path/to/downstream/project variables \u5173\u952e\u5b57\u5c06\u5f53\u524d\u6d41\u7a0b\u7684\u53c2\u6570\u4f20\u9012\u5230\u4e0b\u6e38\u6d41\u7a0b\u7684\u6bcf\u4e2a\u4efb\u52a1\u4e2d\u53bb\uff0c\u4f8b\u5982\u6b64\u5904 $CI_COMMIT_REF_NAME \u8868\u793a\u5f53\u524d\u5206\u652f\u540d \u66f4\u591a\u5185\u7f6e\u53c2\u6570\u53c2\u8003 Predefined CI/CD variables \u6ce8\u610f\uff1a trigger:project \u4e0d\u652f\u6301\u53d8\u91cf\u8f93\u5165\uff0c trigger:branch \u652f\u6301\u53d8\u91cf\u8f93\u5165\u3002","title":"\u8de8\u9879\u76ee\u89e6\u53d1\u6d41\u7a0b"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#_6","text":"GitLab CI/CD\u901a\u8fc7 only / except \u548c rules \u5173\u952e\u5b57\uff0c\u4ee5\u975e\u5e38\u7075\u6d3b\u7684\u65b9\u5f0f\u5c06\u4efb\u52a1\u52a0\u5165\u6216\u8005\u6392\u9664\u5f53\u524d\u6d41\u7a0b\u3002 \u672c\u6587\u76f8\u5173\u7684\u51e0\u4e2a\u4f8b\u5b50\uff1a \u4ece\u4e0a\u6e38\u4ed3\u5e93\u89e6\u53d1 B1 \u4e0d\u6267\u884c trigger A trigger_a: stage: trigger trigger: path/to/A except: - pipelines \u5f53\u4e14\u4ec5\u5f53\u4ece\u4e0a\u6e38\u4ed3\u5e93\u89e6\u53d1 B1 \u65f6\u624d\u6267\u884c build build: stage: build script: - ... only: - pipelines \u4ece\u4e0a\u6e38\u4ed3\u5e93\u89e6\u53d1 B1 \u4e14\u5f53\u524d\u5206\u652f\u662f release \u65f6\u624d\u6267\u884c deploy deploy: stage: deploy script: - echo \"Deploying application only if branch=release...\" rules: - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_BRANCH==\"release\" \u5176\u4e2d\uff0c CI_PIPELINE_SOURCE \u4e5f\u662f\u9ed8\u8ba4CI/CD\u53c2\u6570\uff0c\u8868\u793a\u6d41\u7a0b\u7684\u89e6\u53d1\u6e90\uff0c\u503c pipeline \u8868\u660e\u4ece\u4e0a\u6e38\u6d41\u7a0b\u89e6\u53d1\u800c\u6765\uff1b SOURCE_BRANCH \u4e5f\u662f\u4ece\u4e0a\u6e38\u6d41\u7a0b\u4f20\u9012\u8fc7\u6765\u7684\u8868\u660e\u5f53\u524d\u5206\u652f\u7684\u81ea\u5b9a\u4e49\u53c2\u6570\u3002 A \u4e2d get version number \u4efb\u52a1\u53ea\u6709\u5728 tag \u63d0\u4ea4\u6216\u8005\u4ece\u5176\u4ed6\u6d41\u7a0b\u89e6\u53d1\u800c\u6765\u624d\u6267\u884c get_version_number: stage: prepare script: - ... only: - /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - pipelines A \u4e2d trigger B1 \u4efb\u52a1\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u79cd\u60c5\u5f62\u4e4b\u4e00\u5373\u53ef\u6267\u884c\uff1a \u76f4\u63a5\u4ece A \u4ed3\u5e93 tag \u63d0\u4ea4 \u4ece\u5176\u4ed6\u6d41\u7a0b\u89e6\u53d1\u4e14\u81ea\u5b9a\u4e49\u53c2\u6570 SOURCE_PROJECT \u7684\u503c\u7b49\u4e8e B1 \u5373\u4ece B1 \u89e6\u53d1\u7684\u6d41\u7a0b trigger_b1: stage: trigger trigger: project: path/to/B1 branch: $TARGET_BRANCH rules: - if: $CI_COMMIT_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_PROJECT==\"B1\"","title":"\u4efb\u52a1\u6267\u884c\u6761\u4ef6"},{"location":"2022-01-27-GitLab-CI-CD%EF%BC%9A%E8%A7%A6%E5%8F%91%E8%B7%A8%E9%A1%B9%E7%9B%AEpipeline/#ymal","text":"\u8865\u5145\u4e00\u70b9\uff1a\u672c\u4f8b\u7684\u4ea7\u54c1\u7248\u672c\u53f7\u662f\u901a\u8fc7\u4fdd\u5b58\u6587\u4ef6\u7684\u5f62\u5f0f\u5728\u4e24\u4e2a\u6d41\u7a0b\u95f4\u4f20\u9012\u7684\uff0c\u56e0\u6b64\u9700\u8981\u4fdd\u8bc1\u5404\u6d41\u7a0b\u90fd\u5728\u540c\u4e00\u53f0gitlab-runner\u4e0a\u6267\u884c\u3002\u800c\u8fd9\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u5b9a\u76f8\u540c\u7684 tags \u6765\u5b9e\u73b0\u3002 \u6700\u540e\uff0c\u5206\u522b\u5217\u51fa\u5404\u4ed3\u5e93\u7684ymal\u6587\u4ef6\u3002 # .gitlab-ci.yml for project A variables: PROJECT_B1: \"B1\" PROJECT_B2: \"B2\" VERSION_FILE: /tmp/version TARGET_BRANCH: \"release\" stages: - prepare - trigger check_version: stage: prepare script: - VERSION=$(git describe --tags $(git rev-list --tags --max-count=1)) # recent tag - if [ \"$VERSION\" = \"\" ]; then VERSION=\"1.0.0\"; fi - VERSION=\"$VERSION.$(date +%Y%m%d)\" - echo $VERSION>$VERSION_FILE only: - /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - pipelines tags: - shell_runner trigger_b1: stage: trigger variables: SOURCE_BRANCH: $TARGET_BRANCH trigger: project: path/to/B1 branch: $TARGET_BRANCH rules: - if: $CI_COMMIT_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_PROJECT==$PROJECT_B1 trigger_b2: stage: trigger variables: SOURCE_BRANCH: $TARGET_BRANCH trigger: project: path/to/B2 branch: $TARGET_BRANCH rules: - if: $CI_COMMIT_TAG =~ /^([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_PROJECT==$PROJECT_B2 # .gitlab-ci.yml for project B1; same with B2 stages: - trigger - build - deploy trigger_a: variables: SOURCE_PROJECT: $CI_PROJECT_NAME TARGET_BRANCH: $CI_COMMIT_REF_NAME stage: trigger trigger: path/to/A except: - pipelines build: stage: build script: - VERSION=$(cat $VERSION_FILE) - echo $VERSION only: - pipelines tags: - shell_runner deploy: stage: deploy script: - echo \"Deploying application only if branch=release...\" rules: - if: $CI_PIPELINE_SOURCE==\"pipeline\" && $SOURCE_BRANCH==\"release\" tags: - shell_runner","title":"\u5b8c\u6574ymal\u6587\u4ef6"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/","text":"\u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 \u00b6 \u53d1\u5e03\u4e8e\uff1a2022-07-03 | \u5206\u7c7b\uff1a mathematics , machine learning \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08Spatial Pyramid Pooling\uff09\u65b9\u6cd5\u5173\u8054\u4e86\u4e0d\u5b9a\u5c3a\u5bf8\u8f93\u51fa\u7684\u5377\u79ef\u5c42\u548c\u56fa\u5b9a\u5927\u5c0f\u7684\u5168\u8fde\u63a5\u5c42\uff0c\u4e00\u65b9\u9762\u53ef\u4ee5\u9002\u5e94\u4e0d\u540c\u5c3a\u5bf8\u56fe\u7247\u8f93\u5165\uff0c\u907f\u514d\u4e86\u7edf\u4e00\u56fe\u7247\u5927\u5c0f\u7684\u524d\u5904\u7406\u64cd\u4f5c\uff1b\u53e6\u4e00\u65b9\u9762\u53ef\u4ee5\u63d0\u53d6\u4e0d\u540c\u5c3a\u5bf8\u7684\u7a7a\u95f4\u7279\u5f81\u4fe1\u606f\uff0c\u8fdb\u800c\u63d0\u5347\u6a21\u578b\u5bf9\u4e8e\u7a7a\u95f4\u5e03\u5c40\u548c\u7269\u4f53\u53d8\u5f62\u7684\u9c81\u68d2\u6027\u3002SPP\u7684\u57fa\u672c\u539f\u7406\u8bf7\u53c2\u8003 \u539f\u8bba\u6587 \u6216 \u76f8\u5173\u89e3\u8bfb \uff0c\u672c\u6587\u57fa\u4e8e\u8f93\u5165\u8f93\u51fa\u5c3a\u5bf8\uff0c\u5206\u6790SPP\u5173\u952e\u53c2\u6570\u4f8b\u5982\u7a97\u53e3\u5c3a\u5bf8\uff08kernel\uff09\u3001\u6b65\u957f\uff08stride\uff09\u53ca\u8fb9\u8ddd\uff08padding\uff09\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002 \u95ee\u9898\u63d0\u51fa \u00b6 \u5df2\u77e5\u5377\u79ef\u540e\u8f93\u51fa\u5c3a\u5bf8 (w, h) (w, h) \uff0c\u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\u540e\u76ee\u6807\u8f93\u51fa (n_w, n_h) (n_w, n_h) \uff0c\u8ba1\u7b97\u6c60\u5316\u5c42\u7684\u7a97\u53e3\u5c3a\u5bf8 (k_w, k_h) (k_w, k_h) \uff0c\u6b65\u957f (s_w, s_h) (s_w, s_h) \u53ca\u8fb9\u8ddd (p_w, p_h) (p_w, p_h) \u3002\u4e3a\u4e86\u7b80\u5316\u63cf\u8ff0\uff0c\u4ee5\u4e0b\u4ec5\u57fa\u4e8e\u5176\u4e2d\u4e00\u4e2a\u7ef4\u5ea6\u8ba1\u7b97\uff0c\u53e6\u4e00\u7ef4\u5ea6\u91c7\u7528\u5b8c\u5168\u76f8\u540c\u7684\u8ba1\u7b97\u516c\u5f0f\u3002\u56e0\u6b64\uff0c\u76f8\u5e94\u53c2\u6570\u7b80\u5316\u4e3a\uff1a \u5df2\u77e5\u8f93\u5165\u3001\u8f93\u51fa\u5c3a\u5bf8 w w \u548c n n \uff0c\u6c42\u6c60\u5316\u7a97\u53e3\u5c3a\u5bf8 (k) (k) \uff0c\u6b65\u957f (s) (s) \u53ca\u8fb9\u8ddd (p) (p) \u3002 \u5982\u679c\u6b63\u5411\u8ba1\u7b97\uff0c\u516c\u5f0f\u4e3a\uff1a n = \\left \\lfloor \\frac {w+2p-k} {s} \\right \\rfloor + 1 \\tag{1} n = \\left \\lfloor \\frac {w+2p-k} {s} \\right \\rfloor + 1 \\tag{1} \u5176\u4e2d \\lfloor x \\rfloor \\lfloor x \\rfloor \u8868\u793a\u5bf9 x x \u5411\u4e0b\u53d6\u6574\uff0c\u4f8b\u5982 \\lfloor 1.5 \\rfloor = 1 \\lfloor 1.5 \\rfloor = 1 \uff0c\u540c\u7406\u5411\u4e0a\u53d6\u6574\u7b26\u53f7\u53ca\u4f8b\u5b50\uff1a \\lceil 1.5 \\rceil = 2 \\lceil 1.5 \\rceil = 2 \u3002 \u539f\u59cb\u8bba\u6587\u516c\u5f0f \u00b6 \u539f\u8bba\u6587 \u4e2d\u7684\u8ba1\u7b97\u516c\u5f0f\uff1a k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad p = 0 \\tag{2} k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad p = 0 \\tag{2} \u6709\u4e9b\u89e3\u8bfb\u8bba\u6587\u7684\u535a\u6587\u6307\u51fa\u4e86\u95ee\u9898\u53ca\u53cd\u4f8b\uff1a \u53d6 w=7, n=4 w=7, n=4 \uff0c\u6839\u636e\u516c\u5f0f\uff082\uff09\u5f97\u51fa k=2,s=1,p=0 k=2,s=1,p=0 \uff0c \u7136\u800c\u5c06\u6c60\u5316\u53c2\u6570\u5e26\u5165\u516c\u5f0f\uff081\uff09\u5374\u5f97\u51fa\u77db\u76fe\u7684\u7ed3\u679c\uff1a n=5 n=5 \uff01 \u6ce8\u610f\uff1a \u8fd9\u662f\u4f5c\u8005\u4e3a\u8bba\u6587\u4e2d\u7279\u5b9a\u573a\u666f\u63d0\u51fa\u7684\uff0c\u786e\u5b9e\u5e76\u4e0d\u5177\u5907\uff08\u4f5c\u8005\u4e5f\u6ca1\u4e3b\u5f20\uff09\u5176\u901a\u7528\u6027\u3002 \u521d\u6b65\u4fee\u6b63\u7684\u516c\u5f0f \u00b6 \u53c2\u8003 \u535a\u6587 \uff0c\u7ed9\u51fa\u4e86\u5982\u4e0b\u901a\u7528\u6027\u66f4\u597d\u7684\u516c\u5f0f\uff1a k = s = \\left \\lceil \\frac {w} {n} \\right \\rceil \\\\\\\\ p = \\left \\lfloor \\frac {k*n-w+1} {2} \\right \\rfloor \\tag{3} k = s = \\left \\lceil \\frac {w} {n} \\right \\rceil \\\\\\\\ p = \\left \\lfloor \\frac {k*n-w+1} {2} \\right \\rfloor \\tag{3} \u5bf9\u4e0a\u4e00\u4e2a\u4f8b\u5b50 w=7, n=4 w=7, n=4 \uff0c\u6839\u636e\u516c\u5f0f\uff083\uff09\u53ef\u4ee5\u5f97\u51fa\u6b63\u786e\u7ed3\u679c\uff1a k=2,s=2,p=1 k=2,s=2,p=1 \u3002 \u4f46\u8fd8\u662f\u53ef\u4ee5\u627e\u5230\u6709\u95ee\u9898\u7684\u4f8b\u5b50\uff1a \u53d6 w=5, n=4 w=5, n=4 \uff0c\u6839\u636e\u516c\u5f0f\uff083\uff09\u5f97\u51fa k=2,s=2,p=2 k=2,s=2,p=2 \uff0c \u5e26\u5165\u516c\u5f0f\uff081\uff09\u9a8c\u8bc1\u6ca1\u95ee\u9898\uff0c\u4f46\u662f pytorch\u8981\u6c42 padding \u4e0d\u8d85\u8fc7 kernel \u7684\u4e00\u534a \u5373 k >= 2p k >= 2p \uff0c\u663e\u7136\u6b64\u5904\u4e0d\u6ee1\u8db3\u3002 \u53ef\u884c\u57df\u5206\u6790 \u00b6 \u4e3a\u4e86\u65b9\u4fbf\u5206\u6790\u8fd9\u4e2a\u95ee\u9898\uff0c\u5148\u6392\u9664\u4e24\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a \u5f53 n>w n>w \u65f6\uff0c\u4e0d\u7b26\u5408SPP\u7684\u7269\u7406\u610f\u4e49 \u5f53 n=1 n=1 \u5373\u8f93\u51fa\u4e3a1\u65f6\uff0c\u53d6\u7a97\u53e3\u6b63\u597d\u4e3a\u8f93\u5165\u5c3a\u5bf8\uff1a k=w, s=1, p=0 k=w, s=1, p=0 \u4e8e\u662f\u5728 w \\geq n \\gt 1 w \\geq n \\gt 1 \u6761\u4ef6\u4e0b\uff0c\u5217\u51fa\u4ee5\u4e0b\u9650\u5236\u6761\u4ef6/\u4e0d\u7b49\u5f0f\uff1a (n-1)*s+k-w \\leq 2p \\lt n*s+k-w \\tag{4-1} (n-1)*s+k-w \\leq 2p \\lt n*s+k-w \\tag{4-1} 0 \\leq 2p \\leq k \\tag{4-2} 0 \\leq 2p \\leq k \\tag{4-2} 1 \\leq s \\leq k \\leq w \\tag{4-3} 1 \\leq s \\leq k \\leq w \\tag{4-3} (n-1)*s+k \\geq w + p \\tag{4-4} (n-1)*s+k \\geq w + p \\tag{4-4} \u5176\u4e2d\uff0c \u4e0d\u7b49\u5f0f\uff084-1\uff09\u76f4\u63a5\u4ece\u7b49\u5f0f\uff081\uff09\u53bb\u6389\u53d6\u6574\u7b26\u53f7\u5f97\u5230\uff1b \u4e0d\u7b49\u5f0f\uff084-2\uff09\u907f\u514d\u5f15\u5165\u8fc7\u591a\u65e0\u610f\u4e49\u7684\u8fb9\u8ddd\u4fe1\u606f\uff0c\u4e5f\u662f pytorch \u4e2d\u7684\u4e00\u4e2a\u9650\u5236\uff1b \u4e0d\u7b49\u5f0f\uff084-3\uff09\u8981\u6c42\u6b65\u957f\u4e0d\u5927\u4e8e\u7a97\u53e3\u5927\u5c0f\uff0c\u5426\u5219\u8df3\u8fc7\u4e86\u6709\u6548\u533a\u57df\uff1b \u4e0d\u7b49\u5f0f\uff084-4\uff09\u5de6\u8fb9\u8868\u793a\u6c60\u5316\u64cd\u4f5c\u7684\u5b9e\u9645\u4f5c\u7528\u8303\u56f4\uff0c\u53f3\u8fb9\u8868\u793a\u7279\u5f81\u56fe\u7684\u6709\u6548\u4f4d\u7f6e\uff0c\u56e0\u6b64\u6574\u4e2a\u5f0f\u5b50\u8981\u6c42\u6c60\u5316\u64cd\u4f5c\u8986\u76d6\u6240\u6709\u6709\u6548\u533a\u57df\u3002 \u5c06\u4e0d\u7b49\u5f0f\uff084-1\uff09\u5de6\u534a\u90e8\u5206\u53d6\u6574\u5f97\u5230 p p \u7684\u8ba1\u7b97\u516c\u5f0f\uff1a p = \\left \\lceil \\frac {(n-1)*s + k - w} {2} \\right \\rceil \\tag{5} p = \\left \\lceil \\frac {(n-1)*s + k - w} {2} \\right \\rceil \\tag{5} \u5c06 k=s k=s \u4ee3\u5165\u4e0a\u5f0f\u5373\u53ef\u5f97\u5230\u516c\u5f0f\uff083\uff09\u4e2d\u8ba1\u7b97 p p \u7684\u90e8\u5206\uff0c\u8868\u660e\u4e0a\u5f0f\u66f4\u5177\u4e00\u822c\u6027\uff0c\u516c\u5f0f\uff083\uff09\u8ba1\u7b97 p p \u7684\u65b9\u6cd5\u53ea\u662f\u516c\u5f0f\uff085\uff09\u4e00\u4e2a\u7279\u4f8b\u3002 \u7ed3\u5408\uff084-1\uff09\u5de6\u534a\u90e8\u5206\u548c\uff084-2\uff09\u53f3\u534a\u90e8\u5206\uff1a k \\geq 2p \\geq (n-1)*s+k-w => s \\leq \\frac {w} {n-1} k \\geq 2p \\geq (n-1)*s+k-w => s \\leq \\frac {w} {n-1} \u7ed3\u5408\uff084-1\uff09\u53f3\u534a\u90e8\u5206\u548c\uff084-3\uff09\uff1a 0 \\leq 2p \\lt n*s+k-w \\leq n*k+k-w => k \\gt \\frac {w} {n+1} 0 \\leq 2p \\lt n*s+k-w \\leq n*k+k-w => k \\gt \\frac {w} {n+1} \u4e0d\u7b49\u5f0f\uff084-4\uff09\u7f29\u653e\u4e00\u4e0b\u53bb\u6389 p p \uff1a (n-1)*s+k \\geq w (n-1)*s+k \\geq w \u7efc\u5408\u5f97\u5230\uff1a \\begin{cases} 1 \\leq s \\leq \\frac {w} {n-1} \\\\\\\\ \\frac {w} {n+1} \\lt k \\leq w \\\\\\\\ k \\geq s \\\\\\\\ k \\geq (1-n)*s + w \\end{cases} \\tag{6} \\begin{cases} 1 \\leq s \\leq \\frac {w} {n-1} \\\\\\\\ \\frac {w} {n+1} \\lt k \\leq w \\\\\\\\ k \\geq s \\\\\\\\ k \\geq (1-n)*s + w \\end{cases} \\tag{6} \u6ce8\u610f\u5404\u4e2a\u53c2\u6570\u90fd\u662f\u975e\u8d1f\u6574\u6570\uff0c\u4f46\u6b64\u523b\u5148\u4e0d\u505a\u533a\u5206\uff0c\u76f4\u63a5\u7ebf\u6027\u89c4\u5212\u6c42\u89e3\u53ef\u884c\u57df\uff0c\u5f97\u5230\u4e0b\u56fe\u3002 \u663e\u7136\uff0c\u89e3\u53ef\u80fd\u4e0d\u552f\u4e00\u3002\u6211\u4eec\u5148\u5f97\u5230\u4e00\u4e2a\u7279\u5f81\u70b9 P_0(w/n, w/n) P_0(w/n, w/n) \uff0c\u7136\u540e\u57fa\u4e8e\u4e0d\u540c\u7684\u7b56\u7565\u6709\u4e0d\u540c\u7684\u9009\u62e9\uff1a \u5982\u679c\u6cbf\u7740\u7eff\u8272\u7bad\u5934\u65b9\u5411\u5f80 P_1 P_1 \u65b9\u5411\u8d70\uff0c\u7a97\u53e3\u5927\u5c0f\u59cb\u7ec8\u4e0e\u6b65\u957f\u76f8\u7b49\uff0c\u5373\u4f20\u7edf\u7684\u6c60\u5316\u6a21\u5f0f\u3002 \u5982\u679c\u6cbf\u7740\u9752\u8272\u7bad\u5934\u65b9\u5411\u5f80 P_2 P_2 \u65b9\u5411\u8d70\uff0c\u7a97\u53e3\u5927\u5c0f\u59cb\u7ec8\u5927\u4e8e\u6b65\u957f\uff0c\u5373\u5e26\u91cd\u53e0\u6a21\u5f0f\u7684\u6c60\u5316\u3002 \u4ee5 P_1 P_1 \u65b9\u5411\u4e3a\u4f8b\uff0c\u56e0\u4e3a k,s k,s \u90fd\u662f\u6b63\u6574\u6570\uff0c\u6211\u4eec\u53d6 P_0 P_0 \u53f3\u4fa7\u6700\u63a5\u8fd1\u7684\u6b63\u6574\u6570\u503c\uff0c\u5373 k = s = \\lceil w / n \\rceil k = s = \\lceil w / n \\rceil \uff0c\u4e8e\u662f\u5f97\u5230\u4e86\u7f51\u4e0a\u5e38\u89c1\u7684\u521d\u6b65\u4fee\u6b63\u7684\u516c\u5f0f\uff0c\u5373\u4e0a\u6587\u7684\u516c\u5f0f\uff083\uff09\u3002 \u81f3\u6b64\uff0c\u53ef\u4ee5\u7edf\u4e00\u4e0a\u6587\u63d0\u53ca\u7684\u8ba1\u7b97\u65b9\u6cd5\uff0c\u5e76\u4e14\u5b8c\u7f8e\u89e3\u91ca\u4ee5\u4e0b\u4e24\u4e2a\u95ee\u9898\uff1a \uff08a\uff09\u516c\u5f0f\uff083\uff09\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4e0d\u518d\u9002\u7528\uff1f \u00b6 \u5bf9\u7167\u53ef\u884c\u57df\u56fe\u5c31\u5f88\u597d\u89e3\u91ca\u4e86\u2014\u2014\u7eff\u8272\u7ebf\u6bb5\u4e0a\u53ef\u80fd\u4e0d\u5b58\u5728\u6574\u6570\u89e3\u3002 \u4f8b\u5982\u4f8b\u5b50\u4e2d w=5,n=4 w=5,n=4 \uff0c\u7eff\u8272\u7ebf\u6bb5\u4e24\u4e2a\u7aef\u70b9\u7684 s s \u5750\u6807\u5206\u522b\u4e3a 1.25 \u548c 1.667\uff0c\u4e8c\u8005\u4e4b\u95f4\u5e76\u4e0d\u5b58\u5728\u6b63\u6574\u6570\u3002 \u90a3\u4e48\uff0c\u516c\u5f0f\uff083\uff09\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\u624d\u9002\u7528\u5462\uff1f\u4ee4 w=a*n+b w=a*n+b \uff0c\u5176\u4e2d 0 \\leq b \\lt n 0 \\leq b \\lt n \uff0c\u5219 \\frac {w} {n-1} = \\frac {a*n+b} {n-1} = a + \\frac {a+b} {n-1} \\frac {w} {n-1} = \\frac {a*n+b} {n-1} = a + \\frac {a+b} {n-1} \u663e\u7136\uff0c w/(n-1) w/(n-1) \u7684\u6574\u6570\u90e8\u5206\u81f3\u5c11\u8fbe\u5230 a+1 a+1 \u5373 (a+b)/(n-1) \\geq 1 (a+b)/(n-1) \\geq 1 \u65f6\uff0c\u7eff\u8272\u7ebf\u6bb5\u6807\u6ce8\u7684\u53ef\u884c\u57df\u4e0a\u624d\u6709\u6574\u6570\u89e3\uff1a \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 \\geq n \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 \\geq n \u8fdb\u4e00\u6b65\u8003\u8651\u7aef\u70b9\u4e0a\u7684\u60c5\u51b5\uff0c\u5373\u4e0a\u5f0f\u53d6\u7b49\u53f7\uff0c\u6b64\u65f6 w/(n-1) w/(n-1) \u6070\u597d\u4e3a\u6574\u6570\uff0c\u4e14 k=s=w/(n-1) k=s=w/(n-1) \uff0c\u53c2\u8003\u516c\u5f0f\uff085\uff09\u53ef\u77e5\uff1a p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil = \\left \\lceil \\frac {w} {2 *(n-1)} \\right \\rceil = \\left \\lceil \\frac {k} {2} \\right \\rceil p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil = \\left \\lceil \\frac {w} {2 *(n-1)} \\right \\rceil = \\left \\lceil \\frac {k} {2} \\right \\rceil \u7ed3\u5408 k \\geq 2p k \\geq 2p \u7684\u9650\u5b9a\u6761\u4ef6\uff0c\u6b64\u65f6\u8981\u6c42 k k \u5373 w/(n-1) w/(n-1) \u5fc5\u987b\u4e3a\u5076\u6570\u3002 \u7efc\u4e0a\uff0c\u516c\u5f0f\uff083\uff09\u7684\u4f7f\u7528\u6761\u4ef6\uff1a t = \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 t = \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 t \\gt n \\quad \\lor \\quad \\left( t = n \\quad \\land \\quad w/(n-1) \\mod 2 = 0 \\right) \\tag{7} t \\gt n \\quad \\lor \\quad \\left( t = n \\quad \\land \\quad w/(n-1) \\mod 2 = 0 \\right) \\tag{7} \u5176\u4e2d\uff0c \\lor \\lor \u548c \\land \\land \u5206\u522b\u8868\u793a\u201c\u6216\u201d\u548c\u201c\u4e14\u201d\u3002 \uff08b\uff09\u5982\u4f55\u5904\u7406\u516c\u5f0f\uff083\uff09\u4e0d\u9002\u7528\u7684\u60c5\u51b5\uff1f \u00b6 \u5f53 w,n w,n \u4e0d\u6ee1\u8db3\u4e0d\u7b49\u5f0f\uff087\uff09\u65f6\uff0c\u516c\u5f0f\uff083\uff09\u5931\u6548\uff0c\u90a3\u5c31\u8d70 P_2 P_2 \u7684\u8def\u7ebf\uff0c\u5982\u9752\u8272\u7bad\u5934\u6240\u793a\uff1a \u6b64\u79cd\u60c5\u51b5\u4e0b\u5f80\u53f3\u663e\u7136\u4e0d\u5b58\u5728\u53ef\u884c\u7684 s s \u4e86\uff0c\u4e8e\u662f\u5411\u5de6\u4e00\u6b65\u5f97\u5230 P_0 P_0 \u9644\u8fd1\u7684 s s \uff1b \u7136\u540e\u5411\u4e0a\u589e\u5927 k k \u76f4\u5230\u6ee1\u8db3\u53ef\u884c\u57df\u8981\u6c42\u3002 \u4ee5\u4e0a\u8fc7\u7a0b\u53cd\u6620\u4e86\u516c\u5f0f\uff082\uff09\u7684\u601d\u8def\uff0c\u4f46\u662f\u4e3a\u4e86\u66f4\u5177\u901a\u7528\u6027\uff0c\u786e\u5b9a k k \u65f6\u9700\u8981\u68c0\u67e5\u662f\u5426\u843d\u5728\u53ef\u884c\u57df\u5185\u3002\u5c06\u516c\u5f0f\uff082\uff09\u4e2d s s \u7684\u8868\u8fbe\u5f0f\u4ee3\u5165\uff084-4\uff09\u7684\u7f29\u653e\u5f0f\u5f97\u5230 k k \uff0c\u7136\u540e\u5c06 k,s k,s \u4ee3\u5165\u516c\u5f0f\uff085\uff09\u8ba1\u7b97 p p \uff0c\u6700\u7ec8\u5f97\u5230\u516c\u5f0f\uff082\uff09\u7684\u66f4\u4e00\u822c\u5f62\u5f0f\uff1a s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 \\tag{8} s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 \\tag{8} \u56de\u5230 w=5,n=4 w=5,n=4 \u7684\u4f8b\u5b50\uff0c\u4ee3\u5165\u4e0a\u5f0f\u5f97\u5230 k=2, s=1, p=0 k=2, s=1, p=0 \uff0c\u6ee1\u8db3\u6240\u6709\u7ea6\u675f\u3002 \u6ce8\u610f\uff1a \u4e0a\u5f0f\u548c\u516c\u5f0f\uff082\uff09\u7684\u6700\u76f4\u63a5\u533a\u522b\u662f k k \u7684\u8ba1\u7b97\u65b9\u6cd5\u3002\u516c\u5f0f\uff082\uff09\u5728\u5b9a\u4e49 k,s k,s \u7684\u540c\u65f6\u5f3a\u884c\u8bbe\u5b9a p=0 p=0 \uff08\u6216\u8005\u8bf4\u5ffd\u7565\u4e86 p p \u7684\u8ba1\u7b97\uff09\uff0c\u5b9e\u9645\u4e0a\u4e09\u8005\u662f\u76f8\u4e92\u5173\u8054\u7684\u3002\u516c\u5f0f\uff088\uff09\u901a\u8fc7\u6784\u9020 k k \uff0c\u4f7f p=0 p=0 \u81ea\u7136\u5f97\u5230\u6ee1\u8db3\u3002 \u5b8c\u6574\u7b97\u6cd5 \u00b6 \u5df2\u77e5\u8f93\u5165\u3001\u8f93\u51fa\u5c3a\u5bf8 w w \u548c n n \uff08 w \\geq n w \\geq n \uff09\uff0c\u6c42SPP\u6c60\u5316\u5c42\u7684\u7a97\u53e3\u5c3a\u5bf8 (k) (k) \uff0c\u6b65\u957f (s) (s) \u53ca\u8fb9\u8ddd (p) (p) \u3002 \uff081\uff09\u5f53\u6ee1\u8db3\u4e0d\u7b49\u5f0f\uff087\uff09\u65f6\uff0c s = k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil s = k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil \uff082\uff09\u5f53\u4e0d\u6ee1\u8db3\u4e0d\u7b49\u5f0f\uff087\uff09\u65f6\uff0c s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 \u6ce8\u610f\uff1a\u4ee5\u4e0a\u7b97\u6cd5\u4f18\u5148\u9009\u62e9\u4f20\u7edf\u975e\u91cd\u53e0\u7684\u6c60\u5316\u65b9\u5f0f\uff0c\u53ea\u6709\u5728\u65e0\u6cd5\u6ee1\u8db3\u65f6\uff0c\u624d\u8003\u8651\u91cd\u53e0\u7684\u6c60\u5316\u65b9\u5f0f\u3002\u5982\u679c\u503e\u5411\u4e8e\u91cd\u53e0\u7684\u6c60\u5316\u65b9\u5f0f\uff0c\u5219\u76f4\u63a5\u9009\u62e9\u7b2c\uff082\uff09\u90e8\u5206\u8ba1\u7b97\u516c\u5f0f\u5373\u53ef\u3002","title":"\u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#spp","text":"\u53d1\u5e03\u4e8e\uff1a2022-07-03 | \u5206\u7c7b\uff1a mathematics , machine learning \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08Spatial Pyramid Pooling\uff09\u65b9\u6cd5\u5173\u8054\u4e86\u4e0d\u5b9a\u5c3a\u5bf8\u8f93\u51fa\u7684\u5377\u79ef\u5c42\u548c\u56fa\u5b9a\u5927\u5c0f\u7684\u5168\u8fde\u63a5\u5c42\uff0c\u4e00\u65b9\u9762\u53ef\u4ee5\u9002\u5e94\u4e0d\u540c\u5c3a\u5bf8\u56fe\u7247\u8f93\u5165\uff0c\u907f\u514d\u4e86\u7edf\u4e00\u56fe\u7247\u5927\u5c0f\u7684\u524d\u5904\u7406\u64cd\u4f5c\uff1b\u53e6\u4e00\u65b9\u9762\u53ef\u4ee5\u63d0\u53d6\u4e0d\u540c\u5c3a\u5bf8\u7684\u7a7a\u95f4\u7279\u5f81\u4fe1\u606f\uff0c\u8fdb\u800c\u63d0\u5347\u6a21\u578b\u5bf9\u4e8e\u7a7a\u95f4\u5e03\u5c40\u548c\u7269\u4f53\u53d8\u5f62\u7684\u9c81\u68d2\u6027\u3002SPP\u7684\u57fa\u672c\u539f\u7406\u8bf7\u53c2\u8003 \u539f\u8bba\u6587 \u6216 \u76f8\u5173\u89e3\u8bfb \uff0c\u672c\u6587\u57fa\u4e8e\u8f93\u5165\u8f93\u51fa\u5c3a\u5bf8\uff0c\u5206\u6790SPP\u5173\u952e\u53c2\u6570\u4f8b\u5982\u7a97\u53e3\u5c3a\u5bf8\uff08kernel\uff09\u3001\u6b65\u957f\uff08stride\uff09\u53ca\u8fb9\u8ddd\uff08padding\uff09\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002","title":"\u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#_1","text":"\u5df2\u77e5\u5377\u79ef\u540e\u8f93\u51fa\u5c3a\u5bf8 (w, h) (w, h) \uff0c\u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\u540e\u76ee\u6807\u8f93\u51fa (n_w, n_h) (n_w, n_h) \uff0c\u8ba1\u7b97\u6c60\u5316\u5c42\u7684\u7a97\u53e3\u5c3a\u5bf8 (k_w, k_h) (k_w, k_h) \uff0c\u6b65\u957f (s_w, s_h) (s_w, s_h) \u53ca\u8fb9\u8ddd (p_w, p_h) (p_w, p_h) \u3002\u4e3a\u4e86\u7b80\u5316\u63cf\u8ff0\uff0c\u4ee5\u4e0b\u4ec5\u57fa\u4e8e\u5176\u4e2d\u4e00\u4e2a\u7ef4\u5ea6\u8ba1\u7b97\uff0c\u53e6\u4e00\u7ef4\u5ea6\u91c7\u7528\u5b8c\u5168\u76f8\u540c\u7684\u8ba1\u7b97\u516c\u5f0f\u3002\u56e0\u6b64\uff0c\u76f8\u5e94\u53c2\u6570\u7b80\u5316\u4e3a\uff1a \u5df2\u77e5\u8f93\u5165\u3001\u8f93\u51fa\u5c3a\u5bf8 w w \u548c n n \uff0c\u6c42\u6c60\u5316\u7a97\u53e3\u5c3a\u5bf8 (k) (k) \uff0c\u6b65\u957f (s) (s) \u53ca\u8fb9\u8ddd (p) (p) \u3002 \u5982\u679c\u6b63\u5411\u8ba1\u7b97\uff0c\u516c\u5f0f\u4e3a\uff1a n = \\left \\lfloor \\frac {w+2p-k} {s} \\right \\rfloor + 1 \\tag{1} n = \\left \\lfloor \\frac {w+2p-k} {s} \\right \\rfloor + 1 \\tag{1} \u5176\u4e2d \\lfloor x \\rfloor \\lfloor x \\rfloor \u8868\u793a\u5bf9 x x \u5411\u4e0b\u53d6\u6574\uff0c\u4f8b\u5982 \\lfloor 1.5 \\rfloor = 1 \\lfloor 1.5 \\rfloor = 1 \uff0c\u540c\u7406\u5411\u4e0a\u53d6\u6574\u7b26\u53f7\u53ca\u4f8b\u5b50\uff1a \\lceil 1.5 \\rceil = 2 \\lceil 1.5 \\rceil = 2 \u3002","title":"\u95ee\u9898\u63d0\u51fa"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#_2","text":"\u539f\u8bba\u6587 \u4e2d\u7684\u8ba1\u7b97\u516c\u5f0f\uff1a k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad p = 0 \\tag{2} k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad p = 0 \\tag{2} \u6709\u4e9b\u89e3\u8bfb\u8bba\u6587\u7684\u535a\u6587\u6307\u51fa\u4e86\u95ee\u9898\u53ca\u53cd\u4f8b\uff1a \u53d6 w=7, n=4 w=7, n=4 \uff0c\u6839\u636e\u516c\u5f0f\uff082\uff09\u5f97\u51fa k=2,s=1,p=0 k=2,s=1,p=0 \uff0c \u7136\u800c\u5c06\u6c60\u5316\u53c2\u6570\u5e26\u5165\u516c\u5f0f\uff081\uff09\u5374\u5f97\u51fa\u77db\u76fe\u7684\u7ed3\u679c\uff1a n=5 n=5 \uff01 \u6ce8\u610f\uff1a \u8fd9\u662f\u4f5c\u8005\u4e3a\u8bba\u6587\u4e2d\u7279\u5b9a\u573a\u666f\u63d0\u51fa\u7684\uff0c\u786e\u5b9e\u5e76\u4e0d\u5177\u5907\uff08\u4f5c\u8005\u4e5f\u6ca1\u4e3b\u5f20\uff09\u5176\u901a\u7528\u6027\u3002","title":"\u539f\u59cb\u8bba\u6587\u516c\u5f0f"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#_3","text":"\u53c2\u8003 \u535a\u6587 \uff0c\u7ed9\u51fa\u4e86\u5982\u4e0b\u901a\u7528\u6027\u66f4\u597d\u7684\u516c\u5f0f\uff1a k = s = \\left \\lceil \\frac {w} {n} \\right \\rceil \\\\\\\\ p = \\left \\lfloor \\frac {k*n-w+1} {2} \\right \\rfloor \\tag{3} k = s = \\left \\lceil \\frac {w} {n} \\right \\rceil \\\\\\\\ p = \\left \\lfloor \\frac {k*n-w+1} {2} \\right \\rfloor \\tag{3} \u5bf9\u4e0a\u4e00\u4e2a\u4f8b\u5b50 w=7, n=4 w=7, n=4 \uff0c\u6839\u636e\u516c\u5f0f\uff083\uff09\u53ef\u4ee5\u5f97\u51fa\u6b63\u786e\u7ed3\u679c\uff1a k=2,s=2,p=1 k=2,s=2,p=1 \u3002 \u4f46\u8fd8\u662f\u53ef\u4ee5\u627e\u5230\u6709\u95ee\u9898\u7684\u4f8b\u5b50\uff1a \u53d6 w=5, n=4 w=5, n=4 \uff0c\u6839\u636e\u516c\u5f0f\uff083\uff09\u5f97\u51fa k=2,s=2,p=2 k=2,s=2,p=2 \uff0c \u5e26\u5165\u516c\u5f0f\uff081\uff09\u9a8c\u8bc1\u6ca1\u95ee\u9898\uff0c\u4f46\u662f pytorch\u8981\u6c42 padding \u4e0d\u8d85\u8fc7 kernel \u7684\u4e00\u534a \u5373 k >= 2p k >= 2p \uff0c\u663e\u7136\u6b64\u5904\u4e0d\u6ee1\u8db3\u3002","title":"\u521d\u6b65\u4fee\u6b63\u7684\u516c\u5f0f"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#_4","text":"\u4e3a\u4e86\u65b9\u4fbf\u5206\u6790\u8fd9\u4e2a\u95ee\u9898\uff0c\u5148\u6392\u9664\u4e24\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a \u5f53 n>w n>w \u65f6\uff0c\u4e0d\u7b26\u5408SPP\u7684\u7269\u7406\u610f\u4e49 \u5f53 n=1 n=1 \u5373\u8f93\u51fa\u4e3a1\u65f6\uff0c\u53d6\u7a97\u53e3\u6b63\u597d\u4e3a\u8f93\u5165\u5c3a\u5bf8\uff1a k=w, s=1, p=0 k=w, s=1, p=0 \u4e8e\u662f\u5728 w \\geq n \\gt 1 w \\geq n \\gt 1 \u6761\u4ef6\u4e0b\uff0c\u5217\u51fa\u4ee5\u4e0b\u9650\u5236\u6761\u4ef6/\u4e0d\u7b49\u5f0f\uff1a (n-1)*s+k-w \\leq 2p \\lt n*s+k-w \\tag{4-1} (n-1)*s+k-w \\leq 2p \\lt n*s+k-w \\tag{4-1} 0 \\leq 2p \\leq k \\tag{4-2} 0 \\leq 2p \\leq k \\tag{4-2} 1 \\leq s \\leq k \\leq w \\tag{4-3} 1 \\leq s \\leq k \\leq w \\tag{4-3} (n-1)*s+k \\geq w + p \\tag{4-4} (n-1)*s+k \\geq w + p \\tag{4-4} \u5176\u4e2d\uff0c \u4e0d\u7b49\u5f0f\uff084-1\uff09\u76f4\u63a5\u4ece\u7b49\u5f0f\uff081\uff09\u53bb\u6389\u53d6\u6574\u7b26\u53f7\u5f97\u5230\uff1b \u4e0d\u7b49\u5f0f\uff084-2\uff09\u907f\u514d\u5f15\u5165\u8fc7\u591a\u65e0\u610f\u4e49\u7684\u8fb9\u8ddd\u4fe1\u606f\uff0c\u4e5f\u662f pytorch \u4e2d\u7684\u4e00\u4e2a\u9650\u5236\uff1b \u4e0d\u7b49\u5f0f\uff084-3\uff09\u8981\u6c42\u6b65\u957f\u4e0d\u5927\u4e8e\u7a97\u53e3\u5927\u5c0f\uff0c\u5426\u5219\u8df3\u8fc7\u4e86\u6709\u6548\u533a\u57df\uff1b \u4e0d\u7b49\u5f0f\uff084-4\uff09\u5de6\u8fb9\u8868\u793a\u6c60\u5316\u64cd\u4f5c\u7684\u5b9e\u9645\u4f5c\u7528\u8303\u56f4\uff0c\u53f3\u8fb9\u8868\u793a\u7279\u5f81\u56fe\u7684\u6709\u6548\u4f4d\u7f6e\uff0c\u56e0\u6b64\u6574\u4e2a\u5f0f\u5b50\u8981\u6c42\u6c60\u5316\u64cd\u4f5c\u8986\u76d6\u6240\u6709\u6709\u6548\u533a\u57df\u3002 \u5c06\u4e0d\u7b49\u5f0f\uff084-1\uff09\u5de6\u534a\u90e8\u5206\u53d6\u6574\u5f97\u5230 p p \u7684\u8ba1\u7b97\u516c\u5f0f\uff1a p = \\left \\lceil \\frac {(n-1)*s + k - w} {2} \\right \\rceil \\tag{5} p = \\left \\lceil \\frac {(n-1)*s + k - w} {2} \\right \\rceil \\tag{5} \u5c06 k=s k=s \u4ee3\u5165\u4e0a\u5f0f\u5373\u53ef\u5f97\u5230\u516c\u5f0f\uff083\uff09\u4e2d\u8ba1\u7b97 p p \u7684\u90e8\u5206\uff0c\u8868\u660e\u4e0a\u5f0f\u66f4\u5177\u4e00\u822c\u6027\uff0c\u516c\u5f0f\uff083\uff09\u8ba1\u7b97 p p \u7684\u65b9\u6cd5\u53ea\u662f\u516c\u5f0f\uff085\uff09\u4e00\u4e2a\u7279\u4f8b\u3002 \u7ed3\u5408\uff084-1\uff09\u5de6\u534a\u90e8\u5206\u548c\uff084-2\uff09\u53f3\u534a\u90e8\u5206\uff1a k \\geq 2p \\geq (n-1)*s+k-w => s \\leq \\frac {w} {n-1} k \\geq 2p \\geq (n-1)*s+k-w => s \\leq \\frac {w} {n-1} \u7ed3\u5408\uff084-1\uff09\u53f3\u534a\u90e8\u5206\u548c\uff084-3\uff09\uff1a 0 \\leq 2p \\lt n*s+k-w \\leq n*k+k-w => k \\gt \\frac {w} {n+1} 0 \\leq 2p \\lt n*s+k-w \\leq n*k+k-w => k \\gt \\frac {w} {n+1} \u4e0d\u7b49\u5f0f\uff084-4\uff09\u7f29\u653e\u4e00\u4e0b\u53bb\u6389 p p \uff1a (n-1)*s+k \\geq w (n-1)*s+k \\geq w \u7efc\u5408\u5f97\u5230\uff1a \\begin{cases} 1 \\leq s \\leq \\frac {w} {n-1} \\\\\\\\ \\frac {w} {n+1} \\lt k \\leq w \\\\\\\\ k \\geq s \\\\\\\\ k \\geq (1-n)*s + w \\end{cases} \\tag{6} \\begin{cases} 1 \\leq s \\leq \\frac {w} {n-1} \\\\\\\\ \\frac {w} {n+1} \\lt k \\leq w \\\\\\\\ k \\geq s \\\\\\\\ k \\geq (1-n)*s + w \\end{cases} \\tag{6} \u6ce8\u610f\u5404\u4e2a\u53c2\u6570\u90fd\u662f\u975e\u8d1f\u6574\u6570\uff0c\u4f46\u6b64\u523b\u5148\u4e0d\u505a\u533a\u5206\uff0c\u76f4\u63a5\u7ebf\u6027\u89c4\u5212\u6c42\u89e3\u53ef\u884c\u57df\uff0c\u5f97\u5230\u4e0b\u56fe\u3002 \u663e\u7136\uff0c\u89e3\u53ef\u80fd\u4e0d\u552f\u4e00\u3002\u6211\u4eec\u5148\u5f97\u5230\u4e00\u4e2a\u7279\u5f81\u70b9 P_0(w/n, w/n) P_0(w/n, w/n) \uff0c\u7136\u540e\u57fa\u4e8e\u4e0d\u540c\u7684\u7b56\u7565\u6709\u4e0d\u540c\u7684\u9009\u62e9\uff1a \u5982\u679c\u6cbf\u7740\u7eff\u8272\u7bad\u5934\u65b9\u5411\u5f80 P_1 P_1 \u65b9\u5411\u8d70\uff0c\u7a97\u53e3\u5927\u5c0f\u59cb\u7ec8\u4e0e\u6b65\u957f\u76f8\u7b49\uff0c\u5373\u4f20\u7edf\u7684\u6c60\u5316\u6a21\u5f0f\u3002 \u5982\u679c\u6cbf\u7740\u9752\u8272\u7bad\u5934\u65b9\u5411\u5f80 P_2 P_2 \u65b9\u5411\u8d70\uff0c\u7a97\u53e3\u5927\u5c0f\u59cb\u7ec8\u5927\u4e8e\u6b65\u957f\uff0c\u5373\u5e26\u91cd\u53e0\u6a21\u5f0f\u7684\u6c60\u5316\u3002 \u4ee5 P_1 P_1 \u65b9\u5411\u4e3a\u4f8b\uff0c\u56e0\u4e3a k,s k,s \u90fd\u662f\u6b63\u6574\u6570\uff0c\u6211\u4eec\u53d6 P_0 P_0 \u53f3\u4fa7\u6700\u63a5\u8fd1\u7684\u6b63\u6574\u6570\u503c\uff0c\u5373 k = s = \\lceil w / n \\rceil k = s = \\lceil w / n \\rceil \uff0c\u4e8e\u662f\u5f97\u5230\u4e86\u7f51\u4e0a\u5e38\u89c1\u7684\u521d\u6b65\u4fee\u6b63\u7684\u516c\u5f0f\uff0c\u5373\u4e0a\u6587\u7684\u516c\u5f0f\uff083\uff09\u3002 \u81f3\u6b64\uff0c\u53ef\u4ee5\u7edf\u4e00\u4e0a\u6587\u63d0\u53ca\u7684\u8ba1\u7b97\u65b9\u6cd5\uff0c\u5e76\u4e14\u5b8c\u7f8e\u89e3\u91ca\u4ee5\u4e0b\u4e24\u4e2a\u95ee\u9898\uff1a","title":"\u53ef\u884c\u57df\u5206\u6790"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#a3","text":"\u5bf9\u7167\u53ef\u884c\u57df\u56fe\u5c31\u5f88\u597d\u89e3\u91ca\u4e86\u2014\u2014\u7eff\u8272\u7ebf\u6bb5\u4e0a\u53ef\u80fd\u4e0d\u5b58\u5728\u6574\u6570\u89e3\u3002 \u4f8b\u5982\u4f8b\u5b50\u4e2d w=5,n=4 w=5,n=4 \uff0c\u7eff\u8272\u7ebf\u6bb5\u4e24\u4e2a\u7aef\u70b9\u7684 s s \u5750\u6807\u5206\u522b\u4e3a 1.25 \u548c 1.667\uff0c\u4e8c\u8005\u4e4b\u95f4\u5e76\u4e0d\u5b58\u5728\u6b63\u6574\u6570\u3002 \u90a3\u4e48\uff0c\u516c\u5f0f\uff083\uff09\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\u624d\u9002\u7528\u5462\uff1f\u4ee4 w=a*n+b w=a*n+b \uff0c\u5176\u4e2d 0 \\leq b \\lt n 0 \\leq b \\lt n \uff0c\u5219 \\frac {w} {n-1} = \\frac {a*n+b} {n-1} = a + \\frac {a+b} {n-1} \\frac {w} {n-1} = \\frac {a*n+b} {n-1} = a + \\frac {a+b} {n-1} \u663e\u7136\uff0c w/(n-1) w/(n-1) \u7684\u6574\u6570\u90e8\u5206\u81f3\u5c11\u8fbe\u5230 a+1 a+1 \u5373 (a+b)/(n-1) \\geq 1 (a+b)/(n-1) \\geq 1 \u65f6\uff0c\u7eff\u8272\u7ebf\u6bb5\u6807\u6ce8\u7684\u53ef\u884c\u57df\u4e0a\u624d\u6709\u6574\u6570\u89e3\uff1a \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 \\geq n \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 \\geq n \u8fdb\u4e00\u6b65\u8003\u8651\u7aef\u70b9\u4e0a\u7684\u60c5\u51b5\uff0c\u5373\u4e0a\u5f0f\u53d6\u7b49\u53f7\uff0c\u6b64\u65f6 w/(n-1) w/(n-1) \u6070\u597d\u4e3a\u6574\u6570\uff0c\u4e14 k=s=w/(n-1) k=s=w/(n-1) \uff0c\u53c2\u8003\u516c\u5f0f\uff085\uff09\u53ef\u77e5\uff1a p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil = \\left \\lceil \\frac {w} {2 *(n-1)} \\right \\rceil = \\left \\lceil \\frac {k} {2} \\right \\rceil p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil = \\left \\lceil \\frac {w} {2 *(n-1)} \\right \\rceil = \\left \\lceil \\frac {k} {2} \\right \\rceil \u7ed3\u5408 k \\geq 2p k \\geq 2p \u7684\u9650\u5b9a\u6761\u4ef6\uff0c\u6b64\u65f6\u8981\u6c42 k k \u5373 w/(n-1) w/(n-1) \u5fc5\u987b\u4e3a\u5076\u6570\u3002 \u7efc\u4e0a\uff0c\u516c\u5f0f\uff083\uff09\u7684\u4f7f\u7528\u6761\u4ef6\uff1a t = \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 t = \\left \\lfloor \\frac {w} {n} \\right \\rfloor + \\left(w \\mod n\\right) + 1 t \\gt n \\quad \\lor \\quad \\left( t = n \\quad \\land \\quad w/(n-1) \\mod 2 = 0 \\right) \\tag{7} t \\gt n \\quad \\lor \\quad \\left( t = n \\quad \\land \\quad w/(n-1) \\mod 2 = 0 \\right) \\tag{7} \u5176\u4e2d\uff0c \\lor \\lor \u548c \\land \\land \u5206\u522b\u8868\u793a\u201c\u6216\u201d\u548c\u201c\u4e14\u201d\u3002","title":"\uff08a\uff09\u516c\u5f0f\uff083\uff09\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4e0d\u518d\u9002\u7528\uff1f"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#b3","text":"\u5f53 w,n w,n \u4e0d\u6ee1\u8db3\u4e0d\u7b49\u5f0f\uff087\uff09\u65f6\uff0c\u516c\u5f0f\uff083\uff09\u5931\u6548\uff0c\u90a3\u5c31\u8d70 P_2 P_2 \u7684\u8def\u7ebf\uff0c\u5982\u9752\u8272\u7bad\u5934\u6240\u793a\uff1a \u6b64\u79cd\u60c5\u51b5\u4e0b\u5f80\u53f3\u663e\u7136\u4e0d\u5b58\u5728\u53ef\u884c\u7684 s s \u4e86\uff0c\u4e8e\u662f\u5411\u5de6\u4e00\u6b65\u5f97\u5230 P_0 P_0 \u9644\u8fd1\u7684 s s \uff1b \u7136\u540e\u5411\u4e0a\u589e\u5927 k k \u76f4\u5230\u6ee1\u8db3\u53ef\u884c\u57df\u8981\u6c42\u3002 \u4ee5\u4e0a\u8fc7\u7a0b\u53cd\u6620\u4e86\u516c\u5f0f\uff082\uff09\u7684\u601d\u8def\uff0c\u4f46\u662f\u4e3a\u4e86\u66f4\u5177\u901a\u7528\u6027\uff0c\u786e\u5b9a k k \u65f6\u9700\u8981\u68c0\u67e5\u662f\u5426\u843d\u5728\u53ef\u884c\u57df\u5185\u3002\u5c06\u516c\u5f0f\uff082\uff09\u4e2d s s \u7684\u8868\u8fbe\u5f0f\u4ee3\u5165\uff084-4\uff09\u7684\u7f29\u653e\u5f0f\u5f97\u5230 k k \uff0c\u7136\u540e\u5c06 k,s k,s \u4ee3\u5165\u516c\u5f0f\uff085\uff09\u8ba1\u7b97 p p \uff0c\u6700\u7ec8\u5f97\u5230\u516c\u5f0f\uff082\uff09\u7684\u66f4\u4e00\u822c\u5f62\u5f0f\uff1a s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 \\tag{8} s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 \\tag{8} \u56de\u5230 w=5,n=4 w=5,n=4 \u7684\u4f8b\u5b50\uff0c\u4ee3\u5165\u4e0a\u5f0f\u5f97\u5230 k=2, s=1, p=0 k=2, s=1, p=0 \uff0c\u6ee1\u8db3\u6240\u6709\u7ea6\u675f\u3002 \u6ce8\u610f\uff1a \u4e0a\u5f0f\u548c\u516c\u5f0f\uff082\uff09\u7684\u6700\u76f4\u63a5\u533a\u522b\u662f k k \u7684\u8ba1\u7b97\u65b9\u6cd5\u3002\u516c\u5f0f\uff082\uff09\u5728\u5b9a\u4e49 k,s k,s \u7684\u540c\u65f6\u5f3a\u884c\u8bbe\u5b9a p=0 p=0 \uff08\u6216\u8005\u8bf4\u5ffd\u7565\u4e86 p p \u7684\u8ba1\u7b97\uff09\uff0c\u5b9e\u9645\u4e0a\u4e09\u8005\u662f\u76f8\u4e92\u5173\u8054\u7684\u3002\u516c\u5f0f\uff088\uff09\u901a\u8fc7\u6784\u9020 k k \uff0c\u4f7f p=0 p=0 \u81ea\u7136\u5f97\u5230\u6ee1\u8db3\u3002","title":"\uff08b\uff09\u5982\u4f55\u5904\u7406\u516c\u5f0f\uff083\uff09\u4e0d\u9002\u7528\u7684\u60c5\u51b5\uff1f"},{"location":"2022-07-03-%E7%A9%BA%E9%97%B4%E9%87%91%E5%AD%97%E5%A1%94%E6%B1%A0%E5%8C%96%EF%BC%88SPP%EF%BC%89%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97/#_5","text":"\u5df2\u77e5\u8f93\u5165\u3001\u8f93\u51fa\u5c3a\u5bf8 w w \u548c n n \uff08 w \\geq n w \\geq n \uff09\uff0c\u6c42SPP\u6c60\u5316\u5c42\u7684\u7a97\u53e3\u5c3a\u5bf8 (k) (k) \uff0c\u6b65\u957f (s) (s) \u53ca\u8fb9\u8ddd (p) (p) \u3002 \uff081\uff09\u5f53\u6ee1\u8db3\u4e0d\u7b49\u5f0f\uff087\uff09\u65f6\uff0c s = k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil s = k = \\left \\lceil \\frac {w} {n} \\right \\rceil, \\quad p = \\left \\lceil \\frac {n*k - w} {2} \\right \\rceil \uff082\uff09\u5f53\u4e0d\u6ee1\u8db3\u4e0d\u7b49\u5f0f\uff087\uff09\u65f6\uff0c s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 s = \\left \\lfloor \\frac {w} {n} \\right \\rfloor, \\quad k = w - (n-1)*s, \\quad p = 0 \u6ce8\u610f\uff1a\u4ee5\u4e0a\u7b97\u6cd5\u4f18\u5148\u9009\u62e9\u4f20\u7edf\u975e\u91cd\u53e0\u7684\u6c60\u5316\u65b9\u5f0f\uff0c\u53ea\u6709\u5728\u65e0\u6cd5\u6ee1\u8db3\u65f6\uff0c\u624d\u8003\u8651\u91cd\u53e0\u7684\u6c60\u5316\u65b9\u5f0f\u3002\u5982\u679c\u503e\u5411\u4e8e\u91cd\u53e0\u7684\u6c60\u5316\u65b9\u5f0f\uff0c\u5219\u76f4\u63a5\u9009\u62e9\u7b2c\uff082\uff09\u90e8\u5206\u8ba1\u7b97\u516c\u5f0f\u5373\u53ef\u3002","title":"\u5b8c\u6574\u7b97\u6cd5"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/","text":"\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 \u00b6 \u53d1\u5e03\u4e8e\uff1a2022-10-22 | \u5206\u7c7b\uff1a mathematics , optimization \u6700\u8fd1\u770b\u4e86\u4e00\u4e9b\u5fae\u7535\u7f51\u4f18\u5316\u8c03\u5ea6\u7684\u8bba\u6587\uff0c\u82e6\u4e8e\u65e0\u4ece\u4e0b\u624b\u4e4b\u9645\uff0c\u770b\u5230\u4e00\u9053\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u76f8\u5173\u7684\u6570\u5b66\u5efa\u6a21\u9898\uff1b\u9898\u76ee\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u98ce\u5149\u50a8\u5fae\u7535\u7f51\u573a\u666f\u53ca\u6d4b\u8bd5\u6570\u636e\uff0c\u6b63\u597d\u62ff\u6765\u7ec3\u624b\u3002\u672c\u6587\u57fa\u4e8ePython\u7b2c\u4e09\u65b9\u5e93 PuLP \u5b9e\u73b0\u9898\u76ee\u7684\u6df7\u5408\u6574\u6570\u89c4\u5212\u6a21\u578b\uff0c\u5e76\u4f7f\u7528\u9ed8\u8ba4\u7684 CBC \u6c42\u89e3\u5668\u6c42\u89e3\u3002\u8f93\u5165\u6570\u636e\u53ca\u6c47\u603b\u4ee3\u7801\uff0c\u53c2\u89c1\u6587\u672b\u3002 \u95ee\u9898\u63cf\u8ff0 \u00b6 \u95ee\u9898\u51fa\u81ea\u7b2c\u5341\u5c4a\u201c\u4e2d\u56fd\u7535\u673a\u5de5\u7a0b\u5b66\u4f1a\u676f\u201d\u5168\u56fd\u5927\u5b66\u751f\u7535\u5de5\u6570\u5b66\u5efa\u6a21\u7ade\u8d5bA\u9898\uff1a\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u3002 \u4e0b\u56fe\u793a\u610f\u4e86\u4e00\u4e2a\u542b\u6709\u98ce\u673a\u3001\u5149\u4f0f\u3001\u84c4\u7535\u6c60\u53ca\u5e38\u89c1\u8d1f\u8377\u7684\u5fae\u7535\u7f51\u7cfb\u7edf\u3002\u65e5\u524d\u7ecf\u6d4e\u8c03\u5ea6\u95ee\u9898\u662f\u6307\u5728\u5bf9\u98ce\u673a\u51fa\u529b\u3001\u5149\u4f0f\u51fa\u529b\u3001\u5e38\u89c4\u8d1f\u8377\u8fdb\u884c\u65e5\u524d\uff08\u672a\u676524h\uff09\u9884\u6d4b\u7684\u57fa\u7840\u4e0a\uff0c\u8003\u8651\u7535\u7f51\u6d4b\u7684\u5206\u65f6\u7535\u4ef7\uff0c\u5145\u5206\u5229\u7528\u5fae\u7f51\u4e2d\u7684\u84c4\u7535\u6c60\u7b49\u53ef\u8c03\u63a7\u624b\u6bb5\uff0c\u4f7f\u5fae\u7535\u7f51\u8fd0\u884c\u7684\u7ecf\u6d4e\u6027\u6700\u4f18\u3002 \u9898\u76ee\u8981\u6c42\u5728\u5982\u4e0b\u5df2\u77e5\u6761\u4ef6\u4e0b\uff0c\u6c42\u4e0d\u540c\u8c03\u5ea6\u65b9\u6848\u7684\u5e73\u5747\u7528\u7535\u6210\u672c\uff1a \u672a\u676524h\u3001\u6bcf\u969415min\u517196\u4e2a\u65f6\u95f4\u70b9\u7684\u8d1f\u8377\u3001\u5149\u4f0f\u3001\u98ce\u673a\u51fa\u529b\u9884\u6d4b\uff0c\u53ca\u5206\u65f6\u7535\u4ef7\u6570\u636e\uff1b \u98ce\u673a\u5bb9\u91cf250kW\uff0c\u53d1\u7535\u6210\u672c0.52\u5143/kWh\uff1b \u5149\u4f0f\u5bb9\u91cf150kW\uff0c\u53d1\u7535\u6210\u672c0.75\u5143/kWh\uff1b \u84c4\u7535\u6c60\u5bb9\u91cf300kWh\uff1bSOC\u521d\u59cb\u503c0.4\uff0c\u8fd0\u884c\u8303\u56f4[0.3, 0.95]\uff1b\u7531\u5145\u7535\u81f3\u653e\u7535\u6210\u4e3a\u4e3a0.2\u5143/kWh\uff1b\u65e5\u5145\u653e\u7535\u6b21\u6570\u9650\u5236\u5747\u4e3a8\uff1b\u5ffd\u7565\u84c4\u7535\u6c60\u635f\u8017\uff1b \u5b8c\u6574\u95ee\u9898\u63cf\u8ff0\u53c2\u8003\uff1a \u7b2c\u5341\u5c4a\u201c\u4e2d\u56fd\u7535\u673a\u5de5\u7a0b\u5b66\u4f1a\u676f\u201d\u5168\u56fd\u5927\u5b66\u751f\u7535\u5de5\u6570\u5b66\u5efa\u6a21\u7ade\u8d5b A \u9898\uff1a\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6 \u3002\u7b97\u4f8b\u6709\u4ee3\u7801\uff080\uff09 \u98ce\u5149\u50a8\u4f18\u5316\u8c03\u5ea6\u6a21\u578b \u00b6 \u9898\u76ee\u6d89\u53ca\u7535\u7f51\u3001\u65b0\u80fd\u6e90\uff08\u98ce\u673a\u3001\u5149\u4f0f\uff09\u3001\u84c4\u7535\u6c60\u53ca\u8d1f\u8377\u56db\u7c7b\u8d44\u6e90\uff0c\u6211\u4eec\u4f9d\u6b21\u5efa\u7acb\u5176\u7ebf\u6027\u89c4\u5212\u6a21\u578b\uff0c\u7136\u540e\u4ea4\u7ed9\u6c42\u89e3\u5668\u6c42\u89e3\u3002\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u6a21\u578b\u5305\u542b\uff1a \u8bbe\u8ba1\u53d8\u91cf\uff1a\u5404\u7c7b\u8d44\u6e90\u7684\u5b9e\u65f6\u51fa\u529b\u6570\u636e \u7ea6\u675f\u6761\u4ef6\uff1a\u80fd\u91cf\u5e73\u8861\u53ca\u5404\u7c7b\u8d44\u6e90\u5e94\u8be5\u6ee1\u8db3\u7684\u6280\u672f\u53c2\u6570\uff0c\u4f8b\u5982\u84c4\u7535\u6c60\u7684\u5bb9\u91cf\u9650\u5236\u3001SOC\u9650\u5236\u3001\u5145\u653e\u7535\u6b21\u6570\u9650\u5236\u7b49 \u76ee\u6807\u51fd\u6570\uff1a\u8fd0\u884c\u6210\u672c\uff0c\u5177\u4f53\u5230\u672c\u9898\u5373\u7528\u7535\u6210\u672c \u672c\u6587\u57fa\u4e8e Python \u7b2c\u4e09\u65b9\u5e93 PuLP \u5b9e\u73b0\u3002 PuLP \u662f\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u95ee\u9898\u5efa\u6a21\u5e93\uff0c\u5c06\u6570\u5b66\u6a21\u578b\u8f6c\u6362\u4e3a MPS \u6216\u8005 LP \u6587\u4ef6\uff0c\u7136\u540e\u8c03\u7528 LP \u6c42\u89e3\u5668\u5982 CBC\u3001GLPK\u3001CPLEX\u3001Gurobi \u7b49\u6c42\u89e3\u3002\u5177\u4f53\u7528\u6cd5\u53c2\u8003\u4e0b\u9762\u94fe\u63a5\uff0c\u672c\u6587\u4e0d\u518d\u8d58\u8ff0\u3002 PuLP Documentation Python\u6c42\u89e3\u7ebf\u6027\u89c4\u5212\u2014\u2014PuLP\u4f7f\u7528\u6559\u7a0b \u5f00\u59cb\u4e4b\u524d\u5148\u62bd\u8c61\u4e00\u4e2a\u6a21\u578b\u57fa\u7c7b\uff0c\u8868\u793a\u5404\u7c7b\u8c03\u5ea6\u8bbe\u5907\uff0c\u5305\u542b\u540d\u79f0\u3001\u5bb9\u91cf\u3001\u4f7f\u7528\u6210\u672c\u7b49\u57fa\u672c\u5c5e\u6027\uff0c\u540c\u65f6\u63d0\u4f9b\u4e00\u4e2a create_model() \u65b9\u6cd5\uff0c\u7528\u4e8e\u5b9e\u73b0\u8bbe\u8ba1\u53d8\u91cf\u3001\u7ea6\u675f\u6761\u4ef6\u3001\u76ee\u6807\u51fd\u6570\u7b49\u7ebf\u6027\u89c4\u5212\u6a21\u578b\u4e09\u8981\u7d20\u3002\u6a21\u578b\u6c42\u89e3\u540e\uff0c\u8c03\u7528 output \u5c5e\u6027\u83b7\u53d6\u53d8\u91cf\u503c\uff0c\u5373\u6bcf\u4e2a\u65f6\u523b\u7684\u51fa\u529b\u3002 import pulp import numpy as np class Model: def __init__(self, name:str, capacity:float, # resource capacity unit_cost:float): # unit cost when using the energy '''Base class for resource model, e.g., Grid, Renewable and Storage.''' # technical parameters self.name = name self.capacity = capacity self.unit_cost = unit_cost # linear programming model: variables, constraints and objective self.variables = None self.constraints = None self.objective = None def create_model(self, time_points:int, dt:float): '''How to create the LP model.''' raise NotImplementedError @property def output(self): return np.array([v.value() for v in self.variables]) \u63a5\u4e0b\u6765\u4f9d\u6b21\u5efa\u7acb\u7535\u7f51\u3001\u65b0\u80fd\u6e90\uff08\u98ce\u673a\u3001\u5149\u4f0f\uff09\u53ca\u84c4\u7535\u6c60\u7684\u6a21\u578b\u3002 (1) \u7535\u7f51\u6a21\u578b \u00b6 \u7535\u7f51\u6a21\u578b\u7ee7\u627f\u81ea Model \u57fa\u7c7b\uff0c\u540c\u65f6\u65b0\u589e\u4e86 \u5356\u7535\u6536\u76ca \u5c5e\u6027\uff0c\u5e76\u4e14\u6ee1\u8db3\u5bb9\u91cf\u7ea6\u675f\u5373\u6bcf\u4e2a\u65f6\u523b\u7684\u51fa\u529b\u4e0d\u80fd\u8d85\u8fc7\u9650\u5b9a\u503c\uff0c\u76ee\u6807\u51fd\u6570\u4e3a\u8fd0\u884c\u6210\u672c\u5373\u7528\u7535\u8d39\u7528\u4e0e\u5356\u7535\u6536\u76ca\u7684\u5dee\u503c\u3002 \u76f4\u89c2\u5730\uff0c\u4efb\u610f\u65f6\u523b\u53ef\u4ee5\u7528\u4e00\u4e2a\u53d8\u91cf p^i p^i \u6765\u8868\u793a\u7535\u7f51\u7684\u51fa\u529b\uff1a\u6b63\u503c\u8868\u793a\u4ece\u7535\u7f51\u4e70\u7535\uff0c\u6216\u8005\u8d1f\u503c\u8868\u793a\u5356\u7535\u7ed9\u7535\u7f51\u3002\u4f46\u662f\uff0c \u4e8b\u5148\u5e76\u4e0d\u77e5\u9053 p^i p^i \u7684\u6b63\u8d1f \uff0c\u4e5f\u5c31\u6ca1\u6cd5\u8ba1\u7b97\u6b64\u523b\u7684\u8fd0\u884c\u6210\u672c\uff08\u4e0d\u80fd\u5c06\u7ebf\u6027\u89c4\u5212\u53d8\u91cf\u76f4\u63a5\u7528\u4e8e if-else \u8bed\u53e5\u4e2d\uff09\u3002\u56e0\u6b64\uff0c\u5f15\u5165\u4e70\u7535\u3001\u5356\u7535\u4e24\u4e2a\u4e2d\u95f4\u53d8\u91cf\u6765\u5206\u5f00\u63cf\u8ff0\uff1a p^i_f \\geq 0 p^i_f \\geq 0 \u8868\u793a i i \u65f6\u523b\u4ece\u7535\u7f51\u4e70\u7535\u91cf\uff1b p^i_t \\geq 0 p^i_t \\geq 0 \u8868\u793a i i \u65f6\u523b\u5411\u7535\u7f51\u5356\u7535\u91cf\uff1b \u56e0\u4e3a\u540c\u4e00\u65f6\u523b\u7535\u6d41\u53ea\u80fd\u5355\u5411\u6d41\u52a8\uff0c\u5373 p^i_f p^i_f \u548c p^i_t p^i_t \u81f3\u5c11\u6709\u4e00\u4e2a\u7b49\u4e8e0\uff1a p^i_f * p^i_t=0 p^i_f * p^i_t=0 \u3002 \u4f46\u8fd9\u5e76\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u7ebf\u6027\u7ea6\u675f\uff0c\u9700\u8981\u518d\u5f15\u5165\u4e00\u4e2a 0-1 \u53d8\u91cf\uff1a b_i=\\{0\uff0c1\\} b_i=\\{0\uff0c1\\} \uff1a1 \u8868\u793a\u4ece\u7535\u7f51\u4e70\u7535\u5373 p^i_t=0 p^i_t=0 \uff0c0 \u8868\u793a\u5356\u7535\u5230\u7535\u7f51\u5373 p^i_f=0 p^i_f=0 \u4e8e\u662f\u7ebf\u6027\u7ea6\u675f\u8868\u793a\u4e3a\uff1a 0 \\leq p^i_f \\leq b^i * C \\\\ 0 \\leq p^i_t \\leq (1-b^i) * C \\\\ 0 \\leq p^i_f \\leq b^i * C \\\\ 0 \\leq p^i_t \\leq (1-b^i) * C \\\\ \u5176\u4e2d\uff0c C C \u4e3a\u7535\u7f51\u5bb9\u91cf\uff08\u4ea4\u6362\u529f\u7387\uff09\u9650\u5236\u503c\u3002 \u6700\u7ec8\uff0c\u7535\u7f51 i i \u65f6\u523b\u5b9e\u9645\u51fa\u529b p^i p^i \u53ca\u7528\u7535\u6210\u672c\uff08\u4e70\u7535\u6216\u5356\u7535\uff09 c^i c^i \uff1a p^i = p^i_f - p^i_t \\\\ c^i = p^i_f * u_1 * dt - p^i_t * u_2 * dt p^i = p^i_f - p^i_t \\\\ c^i = p^i_f * u_1 * dt - p^i_t * u_2 * dt \u5176\u4e2d\uff0c u_1,u_2 u_1,u_2 \u5206\u522b\u4e3a\u8be5\u65f6\u523b\u5355\u4f4d\u4e70\u7535\u6210\u672c\u3001\u5356\u7535\u6536\u76ca\uff08\u5143/kWh\uff09\uff0c dt dt \u4e3a\u65f6\u95f4\u6b65\u957f\u3002 class Grid(Model): def __init__(self, name:str, capacity:float, unit_cost:np.ndarray, # unit cost when buying electricity from utility grid unit_profit:np.ndarray): # unit profit when selling electricity to utility grid super().__init__(name, capacity, unit_cost) self.unit_profit = unit_profit def create_model(self, time_points:int, dt:float): # define variables at each time point vars_from = [pulp.LpVariable(name=f'{self.name}_from_{i}', lowBound=0) for i in range(time_points)] vars_to = [pulp.LpVariable(name=f'{self.name}_to_{i}', lowBound=0) for i in range(time_points)] self.variables = [v1-v2 for v1,v2 in zip(vars_from, vars_to)] # constraints: capacity limit # 0<=var_from<=C*b # 0<=var_to<=C*(1-b) self.constraints = [] vars_b = [pulp.LpVariable(name=f'{self.name}_binary_{i}', cat=pulp.LpInteger) for i in range(time_points)] for v1,v2,b in zip(vars_from, vars_to, vars_b): self.constraints.append(v1<=self.capacity*b) self.constraints.append(v2<=self.capacity*(1-b)) # objective self.objective = pulp.lpSum([v*x for v,x in zip(vars_from, self.unit_cost)])*dt - \\ pulp.lpSum([v*x for v,x in zip(vars_to, self.unit_profit)])*dt (2) \u65b0\u80fd\u6e90\u53d1\u7535\u6a21\u578b \u00b6 \u5c06\u98ce\u673a\u548c\u5149\u4f0f\u62bd\u8c61\u4e3a\u65b0\u80fd\u6e90\u53d1\u7535\u6a21\u578b\uff0c\u7ea6\u675f\u6761\u4ef6\u4e3a \u6bcf\u4e00\u65f6\u523b\u7684\u7535\u529b\u4f9b\u5e94\u4e0d\u5927\u4e8e\u9884\u6d4b\u51fa\u529b\uff0c\u5982\u679c\u4e0d\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\u7684\u8bdd\uff0c\u5219\u7b49\u4e8e\u9884\u6d4b\u51fa\u529b\u503c \u3002\u56e0\u6b64\uff0c\u5728 Model \u7c7b\u57fa\u7840\u4e0a\u589e\u52a0\u4e24\u4e2a\u8f93\u5165\u53c2\u6570\uff1a forecast \uff1a\u6bcf\u4e00\u65f6\u523b\u7684\u51fa\u529b\u9884\u6d4b\uff0c\u5373\u4e00\u4e2a\u5217\u5411\u91cf/\u6570\u7ec4/\u65f6\u95f4\u5e8f\u5217\uff1b allow_curtailment \uff1a\u662f\u5426\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff0c\u9ed8\u8ba4\u5141\u8bb8\u3002 \u76f8\u5e94\u5730\uff0c\u63d0\u4f9b\u4e00\u4e2a utilization \u8f93\u51fa\u5c5e\u6027\u8868\u793a\u65b0\u80fd\u6e90\u53d1\u7535\u7684\u5b9e\u9645\u5229\u7528\u7387\u3002 class Renewable(Model): def __init__(self, name:str, capacity:float, unit_cost:float, forecast:np.ndarray, # forecasting output allow_curtailment:bool=True): # allow curtailment or not super().__init__(name, capacity, unit_cost) self.forecast = forecast self.allow_curtailment = allow_curtailment def create_model(self, time_points:int, dt:float): # define variables at each time point self.variables = [pulp.LpVariable(name=f'{self.name}_{i}', lowBound=0) for i in range(time_points)] # constraints: v<=forecast if self.allow_curtailment: self.constraints = [v<=x for v,x in zip(self.variables, self.forecast)] else: self.constraints = [v==x for v,x in zip(self.variables, self.forecast)] # objective self.objective = pulp.lpSum(self.variables)*self.unit_cost*dt @property def utilization(self): return self.output.sum() / self.forecast.sum() (3) \u84c4\u7535\u6c60\u6a21\u578b \u00b6 \u539f\u9898\u5df2\u7ecf\u7ed9\u51fa\u4e86\u84c4\u7535\u6c60\u7684\u6df7\u5408\u6574\u6570\u89c4\u5212\u6570\u5b66\u6a21\u578b\uff0c\u9664\u4e86\u57fa\u7c7b\u4e2d\u7684\u5bb9\u91cf\u3001\u5355\u4f4d\u7528\u7535\u6210\u672c\u5916\uff0c\u8fd8\u6709\u5982\u4e0b\u4e3b\u8981\u53c2\u6570\uff1a capacity_limit \uff1a\u722c\u5761\u9650\u5236\u503c\uff0c\u5373\u539f\u9898\u516c\u5f0f\uff085\uff09\u4e2d\u7684\u6570\u503c 20% init_soc \uff1a\u521d\u59cbSOC\u72b6\u6001 soc_limit \uff1a\u7535\u91cf\u8303\u56f4SOC\u9650\u5236 cycle_limit \uff1a\u5145\u653e\u7535\u6b21\u6570\u9650\u5236 \u53c2\u8003\u539f\u9898\u7684\u7ea6\u675f\uff1a \u722c\u5761\u7ea6\u675f\uff1a\u516c\u5f0f\uff083\uff09\uff085\uff09 \u5bb9\u91cf\u7ea6\u675f\uff1a\u516c\u5f0f\uff081\uff09\uff082\uff09 \u8c03\u5ea6\u5468\u671f\u59cb\u672b\u7535\u91cf\u76f8\u7b49\uff1a\u516c\u5f0f\uff084\uff09 \u5145\u653e\u7535\u6b21\u6570\u7ea6\u675f\uff1a\u516c\u5f0f\uff086\uff09 \u7c7b\u6bd4\u4e0a\u6587\u5bf9\u7535\u7f51\u4e70\u7535\u3001\u5356\u7535\u884c\u4e3a\u7684\u5efa\u6a21\uff0c\u540c\u4e00\u65f6\u523b\u4e5f\u9700\u8981\u4e09\u4e2a\u4e2d\u95f4\u53d8\u91cf\uff1a\u5145\u7535\u529f\u7387 p^i_c p^i_c \u3001\u653e\u7535\u529f\u7387 p^i_d p^i_d \u3001\u5145\u653e\u7535 0-1 \u72b6\u6001 b^i b^i \uff081-\u653e\u7535\uff0c0-\u5145\u7535\uff09\u6765\u63cf\u8ff0\u7535\u6c60\u7684\u51fa\u529b\u3002\u524d\u4e09\u4e2a\u7ea6\u675f\u7684\u5b9e\u73b0\u4e0d\u518d\u8d58\u8ff0\uff0c\u4e0b\u9762\u91cd\u70b9\u89e3\u6790\u5145\u653e\u7535\u6b21\u6570\u7ea6\u675f\u3002 \u5145\u653e\u7535\u72b6\u6001\u5e8f\u5217 b=\\{b^1, b^2, ..., b^n\\} b=\\{b^1, b^2, ..., b^n\\} \uff0c\u5f15\u5165\u8f85\u52a9\u7684 0-1 \u53d8\u91cf t t \u8868\u793a\u76f8\u90bb\u72b6\u6001\u76f8\u51cf\u7684\u7edd\u5bf9\u503c\uff0c\u5373 t^i = |b^{i+1} - b^i| \\quad 1=1,2,3,...,n-1 t^i = |b^{i+1} - b^i| \\quad 1=1,2,3,...,n-1 \u5f53 t^i=1 t^i=1 \u65f6\uff0c\u5373\u76f8\u90bb\u7684\u5145\u653e\u7535\u72b6\u6001\u75310\u53d8\u6210\u4e861\uff0c\u6216\u8005\u75311\u53d8\u6210\u4e860\uff0c\u8868\u793a\u5b8c\u6210\u4e86\u4e00\u6b21\u5145\u653e\u7535\u5468\u671f\u3002\u4e8e\u662f\u603b\u7684\u5145\u653e\u7535\u6b21\u6570\u9650\u5236\u7ea6\u675f\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a \\Sigma t^i \\leq N_c \\Sigma t^i \\leq N_c \u81f3\u6b64\u8fd8\u5269\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u5c06\u542b\u6709\u7edd\u5bf9\u503c\u7684\u7b49\u5f0f t^i = |b^{i+1} - b^i| t^i = |b^{i+1} - b^i| \u53d8\u6362\u4e3a\u7ebf\u6027\u7ea6\u675f\uff1f \u7ed3\u5408\u672c\u6587\u573a\u666f\uff0c\u5c06\u7b49\u5f0f\u677e\u5f1b\u4e00\u4e0b t^i \\geq |b^{i+1} - b^i| t^i \\geq |b^{i+1} - b^i| \uff1a t^i=1 t^i=1 \u6b63\u662f\u6211\u4eec\u9700\u8981\u8ba1\u6570\u7684\u60c5\u51b5 t^i=0 t^i=0 \u6ca1\u6709\u589e\u52a0\u8ba1\u6570\uff0c\u6b64\u65f6 b^{i+1} = b^i b^{i+1} = b^i \u8868\u660e\u5e76\u672a\u53d1\u751f\u5145\u653e\u7535\u72b6\u6001\u53d8\u5316\uff0c\u6070\u597d\u53ef\u4ee5\u5bf9\u5e94\u4e0a \u4e8e\u662f\uff0c\u4e0a\u8ff0\u7edd\u5bf9\u503c\u7b49\u5f0f\u7ea6\u675f\u7b49\u6548\u4e3a\uff1a -t^i \\leq b^{i+1} - b^i \\leq t^i -t^i \\leq b^{i+1} - b^i \\leq t^i class Storage(Model): def __init__(self, name:str, capacity:float, unit_cost:float, capacity_limit:float, # charging / discharging ramping limit init_soc:float, # initial state of charge soc_limit:list, # SOC limit cycle_limit:int): # charing / discharging cycle counts limit super().__init__(name, capacity, unit_cost) self.init_soc = init_soc self.soc_limit = soc_limit self.cycle_limit = cycle_limit self.capacity_limit = capacity_limit def create_model(self, time_points: int, dt: float): # define variables at each time point vars_ch = [pulp.LpVariable(name=f'{self.name}_charge_{i}', lowBound=0) for i in range(time_points)] vars_dis = [pulp.LpVariable(name=f'{self.name}_discharge_{i}', lowBound=0) for i in range(time_points)] self.variables = [v1-v2 for v1,v2 in zip(vars_dis, vars_ch)] # constraints 1: ramping limit # 0<=var_dis<=C*b # 0<=var_ch<=C*(1-b) self.constraints = [] vars_b = [pulp.LpVariable(name=f'{self.name}_binary_{i}', cat=pulp.LpInteger) for i in range(time_points)] C = self.capacity * self.capacity_limit for v1,v2,b in zip(vars_dis, vars_ch, vars_b): self.constraints.append(v1<=C*b) self.constraints.append(v2<=C*(1-b)) # constraints 2: SOC limit soc = self.init_soc s1, s2 = self.soc_limit for v1,v2 in zip(vars_ch, vars_dis): soc += (v1*dt - v2*dt) / self.capacity self.constraints.append(soc>=s1) self.constraints.append(soc<=s2) # constraints 3: same SOC at the scheduling end self.constraints.append(pulp.lpSum(self.variables)==0) # constraints 4: charging / discharging cycle limit # t = |b_i-b_{i+1}| # sum(t)<=N vars_db = [vars_b[i+1]-vars_b[i] for i in range(time_points-1)] vars_t = [pulp.LpVariable(name=f'{self.name}_binary_t_{i}', cat=pulp.LpInteger) for i in range(time_points-1)] for db, t in zip(vars_db, vars_t): self.constraints.append(db>=-t) self.constraints.append(db<=t) self.constraints.append(pulp.lpSum(vars_t)<=self.cycle_limit) # objective self.objective = pulp.lpSum(vars_dis)*self.unit_cost*dt (4) \u98ce\u5149\u50a8\u4f18\u5316\u8c03\u5ea6\u6a21\u578b \u00b6 \u6700\u540e\uff0c\u6211\u4eec\u62bd\u8c61\u51fa\u4e00\u4e2a\u5fae\u7535\u7f51\u7c7b\uff0c\u5305\u542b\u4e0a\u8ff0\u80fd\u6e90\u8bbe\u5907 resources \u53ca\u8d1f\u8377 load \uff0c\u540c\u65f6\u5f15\u5165\u7cfb\u7edf\u80fd\u91cf\u5e73\u8861\u7ea6\u675f\uff0c\u5efa\u7acb\u6700\u7ec8\u7684\u4f18\u5316\u6a21\u578b\u3002\u5176\u4e2d\u7684\u51e0\u4e2a\u65b9\u6cd5\uff1a optimize() \uff1a\u5efa\u6a21\u548c\u6c42\u89e3\u8fc7\u7a0b operation_cost \uff1a\u76ee\u6807\u51fd\u6570\u503c\u5373\u603b\u7528\u7535\u8d39\u7528 average_cost \uff1a\u5e73\u5747\u7528\u7535\u6210\u672c import matplotlib.pyplot as plt class MicroGrid: def __init__(self, resources:list, load:np.ndarray, time_step:float) -> None: self.resources = resources self.load = load self.time_step = time_step # create problem: minimize the operation cost self.prob = pulp.LpProblem(name='microgrid_optimization', sense=pulp.LpMinimize) @property def operation_cost(self): return self.prob.objective.value() @property def average_cost(self): return self.operation_cost / (self.load.sum()*self.time_step) def optimize(self): '''Micro-grid operation optimization.''' # collect resources models d_variables, constraints, objective = [], [], 0.0 time_points = self.load.size for resource in self.resources: resource.create_model(time_points, self.time_step) d_variables.append(resource.variables) constraints.extend(resource.constraints) objective += resource.objective # add constraints: resource level for c in constraints: self.prob += c # add constraint: energy balance for i in range(time_points): _vars = [variables[i] for variables in d_variables] self.prob += pulp.lpSum(_vars)==self.load[i] # objective self.prob += objective # solve self.prob.solve() # output self._summary() def _summary(self): print(f'Status: {pulp.LpStatus[self.prob.status]}') print(f'\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a{round(self.operation_cost,4)} \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a{round(self.average_cost,4)} \u5143/kWh') # plot for r in self.resources: plt.plot(r.output, label=r.name) plt.plot(self.load, label='load') plt.legend() \u6c42\u89e3\u5178\u578b\u573a\u666f \u00b6 \u672c\u8282\u6839\u636e\u4e0a\u6587\u5efa\u7acb\u7684\u4f18\u5316\u8c03\u5ea6\u6a21\u578b\uff0c\u6c42\u89e3\u63d0\u95ee\u4e2d\u7684\u4e0d\u540c\u8c03\u5ea6\u7b56\u7565\u3002 \u5148\u5bfc\u5165\u5168\u592996\u4e2a\u65f6\u523b\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\uff1a # read text to list with open('input.csv', 'r', encoding='utf-8') as f: lines = f.readlines() # print the first three lines for example for line in lines[:3]: print(line) # list to numpy 2D array data = [list(map(float, line.split(','))) for line in lines[1:]] # except the header line data = np.array(data) data_load, data_wt, data_pv, unit_profit, unit_cost = [data[:, i] for i in range(1,6)] # output: # \u5e8f\u53f7,\u8d1f\u8377(kW),\u98ce\u673a(kW),\u5149\u4f0f(kW),\u552e\u7535(\u5143/kWh),\u8d2d\u7535(\u5143/kWh) # 1,64.3,163.1,0,0.22,0.25 # 2,65.5,201.47,0,0.22,0.25 (1) \u7ecf\u6d4e\u6027\u8bc4\u4f30\u65b9\u6848 \u00b6 \u95ee\u9898\uff1a\u5fae\u7f51\u4e2d\u84c4\u7535\u6c60\u4e0d\u4f5c\u7528\uff0c\u5fae\u7f51\u4e0e\u7535\u7f51\u4ea4\u6362\u529f\u7387\u65e0\u7ea6\u675f\uff0c\u65e0\u53ef\u518d\u751f\u80fd\u6e90\u60c5\u51b5\u4e0b\uff0c\u5206\u522b\u8ba1\u7b97\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\u3002 \u8fd9\u4e00\u95ee\u4e0d\u7528\u4f18\u5316\u6a21\u578b\u4e5f\u80fd\u89e3\uff0c\u591a\u4f59\u7684\u7535\u5356\u7ed9\u7535\u7f51\u3001\u4e0d\u8db3\u7684\u7535\u4ece\u7535\u7f51\u8d2d\u4e70\u5373\u53ef\uff0c\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 \u7684\u89e3\u6790\u8fc7\u7a0b\u3002\u4f46\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u5efa\u7acb\u4e86\u7edf\u4e00\u7684\u4f18\u5316\u8c03\u5ea6\u6a21\u578b\uff0c\u672c\u4f8b\u53ea\u8981\u5f15\u5165\u7535\u7f51\u4e00\u79cd\u8d44\u6e90\uff0c\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u7279\u4f8b\u76f4\u63a5\u6c42\u89e3\u5373\u53ef\u3002 \u56e0\u4e3a\u7535\u7f51\u4ea4\u6362\u529f\u7387\u6ca1\u6709\u9650\u5236\uff0c\u76f4\u63a5\u8bbe\u4e00\u4e2a\u8f83\u5927\u7684\u6570\u4f8b\u5982 10^6 10^6 \u5373\u53ef\u3002 # set a large value 1e6 as no limit on energy exchanging with grid grid = Grid(name='grid', capacity=1e6, unit_cost=unit_cost, unit_profit=unit_profit) # microgrid resources = [grid] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a1976.4142 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.5976 \u5143/kWh \u95ee\u9898\uff1a\u5fae\u7f51\u4e2d\u84c4\u7535\u6c60\u4e0d\u4f5c\u7528\uff0c\u5fae\u7f51\u4e0e\u7535\u7f51\u4ea4\u6362\u529f\u7387\u65e0\u7ea6\u675f\uff0c\u53ef\u518d\u751f\u80fd\u6e90\u5168\u989d\u5229\u7528\u60c5\u51b5\u4e0b\uff0c\u5206\u522b\u8ba1\u7b97\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\u3002 \u8fd9\u4e00\u95ee\u5c06\u98ce\u673a\u548c\u5149\u4f0f\u52a0\u5165\u5fae\u7f51\uff0c\u540c\u65f6\u6ce8\u610f\u8bbe\u7f6e\u4e0d\u53ef\u5f03\u98ce\u5f03\u5149\uff08\u53ef\u518d\u751f\u80fd\u6e90\u5168\u989d\u5229\u7528\uff09\u3002 # set a large value 1e6 as no limit on energy exchanging with grid grid = Grid(name='grid', capacity=1e6, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine: allow_curtailment=False wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=False) # pv: allow_curtailment=False pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=False) # microgrid resources = [grid, wt, pv] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a2275.1698 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.6879 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.0\uff0c\u5f03\u5149\u7387\uff1a0.0 \u56e0\u4e3a\u9650\u5b9a\u5168\u989d\u5229\u7528\u53ef\u518d\u751f\u80fd\u6e90\uff0c\u6240\u4ee5\u5f03\u98ce\u5f03\u5149\u7387\u90fd\u662f0\u3002\u98ce\u673a\u3001\u5149\u4f0f\u7684\u7528\u7535\u6210\u672c\u8f83\u9ad8\uff0c\u5373\u4fbf\u53ef\u4ee5\u5c06\u98ce\u673a\u3001\u5149\u4f0f\u7684\u7535\u5356\u7ed9\u7535\u7f51\uff0c\u5176\u6700\u7ec8\u6536\u76ca\u8fd8\u4e0d\u5982\u4f4e\u7535\u4ef7\u65f6\u523b\u4ece\u7535\u7f51\u76f4\u63a5\u4e70\u7535\uff0c\u6240\u4ee5\u5168\u989d\u5229\u7528\u53ef\u518d\u751f\u80fd\u6e90\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e00\u5c0f\u95ee\u7684\u5e73\u5747\u7528\u7535\u6210\u672c\u9ad8\u4e8e\u4e0a\u4e00\u95ee\u7684\u7eaf\u7f51\u7535\u3002 (2) \u6700\u4f18\u65e5\u524d\u8c03\u5ea6\u65b9\u6848\u4e00 \u00b6 \u95ee\u9898\uff1a\u4e0d\u8ba1\u84c4\u7535\u6c60\u4f5c\u7528\uff0c\u5fae\u7f51\u4e0e\u7535\u7f51\u4ea4\u6362\u529f\u7387\u65e0\u7ea6\u675f\uff0c\u4ee5\u5e73\u5747\u8d1f\u8377\u4f9b\u7535\u5355\u4ef7\u6700\u5c0f\u4e3a\u76ee\u6807\uff08\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff09\uff0c\u5206\u522b\u8ba1\u7b97\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\uff0c\u5206\u6790\u53ef\u518d\u751f\u80fd\u6e90\u7684\u5229\u7528\u60c5\u51b5\u3002 \u8fd9\u4e2a\u8c03\u5ea6\u65b9\u6848\u662f\u5728\u4e0a\u4e00\u95ee\u7684\u57fa\u7840\u4e0a\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff0c\u5373\u5408\u7406\u9009\u62e9\u4f7f\u7528\u65b0\u80fd\u6e90\u53d1\u7535\u8fd8\u662f\u7f51\u7535\u3002\u540c\u6837\uff0c\u6211\u4eec\u8bbe\u7f6e\u8f93\u5165\u53c2\u6570\uff0c\u7136\u540e\u4ea4\u7ed9\u4f18\u5316\u6a21\u578b\u5373\u53ef\u3002\u6ce8\u610f\u548c\u4e0a\u4e00\u6bb5\u4ee3\u7801\u7684\u552f\u4e00\u533a\u522b\u662f\u8bbe\u7f6e\u5141\u8bb8\u5f03\u98ce\u5f03\u5149 allow_curtailment=True \u3002 # set a large value 1e6 as no limit on energy exchanging with grid grid = Grid(name='grid', capacity=1e6, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine: allow_curtailment=True wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=True) # pv: allow_curtailment=True pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=True) # microgrid resources=[grid, wt, pv] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a1785.1532 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.5397 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.5399\uff0c\u5f03\u5149\u7387\uff1a0.6923 \u56e0\u4e3a\u53ef\u4ee5\u6839\u636e\u7ecf\u6d4e\u6700\u4f18\u9009\u62e9\u5408\u9002\u7684\u7535\u529b\u6765\u6e90\uff0c\u8fd9\u4e00\u8c03\u5ea6\u65b9\u6848\u7684\u5e73\u5747\u7528\u7535\u6210\u672c\u4f4e\u4e8e\u524d\u4e24\u95ee\u3002\u4f8b\u5982\uff0c\u51cc\u6668\u65f6\u6bb5\u7f51\u7535\u7535\u4ef7\u672c\u6765\u5c31\u4f4e\uff0c\u6240\u4ee5\u9009\u62e9\u76f4\u63a5\u5f03\u6389\u6b64\u65f6\u7684\u98ce\u673a\u548c\u5149\u4f0f\u7535\u529b\uff08\u53c2\u89c1\u5f03\u98ce\u5f03\u5149\u7387\uff09\uff1b\u7f51\u7535\u5cf0\u7535\u65f6\u6bb5\u62e9\u673a\u8003\u8651\u98ce\u7535\u548c\u5149\u4f0f\u3002 \u8fd9\u7bc7\u6587\u7ae0 \u4ece\u7535\u4ef7\u89e3\u6790\u7684\u89d2\u5ea6\u5206\u6790\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u4eba\u4e3a\u5206\u6790\u7684\u7b56\u7565\u4e0e\u672c\u6587\u4f18\u5316\u7684\u7ed3\u679c\u5f88\u63a5\u8fd1\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003\u3002 (3) \u6700\u4f18\u65e5\u524d\u8c03\u5ea6\u65b9\u6848\u4e8c \u00b6 \u95ee\u9898\uff1a\u8003\u8651\u84c4\u7535\u6c60\u4f5c\u7528\uff0c\u4e14\u5fae\u7f51\u4e0e\u7535\u7f51\u5141\u8bb8\u4ea4\u6362\u529f\u7387\u4e0d\u8d85\u8fc7150kW\uff0c\u5728\u53ef\u518d\u751f\u80fd\u6e90\u5168\u989d\u5229\u7528\u7684\u6761\u4ef6\u4e0b\uff0c\u4ee5\u8d1f\u8377\u5e73\u5747\u4f9b\u7535\u5355\u4ef7\u6700\u5c0f\u4e3a\u76ee\u6807\uff0c\u5efa\u7acb\u4f18\u5316\u6a21\u578b\uff0c\u7ed9\u51fa\u6700\u4f18\u8c03\u5ea6\u65b9\u6848\uff0c\u5305\u62ec\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\uff0c\u5206\u6790\u84c4\u7535\u6c60\u53c2\u4e0e\u8c03\u8282\u540e\u4ea7\u751f\u7684\u5f71\u54cd\u3002 \u8fd9\u4e2a\u8c03\u5ea6\u65b9\u6848\u5728\u57fa\u7840\u573a\u666f\uff081\uff09\u7b2c\u4e8c\u95ee\u7684\u57fa\u7840\u4e0a\u5f15\u5165\u4e86\u84c4\u7535\u6c60\uff0c\u540c\u65f6\u9650\u5236\u4e86\u7535\u7f51\u4ea4\u6362\u529f\u7387\u3002 # grid grid = Grid(name='grid', capacity=150, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=False) # pv: allow_curtailment=False pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=False) # battery: allow_curtailment=False bt = Storage(name='battery', capacity=300, unit_cost=0.2, capacity_limit=0.2, init_soc=0.4, soc_limit=[0.3,0.95], cycle_limit=8) # microgrid resources=[grid, wt, pv, bt] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a2210.4672 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.6683 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.0\uff0c\u5f03\u5149\u7387\uff1a0.0 \u76f8\u6bd4\u57fa\u7840\u573a\u666f\uff081\uff09\u7b2c\u4e8c\u95ee\u7684\u5e73\u5747\u7528\u7535\u6210\u672c0.6879\uff0c\u672c\u65b9\u6848\u7528\u7535\u6210\u672c\u6709\u6240\u964d\u4f4e\u3002\u7ed3\u5408\u4e0b\u56fe\u5177\u4f53\u8c03\u5ea6\u53ef\u77e5\uff0c\u84c4\u7535\u6c60\u5c06\u51cc\u6668\u9ad8\u6210\u672c\u7684\u65b0\u80fd\u6e90\u7535\u529b\u8f6c\u79fb\u5230\u4e86\u7f51\u7535\u7684\u5cf0\u7535\u65f6\u6bb5\uff0c\u56e0\u6b64\u6bd4\u76f4\u63a5\u5728\u51cc\u6668\u65f6\u6bb5\u5356\u9ad8\u6210\u672c\u7684\u65b0\u80fd\u6e90\u7535\u529b\u66f4\u4e3a\u5212\u7b97\u3002 \u8fd9\u7bc7\u6587\u7ae0 \u4e5f\u89e3\u7b54\u4e86\u672c\u95ee\u9898\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003\u3002 (4) \u6700\u4f18\u65e5\u524d\u8c03\u5ea6\u65b9\u6848\u4e09 \u00b6 \u95ee\u9898\uff1a\u8003\u8651\u84c4\u7535\u6c60\u4f5c\u7528\uff0c\u4e14\u5fae\u7f51\u4e0e\u7535\u7f51\u5141\u8bb8\u4ea4\u6362\u529f\u7387\u4e0d\u8d85\u8fc7150kW\uff0c\u4ee5\u8d1f\u8377\u4f9b\u7535\u6210\u672c\u6700\u5c0f\u4e3a\u76ee\u6807\uff08\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff09\uff0c\u5efa\u7acb\u4f18\u5316\u6a21\u578b\uff0c\u7ed9\u51fa\u6700\u4f18\u8c03\u5ea6\u65b9\u6848\uff0c\u5305\u62ec\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\uff0c\u5206\u6790\u53ef\u518d\u751f\u80fd\u6e90\u7684\u5229\u7528\u60c5\u51b5\u53ca\u84c4\u7535\u6c60\u53c2\u4e0e\u8c03\u8282\u540e\u4ea7\u751f\u7684\u5f71\u54cd\u3002 \u8fd9\u4e00\u8c03\u5ea6\u65b9\u6848\u662f\u5728\u95ee\u9898\uff083\uff09\u7684\u57fa\u7840\u4e0a\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff0c\u540c\u7406\u7565\u4f5c\u4fee\u6539\u5373\u53ef\u3002 # grid grid = Grid(name='grid', capacity=150, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=True) # pv: allow_curtailment=True pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=True) # battery: allow_curtailment=True bt = Storage(name='battery', capacity=300, unit_cost=0.2, capacity_limit=0.2, init_soc=0.4, soc_limit=[0.3,0.95], cycle_limit=8) # microgrid resources=[grid, wt, pv, bt] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a1733.5558 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.5241 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.5383\uff0c\u5f03\u5149\u7387\uff1a0.6494 \u76f8\u6bd4\u95ee\u9898\uff083\uff09\uff0c\u672c\u65b9\u6848\u5141\u8bb8\u653e\u5f03\u9ad8\u7535\u4ef7\u7684\u65b0\u80fd\u6e90\u7535\u529b\uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u4e00\u6b65\u964d\u4f4e\u5e73\u5747\u7528\u7535\u6210\u672c\uff1b\u76f8\u6bd4\u95ee\u9898\uff082\uff09\uff0c\u672c\u65b9\u6848\u591a\u4e86\u84c4\u7535\u6c60\u7684\u8c03\u8282\u4f5c\u7528\uff08\u5cf0\u8c37\u7535\u4ef7\u8f6c\u79fb\uff09\uff0c\u56e0\u6b64\u4e5f\u964d\u4f4e\u4e86\u5e73\u5747\u7528\u7535\u6210\u672c\uff0c\u540c\u65f6\u56e0\u4e3a\u7535\u6c60\u5bf9\u65b0\u80fd\u6e90\u7684\u6d88\u7eb3\uff0c\u672c\u65b9\u6848\u76f8\u5bf9\u95ee\u9898\uff082\uff09\u4e5f\u7565\u5fae\u964d\u4f4e\u4e86\u5f03\u98ce\u5f03\u5149\u7387\u3002 \u4ee3\u7801\u6c47\u603b \u00b6 input.csv microgrid_optimization.ipynb","title":"\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#_1","text":"\u53d1\u5e03\u4e8e\uff1a2022-10-22 | \u5206\u7c7b\uff1a mathematics , optimization \u6700\u8fd1\u770b\u4e86\u4e00\u4e9b\u5fae\u7535\u7f51\u4f18\u5316\u8c03\u5ea6\u7684\u8bba\u6587\uff0c\u82e6\u4e8e\u65e0\u4ece\u4e0b\u624b\u4e4b\u9645\uff0c\u770b\u5230\u4e00\u9053\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u76f8\u5173\u7684\u6570\u5b66\u5efa\u6a21\u9898\uff1b\u9898\u76ee\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u98ce\u5149\u50a8\u5fae\u7535\u7f51\u573a\u666f\u53ca\u6d4b\u8bd5\u6570\u636e\uff0c\u6b63\u597d\u62ff\u6765\u7ec3\u624b\u3002\u672c\u6587\u57fa\u4e8ePython\u7b2c\u4e09\u65b9\u5e93 PuLP \u5b9e\u73b0\u9898\u76ee\u7684\u6df7\u5408\u6574\u6570\u89c4\u5212\u6a21\u578b\uff0c\u5e76\u4f7f\u7528\u9ed8\u8ba4\u7684 CBC \u6c42\u89e3\u5668\u6c42\u89e3\u3002\u8f93\u5165\u6570\u636e\u53ca\u6c47\u603b\u4ee3\u7801\uff0c\u53c2\u89c1\u6587\u672b\u3002","title":"\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#_2","text":"\u95ee\u9898\u51fa\u81ea\u7b2c\u5341\u5c4a\u201c\u4e2d\u56fd\u7535\u673a\u5de5\u7a0b\u5b66\u4f1a\u676f\u201d\u5168\u56fd\u5927\u5b66\u751f\u7535\u5de5\u6570\u5b66\u5efa\u6a21\u7ade\u8d5bA\u9898\uff1a\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u3002 \u4e0b\u56fe\u793a\u610f\u4e86\u4e00\u4e2a\u542b\u6709\u98ce\u673a\u3001\u5149\u4f0f\u3001\u84c4\u7535\u6c60\u53ca\u5e38\u89c1\u8d1f\u8377\u7684\u5fae\u7535\u7f51\u7cfb\u7edf\u3002\u65e5\u524d\u7ecf\u6d4e\u8c03\u5ea6\u95ee\u9898\u662f\u6307\u5728\u5bf9\u98ce\u673a\u51fa\u529b\u3001\u5149\u4f0f\u51fa\u529b\u3001\u5e38\u89c4\u8d1f\u8377\u8fdb\u884c\u65e5\u524d\uff08\u672a\u676524h\uff09\u9884\u6d4b\u7684\u57fa\u7840\u4e0a\uff0c\u8003\u8651\u7535\u7f51\u6d4b\u7684\u5206\u65f6\u7535\u4ef7\uff0c\u5145\u5206\u5229\u7528\u5fae\u7f51\u4e2d\u7684\u84c4\u7535\u6c60\u7b49\u53ef\u8c03\u63a7\u624b\u6bb5\uff0c\u4f7f\u5fae\u7535\u7f51\u8fd0\u884c\u7684\u7ecf\u6d4e\u6027\u6700\u4f18\u3002 \u9898\u76ee\u8981\u6c42\u5728\u5982\u4e0b\u5df2\u77e5\u6761\u4ef6\u4e0b\uff0c\u6c42\u4e0d\u540c\u8c03\u5ea6\u65b9\u6848\u7684\u5e73\u5747\u7528\u7535\u6210\u672c\uff1a \u672a\u676524h\u3001\u6bcf\u969415min\u517196\u4e2a\u65f6\u95f4\u70b9\u7684\u8d1f\u8377\u3001\u5149\u4f0f\u3001\u98ce\u673a\u51fa\u529b\u9884\u6d4b\uff0c\u53ca\u5206\u65f6\u7535\u4ef7\u6570\u636e\uff1b \u98ce\u673a\u5bb9\u91cf250kW\uff0c\u53d1\u7535\u6210\u672c0.52\u5143/kWh\uff1b \u5149\u4f0f\u5bb9\u91cf150kW\uff0c\u53d1\u7535\u6210\u672c0.75\u5143/kWh\uff1b \u84c4\u7535\u6c60\u5bb9\u91cf300kWh\uff1bSOC\u521d\u59cb\u503c0.4\uff0c\u8fd0\u884c\u8303\u56f4[0.3, 0.95]\uff1b\u7531\u5145\u7535\u81f3\u653e\u7535\u6210\u4e3a\u4e3a0.2\u5143/kWh\uff1b\u65e5\u5145\u653e\u7535\u6b21\u6570\u9650\u5236\u5747\u4e3a8\uff1b\u5ffd\u7565\u84c4\u7535\u6c60\u635f\u8017\uff1b \u5b8c\u6574\u95ee\u9898\u63cf\u8ff0\u53c2\u8003\uff1a \u7b2c\u5341\u5c4a\u201c\u4e2d\u56fd\u7535\u673a\u5de5\u7a0b\u5b66\u4f1a\u676f\u201d\u5168\u56fd\u5927\u5b66\u751f\u7535\u5de5\u6570\u5b66\u5efa\u6a21\u7ade\u8d5b A \u9898\uff1a\u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6 \u3002\u7b97\u4f8b\u6709\u4ee3\u7801\uff080\uff09","title":"\u95ee\u9898\u63cf\u8ff0"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#_3","text":"\u9898\u76ee\u6d89\u53ca\u7535\u7f51\u3001\u65b0\u80fd\u6e90\uff08\u98ce\u673a\u3001\u5149\u4f0f\uff09\u3001\u84c4\u7535\u6c60\u53ca\u8d1f\u8377\u56db\u7c7b\u8d44\u6e90\uff0c\u6211\u4eec\u4f9d\u6b21\u5efa\u7acb\u5176\u7ebf\u6027\u89c4\u5212\u6a21\u578b\uff0c\u7136\u540e\u4ea4\u7ed9\u6c42\u89e3\u5668\u6c42\u89e3\u3002\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u6a21\u578b\u5305\u542b\uff1a \u8bbe\u8ba1\u53d8\u91cf\uff1a\u5404\u7c7b\u8d44\u6e90\u7684\u5b9e\u65f6\u51fa\u529b\u6570\u636e \u7ea6\u675f\u6761\u4ef6\uff1a\u80fd\u91cf\u5e73\u8861\u53ca\u5404\u7c7b\u8d44\u6e90\u5e94\u8be5\u6ee1\u8db3\u7684\u6280\u672f\u53c2\u6570\uff0c\u4f8b\u5982\u84c4\u7535\u6c60\u7684\u5bb9\u91cf\u9650\u5236\u3001SOC\u9650\u5236\u3001\u5145\u653e\u7535\u6b21\u6570\u9650\u5236\u7b49 \u76ee\u6807\u51fd\u6570\uff1a\u8fd0\u884c\u6210\u672c\uff0c\u5177\u4f53\u5230\u672c\u9898\u5373\u7528\u7535\u6210\u672c \u672c\u6587\u57fa\u4e8e Python \u7b2c\u4e09\u65b9\u5e93 PuLP \u5b9e\u73b0\u3002 PuLP \u662f\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u95ee\u9898\u5efa\u6a21\u5e93\uff0c\u5c06\u6570\u5b66\u6a21\u578b\u8f6c\u6362\u4e3a MPS \u6216\u8005 LP \u6587\u4ef6\uff0c\u7136\u540e\u8c03\u7528 LP \u6c42\u89e3\u5668\u5982 CBC\u3001GLPK\u3001CPLEX\u3001Gurobi \u7b49\u6c42\u89e3\u3002\u5177\u4f53\u7528\u6cd5\u53c2\u8003\u4e0b\u9762\u94fe\u63a5\uff0c\u672c\u6587\u4e0d\u518d\u8d58\u8ff0\u3002 PuLP Documentation Python\u6c42\u89e3\u7ebf\u6027\u89c4\u5212\u2014\u2014PuLP\u4f7f\u7528\u6559\u7a0b \u5f00\u59cb\u4e4b\u524d\u5148\u62bd\u8c61\u4e00\u4e2a\u6a21\u578b\u57fa\u7c7b\uff0c\u8868\u793a\u5404\u7c7b\u8c03\u5ea6\u8bbe\u5907\uff0c\u5305\u542b\u540d\u79f0\u3001\u5bb9\u91cf\u3001\u4f7f\u7528\u6210\u672c\u7b49\u57fa\u672c\u5c5e\u6027\uff0c\u540c\u65f6\u63d0\u4f9b\u4e00\u4e2a create_model() \u65b9\u6cd5\uff0c\u7528\u4e8e\u5b9e\u73b0\u8bbe\u8ba1\u53d8\u91cf\u3001\u7ea6\u675f\u6761\u4ef6\u3001\u76ee\u6807\u51fd\u6570\u7b49\u7ebf\u6027\u89c4\u5212\u6a21\u578b\u4e09\u8981\u7d20\u3002\u6a21\u578b\u6c42\u89e3\u540e\uff0c\u8c03\u7528 output \u5c5e\u6027\u83b7\u53d6\u53d8\u91cf\u503c\uff0c\u5373\u6bcf\u4e2a\u65f6\u523b\u7684\u51fa\u529b\u3002 import pulp import numpy as np class Model: def __init__(self, name:str, capacity:float, # resource capacity unit_cost:float): # unit cost when using the energy '''Base class for resource model, e.g., Grid, Renewable and Storage.''' # technical parameters self.name = name self.capacity = capacity self.unit_cost = unit_cost # linear programming model: variables, constraints and objective self.variables = None self.constraints = None self.objective = None def create_model(self, time_points:int, dt:float): '''How to create the LP model.''' raise NotImplementedError @property def output(self): return np.array([v.value() for v in self.variables]) \u63a5\u4e0b\u6765\u4f9d\u6b21\u5efa\u7acb\u7535\u7f51\u3001\u65b0\u80fd\u6e90\uff08\u98ce\u673a\u3001\u5149\u4f0f\uff09\u53ca\u84c4\u7535\u6c60\u7684\u6a21\u578b\u3002","title":"\u98ce\u5149\u50a8\u4f18\u5316\u8c03\u5ea6\u6a21\u578b"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#1","text":"\u7535\u7f51\u6a21\u578b\u7ee7\u627f\u81ea Model \u57fa\u7c7b\uff0c\u540c\u65f6\u65b0\u589e\u4e86 \u5356\u7535\u6536\u76ca \u5c5e\u6027\uff0c\u5e76\u4e14\u6ee1\u8db3\u5bb9\u91cf\u7ea6\u675f\u5373\u6bcf\u4e2a\u65f6\u523b\u7684\u51fa\u529b\u4e0d\u80fd\u8d85\u8fc7\u9650\u5b9a\u503c\uff0c\u76ee\u6807\u51fd\u6570\u4e3a\u8fd0\u884c\u6210\u672c\u5373\u7528\u7535\u8d39\u7528\u4e0e\u5356\u7535\u6536\u76ca\u7684\u5dee\u503c\u3002 \u76f4\u89c2\u5730\uff0c\u4efb\u610f\u65f6\u523b\u53ef\u4ee5\u7528\u4e00\u4e2a\u53d8\u91cf p^i p^i \u6765\u8868\u793a\u7535\u7f51\u7684\u51fa\u529b\uff1a\u6b63\u503c\u8868\u793a\u4ece\u7535\u7f51\u4e70\u7535\uff0c\u6216\u8005\u8d1f\u503c\u8868\u793a\u5356\u7535\u7ed9\u7535\u7f51\u3002\u4f46\u662f\uff0c \u4e8b\u5148\u5e76\u4e0d\u77e5\u9053 p^i p^i \u7684\u6b63\u8d1f \uff0c\u4e5f\u5c31\u6ca1\u6cd5\u8ba1\u7b97\u6b64\u523b\u7684\u8fd0\u884c\u6210\u672c\uff08\u4e0d\u80fd\u5c06\u7ebf\u6027\u89c4\u5212\u53d8\u91cf\u76f4\u63a5\u7528\u4e8e if-else \u8bed\u53e5\u4e2d\uff09\u3002\u56e0\u6b64\uff0c\u5f15\u5165\u4e70\u7535\u3001\u5356\u7535\u4e24\u4e2a\u4e2d\u95f4\u53d8\u91cf\u6765\u5206\u5f00\u63cf\u8ff0\uff1a p^i_f \\geq 0 p^i_f \\geq 0 \u8868\u793a i i \u65f6\u523b\u4ece\u7535\u7f51\u4e70\u7535\u91cf\uff1b p^i_t \\geq 0 p^i_t \\geq 0 \u8868\u793a i i \u65f6\u523b\u5411\u7535\u7f51\u5356\u7535\u91cf\uff1b \u56e0\u4e3a\u540c\u4e00\u65f6\u523b\u7535\u6d41\u53ea\u80fd\u5355\u5411\u6d41\u52a8\uff0c\u5373 p^i_f p^i_f \u548c p^i_t p^i_t \u81f3\u5c11\u6709\u4e00\u4e2a\u7b49\u4e8e0\uff1a p^i_f * p^i_t=0 p^i_f * p^i_t=0 \u3002 \u4f46\u8fd9\u5e76\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u7ebf\u6027\u7ea6\u675f\uff0c\u9700\u8981\u518d\u5f15\u5165\u4e00\u4e2a 0-1 \u53d8\u91cf\uff1a b_i=\\{0\uff0c1\\} b_i=\\{0\uff0c1\\} \uff1a1 \u8868\u793a\u4ece\u7535\u7f51\u4e70\u7535\u5373 p^i_t=0 p^i_t=0 \uff0c0 \u8868\u793a\u5356\u7535\u5230\u7535\u7f51\u5373 p^i_f=0 p^i_f=0 \u4e8e\u662f\u7ebf\u6027\u7ea6\u675f\u8868\u793a\u4e3a\uff1a 0 \\leq p^i_f \\leq b^i * C \\\\ 0 \\leq p^i_t \\leq (1-b^i) * C \\\\ 0 \\leq p^i_f \\leq b^i * C \\\\ 0 \\leq p^i_t \\leq (1-b^i) * C \\\\ \u5176\u4e2d\uff0c C C \u4e3a\u7535\u7f51\u5bb9\u91cf\uff08\u4ea4\u6362\u529f\u7387\uff09\u9650\u5236\u503c\u3002 \u6700\u7ec8\uff0c\u7535\u7f51 i i \u65f6\u523b\u5b9e\u9645\u51fa\u529b p^i p^i \u53ca\u7528\u7535\u6210\u672c\uff08\u4e70\u7535\u6216\u5356\u7535\uff09 c^i c^i \uff1a p^i = p^i_f - p^i_t \\\\ c^i = p^i_f * u_1 * dt - p^i_t * u_2 * dt p^i = p^i_f - p^i_t \\\\ c^i = p^i_f * u_1 * dt - p^i_t * u_2 * dt \u5176\u4e2d\uff0c u_1,u_2 u_1,u_2 \u5206\u522b\u4e3a\u8be5\u65f6\u523b\u5355\u4f4d\u4e70\u7535\u6210\u672c\u3001\u5356\u7535\u6536\u76ca\uff08\u5143/kWh\uff09\uff0c dt dt \u4e3a\u65f6\u95f4\u6b65\u957f\u3002 class Grid(Model): def __init__(self, name:str, capacity:float, unit_cost:np.ndarray, # unit cost when buying electricity from utility grid unit_profit:np.ndarray): # unit profit when selling electricity to utility grid super().__init__(name, capacity, unit_cost) self.unit_profit = unit_profit def create_model(self, time_points:int, dt:float): # define variables at each time point vars_from = [pulp.LpVariable(name=f'{self.name}_from_{i}', lowBound=0) for i in range(time_points)] vars_to = [pulp.LpVariable(name=f'{self.name}_to_{i}', lowBound=0) for i in range(time_points)] self.variables = [v1-v2 for v1,v2 in zip(vars_from, vars_to)] # constraints: capacity limit # 0<=var_from<=C*b # 0<=var_to<=C*(1-b) self.constraints = [] vars_b = [pulp.LpVariable(name=f'{self.name}_binary_{i}', cat=pulp.LpInteger) for i in range(time_points)] for v1,v2,b in zip(vars_from, vars_to, vars_b): self.constraints.append(v1<=self.capacity*b) self.constraints.append(v2<=self.capacity*(1-b)) # objective self.objective = pulp.lpSum([v*x for v,x in zip(vars_from, self.unit_cost)])*dt - \\ pulp.lpSum([v*x for v,x in zip(vars_to, self.unit_profit)])*dt","title":"(1) \u7535\u7f51\u6a21\u578b"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#2","text":"\u5c06\u98ce\u673a\u548c\u5149\u4f0f\u62bd\u8c61\u4e3a\u65b0\u80fd\u6e90\u53d1\u7535\u6a21\u578b\uff0c\u7ea6\u675f\u6761\u4ef6\u4e3a \u6bcf\u4e00\u65f6\u523b\u7684\u7535\u529b\u4f9b\u5e94\u4e0d\u5927\u4e8e\u9884\u6d4b\u51fa\u529b\uff0c\u5982\u679c\u4e0d\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\u7684\u8bdd\uff0c\u5219\u7b49\u4e8e\u9884\u6d4b\u51fa\u529b\u503c \u3002\u56e0\u6b64\uff0c\u5728 Model \u7c7b\u57fa\u7840\u4e0a\u589e\u52a0\u4e24\u4e2a\u8f93\u5165\u53c2\u6570\uff1a forecast \uff1a\u6bcf\u4e00\u65f6\u523b\u7684\u51fa\u529b\u9884\u6d4b\uff0c\u5373\u4e00\u4e2a\u5217\u5411\u91cf/\u6570\u7ec4/\u65f6\u95f4\u5e8f\u5217\uff1b allow_curtailment \uff1a\u662f\u5426\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff0c\u9ed8\u8ba4\u5141\u8bb8\u3002 \u76f8\u5e94\u5730\uff0c\u63d0\u4f9b\u4e00\u4e2a utilization \u8f93\u51fa\u5c5e\u6027\u8868\u793a\u65b0\u80fd\u6e90\u53d1\u7535\u7684\u5b9e\u9645\u5229\u7528\u7387\u3002 class Renewable(Model): def __init__(self, name:str, capacity:float, unit_cost:float, forecast:np.ndarray, # forecasting output allow_curtailment:bool=True): # allow curtailment or not super().__init__(name, capacity, unit_cost) self.forecast = forecast self.allow_curtailment = allow_curtailment def create_model(self, time_points:int, dt:float): # define variables at each time point self.variables = [pulp.LpVariable(name=f'{self.name}_{i}', lowBound=0) for i in range(time_points)] # constraints: v<=forecast if self.allow_curtailment: self.constraints = [v<=x for v,x in zip(self.variables, self.forecast)] else: self.constraints = [v==x for v,x in zip(self.variables, self.forecast)] # objective self.objective = pulp.lpSum(self.variables)*self.unit_cost*dt @property def utilization(self): return self.output.sum() / self.forecast.sum()","title":"(2) \u65b0\u80fd\u6e90\u53d1\u7535\u6a21\u578b"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#3","text":"\u539f\u9898\u5df2\u7ecf\u7ed9\u51fa\u4e86\u84c4\u7535\u6c60\u7684\u6df7\u5408\u6574\u6570\u89c4\u5212\u6570\u5b66\u6a21\u578b\uff0c\u9664\u4e86\u57fa\u7c7b\u4e2d\u7684\u5bb9\u91cf\u3001\u5355\u4f4d\u7528\u7535\u6210\u672c\u5916\uff0c\u8fd8\u6709\u5982\u4e0b\u4e3b\u8981\u53c2\u6570\uff1a capacity_limit \uff1a\u722c\u5761\u9650\u5236\u503c\uff0c\u5373\u539f\u9898\u516c\u5f0f\uff085\uff09\u4e2d\u7684\u6570\u503c 20% init_soc \uff1a\u521d\u59cbSOC\u72b6\u6001 soc_limit \uff1a\u7535\u91cf\u8303\u56f4SOC\u9650\u5236 cycle_limit \uff1a\u5145\u653e\u7535\u6b21\u6570\u9650\u5236 \u53c2\u8003\u539f\u9898\u7684\u7ea6\u675f\uff1a \u722c\u5761\u7ea6\u675f\uff1a\u516c\u5f0f\uff083\uff09\uff085\uff09 \u5bb9\u91cf\u7ea6\u675f\uff1a\u516c\u5f0f\uff081\uff09\uff082\uff09 \u8c03\u5ea6\u5468\u671f\u59cb\u672b\u7535\u91cf\u76f8\u7b49\uff1a\u516c\u5f0f\uff084\uff09 \u5145\u653e\u7535\u6b21\u6570\u7ea6\u675f\uff1a\u516c\u5f0f\uff086\uff09 \u7c7b\u6bd4\u4e0a\u6587\u5bf9\u7535\u7f51\u4e70\u7535\u3001\u5356\u7535\u884c\u4e3a\u7684\u5efa\u6a21\uff0c\u540c\u4e00\u65f6\u523b\u4e5f\u9700\u8981\u4e09\u4e2a\u4e2d\u95f4\u53d8\u91cf\uff1a\u5145\u7535\u529f\u7387 p^i_c p^i_c \u3001\u653e\u7535\u529f\u7387 p^i_d p^i_d \u3001\u5145\u653e\u7535 0-1 \u72b6\u6001 b^i b^i \uff081-\u653e\u7535\uff0c0-\u5145\u7535\uff09\u6765\u63cf\u8ff0\u7535\u6c60\u7684\u51fa\u529b\u3002\u524d\u4e09\u4e2a\u7ea6\u675f\u7684\u5b9e\u73b0\u4e0d\u518d\u8d58\u8ff0\uff0c\u4e0b\u9762\u91cd\u70b9\u89e3\u6790\u5145\u653e\u7535\u6b21\u6570\u7ea6\u675f\u3002 \u5145\u653e\u7535\u72b6\u6001\u5e8f\u5217 b=\\{b^1, b^2, ..., b^n\\} b=\\{b^1, b^2, ..., b^n\\} \uff0c\u5f15\u5165\u8f85\u52a9\u7684 0-1 \u53d8\u91cf t t \u8868\u793a\u76f8\u90bb\u72b6\u6001\u76f8\u51cf\u7684\u7edd\u5bf9\u503c\uff0c\u5373 t^i = |b^{i+1} - b^i| \\quad 1=1,2,3,...,n-1 t^i = |b^{i+1} - b^i| \\quad 1=1,2,3,...,n-1 \u5f53 t^i=1 t^i=1 \u65f6\uff0c\u5373\u76f8\u90bb\u7684\u5145\u653e\u7535\u72b6\u6001\u75310\u53d8\u6210\u4e861\uff0c\u6216\u8005\u75311\u53d8\u6210\u4e860\uff0c\u8868\u793a\u5b8c\u6210\u4e86\u4e00\u6b21\u5145\u653e\u7535\u5468\u671f\u3002\u4e8e\u662f\u603b\u7684\u5145\u653e\u7535\u6b21\u6570\u9650\u5236\u7ea6\u675f\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a \\Sigma t^i \\leq N_c \\Sigma t^i \\leq N_c \u81f3\u6b64\u8fd8\u5269\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u5c06\u542b\u6709\u7edd\u5bf9\u503c\u7684\u7b49\u5f0f t^i = |b^{i+1} - b^i| t^i = |b^{i+1} - b^i| \u53d8\u6362\u4e3a\u7ebf\u6027\u7ea6\u675f\uff1f \u7ed3\u5408\u672c\u6587\u573a\u666f\uff0c\u5c06\u7b49\u5f0f\u677e\u5f1b\u4e00\u4e0b t^i \\geq |b^{i+1} - b^i| t^i \\geq |b^{i+1} - b^i| \uff1a t^i=1 t^i=1 \u6b63\u662f\u6211\u4eec\u9700\u8981\u8ba1\u6570\u7684\u60c5\u51b5 t^i=0 t^i=0 \u6ca1\u6709\u589e\u52a0\u8ba1\u6570\uff0c\u6b64\u65f6 b^{i+1} = b^i b^{i+1} = b^i \u8868\u660e\u5e76\u672a\u53d1\u751f\u5145\u653e\u7535\u72b6\u6001\u53d8\u5316\uff0c\u6070\u597d\u53ef\u4ee5\u5bf9\u5e94\u4e0a \u4e8e\u662f\uff0c\u4e0a\u8ff0\u7edd\u5bf9\u503c\u7b49\u5f0f\u7ea6\u675f\u7b49\u6548\u4e3a\uff1a -t^i \\leq b^{i+1} - b^i \\leq t^i -t^i \\leq b^{i+1} - b^i \\leq t^i class Storage(Model): def __init__(self, name:str, capacity:float, unit_cost:float, capacity_limit:float, # charging / discharging ramping limit init_soc:float, # initial state of charge soc_limit:list, # SOC limit cycle_limit:int): # charing / discharging cycle counts limit super().__init__(name, capacity, unit_cost) self.init_soc = init_soc self.soc_limit = soc_limit self.cycle_limit = cycle_limit self.capacity_limit = capacity_limit def create_model(self, time_points: int, dt: float): # define variables at each time point vars_ch = [pulp.LpVariable(name=f'{self.name}_charge_{i}', lowBound=0) for i in range(time_points)] vars_dis = [pulp.LpVariable(name=f'{self.name}_discharge_{i}', lowBound=0) for i in range(time_points)] self.variables = [v1-v2 for v1,v2 in zip(vars_dis, vars_ch)] # constraints 1: ramping limit # 0<=var_dis<=C*b # 0<=var_ch<=C*(1-b) self.constraints = [] vars_b = [pulp.LpVariable(name=f'{self.name}_binary_{i}', cat=pulp.LpInteger) for i in range(time_points)] C = self.capacity * self.capacity_limit for v1,v2,b in zip(vars_dis, vars_ch, vars_b): self.constraints.append(v1<=C*b) self.constraints.append(v2<=C*(1-b)) # constraints 2: SOC limit soc = self.init_soc s1, s2 = self.soc_limit for v1,v2 in zip(vars_ch, vars_dis): soc += (v1*dt - v2*dt) / self.capacity self.constraints.append(soc>=s1) self.constraints.append(soc<=s2) # constraints 3: same SOC at the scheduling end self.constraints.append(pulp.lpSum(self.variables)==0) # constraints 4: charging / discharging cycle limit # t = |b_i-b_{i+1}| # sum(t)<=N vars_db = [vars_b[i+1]-vars_b[i] for i in range(time_points-1)] vars_t = [pulp.LpVariable(name=f'{self.name}_binary_t_{i}', cat=pulp.LpInteger) for i in range(time_points-1)] for db, t in zip(vars_db, vars_t): self.constraints.append(db>=-t) self.constraints.append(db<=t) self.constraints.append(pulp.lpSum(vars_t)<=self.cycle_limit) # objective self.objective = pulp.lpSum(vars_dis)*self.unit_cost*dt","title":"(3) \u84c4\u7535\u6c60\u6a21\u578b"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#4","text":"\u6700\u540e\uff0c\u6211\u4eec\u62bd\u8c61\u51fa\u4e00\u4e2a\u5fae\u7535\u7f51\u7c7b\uff0c\u5305\u542b\u4e0a\u8ff0\u80fd\u6e90\u8bbe\u5907 resources \u53ca\u8d1f\u8377 load \uff0c\u540c\u65f6\u5f15\u5165\u7cfb\u7edf\u80fd\u91cf\u5e73\u8861\u7ea6\u675f\uff0c\u5efa\u7acb\u6700\u7ec8\u7684\u4f18\u5316\u6a21\u578b\u3002\u5176\u4e2d\u7684\u51e0\u4e2a\u65b9\u6cd5\uff1a optimize() \uff1a\u5efa\u6a21\u548c\u6c42\u89e3\u8fc7\u7a0b operation_cost \uff1a\u76ee\u6807\u51fd\u6570\u503c\u5373\u603b\u7528\u7535\u8d39\u7528 average_cost \uff1a\u5e73\u5747\u7528\u7535\u6210\u672c import matplotlib.pyplot as plt class MicroGrid: def __init__(self, resources:list, load:np.ndarray, time_step:float) -> None: self.resources = resources self.load = load self.time_step = time_step # create problem: minimize the operation cost self.prob = pulp.LpProblem(name='microgrid_optimization', sense=pulp.LpMinimize) @property def operation_cost(self): return self.prob.objective.value() @property def average_cost(self): return self.operation_cost / (self.load.sum()*self.time_step) def optimize(self): '''Micro-grid operation optimization.''' # collect resources models d_variables, constraints, objective = [], [], 0.0 time_points = self.load.size for resource in self.resources: resource.create_model(time_points, self.time_step) d_variables.append(resource.variables) constraints.extend(resource.constraints) objective += resource.objective # add constraints: resource level for c in constraints: self.prob += c # add constraint: energy balance for i in range(time_points): _vars = [variables[i] for variables in d_variables] self.prob += pulp.lpSum(_vars)==self.load[i] # objective self.prob += objective # solve self.prob.solve() # output self._summary() def _summary(self): print(f'Status: {pulp.LpStatus[self.prob.status]}') print(f'\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a{round(self.operation_cost,4)} \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a{round(self.average_cost,4)} \u5143/kWh') # plot for r in self.resources: plt.plot(r.output, label=r.name) plt.plot(self.load, label='load') plt.legend()","title":"(4) \u98ce\u5149\u50a8\u4f18\u5316\u8c03\u5ea6\u6a21\u578b"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#_4","text":"\u672c\u8282\u6839\u636e\u4e0a\u6587\u5efa\u7acb\u7684\u4f18\u5316\u8c03\u5ea6\u6a21\u578b\uff0c\u6c42\u89e3\u63d0\u95ee\u4e2d\u7684\u4e0d\u540c\u8c03\u5ea6\u7b56\u7565\u3002 \u5148\u5bfc\u5165\u5168\u592996\u4e2a\u65f6\u523b\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\uff1a # read text to list with open('input.csv', 'r', encoding='utf-8') as f: lines = f.readlines() # print the first three lines for example for line in lines[:3]: print(line) # list to numpy 2D array data = [list(map(float, line.split(','))) for line in lines[1:]] # except the header line data = np.array(data) data_load, data_wt, data_pv, unit_profit, unit_cost = [data[:, i] for i in range(1,6)] # output: # \u5e8f\u53f7,\u8d1f\u8377(kW),\u98ce\u673a(kW),\u5149\u4f0f(kW),\u552e\u7535(\u5143/kWh),\u8d2d\u7535(\u5143/kWh) # 1,64.3,163.1,0,0.22,0.25 # 2,65.5,201.47,0,0.22,0.25","title":"\u6c42\u89e3\u5178\u578b\u573a\u666f"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#1_1","text":"\u95ee\u9898\uff1a\u5fae\u7f51\u4e2d\u84c4\u7535\u6c60\u4e0d\u4f5c\u7528\uff0c\u5fae\u7f51\u4e0e\u7535\u7f51\u4ea4\u6362\u529f\u7387\u65e0\u7ea6\u675f\uff0c\u65e0\u53ef\u518d\u751f\u80fd\u6e90\u60c5\u51b5\u4e0b\uff0c\u5206\u522b\u8ba1\u7b97\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\u3002 \u8fd9\u4e00\u95ee\u4e0d\u7528\u4f18\u5316\u6a21\u578b\u4e5f\u80fd\u89e3\uff0c\u591a\u4f59\u7684\u7535\u5356\u7ed9\u7535\u7f51\u3001\u4e0d\u8db3\u7684\u7535\u4ece\u7535\u7f51\u8d2d\u4e70\u5373\u53ef\uff0c\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 \u7684\u89e3\u6790\u8fc7\u7a0b\u3002\u4f46\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u5efa\u7acb\u4e86\u7edf\u4e00\u7684\u4f18\u5316\u8c03\u5ea6\u6a21\u578b\uff0c\u672c\u4f8b\u53ea\u8981\u5f15\u5165\u7535\u7f51\u4e00\u79cd\u8d44\u6e90\uff0c\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u7279\u4f8b\u76f4\u63a5\u6c42\u89e3\u5373\u53ef\u3002 \u56e0\u4e3a\u7535\u7f51\u4ea4\u6362\u529f\u7387\u6ca1\u6709\u9650\u5236\uff0c\u76f4\u63a5\u8bbe\u4e00\u4e2a\u8f83\u5927\u7684\u6570\u4f8b\u5982 10^6 10^6 \u5373\u53ef\u3002 # set a large value 1e6 as no limit on energy exchanging with grid grid = Grid(name='grid', capacity=1e6, unit_cost=unit_cost, unit_profit=unit_profit) # microgrid resources = [grid] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a1976.4142 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.5976 \u5143/kWh \u95ee\u9898\uff1a\u5fae\u7f51\u4e2d\u84c4\u7535\u6c60\u4e0d\u4f5c\u7528\uff0c\u5fae\u7f51\u4e0e\u7535\u7f51\u4ea4\u6362\u529f\u7387\u65e0\u7ea6\u675f\uff0c\u53ef\u518d\u751f\u80fd\u6e90\u5168\u989d\u5229\u7528\u60c5\u51b5\u4e0b\uff0c\u5206\u522b\u8ba1\u7b97\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\u3002 \u8fd9\u4e00\u95ee\u5c06\u98ce\u673a\u548c\u5149\u4f0f\u52a0\u5165\u5fae\u7f51\uff0c\u540c\u65f6\u6ce8\u610f\u8bbe\u7f6e\u4e0d\u53ef\u5f03\u98ce\u5f03\u5149\uff08\u53ef\u518d\u751f\u80fd\u6e90\u5168\u989d\u5229\u7528\uff09\u3002 # set a large value 1e6 as no limit on energy exchanging with grid grid = Grid(name='grid', capacity=1e6, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine: allow_curtailment=False wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=False) # pv: allow_curtailment=False pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=False) # microgrid resources = [grid, wt, pv] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a2275.1698 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.6879 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.0\uff0c\u5f03\u5149\u7387\uff1a0.0 \u56e0\u4e3a\u9650\u5b9a\u5168\u989d\u5229\u7528\u53ef\u518d\u751f\u80fd\u6e90\uff0c\u6240\u4ee5\u5f03\u98ce\u5f03\u5149\u7387\u90fd\u662f0\u3002\u98ce\u673a\u3001\u5149\u4f0f\u7684\u7528\u7535\u6210\u672c\u8f83\u9ad8\uff0c\u5373\u4fbf\u53ef\u4ee5\u5c06\u98ce\u673a\u3001\u5149\u4f0f\u7684\u7535\u5356\u7ed9\u7535\u7f51\uff0c\u5176\u6700\u7ec8\u6536\u76ca\u8fd8\u4e0d\u5982\u4f4e\u7535\u4ef7\u65f6\u523b\u4ece\u7535\u7f51\u76f4\u63a5\u4e70\u7535\uff0c\u6240\u4ee5\u5168\u989d\u5229\u7528\u53ef\u518d\u751f\u80fd\u6e90\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e00\u5c0f\u95ee\u7684\u5e73\u5747\u7528\u7535\u6210\u672c\u9ad8\u4e8e\u4e0a\u4e00\u95ee\u7684\u7eaf\u7f51\u7535\u3002","title":"(1) \u7ecf\u6d4e\u6027\u8bc4\u4f30\u65b9\u6848"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#2_1","text":"\u95ee\u9898\uff1a\u4e0d\u8ba1\u84c4\u7535\u6c60\u4f5c\u7528\uff0c\u5fae\u7f51\u4e0e\u7535\u7f51\u4ea4\u6362\u529f\u7387\u65e0\u7ea6\u675f\uff0c\u4ee5\u5e73\u5747\u8d1f\u8377\u4f9b\u7535\u5355\u4ef7\u6700\u5c0f\u4e3a\u76ee\u6807\uff08\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff09\uff0c\u5206\u522b\u8ba1\u7b97\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\uff0c\u5206\u6790\u53ef\u518d\u751f\u80fd\u6e90\u7684\u5229\u7528\u60c5\u51b5\u3002 \u8fd9\u4e2a\u8c03\u5ea6\u65b9\u6848\u662f\u5728\u4e0a\u4e00\u95ee\u7684\u57fa\u7840\u4e0a\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff0c\u5373\u5408\u7406\u9009\u62e9\u4f7f\u7528\u65b0\u80fd\u6e90\u53d1\u7535\u8fd8\u662f\u7f51\u7535\u3002\u540c\u6837\uff0c\u6211\u4eec\u8bbe\u7f6e\u8f93\u5165\u53c2\u6570\uff0c\u7136\u540e\u4ea4\u7ed9\u4f18\u5316\u6a21\u578b\u5373\u53ef\u3002\u6ce8\u610f\u548c\u4e0a\u4e00\u6bb5\u4ee3\u7801\u7684\u552f\u4e00\u533a\u522b\u662f\u8bbe\u7f6e\u5141\u8bb8\u5f03\u98ce\u5f03\u5149 allow_curtailment=True \u3002 # set a large value 1e6 as no limit on energy exchanging with grid grid = Grid(name='grid', capacity=1e6, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine: allow_curtailment=True wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=True) # pv: allow_curtailment=True pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=True) # microgrid resources=[grid, wt, pv] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a1785.1532 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.5397 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.5399\uff0c\u5f03\u5149\u7387\uff1a0.6923 \u56e0\u4e3a\u53ef\u4ee5\u6839\u636e\u7ecf\u6d4e\u6700\u4f18\u9009\u62e9\u5408\u9002\u7684\u7535\u529b\u6765\u6e90\uff0c\u8fd9\u4e00\u8c03\u5ea6\u65b9\u6848\u7684\u5e73\u5747\u7528\u7535\u6210\u672c\u4f4e\u4e8e\u524d\u4e24\u95ee\u3002\u4f8b\u5982\uff0c\u51cc\u6668\u65f6\u6bb5\u7f51\u7535\u7535\u4ef7\u672c\u6765\u5c31\u4f4e\uff0c\u6240\u4ee5\u9009\u62e9\u76f4\u63a5\u5f03\u6389\u6b64\u65f6\u7684\u98ce\u673a\u548c\u5149\u4f0f\u7535\u529b\uff08\u53c2\u89c1\u5f03\u98ce\u5f03\u5149\u7387\uff09\uff1b\u7f51\u7535\u5cf0\u7535\u65f6\u6bb5\u62e9\u673a\u8003\u8651\u98ce\u7535\u548c\u5149\u4f0f\u3002 \u8fd9\u7bc7\u6587\u7ae0 \u4ece\u7535\u4ef7\u89e3\u6790\u7684\u89d2\u5ea6\u5206\u6790\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u4eba\u4e3a\u5206\u6790\u7684\u7b56\u7565\u4e0e\u672c\u6587\u4f18\u5316\u7684\u7ed3\u679c\u5f88\u63a5\u8fd1\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003\u3002","title":"(2) \u6700\u4f18\u65e5\u524d\u8c03\u5ea6\u65b9\u6848\u4e00"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#3_1","text":"\u95ee\u9898\uff1a\u8003\u8651\u84c4\u7535\u6c60\u4f5c\u7528\uff0c\u4e14\u5fae\u7f51\u4e0e\u7535\u7f51\u5141\u8bb8\u4ea4\u6362\u529f\u7387\u4e0d\u8d85\u8fc7150kW\uff0c\u5728\u53ef\u518d\u751f\u80fd\u6e90\u5168\u989d\u5229\u7528\u7684\u6761\u4ef6\u4e0b\uff0c\u4ee5\u8d1f\u8377\u5e73\u5747\u4f9b\u7535\u5355\u4ef7\u6700\u5c0f\u4e3a\u76ee\u6807\uff0c\u5efa\u7acb\u4f18\u5316\u6a21\u578b\uff0c\u7ed9\u51fa\u6700\u4f18\u8c03\u5ea6\u65b9\u6848\uff0c\u5305\u62ec\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\uff0c\u5206\u6790\u84c4\u7535\u6c60\u53c2\u4e0e\u8c03\u8282\u540e\u4ea7\u751f\u7684\u5f71\u54cd\u3002 \u8fd9\u4e2a\u8c03\u5ea6\u65b9\u6848\u5728\u57fa\u7840\u573a\u666f\uff081\uff09\u7b2c\u4e8c\u95ee\u7684\u57fa\u7840\u4e0a\u5f15\u5165\u4e86\u84c4\u7535\u6c60\uff0c\u540c\u65f6\u9650\u5236\u4e86\u7535\u7f51\u4ea4\u6362\u529f\u7387\u3002 # grid grid = Grid(name='grid', capacity=150, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=False) # pv: allow_curtailment=False pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=False) # battery: allow_curtailment=False bt = Storage(name='battery', capacity=300, unit_cost=0.2, capacity_limit=0.2, init_soc=0.4, soc_limit=[0.3,0.95], cycle_limit=8) # microgrid resources=[grid, wt, pv, bt] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a2210.4672 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.6683 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.0\uff0c\u5f03\u5149\u7387\uff1a0.0 \u76f8\u6bd4\u57fa\u7840\u573a\u666f\uff081\uff09\u7b2c\u4e8c\u95ee\u7684\u5e73\u5747\u7528\u7535\u6210\u672c0.6879\uff0c\u672c\u65b9\u6848\u7528\u7535\u6210\u672c\u6709\u6240\u964d\u4f4e\u3002\u7ed3\u5408\u4e0b\u56fe\u5177\u4f53\u8c03\u5ea6\u53ef\u77e5\uff0c\u84c4\u7535\u6c60\u5c06\u51cc\u6668\u9ad8\u6210\u672c\u7684\u65b0\u80fd\u6e90\u7535\u529b\u8f6c\u79fb\u5230\u4e86\u7f51\u7535\u7684\u5cf0\u7535\u65f6\u6bb5\uff0c\u56e0\u6b64\u6bd4\u76f4\u63a5\u5728\u51cc\u6668\u65f6\u6bb5\u5356\u9ad8\u6210\u672c\u7684\u65b0\u80fd\u6e90\u7535\u529b\u66f4\u4e3a\u5212\u7b97\u3002 \u8fd9\u7bc7\u6587\u7ae0 \u4e5f\u89e3\u7b54\u4e86\u672c\u95ee\u9898\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003\u3002","title":"(3) \u6700\u4f18\u65e5\u524d\u8c03\u5ea6\u65b9\u6848\u4e8c"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#4_1","text":"\u95ee\u9898\uff1a\u8003\u8651\u84c4\u7535\u6c60\u4f5c\u7528\uff0c\u4e14\u5fae\u7f51\u4e0e\u7535\u7f51\u5141\u8bb8\u4ea4\u6362\u529f\u7387\u4e0d\u8d85\u8fc7150kW\uff0c\u4ee5\u8d1f\u8377\u4f9b\u7535\u6210\u672c\u6700\u5c0f\u4e3a\u76ee\u6807\uff08\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff09\uff0c\u5efa\u7acb\u4f18\u5316\u6a21\u578b\uff0c\u7ed9\u51fa\u6700\u4f18\u8c03\u5ea6\u65b9\u6848\uff0c\u5305\u62ec\u5404\u65f6\u6bb5\u8d1f\u8377\u7684\u4f9b\u7535\u6784\u6210\uff08kW\uff09\u3001\u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528(\u5143)\u548c\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff08\u5143/kWh\uff09\uff0c\u5206\u6790\u53ef\u518d\u751f\u80fd\u6e90\u7684\u5229\u7528\u60c5\u51b5\u53ca\u84c4\u7535\u6c60\u53c2\u4e0e\u8c03\u8282\u540e\u4ea7\u751f\u7684\u5f71\u54cd\u3002 \u8fd9\u4e00\u8c03\u5ea6\u65b9\u6848\u662f\u5728\u95ee\u9898\uff083\uff09\u7684\u57fa\u7840\u4e0a\u5141\u8bb8\u5f03\u98ce\u5f03\u5149\uff0c\u540c\u7406\u7565\u4f5c\u4fee\u6539\u5373\u53ef\u3002 # grid grid = Grid(name='grid', capacity=150, unit_cost=unit_cost, unit_profit=unit_profit) # wind turbine wt = Renewable(name='wind', capacity=250, unit_cost=0.52, forecast=data_wt, allow_curtailment=True) # pv: allow_curtailment=True pv = Renewable(name='pv', capacity=150, unit_cost=0.75, forecast=data_pv, allow_curtailment=True) # battery: allow_curtailment=True bt = Storage(name='battery', capacity=300, unit_cost=0.2, capacity_limit=0.2, init_soc=0.4, soc_limit=[0.3,0.95], cycle_limit=8) # microgrid resources=[grid, wt, pv, bt] mg = MicroGrid(resources=resources, load=data_load, time_step=15/60) # 15min mg.optimize() print(f'\u5f03\u98ce\u7387\uff1a{round(1-wt.utilization,4)}\uff0c\u5f03\u5149\u7387\uff1a{round(1-pv.utilization, 4)}') \u8f93\u51fa\uff1a Status: Optimal \u5168\u5929\u603b\u4f9b\u7535\u8d39\u7528\uff1a1733.5558 \u5143\uff0c\u8d1f\u8377\u5e73\u5747\u8d2d\u7535\u5355\u4ef7\uff1a0.5241 \u5143/kWh \u5f03\u98ce\u7387\uff1a0.5383\uff0c\u5f03\u5149\u7387\uff1a0.6494 \u76f8\u6bd4\u95ee\u9898\uff083\uff09\uff0c\u672c\u65b9\u6848\u5141\u8bb8\u653e\u5f03\u9ad8\u7535\u4ef7\u7684\u65b0\u80fd\u6e90\u7535\u529b\uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u4e00\u6b65\u964d\u4f4e\u5e73\u5747\u7528\u7535\u6210\u672c\uff1b\u76f8\u6bd4\u95ee\u9898\uff082\uff09\uff0c\u672c\u65b9\u6848\u591a\u4e86\u84c4\u7535\u6c60\u7684\u8c03\u8282\u4f5c\u7528\uff08\u5cf0\u8c37\u7535\u4ef7\u8f6c\u79fb\uff09\uff0c\u56e0\u6b64\u4e5f\u964d\u4f4e\u4e86\u5e73\u5747\u7528\u7535\u6210\u672c\uff0c\u540c\u65f6\u56e0\u4e3a\u7535\u6c60\u5bf9\u65b0\u80fd\u6e90\u7684\u6d88\u7eb3\uff0c\u672c\u65b9\u6848\u76f8\u5bf9\u95ee\u9898\uff082\uff09\u4e5f\u7565\u5fae\u964d\u4f4e\u4e86\u5f03\u98ce\u5f03\u5149\u7387\u3002","title":"(4) \u6700\u4f18\u65e5\u524d\u8c03\u5ea6\u65b9\u6848\u4e09"},{"location":"2022-10-22-%E5%BE%AE%E7%94%B5%E7%BD%91%E6%97%A5%E5%89%8D%E4%BC%98%E5%8C%96%E8%B0%83%E5%BA%A6%E5%85%A5%E9%97%A8%EF%BC%9A%E6%B1%82%E8%A7%A3%E4%B8%80%E9%81%93%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%A2%98/#_5","text":"input.csv microgrid_optimization.ipynb","title":"\u4ee3\u7801\u6c47\u603b"},{"location":"about/","text":"\u8fd9\u662f\u6211\u7684\u535a\u5ba2\uff0c\u8bb0\u5f55\u5de5\u4f5c\u548c\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u601d\u8003\u548c\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u6d89\u53ca\u6570\u503c\u8ba1\u7b97\u3001\u6d41\u7a0b\u81ea\u52a8\u5316\u3001CAD/CAE\u96c6\u6210\u7b49\uff0c\u4ee5\u53ca\u6b63\u5728\u5c1d\u8bd5\u7684\u673a\u5668\u5b66\u4e60\u3002 \u8054\u7cfb\u65b9\u5f0f\uff1atrain8808#gmail.com \u6211\u5728 Github \u4e0a\u5206\u4eab\u7684\u4e00\u4e9b\u5c0f\u9879\u76ee\uff1a PDF\u8f6cWord\uff1apdf2docx PyQt5\u5e94\u7528\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177tagit Excel\u63d2\u4ef6\uff1a\u7ed3\u5408Python\u548cVBA Python\u9057\u4f20\u7b97\u6cd5\u7ec3\u4e60","title":"\u5173\u4e8e"},{"location":"archive/","text":"Archives \u00b6 2022 (3) 2021 (15) 2020 (12) 2019 (13) 2018 (18) 2017 (15) 2016 (2) 2015 (4) 2014 (5) 2013 (9) 2012 (8)","title":"\u5f52\u6863"},{"location":"archive/#archives","text":"2022 (3) 2021 (15) 2020 (12) 2019 (13) 2018 (18) 2017 (15) 2016 (2) 2015 (4) 2014 (5) 2013 (9) 2012 (8)","title":"Archives"},{"location":"archives/2012/","text":"2012 \u00b6 2012-10-21 MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e 2012-10-20 MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f 2012-10-18 MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f 2012-10-10 \u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898 2012-07-27 MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b 2012-07-26 Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1 2012-07-10 Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898 2012-05-21 \u4e00\u8def\u8d70\u6765","title":"2012"},{"location":"archives/2012/#2012","text":"2012-10-21 MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e 2012-10-20 MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f 2012-10-18 MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f 2012-10-10 \u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898 2012-07-27 MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b 2012-07-26 Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1 2012-07-10 Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898 2012-05-21 \u4e00\u8def\u8d70\u6765","title":"2012"},{"location":"archives/2013/","text":"2013 \u00b6 2013-10-31 Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f 2013-10-19 ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b 2013-09-28 ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3 2013-08-05 UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528 2013-07-31 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5 2013-07-29 Levy Mises\u7406\u8bba\u7684\u601d\u8003 2013-06-13 UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55","title":"2013"},{"location":"archives/2013/#2013","text":"2013-10-31 Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f 2013-10-19 ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b 2013-09-28 ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3 2013-08-05 UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528 2013-07-31 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5 2013-07-29 Levy Mises\u7406\u8bba\u7684\u601d\u8003 2013-06-13 UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55","title":"2013"},{"location":"archives/2014/","text":"2014 \u00b6 2014-12-24 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206 2014-12-22 NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 2014-12-19 Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206 2014-11-28 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206 2014-07-02 Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898","title":"2014"},{"location":"archives/2014/#2014","text":"2014-12-24 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206 2014-12-22 NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 2014-12-19 Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206 2014-11-28 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206 2014-07-02 Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898","title":"2014"},{"location":"archives/2015/","text":"2015 \u00b6 2015-11-15 python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92 2015-11-04 \u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861 2015-06-17 SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e 2015-06-16 SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93","title":"2015"},{"location":"archives/2015/#2015","text":"2015-11-15 python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92 2015-11-04 \u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861 2015-06-17 SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e 2015-06-16 SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93","title":"2015"},{"location":"archives/2016/","text":"2016 \u00b6 2016-11-05 \u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6 2016-01-20 \u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e","title":"2016"},{"location":"archives/2016/#2016","text":"2016-11-05 \u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6 2016-01-20 \u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e","title":"2016"},{"location":"archives/2017/","text":"2017 \u00b6 2017-12-12 NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d 2017-11-30 VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 2017-11-25 VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf 2017-10-10 \u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f 2017-09-01 NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 2017-08-27 NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6 2017-08-08 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions 2017-07-31 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001 2017-07-24 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML 2017-07-23 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa 2017-04-24 Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 2017-04-24 Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 2017-03-09 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5 2017-03-08 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5 2017-01-07 \u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408","title":"2017"},{"location":"archives/2017/#2017","text":"2017-12-12 NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d 2017-11-30 VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 2017-11-25 VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf 2017-10-10 \u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f 2017-09-01 NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 2017-08-27 NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6 2017-08-08 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions 2017-07-31 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001 2017-07-24 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML 2017-07-23 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa 2017-04-24 Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 2017-04-24 Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 2017-03-09 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5 2017-03-08 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5 2017-01-07 \u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408","title":"2017"},{"location":"archives/2018/","text":"2018 \u00b6 2018-11-05 \u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c 2018-10-31 GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd 2018-10-27 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565 2018-10-25 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 2018-10-21 \u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 2018-10-21 Python Package __init__\u89e3\u6790 2018-09-28 NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879 2018-07-01 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh 2018-06-25 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0 2018-05-06 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe 2018-05-04 NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c 2018-04-05 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784 2018-02-09 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c 2018-02-08 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c 2018-02-07 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c 2018-01-23 \u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df 2018-01-13 PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa 2018-01-12 \u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa","title":"2018"},{"location":"archives/2018/#2018","text":"2018-11-05 \u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c 2018-10-31 GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd 2018-10-27 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565 2018-10-25 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 2018-10-21 \u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 2018-10-21 Python Package __init__\u89e3\u6790 2018-09-28 NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879 2018-07-01 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh 2018-06-25 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0 2018-05-06 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe 2018-05-04 NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c 2018-04-05 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784 2018-02-09 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c 2018-02-08 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c 2018-02-07 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c 2018-01-23 \u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df 2018-01-13 PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa 2018-01-12 \u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa","title":"2018"},{"location":"archives/2019/","text":"2019 \u00b6 2019-12-29 GitLab CI CD\uff1abefore_script\u548cafter_script 2019-10-01 Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898 2019-09-14 \u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5 2019-09-13 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 2019-08-31 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 2019-08-18 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32 2019-05-22 Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe 2019-05-02 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb 2019-04-21 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 2019-04-20 VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5 2019-03-24 PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e","title":"2019"},{"location":"archives/2019/#2019","text":"2019-12-29 GitLab CI CD\uff1abefore_script\u548cafter_script 2019-10-01 Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898 2019-09-14 \u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5 2019-09-13 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 2019-08-31 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 2019-08-18 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32 2019-05-22 Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe 2019-05-02 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb 2019-04-21 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 2019-04-20 VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5 2019-03-24 PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e","title":"2019"},{"location":"archives/2020/","text":"2020 \u00b6 2020-10-25 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247 2020-10-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e 2020-09-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf 2020-09-01 \u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 2020-08-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d 2020-08-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c 2020-07-20 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f 2020-07-14 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 2020-07-13 pdf2docx\u5f00\u53d1\u6982\u8981 2020-03-01 \u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 2020-02-28 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset 2020-02-27 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset","title":"2020"},{"location":"archives/2020/#2020","text":"2020-10-25 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247 2020-10-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e 2020-09-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf 2020-09-01 \u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 2020-08-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d 2020-08-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c 2020-07-20 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f 2020-07-14 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 2020-07-13 pdf2docx\u5f00\u53d1\u6982\u8981 2020-03-01 \u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 2020-02-28 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset 2020-02-27 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset","title":"2020"},{"location":"archives/2021/","text":"2021 \u00b6 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-15 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6 2021-06-26 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406 2021-06-19 \u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 2021-06-06 pytest\u53c2\u6570\u5316\u6d4b\u8bd5 2021-05-30 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40 2021-05-09 Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee 2021-05-01 Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846 2021-04-24 Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570 2021-01-02 Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4","title":"2021"},{"location":"archives/2021/#2021","text":"2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-15 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6 2021-06-26 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406 2021-06-19 \u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 2021-06-06 pytest\u53c2\u6570\u5316\u6d4b\u8bd5 2021-05-30 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40 2021-05-09 Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee 2021-05-01 Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846 2021-04-24 Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570 2021-01-02 Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4","title":"2021"},{"location":"archives/2022/","text":"2022 \u00b6 2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2022-01-27 GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline","title":"2022"},{"location":"archives/2022/#2022","text":"2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2022-01-27 GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline","title":"2022"},{"location":"categories/CAD-CAE%20integration/","text":"CAD/CAE integration \u00b6 2018-09-28 NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879 2018-07-01 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh 2018-06-25 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0 2018-05-06 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe 2018-05-04 NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c 2018-04-05 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784 2017-12-12 NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d 2017-09-01 NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 2017-08-27 NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6 2017-08-08 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions 2013-08-05 UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528 2013-06-13 UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55","title":"CAD/CAE integration"},{"location":"categories/CAD-CAE%20integration/#cadcae integration","text":"2018-09-28 NXOpen\uff1a\u7981\u7528\u83dc\u5355\u9879 2018-07-01 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4eceANSYS APDL\u89d2\u5ea6\u770b\u5f85Mesh 2018-06-25 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aFEM SIM\u6a21\u578b\u4e2dPolygon Body\u7684\u540d\u79f0 2018-05-06 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1a\u4e3b\u8981\u7c7b\u7ed3\u6784\u56fe 2018-05-04 NXOpen\uff1a\u5bf9\u8c61\u5c5e\u6027\u64cd\u4f5c 2018-04-05 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aAdvanced Simulation\u6587\u4ef6\u7ed3\u6784 2017-12-12 NXOpen\uff1aExpression\u7c7b\u578b\u4e0e\u57fa\u672c\u5355\u4f4d 2017-09-01 NXOpen\uff1aMenu Script\u81ea\u5b9a\u4e49\u83dc\u5355 2017-08-27 NXOpen\uff1a\u5bf9\u8bdd\u6846\u7684\u8ba4\u8bc6 2017-08-08 NXOpen CAE\u5f00\u53d1\u603b\u7ed3\u7cfb\u5217\uff1aGroups\u4e0eRegions 2013-08-05 UG NX \u89d2\u8272\u5b9a\u5236\u4e0e\u5e94\u7528 2013-06-13 UG\u8fd0\u52a8\u4eff\u771f\u5b66\u4e60\u8bb0\u5f55","title":"CAD/CAE integration"},{"location":"categories/devops/","text":"devops \u00b6 2022-01-27 GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline 2021-06-06 pytest\u53c2\u6570\u5316\u6d4b\u8bd5 2021-05-09 Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee 2019-12-29 GitLab CI CD\uff1abefore_script\u548cafter_script 2018-10-31 GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd","title":"devops"},{"location":"categories/devops/#devops","text":"2022-01-27 GitLab CI CD\uff1a\u8de8\u9879\u76ee\u89e6\u53d1pipeline 2021-06-06 pytest\u53c2\u6570\u5316\u6d4b\u8bd5 2021-05-09 Jenkins\u5165\u95e8\uff1a\u521b\u5efa\u9879\u76ee 2019-12-29 GitLab CI CD\uff1abefore_script\u548cafter_script 2018-10-31 GitLab CI CD\uff1a\u529f\u80fd\u4ecb\u7ecd","title":"devops"},{"location":"categories/feeling/","text":"feeling \u00b6 2020-03-01 \u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 2012-05-21 \u4e00\u8def\u8d70\u6765","title":"feeling"},{"location":"categories/feeling/#feeling","text":"2020-03-01 \u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 2012-05-21 \u4e00\u8def\u8d70\u6765","title":"feeling"},{"location":"categories/finite%20element%20analysis/","text":"finite element analysis \u00b6 2016-01-20 \u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e 2012-10-21 MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e 2012-10-20 MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f 2012-10-18 MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f 2012-10-10 \u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898 2012-07-27 MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b 2012-07-26 Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1 2012-07-10 Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898","title":"finite element analysis"},{"location":"categories/finite%20element%20analysis/#finite element analysis","text":"2016-01-20 \u4f7f\u7528Python\u5bfc\u51faMSC.Marc\u540e\u5904\u7406\u6570\u636e 2012-10-21 MSC.MARC 2010\u521a\u6027\u63a5\u89e6\u4f53\u8fd0\u52a8\u8bbe\u7f6e 2012-10-20 MSC.MARC 2010\u8868\u683c\uff1a\u6570\u636e\u6a21\u5f0f 2012-10-18 MSC.MARC 2010\u8868\u683c\uff1a\u521b\u5efa\u65b9\u5f0f 2012-10-10 \u5b9e\u4f8b\u8bf4\u660eVS2005\u3001Python\u7a0b\u5e8f\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5b57\u7b26\u7f16\u7801\u95ee\u9898 2012-07-27 MSC Marc2011\u5355\u673a\u591a\u6838\u5e76\u884c\u8ba1\u7b97\u793a\u4f8b 2012-07-26 Windows\u547d\u4ee4\u884c\u63d0\u4ea4Marc\u8ba1\u7b97\u4efb\u52a1 2012-07-10 Marc\u8c03\u7528Python\u811a\u672c\u7a0b\u5e8f\u4e2d\u5173\u4e8e\u76ee\u5f55\u64cd\u4f5c\u7684\u51e0\u4e2a\u95ee\u9898","title":"finite element analysis"},{"location":"categories/machine%20learning/","text":"machine learning \u00b6 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2020-03-01 \u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 2020-02-28 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset 2020-02-27 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset","title":"machine learning"},{"location":"categories/machine%20learning/#machine learning","text":"2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2020-03-01 \u8bfb\u4e66\u8ba1\u5212\uff1aTensorFlow\u6280\u672f\u89e3\u6790\u4e0e\u5b9e\u6218 2020-02-28 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.TFRecordDataset 2020-02-27 TensorFlow\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\uff1atf.data.Dataset","title":"machine learning"},{"location":"categories/mathematics/","text":"mathematics \u00b6 2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6 2021-06-19 \u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 2020-09-01 \u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 2017-03-09 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5 2017-03-08 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5 2015-11-04 \u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861 2013-07-31 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5","title":"mathematics"},{"location":"categories/mathematics/#mathematics","text":"2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2022-07-03 \u7a7a\u95f4\u91d1\u5b57\u5854\u6c60\u5316\uff08SPP\uff09\u5173\u952e\u53c2\u6570\u8ba1\u7b97 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6 2021-06-19 \u9012\u5f52\u6295\u5f71\u5206\u5272\u7b97\u6cd5 2020-09-01 \u6c42\u89e3\u77e9\u5f62\u76f8\u4ea4\u95ee\u9898 2017-03-09 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u5411\u91cf\u4ee3\u6570\u6cd5 2017-03-08 \u7403\u9762\u8ddd\u79bb\u4e0e\u65b9\u4f4d\u89d2\u516c\u5f0f\u7684\u63a8\u5bfc\uff1a\u89e3\u4e09\u89d2\u5f62\u6cd5 2015-11-04 \u7a0b\u5e8f\u5b9e\u73b0\u793e\u4f1a\u6838\u7b97\u77e9\u9635\uff08SAM\uff09\u7684\u8d26\u6237\u96c6\u7ed3\u4e0e\u5e73\u8861 2013-07-31 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5","title":"mathematics"},{"location":"categories/numeric%20calculation/","text":"numeric calculation \u00b6 2019-10-01 Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898 2018-11-05 \u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c 2018-10-27 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565 2018-10-25 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 2018-10-21 \u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 2015-11-15 python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92 2014-12-24 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206 2014-12-22 NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 2014-12-19 Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206 2014-11-28 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206","title":"numeric calculation"},{"location":"categories/numeric%20calculation/#numeric calculation","text":"2019-10-01 Python\u6c42\u89e3\u81ea\u884c\u8f66\u524d\u540e\u8f6e\u8f68\u8ff9\u95ee\u9898 2018-11-05 \u9057\u4f20\u7b97\u6cd5\uff1a\u6d4b\u8bd5\u6848\u4f8b\u4e4b\u51fd\u6570\u6781\u503c 2018-10-27 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u7cbe\u82f1\u7b56\u7565 2018-10-25 \u9057\u4f20\u7b97\u6cd5\uff1a\u6539\u8fdb\u65b9\u5411\u4e4b\u81ea\u9002\u5e94\u7b56\u7565 2018-10-21 \u9057\u4f20\u7b97\u6cd5\uff1a\u57fa\u672c\u539f\u7406\u53caPython\u5b9e\u73b0 2015-11-15 python\u4e2d\u4f7f\u7528mlab\u5e93\u5b9e\u73b0\u4e0eMATLAB\u4ea4\u4e92 2014-12-24 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e09\u91cd\u79ef\u5206 2014-12-22 NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 2014-12-19 Gauss Legendre\u4e8c\u91cd\u6570\u503c\u79ef\u5206 2014-11-28 \u4e0a\u9650\u6cd5\u5851\u6027\u529f\u6570\u503c\u79ef\u5206\u7b97\u4f8b\uff1a\u4e8c\u91cd\u79ef\u5206","title":"numeric calculation"},{"location":"categories/optimization/","text":"optimization \u00b6 2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6","title":"optimization"},{"location":"categories/optimization/#optimization","text":"2022-10-22 \u5fae\u7535\u7f51\u65e5\u524d\u4f18\u5316\u8c03\u5ea6\u5165\u95e8\uff1a\u6c42\u89e3\u4e00\u9053\u6570\u5b66\u5efa\u6a21\u9898 2021-08-29 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPuLP \u6c42\u89e3\u6846\u67b6 2021-08-28 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u89c4\u5219\u6307\u6d3e\u7b97\u6cd5 2021-08-22 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aOR-Tools \u7ea6\u675f\u6c42\u89e3\u5668 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1a\u95ee\u9898\u63cf\u8ff0 2021-08-08 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6","title":"optimization"},{"location":"categories/plasticity%20theory/","text":"plasticity theory \u00b6 2013-07-31 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5 2013-07-29 Levy Mises\u7406\u8bba\u7684\u601d\u8003","title":"plasticity theory"},{"location":"categories/plasticity%20theory/#plasticity theory","text":"2013-07-31 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\u7684\u8bc1\u660e 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362 2013-07-30 \u5e94\u529b\u5f20\u91cf\u7684\u8ba4\u8bc6\uff1a\u57fa\u672c\u6982\u5ff5 2013-07-29 Levy Mises\u7406\u8bba\u7684\u601d\u8003","title":"plasticity theory"},{"location":"categories/process%20automation/","text":"process automation \u00b6 2021-06-26 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406 2021-05-30 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40 2021-05-01 Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846 2021-04-24 Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570 2021-01-02 Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4 2020-10-25 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247 2020-10-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e 2020-09-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf 2020-08-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d 2020-08-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c 2020-07-20 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f 2020-07-14 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 2020-07-13 pdf2docx\u5f00\u53d1\u6982\u8981 2019-09-14 \u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5 2019-09-13 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 2019-05-02 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb 2019-04-21 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e 2018-01-23 \u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df 2017-07-31 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001 2017-07-24 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML 2017-07-23 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa 2017-04-24 Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 2017-04-24 Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 2017-01-07 \u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408 2014-07-02 Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898","title":"process automation"},{"location":"categories/process%20automation/#process automation","text":"2021-06-26 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u77e2\u91cf\u56fe\u5904\u7406 2021-05-30 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u9875\u9762\u5e03\u5c40 2021-05-01 Python\u5b50\u8fdb\u7a0b\u5173\u95edExcel\u81ea\u52a8\u5316\u8fc7\u7a0b\u51fa\u73b0\u7684\u6d88\u606f\u6846 2021-04-24 Python xlwings\u6a21\u5757\u521b\u5efa\u548c\u8c03\u7528VBA\u51fd\u6570 2021-01-02 Python\u5904\u7406PDF\u7684\u7b2c\u4e09\u65b9\u5e93\u5bf9\u6bd4 2020-10-25 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u521b\u5efa\u6d6e\u52a8\u56fe\u7247 2020-10-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u83b7\u53d6\u56fe\u7247\u53ca\u5176\u4f4d\u7f6e 2020-09-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u5bf9\u9f50\u9690\u5f0f\u8868\u683c\u7ebf 2020-08-27 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6bb5\u843d 2020-08-15 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u8868\u683c 2020-07-20 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u89e3\u6790\u6587\u672c\u6837\u5f0f 2020-07-14 pdf2docx\u5f00\u53d1\u6982\u8981\uff1a\u63d0\u53d6\u6587\u672c\u3001\u56fe\u7247\u548c\u5f62\u72b6 2020-07-13 pdf2docx\u5f00\u53d1\u6982\u8981 2019-09-14 \u4ee5Windows\u670d\u52a1\u65b9\u5f0f\u8fd0\u884cExcel\u81ea\u52a8\u5316\u7a0b\u5e8f\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6cd5 2019-09-13 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 2019-05-02 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb 2019-04-21 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e 2018-01-23 \u81ea\u5b9a\u4e49Microsoft Office Ribbon\u533a\u57df 2017-07-31 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u83dc\u5355\u9879Enable\u72b6\u6001 2017-07-24 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u4fee\u6539XML 2017-07-23 Microsoft Excel 2010\u81ea\u5b9a\u4e49\u529f\u80fd\u533a\uff1a\u624b\u5de5\u521b\u5efa 2017-04-24 Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 2017-04-24 Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 2017-01-07 \u5b66\u4f4d\u8bba\u6587\u5199\u4f5c\u4e2d\u7684\u8f6f\u4ef6\u7ec4\u5408 2014-07-02 Sublime Text \u81ea\u5b9a\u4e49\u989c\u8272\u4e3b\u9898","title":"process automation"},{"location":"categories/python-vba-cpp/","text":"python/vba/cpp \u00b6 2021-08-15 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-06-06 pytest\u53c2\u6570\u5316\u6d4b\u8bd5 2019-09-13 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 2019-08-31 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 2019-08-18 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32 2019-05-22 Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe 2019-05-02 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb 2019-04-21 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 2019-04-20 VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5 2019-03-24 PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e 2018-10-21 Python Package __init__\u89e3\u6790 2018-02-09 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c 2018-02-08 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c 2018-02-07 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c 2018-01-13 PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa 2018-01-12 \u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa 2017-11-30 VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 2017-11-25 VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf 2017-10-10 \u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f 2017-04-24 Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 2017-04-24 Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 2014-12-22 NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 2013-10-31 Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f","title":"python/vba/cpp"},{"location":"categories/python-vba-cpp/#pythonvbacpp","text":"2021-08-15 \u57fa\u4e8ematplotlib\u7684\u52a8\u6001\u7518\u7279\u56fe 2021-08-14 \u4f5c\u4e1a\u8f66\u95f4\u8c03\u5ea6\u95ee\u9898\u6c42\u89e3\u6846\u67b6\uff1aPython\u5efa\u6a21 2021-06-06 pytest\u53c2\u6570\u5316\u6d4b\u8bd5 2019-09-13 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1aVBA\u6a21\u5757\u8bfb\u5199 2019-08-31 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u4f20\u5165\u5b57\u7b26\u4e32 2019-08-18 C++ DLL\u4e0eVBA\u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\u4f20\u9012\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32 2019-05-22 Matplotlib\u591a\u7eb5\u8f74\uff08\u5bc4\u751f\u8f74\uff09\u6563\u70b9\u56fe 2019-05-02 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u83b7\u53d6\u516c\u5f0f\u4f9d\u8d56\u5173\u7cfb 2019-04-21 Python win32com\u6a21\u5757\u64cd\u4f5cExcel\uff1a\u57fa\u672c\u8bfb\u5199 2019-04-20 VBA\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff08\u5de5\u4f5c\u7c3f COM\u94fe\u63a5\u5e93 C\u94fe\u63a5\u5e93\uff09\u65b9\u6cd5 2019-03-24 PyQt5\u5e94\u7528\u5b9e\u8df5\uff1a\u4e2a\u4eba\u77e5\u8bc6\u7ba1\u7406\u5de5\u5177Tagit 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u539f\u7406\u4ecb\u7ecd 2019-01-28 \u96c6\u6210python\u7684Excel\u63d2\u4ef6\u6a21\u677fPyAddin\uff1a\u4f7f\u7528\u8bf4\u660e 2018-10-21 Python Package __init__\u89e3\u6790 2018-02-09 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u6587\u4ef6\u76ee\u5f55\u64cd\u4f5c 2018-02-08 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u5b57\u7b26\u4e32\u64cd\u4f5c 2018-02-07 Python3\u4ee3\u7801\u793a\u4f8b\uff1a\u57fa\u672c\u64cd\u4f5c 2018-01-13 PyQt\u4f7f\u7528QProcess\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa 2018-01-12 \u4f7f\u7528subprocess\u6a21\u5757\u8c03\u7528\u5b50\u8fdb\u7a0b\u5e76\u83b7\u53d6\u8f93\u51fa 2017-11-30 VBA\u8c03\u7528C++\u52a8\u6001\u94fe\u63a5\u5e93 2017-11-25 VBA\u8bbe\u7f6e\u7528\u6237\u73af\u5883\u53d8\u91cf 2017-10-10 \u517c\u5bb9Windows\u548cLinux\u7684C++\u52a8\u6001\u94fe\u63a5\u5e93\u6a21\u677f 2017-04-24 Selenium Python\u57fa\u672c\u64cd\u4f5c\u5907\u5fd8 2017-04-24 Selenium+PhantomJS\u65e0\u6cd5\u8f93\u5165\u6587\u672c\u53ca\u5176\u89e3\u51b3\u65b9\u6cd5 2014-12-22 NumPy\u5e93frompyfunc\u4e0evectorize\u7684\u6bd4\u8f83 2013-10-31 Sublime Text 2\u4e2d\u8fd0\u884cPython\u7a0b\u5e8f","title":"python/vba/cpp"},{"location":"categories/web%20development/","text":"web development \u00b6 2016-11-05 \u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6 2015-06-17 SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e 2015-06-16 SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93 2013-10-19 ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b 2013-09-28 ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3","title":"web development"},{"location":"categories/web%20development/#web development","text":"2016-11-05 \u6574\u5408UEditor\u56fe\u7247\u4e0a\u4f20\u6a21\u5757\u4e3a\u4e0a\u4f20\u63d2\u4ef6 2015-06-17 SAE\u73af\u5883\u4e0b\u4f7f\u7528PHPExcel\u5bfc\u5165\u6570\u636e 2015-06-16 SAE\u73af\u5883\u4e0b\u4f7f\u7528MySQLReback\u5907\u4efd\u8fd8\u539fMySQL\u6570\u636e\u5e93 2013-10-19 ThinkPHP\u6846\u67b6\u4e0bMySQL\u6570\u636e\u5e93\u5907\u4efd\u8fd8\u539f\u7c7b 2013-09-28 ThinkPHP\u81ea\u52a8\u9a8c\u8bc1\uff1aunique\u89c4\u5219\u7684\u95ee\u9898\u548c\u7406\u89e3","title":"web development"}]}